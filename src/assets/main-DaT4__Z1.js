const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["assets/algorithms-midterm-CR8ATVR_.js","assets/solution-viewer-CReZtHwQ.js","assets/algorithms-final-CU-PhYWn.js","assets/lab-solutions-DuYKF0zI.js","assets/midterm-solutions-DuY3BOLa.js","assets/final-solutions-Kjz0yZTx.js"])))=>i.map(i=>d[i]);
(function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const r of document.querySelectorAll('link[rel="modulepreload"]'))s(r);new MutationObserver(r=>{for(const n of r)if(n.type==="childList")for(const a of n.addedNodes)a.tagName==="LINK"&&a.rel==="modulepreload"&&s(a)}).observe(document,{childList:!0,subtree:!0});function i(r){const n={};return r.integrity&&(n.integrity=r.integrity),r.referrerPolicy&&(n.referrerPolicy=r.referrerPolicy),r.crossOrigin==="use-credentials"?n.credentials="include":r.crossOrigin==="anonymous"?n.credentials="omit":n.credentials="same-origin",n}function s(r){if(r.ep)return;r.ep=!0;const n=i(r);fetch(r.href,n)}})();const v=t=>document.getElementById(t),Jn=t=>document.querySelectorAll(t);function Rv(t,e=150){let i;return(...s)=>{clearTimeout(i),i=setTimeout(()=>t(...s),e)}}function yg(t){const e=document.createElement("div");return e.textContent=t,e.innerHTML}typeof window<"u"&&(window.$=v,window.$$=Jn,window.debounce=Rv,window.escapeHtml=yg);const O={ctx:null,unlocked:!1,enabled:!1,muted:!1,preset:"piano",masterGain:null,uiGain:null,feedbackGain:null,ambientGain:null,compressor:null,volume:.7,lastPlay:new Map,scale:[130.81,146.83,164.81,196,220,261.63,293.66,329.63,392,440,523.25,587.33],presets:{piano:{type:"triangle",attack:.015,decay:.09,sustain:.35,release:.25,gain:.22,filter:{type:"lowpass",freq:5600,q:.7}},marimba:{type:"sine",attack:.001,decay:.12,sustain:.05,release:.28,gain:.3,filter:{type:"bandpass",freq:1600,q:.8}},synth:{type:"sawtooth",attack:.02,decay:.08,sustain:.35,release:.18,gain:.11,filter:{type:"lowpass",freq:4200,q:.9}},bells:{type:"sine",attack:.001,decay:.22,sustain:.18,release:.7,gain:.26,filter:{type:"highpass",freq:220,q:.7}},lofi:{type:"sine",attack:.04,decay:.2,sustain:.25,release:.5,gain:.18,filter:{type:"lowpass",freq:800,q:.4}},arcade:{type:"square",attack:.001,decay:.04,sustain:.1,release:.08,gain:.12,filter:{type:"highpass",freq:400,q:1.2}},orchestra:{type:"triangle",attack:.06,decay:.15,sustain:.45,release:.6,gain:.22,filter:{type:"lowpass",freq:3e3,q:.5}},silent:{type:"sine",attack:0,decay:0,sustain:0,release:0,gain:0,filter:{type:"lowpass",freq:1,q:0}}},events:{nav_switch:{ch:"ui",kind:"chord",notes:[261.63,329.63],dur:.09,cooldown:120},button_primary_click:{ch:"ui",kind:"tick",freq:392,dur:.05,cooldown:60},button_secondary_click:{ch:"ui",kind:"tick",freq:293.66,dur:.045,cooldown:60},slider_tick:{ch:"ui",kind:"tick",freq:220,dur:.03,cooldown:80},toast_success:{ch:"feedback",kind:"arpeggio",notes:[392,523.25,659.25],dur:.15,cooldown:250},toast_error:{ch:"feedback",kind:"down",notes:[392,329.63],dur:.16,cooldown:250},ds_insert:{ch:"ui",kind:"chord",notes:[329.63,392],dur:.08,cooldown:80},ds_remove:{ch:"ui",kind:"down",notes:[329.63,261.63],dur:.1,cooldown:120},ds_found:{ch:"feedback",kind:"arpeggio",notes:[440,523.25],dur:.12,cooldown:150},ds_not_found:{ch:"feedback",kind:"down",notes:[293.66,261.63],dur:.14,cooldown:150},reset:{ch:"ui",kind:"tick",freq:261.63,dur:.05,cooldown:80},sort_complete:{ch:"feedback",kind:"major",notes:[523.25,659.25,783.99],dur:.55,cooldown:800},path_complete:{ch:"feedback",kind:"major",notes:[392,493.88,587.33],dur:.55,cooldown:800},sql_run_success:{ch:"feedback",kind:"arpeggio",notes:[261.63,329.63,392],dur:.12,cooldown:180},sql_run_error:{ch:"feedback",kind:"down",notes:[329.63,261.63],dur:.18,cooldown:180},sql_hint_open:{ch:"ui",kind:"tick",freq:659.25,dur:.04,cooldown:140},sql_solve_success:{ch:"feedback",kind:"major",notes:[261.63,329.63,392,523.25],dur:.65,cooldown:1e3},card_flip:{ch:"ui",kind:"tick",freq:440,dur:.06,cooldown:100}},init(){if(this.ctx)return;const t=window.AudioContext||window.webkitAudioContext;if(!t)return;this.ctx=new t,this.masterGain=this.ctx.createGain(),this.uiGain=this.ctx.createGain(),this.feedbackGain=this.ctx.createGain(),this.ambientGain=this.ctx.createGain(),this.compressor=this.ctx.createDynamicsCompressor(),this.compressor.threshold.value=-18,this.compressor.knee.value=20,this.compressor.ratio.value=8,this.compressor.attack.value=.003,this.compressor.release.value=.22,this.uiGain.connect(this.masterGain),this.feedbackGain.connect(this.masterGain),this.ambientGain.connect(this.masterGain),this.masterGain.connect(this.compressor),this.compressor.connect(this.ctx.destination),this.uiGain.gain.value=.65,this.feedbackGain.gain.value=.75,this.ambientGain.gain.value=.35;const e=this._loadSettings();this.volume=e.volume,this.enabled=e.enabled,this.muted=e.muted,this.preset=e.preset,this._applyVolume()},_saveSettings(){try{localStorage.setItem("cse-helper-audio",JSON.stringify({enabled:this.enabled,muted:this.muted,volume:this.volume,preset:this.preset}))}catch(t){console.warn("[AudioEngine] Failed to save settings:",t)}},_loadSettings(){try{const t=localStorage.getItem("cse-helper-audio");if(!t)return{enabled:!1,muted:!1,volume:.7,preset:"piano"};const e=JSON.parse(t);return{enabled:!!e.enabled,muted:!!e.muted,volume:typeof e.volume=="number"?Math.min(1,Math.max(0,e.volume)):.7,preset:this.presets[e.preset]?e.preset:"piano"}}catch(t){return console.warn("[AudioEngine] Failed to load settings:",t),{enabled:!1,muted:!1,volume:.7,preset:"piano"}}},async unlock(){if(this.init(),!!this.ctx)try{this.ctx.state==="suspended"&&await this.ctx.resume(),this.unlocked=!0}catch(t){console.warn("[AudioEngine] Failed to unlock:",t)}},toggleEnabled(){this.init(),this.enabled=!this.enabled,this._saveSettings(),this.updateUI(),this.enabled&&(this.unlock(),this.play("button_primary_click"))},setPreset(t){this.presets[t]&&(this.preset=t,this._saveSettings(),this.updateUI(),this.enabled&&this.play("nav_switch"))},setVolume(t){this.volume=Math.min(1,Math.max(0,t)),this._applyVolume(),this._saveSettings()},_applyVolume(){if(!this.masterGain)return;const t=this.muted?0:this.volume;this.masterGain.gain.value=t},setMuted(t){this.muted=!!t,this._applyVolume(),this._saveSettings(),this.updateUI()},_busNode(t){return t==="ui"?this.uiGain:t==="ambient"?this.ambientGain:this.feedbackGain},_cooldownOk(t){const e=this.events[t],i=(e==null?void 0:e.cooldown)??0,s=performance.now(),r=this.lastPlay.get(t)||0;return s-r<i?!1:(this.lastPlay.set(t,s),!0)},valueToFreq(t,e,i){const s=i-e||1,r=(t-e)/s,n=Math.floor(r*(this.scale.length-1));return this.scale[Math.min(Math.max(n,0),this.scale.length-1)]},playNote(t,e=.1,i="ui",s=1,r=0){if(!this.enabled||this.muted||!this.ctx)return;this.ctx.state==="suspended"&&this.unlocked&&this.ctx.resume().catch(()=>{});const n=this.presets[this.preset],a=this.ctx.currentTime,o=this.ctx.createOscillator(),l=this.ctx.createGain(),c=this.ctx.createStereoPanner?this.ctx.createStereoPanner():null,h=this.ctx.createBiquadFilter();o.type=n.type,o.frequency.setValueAtTime(t,a);const d=n.filter||{type:"lowpass",freq:6e3,q:.7};h.type=d.type,h.frequency.setValueAtTime(d.freq,a),h.Q.setValueAtTime(d.q,a);const u=n.attack,p=n.decay,f=n.sustain,g=n.release,m=n.gain*s;l.gain.setValueAtTime(1e-4,a),l.gain.linearRampToValueAtTime(m,a+u),l.gain.linearRampToValueAtTime(m*f,a+u+p);const y=Math.max(a+u+p,a+e-g);l.gain.setValueAtTime(m*f,y),l.gain.exponentialRampToValueAtTime(1e-4,a+e),o.connect(h),h.connect(l),c?(c.pan.setValueAtTime(Math.max(-1,Math.min(1,r)),a),l.connect(c),c.connect(this._busNode(i))):l.connect(this._busNode(i)),o.start(a),o.stop(a+e+.02)},play(t,e={}){if(!this.enabled||this.muted||(this.init(),!this.ctx))return;const i=this.events[t];if(!i||!this._cooldownOk(t))return;const s=e.channel||i.ch||"ui",r=typeof e.dur=="number"?e.dur:i.dur||.08;if(i.kind==="tick"){const n=e.freq||i.freq||392;this.playNote(n,r,s,e.gainMul||1,e.pan||0);return}if(i.kind==="chord"||i.kind==="major"){const n=i.notes||[261.63,329.63];n.forEach((a,o)=>this.playNote(a,r,s,.9,(e.panBase||0)+(o-(n.length-1)/2)*.15));return}if(i.kind==="arpeggio"){(i.notes||[261.63,329.63,392]).forEach((a,o)=>{setTimeout(()=>this.playNote(a,r,s,.85,(e.panBase||0)+(o-1)*.12),o*85)});return}i.kind==="down"&&(i.notes||[392,329.63]).forEach((a,o)=>{setTimeout(()=>this.playNote(a,r,s,.85,0),o*90)})},playCompare(t,e,i,s=0){const r=this.valueToFreq((t+e)/2,0,i);this.playNote(r,.07,"ui",.75,s)},playSwap(t,e,i,s=0){const r=this.valueToFreq(Math.max(t,e),0,i);this.playNote(r,.11,"ui",.95,s)},playSweepSound(t,e){const i=180+t/Math.max(1,e)*680;this.playNote(i,.05,"feedback",.65,t/Math.max(1,e)*.6-.3)},playCompletionMelody(){const t=[261.63,329.63,392,523.25,659.25,783.99];t.forEach((e,i)=>setTimeout(()=>this.playNote(e,.22,"feedback",.95),i*100)),setTimeout(()=>{[523.25,659.25,783.99].forEach(e=>this.playNote(e,.6,"feedback",.85))},t.length*100+50)},updateUI(){const t=v("soundToggle"),e=v("soundPresets"),i=v("currentPreset");if(!t)return;if(this.enabled&&!this.muted){t.classList.add("active");const n=t.querySelector(".icon"),a=t.querySelector(".label");n&&(n.textContent="ðŸ”Š"),a&&(a.textContent="Sound On"),i&&(i.style.display="inline",i.textContent=this.preset.charAt(0).toUpperCase()+this.preset.slice(1)),e&&(e.style.display="flex")}else{t.classList.remove("active");const n=t.querySelector(".icon"),a=t.querySelector(".label");n&&(n.textContent="ðŸ”‡"),a&&(a.textContent="Sound Off"),i&&(i.style.display="none"),e&&(e.style.display="none")}Jn(".preset-btn").forEach(n=>n.classList.toggle("active",n.dataset.preset===this.preset));const s=v("volumeSlider"),r=v("volumeLabel");s&&(s.value=Math.round(this.volume*100)),r&&(r.textContent=`${Math.round(this.volume*100)}%`)}};typeof window<"u"&&(window.AudioEngine=O);const Ei={currentTheme:"light",init(){document.documentElement.setAttribute("data-color-theme","sunset"),this.currentTheme="light";const t=window.matchMedia("(prefers-color-scheme: dark)").matches;(localStorage.getItem("cse-helper-theme")==="dark"||t)&&(this.currentTheme="dark"),this.applyTheme(this.currentTheme),localStorage.setItem("cse-helper-color-theme","sunset"),this.bindEvents(),window.matchMedia("(prefers-color-scheme: dark)").addEventListener("change",e=>{localStorage.getItem("cse-helper-theme")||this.applyTheme(e.matches?"dark":"light")})},applyTheme(t){this.currentTheme=t,t==="dark"?document.documentElement.setAttribute("data-theme","dark"):document.documentElement.removeAttribute("data-theme"),this.updateUI()},toggle(){const t=this.currentTheme==="light"?"dark":"light";this.applyTheme(t),localStorage.setItem("cse-helper-theme",t),typeof O<"u"&&O.enabled&&O.play("nav_switch"),typeof window.showToast=="function"&&window.showToast(t==="dark"?"ðŸŒ™ Dark mode enabled":"â˜€ï¸ Light mode enabled")},updateUI(){const t=document.getElementById("themeLabel"),e=document.getElementById("themeToggleBtn");t&&(t.textContent=this.currentTheme==="dark"?"Dark":"Light"),e&&e.setAttribute("aria-checked",this.currentTheme==="dark"?"true":"false")},bindEvents(){const t=document.getElementById("themeToggleBtn");t&&(t.addEventListener("click",()=>this.toggle()),t.addEventListener("keydown",r=>{(r.key==="Enter"||r.key===" ")&&(r.preventDefault(),this.toggle())})),document.querySelectorAll(".color-theme-btn").forEach(r=>{r.addEventListener("click",()=>{const n=r.dataset.color;this.setColorTheme(n)})});const i=localStorage.getItem("cse-helper-color-theme");i&&this.setColorTheme(i,!1);const s=document.getElementById("btnTheme");s&&s.addEventListener("click",()=>this.toggle())},setColorTheme(t,e=!0){t!=="sunset"&&(console.warn("Theme switching is disabled. Enforcing Sunset."),t="sunset"),document.documentElement.setAttribute("data-color-theme","sunset"),localStorage.setItem("cse-helper-color-theme","sunset"),document.querySelectorAll(".color-theme-btn").forEach(s=>{const r=s.dataset.color==="sunset";s.classList.toggle("active",r),s.setAttribute("aria-pressed",r?"true":"false")})}};typeof window<"u"&&(window.ThemeManager=Ei);function T(t,e="success"){const i=v("toast");i&&(i.textContent=t,i.className=`toast ${e}`,e==="error"&&i.classList.add("shake-error"),i.classList.add("show"),typeof O<"u"&&O.enabled&&O.play(e==="error"?"toast_error":"toast_success"),setTimeout(()=>{i.classList.remove("show"),i.classList.remove("shake-error")},2500))}typeof window<"u"&&(window.showToast=T);function il(t,e){var i={};for(var s in t)Object.prototype.hasOwnProperty.call(t,s)&&e.indexOf(s)<0&&(i[s]=t[s]);if(t!=null&&typeof Object.getOwnPropertySymbols=="function")for(var r=0,s=Object.getOwnPropertySymbols(t);r<s.length;r++)e.indexOf(s[r])<0&&Object.prototype.propertyIsEnumerable.call(t,s[r])&&(i[s[r]]=t[s[r]]);return i}function $v(t,e,i,s){function r(n){return n instanceof i?n:new i(function(a){a(n)})}return new(i||(i=Promise))(function(n,a){function o(h){try{c(s.next(h))}catch(d){a(d)}}function l(h){try{c(s.throw(h))}catch(d){a(d)}}function c(h){h.done?n(h.value):r(h.value).then(o,l)}c((s=s.apply(t,e||[])).next())})}const Iv=t=>t?(...e)=>t(...e):(...e)=>fetch(...e);class ed extends Error{constructor(e,i="FunctionsError",s){super(e),this.name=i,this.context=s}}class Qv extends ed{constructor(e){super("Failed to send a request to the Edge Function","FunctionsFetchError",e)}}class Ru extends ed{constructor(e){super("Relay Error invoking the Edge Function","FunctionsRelayError",e)}}class $u extends ed{constructor(e){super("Edge Function returned a non-2xx status code","FunctionsHttpError",e)}}var Dc;(function(t){t.Any="any",t.ApNortheast1="ap-northeast-1",t.ApNortheast2="ap-northeast-2",t.ApSouth1="ap-south-1",t.ApSoutheast1="ap-southeast-1",t.ApSoutheast2="ap-southeast-2",t.CaCentral1="ca-central-1",t.EuCentral1="eu-central-1",t.EuWest1="eu-west-1",t.EuWest2="eu-west-2",t.EuWest3="eu-west-3",t.SaEast1="sa-east-1",t.UsEast1="us-east-1",t.UsWest1="us-west-1",t.UsWest2="us-west-2"})(Dc||(Dc={}));class Av{constructor(e,{headers:i={},customFetch:s,region:r=Dc.Any}={}){this.url=e,this.headers=i,this.region=r,this.fetch=Iv(s)}setAuth(e){this.headers.Authorization=`Bearer ${e}`}invoke(e){return $v(this,arguments,void 0,function*(i,s={}){var r;let n,a;try{const{headers:o,method:l,body:c,signal:h,timeout:d}=s;let u={},{region:p}=s;p||(p=this.region);const f=new URL(`${this.url}/${i}`);p&&p!=="any"&&(u["x-region"]=p,f.searchParams.set("forceFunctionRegion",p));let g;c&&(o&&!Object.prototype.hasOwnProperty.call(o,"Content-Type")||!o)?typeof Blob<"u"&&c instanceof Blob||c instanceof ArrayBuffer?(u["Content-Type"]="application/octet-stream",g=c):typeof c=="string"?(u["Content-Type"]="text/plain",g=c):typeof FormData<"u"&&c instanceof FormData?g=c:(u["Content-Type"]="application/json",g=JSON.stringify(c)):c&&typeof c!="string"&&!(typeof Blob<"u"&&c instanceof Blob)&&!(c instanceof ArrayBuffer)&&!(typeof FormData<"u"&&c instanceof FormData)?g=JSON.stringify(c):g=c;let m=h;d&&(a=new AbortController,n=setTimeout(()=>a.abort(),d),h?(m=a.signal,h.addEventListener("abort",()=>a.abort())):m=a.signal);const y=yield this.fetch(f.toString(),{method:l||"POST",headers:Object.assign(Object.assign(Object.assign({},u),this.headers),o),body:g,signal:m}).catch(x=>{throw new Qv(x)}),b=y.headers.get("x-relay-error");if(b&&b==="true")throw new Ru(y);if(!y.ok)throw new $u(y);let w=((r=y.headers.get("Content-Type"))!==null&&r!==void 0?r:"text/plain").split(";")[0].trim(),k;return w==="application/json"?k=yield y.json():w==="application/octet-stream"||w==="application/pdf"?k=yield y.blob():w==="text/event-stream"?k=y:w==="multipart/form-data"?k=yield y.formData():k=yield y.text(),{data:k,error:null,response:y}}catch(o){return{data:null,error:o,response:o instanceof $u||o instanceof Ru?o.context:void 0}}finally{n&&clearTimeout(n)}})}}var Lv=class extends Error{constructor(t){super(t.message),this.name="PostgrestError",this.details=t.details,this.hint=t.hint,this.code=t.code}},Nv=class{constructor(t){var e,i;this.shouldThrowOnError=!1,this.method=t.method,this.url=t.url,this.headers=new Headers(t.headers),this.schema=t.schema,this.body=t.body,this.shouldThrowOnError=(e=t.shouldThrowOnError)!==null&&e!==void 0?e:!1,this.signal=t.signal,this.isMaybeSingle=(i=t.isMaybeSingle)!==null&&i!==void 0?i:!1,t.fetch?this.fetch=t.fetch:this.fetch=fetch}throwOnError(){return this.shouldThrowOnError=!0,this}setHeader(t,e){return this.headers=new Headers(this.headers),this.headers.set(t,e),this}then(t,e){var i=this;this.schema===void 0||(["GET","HEAD"].includes(this.method)?this.headers.set("Accept-Profile",this.schema):this.headers.set("Content-Profile",this.schema)),this.method!=="GET"&&this.method!=="HEAD"&&this.headers.set("Content-Type","application/json");const s=this.fetch;let r=s(this.url.toString(),{method:this.method,headers:this.headers,body:JSON.stringify(this.body),signal:this.signal}).then(async n=>{let a=null,o=null,l=null,c=n.status,h=n.statusText;if(n.ok){var d,u;if(i.method!=="HEAD"){var p;const y=await n.text();y===""||(i.headers.get("Accept")==="text/csv"||i.headers.get("Accept")&&(!((p=i.headers.get("Accept"))===null||p===void 0)&&p.includes("application/vnd.pgrst.plan+text"))?o=y:o=JSON.parse(y))}const g=(d=i.headers.get("Prefer"))===null||d===void 0?void 0:d.match(/count=(exact|planned|estimated)/),m=(u=n.headers.get("content-range"))===null||u===void 0?void 0:u.split("/");g&&m&&m.length>1&&(l=parseInt(m[1])),i.isMaybeSingle&&i.method==="GET"&&Array.isArray(o)&&(o.length>1?(a={code:"PGRST116",details:`Results contain ${o.length} rows, application/vnd.pgrst.object+json requires 1 row`,hint:null,message:"JSON object requested, multiple (or no) rows returned"},o=null,l=null,c=406,h="Not Acceptable"):o.length===1?o=o[0]:o=null)}else{var f;const g=await n.text();try{a=JSON.parse(g),Array.isArray(a)&&n.status===404&&(o=[],a=null,c=200,h="OK")}catch{n.status===404&&g===""?(c=204,h="No Content"):a={message:g}}if(a&&i.isMaybeSingle&&(!(a==null||(f=a.details)===null||f===void 0)&&f.includes("0 rows"))&&(a=null,c=200,h="OK"),a&&i.shouldThrowOnError)throw new Lv(a)}return{error:a,data:o,count:l,status:c,statusText:h}});return this.shouldThrowOnError||(r=r.catch(n=>{var a;let o="";const l=n==null?void 0:n.cause;if(l){var c,h,d,u;const f=(c=l==null?void 0:l.message)!==null&&c!==void 0?c:"",g=(h=l==null?void 0:l.code)!==null&&h!==void 0?h:"";o=`${(d=n==null?void 0:n.name)!==null&&d!==void 0?d:"FetchError"}: ${n==null?void 0:n.message}`,o+=`

Caused by: ${(u=l==null?void 0:l.name)!==null&&u!==void 0?u:"Error"}: ${f}`,g&&(o+=` (${g})`),l!=null&&l.stack&&(o+=`
${l.stack}`)}else{var p;o=(p=n==null?void 0:n.stack)!==null&&p!==void 0?p:""}return{error:{message:`${(a=n==null?void 0:n.name)!==null&&a!==void 0?a:"FetchError"}: ${n==null?void 0:n.message}`,details:o,hint:"",code:""},data:null,count:null,status:0,statusText:""}})),r.then(t,e)}returns(){return this}overrideTypes(){return this}},Mv=class extends Nv{select(t){let e=!1;const i=(t??"*").split("").map(s=>/\s/.test(s)&&!e?"":(s==='"'&&(e=!e),s)).join("");return this.url.searchParams.set("select",i),this.headers.append("Prefer","return=representation"),this}order(t,{ascending:e=!0,nullsFirst:i,foreignTable:s,referencedTable:r=s}={}){const n=r?`${r}.order`:"order",a=this.url.searchParams.get(n);return this.url.searchParams.set(n,`${a?`${a},`:""}${t}.${e?"asc":"desc"}${i===void 0?"":i?".nullsfirst":".nullslast"}`),this}limit(t,{foreignTable:e,referencedTable:i=e}={}){const s=typeof i>"u"?"limit":`${i}.limit`;return this.url.searchParams.set(s,`${t}`),this}range(t,e,{foreignTable:i,referencedTable:s=i}={}){const r=typeof s>"u"?"offset":`${s}.offset`,n=typeof s>"u"?"limit":`${s}.limit`;return this.url.searchParams.set(r,`${t}`),this.url.searchParams.set(n,`${e-t+1}`),this}abortSignal(t){return this.signal=t,this}single(){return this.headers.set("Accept","application/vnd.pgrst.object+json"),this}maybeSingle(){return this.method==="GET"?this.headers.set("Accept","application/json"):this.headers.set("Accept","application/vnd.pgrst.object+json"),this.isMaybeSingle=!0,this}csv(){return this.headers.set("Accept","text/csv"),this}geojson(){return this.headers.set("Accept","application/geo+json"),this}explain({analyze:t=!1,verbose:e=!1,settings:i=!1,buffers:s=!1,wal:r=!1,format:n="text"}={}){var a;const o=[t?"analyze":null,e?"verbose":null,i?"settings":null,s?"buffers":null,r?"wal":null].filter(Boolean).join("|"),l=(a=this.headers.get("Accept"))!==null&&a!==void 0?a:"application/json";return this.headers.set("Accept",`application/vnd.pgrst.plan+${n}; for="${l}"; options=${o};`),n==="json"?this:this}rollback(){return this.headers.append("Prefer","tx=rollback"),this}returns(){return this}maxAffected(t){return this.headers.append("Prefer","handling=strict"),this.headers.append("Prefer",`max-affected=${t}`),this}};const Iu=new RegExp("[,()]");var Pr=class extends Mv{eq(t,e){return this.url.searchParams.append(t,`eq.${e}`),this}neq(t,e){return this.url.searchParams.append(t,`neq.${e}`),this}gt(t,e){return this.url.searchParams.append(t,`gt.${e}`),this}gte(t,e){return this.url.searchParams.append(t,`gte.${e}`),this}lt(t,e){return this.url.searchParams.append(t,`lt.${e}`),this}lte(t,e){return this.url.searchParams.append(t,`lte.${e}`),this}like(t,e){return this.url.searchParams.append(t,`like.${e}`),this}likeAllOf(t,e){return this.url.searchParams.append(t,`like(all).{${e.join(",")}}`),this}likeAnyOf(t,e){return this.url.searchParams.append(t,`like(any).{${e.join(",")}}`),this}ilike(t,e){return this.url.searchParams.append(t,`ilike.${e}`),this}ilikeAllOf(t,e){return this.url.searchParams.append(t,`ilike(all).{${e.join(",")}}`),this}ilikeAnyOf(t,e){return this.url.searchParams.append(t,`ilike(any).{${e.join(",")}}`),this}regexMatch(t,e){return this.url.searchParams.append(t,`match.${e}`),this}regexIMatch(t,e){return this.url.searchParams.append(t,`imatch.${e}`),this}is(t,e){return this.url.searchParams.append(t,`is.${e}`),this}isDistinct(t,e){return this.url.searchParams.append(t,`isdistinct.${e}`),this}in(t,e){const i=Array.from(new Set(e)).map(s=>typeof s=="string"&&Iu.test(s)?`"${s}"`:`${s}`).join(",");return this.url.searchParams.append(t,`in.(${i})`),this}notIn(t,e){const i=Array.from(new Set(e)).map(s=>typeof s=="string"&&Iu.test(s)?`"${s}"`:`${s}`).join(",");return this.url.searchParams.append(t,`not.in.(${i})`),this}contains(t,e){return typeof e=="string"?this.url.searchParams.append(t,`cs.${e}`):Array.isArray(e)?this.url.searchParams.append(t,`cs.{${e.join(",")}}`):this.url.searchParams.append(t,`cs.${JSON.stringify(e)}`),this}containedBy(t,e){return typeof e=="string"?this.url.searchParams.append(t,`cd.${e}`):Array.isArray(e)?this.url.searchParams.append(t,`cd.{${e.join(",")}}`):this.url.searchParams.append(t,`cd.${JSON.stringify(e)}`),this}rangeGt(t,e){return this.url.searchParams.append(t,`sr.${e}`),this}rangeGte(t,e){return this.url.searchParams.append(t,`nxl.${e}`),this}rangeLt(t,e){return this.url.searchParams.append(t,`sl.${e}`),this}rangeLte(t,e){return this.url.searchParams.append(t,`nxr.${e}`),this}rangeAdjacent(t,e){return this.url.searchParams.append(t,`adj.${e}`),this}overlaps(t,e){return typeof e=="string"?this.url.searchParams.append(t,`ov.${e}`):this.url.searchParams.append(t,`ov.{${e.join(",")}}`),this}textSearch(t,e,{config:i,type:s}={}){let r="";s==="plain"?r="pl":s==="phrase"?r="ph":s==="websearch"&&(r="w");const n=i===void 0?"":`(${i})`;return this.url.searchParams.append(t,`${r}fts${n}.${e}`),this}match(t){return Object.entries(t).forEach(([e,i])=>{this.url.searchParams.append(e,`eq.${i}`)}),this}not(t,e,i){return this.url.searchParams.append(t,`not.${e}.${i}`),this}or(t,{foreignTable:e,referencedTable:i=e}={}){const s=i?`${i}.or`:"or";return this.url.searchParams.append(s,`(${t})`),this}filter(t,e,i){return this.url.searchParams.append(t,`${e}.${i}`),this}},qv=class{constructor(t,{headers:e={},schema:i,fetch:s}){this.url=t,this.headers=new Headers(e),this.schema=i,this.fetch=s}cloneRequestState(){return{url:new URL(this.url.toString()),headers:new Headers(this.headers)}}select(t,e){const{head:i=!1,count:s}=e??{},r=i?"HEAD":"GET";let n=!1;const a=(t??"*").split("").map(c=>/\s/.test(c)&&!n?"":(c==='"'&&(n=!n),c)).join(""),{url:o,headers:l}=this.cloneRequestState();return o.searchParams.set("select",a),s&&l.append("Prefer",`count=${s}`),new Pr({method:r,url:o,headers:l,schema:this.schema,fetch:this.fetch})}insert(t,{count:e,defaultToNull:i=!0}={}){var s;const r="POST",{url:n,headers:a}=this.cloneRequestState();if(e&&a.append("Prefer",`count=${e}`),i||a.append("Prefer","missing=default"),Array.isArray(t)){const o=t.reduce((l,c)=>l.concat(Object.keys(c)),[]);if(o.length>0){const l=[...new Set(o)].map(c=>`"${c}"`);n.searchParams.set("columns",l.join(","))}}return new Pr({method:r,url:n,headers:a,schema:this.schema,body:t,fetch:(s=this.fetch)!==null&&s!==void 0?s:fetch})}upsert(t,{onConflict:e,ignoreDuplicates:i=!1,count:s,defaultToNull:r=!0}={}){var n;const a="POST",{url:o,headers:l}=this.cloneRequestState();if(l.append("Prefer",`resolution=${i?"ignore":"merge"}-duplicates`),e!==void 0&&o.searchParams.set("on_conflict",e),s&&l.append("Prefer",`count=${s}`),r||l.append("Prefer","missing=default"),Array.isArray(t)){const c=t.reduce((h,d)=>h.concat(Object.keys(d)),[]);if(c.length>0){const h=[...new Set(c)].map(d=>`"${d}"`);o.searchParams.set("columns",h.join(","))}}return new Pr({method:a,url:o,headers:l,schema:this.schema,body:t,fetch:(n=this.fetch)!==null&&n!==void 0?n:fetch})}update(t,{count:e}={}){var i;const s="PATCH",{url:r,headers:n}=this.cloneRequestState();return e&&n.append("Prefer",`count=${e}`),new Pr({method:s,url:r,headers:n,schema:this.schema,body:t,fetch:(i=this.fetch)!==null&&i!==void 0?i:fetch})}delete({count:t}={}){var e;const i="DELETE",{url:s,headers:r}=this.cloneRequestState();return t&&r.append("Prefer",`count=${t}`),new Pr({method:i,url:s,headers:r,schema:this.schema,fetch:(e=this.fetch)!==null&&e!==void 0?e:fetch})}},Dv=class vg{constructor(e,{headers:i={},schema:s,fetch:r}={}){this.url=e,this.headers=new Headers(i),this.schemaName=s,this.fetch=r}from(e){if(!e||typeof e!="string"||e.trim()==="")throw new Error("Invalid relation name: relation must be a non-empty string.");return new qv(new URL(`${this.url}/${e}`),{headers:new Headers(this.headers),schema:this.schemaName,fetch:this.fetch})}schema(e){return new vg(this.url,{headers:this.headers,schema:e,fetch:this.fetch})}rpc(e,i={},{head:s=!1,get:r=!1,count:n}={}){var a;let o;const l=new URL(`${this.url}/rpc/${e}`);let c;const h=p=>p!==null&&typeof p=="object"&&(!Array.isArray(p)||p.some(h)),d=s&&Object.values(i).some(h);d?(o="POST",c=i):s||r?(o=s?"HEAD":"GET",Object.entries(i).filter(([p,f])=>f!==void 0).map(([p,f])=>[p,Array.isArray(f)?`{${f.join(",")}}`:`${f}`]).forEach(([p,f])=>{l.searchParams.append(p,f)})):(o="POST",c=i);const u=new Headers(this.headers);return d?u.set("Prefer",n?`count=${n},return=minimal`:"return=minimal"):n&&u.set("Prefer",`count=${n}`),new Pr({method:o,url:l,headers:u,schema:this.schemaName,body:c,fetch:(a=this.fetch)!==null&&a!==void 0?a:fetch})}};class Bv{constructor(){}static detectEnvironment(){var e;if(typeof WebSocket<"u")return{type:"native",constructor:WebSocket};if(typeof globalThis<"u"&&typeof globalThis.WebSocket<"u")return{type:"native",constructor:globalThis.WebSocket};if(typeof global<"u"&&typeof global.WebSocket<"u")return{type:"native",constructor:global.WebSocket};if(typeof globalThis<"u"&&typeof globalThis.WebSocketPair<"u"&&typeof globalThis.WebSocket>"u")return{type:"cloudflare",error:"Cloudflare Workers detected. WebSocket clients are not supported in Cloudflare Workers.",workaround:"Use Cloudflare Workers WebSocket API for server-side WebSocket handling, or deploy to a different runtime."};if(typeof globalThis<"u"&&globalThis.EdgeRuntime||typeof navigator<"u"&&(!((e=navigator.userAgent)===null||e===void 0)&&e.includes("Vercel-Edge")))return{type:"unsupported",error:"Edge runtime detected (Vercel Edge/Netlify Edge). WebSockets are not supported in edge functions.",workaround:"Use serverless functions or a different deployment target for WebSocket functionality."};const i=globalThis.process;if(i){const s=i.versions;if(s&&s.node){const r=s.node,n=parseInt(r.replace(/^v/,"").split(".")[0]);return n>=22?typeof globalThis.WebSocket<"u"?{type:"native",constructor:globalThis.WebSocket}:{type:"unsupported",error:`Node.js ${n} detected but native WebSocket not found.`,workaround:"Provide a WebSocket implementation via the transport option."}:{type:"unsupported",error:`Node.js ${n} detected without native WebSocket support.`,workaround:`For Node.js < 22, install "ws" package and provide it via the transport option:
import ws from "ws"
new RealtimeClient(url, { transport: ws })`}}}return{type:"unsupported",error:"Unknown JavaScript runtime without WebSocket support.",workaround:"Ensure you're running in a supported environment (browser, Node.js, Deno) or provide a custom WebSocket implementation."}}static getWebSocketConstructor(){const e=this.detectEnvironment();if(e.constructor)return e.constructor;let i=e.error||"WebSocket not supported in this environment.";throw e.workaround&&(i+=`

Suggested solution: ${e.workaround}`),new Error(i)}static createWebSocket(e,i){const s=this.getWebSocketConstructor();return new s(e,i)}static isWebSocketSupported(){try{const e=this.detectEnvironment();return e.type==="native"||e.type==="ws"}catch{return!1}}}const jv="2.93.1",Wv=`realtime-js/${jv}`,Fv="1.0.0",bg="2.0.0",Qu=bg,Bc=1e4,Uv=1e3,Vv=100;var ps;(function(t){t[t.connecting=0]="connecting",t[t.open=1]="open",t[t.closing=2]="closing",t[t.closed=3]="closed"})(ps||(ps={}));var st;(function(t){t.closed="closed",t.errored="errored",t.joined="joined",t.joining="joining",t.leaving="leaving"})(st||(st={}));var ci;(function(t){t.close="phx_close",t.error="phx_error",t.join="phx_join",t.reply="phx_reply",t.leave="phx_leave",t.access_token="access_token"})(ci||(ci={}));var jc;(function(t){t.websocket="websocket"})(jc||(jc={}));var Ws;(function(t){t.Connecting="connecting",t.Open="open",t.Closing="closing",t.Closed="closed"})(Ws||(Ws={}));class zv{constructor(e){this.HEADER_LENGTH=1,this.USER_BROADCAST_PUSH_META_LENGTH=6,this.KINDS={userBroadcastPush:3,userBroadcast:4},this.BINARY_ENCODING=0,this.JSON_ENCODING=1,this.BROADCAST_EVENT="broadcast",this.allowedMetadataKeys=[],this.allowedMetadataKeys=e??[]}encode(e,i){if(e.event===this.BROADCAST_EVENT&&!(e.payload instanceof ArrayBuffer)&&typeof e.payload.event=="string")return i(this._binaryEncodeUserBroadcastPush(e));let s=[e.join_ref,e.ref,e.topic,e.event,e.payload];return i(JSON.stringify(s))}_binaryEncodeUserBroadcastPush(e){var i;return this._isArrayBuffer((i=e.payload)===null||i===void 0?void 0:i.payload)?this._encodeBinaryUserBroadcastPush(e):this._encodeJsonUserBroadcastPush(e)}_encodeBinaryUserBroadcastPush(e){var i,s;const r=(s=(i=e.payload)===null||i===void 0?void 0:i.payload)!==null&&s!==void 0?s:new ArrayBuffer(0);return this._encodeUserBroadcastPush(e,this.BINARY_ENCODING,r)}_encodeJsonUserBroadcastPush(e){var i,s;const r=(s=(i=e.payload)===null||i===void 0?void 0:i.payload)!==null&&s!==void 0?s:{},a=new TextEncoder().encode(JSON.stringify(r)).buffer;return this._encodeUserBroadcastPush(e,this.JSON_ENCODING,a)}_encodeUserBroadcastPush(e,i,s){var r,n;const a=e.topic,o=(r=e.ref)!==null&&r!==void 0?r:"",l=(n=e.join_ref)!==null&&n!==void 0?n:"",c=e.payload.event,h=this.allowedMetadataKeys?this._pick(e.payload,this.allowedMetadataKeys):{},d=Object.keys(h).length===0?"":JSON.stringify(h);if(l.length>255)throw new Error(`joinRef length ${l.length} exceeds maximum of 255`);if(o.length>255)throw new Error(`ref length ${o.length} exceeds maximum of 255`);if(a.length>255)throw new Error(`topic length ${a.length} exceeds maximum of 255`);if(c.length>255)throw new Error(`userEvent length ${c.length} exceeds maximum of 255`);if(d.length>255)throw new Error(`metadata length ${d.length} exceeds maximum of 255`);const u=this.USER_BROADCAST_PUSH_META_LENGTH+l.length+o.length+a.length+c.length+d.length,p=new ArrayBuffer(this.HEADER_LENGTH+u);let f=new DataView(p),g=0;f.setUint8(g++,this.KINDS.userBroadcastPush),f.setUint8(g++,l.length),f.setUint8(g++,o.length),f.setUint8(g++,a.length),f.setUint8(g++,c.length),f.setUint8(g++,d.length),f.setUint8(g++,i),Array.from(l,y=>f.setUint8(g++,y.charCodeAt(0))),Array.from(o,y=>f.setUint8(g++,y.charCodeAt(0))),Array.from(a,y=>f.setUint8(g++,y.charCodeAt(0))),Array.from(c,y=>f.setUint8(g++,y.charCodeAt(0))),Array.from(d,y=>f.setUint8(g++,y.charCodeAt(0)));var m=new Uint8Array(p.byteLength+s.byteLength);return m.set(new Uint8Array(p),0),m.set(new Uint8Array(s),p.byteLength),m.buffer}decode(e,i){if(this._isArrayBuffer(e)){let s=this._binaryDecode(e);return i(s)}if(typeof e=="string"){const s=JSON.parse(e),[r,n,a,o,l]=s;return i({join_ref:r,ref:n,topic:a,event:o,payload:l})}return i({})}_binaryDecode(e){const i=new DataView(e),s=i.getUint8(0),r=new TextDecoder;switch(s){case this.KINDS.userBroadcast:return this._decodeUserBroadcast(e,i,r)}}_decodeUserBroadcast(e,i,s){const r=i.getUint8(1),n=i.getUint8(2),a=i.getUint8(3),o=i.getUint8(4);let l=this.HEADER_LENGTH+4;const c=s.decode(e.slice(l,l+r));l=l+r;const h=s.decode(e.slice(l,l+n));l=l+n;const d=s.decode(e.slice(l,l+a));l=l+a;const u=e.slice(l,e.byteLength),p=o===this.JSON_ENCODING?JSON.parse(s.decode(u)):u,f={type:this.BROADCAST_EVENT,event:h,payload:p};return a>0&&(f.meta=JSON.parse(d)),{join_ref:null,ref:null,topic:c,event:this.BROADCAST_EVENT,payload:f}}_isArrayBuffer(e){var i;return e instanceof ArrayBuffer||((i=e==null?void 0:e.constructor)===null||i===void 0?void 0:i.name)==="ArrayBuffer"}_pick(e,i){return!e||typeof e!="object"?{}:Object.fromEntries(Object.entries(e).filter(([s])=>i.includes(s)))}}class wg{constructor(e,i){this.callback=e,this.timerCalc=i,this.timer=void 0,this.tries=0,this.callback=e,this.timerCalc=i}reset(){this.tries=0,clearTimeout(this.timer),this.timer=void 0}scheduleTimeout(){clearTimeout(this.timer),this.timer=setTimeout(()=>{this.tries=this.tries+1,this.callback()},this.timerCalc(this.tries+1))}}var Ne;(function(t){t.abstime="abstime",t.bool="bool",t.date="date",t.daterange="daterange",t.float4="float4",t.float8="float8",t.int2="int2",t.int4="int4",t.int4range="int4range",t.int8="int8",t.int8range="int8range",t.json="json",t.jsonb="jsonb",t.money="money",t.numeric="numeric",t.oid="oid",t.reltime="reltime",t.text="text",t.time="time",t.timestamp="timestamp",t.timestamptz="timestamptz",t.timetz="timetz",t.tsrange="tsrange",t.tstzrange="tstzrange"})(Ne||(Ne={}));const Au=(t,e,i={})=>{var s;const r=(s=i.skipTypes)!==null&&s!==void 0?s:[];return e?Object.keys(e).reduce((n,a)=>(n[a]=Xv(a,t,e,r),n),{}):{}},Xv=(t,e,i,s)=>{const r=e.find(o=>o.name===t),n=r==null?void 0:r.type,a=i[t];return n&&!s.includes(n)?Sg(n,a):Wc(a)},Sg=(t,e)=>{if(t.charAt(0)==="_"){const i=t.slice(1,t.length);return Hv(e,i)}switch(t){case Ne.bool:return Gv(e);case Ne.float4:case Ne.float8:case Ne.int2:case Ne.int4:case Ne.int8:case Ne.numeric:case Ne.oid:return Yv(e);case Ne.json:case Ne.jsonb:return Zv(e);case Ne.timestamp:return Kv(e);case Ne.abstime:case Ne.date:case Ne.daterange:case Ne.int4range:case Ne.int8range:case Ne.money:case Ne.reltime:case Ne.text:case Ne.time:case Ne.timestamptz:case Ne.timetz:case Ne.tsrange:case Ne.tstzrange:return Wc(e);default:return Wc(e)}},Wc=t=>t,Gv=t=>{switch(t){case"t":return!0;case"f":return!1;default:return t}},Yv=t=>{if(typeof t=="string"){const e=parseFloat(t);if(!Number.isNaN(e))return e}return t},Zv=t=>{if(typeof t=="string")try{return JSON.parse(t)}catch{return t}return t},Hv=(t,e)=>{if(typeof t!="string")return t;const i=t.length-1,s=t[i];if(t[0]==="{"&&s==="}"){let n;const a=t.slice(1,i);try{n=JSON.parse("["+a+"]")}catch{n=a?a.split(","):[]}return n.map(o=>Sg(e,o))}return t},Kv=t=>typeof t=="string"?t.replace(" ","T"):t,xg=t=>{const e=new URL(t);return e.protocol=e.protocol.replace(/^ws/i,"http"),e.pathname=e.pathname.replace(/\/+$/,"").replace(/\/socket\/websocket$/i,"").replace(/\/socket$/i,"").replace(/\/websocket$/i,""),e.pathname===""||e.pathname==="/"?e.pathname="/api/broadcast":e.pathname=e.pathname+"/api/broadcast",e.href};class Kl{constructor(e,i,s={},r=Bc){this.channel=e,this.event=i,this.payload=s,this.timeout=r,this.sent=!1,this.timeoutTimer=void 0,this.ref="",this.receivedResp=null,this.recHooks=[],this.refEvent=null}resend(e){this.timeout=e,this._cancelRefEvent(),this.ref="",this.refEvent=null,this.receivedResp=null,this.sent=!1,this.send()}send(){this._hasReceived("timeout")||(this.startTimeout(),this.sent=!0,this.channel.socket.push({topic:this.channel.topic,event:this.event,payload:this.payload,ref:this.ref,join_ref:this.channel._joinRef()}))}updatePayload(e){this.payload=Object.assign(Object.assign({},this.payload),e)}receive(e,i){var s;return this._hasReceived(e)&&i((s=this.receivedResp)===null||s===void 0?void 0:s.response),this.recHooks.push({status:e,callback:i}),this}startTimeout(){if(this.timeoutTimer)return;this.ref=this.channel.socket._makeRef(),this.refEvent=this.channel._replyEventName(this.ref);const e=i=>{this._cancelRefEvent(),this._cancelTimeout(),this.receivedResp=i,this._matchReceive(i)};this.channel._on(this.refEvent,{},e),this.timeoutTimer=setTimeout(()=>{this.trigger("timeout",{})},this.timeout)}trigger(e,i){this.refEvent&&this.channel._trigger(this.refEvent,{status:e,response:i})}destroy(){this._cancelRefEvent(),this._cancelTimeout()}_cancelRefEvent(){this.refEvent&&this.channel._off(this.refEvent,{})}_cancelTimeout(){clearTimeout(this.timeoutTimer),this.timeoutTimer=void 0}_matchReceive({status:e,response:i}){this.recHooks.filter(s=>s.status===e).forEach(s=>s.callback(i))}_hasReceived(e){return this.receivedResp&&this.receivedResp.status===e}}var Lu;(function(t){t.SYNC="sync",t.JOIN="join",t.LEAVE="leave"})(Lu||(Lu={}));class Bn{constructor(e,i){this.channel=e,this.state={},this.pendingDiffs=[],this.joinRef=null,this.enabled=!1,this.caller={onJoin:()=>{},onLeave:()=>{},onSync:()=>{}};const s=(i==null?void 0:i.events)||{state:"presence_state",diff:"presence_diff"};this.channel._on(s.state,{},r=>{const{onJoin:n,onLeave:a,onSync:o}=this.caller;this.joinRef=this.channel._joinRef(),this.state=Bn.syncState(this.state,r,n,a),this.pendingDiffs.forEach(l=>{this.state=Bn.syncDiff(this.state,l,n,a)}),this.pendingDiffs=[],o()}),this.channel._on(s.diff,{},r=>{const{onJoin:n,onLeave:a,onSync:o}=this.caller;this.inPendingSyncState()?this.pendingDiffs.push(r):(this.state=Bn.syncDiff(this.state,r,n,a),o())}),this.onJoin((r,n,a)=>{this.channel._trigger("presence",{event:"join",key:r,currentPresences:n,newPresences:a})}),this.onLeave((r,n,a)=>{this.channel._trigger("presence",{event:"leave",key:r,currentPresences:n,leftPresences:a})}),this.onSync(()=>{this.channel._trigger("presence",{event:"sync"})})}static syncState(e,i,s,r){const n=this.cloneDeep(e),a=this.transformState(i),o={},l={};return this.map(n,(c,h)=>{a[c]||(l[c]=h)}),this.map(a,(c,h)=>{const d=n[c];if(d){const u=h.map(m=>m.presence_ref),p=d.map(m=>m.presence_ref),f=h.filter(m=>p.indexOf(m.presence_ref)<0),g=d.filter(m=>u.indexOf(m.presence_ref)<0);f.length>0&&(o[c]=f),g.length>0&&(l[c]=g)}else o[c]=h}),this.syncDiff(n,{joins:o,leaves:l},s,r)}static syncDiff(e,i,s,r){const{joins:n,leaves:a}={joins:this.transformState(i.joins),leaves:this.transformState(i.leaves)};return s||(s=()=>{}),r||(r=()=>{}),this.map(n,(o,l)=>{var c;const h=(c=e[o])!==null&&c!==void 0?c:[];if(e[o]=this.cloneDeep(l),h.length>0){const d=e[o].map(p=>p.presence_ref),u=h.filter(p=>d.indexOf(p.presence_ref)<0);e[o].unshift(...u)}s(o,h,l)}),this.map(a,(o,l)=>{let c=e[o];if(!c)return;const h=l.map(d=>d.presence_ref);c=c.filter(d=>h.indexOf(d.presence_ref)<0),e[o]=c,r(o,c,l),c.length===0&&delete e[o]}),e}static map(e,i){return Object.getOwnPropertyNames(e).map(s=>i(s,e[s]))}static transformState(e){return e=this.cloneDeep(e),Object.getOwnPropertyNames(e).reduce((i,s)=>{const r=e[s];return"metas"in r?i[s]=r.metas.map(n=>(n.presence_ref=n.phx_ref,delete n.phx_ref,delete n.phx_ref_prev,n)):i[s]=r,i},{})}static cloneDeep(e){return JSON.parse(JSON.stringify(e))}onJoin(e){this.caller.onJoin=e}onLeave(e){this.caller.onLeave=e}onSync(e){this.caller.onSync=e}inPendingSyncState(){return!this.joinRef||this.joinRef!==this.channel._joinRef()}}var Nu;(function(t){t.ALL="*",t.INSERT="INSERT",t.UPDATE="UPDATE",t.DELETE="DELETE"})(Nu||(Nu={}));var jn;(function(t){t.BROADCAST="broadcast",t.PRESENCE="presence",t.POSTGRES_CHANGES="postgres_changes",t.SYSTEM="system"})(jn||(jn={}));var Gi;(function(t){t.SUBSCRIBED="SUBSCRIBED",t.TIMED_OUT="TIMED_OUT",t.CLOSED="CLOSED",t.CHANNEL_ERROR="CHANNEL_ERROR"})(Gi||(Gi={}));class Lr{constructor(e,i={config:{}},s){var r,n;if(this.topic=e,this.params=i,this.socket=s,this.bindings={},this.state=st.closed,this.joinedOnce=!1,this.pushBuffer=[],this.subTopic=e.replace(/^realtime:/i,""),this.params.config=Object.assign({broadcast:{ack:!1,self:!1},presence:{key:"",enabled:!1},private:!1},i.config),this.timeout=this.socket.timeout,this.joinPush=new Kl(this,ci.join,this.params,this.timeout),this.rejoinTimer=new wg(()=>this._rejoinUntilConnected(),this.socket.reconnectAfterMs),this.joinPush.receive("ok",()=>{this.state=st.joined,this.rejoinTimer.reset(),this.pushBuffer.forEach(a=>a.send()),this.pushBuffer=[]}),this._onClose(()=>{this.rejoinTimer.reset(),this.socket.log("channel",`close ${this.topic} ${this._joinRef()}`),this.state=st.closed,this.socket._remove(this)}),this._onError(a=>{this._isLeaving()||this._isClosed()||(this.socket.log("channel",`error ${this.topic}`,a),this.state=st.errored,this.rejoinTimer.scheduleTimeout())}),this.joinPush.receive("timeout",()=>{this._isJoining()&&(this.socket.log("channel",`timeout ${this.topic}`,this.joinPush.timeout),this.state=st.errored,this.rejoinTimer.scheduleTimeout())}),this.joinPush.receive("error",a=>{this._isLeaving()||this._isClosed()||(this.socket.log("channel",`error ${this.topic}`,a),this.state=st.errored,this.rejoinTimer.scheduleTimeout())}),this._on(ci.reply,{},(a,o)=>{this._trigger(this._replyEventName(o),a)}),this.presence=new Bn(this),this.broadcastEndpointURL=xg(this.socket.endPoint),this.private=this.params.config.private||!1,!this.private&&(!((n=(r=this.params.config)===null||r===void 0?void 0:r.broadcast)===null||n===void 0)&&n.replay))throw`tried to use replay on public channel '${this.topic}'. It must be a private channel.`}subscribe(e,i=this.timeout){var s,r,n;if(this.socket.isConnected()||this.socket.connect(),this.state==st.closed){const{config:{broadcast:a,presence:o,private:l}}=this.params,c=(r=(s=this.bindings.postgres_changes)===null||s===void 0?void 0:s.map(p=>p.filter))!==null&&r!==void 0?r:[],h=!!this.bindings[jn.PRESENCE]&&this.bindings[jn.PRESENCE].length>0||((n=this.params.config.presence)===null||n===void 0?void 0:n.enabled)===!0,d={},u={broadcast:a,presence:Object.assign(Object.assign({},o),{enabled:h}),postgres_changes:c,private:l};this.socket.accessTokenValue&&(d.access_token=this.socket.accessTokenValue),this._onError(p=>e==null?void 0:e(Gi.CHANNEL_ERROR,p)),this._onClose(()=>e==null?void 0:e(Gi.CLOSED)),this.updateJoinPayload(Object.assign({config:u},d)),this.joinedOnce=!0,this._rejoin(i),this.joinPush.receive("ok",async({postgres_changes:p})=>{var f;if(this.socket._isManualToken()||this.socket.setAuth(),p===void 0){e==null||e(Gi.SUBSCRIBED);return}else{const g=this.bindings.postgres_changes,m=(f=g==null?void 0:g.length)!==null&&f!==void 0?f:0,y=[];for(let b=0;b<m;b++){const w=g[b],{filter:{event:k,schema:x,table:E,filter:_}}=w,R=p&&p[b];if(R&&R.event===k&&Lr.isFilterValueEqual(R.schema,x)&&Lr.isFilterValueEqual(R.table,E)&&Lr.isFilterValueEqual(R.filter,_))y.push(Object.assign(Object.assign({},w),{id:R.id}));else{this.unsubscribe(),this.state=st.errored,e==null||e(Gi.CHANNEL_ERROR,new Error("mismatch between server and client bindings for postgres changes"));return}}this.bindings.postgres_changes=y,e&&e(Gi.SUBSCRIBED);return}}).receive("error",p=>{this.state=st.errored,e==null||e(Gi.CHANNEL_ERROR,new Error(JSON.stringify(Object.values(p).join(", ")||"error")))}).receive("timeout",()=>{e==null||e(Gi.TIMED_OUT)})}return this}presenceState(){return this.presence.state}async track(e,i={}){return await this.send({type:"presence",event:"track",payload:e},i.timeout||this.timeout)}async untrack(e={}){return await this.send({type:"presence",event:"untrack"},e)}on(e,i,s){return this.state===st.joined&&e===jn.PRESENCE&&(this.socket.log("channel",`resubscribe to ${this.topic} due to change in presence callbacks on joined channel`),this.unsubscribe().then(async()=>await this.subscribe())),this._on(e,i,s)}async httpSend(e,i,s={}){var r;if(i==null)return Promise.reject("Payload is required for httpSend()");const n={apikey:this.socket.apiKey?this.socket.apiKey:"","Content-Type":"application/json"};this.socket.accessTokenValue&&(n.Authorization=`Bearer ${this.socket.accessTokenValue}`);const a={method:"POST",headers:n,body:JSON.stringify({messages:[{topic:this.subTopic,event:e,payload:i,private:this.private}]})},o=await this._fetchWithTimeout(this.broadcastEndpointURL,a,(r=s.timeout)!==null&&r!==void 0?r:this.timeout);if(o.status===202)return{success:!0};let l=o.statusText;try{const c=await o.json();l=c.error||c.message||l}catch{}return Promise.reject(new Error(l))}async send(e,i={}){var s,r;if(!this._canPush()&&e.type==="broadcast"){console.warn("Realtime send() is automatically falling back to REST API. This behavior will be deprecated in the future. Please use httpSend() explicitly for REST delivery.");const{event:n,payload:a}=e,o={apikey:this.socket.apiKey?this.socket.apiKey:"","Content-Type":"application/json"};this.socket.accessTokenValue&&(o.Authorization=`Bearer ${this.socket.accessTokenValue}`);const l={method:"POST",headers:o,body:JSON.stringify({messages:[{topic:this.subTopic,event:n,payload:a,private:this.private}]})};try{const c=await this._fetchWithTimeout(this.broadcastEndpointURL,l,(s=i.timeout)!==null&&s!==void 0?s:this.timeout);return await((r=c.body)===null||r===void 0?void 0:r.cancel()),c.ok?"ok":"error"}catch(c){return c.name==="AbortError"?"timed out":"error"}}else return new Promise(n=>{var a,o,l;const c=this._push(e.type,e,i.timeout||this.timeout);e.type==="broadcast"&&!(!((l=(o=(a=this.params)===null||a===void 0?void 0:a.config)===null||o===void 0?void 0:o.broadcast)===null||l===void 0)&&l.ack)&&n("ok"),c.receive("ok",()=>n("ok")),c.receive("error",()=>n("error")),c.receive("timeout",()=>n("timed out"))})}updateJoinPayload(e){this.joinPush.updatePayload(e)}unsubscribe(e=this.timeout){this.state=st.leaving;const i=()=>{this.socket.log("channel",`leave ${this.topic}`),this._trigger(ci.close,"leave",this._joinRef())};this.joinPush.destroy();let s=null;return new Promise(r=>{s=new Kl(this,ci.leave,{},e),s.receive("ok",()=>{i(),r("ok")}).receive("timeout",()=>{i(),r("timed out")}).receive("error",()=>{r("error")}),s.send(),this._canPush()||s.trigger("ok",{})}).finally(()=>{s==null||s.destroy()})}teardown(){this.pushBuffer.forEach(e=>e.destroy()),this.pushBuffer=[],this.rejoinTimer.reset(),this.joinPush.destroy(),this.state=st.closed,this.bindings={}}async _fetchWithTimeout(e,i,s){const r=new AbortController,n=setTimeout(()=>r.abort(),s),a=await this.socket.fetch(e,Object.assign(Object.assign({},i),{signal:r.signal}));return clearTimeout(n),a}_push(e,i,s=this.timeout){if(!this.joinedOnce)throw`tried to push '${e}' to '${this.topic}' before joining. Use channel.subscribe() before pushing events`;let r=new Kl(this,e,i,s);return this._canPush()?r.send():this._addToPushBuffer(r),r}_addToPushBuffer(e){if(e.startTimeout(),this.pushBuffer.push(e),this.pushBuffer.length>Vv){const i=this.pushBuffer.shift();i&&(i.destroy(),this.socket.log("channel",`discarded push due to buffer overflow: ${i.event}`,i.payload))}}_onMessage(e,i,s){return i}_isMember(e){return this.topic===e}_joinRef(){return this.joinPush.ref}_trigger(e,i,s){var r,n;const a=e.toLocaleLowerCase(),{close:o,error:l,leave:c,join:h}=ci;if(s&&[o,l,c,h].indexOf(a)>=0&&s!==this._joinRef())return;let u=this._onMessage(a,i,s);if(i&&!u)throw"channel onMessage callbacks must return the payload, modified or unmodified";["insert","update","delete"].includes(a)?(r=this.bindings.postgres_changes)===null||r===void 0||r.filter(p=>{var f,g,m;return((f=p.filter)===null||f===void 0?void 0:f.event)==="*"||((m=(g=p.filter)===null||g===void 0?void 0:g.event)===null||m===void 0?void 0:m.toLocaleLowerCase())===a}).map(p=>p.callback(u,s)):(n=this.bindings[a])===null||n===void 0||n.filter(p=>{var f,g,m,y,b,w;if(["broadcast","presence","postgres_changes"].includes(a))if("id"in p){const k=p.id,x=(f=p.filter)===null||f===void 0?void 0:f.event;return k&&((g=i.ids)===null||g===void 0?void 0:g.includes(k))&&(x==="*"||(x==null?void 0:x.toLocaleLowerCase())===((m=i.data)===null||m===void 0?void 0:m.type.toLocaleLowerCase()))}else{const k=(b=(y=p==null?void 0:p.filter)===null||y===void 0?void 0:y.event)===null||b===void 0?void 0:b.toLocaleLowerCase();return k==="*"||k===((w=i==null?void 0:i.event)===null||w===void 0?void 0:w.toLocaleLowerCase())}else return p.type.toLocaleLowerCase()===a}).map(p=>{if(typeof u=="object"&&"ids"in u){const f=u.data,{schema:g,table:m,commit_timestamp:y,type:b,errors:w}=f;u=Object.assign(Object.assign({},{schema:g,table:m,commit_timestamp:y,eventType:b,new:{},old:{},errors:w}),this._getPayloadRecords(f))}p.callback(u,s)})}_isClosed(){return this.state===st.closed}_isJoined(){return this.state===st.joined}_isJoining(){return this.state===st.joining}_isLeaving(){return this.state===st.leaving}_replyEventName(e){return`chan_reply_${e}`}_on(e,i,s){const r=e.toLocaleLowerCase(),n={type:r,filter:i,callback:s};return this.bindings[r]?this.bindings[r].push(n):this.bindings[r]=[n],this}_off(e,i){const s=e.toLocaleLowerCase();return this.bindings[s]&&(this.bindings[s]=this.bindings[s].filter(r=>{var n;return!(((n=r.type)===null||n===void 0?void 0:n.toLocaleLowerCase())===s&&Lr.isEqual(r.filter,i))})),this}static isEqual(e,i){if(Object.keys(e).length!==Object.keys(i).length)return!1;for(const s in e)if(e[s]!==i[s])return!1;return!0}static isFilterValueEqual(e,i){return(e??void 0)===(i??void 0)}_rejoinUntilConnected(){this.rejoinTimer.scheduleTimeout(),this.socket.isConnected()&&this._rejoin()}_onClose(e){this._on(ci.close,{},e)}_onError(e){this._on(ci.error,{},i=>e(i))}_canPush(){return this.socket.isConnected()&&this._isJoined()}_rejoin(e=this.timeout){this._isLeaving()||(this.socket._leaveOpenTopic(this.topic),this.state=st.joining,this.joinPush.resend(e))}_getPayloadRecords(e){const i={new:{},old:{}};return(e.type==="INSERT"||e.type==="UPDATE")&&(i.new=Au(e.columns,e.record)),(e.type==="UPDATE"||e.type==="DELETE")&&(i.old=Au(e.columns,e.old_record)),i}}const Jl=()=>{},Fa={HEARTBEAT_INTERVAL:25e3,RECONNECT_DELAY:10,HEARTBEAT_TIMEOUT_FALLBACK:100},Jv=[1e3,2e3,5e3,1e4],eb=1e4,tb=`
  addEventListener("message", (e) => {
    if (e.data.event === "start") {
      setInterval(() => postMessage({ event: "keepAlive" }), e.data.interval);
    }
  });`;class ib{constructor(e,i){var s;if(this.accessTokenValue=null,this.apiKey=null,this._manuallySetToken=!1,this.channels=new Array,this.endPoint="",this.httpEndpoint="",this.headers={},this.params={},this.timeout=Bc,this.transport=null,this.heartbeatIntervalMs=Fa.HEARTBEAT_INTERVAL,this.heartbeatTimer=void 0,this.pendingHeartbeatRef=null,this.heartbeatCallback=Jl,this.ref=0,this.reconnectTimer=null,this.vsn=Qu,this.logger=Jl,this.conn=null,this.sendBuffer=[],this.serializer=new zv,this.stateChangeCallbacks={open:[],close:[],error:[],message:[]},this.accessToken=null,this._connectionState="disconnected",this._wasManualDisconnect=!1,this._authPromise=null,this._heartbeatSentAt=null,this._resolveFetch=r=>r?(...n)=>r(...n):(...n)=>fetch(...n),!(!((s=i==null?void 0:i.params)===null||s===void 0)&&s.apikey))throw new Error("API key is required to connect to Realtime");this.apiKey=i.params.apikey,this.endPoint=`${e}/${jc.websocket}`,this.httpEndpoint=xg(e),this._initializeOptions(i),this._setupReconnectionTimer(),this.fetch=this._resolveFetch(i==null?void 0:i.fetch)}connect(){if(!(this.isConnecting()||this.isDisconnecting()||this.conn!==null&&this.isConnected())){if(this._setConnectionState("connecting"),this.accessToken&&!this._authPromise&&this._setAuthSafely("connect"),this.transport)this.conn=new this.transport(this.endpointURL());else try{this.conn=Bv.createWebSocket(this.endpointURL())}catch(e){this._setConnectionState("disconnected");const i=e.message;throw i.includes("Node.js")?new Error(`${i}

To use Realtime in Node.js, you need to provide a WebSocket implementation:

Option 1: Use Node.js 22+ which has native WebSocket support
Option 2: Install and provide the "ws" package:

  npm install ws

  import ws from "ws"
  const client = new RealtimeClient(url, {
    ...options,
    transport: ws
  })`):new Error(`WebSocket not available: ${i}`)}this._setupConnectionHandlers()}}endpointURL(){return this._appendParams(this.endPoint,Object.assign({},this.params,{vsn:this.vsn}))}disconnect(e,i){if(!this.isDisconnecting())if(this._setConnectionState("disconnecting",!0),this.conn){const s=setTimeout(()=>{this._setConnectionState("disconnected")},100);this.conn.onclose=()=>{clearTimeout(s),this._setConnectionState("disconnected")},typeof this.conn.close=="function"&&(e?this.conn.close(e,i??""):this.conn.close()),this._teardownConnection()}else this._setConnectionState("disconnected")}getChannels(){return this.channels}async removeChannel(e){const i=await e.unsubscribe();return this.channels.length===0&&this.disconnect(),i}async removeAllChannels(){const e=await Promise.all(this.channels.map(i=>i.unsubscribe()));return this.channels=[],this.disconnect(),e}log(e,i,s){this.logger(e,i,s)}connectionState(){switch(this.conn&&this.conn.readyState){case ps.connecting:return Ws.Connecting;case ps.open:return Ws.Open;case ps.closing:return Ws.Closing;default:return Ws.Closed}}isConnected(){return this.connectionState()===Ws.Open}isConnecting(){return this._connectionState==="connecting"}isDisconnecting(){return this._connectionState==="disconnecting"}channel(e,i={config:{}}){const s=`realtime:${e}`,r=this.getChannels().find(n=>n.topic===s);if(r)return r;{const n=new Lr(`realtime:${e}`,i,this);return this.channels.push(n),n}}push(e){const{topic:i,event:s,payload:r,ref:n}=e,a=()=>{this.encode(e,o=>{var l;(l=this.conn)===null||l===void 0||l.send(o)})};this.log("push",`${i} ${s} (${n})`,r),this.isConnected()?a():this.sendBuffer.push(a)}async setAuth(e=null){this._authPromise=this._performAuth(e);try{await this._authPromise}finally{this._authPromise=null}}_isManualToken(){return this._manuallySetToken}async sendHeartbeat(){var e;if(!this.isConnected()){try{this.heartbeatCallback("disconnected")}catch(i){this.log("error","error in heartbeat callback",i)}return}if(this.pendingHeartbeatRef){this.pendingHeartbeatRef=null,this._heartbeatSentAt=null,this.log("transport","heartbeat timeout. Attempting to re-establish connection");try{this.heartbeatCallback("timeout")}catch(i){this.log("error","error in heartbeat callback",i)}this._wasManualDisconnect=!1,(e=this.conn)===null||e===void 0||e.close(Uv,"heartbeat timeout"),setTimeout(()=>{var i;this.isConnected()||(i=this.reconnectTimer)===null||i===void 0||i.scheduleTimeout()},Fa.HEARTBEAT_TIMEOUT_FALLBACK);return}this._heartbeatSentAt=Date.now(),this.pendingHeartbeatRef=this._makeRef(),this.push({topic:"phoenix",event:"heartbeat",payload:{},ref:this.pendingHeartbeatRef});try{this.heartbeatCallback("sent")}catch(i){this.log("error","error in heartbeat callback",i)}this._setAuthSafely("heartbeat")}onHeartbeat(e){this.heartbeatCallback=e}flushSendBuffer(){this.isConnected()&&this.sendBuffer.length>0&&(this.sendBuffer.forEach(e=>e()),this.sendBuffer=[])}_makeRef(){let e=this.ref+1;return e===this.ref?this.ref=0:this.ref=e,this.ref.toString()}_leaveOpenTopic(e){let i=this.channels.find(s=>s.topic===e&&(s._isJoined()||s._isJoining()));i&&(this.log("transport",`leaving duplicate topic "${e}"`),i.unsubscribe())}_remove(e){this.channels=this.channels.filter(i=>i.topic!==e.topic)}_onConnMessage(e){this.decode(e.data,i=>{if(i.topic==="phoenix"&&i.event==="phx_reply"&&i.ref&&i.ref===this.pendingHeartbeatRef){const c=this._heartbeatSentAt?Date.now()-this._heartbeatSentAt:void 0;try{this.heartbeatCallback(i.payload.status==="ok"?"ok":"error",c)}catch(h){this.log("error","error in heartbeat callback",h)}this._heartbeatSentAt=null,this.pendingHeartbeatRef=null}const{topic:s,event:r,payload:n,ref:a}=i,o=a?`(${a})`:"",l=n.status||"";this.log("receive",`${l} ${s} ${r} ${o}`.trim(),n),this.channels.filter(c=>c._isMember(s)).forEach(c=>c._trigger(r,n,a)),this._triggerStateCallbacks("message",i)})}_clearTimer(e){var i;e==="heartbeat"&&this.heartbeatTimer?(clearInterval(this.heartbeatTimer),this.heartbeatTimer=void 0):e==="reconnect"&&((i=this.reconnectTimer)===null||i===void 0||i.reset())}_clearAllTimers(){this._clearTimer("heartbeat"),this._clearTimer("reconnect")}_setupConnectionHandlers(){this.conn&&("binaryType"in this.conn&&(this.conn.binaryType="arraybuffer"),this.conn.onopen=()=>this._onConnOpen(),this.conn.onerror=e=>this._onConnError(e),this.conn.onmessage=e=>this._onConnMessage(e),this.conn.onclose=e=>this._onConnClose(e),this.conn.readyState===ps.open&&this._onConnOpen())}_teardownConnection(){if(this.conn){if(this.conn.readyState===ps.open||this.conn.readyState===ps.connecting)try{this.conn.close()}catch(e){this.log("error","Error closing connection",e)}this.conn.onopen=null,this.conn.onerror=null,this.conn.onmessage=null,this.conn.onclose=null,this.conn=null}this._clearAllTimers(),this._terminateWorker(),this.channels.forEach(e=>e.teardown())}_onConnOpen(){this._setConnectionState("connected"),this.log("transport",`connected to ${this.endpointURL()}`),(this._authPromise||(this.accessToken&&!this.accessTokenValue?this.setAuth():Promise.resolve())).then(()=>{this.flushSendBuffer()}).catch(i=>{this.log("error","error waiting for auth on connect",i),this.flushSendBuffer()}),this._clearTimer("reconnect"),this.worker?this.workerRef||this._startWorkerHeartbeat():this._startHeartbeat(),this._triggerStateCallbacks("open")}_startHeartbeat(){this.heartbeatTimer&&clearInterval(this.heartbeatTimer),this.heartbeatTimer=setInterval(()=>this.sendHeartbeat(),this.heartbeatIntervalMs)}_startWorkerHeartbeat(){this.workerUrl?this.log("worker",`starting worker for from ${this.workerUrl}`):this.log("worker","starting default worker");const e=this._workerObjectUrl(this.workerUrl);this.workerRef=new Worker(e),this.workerRef.onerror=i=>{this.log("worker","worker error",i.message),this._terminateWorker()},this.workerRef.onmessage=i=>{i.data.event==="keepAlive"&&this.sendHeartbeat()},this.workerRef.postMessage({event:"start",interval:this.heartbeatIntervalMs})}_terminateWorker(){this.workerRef&&(this.log("worker","terminating worker"),this.workerRef.terminate(),this.workerRef=void 0)}_onConnClose(e){var i;this._setConnectionState("disconnected"),this.log("transport","close",e),this._triggerChanError(),this._clearTimer("heartbeat"),this._wasManualDisconnect||(i=this.reconnectTimer)===null||i===void 0||i.scheduleTimeout(),this._triggerStateCallbacks("close",e)}_onConnError(e){this._setConnectionState("disconnected"),this.log("transport",`${e}`),this._triggerChanError(),this._triggerStateCallbacks("error",e);try{this.heartbeatCallback("error")}catch(i){this.log("error","error in heartbeat callback",i)}}_triggerChanError(){this.channels.forEach(e=>e._trigger(ci.error))}_appendParams(e,i){if(Object.keys(i).length===0)return e;const s=e.match(/\?/)?"&":"?",r=new URLSearchParams(i);return`${e}${s}${r}`}_workerObjectUrl(e){let i;if(e)i=e;else{const s=new Blob([tb],{type:"application/javascript"});i=URL.createObjectURL(s)}return i}_setConnectionState(e,i=!1){this._connectionState=e,e==="connecting"?this._wasManualDisconnect=!1:e==="disconnecting"&&(this._wasManualDisconnect=i)}async _performAuth(e=null){let i,s=!1;if(e)i=e,s=!0;else if(this.accessToken)try{i=await this.accessToken()}catch(r){this.log("error","Error fetching access token from callback",r),i=this.accessTokenValue}else i=this.accessTokenValue;s?this._manuallySetToken=!0:this.accessToken&&(this._manuallySetToken=!1),this.accessTokenValue!=i&&(this.accessTokenValue=i,this.channels.forEach(r=>{const n={access_token:i,version:Wv};i&&r.updateJoinPayload(n),r.joinedOnce&&r._isJoined()&&r._push(ci.access_token,{access_token:i})}))}async _waitForAuthIfNeeded(){this._authPromise&&await this._authPromise}_setAuthSafely(e="general"){this._isManualToken()||this.setAuth().catch(i=>{this.log("error",`Error setting auth in ${e}`,i)})}_triggerStateCallbacks(e,i){try{this.stateChangeCallbacks[e].forEach(s=>{try{s(i)}catch(r){this.log("error",`error in ${e} callback`,r)}})}catch(s){this.log("error",`error triggering ${e} callbacks`,s)}}_setupReconnectionTimer(){this.reconnectTimer=new wg(async()=>{setTimeout(async()=>{await this._waitForAuthIfNeeded(),this.isConnected()||this.connect()},Fa.RECONNECT_DELAY)},this.reconnectAfterMs)}_initializeOptions(e){var i,s,r,n,a,o,l,c,h,d,u,p;switch(this.transport=(i=e==null?void 0:e.transport)!==null&&i!==void 0?i:null,this.timeout=(s=e==null?void 0:e.timeout)!==null&&s!==void 0?s:Bc,this.heartbeatIntervalMs=(r=e==null?void 0:e.heartbeatIntervalMs)!==null&&r!==void 0?r:Fa.HEARTBEAT_INTERVAL,this.worker=(n=e==null?void 0:e.worker)!==null&&n!==void 0?n:!1,this.accessToken=(a=e==null?void 0:e.accessToken)!==null&&a!==void 0?a:null,this.heartbeatCallback=(o=e==null?void 0:e.heartbeatCallback)!==null&&o!==void 0?o:Jl,this.vsn=(l=e==null?void 0:e.vsn)!==null&&l!==void 0?l:Qu,e!=null&&e.params&&(this.params=e.params),e!=null&&e.logger&&(this.logger=e.logger),(e!=null&&e.logLevel||e!=null&&e.log_level)&&(this.logLevel=e.logLevel||e.log_level,this.params=Object.assign(Object.assign({},this.params),{log_level:this.logLevel})),this.reconnectAfterMs=(c=e==null?void 0:e.reconnectAfterMs)!==null&&c!==void 0?c:f=>Jv[f-1]||eb,this.vsn){case Fv:this.encode=(h=e==null?void 0:e.encode)!==null&&h!==void 0?h:(f,g)=>g(JSON.stringify(f)),this.decode=(d=e==null?void 0:e.decode)!==null&&d!==void 0?d:(f,g)=>g(JSON.parse(f));break;case bg:this.encode=(u=e==null?void 0:e.encode)!==null&&u!==void 0?u:this.serializer.encode.bind(this.serializer),this.decode=(p=e==null?void 0:e.decode)!==null&&p!==void 0?p:this.serializer.decode.bind(this.serializer);break;default:throw new Error(`Unsupported serializer version: ${this.vsn}`)}if(this.worker){if(typeof window<"u"&&!window.Worker)throw new Error("Web Worker is not supported");this.workerUrl=e==null?void 0:e.workerUrl}}}var ea=class extends Error{constructor(t,e){var i;super(t),this.name="IcebergError",this.status=e.status,this.icebergType=e.icebergType,this.icebergCode=e.icebergCode,this.details=e.details,this.isCommitStateUnknown=e.icebergType==="CommitStateUnknownException"||[500,502,504].includes(e.status)&&((i=e.icebergType)==null?void 0:i.includes("CommitState"))===!0}isNotFound(){return this.status===404}isConflict(){return this.status===409}isAuthenticationTimeout(){return this.status===419}};function sb(t,e,i){const s=new URL(e,t);if(i)for(const[r,n]of Object.entries(i))n!==void 0&&s.searchParams.set(r,n);return s.toString()}async function rb(t){return!t||t.type==="none"?{}:t.type==="bearer"?{Authorization:`Bearer ${t.token}`}:t.type==="header"?{[t.name]:t.value}:t.type==="custom"?await t.getHeaders():{}}function nb(t){const e=t.fetchImpl??globalThis.fetch;return{async request({method:i,path:s,query:r,body:n,headers:a}){const o=sb(t.baseUrl,s,r),l=await rb(t.auth),c=await e(o,{method:i,headers:{...n?{"Content-Type":"application/json"}:{},...l,...a},body:n?JSON.stringify(n):void 0}),h=await c.text(),d=(c.headers.get("content-type")||"").includes("application/json"),u=d&&h?JSON.parse(h):h;if(!c.ok){const p=d?u:void 0,f=p==null?void 0:p.error;throw new ea((f==null?void 0:f.message)??`Request failed with status ${c.status}`,{status:c.status,icebergType:f==null?void 0:f.type,icebergCode:f==null?void 0:f.code,details:p})}return{status:c.status,headers:c.headers,data:u}}}}function Ua(t){return t.join("")}var ab=class{constructor(t,e=""){this.client=t,this.prefix=e}async listNamespaces(t){const e=t?{parent:Ua(t.namespace)}:void 0;return(await this.client.request({method:"GET",path:`${this.prefix}/namespaces`,query:e})).data.namespaces.map(s=>({namespace:s}))}async createNamespace(t,e){const i={namespace:t.namespace,properties:e==null?void 0:e.properties};return(await this.client.request({method:"POST",path:`${this.prefix}/namespaces`,body:i})).data}async dropNamespace(t){await this.client.request({method:"DELETE",path:`${this.prefix}/namespaces/${Ua(t.namespace)}`})}async loadNamespaceMetadata(t){return{properties:(await this.client.request({method:"GET",path:`${this.prefix}/namespaces/${Ua(t.namespace)}`})).data.properties}}async namespaceExists(t){try{return await this.client.request({method:"HEAD",path:`${this.prefix}/namespaces/${Ua(t.namespace)}`}),!0}catch(e){if(e instanceof ea&&e.status===404)return!1;throw e}}async createNamespaceIfNotExists(t,e){try{return await this.createNamespace(t,e)}catch(i){if(i instanceof ea&&i.status===409)return;throw i}}};function br(t){return t.join("")}var ob=class{constructor(t,e="",i){this.client=t,this.prefix=e,this.accessDelegation=i}async listTables(t){return(await this.client.request({method:"GET",path:`${this.prefix}/namespaces/${br(t.namespace)}/tables`})).data.identifiers}async createTable(t,e){const i={};return this.accessDelegation&&(i["X-Iceberg-Access-Delegation"]=this.accessDelegation),(await this.client.request({method:"POST",path:`${this.prefix}/namespaces/${br(t.namespace)}/tables`,body:e,headers:i})).data.metadata}async updateTable(t,e){const i=await this.client.request({method:"POST",path:`${this.prefix}/namespaces/${br(t.namespace)}/tables/${t.name}`,body:e});return{"metadata-location":i.data["metadata-location"],metadata:i.data.metadata}}async dropTable(t,e){await this.client.request({method:"DELETE",path:`${this.prefix}/namespaces/${br(t.namespace)}/tables/${t.name}`,query:{purgeRequested:String((e==null?void 0:e.purge)??!1)}})}async loadTable(t){const e={};return this.accessDelegation&&(e["X-Iceberg-Access-Delegation"]=this.accessDelegation),(await this.client.request({method:"GET",path:`${this.prefix}/namespaces/${br(t.namespace)}/tables/${t.name}`,headers:e})).data.metadata}async tableExists(t){const e={};this.accessDelegation&&(e["X-Iceberg-Access-Delegation"]=this.accessDelegation);try{return await this.client.request({method:"HEAD",path:`${this.prefix}/namespaces/${br(t.namespace)}/tables/${t.name}`,headers:e}),!0}catch(i){if(i instanceof ea&&i.status===404)return!1;throw i}}async createTableIfNotExists(t,e){try{return await this.createTable(t,e)}catch(i){if(i instanceof ea&&i.status===409)return await this.loadTable({namespace:t.namespace,name:e.name});throw i}}},lb=class{constructor(t){var s;let e="v1";t.catalogName&&(e+=`/${t.catalogName}`);const i=t.baseUrl.endsWith("/")?t.baseUrl:`${t.baseUrl}/`;this.client=nb({baseUrl:i,auth:t.auth,fetchImpl:t.fetch}),this.accessDelegation=(s=t.accessDelegation)==null?void 0:s.join(","),this.namespaceOps=new ab(this.client,e),this.tableOps=new ob(this.client,e,this.accessDelegation)}async listNamespaces(t){return this.namespaceOps.listNamespaces(t)}async createNamespace(t,e){return this.namespaceOps.createNamespace(t,e)}async dropNamespace(t){await this.namespaceOps.dropNamespace(t)}async loadNamespaceMetadata(t){return this.namespaceOps.loadNamespaceMetadata(t)}async listTables(t){return this.tableOps.listTables(t)}async createTable(t,e){return this.tableOps.createTable(t,e)}async updateTable(t,e){return this.tableOps.updateTable(t,e)}async dropTable(t,e){await this.tableOps.dropTable(t,e)}async loadTable(t){return this.tableOps.loadTable(t)}async namespaceExists(t){return this.namespaceOps.namespaceExists(t)}async tableExists(t){return this.tableOps.tableExists(t)}async createNamespaceIfNotExists(t,e){return this.namespaceOps.createNamespaceIfNotExists(t,e)}async createTableIfNotExists(t,e){return this.tableOps.createTableIfNotExists(t,e)}},sl=class extends Error{constructor(t,e="storage",i,s){super(t),this.__isStorageError=!0,this.namespace=e,this.name=e==="vectors"?"StorageVectorsError":"StorageError",this.status=i,this.statusCode=s}};function rl(t){return typeof t=="object"&&t!==null&&"__isStorageError"in t}var Va=class extends sl{constructor(t,e,i,s="storage"){super(t,s,e,i),this.name=s==="vectors"?"StorageVectorsApiError":"StorageApiError",this.status=e,this.statusCode=i}toJSON(){return{name:this.name,message:this.message,status:this.status,statusCode:this.statusCode}}},kg=class extends sl{constructor(t,e,i="storage"){super(t,i),this.name=i==="vectors"?"StorageVectorsUnknownError":"StorageUnknownError",this.originalError=e}};const cb=t=>t?(...e)=>t(...e):(...e)=>fetch(...e),hb=t=>{if(typeof t!="object"||t===null)return!1;const e=Object.getPrototypeOf(t);return(e===null||e===Object.prototype||Object.getPrototypeOf(e)===null)&&!(Symbol.toStringTag in t)&&!(Symbol.iterator in t)},Fc=t=>{if(Array.isArray(t))return t.map(i=>Fc(i));if(typeof t=="function"||t!==Object(t))return t;const e={};return Object.entries(t).forEach(([i,s])=>{const r=i.replace(/([-_][a-z])/gi,n=>n.toUpperCase().replace(/[-_]/g,""));e[r]=Fc(s)}),e},db=t=>!t||typeof t!="string"||t.length===0||t.length>100||t.trim()!==t||t.includes("/")||t.includes("\\")?!1:/^[\w!.\*'() &$@=;:+,?-]+$/.test(t);function ta(t){"@babel/helpers - typeof";return ta=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},ta(t)}function ub(t,e){if(ta(t)!="object"||!t)return t;var i=t[Symbol.toPrimitive];if(i!==void 0){var s=i.call(t,e);if(ta(s)!="object")return s;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function pb(t){var e=ub(t,"string");return ta(e)=="symbol"?e:e+""}function fb(t,e,i){return(e=pb(e))in t?Object.defineProperty(t,e,{value:i,enumerable:!0,configurable:!0,writable:!0}):t[e]=i,t}function Mu(t,e){var i=Object.keys(t);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(t);e&&(s=s.filter(function(r){return Object.getOwnPropertyDescriptor(t,r).enumerable})),i.push.apply(i,s)}return i}function de(t){for(var e=1;e<arguments.length;e++){var i=arguments[e]!=null?arguments[e]:{};e%2?Mu(Object(i),!0).forEach(function(s){fb(t,s,i[s])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(i)):Mu(Object(i)).forEach(function(s){Object.defineProperty(t,s,Object.getOwnPropertyDescriptor(i,s))})}return t}const qu=t=>{var e;return t.msg||t.message||t.error_description||(typeof t.error=="string"?t.error:(e=t.error)===null||e===void 0?void 0:e.message)||JSON.stringify(t)},gb=async(t,e,i,s)=>{if(t&&typeof t=="object"&&"status"in t&&"ok"in t&&typeof t.status=="number"&&!(i!=null&&i.noResolveJson)){const r=t,n=r.status||500;if(typeof r.json=="function")r.json().then(a=>{const o=(a==null?void 0:a.statusCode)||(a==null?void 0:a.code)||n+"";e(new Va(qu(a),n,o,s))}).catch(()=>{if(s==="vectors"){const a=n+"";e(new Va(r.statusText||`HTTP ${n} error`,n,a,s))}else{const a=n+"";e(new Va(r.statusText||`HTTP ${n} error`,n,a,s))}});else{const a=n+"";e(new Va(r.statusText||`HTTP ${n} error`,n,a,s))}}else e(new kg(qu(t),t,s))},mb=(t,e,i,s)=>{const r={method:t,headers:(e==null?void 0:e.headers)||{}};return t==="GET"||t==="HEAD"||!s?de(de({},r),i):(hb(s)?(r.headers=de({"Content-Type":"application/json"},e==null?void 0:e.headers),r.body=JSON.stringify(s)):r.body=s,e!=null&&e.duplex&&(r.duplex=e.duplex),de(de({},r),i))};async function kn(t,e,i,s,r,n,a){return new Promise((o,l)=>{t(i,mb(e,s,r,n)).then(c=>{if(!c.ok)throw c;if(s!=null&&s.noResolveJson)return c;if(a==="vectors"){const h=c.headers.get("content-type");if(!h||!h.includes("application/json"))return{}}return c.json()}).then(c=>o(c)).catch(c=>gb(c,l,s,a))})}function Ob(t="storage"){return{get:async(e,i,s,r)=>kn(e,"GET",i,s,r,void 0,t),post:async(e,i,s,r,n)=>kn(e,"POST",i,r,n,s,t),put:async(e,i,s,r,n)=>kn(e,"PUT",i,r,n,s,t),head:async(e,i,s,r)=>kn(e,"HEAD",i,de(de({},s),{},{noResolveJson:!0}),r,void 0,t),remove:async(e,i,s,r,n)=>kn(e,"DELETE",i,r,n,s,t)}}const yb=Ob("storage"),{get:ia,post:Be,put:Uc,head:vb,remove:td}=yb;var sn=class{constructor(t,e={},i,s="storage"){this.shouldThrowOnError=!1,this.url=t,this.headers=e,this.fetch=cb(i),this.namespace=s}throwOnError(){return this.shouldThrowOnError=!0,this}async handleOperation(t){var e=this;try{return{data:await t(),error:null}}catch(i){if(e.shouldThrowOnError)throw i;if(rl(i))return{data:null,error:i};throw i}}},bb=class{constructor(t,e){this.downloadFn=t,this.shouldThrowOnError=e}then(t,e){return this.execute().then(t,e)}async execute(){var t=this;try{return{data:(await t.downloadFn()).body,error:null}}catch(e){if(t.shouldThrowOnError)throw e;if(rl(e))return{data:null,error:e};throw e}}};let Tg;Tg=Symbol.toStringTag;var wb=class{constructor(t,e){this.downloadFn=t,this.shouldThrowOnError=e,this[Tg]="BlobDownloadBuilder",this.promise=null}asStream(){return new bb(this.downloadFn,this.shouldThrowOnError)}then(t,e){return this.getPromise().then(t,e)}catch(t){return this.getPromise().catch(t)}finally(t){return this.getPromise().finally(t)}getPromise(){return this.promise||(this.promise=this.execute()),this.promise}async execute(){var t=this;try{return{data:await(await t.downloadFn()).blob(),error:null}}catch(e){if(t.shouldThrowOnError)throw e;if(rl(e))return{data:null,error:e};throw e}}};const Sb={limit:100,offset:0,sortBy:{column:"name",order:"asc"}},Du={cacheControl:"3600",contentType:"text/plain;charset=UTF-8",upsert:!1};var xb=class extends sn{constructor(t,e={},i,s){super(t,e,s,"storage"),this.bucketId=i}async uploadOrUpdate(t,e,i,s){var r=this;return r.handleOperation(async()=>{let n;const a=de(de({},Du),s);let o=de(de({},r.headers),t==="POST"&&{"x-upsert":String(a.upsert)});const l=a.metadata;typeof Blob<"u"&&i instanceof Blob?(n=new FormData,n.append("cacheControl",a.cacheControl),l&&n.append("metadata",r.encodeMetadata(l)),n.append("",i)):typeof FormData<"u"&&i instanceof FormData?(n=i,n.has("cacheControl")||n.append("cacheControl",a.cacheControl),l&&!n.has("metadata")&&n.append("metadata",r.encodeMetadata(l))):(n=i,o["cache-control"]=`max-age=${a.cacheControl}`,o["content-type"]=a.contentType,l&&(o["x-metadata"]=r.toBase64(r.encodeMetadata(l))),(typeof ReadableStream<"u"&&n instanceof ReadableStream||n&&typeof n=="object"&&"pipe"in n&&typeof n.pipe=="function")&&!a.duplex&&(a.duplex="half")),s!=null&&s.headers&&(o=de(de({},o),s.headers));const c=r._removeEmptyFolders(e),h=r._getFinalPath(c),d=await(t=="PUT"?Uc:Be)(r.fetch,`${r.url}/object/${h}`,n,de({headers:o},a!=null&&a.duplex?{duplex:a.duplex}:{}));return{path:c,id:d.Id,fullPath:d.Key}})}async upload(t,e,i){return this.uploadOrUpdate("POST",t,e,i)}async uploadToSignedUrl(t,e,i,s){var r=this;const n=r._removeEmptyFolders(t),a=r._getFinalPath(n),o=new URL(r.url+`/object/upload/sign/${a}`);return o.searchParams.set("token",e),r.handleOperation(async()=>{let l;const c=de({upsert:Du.upsert},s),h=de(de({},r.headers),{"x-upsert":String(c.upsert)});return typeof Blob<"u"&&i instanceof Blob?(l=new FormData,l.append("cacheControl",c.cacheControl),l.append("",i)):typeof FormData<"u"&&i instanceof FormData?(l=i,l.append("cacheControl",c.cacheControl)):(l=i,h["cache-control"]=`max-age=${c.cacheControl}`,h["content-type"]=c.contentType),{path:n,fullPath:(await Uc(r.fetch,o.toString(),l,{headers:h})).Key}})}async createSignedUploadUrl(t,e){var i=this;return i.handleOperation(async()=>{let s=i._getFinalPath(t);const r=de({},i.headers);e!=null&&e.upsert&&(r["x-upsert"]="true");const n=await Be(i.fetch,`${i.url}/object/upload/sign/${s}`,{},{headers:r}),a=new URL(i.url+n.url),o=a.searchParams.get("token");if(!o)throw new sl("No token returned by API");return{signedUrl:a.toString(),path:t,token:o}})}async update(t,e,i){return this.uploadOrUpdate("PUT",t,e,i)}async move(t,e,i){var s=this;return s.handleOperation(async()=>await Be(s.fetch,`${s.url}/object/move`,{bucketId:s.bucketId,sourceKey:t,destinationKey:e,destinationBucket:i==null?void 0:i.destinationBucket},{headers:s.headers}))}async copy(t,e,i){var s=this;return s.handleOperation(async()=>({path:(await Be(s.fetch,`${s.url}/object/copy`,{bucketId:s.bucketId,sourceKey:t,destinationKey:e,destinationBucket:i==null?void 0:i.destinationBucket},{headers:s.headers})).Key}))}async createSignedUrl(t,e,i){var s=this;return s.handleOperation(async()=>{let r=s._getFinalPath(t),n=await Be(s.fetch,`${s.url}/object/sign/${r}`,de({expiresIn:e},i!=null&&i.transform?{transform:i.transform}:{}),{headers:s.headers});const a=i!=null&&i.download?`&download=${i.download===!0?"":i.download}`:"";return{signedUrl:encodeURI(`${s.url}${n.signedURL}${a}`)}})}async createSignedUrls(t,e,i){var s=this;return s.handleOperation(async()=>{const r=await Be(s.fetch,`${s.url}/object/sign/${s.bucketId}`,{expiresIn:e,paths:t},{headers:s.headers}),n=i!=null&&i.download?`&download=${i.download===!0?"":i.download}`:"";return r.map(a=>de(de({},a),{},{signedUrl:a.signedURL?encodeURI(`${s.url}${a.signedURL}${n}`):null}))})}download(t,e){const i=typeof(e==null?void 0:e.transform)<"u"?"render/image/authenticated":"object",s=this.transformOptsToQueryString((e==null?void 0:e.transform)||{}),r=s?`?${s}`:"",n=this._getFinalPath(t),a=()=>ia(this.fetch,`${this.url}/${i}/${n}${r}`,{headers:this.headers,noResolveJson:!0});return new wb(a,this.shouldThrowOnError)}async info(t){var e=this;const i=e._getFinalPath(t);return e.handleOperation(async()=>Fc(await ia(e.fetch,`${e.url}/object/info/${i}`,{headers:e.headers})))}async exists(t){var e=this;const i=e._getFinalPath(t);try{return await vb(e.fetch,`${e.url}/object/${i}`,{headers:e.headers}),{data:!0,error:null}}catch(s){if(e.shouldThrowOnError)throw s;if(rl(s)&&s instanceof kg){const r=s.originalError;if([400,404].includes(r==null?void 0:r.status))return{data:!1,error:s}}throw s}}getPublicUrl(t,e){const i=this._getFinalPath(t),s=[],r=e!=null&&e.download?`download=${e.download===!0?"":e.download}`:"";r!==""&&s.push(r);const n=typeof(e==null?void 0:e.transform)<"u"?"render/image":"object",a=this.transformOptsToQueryString((e==null?void 0:e.transform)||{});a!==""&&s.push(a);let o=s.join("&");return o!==""&&(o=`?${o}`),{data:{publicUrl:encodeURI(`${this.url}/${n}/public/${i}${o}`)}}}async remove(t){var e=this;return e.handleOperation(async()=>await td(e.fetch,`${e.url}/object/${e.bucketId}`,{prefixes:t},{headers:e.headers}))}async list(t,e,i){var s=this;return s.handleOperation(async()=>{const r=de(de(de({},Sb),e),{},{prefix:t||""});return await Be(s.fetch,`${s.url}/object/list/${s.bucketId}`,r,{headers:s.headers},i)})}async listV2(t,e){var i=this;return i.handleOperation(async()=>{const s=de({},t);return await Be(i.fetch,`${i.url}/object/list-v2/${i.bucketId}`,s,{headers:i.headers},e)})}encodeMetadata(t){return JSON.stringify(t)}toBase64(t){return typeof Buffer<"u"?Buffer.from(t).toString("base64"):btoa(t)}_getFinalPath(t){return`${this.bucketId}/${t.replace(/^\/+/,"")}`}_removeEmptyFolders(t){return t.replace(/^\/|\/$/g,"").replace(/\/+/g,"/")}transformOptsToQueryString(t){const e=[];return t.width&&e.push(`width=${t.width}`),t.height&&e.push(`height=${t.height}`),t.resize&&e.push(`resize=${t.resize}`),t.format&&e.push(`format=${t.format}`),t.quality&&e.push(`quality=${t.quality}`),e.join("&")}};const kb="2.93.1",ba={"X-Client-Info":`storage-js/${kb}`};var Tb=class extends sn{constructor(t,e={},i,s){const r=new URL(t);s!=null&&s.useNewHostname&&/supabase\.(co|in|red)$/.test(r.hostname)&&!r.hostname.includes("storage.supabase.")&&(r.hostname=r.hostname.replace("supabase.","storage.supabase."));const n=r.href.replace(/\/$/,""),a=de(de({},ba),e);super(n,a,i,"storage")}async listBuckets(t){var e=this;return e.handleOperation(async()=>{const i=e.listBucketOptionsToQueryString(t);return await ia(e.fetch,`${e.url}/bucket${i}`,{headers:e.headers})})}async getBucket(t){var e=this;return e.handleOperation(async()=>await ia(e.fetch,`${e.url}/bucket/${t}`,{headers:e.headers}))}async createBucket(t,e={public:!1}){var i=this;return i.handleOperation(async()=>await Be(i.fetch,`${i.url}/bucket`,{id:t,name:t,type:e.type,public:e.public,file_size_limit:e.fileSizeLimit,allowed_mime_types:e.allowedMimeTypes},{headers:i.headers}))}async updateBucket(t,e){var i=this;return i.handleOperation(async()=>await Uc(i.fetch,`${i.url}/bucket/${t}`,{id:t,name:t,public:e.public,file_size_limit:e.fileSizeLimit,allowed_mime_types:e.allowedMimeTypes},{headers:i.headers}))}async emptyBucket(t){var e=this;return e.handleOperation(async()=>await Be(e.fetch,`${e.url}/bucket/${t}/empty`,{},{headers:e.headers}))}async deleteBucket(t){var e=this;return e.handleOperation(async()=>await td(e.fetch,`${e.url}/bucket/${t}`,{},{headers:e.headers}))}listBucketOptionsToQueryString(t){const e={};return t&&("limit"in t&&(e.limit=String(t.limit)),"offset"in t&&(e.offset=String(t.offset)),t.search&&(e.search=t.search),t.sortColumn&&(e.sortColumn=t.sortColumn),t.sortOrder&&(e.sortOrder=t.sortOrder)),Object.keys(e).length>0?"?"+new URLSearchParams(e).toString():""}},Eb=class extends sn{constructor(t,e={},i){const s=t.replace(/\/$/,""),r=de(de({},ba),e);super(s,r,i,"storage")}async createBucket(t){var e=this;return e.handleOperation(async()=>await Be(e.fetch,`${e.url}/bucket`,{name:t},{headers:e.headers}))}async listBuckets(t){var e=this;return e.handleOperation(async()=>{const i=new URLSearchParams;(t==null?void 0:t.limit)!==void 0&&i.set("limit",t.limit.toString()),(t==null?void 0:t.offset)!==void 0&&i.set("offset",t.offset.toString()),t!=null&&t.sortColumn&&i.set("sortColumn",t.sortColumn),t!=null&&t.sortOrder&&i.set("sortOrder",t.sortOrder),t!=null&&t.search&&i.set("search",t.search);const s=i.toString(),r=s?`${e.url}/bucket?${s}`:`${e.url}/bucket`;return await ia(e.fetch,r,{headers:e.headers})})}async deleteBucket(t){var e=this;return e.handleOperation(async()=>await td(e.fetch,`${e.url}/bucket/${t}`,{},{headers:e.headers}))}from(t){var e=this;if(!db(t))throw new sl("Invalid bucket name: File, folder, and bucket names must follow AWS object key naming guidelines and should avoid the use of any other characters.");const i=new lb({baseUrl:this.url,catalogName:t,auth:{type:"custom",getHeaders:async()=>e.headers},fetch:this.fetch}),s=this.shouldThrowOnError;return new Proxy(i,{get(r,n){const a=r[n];return typeof a!="function"?a:async(...o)=>{try{return{data:await a.apply(r,o),error:null}}catch(l){if(s)throw l;return{data:null,error:l}}}}})}},Pb=class extends sn{constructor(t,e={},i){const s=t.replace(/\/$/,""),r=de(de({},ba),{},{"Content-Type":"application/json"},e);super(s,r,i,"vectors")}async createIndex(t){var e=this;return e.handleOperation(async()=>await Be(e.fetch,`${e.url}/CreateIndex`,t,{headers:e.headers})||{})}async getIndex(t,e){var i=this;return i.handleOperation(async()=>await Be(i.fetch,`${i.url}/GetIndex`,{vectorBucketName:t,indexName:e},{headers:i.headers}))}async listIndexes(t){var e=this;return e.handleOperation(async()=>await Be(e.fetch,`${e.url}/ListIndexes`,t,{headers:e.headers}))}async deleteIndex(t,e){var i=this;return i.handleOperation(async()=>await Be(i.fetch,`${i.url}/DeleteIndex`,{vectorBucketName:t,indexName:e},{headers:i.headers})||{})}},Cb=class extends sn{constructor(t,e={},i){const s=t.replace(/\/$/,""),r=de(de({},ba),{},{"Content-Type":"application/json"},e);super(s,r,i,"vectors")}async putVectors(t){var e=this;if(t.vectors.length<1||t.vectors.length>500)throw new Error("Vector batch size must be between 1 and 500 items");return e.handleOperation(async()=>await Be(e.fetch,`${e.url}/PutVectors`,t,{headers:e.headers})||{})}async getVectors(t){var e=this;return e.handleOperation(async()=>await Be(e.fetch,`${e.url}/GetVectors`,t,{headers:e.headers}))}async listVectors(t){var e=this;if(t.segmentCount!==void 0){if(t.segmentCount<1||t.segmentCount>16)throw new Error("segmentCount must be between 1 and 16");if(t.segmentIndex!==void 0&&(t.segmentIndex<0||t.segmentIndex>=t.segmentCount))throw new Error(`segmentIndex must be between 0 and ${t.segmentCount-1}`)}return e.handleOperation(async()=>await Be(e.fetch,`${e.url}/ListVectors`,t,{headers:e.headers}))}async queryVectors(t){var e=this;return e.handleOperation(async()=>await Be(e.fetch,`${e.url}/QueryVectors`,t,{headers:e.headers}))}async deleteVectors(t){var e=this;if(t.keys.length<1||t.keys.length>500)throw new Error("Keys batch size must be between 1 and 500 items");return e.handleOperation(async()=>await Be(e.fetch,`${e.url}/DeleteVectors`,t,{headers:e.headers})||{})}},_b=class extends sn{constructor(t,e={},i){const s=t.replace(/\/$/,""),r=de(de({},ba),{},{"Content-Type":"application/json"},e);super(s,r,i,"vectors")}async createBucket(t){var e=this;return e.handleOperation(async()=>await Be(e.fetch,`${e.url}/CreateVectorBucket`,{vectorBucketName:t},{headers:e.headers})||{})}async getBucket(t){var e=this;return e.handleOperation(async()=>await Be(e.fetch,`${e.url}/GetVectorBucket`,{vectorBucketName:t},{headers:e.headers}))}async listBuckets(t={}){var e=this;return e.handleOperation(async()=>await Be(e.fetch,`${e.url}/ListVectorBuckets`,t,{headers:e.headers}))}async deleteBucket(t){var e=this;return e.handleOperation(async()=>await Be(e.fetch,`${e.url}/DeleteVectorBucket`,{vectorBucketName:t},{headers:e.headers})||{})}},Rb=class extends _b{constructor(t,e={}){super(t,e.headers||{},e.fetch)}from(t){return new $b(this.url,this.headers,t,this.fetch)}async createBucket(t){var e=()=>super.createBucket,i=this;return e().call(i,t)}async getBucket(t){var e=()=>super.getBucket,i=this;return e().call(i,t)}async listBuckets(t={}){var e=()=>super.listBuckets,i=this;return e().call(i,t)}async deleteBucket(t){var e=()=>super.deleteBucket,i=this;return e().call(i,t)}},$b=class extends Pb{constructor(t,e,i,s){super(t,e,s),this.vectorBucketName=i}async createIndex(t){var e=()=>super.createIndex,i=this;return e().call(i,de(de({},t),{},{vectorBucketName:i.vectorBucketName}))}async listIndexes(t={}){var e=()=>super.listIndexes,i=this;return e().call(i,de(de({},t),{},{vectorBucketName:i.vectorBucketName}))}async getIndex(t){var e=()=>super.getIndex,i=this;return e().call(i,i.vectorBucketName,t)}async deleteIndex(t){var e=()=>super.deleteIndex,i=this;return e().call(i,i.vectorBucketName,t)}index(t){return new Ib(this.url,this.headers,this.vectorBucketName,t,this.fetch)}},Ib=class extends Cb{constructor(t,e,i,s,r){super(t,e,r),this.vectorBucketName=i,this.indexName=s}async putVectors(t){var e=()=>super.putVectors,i=this;return e().call(i,de(de({},t),{},{vectorBucketName:i.vectorBucketName,indexName:i.indexName}))}async getVectors(t){var e=()=>super.getVectors,i=this;return e().call(i,de(de({},t),{},{vectorBucketName:i.vectorBucketName,indexName:i.indexName}))}async listVectors(t={}){var e=()=>super.listVectors,i=this;return e().call(i,de(de({},t),{},{vectorBucketName:i.vectorBucketName,indexName:i.indexName}))}async queryVectors(t){var e=()=>super.queryVectors,i=this;return e().call(i,de(de({},t),{},{vectorBucketName:i.vectorBucketName,indexName:i.indexName}))}async deleteVectors(t){var e=()=>super.deleteVectors,i=this;return e().call(i,de(de({},t),{},{vectorBucketName:i.vectorBucketName,indexName:i.indexName}))}},Qb=class extends Tb{constructor(t,e={},i,s){super(t,e,i,s)}from(t){return new xb(this.url,this.headers,t,this.fetch)}get vectors(){return new Rb(this.url+"/vector",{headers:this.headers,fetch:this.fetch})}get analytics(){return new Eb(this.url+"/iceberg",this.headers,this.fetch)}};const Eg="2.93.1",Cr=30*1e3,Vc=3,ec=Vc*Cr,Ab="http://localhost:9999",Lb="supabase.auth.token",Nb={"X-Client-Info":`gotrue-js/${Eg}`},zc="X-Supabase-Api-Version",Pg={"2024-01-01":{timestamp:Date.parse("2024-01-01T00:00:00.0Z"),name:"2024-01-01"}},Mb=/^([a-z0-9_-]{4})*($|[a-z0-9_-]{3}$|[a-z0-9_-]{2}$)$/i,qb=10*60*1e3;class sa extends Error{constructor(e,i,s){super(e),this.__isAuthError=!0,this.name="AuthError",this.status=i,this.code=s}}function ae(t){return typeof t=="object"&&t!==null&&"__isAuthError"in t}class Db extends sa{constructor(e,i,s){super(e,i,s),this.name="AuthApiError",this.status=i,this.code=s}}function Bb(t){return ae(t)&&t.name==="AuthApiError"}class Fs extends sa{constructor(e,i){super(e),this.name="AuthUnknownError",this.originalError=i}}class rs extends sa{constructor(e,i,s,r){super(e,s,r),this.name=i,this.status=s}}class Wt extends rs{constructor(){super("Auth session missing!","AuthSessionMissingError",400,void 0)}}function tc(t){return ae(t)&&t.name==="AuthSessionMissingError"}class wr extends rs{constructor(){super("Auth session or user missing","AuthInvalidTokenResponseError",500,void 0)}}class za extends rs{constructor(e){super(e,"AuthInvalidCredentialsError",400,void 0)}}class Xa extends rs{constructor(e,i=null){super(e,"AuthImplicitGrantRedirectError",500,void 0),this.details=null,this.details=i}toJSON(){return{name:this.name,message:this.message,status:this.status,details:this.details}}}function jb(t){return ae(t)&&t.name==="AuthImplicitGrantRedirectError"}class Bu extends rs{constructor(e,i=null){super(e,"AuthPKCEGrantCodeExchangeError",500,void 0),this.details=null,this.details=i}toJSON(){return{name:this.name,message:this.message,status:this.status,details:this.details}}}class Wb extends rs{constructor(){super("PKCE code verifier not found in storage. This can happen if the auth flow was initiated in a different browser or device, or if the storage was cleared. For SSR frameworks (Next.js, SvelteKit, etc.), use @supabase/ssr on both the server and client to store the code verifier in cookies.","AuthPKCECodeVerifierMissingError",400,"pkce_code_verifier_not_found")}}class Xc extends rs{constructor(e,i){super(e,"AuthRetryableFetchError",i,void 0)}}function ic(t){return ae(t)&&t.name==="AuthRetryableFetchError"}class ju extends rs{constructor(e,i,s){super(e,"AuthWeakPasswordError",i,"weak_password"),this.reasons=s}}class Gc extends rs{constructor(e){super(e,"AuthInvalidJwtError",400,"invalid_jwt")}}const _o="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-_".split(""),Wu=` 	
\r=`.split(""),Fb=(()=>{const t=new Array(128);for(let e=0;e<t.length;e+=1)t[e]=-1;for(let e=0;e<Wu.length;e+=1)t[Wu[e].charCodeAt(0)]=-2;for(let e=0;e<_o.length;e+=1)t[_o[e].charCodeAt(0)]=e;return t})();function Fu(t,e,i){if(t!==null)for(e.queue=e.queue<<8|t,e.queuedBits+=8;e.queuedBits>=6;){const s=e.queue>>e.queuedBits-6&63;i(_o[s]),e.queuedBits-=6}else if(e.queuedBits>0)for(e.queue=e.queue<<6-e.queuedBits,e.queuedBits=6;e.queuedBits>=6;){const s=e.queue>>e.queuedBits-6&63;i(_o[s]),e.queuedBits-=6}}function Cg(t,e,i){const s=Fb[t];if(s>-1)for(e.queue=e.queue<<6|s,e.queuedBits+=6;e.queuedBits>=8;)i(e.queue>>e.queuedBits-8&255),e.queuedBits-=8;else{if(s===-2)return;throw new Error(`Invalid Base64-URL character "${String.fromCharCode(t)}"`)}}function Uu(t){const e=[],i=a=>{e.push(String.fromCodePoint(a))},s={utf8seq:0,codepoint:0},r={queue:0,queuedBits:0},n=a=>{zb(a,s,i)};for(let a=0;a<t.length;a+=1)Cg(t.charCodeAt(a),r,n);return e.join("")}function Ub(t,e){if(t<=127){e(t);return}else if(t<=2047){e(192|t>>6),e(128|t&63);return}else if(t<=65535){e(224|t>>12),e(128|t>>6&63),e(128|t&63);return}else if(t<=1114111){e(240|t>>18),e(128|t>>12&63),e(128|t>>6&63),e(128|t&63);return}throw new Error(`Unrecognized Unicode codepoint: ${t.toString(16)}`)}function Vb(t,e){for(let i=0;i<t.length;i+=1){let s=t.charCodeAt(i);if(s>55295&&s<=56319){const r=(s-55296)*1024&65535;s=(t.charCodeAt(i+1)-56320&65535|r)+65536,i+=1}Ub(s,e)}}function zb(t,e,i){if(e.utf8seq===0){if(t<=127){i(t);return}for(let s=1;s<6;s+=1)if(!(t>>7-s&1)){e.utf8seq=s;break}if(e.utf8seq===2)e.codepoint=t&31;else if(e.utf8seq===3)e.codepoint=t&15;else if(e.utf8seq===4)e.codepoint=t&7;else throw new Error("Invalid UTF-8 sequence");e.utf8seq-=1}else if(e.utf8seq>0){if(t<=127)throw new Error("Invalid UTF-8 sequence");e.codepoint=e.codepoint<<6|t&63,e.utf8seq-=1,e.utf8seq===0&&i(e.codepoint)}}function Dr(t){const e=[],i={queue:0,queuedBits:0},s=r=>{e.push(r)};for(let r=0;r<t.length;r+=1)Cg(t.charCodeAt(r),i,s);return new Uint8Array(e)}function Xb(t){const e=[];return Vb(t,i=>e.push(i)),new Uint8Array(e)}function Gs(t){const e=[],i={queue:0,queuedBits:0},s=r=>{e.push(r)};return t.forEach(r=>Fu(r,i,s)),Fu(null,i,s),e.join("")}function Gb(t){return Math.round(Date.now()/1e3)+t}function Yb(){return Symbol("auth-callback")}const pt=()=>typeof window<"u"&&typeof document<"u",Ns={tested:!1,writable:!1},_g=()=>{if(!pt())return!1;try{if(typeof globalThis.localStorage!="object")return!1}catch{return!1}if(Ns.tested)return Ns.writable;const t=`lswt-${Math.random()}${Math.random()}`;try{globalThis.localStorage.setItem(t,t),globalThis.localStorage.removeItem(t),Ns.tested=!0,Ns.writable=!0}catch{Ns.tested=!0,Ns.writable=!1}return Ns.writable};function Zb(t){const e={},i=new URL(t);if(i.hash&&i.hash[0]==="#")try{new URLSearchParams(i.hash.substring(1)).forEach((r,n)=>{e[n]=r})}catch{}return i.searchParams.forEach((s,r)=>{e[r]=s}),e}const Rg=t=>t?(...e)=>t(...e):(...e)=>fetch(...e),Hb=t=>typeof t=="object"&&t!==null&&"status"in t&&"ok"in t&&"json"in t&&typeof t.json=="function",_r=async(t,e,i)=>{await t.setItem(e,JSON.stringify(i))},Ms=async(t,e)=>{const i=await t.getItem(e);if(!i)return null;try{return JSON.parse(i)}catch{return i}},ht=async(t,e)=>{await t.removeItem(e)};class nl{constructor(){this.promise=new nl.promiseConstructor((e,i)=>{this.resolve=e,this.reject=i})}}nl.promiseConstructor=Promise;function Ga(t){const e=t.split(".");if(e.length!==3)throw new Gc("Invalid JWT structure");for(let s=0;s<e.length;s++)if(!Mb.test(e[s]))throw new Gc("JWT not in base64url format");return{header:JSON.parse(Uu(e[0])),payload:JSON.parse(Uu(e[1])),signature:Dr(e[2]),raw:{header:e[0],payload:e[1]}}}async function Kb(t){return await new Promise(e=>{setTimeout(()=>e(null),t)})}function Jb(t,e){return new Promise((s,r)=>{(async()=>{for(let n=0;n<1/0;n++)try{const a=await t(n);if(!e(n,null,a)){s(a);return}}catch(a){if(!e(n,a)){r(a);return}}})()})}function ew(t){return("0"+t.toString(16)).substr(-2)}function tw(){const e=new Uint32Array(56);if(typeof crypto>"u"){const i="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-._~",s=i.length;let r="";for(let n=0;n<56;n++)r+=i.charAt(Math.floor(Math.random()*s));return r}return crypto.getRandomValues(e),Array.from(e,ew).join("")}async function iw(t){const i=new TextEncoder().encode(t),s=await crypto.subtle.digest("SHA-256",i),r=new Uint8Array(s);return Array.from(r).map(n=>String.fromCharCode(n)).join("")}async function sw(t){if(!(typeof crypto<"u"&&typeof crypto.subtle<"u"&&typeof TextEncoder<"u"))return console.warn("WebCrypto API is not supported. Code challenge method will default to use plain instead of sha256."),t;const i=await iw(t);return btoa(i).replace(/\+/g,"-").replace(/\//g,"_").replace(/=+$/,"")}async function Sr(t,e,i=!1){const s=tw();let r=s;i&&(r+="/PASSWORD_RECOVERY"),await _r(t,`${e}-code-verifier`,r);const n=await sw(s);return[n,s===n?"plain":"s256"]}const rw=/^2[0-9]{3}-(0[1-9]|1[0-2])-(0[1-9]|1[0-9]|2[0-9]|3[0-1])$/i;function nw(t){const e=t.headers.get(zc);if(!e||!e.match(rw))return null;try{return new Date(`${e}T00:00:00.0Z`)}catch{return null}}function aw(t){if(!t)throw new Error("Missing exp claim");const e=Math.floor(Date.now()/1e3);if(t<=e)throw new Error("JWT has expired")}function ow(t){switch(t){case"RS256":return{name:"RSASSA-PKCS1-v1_5",hash:{name:"SHA-256"}};case"ES256":return{name:"ECDSA",namedCurve:"P-256",hash:{name:"SHA-256"}};default:throw new Error("Invalid alg claim")}}const lw=/^[0-9a-f]{8}-[0-9a-f]{4}-[0-9a-f]{4}-[0-9a-f]{4}-[0-9a-f]{12}$/;function xr(t){if(!lw.test(t))throw new Error("@supabase/auth-js: Expected parameter to be UUID but is not")}function sc(){const t={};return new Proxy(t,{get:(e,i)=>{if(i==="__isUserNotAvailableProxy")return!0;if(typeof i=="symbol"){const s=i.toString();if(s==="Symbol(Symbol.toPrimitive)"||s==="Symbol(Symbol.toStringTag)"||s==="Symbol(util.inspect.custom)")return}throw new Error(`@supabase/auth-js: client was created with userStorage option and there was no user stored in the user storage. Accessing the "${i}" property of the session object is not supported. Please use getUser() instead.`)},set:(e,i)=>{throw new Error(`@supabase/auth-js: client was created with userStorage option and there was no user stored in the user storage. Setting the "${i}" property of the session object is not supported. Please use getUser() to fetch a user object you can manipulate.`)},deleteProperty:(e,i)=>{throw new Error(`@supabase/auth-js: client was created with userStorage option and there was no user stored in the user storage. Deleting the "${i}" property of the session object is not supported. Please use getUser() to fetch a user object you can manipulate.`)}})}function cw(t,e){return new Proxy(t,{get:(i,s,r)=>{if(s==="__isInsecureUserWarningProxy")return!0;if(typeof s=="symbol"){const n=s.toString();if(n==="Symbol(Symbol.toPrimitive)"||n==="Symbol(Symbol.toStringTag)"||n==="Symbol(util.inspect.custom)"||n==="Symbol(nodejs.util.inspect.custom)")return Reflect.get(i,s,r)}return!e.value&&typeof s=="string"&&(console.warn("Using the user object as returned from supabase.auth.getSession() or from some supabase.auth.onAuthStateChange() events could be insecure! This value comes directly from the storage medium (usually cookies on the server) and may not be authentic. Use supabase.auth.getUser() instead which authenticates the data by contacting the Supabase Auth server."),e.value=!0),Reflect.get(i,s,r)}})}function Vu(t){return JSON.parse(JSON.stringify(t))}const Ds=t=>t.msg||t.message||t.error_description||t.error||JSON.stringify(t),hw=[502,503,504];async function zu(t){var e;if(!Hb(t))throw new Xc(Ds(t),0);if(hw.includes(t.status))throw new Xc(Ds(t),t.status);let i;try{i=await t.json()}catch(n){throw new Fs(Ds(n),n)}let s;const r=nw(t);if(r&&r.getTime()>=Pg["2024-01-01"].timestamp&&typeof i=="object"&&i&&typeof i.code=="string"?s=i.code:typeof i=="object"&&i&&typeof i.error_code=="string"&&(s=i.error_code),s){if(s==="weak_password")throw new ju(Ds(i),t.status,((e=i.weak_password)===null||e===void 0?void 0:e.reasons)||[]);if(s==="session_not_found")throw new Wt}else if(typeof i=="object"&&i&&typeof i.weak_password=="object"&&i.weak_password&&Array.isArray(i.weak_password.reasons)&&i.weak_password.reasons.length&&i.weak_password.reasons.reduce((n,a)=>n&&typeof a=="string",!0))throw new ju(Ds(i),t.status,i.weak_password.reasons);throw new Db(Ds(i),t.status||500,s)}const dw=(t,e,i,s)=>{const r={method:t,headers:(e==null?void 0:e.headers)||{}};return t==="GET"?r:(r.headers=Object.assign({"Content-Type":"application/json;charset=UTF-8"},e==null?void 0:e.headers),r.body=JSON.stringify(s),Object.assign(Object.assign({},r),i))};async function he(t,e,i,s){var r;const n=Object.assign({},s==null?void 0:s.headers);n[zc]||(n[zc]=Pg["2024-01-01"].name),s!=null&&s.jwt&&(n.Authorization=`Bearer ${s.jwt}`);const a=(r=s==null?void 0:s.query)!==null&&r!==void 0?r:{};s!=null&&s.redirectTo&&(a.redirect_to=s.redirectTo);const o=Object.keys(a).length?"?"+new URLSearchParams(a).toString():"",l=await uw(t,e,i+o,{headers:n,noResolveJson:s==null?void 0:s.noResolveJson},{},s==null?void 0:s.body);return s!=null&&s.xform?s==null?void 0:s.xform(l):{data:Object.assign({},l),error:null}}async function uw(t,e,i,s,r,n){const a=dw(e,s,r,n);let o;try{o=await t(i,Object.assign({},a))}catch(l){throw console.error(l),new Xc(Ds(l),0)}if(o.ok||await zu(o),s!=null&&s.noResolveJson)return o;try{return await o.json()}catch(l){await zu(l)}}function oi(t){var e;let i=null;gw(t)&&(i=Object.assign({},t),t.expires_at||(i.expires_at=Gb(t.expires_in)));const s=(e=t.user)!==null&&e!==void 0?e:t;return{data:{session:i,user:s},error:null}}function Xu(t){const e=oi(t);return!e.error&&t.weak_password&&typeof t.weak_password=="object"&&Array.isArray(t.weak_password.reasons)&&t.weak_password.reasons.length&&t.weak_password.message&&typeof t.weak_password.message=="string"&&t.weak_password.reasons.reduce((i,s)=>i&&typeof s=="string",!0)&&(e.data.weak_password=t.weak_password),e}function ms(t){var e;return{data:{user:(e=t.user)!==null&&e!==void 0?e:t},error:null}}function pw(t){return{data:t,error:null}}function fw(t){const{action_link:e,email_otp:i,hashed_token:s,redirect_to:r,verification_type:n}=t,a=il(t,["action_link","email_otp","hashed_token","redirect_to","verification_type"]),o={action_link:e,email_otp:i,hashed_token:s,redirect_to:r,verification_type:n},l=Object.assign({},a);return{data:{properties:o,user:l},error:null}}function Gu(t){return t}function gw(t){return t.access_token&&t.refresh_token&&t.expires_in}const rc=["global","local","others"];class mw{constructor({url:e="",headers:i={},fetch:s}){this.url=e,this.headers=i,this.fetch=Rg(s),this.mfa={listFactors:this._listFactors.bind(this),deleteFactor:this._deleteFactor.bind(this)},this.oauth={listClients:this._listOAuthClients.bind(this),createClient:this._createOAuthClient.bind(this),getClient:this._getOAuthClient.bind(this),updateClient:this._updateOAuthClient.bind(this),deleteClient:this._deleteOAuthClient.bind(this),regenerateClientSecret:this._regenerateOAuthClientSecret.bind(this)}}async signOut(e,i=rc[0]){if(rc.indexOf(i)<0)throw new Error(`@supabase/auth-js: Parameter scope must be one of ${rc.join(", ")}`);try{return await he(this.fetch,"POST",`${this.url}/logout?scope=${i}`,{headers:this.headers,jwt:e,noResolveJson:!0}),{data:null,error:null}}catch(s){if(ae(s))return{data:null,error:s};throw s}}async inviteUserByEmail(e,i={}){try{return await he(this.fetch,"POST",`${this.url}/invite`,{body:{email:e,data:i.data},headers:this.headers,redirectTo:i.redirectTo,xform:ms})}catch(s){if(ae(s))return{data:{user:null},error:s};throw s}}async generateLink(e){try{const{options:i}=e,s=il(e,["options"]),r=Object.assign(Object.assign({},s),i);return"newEmail"in s&&(r.new_email=s==null?void 0:s.newEmail,delete r.newEmail),await he(this.fetch,"POST",`${this.url}/admin/generate_link`,{body:r,headers:this.headers,xform:fw,redirectTo:i==null?void 0:i.redirectTo})}catch(i){if(ae(i))return{data:{properties:null,user:null},error:i};throw i}}async createUser(e){try{return await he(this.fetch,"POST",`${this.url}/admin/users`,{body:e,headers:this.headers,xform:ms})}catch(i){if(ae(i))return{data:{user:null},error:i};throw i}}async listUsers(e){var i,s,r,n,a,o,l;try{const c={nextPage:null,lastPage:0,total:0},h=await he(this.fetch,"GET",`${this.url}/admin/users`,{headers:this.headers,noResolveJson:!0,query:{page:(s=(i=e==null?void 0:e.page)===null||i===void 0?void 0:i.toString())!==null&&s!==void 0?s:"",per_page:(n=(r=e==null?void 0:e.perPage)===null||r===void 0?void 0:r.toString())!==null&&n!==void 0?n:""},xform:Gu});if(h.error)throw h.error;const d=await h.json(),u=(a=h.headers.get("x-total-count"))!==null&&a!==void 0?a:0,p=(l=(o=h.headers.get("link"))===null||o===void 0?void 0:o.split(","))!==null&&l!==void 0?l:[];return p.length>0&&(p.forEach(f=>{const g=parseInt(f.split(";")[0].split("=")[1].substring(0,1)),m=JSON.parse(f.split(";")[1].split("=")[1]);c[`${m}Page`]=g}),c.total=parseInt(u)),{data:Object.assign(Object.assign({},d),c),error:null}}catch(c){if(ae(c))return{data:{users:[]},error:c};throw c}}async getUserById(e){xr(e);try{return await he(this.fetch,"GET",`${this.url}/admin/users/${e}`,{headers:this.headers,xform:ms})}catch(i){if(ae(i))return{data:{user:null},error:i};throw i}}async updateUserById(e,i){xr(e);try{return await he(this.fetch,"PUT",`${this.url}/admin/users/${e}`,{body:i,headers:this.headers,xform:ms})}catch(s){if(ae(s))return{data:{user:null},error:s};throw s}}async deleteUser(e,i=!1){xr(e);try{return await he(this.fetch,"DELETE",`${this.url}/admin/users/${e}`,{headers:this.headers,body:{should_soft_delete:i},xform:ms})}catch(s){if(ae(s))return{data:{user:null},error:s};throw s}}async _listFactors(e){xr(e.userId);try{const{data:i,error:s}=await he(this.fetch,"GET",`${this.url}/admin/users/${e.userId}/factors`,{headers:this.headers,xform:r=>({data:{factors:r},error:null})});return{data:i,error:s}}catch(i){if(ae(i))return{data:null,error:i};throw i}}async _deleteFactor(e){xr(e.userId),xr(e.id);try{return{data:await he(this.fetch,"DELETE",`${this.url}/admin/users/${e.userId}/factors/${e.id}`,{headers:this.headers}),error:null}}catch(i){if(ae(i))return{data:null,error:i};throw i}}async _listOAuthClients(e){var i,s,r,n,a,o,l;try{const c={nextPage:null,lastPage:0,total:0},h=await he(this.fetch,"GET",`${this.url}/admin/oauth/clients`,{headers:this.headers,noResolveJson:!0,query:{page:(s=(i=e==null?void 0:e.page)===null||i===void 0?void 0:i.toString())!==null&&s!==void 0?s:"",per_page:(n=(r=e==null?void 0:e.perPage)===null||r===void 0?void 0:r.toString())!==null&&n!==void 0?n:""},xform:Gu});if(h.error)throw h.error;const d=await h.json(),u=(a=h.headers.get("x-total-count"))!==null&&a!==void 0?a:0,p=(l=(o=h.headers.get("link"))===null||o===void 0?void 0:o.split(","))!==null&&l!==void 0?l:[];return p.length>0&&(p.forEach(f=>{const g=parseInt(f.split(";")[0].split("=")[1].substring(0,1)),m=JSON.parse(f.split(";")[1].split("=")[1]);c[`${m}Page`]=g}),c.total=parseInt(u)),{data:Object.assign(Object.assign({},d),c),error:null}}catch(c){if(ae(c))return{data:{clients:[]},error:c};throw c}}async _createOAuthClient(e){try{return await he(this.fetch,"POST",`${this.url}/admin/oauth/clients`,{body:e,headers:this.headers,xform:i=>({data:i,error:null})})}catch(i){if(ae(i))return{data:null,error:i};throw i}}async _getOAuthClient(e){try{return await he(this.fetch,"GET",`${this.url}/admin/oauth/clients/${e}`,{headers:this.headers,xform:i=>({data:i,error:null})})}catch(i){if(ae(i))return{data:null,error:i};throw i}}async _updateOAuthClient(e,i){try{return await he(this.fetch,"PUT",`${this.url}/admin/oauth/clients/${e}`,{body:i,headers:this.headers,xform:s=>({data:s,error:null})})}catch(s){if(ae(s))return{data:null,error:s};throw s}}async _deleteOAuthClient(e){try{return await he(this.fetch,"DELETE",`${this.url}/admin/oauth/clients/${e}`,{headers:this.headers,noResolveJson:!0}),{data:null,error:null}}catch(i){if(ae(i))return{data:null,error:i};throw i}}async _regenerateOAuthClientSecret(e){try{return await he(this.fetch,"POST",`${this.url}/admin/oauth/clients/${e}/regenerate_secret`,{headers:this.headers,xform:i=>({data:i,error:null})})}catch(i){if(ae(i))return{data:null,error:i};throw i}}}function Yu(t={}){return{getItem:e=>t[e]||null,setItem:(e,i)=>{t[e]=i},removeItem:e=>{delete t[e]}}}const kr={debug:!!(globalThis&&_g()&&globalThis.localStorage&&globalThis.localStorage.getItem("supabase.gotrue-js.locks.debug")==="true")};class $g extends Error{constructor(e){super(e),this.isAcquireTimeout=!0}}class Ow extends $g{}async function yw(t,e,i){kr.debug&&console.log("@supabase/gotrue-js: navigatorLock: acquire lock",t,e);const s=new globalThis.AbortController;return e>0&&setTimeout(()=>{s.abort(),kr.debug&&console.log("@supabase/gotrue-js: navigatorLock acquire timed out",t)},e),await Promise.resolve().then(()=>globalThis.navigator.locks.request(t,e===0?{mode:"exclusive",ifAvailable:!0}:{mode:"exclusive",signal:s.signal},async r=>{if(r){kr.debug&&console.log("@supabase/gotrue-js: navigatorLock: acquired",t,r.name);try{return await i()}finally{kr.debug&&console.log("@supabase/gotrue-js: navigatorLock: released",t,r.name)}}else{if(e===0)throw kr.debug&&console.log("@supabase/gotrue-js: navigatorLock: not immediately available",t),new Ow(`Acquiring an exclusive Navigator LockManager lock "${t}" immediately failed`);if(kr.debug)try{const n=await globalThis.navigator.locks.query();console.log("@supabase/gotrue-js: Navigator LockManager state",JSON.stringify(n,null,"  "))}catch(n){console.warn("@supabase/gotrue-js: Error when querying Navigator LockManager state",n)}return console.warn("@supabase/gotrue-js: Navigator LockManager returned a null lock when using #request without ifAvailable set to true, it appears this browser is not following the LockManager spec https://developer.mozilla.org/en-US/docs/Web/API/LockManager/request"),await i()}}))}function vw(){if(typeof globalThis!="object")try{Object.defineProperty(Object.prototype,"__magic__",{get:function(){return this},configurable:!0}),__magic__.globalThis=__magic__,delete Object.prototype.__magic__}catch{typeof self<"u"&&(self.globalThis=self)}}function Ig(t){if(!/^0x[a-fA-F0-9]{40}$/.test(t))throw new Error(`@supabase/auth-js: Address "${t}" is invalid.`);return t.toLowerCase()}function bw(t){return parseInt(t,16)}function ww(t){const e=new TextEncoder().encode(t);return"0x"+Array.from(e,s=>s.toString(16).padStart(2,"0")).join("")}function Sw(t){var e;const{chainId:i,domain:s,expirationTime:r,issuedAt:n=new Date,nonce:a,notBefore:o,requestId:l,resources:c,scheme:h,uri:d,version:u}=t;{if(!Number.isInteger(i))throw new Error(`@supabase/auth-js: Invalid SIWE message field "chainId". Chain ID must be a EIP-155 chain ID. Provided value: ${i}`);if(!s)throw new Error('@supabase/auth-js: Invalid SIWE message field "domain". Domain must be provided.');if(a&&a.length<8)throw new Error(`@supabase/auth-js: Invalid SIWE message field "nonce". Nonce must be at least 8 characters. Provided value: ${a}`);if(!d)throw new Error('@supabase/auth-js: Invalid SIWE message field "uri". URI must be provided.');if(u!=="1")throw new Error(`@supabase/auth-js: Invalid SIWE message field "version". Version must be '1'. Provided value: ${u}`);if(!((e=t.statement)===null||e===void 0)&&e.includes(`
`))throw new Error(`@supabase/auth-js: Invalid SIWE message field "statement". Statement must not include '\\n'. Provided value: ${t.statement}`)}const p=Ig(t.address),f=h?`${h}://${s}`:s,g=t.statement?`${t.statement}
`:"",m=`${f} wants you to sign in with your Ethereum account:
${p}

${g}`;let y=`URI: ${d}
Version: ${u}
Chain ID: ${i}${a?`
Nonce: ${a}`:""}
Issued At: ${n.toISOString()}`;if(r&&(y+=`
Expiration Time: ${r.toISOString()}`),o&&(y+=`
Not Before: ${o.toISOString()}`),l&&(y+=`
Request ID: ${l}`),c){let b=`
Resources:`;for(const w of c){if(!w||typeof w!="string")throw new Error(`@supabase/auth-js: Invalid SIWE message field "resources". Every resource must be a valid string. Provided value: ${w}`);b+=`
- ${w}`}y+=b}return`${m}
${y}`}class Je extends Error{constructor({message:e,code:i,cause:s,name:r}){var n;super(e,{cause:s}),this.__isWebAuthnError=!0,this.name=(n=r??(s instanceof Error?s.name:void 0))!==null&&n!==void 0?n:"Unknown Error",this.code=i}}class Ro extends Je{constructor(e,i){super({code:"ERROR_PASSTHROUGH_SEE_CAUSE_PROPERTY",cause:i,message:e}),this.name="WebAuthnUnknownError",this.originalError=i}}function xw({error:t,options:e}){var i,s,r;const{publicKey:n}=e;if(!n)throw Error("options was missing required publicKey property");if(t.name==="AbortError"){if(e.signal instanceof AbortSignal)return new Je({message:"Registration ceremony was sent an abort signal",code:"ERROR_CEREMONY_ABORTED",cause:t})}else if(t.name==="ConstraintError"){if(((i=n.authenticatorSelection)===null||i===void 0?void 0:i.requireResidentKey)===!0)return new Je({message:"Discoverable credentials were required but no available authenticator supported it",code:"ERROR_AUTHENTICATOR_MISSING_DISCOVERABLE_CREDENTIAL_SUPPORT",cause:t});if(e.mediation==="conditional"&&((s=n.authenticatorSelection)===null||s===void 0?void 0:s.userVerification)==="required")return new Je({message:"User verification was required during automatic registration but it could not be performed",code:"ERROR_AUTO_REGISTER_USER_VERIFICATION_FAILURE",cause:t});if(((r=n.authenticatorSelection)===null||r===void 0?void 0:r.userVerification)==="required")return new Je({message:"User verification was required but no available authenticator supported it",code:"ERROR_AUTHENTICATOR_MISSING_USER_VERIFICATION_SUPPORT",cause:t})}else{if(t.name==="InvalidStateError")return new Je({message:"The authenticator was previously registered",code:"ERROR_AUTHENTICATOR_PREVIOUSLY_REGISTERED",cause:t});if(t.name==="NotAllowedError")return new Je({message:t.message,code:"ERROR_PASSTHROUGH_SEE_CAUSE_PROPERTY",cause:t});if(t.name==="NotSupportedError")return n.pubKeyCredParams.filter(o=>o.type==="public-key").length===0?new Je({message:'No entry in pubKeyCredParams was of type "public-key"',code:"ERROR_MALFORMED_PUBKEYCREDPARAMS",cause:t}):new Je({message:"No available authenticator supported any of the specified pubKeyCredParams algorithms",code:"ERROR_AUTHENTICATOR_NO_SUPPORTED_PUBKEYCREDPARAMS_ALG",cause:t});if(t.name==="SecurityError"){const a=window.location.hostname;if(Qg(a)){if(n.rp.id!==a)return new Je({message:`The RP ID "${n.rp.id}" is invalid for this domain`,code:"ERROR_INVALID_RP_ID",cause:t})}else return new Je({message:`${window.location.hostname} is an invalid domain`,code:"ERROR_INVALID_DOMAIN",cause:t})}else if(t.name==="TypeError"){if(n.user.id.byteLength<1||n.user.id.byteLength>64)return new Je({message:"User ID was not between 1 and 64 characters",code:"ERROR_INVALID_USER_ID_LENGTH",cause:t})}else if(t.name==="UnknownError")return new Je({message:"The authenticator was unable to process the specified options, or could not create a new credential",code:"ERROR_AUTHENTICATOR_GENERAL_ERROR",cause:t})}return new Je({message:"a Non-Webauthn related error has occurred",code:"ERROR_PASSTHROUGH_SEE_CAUSE_PROPERTY",cause:t})}function kw({error:t,options:e}){const{publicKey:i}=e;if(!i)throw Error("options was missing required publicKey property");if(t.name==="AbortError"){if(e.signal instanceof AbortSignal)return new Je({message:"Authentication ceremony was sent an abort signal",code:"ERROR_CEREMONY_ABORTED",cause:t})}else{if(t.name==="NotAllowedError")return new Je({message:t.message,code:"ERROR_PASSTHROUGH_SEE_CAUSE_PROPERTY",cause:t});if(t.name==="SecurityError"){const s=window.location.hostname;if(Qg(s)){if(i.rpId!==s)return new Je({message:`The RP ID "${i.rpId}" is invalid for this domain`,code:"ERROR_INVALID_RP_ID",cause:t})}else return new Je({message:`${window.location.hostname} is an invalid domain`,code:"ERROR_INVALID_DOMAIN",cause:t})}else if(t.name==="UnknownError")return new Je({message:"The authenticator was unable to process the specified options, or could not create a new assertion signature",code:"ERROR_AUTHENTICATOR_GENERAL_ERROR",cause:t})}return new Je({message:"a Non-Webauthn related error has occurred",code:"ERROR_PASSTHROUGH_SEE_CAUSE_PROPERTY",cause:t})}class Tw{createNewAbortSignal(){if(this.controller){const i=new Error("Cancelling existing WebAuthn API call for new one");i.name="AbortError",this.controller.abort(i)}const e=new AbortController;return this.controller=e,e.signal}cancelCeremony(){if(this.controller){const e=new Error("Manually cancelling existing WebAuthn API call");e.name="AbortError",this.controller.abort(e),this.controller=void 0}}}const Ew=new Tw;function Pw(t){if(!t)throw new Error("Credential creation options are required");if(typeof PublicKeyCredential<"u"&&"parseCreationOptionsFromJSON"in PublicKeyCredential&&typeof PublicKeyCredential.parseCreationOptionsFromJSON=="function")return PublicKeyCredential.parseCreationOptionsFromJSON(t);const{challenge:e,user:i,excludeCredentials:s}=t,r=il(t,["challenge","user","excludeCredentials"]),n=Dr(e).buffer,a=Object.assign(Object.assign({},i),{id:Dr(i.id).buffer}),o=Object.assign(Object.assign({},r),{challenge:n,user:a});if(s&&s.length>0){o.excludeCredentials=new Array(s.length);for(let l=0;l<s.length;l++){const c=s[l];o.excludeCredentials[l]=Object.assign(Object.assign({},c),{id:Dr(c.id).buffer,type:c.type||"public-key",transports:c.transports})}}return o}function Cw(t){if(!t)throw new Error("Credential request options are required");if(typeof PublicKeyCredential<"u"&&"parseRequestOptionsFromJSON"in PublicKeyCredential&&typeof PublicKeyCredential.parseRequestOptionsFromJSON=="function")return PublicKeyCredential.parseRequestOptionsFromJSON(t);const{challenge:e,allowCredentials:i}=t,s=il(t,["challenge","allowCredentials"]),r=Dr(e).buffer,n=Object.assign(Object.assign({},s),{challenge:r});if(i&&i.length>0){n.allowCredentials=new Array(i.length);for(let a=0;a<i.length;a++){const o=i[a];n.allowCredentials[a]=Object.assign(Object.assign({},o),{id:Dr(o.id).buffer,type:o.type||"public-key",transports:o.transports})}}return n}function _w(t){var e;if("toJSON"in t&&typeof t.toJSON=="function")return t.toJSON();const i=t;return{id:t.id,rawId:t.id,response:{attestationObject:Gs(new Uint8Array(t.response.attestationObject)),clientDataJSON:Gs(new Uint8Array(t.response.clientDataJSON))},type:"public-key",clientExtensionResults:t.getClientExtensionResults(),authenticatorAttachment:(e=i.authenticatorAttachment)!==null&&e!==void 0?e:void 0}}function Rw(t){var e;if("toJSON"in t&&typeof t.toJSON=="function")return t.toJSON();const i=t,s=t.getClientExtensionResults(),r=t.response;return{id:t.id,rawId:t.id,response:{authenticatorData:Gs(new Uint8Array(r.authenticatorData)),clientDataJSON:Gs(new Uint8Array(r.clientDataJSON)),signature:Gs(new Uint8Array(r.signature)),userHandle:r.userHandle?Gs(new Uint8Array(r.userHandle)):void 0},type:"public-key",clientExtensionResults:s,authenticatorAttachment:(e=i.authenticatorAttachment)!==null&&e!==void 0?e:void 0}}function Qg(t){return t==="localhost"||/^([a-z0-9]+(-[a-z0-9]+)*\.)+[a-z]{2,}$/i.test(t)}function Zu(){var t,e;return!!(pt()&&"PublicKeyCredential"in window&&window.PublicKeyCredential&&"credentials"in navigator&&typeof((t=navigator==null?void 0:navigator.credentials)===null||t===void 0?void 0:t.create)=="function"&&typeof((e=navigator==null?void 0:navigator.credentials)===null||e===void 0?void 0:e.get)=="function")}async function $w(t){try{const e=await navigator.credentials.create(t);return e?e instanceof PublicKeyCredential?{data:e,error:null}:{data:null,error:new Ro("Browser returned unexpected credential type",e)}:{data:null,error:new Ro("Empty credential response",e)}}catch(e){return{data:null,error:xw({error:e,options:t})}}}async function Iw(t){try{const e=await navigator.credentials.get(t);return e?e instanceof PublicKeyCredential?{data:e,error:null}:{data:null,error:new Ro("Browser returned unexpected credential type",e)}:{data:null,error:new Ro("Empty credential response",e)}}catch(e){return{data:null,error:kw({error:e,options:t})}}}const Qw={hints:["security-key"],authenticatorSelection:{authenticatorAttachment:"cross-platform",requireResidentKey:!1,userVerification:"preferred",residentKey:"discouraged"},attestation:"direct"},Aw={userVerification:"preferred",hints:["security-key"],attestation:"direct"};function $o(...t){const e=r=>r!==null&&typeof r=="object"&&!Array.isArray(r),i=r=>r instanceof ArrayBuffer||ArrayBuffer.isView(r),s={};for(const r of t)if(r)for(const n in r){const a=r[n];if(a!==void 0)if(Array.isArray(a))s[n]=a;else if(i(a))s[n]=a;else if(e(a)){const o=s[n];e(o)?s[n]=$o(o,a):s[n]=$o(a)}else s[n]=a}return s}function Lw(t,e){return $o(Qw,t,e||{})}function Nw(t,e){return $o(Aw,t,e||{})}class Mw{constructor(e){this.client=e,this.enroll=this._enroll.bind(this),this.challenge=this._challenge.bind(this),this.verify=this._verify.bind(this),this.authenticate=this._authenticate.bind(this),this.register=this._register.bind(this)}async _enroll(e){return this.client.mfa.enroll(Object.assign(Object.assign({},e),{factorType:"webauthn"}))}async _challenge({factorId:e,webauthn:i,friendlyName:s,signal:r},n){try{const{data:a,error:o}=await this.client.mfa.challenge({factorId:e,webauthn:i});if(!a)return{data:null,error:o};const l=r??Ew.createNewAbortSignal();if(a.webauthn.type==="create"){const{user:c}=a.webauthn.credential_options.publicKey;c.name||(c.name=`${c.id}:${s}`),c.displayName||(c.displayName=c.name)}switch(a.webauthn.type){case"create":{const c=Lw(a.webauthn.credential_options.publicKey,n==null?void 0:n.create),{data:h,error:d}=await $w({publicKey:c,signal:l});return h?{data:{factorId:e,challengeId:a.id,webauthn:{type:a.webauthn.type,credential_response:h}},error:null}:{data:null,error:d}}case"request":{const c=Nw(a.webauthn.credential_options.publicKey,n==null?void 0:n.request),{data:h,error:d}=await Iw(Object.assign(Object.assign({},a.webauthn.credential_options),{publicKey:c,signal:l}));return h?{data:{factorId:e,challengeId:a.id,webauthn:{type:a.webauthn.type,credential_response:h}},error:null}:{data:null,error:d}}}}catch(a){return ae(a)?{data:null,error:a}:{data:null,error:new Fs("Unexpected error in challenge",a)}}}async _verify({challengeId:e,factorId:i,webauthn:s}){return this.client.mfa.verify({factorId:i,challengeId:e,webauthn:s})}async _authenticate({factorId:e,webauthn:{rpId:i=typeof window<"u"?window.location.hostname:void 0,rpOrigins:s=typeof window<"u"?[window.location.origin]:void 0,signal:r}={}},n){if(!i)return{data:null,error:new sa("rpId is required for WebAuthn authentication")};try{if(!Zu())return{data:null,error:new Fs("Browser does not support WebAuthn",null)};const{data:a,error:o}=await this.challenge({factorId:e,webauthn:{rpId:i,rpOrigins:s},signal:r},{request:n});if(!a)return{data:null,error:o};const{webauthn:l}=a;return this._verify({factorId:e,challengeId:a.challengeId,webauthn:{type:l.type,rpId:i,rpOrigins:s,credential_response:l.credential_response}})}catch(a){return ae(a)?{data:null,error:a}:{data:null,error:new Fs("Unexpected error in authenticate",a)}}}async _register({friendlyName:e,webauthn:{rpId:i=typeof window<"u"?window.location.hostname:void 0,rpOrigins:s=typeof window<"u"?[window.location.origin]:void 0,signal:r}={}},n){if(!i)return{data:null,error:new sa("rpId is required for WebAuthn registration")};try{if(!Zu())return{data:null,error:new Fs("Browser does not support WebAuthn",null)};const{data:a,error:o}=await this._enroll({friendlyName:e});if(!a)return await this.client.mfa.listFactors().then(h=>{var d;return(d=h.data)===null||d===void 0?void 0:d.all.find(u=>u.factor_type==="webauthn"&&u.friendly_name===e&&u.status!=="unverified")}).then(h=>h?this.client.mfa.unenroll({factorId:h==null?void 0:h.id}):void 0),{data:null,error:o};const{data:l,error:c}=await this._challenge({factorId:a.id,friendlyName:a.friendly_name,webauthn:{rpId:i,rpOrigins:s},signal:r},{create:n});return l?this._verify({factorId:a.id,challengeId:l.challengeId,webauthn:{rpId:i,rpOrigins:s,type:l.webauthn.type,credential_response:l.webauthn.credential_response}}):{data:null,error:c}}catch(a){return ae(a)?{data:null,error:a}:{data:null,error:new Fs("Unexpected error in register",a)}}}}vw();const qw={url:Ab,storageKey:Lb,autoRefreshToken:!0,persistSession:!0,detectSessionInUrl:!0,headers:Nb,flowType:"implicit",debug:!1,hasCustomAuthorizationHeader:!1,throwOnError:!1,lockAcquireTimeout:1e4};async function Hu(t,e,i){return await i()}const Tr={};class ra{get jwks(){var e,i;return(i=(e=Tr[this.storageKey])===null||e===void 0?void 0:e.jwks)!==null&&i!==void 0?i:{keys:[]}}set jwks(e){Tr[this.storageKey]=Object.assign(Object.assign({},Tr[this.storageKey]),{jwks:e})}get jwks_cached_at(){var e,i;return(i=(e=Tr[this.storageKey])===null||e===void 0?void 0:e.cachedAt)!==null&&i!==void 0?i:Number.MIN_SAFE_INTEGER}set jwks_cached_at(e){Tr[this.storageKey]=Object.assign(Object.assign({},Tr[this.storageKey]),{cachedAt:e})}constructor(e){var i,s,r;this.userStorage=null,this.memoryStorage=null,this.stateChangeEmitters=new Map,this.autoRefreshTicker=null,this.autoRefreshTickTimeout=null,this.visibilityChangedCallback=null,this.refreshingDeferred=null,this.initializePromise=null,this.detectSessionInUrl=!0,this.hasCustomAuthorizationHeader=!1,this.suppressGetSessionWarning=!1,this.lockAcquired=!1,this.pendingInLock=[],this.broadcastChannel=null,this.logger=console.log;const n=Object.assign(Object.assign({},qw),e);if(this.storageKey=n.storageKey,this.instanceID=(i=ra.nextInstanceID[this.storageKey])!==null&&i!==void 0?i:0,ra.nextInstanceID[this.storageKey]=this.instanceID+1,this.logDebugMessages=!!n.debug,typeof n.debug=="function"&&(this.logger=n.debug),this.instanceID>0&&pt()){const a=`${this._logPrefix()} Multiple GoTrueClient instances detected in the same browser context. It is not an error, but this should be avoided as it may produce undefined behavior when used concurrently under the same storage key.`;console.warn(a),this.logDebugMessages&&console.trace(a)}if(this.persistSession=n.persistSession,this.autoRefreshToken=n.autoRefreshToken,this.admin=new mw({url:n.url,headers:n.headers,fetch:n.fetch}),this.url=n.url,this.headers=n.headers,this.fetch=Rg(n.fetch),this.lock=n.lock||Hu,this.detectSessionInUrl=n.detectSessionInUrl,this.flowType=n.flowType,this.hasCustomAuthorizationHeader=n.hasCustomAuthorizationHeader,this.throwOnError=n.throwOnError,this.lockAcquireTimeout=n.lockAcquireTimeout,n.lock?this.lock=n.lock:this.persistSession&&pt()&&(!((s=globalThis==null?void 0:globalThis.navigator)===null||s===void 0)&&s.locks)?this.lock=yw:this.lock=Hu,this.jwks||(this.jwks={keys:[]},this.jwks_cached_at=Number.MIN_SAFE_INTEGER),this.mfa={verify:this._verify.bind(this),enroll:this._enroll.bind(this),unenroll:this._unenroll.bind(this),challenge:this._challenge.bind(this),listFactors:this._listFactors.bind(this),challengeAndVerify:this._challengeAndVerify.bind(this),getAuthenticatorAssuranceLevel:this._getAuthenticatorAssuranceLevel.bind(this),webauthn:new Mw(this)},this.oauth={getAuthorizationDetails:this._getAuthorizationDetails.bind(this),approveAuthorization:this._approveAuthorization.bind(this),denyAuthorization:this._denyAuthorization.bind(this),listGrants:this._listOAuthGrants.bind(this),revokeGrant:this._revokeOAuthGrant.bind(this)},this.persistSession?(n.storage?this.storage=n.storage:_g()?this.storage=globalThis.localStorage:(this.memoryStorage={},this.storage=Yu(this.memoryStorage)),n.userStorage&&(this.userStorage=n.userStorage)):(this.memoryStorage={},this.storage=Yu(this.memoryStorage)),pt()&&globalThis.BroadcastChannel&&this.persistSession&&this.storageKey){try{this.broadcastChannel=new globalThis.BroadcastChannel(this.storageKey)}catch(a){console.error("Failed to create a new BroadcastChannel, multi-tab state changes will not be available",a)}(r=this.broadcastChannel)===null||r===void 0||r.addEventListener("message",async a=>{this._debug("received broadcast notification from other tab or client",a);try{await this._notifyAllSubscribers(a.data.event,a.data.session,!1)}catch(o){this._debug("#broadcastChannel","error",o)}})}this.initialize().catch(a=>{this._debug("#initialize()","error",a)})}isThrowOnErrorEnabled(){return this.throwOnError}_returnResult(e){if(this.throwOnError&&e&&e.error)throw e.error;return e}_logPrefix(){return`GoTrueClient@${this.storageKey}:${this.instanceID} (${Eg}) ${new Date().toISOString()}`}_debug(...e){return this.logDebugMessages&&this.logger(this._logPrefix(),...e),this}async initialize(){return this.initializePromise?await this.initializePromise:(this.initializePromise=(async()=>await this._acquireLock(this.lockAcquireTimeout,async()=>await this._initialize()))(),await this.initializePromise)}async _initialize(){var e;try{let i={},s="none";if(pt()&&(i=Zb(window.location.href),this._isImplicitGrantCallback(i)?s="implicit":await this._isPKCECallback(i)&&(s="pkce")),pt()&&this.detectSessionInUrl&&s!=="none"){const{data:r,error:n}=await this._getSessionFromURL(i,s);if(n){if(this._debug("#_initialize()","error detecting session from URL",n),jb(n)){const l=(e=n.details)===null||e===void 0?void 0:e.code;if(l==="identity_already_exists"||l==="identity_not_found"||l==="single_identity_not_deletable")return{error:n}}return{error:n}}const{session:a,redirectType:o}=r;return this._debug("#_initialize()","detected session in URL",a,"redirect type",o),await this._saveSession(a),setTimeout(async()=>{o==="recovery"?await this._notifyAllSubscribers("PASSWORD_RECOVERY",a):await this._notifyAllSubscribers("SIGNED_IN",a)},0),{error:null}}return await this._recoverAndRefresh(),{error:null}}catch(i){return ae(i)?this._returnResult({error:i}):this._returnResult({error:new Fs("Unexpected error during initialization",i)})}finally{await this._handleVisibilityChange(),this._debug("#_initialize()","end")}}async signInAnonymously(e){var i,s,r;try{const n=await he(this.fetch,"POST",`${this.url}/signup`,{headers:this.headers,body:{data:(s=(i=e==null?void 0:e.options)===null||i===void 0?void 0:i.data)!==null&&s!==void 0?s:{},gotrue_meta_security:{captcha_token:(r=e==null?void 0:e.options)===null||r===void 0?void 0:r.captchaToken}},xform:oi}),{data:a,error:o}=n;if(o||!a)return this._returnResult({data:{user:null,session:null},error:o});const l=a.session,c=a.user;return a.session&&(await this._saveSession(a.session),await this._notifyAllSubscribers("SIGNED_IN",l)),this._returnResult({data:{user:c,session:l},error:null})}catch(n){if(ae(n))return this._returnResult({data:{user:null,session:null},error:n});throw n}}async signUp(e){var i,s,r;try{let n;if("email"in e){const{email:h,password:d,options:u}=e;let p=null,f=null;this.flowType==="pkce"&&([p,f]=await Sr(this.storage,this.storageKey)),n=await he(this.fetch,"POST",`${this.url}/signup`,{headers:this.headers,redirectTo:u==null?void 0:u.emailRedirectTo,body:{email:h,password:d,data:(i=u==null?void 0:u.data)!==null&&i!==void 0?i:{},gotrue_meta_security:{captcha_token:u==null?void 0:u.captchaToken},code_challenge:p,code_challenge_method:f},xform:oi})}else if("phone"in e){const{phone:h,password:d,options:u}=e;n=await he(this.fetch,"POST",`${this.url}/signup`,{headers:this.headers,body:{phone:h,password:d,data:(s=u==null?void 0:u.data)!==null&&s!==void 0?s:{},channel:(r=u==null?void 0:u.channel)!==null&&r!==void 0?r:"sms",gotrue_meta_security:{captcha_token:u==null?void 0:u.captchaToken}},xform:oi})}else throw new za("You must provide either an email or phone number and a password");const{data:a,error:o}=n;if(o||!a)return await ht(this.storage,`${this.storageKey}-code-verifier`),this._returnResult({data:{user:null,session:null},error:o});const l=a.session,c=a.user;return a.session&&(await this._saveSession(a.session),await this._notifyAllSubscribers("SIGNED_IN",l)),this._returnResult({data:{user:c,session:l},error:null})}catch(n){if(await ht(this.storage,`${this.storageKey}-code-verifier`),ae(n))return this._returnResult({data:{user:null,session:null},error:n});throw n}}async signInWithPassword(e){try{let i;if("email"in e){const{email:n,password:a,options:o}=e;i=await he(this.fetch,"POST",`${this.url}/token?grant_type=password`,{headers:this.headers,body:{email:n,password:a,gotrue_meta_security:{captcha_token:o==null?void 0:o.captchaToken}},xform:Xu})}else if("phone"in e){const{phone:n,password:a,options:o}=e;i=await he(this.fetch,"POST",`${this.url}/token?grant_type=password`,{headers:this.headers,body:{phone:n,password:a,gotrue_meta_security:{captcha_token:o==null?void 0:o.captchaToken}},xform:Xu})}else throw new za("You must provide either an email or phone number and a password");const{data:s,error:r}=i;if(r)return this._returnResult({data:{user:null,session:null},error:r});if(!s||!s.session||!s.user){const n=new wr;return this._returnResult({data:{user:null,session:null},error:n})}return s.session&&(await this._saveSession(s.session),await this._notifyAllSubscribers("SIGNED_IN",s.session)),this._returnResult({data:Object.assign({user:s.user,session:s.session},s.weak_password?{weakPassword:s.weak_password}:null),error:r})}catch(i){if(ae(i))return this._returnResult({data:{user:null,session:null},error:i});throw i}}async signInWithOAuth(e){var i,s,r,n;return await this._handleProviderSignIn(e.provider,{redirectTo:(i=e.options)===null||i===void 0?void 0:i.redirectTo,scopes:(s=e.options)===null||s===void 0?void 0:s.scopes,queryParams:(r=e.options)===null||r===void 0?void 0:r.queryParams,skipBrowserRedirect:(n=e.options)===null||n===void 0?void 0:n.skipBrowserRedirect})}async exchangeCodeForSession(e){return await this.initializePromise,this._acquireLock(this.lockAcquireTimeout,async()=>this._exchangeCodeForSession(e))}async signInWithWeb3(e){const{chain:i}=e;switch(i){case"ethereum":return await this.signInWithEthereum(e);case"solana":return await this.signInWithSolana(e);default:throw new Error(`@supabase/auth-js: Unsupported chain "${i}"`)}}async signInWithEthereum(e){var i,s,r,n,a,o,l,c,h,d,u;let p,f;if("message"in e)p=e.message,f=e.signature;else{const{chain:g,wallet:m,statement:y,options:b}=e;let w;if(pt())if(typeof m=="object")w=m;else{const C=window;if("ethereum"in C&&typeof C.ethereum=="object"&&"request"in C.ethereum&&typeof C.ethereum.request=="function")w=C.ethereum;else throw new Error("@supabase/auth-js: No compatible Ethereum wallet interface on the window object (window.ethereum) detected. Make sure the user already has a wallet installed and connected for this app. Prefer passing the wallet interface object directly to signInWithWeb3({ chain: 'ethereum', wallet: resolvedUserWallet }) instead.")}else{if(typeof m!="object"||!(b!=null&&b.url))throw new Error("@supabase/auth-js: Both wallet and url must be specified in non-browser environments.");w=m}const k=new URL((i=b==null?void 0:b.url)!==null&&i!==void 0?i:window.location.href),x=await w.request({method:"eth_requestAccounts"}).then(C=>C).catch(()=>{throw new Error("@supabase/auth-js: Wallet method eth_requestAccounts is missing or invalid")});if(!x||x.length===0)throw new Error("@supabase/auth-js: No accounts available. Please ensure the wallet is connected.");const E=Ig(x[0]);let _=(s=b==null?void 0:b.signInWithEthereum)===null||s===void 0?void 0:s.chainId;if(!_){const C=await w.request({method:"eth_chainId"});_=bw(C)}const R={domain:k.host,address:E,statement:y,uri:k.href,version:"1",chainId:_,nonce:(r=b==null?void 0:b.signInWithEthereum)===null||r===void 0?void 0:r.nonce,issuedAt:(a=(n=b==null?void 0:b.signInWithEthereum)===null||n===void 0?void 0:n.issuedAt)!==null&&a!==void 0?a:new Date,expirationTime:(o=b==null?void 0:b.signInWithEthereum)===null||o===void 0?void 0:o.expirationTime,notBefore:(l=b==null?void 0:b.signInWithEthereum)===null||l===void 0?void 0:l.notBefore,requestId:(c=b==null?void 0:b.signInWithEthereum)===null||c===void 0?void 0:c.requestId,resources:(h=b==null?void 0:b.signInWithEthereum)===null||h===void 0?void 0:h.resources};p=Sw(R),f=await w.request({method:"personal_sign",params:[ww(p),E]})}try{const{data:g,error:m}=await he(this.fetch,"POST",`${this.url}/token?grant_type=web3`,{headers:this.headers,body:Object.assign({chain:"ethereum",message:p,signature:f},!((d=e.options)===null||d===void 0)&&d.captchaToken?{gotrue_meta_security:{captcha_token:(u=e.options)===null||u===void 0?void 0:u.captchaToken}}:null),xform:oi});if(m)throw m;if(!g||!g.session||!g.user){const y=new wr;return this._returnResult({data:{user:null,session:null},error:y})}return g.session&&(await this._saveSession(g.session),await this._notifyAllSubscribers("SIGNED_IN",g.session)),this._returnResult({data:Object.assign({},g),error:m})}catch(g){if(ae(g))return this._returnResult({data:{user:null,session:null},error:g});throw g}}async signInWithSolana(e){var i,s,r,n,a,o,l,c,h,d,u,p;let f,g;if("message"in e)f=e.message,g=e.signature;else{const{chain:m,wallet:y,statement:b,options:w}=e;let k;if(pt())if(typeof y=="object")k=y;else{const E=window;if("solana"in E&&typeof E.solana=="object"&&("signIn"in E.solana&&typeof E.solana.signIn=="function"||"signMessage"in E.solana&&typeof E.solana.signMessage=="function"))k=E.solana;else throw new Error("@supabase/auth-js: No compatible Solana wallet interface on the window object (window.solana) detected. Make sure the user already has a wallet installed and connected for this app. Prefer passing the wallet interface object directly to signInWithWeb3({ chain: 'solana', wallet: resolvedUserWallet }) instead.")}else{if(typeof y!="object"||!(w!=null&&w.url))throw new Error("@supabase/auth-js: Both wallet and url must be specified in non-browser environments.");k=y}const x=new URL((i=w==null?void 0:w.url)!==null&&i!==void 0?i:window.location.href);if("signIn"in k&&k.signIn){const E=await k.signIn(Object.assign(Object.assign(Object.assign({issuedAt:new Date().toISOString()},w==null?void 0:w.signInWithSolana),{version:"1",domain:x.host,uri:x.href}),b?{statement:b}:null));let _;if(Array.isArray(E)&&E[0]&&typeof E[0]=="object")_=E[0];else if(E&&typeof E=="object"&&"signedMessage"in E&&"signature"in E)_=E;else throw new Error("@supabase/auth-js: Wallet method signIn() returned unrecognized value");if("signedMessage"in _&&"signature"in _&&(typeof _.signedMessage=="string"||_.signedMessage instanceof Uint8Array)&&_.signature instanceof Uint8Array)f=typeof _.signedMessage=="string"?_.signedMessage:new TextDecoder().decode(_.signedMessage),g=_.signature;else throw new Error("@supabase/auth-js: Wallet method signIn() API returned object without signedMessage and signature fields")}else{if(!("signMessage"in k)||typeof k.signMessage!="function"||!("publicKey"in k)||typeof k!="object"||!k.publicKey||!("toBase58"in k.publicKey)||typeof k.publicKey.toBase58!="function")throw new Error("@supabase/auth-js: Wallet does not have a compatible signMessage() and publicKey.toBase58() API");f=[`${x.host} wants you to sign in with your Solana account:`,k.publicKey.toBase58(),...b?["",b,""]:[""],"Version: 1",`URI: ${x.href}`,`Issued At: ${(r=(s=w==null?void 0:w.signInWithSolana)===null||s===void 0?void 0:s.issuedAt)!==null&&r!==void 0?r:new Date().toISOString()}`,...!((n=w==null?void 0:w.signInWithSolana)===null||n===void 0)&&n.notBefore?[`Not Before: ${w.signInWithSolana.notBefore}`]:[],...!((a=w==null?void 0:w.signInWithSolana)===null||a===void 0)&&a.expirationTime?[`Expiration Time: ${w.signInWithSolana.expirationTime}`]:[],...!((o=w==null?void 0:w.signInWithSolana)===null||o===void 0)&&o.chainId?[`Chain ID: ${w.signInWithSolana.chainId}`]:[],...!((l=w==null?void 0:w.signInWithSolana)===null||l===void 0)&&l.nonce?[`Nonce: ${w.signInWithSolana.nonce}`]:[],...!((c=w==null?void 0:w.signInWithSolana)===null||c===void 0)&&c.requestId?[`Request ID: ${w.signInWithSolana.requestId}`]:[],...!((d=(h=w==null?void 0:w.signInWithSolana)===null||h===void 0?void 0:h.resources)===null||d===void 0)&&d.length?["Resources",...w.signInWithSolana.resources.map(_=>`- ${_}`)]:[]].join(`
`);const E=await k.signMessage(new TextEncoder().encode(f),"utf8");if(!E||!(E instanceof Uint8Array))throw new Error("@supabase/auth-js: Wallet signMessage() API returned an recognized value");g=E}}try{const{data:m,error:y}=await he(this.fetch,"POST",`${this.url}/token?grant_type=web3`,{headers:this.headers,body:Object.assign({chain:"solana",message:f,signature:Gs(g)},!((u=e.options)===null||u===void 0)&&u.captchaToken?{gotrue_meta_security:{captcha_token:(p=e.options)===null||p===void 0?void 0:p.captchaToken}}:null),xform:oi});if(y)throw y;if(!m||!m.session||!m.user){const b=new wr;return this._returnResult({data:{user:null,session:null},error:b})}return m.session&&(await this._saveSession(m.session),await this._notifyAllSubscribers("SIGNED_IN",m.session)),this._returnResult({data:Object.assign({},m),error:y})}catch(m){if(ae(m))return this._returnResult({data:{user:null,session:null},error:m});throw m}}async _exchangeCodeForSession(e){const i=await Ms(this.storage,`${this.storageKey}-code-verifier`),[s,r]=(i??"").split("/");try{if(!s&&this.flowType==="pkce")throw new Wb;const{data:n,error:a}=await he(this.fetch,"POST",`${this.url}/token?grant_type=pkce`,{headers:this.headers,body:{auth_code:e,code_verifier:s},xform:oi});if(await ht(this.storage,`${this.storageKey}-code-verifier`),a)throw a;if(!n||!n.session||!n.user){const o=new wr;return this._returnResult({data:{user:null,session:null,redirectType:null},error:o})}return n.session&&(await this._saveSession(n.session),await this._notifyAllSubscribers("SIGNED_IN",n.session)),this._returnResult({data:Object.assign(Object.assign({},n),{redirectType:r??null}),error:a})}catch(n){if(await ht(this.storage,`${this.storageKey}-code-verifier`),ae(n))return this._returnResult({data:{user:null,session:null,redirectType:null},error:n});throw n}}async signInWithIdToken(e){try{const{options:i,provider:s,token:r,access_token:n,nonce:a}=e,o=await he(this.fetch,"POST",`${this.url}/token?grant_type=id_token`,{headers:this.headers,body:{provider:s,id_token:r,access_token:n,nonce:a,gotrue_meta_security:{captcha_token:i==null?void 0:i.captchaToken}},xform:oi}),{data:l,error:c}=o;if(c)return this._returnResult({data:{user:null,session:null},error:c});if(!l||!l.session||!l.user){const h=new wr;return this._returnResult({data:{user:null,session:null},error:h})}return l.session&&(await this._saveSession(l.session),await this._notifyAllSubscribers("SIGNED_IN",l.session)),this._returnResult({data:l,error:c})}catch(i){if(ae(i))return this._returnResult({data:{user:null,session:null},error:i});throw i}}async signInWithOtp(e){var i,s,r,n,a;try{if("email"in e){const{email:o,options:l}=e;let c=null,h=null;this.flowType==="pkce"&&([c,h]=await Sr(this.storage,this.storageKey));const{error:d}=await he(this.fetch,"POST",`${this.url}/otp`,{headers:this.headers,body:{email:o,data:(i=l==null?void 0:l.data)!==null&&i!==void 0?i:{},create_user:(s=l==null?void 0:l.shouldCreateUser)!==null&&s!==void 0?s:!0,gotrue_meta_security:{captcha_token:l==null?void 0:l.captchaToken},code_challenge:c,code_challenge_method:h},redirectTo:l==null?void 0:l.emailRedirectTo});return this._returnResult({data:{user:null,session:null},error:d})}if("phone"in e){const{phone:o,options:l}=e,{data:c,error:h}=await he(this.fetch,"POST",`${this.url}/otp`,{headers:this.headers,body:{phone:o,data:(r=l==null?void 0:l.data)!==null&&r!==void 0?r:{},create_user:(n=l==null?void 0:l.shouldCreateUser)!==null&&n!==void 0?n:!0,gotrue_meta_security:{captcha_token:l==null?void 0:l.captchaToken},channel:(a=l==null?void 0:l.channel)!==null&&a!==void 0?a:"sms"}});return this._returnResult({data:{user:null,session:null,messageId:c==null?void 0:c.message_id},error:h})}throw new za("You must provide either an email or phone number.")}catch(o){if(await ht(this.storage,`${this.storageKey}-code-verifier`),ae(o))return this._returnResult({data:{user:null,session:null},error:o});throw o}}async verifyOtp(e){var i,s;try{let r,n;"options"in e&&(r=(i=e.options)===null||i===void 0?void 0:i.redirectTo,n=(s=e.options)===null||s===void 0?void 0:s.captchaToken);const{data:a,error:o}=await he(this.fetch,"POST",`${this.url}/verify`,{headers:this.headers,body:Object.assign(Object.assign({},e),{gotrue_meta_security:{captcha_token:n}}),redirectTo:r,xform:oi});if(o)throw o;if(!a)throw new Error("An error occurred on token verification.");const l=a.session,c=a.user;return l!=null&&l.access_token&&(await this._saveSession(l),await this._notifyAllSubscribers(e.type=="recovery"?"PASSWORD_RECOVERY":"SIGNED_IN",l)),this._returnResult({data:{user:c,session:l},error:null})}catch(r){if(ae(r))return this._returnResult({data:{user:null,session:null},error:r});throw r}}async signInWithSSO(e){var i,s,r,n,a;try{let o=null,l=null;this.flowType==="pkce"&&([o,l]=await Sr(this.storage,this.storageKey));const c=await he(this.fetch,"POST",`${this.url}/sso`,{body:Object.assign(Object.assign(Object.assign(Object.assign(Object.assign({},"providerId"in e?{provider_id:e.providerId}:null),"domain"in e?{domain:e.domain}:null),{redirect_to:(s=(i=e.options)===null||i===void 0?void 0:i.redirectTo)!==null&&s!==void 0?s:void 0}),!((r=e==null?void 0:e.options)===null||r===void 0)&&r.captchaToken?{gotrue_meta_security:{captcha_token:e.options.captchaToken}}:null),{skip_http_redirect:!0,code_challenge:o,code_challenge_method:l}),headers:this.headers,xform:pw});return!((n=c.data)===null||n===void 0)&&n.url&&pt()&&!(!((a=e.options)===null||a===void 0)&&a.skipBrowserRedirect)&&window.location.assign(c.data.url),this._returnResult(c)}catch(o){if(await ht(this.storage,`${this.storageKey}-code-verifier`),ae(o))return this._returnResult({data:null,error:o});throw o}}async reauthenticate(){return await this.initializePromise,await this._acquireLock(this.lockAcquireTimeout,async()=>await this._reauthenticate())}async _reauthenticate(){try{return await this._useSession(async e=>{const{data:{session:i},error:s}=e;if(s)throw s;if(!i)throw new Wt;const{error:r}=await he(this.fetch,"GET",`${this.url}/reauthenticate`,{headers:this.headers,jwt:i.access_token});return this._returnResult({data:{user:null,session:null},error:r})})}catch(e){if(ae(e))return this._returnResult({data:{user:null,session:null},error:e});throw e}}async resend(e){try{const i=`${this.url}/resend`;if("email"in e){const{email:s,type:r,options:n}=e,{error:a}=await he(this.fetch,"POST",i,{headers:this.headers,body:{email:s,type:r,gotrue_meta_security:{captcha_token:n==null?void 0:n.captchaToken}},redirectTo:n==null?void 0:n.emailRedirectTo});return this._returnResult({data:{user:null,session:null},error:a})}else if("phone"in e){const{phone:s,type:r,options:n}=e,{data:a,error:o}=await he(this.fetch,"POST",i,{headers:this.headers,body:{phone:s,type:r,gotrue_meta_security:{captcha_token:n==null?void 0:n.captchaToken}}});return this._returnResult({data:{user:null,session:null,messageId:a==null?void 0:a.message_id},error:o})}throw new za("You must provide either an email or phone number and a type")}catch(i){if(ae(i))return this._returnResult({data:{user:null,session:null},error:i});throw i}}async getSession(){return await this.initializePromise,await this._acquireLock(this.lockAcquireTimeout,async()=>this._useSession(async i=>i))}async _acquireLock(e,i){this._debug("#_acquireLock","begin",e);try{if(this.lockAcquired){const s=this.pendingInLock.length?this.pendingInLock[this.pendingInLock.length-1]:Promise.resolve(),r=(async()=>(await s,await i()))();return this.pendingInLock.push((async()=>{try{await r}catch{}})()),r}return await this.lock(`lock:${this.storageKey}`,e,async()=>{this._debug("#_acquireLock","lock acquired for storage key",this.storageKey);try{this.lockAcquired=!0;const s=i();for(this.pendingInLock.push((async()=>{try{await s}catch{}})()),await s;this.pendingInLock.length;){const r=[...this.pendingInLock];await Promise.all(r),this.pendingInLock.splice(0,r.length)}return await s}finally{this._debug("#_acquireLock","lock released for storage key",this.storageKey),this.lockAcquired=!1}})}finally{this._debug("#_acquireLock","end")}}async _useSession(e){this._debug("#_useSession","begin");try{const i=await this.__loadSession();return await e(i)}finally{this._debug("#_useSession","end")}}async __loadSession(){this._debug("#__loadSession()","begin"),this.lockAcquired||this._debug("#__loadSession()","used outside of an acquired lock!",new Error().stack);try{let e=null;const i=await Ms(this.storage,this.storageKey);if(this._debug("#getSession()","session from storage",i),i!==null&&(this._isValidSession(i)?e=i:(this._debug("#getSession()","session from storage is not valid"),await this._removeSession())),!e)return{data:{session:null},error:null};const s=e.expires_at?e.expires_at*1e3-Date.now()<ec:!1;if(this._debug("#__loadSession()",`session has${s?"":" not"} expired`,"expires_at",e.expires_at),!s){if(this.userStorage){const a=await Ms(this.userStorage,this.storageKey+"-user");a!=null&&a.user?e.user=a.user:e.user=sc()}if(this.storage.isServer&&e.user&&!e.user.__isUserNotAvailableProxy){const a={value:this.suppressGetSessionWarning};e.user=cw(e.user,a),a.value&&(this.suppressGetSessionWarning=!0)}return{data:{session:e},error:null}}const{data:r,error:n}=await this._callRefreshToken(e.refresh_token);return n?this._returnResult({data:{session:null},error:n}):this._returnResult({data:{session:r},error:null})}finally{this._debug("#__loadSession()","end")}}async getUser(e){if(e)return await this._getUser(e);await this.initializePromise;const i=await this._acquireLock(this.lockAcquireTimeout,async()=>await this._getUser());return i.data.user&&(this.suppressGetSessionWarning=!0),i}async _getUser(e){try{return e?await he(this.fetch,"GET",`${this.url}/user`,{headers:this.headers,jwt:e,xform:ms}):await this._useSession(async i=>{var s,r,n;const{data:a,error:o}=i;if(o)throw o;return!(!((s=a.session)===null||s===void 0)&&s.access_token)&&!this.hasCustomAuthorizationHeader?{data:{user:null},error:new Wt}:await he(this.fetch,"GET",`${this.url}/user`,{headers:this.headers,jwt:(n=(r=a.session)===null||r===void 0?void 0:r.access_token)!==null&&n!==void 0?n:void 0,xform:ms})})}catch(i){if(ae(i))return tc(i)&&(await this._removeSession(),await ht(this.storage,`${this.storageKey}-code-verifier`)),this._returnResult({data:{user:null},error:i});throw i}}async updateUser(e,i={}){return await this.initializePromise,await this._acquireLock(this.lockAcquireTimeout,async()=>await this._updateUser(e,i))}async _updateUser(e,i={}){try{return await this._useSession(async s=>{const{data:r,error:n}=s;if(n)throw n;if(!r.session)throw new Wt;const a=r.session;let o=null,l=null;this.flowType==="pkce"&&e.email!=null&&([o,l]=await Sr(this.storage,this.storageKey));const{data:c,error:h}=await he(this.fetch,"PUT",`${this.url}/user`,{headers:this.headers,redirectTo:i==null?void 0:i.emailRedirectTo,body:Object.assign(Object.assign({},e),{code_challenge:o,code_challenge_method:l}),jwt:a.access_token,xform:ms});if(h)throw h;return a.user=c.user,await this._saveSession(a),await this._notifyAllSubscribers("USER_UPDATED",a),this._returnResult({data:{user:a.user},error:null})})}catch(s){if(await ht(this.storage,`${this.storageKey}-code-verifier`),ae(s))return this._returnResult({data:{user:null},error:s});throw s}}async setSession(e){return await this.initializePromise,await this._acquireLock(this.lockAcquireTimeout,async()=>await this._setSession(e))}async _setSession(e){try{if(!e.access_token||!e.refresh_token)throw new Wt;const i=Date.now()/1e3;let s=i,r=!0,n=null;const{payload:a}=Ga(e.access_token);if(a.exp&&(s=a.exp,r=s<=i),r){const{data:o,error:l}=await this._callRefreshToken(e.refresh_token);if(l)return this._returnResult({data:{user:null,session:null},error:l});if(!o)return{data:{user:null,session:null},error:null};n=o}else{const{data:o,error:l}=await this._getUser(e.access_token);if(l)return this._returnResult({data:{user:null,session:null},error:l});n={access_token:e.access_token,refresh_token:e.refresh_token,user:o.user,token_type:"bearer",expires_in:s-i,expires_at:s},await this._saveSession(n),await this._notifyAllSubscribers("SIGNED_IN",n)}return this._returnResult({data:{user:n.user,session:n},error:null})}catch(i){if(ae(i))return this._returnResult({data:{session:null,user:null},error:i});throw i}}async refreshSession(e){return await this.initializePromise,await this._acquireLock(this.lockAcquireTimeout,async()=>await this._refreshSession(e))}async _refreshSession(e){try{return await this._useSession(async i=>{var s;if(!e){const{data:a,error:o}=i;if(o)throw o;e=(s=a.session)!==null&&s!==void 0?s:void 0}if(!(e!=null&&e.refresh_token))throw new Wt;const{data:r,error:n}=await this._callRefreshToken(e.refresh_token);return n?this._returnResult({data:{user:null,session:null},error:n}):r?this._returnResult({data:{user:r.user,session:r},error:null}):this._returnResult({data:{user:null,session:null},error:null})})}catch(i){if(ae(i))return this._returnResult({data:{user:null,session:null},error:i});throw i}}async _getSessionFromURL(e,i){try{if(!pt())throw new Xa("No browser detected.");if(e.error||e.error_description||e.error_code)throw new Xa(e.error_description||"Error in URL with unspecified error_description",{error:e.error||"unspecified_error",code:e.error_code||"unspecified_code"});switch(i){case"implicit":if(this.flowType==="pkce")throw new Bu("Not a valid PKCE flow url.");break;case"pkce":if(this.flowType==="implicit")throw new Xa("Not a valid implicit grant flow url.");break;default:}if(i==="pkce"){if(this._debug("#_initialize()","begin","is PKCE flow",!0),!e.code)throw new Bu("No code detected.");const{data:b,error:w}=await this._exchangeCodeForSession(e.code);if(w)throw w;const k=new URL(window.location.href);return k.searchParams.delete("code"),window.history.replaceState(window.history.state,"",k.toString()),{data:{session:b.session,redirectType:null},error:null}}const{provider_token:s,provider_refresh_token:r,access_token:n,refresh_token:a,expires_in:o,expires_at:l,token_type:c}=e;if(!n||!o||!a||!c)throw new Xa("No session defined in URL");const h=Math.round(Date.now()/1e3),d=parseInt(o);let u=h+d;l&&(u=parseInt(l));const p=u-h;p*1e3<=Cr&&console.warn(`@supabase/gotrue-js: Session as retrieved from URL expires in ${p}s, should have been closer to ${d}s`);const f=u-d;h-f>=120?console.warn("@supabase/gotrue-js: Session as retrieved from URL was issued over 120s ago, URL could be stale",f,u,h):h-f<0&&console.warn("@supabase/gotrue-js: Session as retrieved from URL was issued in the future? Check the device clock for skew",f,u,h);const{data:g,error:m}=await this._getUser(n);if(m)throw m;const y={provider_token:s,provider_refresh_token:r,access_token:n,expires_in:d,expires_at:u,refresh_token:a,token_type:c,user:g.user};return window.location.hash="",this._debug("#_getSessionFromURL()","clearing window.location.hash"),this._returnResult({data:{session:y,redirectType:e.type},error:null})}catch(s){if(ae(s))return this._returnResult({data:{session:null,redirectType:null},error:s});throw s}}_isImplicitGrantCallback(e){return typeof this.detectSessionInUrl=="function"?this.detectSessionInUrl(new URL(window.location.href),e):!!(e.access_token||e.error_description)}async _isPKCECallback(e){const i=await Ms(this.storage,`${this.storageKey}-code-verifier`);return!!(e.code&&i)}async signOut(e={scope:"global"}){return await this.initializePromise,await this._acquireLock(this.lockAcquireTimeout,async()=>await this._signOut(e))}async _signOut({scope:e}={scope:"global"}){return await this._useSession(async i=>{var s;const{data:r,error:n}=i;if(n&&!tc(n))return this._returnResult({error:n});const a=(s=r.session)===null||s===void 0?void 0:s.access_token;if(a){const{error:o}=await this.admin.signOut(a,e);if(o&&!(Bb(o)&&(o.status===404||o.status===401||o.status===403)||tc(o)))return this._returnResult({error:o})}return e!=="others"&&(await this._removeSession(),await ht(this.storage,`${this.storageKey}-code-verifier`)),this._returnResult({error:null})})}onAuthStateChange(e){const i=Yb(),s={id:i,callback:e,unsubscribe:()=>{this._debug("#unsubscribe()","state change callback with id removed",i),this.stateChangeEmitters.delete(i)}};return this._debug("#onAuthStateChange()","registered callback with id",i),this.stateChangeEmitters.set(i,s),(async()=>(await this.initializePromise,await this._acquireLock(this.lockAcquireTimeout,async()=>{this._emitInitialSession(i)})))(),{data:{subscription:s}}}async _emitInitialSession(e){return await this._useSession(async i=>{var s,r;try{const{data:{session:n},error:a}=i;if(a)throw a;await((s=this.stateChangeEmitters.get(e))===null||s===void 0?void 0:s.callback("INITIAL_SESSION",n)),this._debug("INITIAL_SESSION","callback id",e,"session",n)}catch(n){await((r=this.stateChangeEmitters.get(e))===null||r===void 0?void 0:r.callback("INITIAL_SESSION",null)),this._debug("INITIAL_SESSION","callback id",e,"error",n),console.error(n)}})}async resetPasswordForEmail(e,i={}){let s=null,r=null;this.flowType==="pkce"&&([s,r]=await Sr(this.storage,this.storageKey,!0));try{return await he(this.fetch,"POST",`${this.url}/recover`,{body:{email:e,code_challenge:s,code_challenge_method:r,gotrue_meta_security:{captcha_token:i.captchaToken}},headers:this.headers,redirectTo:i.redirectTo})}catch(n){if(await ht(this.storage,`${this.storageKey}-code-verifier`),ae(n))return this._returnResult({data:null,error:n});throw n}}async getUserIdentities(){var e;try{const{data:i,error:s}=await this.getUser();if(s)throw s;return this._returnResult({data:{identities:(e=i.user.identities)!==null&&e!==void 0?e:[]},error:null})}catch(i){if(ae(i))return this._returnResult({data:null,error:i});throw i}}async linkIdentity(e){return"token"in e?this.linkIdentityIdToken(e):this.linkIdentityOAuth(e)}async linkIdentityOAuth(e){var i;try{const{data:s,error:r}=await this._useSession(async n=>{var a,o,l,c,h;const{data:d,error:u}=n;if(u)throw u;const p=await this._getUrlForProvider(`${this.url}/user/identities/authorize`,e.provider,{redirectTo:(a=e.options)===null||a===void 0?void 0:a.redirectTo,scopes:(o=e.options)===null||o===void 0?void 0:o.scopes,queryParams:(l=e.options)===null||l===void 0?void 0:l.queryParams,skipBrowserRedirect:!0});return await he(this.fetch,"GET",p,{headers:this.headers,jwt:(h=(c=d.session)===null||c===void 0?void 0:c.access_token)!==null&&h!==void 0?h:void 0})});if(r)throw r;return pt()&&!(!((i=e.options)===null||i===void 0)&&i.skipBrowserRedirect)&&window.location.assign(s==null?void 0:s.url),this._returnResult({data:{provider:e.provider,url:s==null?void 0:s.url},error:null})}catch(s){if(ae(s))return this._returnResult({data:{provider:e.provider,url:null},error:s});throw s}}async linkIdentityIdToken(e){return await this._useSession(async i=>{var s;try{const{error:r,data:{session:n}}=i;if(r)throw r;const{options:a,provider:o,token:l,access_token:c,nonce:h}=e,d=await he(this.fetch,"POST",`${this.url}/token?grant_type=id_token`,{headers:this.headers,jwt:(s=n==null?void 0:n.access_token)!==null&&s!==void 0?s:void 0,body:{provider:o,id_token:l,access_token:c,nonce:h,link_identity:!0,gotrue_meta_security:{captcha_token:a==null?void 0:a.captchaToken}},xform:oi}),{data:u,error:p}=d;return p?this._returnResult({data:{user:null,session:null},error:p}):!u||!u.session||!u.user?this._returnResult({data:{user:null,session:null},error:new wr}):(u.session&&(await this._saveSession(u.session),await this._notifyAllSubscribers("USER_UPDATED",u.session)),this._returnResult({data:u,error:p}))}catch(r){if(await ht(this.storage,`${this.storageKey}-code-verifier`),ae(r))return this._returnResult({data:{user:null,session:null},error:r});throw r}})}async unlinkIdentity(e){try{return await this._useSession(async i=>{var s,r;const{data:n,error:a}=i;if(a)throw a;return await he(this.fetch,"DELETE",`${this.url}/user/identities/${e.identity_id}`,{headers:this.headers,jwt:(r=(s=n.session)===null||s===void 0?void 0:s.access_token)!==null&&r!==void 0?r:void 0})})}catch(i){if(ae(i))return this._returnResult({data:null,error:i});throw i}}async _refreshAccessToken(e){const i=`#_refreshAccessToken(${e.substring(0,5)}...)`;this._debug(i,"begin");try{const s=Date.now();return await Jb(async r=>(r>0&&await Kb(200*Math.pow(2,r-1)),this._debug(i,"refreshing attempt",r),await he(this.fetch,"POST",`${this.url}/token?grant_type=refresh_token`,{body:{refresh_token:e},headers:this.headers,xform:oi})),(r,n)=>{const a=200*Math.pow(2,r);return n&&ic(n)&&Date.now()+a-s<Cr})}catch(s){if(this._debug(i,"error",s),ae(s))return this._returnResult({data:{session:null,user:null},error:s});throw s}finally{this._debug(i,"end")}}_isValidSession(e){return typeof e=="object"&&e!==null&&"access_token"in e&&"refresh_token"in e&&"expires_at"in e}async _handleProviderSignIn(e,i){const s=await this._getUrlForProvider(`${this.url}/authorize`,e,{redirectTo:i.redirectTo,scopes:i.scopes,queryParams:i.queryParams});return this._debug("#_handleProviderSignIn()","provider",e,"options",i,"url",s),pt()&&!i.skipBrowserRedirect&&window.location.assign(s),{data:{provider:e,url:s},error:null}}async _recoverAndRefresh(){var e,i;const s="#_recoverAndRefresh()";this._debug(s,"begin");try{const r=await Ms(this.storage,this.storageKey);if(r&&this.userStorage){let a=await Ms(this.userStorage,this.storageKey+"-user");!this.storage.isServer&&Object.is(this.storage,this.userStorage)&&!a&&(a={user:r.user},await _r(this.userStorage,this.storageKey+"-user",a)),r.user=(e=a==null?void 0:a.user)!==null&&e!==void 0?e:sc()}else if(r&&!r.user&&!r.user){const a=await Ms(this.storage,this.storageKey+"-user");a&&(a!=null&&a.user)?(r.user=a.user,await ht(this.storage,this.storageKey+"-user"),await _r(this.storage,this.storageKey,r)):r.user=sc()}if(this._debug(s,"session from storage",r),!this._isValidSession(r)){this._debug(s,"session is not valid"),r!==null&&await this._removeSession();return}const n=((i=r.expires_at)!==null&&i!==void 0?i:1/0)*1e3-Date.now()<ec;if(this._debug(s,`session has${n?"":" not"} expired with margin of ${ec}s`),n){if(this.autoRefreshToken&&r.refresh_token){const{error:a}=await this._callRefreshToken(r.refresh_token);a&&(console.error(a),ic(a)||(this._debug(s,"refresh failed with a non-retryable error, removing the session",a),await this._removeSession()))}}else if(r.user&&r.user.__isUserNotAvailableProxy===!0)try{const{data:a,error:o}=await this._getUser(r.access_token);!o&&(a!=null&&a.user)?(r.user=a.user,await this._saveSession(r),await this._notifyAllSubscribers("SIGNED_IN",r)):this._debug(s,"could not get user data, skipping SIGNED_IN notification")}catch(a){console.error("Error getting user data:",a),this._debug(s,"error getting user data, skipping SIGNED_IN notification",a)}else await this._notifyAllSubscribers("SIGNED_IN",r)}catch(r){this._debug(s,"error",r),console.error(r);return}finally{this._debug(s,"end")}}async _callRefreshToken(e){var i,s;if(!e)throw new Wt;if(this.refreshingDeferred)return this.refreshingDeferred.promise;const r=`#_callRefreshToken(${e.substring(0,5)}...)`;this._debug(r,"begin");try{this.refreshingDeferred=new nl;const{data:n,error:a}=await this._refreshAccessToken(e);if(a)throw a;if(!n.session)throw new Wt;await this._saveSession(n.session),await this._notifyAllSubscribers("TOKEN_REFRESHED",n.session);const o={data:n.session,error:null};return this.refreshingDeferred.resolve(o),o}catch(n){if(this._debug(r,"error",n),ae(n)){const a={data:null,error:n};return ic(n)||await this._removeSession(),(i=this.refreshingDeferred)===null||i===void 0||i.resolve(a),a}throw(s=this.refreshingDeferred)===null||s===void 0||s.reject(n),n}finally{this.refreshingDeferred=null,this._debug(r,"end")}}async _notifyAllSubscribers(e,i,s=!0){const r=`#_notifyAllSubscribers(${e})`;this._debug(r,"begin",i,`broadcast = ${s}`);try{this.broadcastChannel&&s&&this.broadcastChannel.postMessage({event:e,session:i});const n=[],a=Array.from(this.stateChangeEmitters.values()).map(async o=>{try{await o.callback(e,i)}catch(l){n.push(l)}});if(await Promise.all(a),n.length>0){for(let o=0;o<n.length;o+=1)console.error(n[o]);throw n[0]}}finally{this._debug(r,"end")}}async _saveSession(e){this._debug("#_saveSession()",e),this.suppressGetSessionWarning=!0,await ht(this.storage,`${this.storageKey}-code-verifier`);const i=Object.assign({},e),s=i.user&&i.user.__isUserNotAvailableProxy===!0;if(this.userStorage){!s&&i.user&&await _r(this.userStorage,this.storageKey+"-user",{user:i.user});const r=Object.assign({},i);delete r.user;const n=Vu(r);await _r(this.storage,this.storageKey,n)}else{const r=Vu(i);await _r(this.storage,this.storageKey,r)}}async _removeSession(){this._debug("#_removeSession()"),this.suppressGetSessionWarning=!1,await ht(this.storage,this.storageKey),await ht(this.storage,this.storageKey+"-code-verifier"),await ht(this.storage,this.storageKey+"-user"),this.userStorage&&await ht(this.userStorage,this.storageKey+"-user"),await this._notifyAllSubscribers("SIGNED_OUT",null)}_removeVisibilityChangedCallback(){this._debug("#_removeVisibilityChangedCallback()");const e=this.visibilityChangedCallback;this.visibilityChangedCallback=null;try{e&&pt()&&(window!=null&&window.removeEventListener)&&window.removeEventListener("visibilitychange",e)}catch(i){console.error("removing visibilitychange callback failed",i)}}async _startAutoRefresh(){await this._stopAutoRefresh(),this._debug("#_startAutoRefresh()");const e=setInterval(()=>this._autoRefreshTokenTick(),Cr);this.autoRefreshTicker=e,e&&typeof e=="object"&&typeof e.unref=="function"?e.unref():typeof Deno<"u"&&typeof Deno.unrefTimer=="function"&&Deno.unrefTimer(e);const i=setTimeout(async()=>{await this.initializePromise,await this._autoRefreshTokenTick()},0);this.autoRefreshTickTimeout=i,i&&typeof i=="object"&&typeof i.unref=="function"?i.unref():typeof Deno<"u"&&typeof Deno.unrefTimer=="function"&&Deno.unrefTimer(i)}async _stopAutoRefresh(){this._debug("#_stopAutoRefresh()");const e=this.autoRefreshTicker;this.autoRefreshTicker=null,e&&clearInterval(e);const i=this.autoRefreshTickTimeout;this.autoRefreshTickTimeout=null,i&&clearTimeout(i)}async startAutoRefresh(){this._removeVisibilityChangedCallback(),await this._startAutoRefresh()}async stopAutoRefresh(){this._removeVisibilityChangedCallback(),await this._stopAutoRefresh()}async _autoRefreshTokenTick(){this._debug("#_autoRefreshTokenTick()","begin");try{await this._acquireLock(0,async()=>{try{const e=Date.now();try{return await this._useSession(async i=>{const{data:{session:s}}=i;if(!s||!s.refresh_token||!s.expires_at){this._debug("#_autoRefreshTokenTick()","no session");return}const r=Math.floor((s.expires_at*1e3-e)/Cr);this._debug("#_autoRefreshTokenTick()",`access token expires in ${r} ticks, a tick lasts ${Cr}ms, refresh threshold is ${Vc} ticks`),r<=Vc&&await this._callRefreshToken(s.refresh_token)})}catch(i){console.error("Auto refresh tick failed with error. This is likely a transient error.",i)}}finally{this._debug("#_autoRefreshTokenTick()","end")}})}catch(e){if(e.isAcquireTimeout||e instanceof $g)this._debug("auto refresh token tick lock not available");else throw e}}async _handleVisibilityChange(){if(this._debug("#_handleVisibilityChange()"),!pt()||!(window!=null&&window.addEventListener))return this.autoRefreshToken&&this.startAutoRefresh(),!1;try{this.visibilityChangedCallback=async()=>{try{await this._onVisibilityChanged(!1)}catch(e){this._debug("#visibilityChangedCallback","error",e)}},window==null||window.addEventListener("visibilitychange",this.visibilityChangedCallback),await this._onVisibilityChanged(!0)}catch(e){console.error("_handleVisibilityChange",e)}}async _onVisibilityChanged(e){const i=`#_onVisibilityChanged(${e})`;this._debug(i,"visibilityState",document.visibilityState),document.visibilityState==="visible"?(this.autoRefreshToken&&this._startAutoRefresh(),e||(await this.initializePromise,await this._acquireLock(this.lockAcquireTimeout,async()=>{if(document.visibilityState!=="visible"){this._debug(i,"acquired the lock to recover the session, but the browser visibilityState is no longer visible, aborting");return}await this._recoverAndRefresh()}))):document.visibilityState==="hidden"&&this.autoRefreshToken&&this._stopAutoRefresh()}async _getUrlForProvider(e,i,s){const r=[`provider=${encodeURIComponent(i)}`];if(s!=null&&s.redirectTo&&r.push(`redirect_to=${encodeURIComponent(s.redirectTo)}`),s!=null&&s.scopes&&r.push(`scopes=${encodeURIComponent(s.scopes)}`),this.flowType==="pkce"){const[n,a]=await Sr(this.storage,this.storageKey),o=new URLSearchParams({code_challenge:`${encodeURIComponent(n)}`,code_challenge_method:`${encodeURIComponent(a)}`});r.push(o.toString())}if(s!=null&&s.queryParams){const n=new URLSearchParams(s.queryParams);r.push(n.toString())}return s!=null&&s.skipBrowserRedirect&&r.push(`skip_http_redirect=${s.skipBrowserRedirect}`),`${e}?${r.join("&")}`}async _unenroll(e){try{return await this._useSession(async i=>{var s;const{data:r,error:n}=i;return n?this._returnResult({data:null,error:n}):await he(this.fetch,"DELETE",`${this.url}/factors/${e.factorId}`,{headers:this.headers,jwt:(s=r==null?void 0:r.session)===null||s===void 0?void 0:s.access_token})})}catch(i){if(ae(i))return this._returnResult({data:null,error:i});throw i}}async _enroll(e){try{return await this._useSession(async i=>{var s,r;const{data:n,error:a}=i;if(a)return this._returnResult({data:null,error:a});const o=Object.assign({friendly_name:e.friendlyName,factor_type:e.factorType},e.factorType==="phone"?{phone:e.phone}:e.factorType==="totp"?{issuer:e.issuer}:{}),{data:l,error:c}=await he(this.fetch,"POST",`${this.url}/factors`,{body:o,headers:this.headers,jwt:(s=n==null?void 0:n.session)===null||s===void 0?void 0:s.access_token});return c?this._returnResult({data:null,error:c}):(e.factorType==="totp"&&l.type==="totp"&&(!((r=l==null?void 0:l.totp)===null||r===void 0)&&r.qr_code)&&(l.totp.qr_code=`data:image/svg+xml;utf-8,${l.totp.qr_code}`),this._returnResult({data:l,error:null}))})}catch(i){if(ae(i))return this._returnResult({data:null,error:i});throw i}}async _verify(e){return this._acquireLock(this.lockAcquireTimeout,async()=>{try{return await this._useSession(async i=>{var s;const{data:r,error:n}=i;if(n)return this._returnResult({data:null,error:n});const a=Object.assign({challenge_id:e.challengeId},"webauthn"in e?{webauthn:Object.assign(Object.assign({},e.webauthn),{credential_response:e.webauthn.type==="create"?_w(e.webauthn.credential_response):Rw(e.webauthn.credential_response)})}:{code:e.code}),{data:o,error:l}=await he(this.fetch,"POST",`${this.url}/factors/${e.factorId}/verify`,{body:a,headers:this.headers,jwt:(s=r==null?void 0:r.session)===null||s===void 0?void 0:s.access_token});return l?this._returnResult({data:null,error:l}):(await this._saveSession(Object.assign({expires_at:Math.round(Date.now()/1e3)+o.expires_in},o)),await this._notifyAllSubscribers("MFA_CHALLENGE_VERIFIED",o),this._returnResult({data:o,error:l}))})}catch(i){if(ae(i))return this._returnResult({data:null,error:i});throw i}})}async _challenge(e){return this._acquireLock(this.lockAcquireTimeout,async()=>{try{return await this._useSession(async i=>{var s;const{data:r,error:n}=i;if(n)return this._returnResult({data:null,error:n});const a=await he(this.fetch,"POST",`${this.url}/factors/${e.factorId}/challenge`,{body:e,headers:this.headers,jwt:(s=r==null?void 0:r.session)===null||s===void 0?void 0:s.access_token});if(a.error)return a;const{data:o}=a;if(o.type!=="webauthn")return{data:o,error:null};switch(o.webauthn.type){case"create":return{data:Object.assign(Object.assign({},o),{webauthn:Object.assign(Object.assign({},o.webauthn),{credential_options:Object.assign(Object.assign({},o.webauthn.credential_options),{publicKey:Pw(o.webauthn.credential_options.publicKey)})})}),error:null};case"request":return{data:Object.assign(Object.assign({},o),{webauthn:Object.assign(Object.assign({},o.webauthn),{credential_options:Object.assign(Object.assign({},o.webauthn.credential_options),{publicKey:Cw(o.webauthn.credential_options.publicKey)})})}),error:null}}})}catch(i){if(ae(i))return this._returnResult({data:null,error:i});throw i}})}async _challengeAndVerify(e){const{data:i,error:s}=await this._challenge({factorId:e.factorId});return s?this._returnResult({data:null,error:s}):await this._verify({factorId:e.factorId,challengeId:i.id,code:e.code})}async _listFactors(){var e;const{data:{user:i},error:s}=await this.getUser();if(s)return{data:null,error:s};const r={all:[],phone:[],totp:[],webauthn:[]};for(const n of(e=i==null?void 0:i.factors)!==null&&e!==void 0?e:[])r.all.push(n),n.status==="verified"&&r[n.factor_type].push(n);return{data:r,error:null}}async _getAuthenticatorAssuranceLevel(e){var i,s,r,n;if(e)try{const{payload:p}=Ga(e);let f=null;p.aal&&(f=p.aal);let g=f;const{data:{user:m},error:y}=await this.getUser(e);if(y)return this._returnResult({data:null,error:y});((s=(i=m==null?void 0:m.factors)===null||i===void 0?void 0:i.filter(k=>k.status==="verified"))!==null&&s!==void 0?s:[]).length>0&&(g="aal2");const w=p.amr||[];return{data:{currentLevel:f,nextLevel:g,currentAuthenticationMethods:w},error:null}}catch(p){if(ae(p))return this._returnResult({data:null,error:p});throw p}const{data:{session:a},error:o}=await this.getSession();if(o)return this._returnResult({data:null,error:o});if(!a)return{data:{currentLevel:null,nextLevel:null,currentAuthenticationMethods:[]},error:null};const{payload:l}=Ga(a.access_token);let c=null;l.aal&&(c=l.aal);let h=c;((n=(r=a.user.factors)===null||r===void 0?void 0:r.filter(p=>p.status==="verified"))!==null&&n!==void 0?n:[]).length>0&&(h="aal2");const u=l.amr||[];return{data:{currentLevel:c,nextLevel:h,currentAuthenticationMethods:u},error:null}}async _getAuthorizationDetails(e){try{return await this._useSession(async i=>{const{data:{session:s},error:r}=i;return r?this._returnResult({data:null,error:r}):s?await he(this.fetch,"GET",`${this.url}/oauth/authorizations/${e}`,{headers:this.headers,jwt:s.access_token,xform:n=>({data:n,error:null})}):this._returnResult({data:null,error:new Wt})})}catch(i){if(ae(i))return this._returnResult({data:null,error:i});throw i}}async _approveAuthorization(e,i){try{return await this._useSession(async s=>{const{data:{session:r},error:n}=s;if(n)return this._returnResult({data:null,error:n});if(!r)return this._returnResult({data:null,error:new Wt});const a=await he(this.fetch,"POST",`${this.url}/oauth/authorizations/${e}/consent`,{headers:this.headers,jwt:r.access_token,body:{action:"approve"},xform:o=>({data:o,error:null})});return a.data&&a.data.redirect_url&&pt()&&!(i!=null&&i.skipBrowserRedirect)&&window.location.assign(a.data.redirect_url),a})}catch(s){if(ae(s))return this._returnResult({data:null,error:s});throw s}}async _denyAuthorization(e,i){try{return await this._useSession(async s=>{const{data:{session:r},error:n}=s;if(n)return this._returnResult({data:null,error:n});if(!r)return this._returnResult({data:null,error:new Wt});const a=await he(this.fetch,"POST",`${this.url}/oauth/authorizations/${e}/consent`,{headers:this.headers,jwt:r.access_token,body:{action:"deny"},xform:o=>({data:o,error:null})});return a.data&&a.data.redirect_url&&pt()&&!(i!=null&&i.skipBrowserRedirect)&&window.location.assign(a.data.redirect_url),a})}catch(s){if(ae(s))return this._returnResult({data:null,error:s});throw s}}async _listOAuthGrants(){try{return await this._useSession(async e=>{const{data:{session:i},error:s}=e;return s?this._returnResult({data:null,error:s}):i?await he(this.fetch,"GET",`${this.url}/user/oauth/grants`,{headers:this.headers,jwt:i.access_token,xform:r=>({data:r,error:null})}):this._returnResult({data:null,error:new Wt})})}catch(e){if(ae(e))return this._returnResult({data:null,error:e});throw e}}async _revokeOAuthGrant(e){try{return await this._useSession(async i=>{const{data:{session:s},error:r}=i;return r?this._returnResult({data:null,error:r}):s?(await he(this.fetch,"DELETE",`${this.url}/user/oauth/grants`,{headers:this.headers,jwt:s.access_token,query:{client_id:e.clientId},noResolveJson:!0}),{data:{},error:null}):this._returnResult({data:null,error:new Wt})})}catch(i){if(ae(i))return this._returnResult({data:null,error:i});throw i}}async fetchJwk(e,i={keys:[]}){let s=i.keys.find(o=>o.kid===e);if(s)return s;const r=Date.now();if(s=this.jwks.keys.find(o=>o.kid===e),s&&this.jwks_cached_at+qb>r)return s;const{data:n,error:a}=await he(this.fetch,"GET",`${this.url}/.well-known/jwks.json`,{headers:this.headers});if(a)throw a;return!n.keys||n.keys.length===0||(this.jwks=n,this.jwks_cached_at=r,s=n.keys.find(o=>o.kid===e),!s)?null:s}async getClaims(e,i={}){try{let s=e;if(!s){const{data:p,error:f}=await this.getSession();if(f||!p.session)return this._returnResult({data:null,error:f});s=p.session.access_token}const{header:r,payload:n,signature:a,raw:{header:o,payload:l}}=Ga(s);i!=null&&i.allowExpired||aw(n.exp);const c=!r.alg||r.alg.startsWith("HS")||!r.kid||!("crypto"in globalThis&&"subtle"in globalThis.crypto)?null:await this.fetchJwk(r.kid,i!=null&&i.keys?{keys:i.keys}:i==null?void 0:i.jwks);if(!c){const{error:p}=await this.getUser(s);if(p)throw p;return{data:{claims:n,header:r,signature:a},error:null}}const h=ow(r.alg),d=await crypto.subtle.importKey("jwk",c,h,!0,["verify"]);if(!await crypto.subtle.verify(h,d,a,Xb(`${o}.${l}`)))throw new Gc("Invalid JWT signature");return{data:{claims:n,header:r,signature:a},error:null}}catch(s){if(ae(s))return this._returnResult({data:null,error:s});throw s}}}ra.nextInstanceID={};const Dw=ra,Bw="2.93.1";let An="";typeof Deno<"u"?An="deno":typeof document<"u"?An="web":typeof navigator<"u"&&navigator.product==="ReactNative"?An="react-native":An="node";function jw(){const t=globalThis.process;if(t&&t.platform){const e=t.platform;if(e==="darwin")return"macOS";if(e==="win32")return"Windows";if(e==="linux")return"Linux";if(e==="android")return"Android"}if(typeof navigator<"u"&&navigator.userAgentData&&navigator.userAgentData.platform){const e=navigator.userAgentData.platform;if(e==="macOS")return"macOS";if(e==="Windows")return"Windows";if(e==="Linux")return"Linux";if(e==="Android")return"Android";if(e==="iOS")return"iOS"}return null}function Ww(){const t=globalThis.process;if(t){const e=t.versions;if(e&&e.node&&typeof window>"u")try{const i=globalThis.require;if(i)return i("os").release()}catch{return null}}if(typeof Deno<"u"&&Deno.osRelease)try{return Deno.osRelease()}catch{return null}return typeof navigator<"u"&&navigator.userAgentData&&navigator.userAgentData.platformVersion?navigator.userAgentData.platformVersion:null}function Fw(){if(typeof Deno<"u")return"deno";if(typeof Bun<"u")return"bun";const t=globalThis.process;if(t){const e=t.versions;if(e&&e.node)return"node"}return null}function Uw(){if(typeof Deno<"u"&&Deno.version)return Deno.version.deno;if(typeof Bun<"u"&&Bun.version)return Bun.version;const t=globalThis.process;if(t){const e=t.versions;if(e&&e.node)return e.node}return null}function Vw(){const t={"X-Client-Info":`supabase-js-${An}/${Bw}`},e=jw();e&&(t["X-Supabase-Client-Platform"]=e);const i=Ww();i&&(t["X-Supabase-Client-Platform-Version"]=i);const s=Fw();s&&(t["X-Supabase-Client-Runtime"]=s);const r=Uw();return r&&(t["X-Supabase-Client-Runtime-Version"]=r),t}const zw=Vw(),Xw={headers:zw},Gw={schema:"public"},Yw={autoRefreshToken:!0,persistSession:!0,detectSessionInUrl:!0,flowType:"implicit"},Zw={};function na(t){"@babel/helpers - typeof";return na=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},na(t)}function Hw(t,e){if(na(t)!="object"||!t)return t;var i=t[Symbol.toPrimitive];if(i!==void 0){var s=i.call(t,e);if(na(s)!="object")return s;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function Kw(t){var e=Hw(t,"string");return na(e)=="symbol"?e:e+""}function Jw(t,e,i){return(e=Kw(e))in t?Object.defineProperty(t,e,{value:i,enumerable:!0,configurable:!0,writable:!0}):t[e]=i,t}function Ku(t,e){var i=Object.keys(t);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(t);e&&(s=s.filter(function(r){return Object.getOwnPropertyDescriptor(t,r).enumerable})),i.push.apply(i,s)}return i}function ze(t){for(var e=1;e<arguments.length;e++){var i=arguments[e]!=null?arguments[e]:{};e%2?Ku(Object(i),!0).forEach(function(s){Jw(t,s,i[s])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(i)):Ku(Object(i)).forEach(function(s){Object.defineProperty(t,s,Object.getOwnPropertyDescriptor(i,s))})}return t}const eS=t=>t?(...e)=>t(...e):(...e)=>fetch(...e),tS=()=>Headers,iS=(t,e,i)=>{const s=eS(i),r=tS();return async(n,a)=>{var o;const l=(o=await e())!==null&&o!==void 0?o:t;let c=new r(a==null?void 0:a.headers);return c.has("apikey")||c.set("apikey",t),c.has("Authorization")||c.set("Authorization",`Bearer ${l}`),s(n,ze(ze({},a),{},{headers:c}))}};function sS(t){return t.endsWith("/")?t:t+"/"}function rS(t,e){var i,s;const{db:r,auth:n,realtime:a,global:o}=t,{db:l,auth:c,realtime:h,global:d}=e,u={db:ze(ze({},l),r),auth:ze(ze({},c),n),realtime:ze(ze({},h),a),storage:{},global:ze(ze(ze({},d),o),{},{headers:ze(ze({},(i=d==null?void 0:d.headers)!==null&&i!==void 0?i:{}),(s=o==null?void 0:o.headers)!==null&&s!==void 0?s:{})}),accessToken:async()=>""};return t.accessToken?u.accessToken=t.accessToken:delete u.accessToken,u}function nS(t){const e=t==null?void 0:t.trim();if(!e)throw new Error("supabaseUrl is required.");if(!e.match(/^https?:\/\//i))throw new Error("Invalid supabaseUrl: Must be a valid HTTP or HTTPS URL.");try{return new URL(sS(e))}catch{throw Error("Invalid supabaseUrl: Provided URL is malformed.")}}var aS=class extends Dw{constructor(t){super(t)}},oS=class{constructor(t,e,i){var s,r;this.supabaseUrl=t,this.supabaseKey=e;const n=nS(t);if(!e)throw new Error("supabaseKey is required.");this.realtimeUrl=new URL("realtime/v1",n),this.realtimeUrl.protocol=this.realtimeUrl.protocol.replace("http","ws"),this.authUrl=new URL("auth/v1",n),this.storageUrl=new URL("storage/v1",n),this.functionsUrl=new URL("functions/v1",n);const a=`sb-${n.hostname.split(".")[0]}-auth-token`,o={db:Gw,realtime:Zw,auth:ze(ze({},Yw),{},{storageKey:a}),global:Xw},l=rS(i??{},o);if(this.storageKey=(s=l.auth.storageKey)!==null&&s!==void 0?s:"",this.headers=(r=l.global.headers)!==null&&r!==void 0?r:{},l.accessToken)this.accessToken=l.accessToken,this.auth=new Proxy({},{get:(h,d)=>{throw new Error(`@supabase/supabase-js: Supabase Client is configured with the accessToken option, accessing supabase.auth.${String(d)} is not possible`)}});else{var c;this.auth=this._initSupabaseAuthClient((c=l.auth)!==null&&c!==void 0?c:{},this.headers,l.global.fetch)}this.fetch=iS(e,this._getAccessToken.bind(this),l.global.fetch),this.realtime=this._initRealtimeClient(ze({headers:this.headers,accessToken:this._getAccessToken.bind(this)},l.realtime)),this.accessToken&&Promise.resolve(this.accessToken()).then(h=>this.realtime.setAuth(h)).catch(h=>console.warn("Failed to set initial Realtime auth token:",h)),this.rest=new Dv(new URL("rest/v1",n).href,{headers:this.headers,schema:l.db.schema,fetch:this.fetch}),this.storage=new Qb(this.storageUrl.href,this.headers,this.fetch,i==null?void 0:i.storage),l.accessToken||this._listenForAuthEvents()}get functions(){return new Av(this.functionsUrl.href,{headers:this.headers,customFetch:this.fetch})}from(t){return this.rest.from(t)}schema(t){return this.rest.schema(t)}rpc(t,e={},i={head:!1,get:!1,count:void 0}){return this.rest.rpc(t,e,i)}channel(t,e={config:{}}){return this.realtime.channel(t,e)}getChannels(){return this.realtime.getChannels()}removeChannel(t){return this.realtime.removeChannel(t)}removeAllChannels(){return this.realtime.removeAllChannels()}async _getAccessToken(){var t=this,e,i;if(t.accessToken)return await t.accessToken();const{data:s}=await t.auth.getSession();return(e=(i=s.session)===null||i===void 0?void 0:i.access_token)!==null&&e!==void 0?e:t.supabaseKey}_initSupabaseAuthClient({autoRefreshToken:t,persistSession:e,detectSessionInUrl:i,storage:s,userStorage:r,storageKey:n,flowType:a,lock:o,debug:l,throwOnError:c},h,d){const u={Authorization:`Bearer ${this.supabaseKey}`,apikey:`${this.supabaseKey}`};return new aS({url:this.authUrl.href,headers:ze(ze({},u),h),storageKey:n,autoRefreshToken:t,persistSession:e,detectSessionInUrl:i,storage:s,userStorage:r,flowType:a,lock:o,debug:l,throwOnError:c,fetch:d,hasCustomAuthorizationHeader:Object.keys(this.headers).some(p=>p.toLowerCase()==="authorization")})}_initRealtimeClient(t){return new ib(this.realtimeUrl.href,ze(ze({},t),{},{params:ze(ze({},{apikey:this.supabaseKey}),t==null?void 0:t.params)}))}_listenForAuthEvents(){return this.auth.onAuthStateChange((t,e)=>{this._handleTokenChanged(t,"CLIENT",e==null?void 0:e.access_token)})}_handleTokenChanged(t,e,i){(t==="TOKEN_REFRESHED"||t==="SIGNED_IN")&&this.changedAccessToken!==i?(this.changedAccessToken=i,this.realtime.setAuth(i)):t==="SIGNED_OUT"&&(this.realtime.setAuth(),e=="STORAGE"&&this.auth.signOut(),this.changedAccessToken=void 0)}};const lS=(t,e,i)=>new oS(t,e,i);function cS(){if(typeof window<"u")return!1;const t=globalThis.process;if(!t)return!1;const e=t.version;if(e==null)return!1;const i=e.match(/^v(\d+)\./);return i?parseInt(i[1],10)<=18:!1}cS()&&console.warn("âš ï¸  Node.js 18 and below are deprecated and will no longer be supported in future versions of @supabase/supabase-js. Please upgrade to Node.js 20 or later. For more information, visit: https://github.com/orgs/supabase/discussions/37217");const hS="https://scxbnrxhmfhpfpakivmq.supabase.co",dS="sb_publishable_LJfatXDOn0N1LpLdmN-17Q_PC5wmtSi";let Yc=null;Yc=lS(hS,dS);async function uS(){if(Yc)try{const{error:t}=await Yc.from("visits").insert([{}]);t?console.error("Error tracking visit:",t):console.log("Visit tracked successfully")}catch(t){console.error("Unexpected error tracking visit:",t)}}const pS={dashboard:"/dashboard",algorithms:"/algorithms",searching:"/searching",pathfinding:"/pathfinding","divide-conquer":"/divide-conquer","algorithm-race":"/algorithm-race","ds-array":"/ds-array","ds-stack":"/ds-stack","ds-queue":"/ds-queue","ds-linkedlist":"/ds-linkedlist","ds-tree":"/ds-tree","ds-hash":"/ds-hash","ds-heap":"/ds-heap","ds-graph":"/ds-graph","sql-lab":"/sql","sql-practice":"/sql-practice","sql-visualizer":"/sql-visualizer","sql-lessons":"/sql-lessons","electure-algorithms":"/lectures","electure-datastructures":"/lectures-ds","electure-sql":"/lectures-sql","quiz-mode":"/quiz","algorithm-sandbox":"/algorithm-sandbox","ds-sandbox":"/ds-sandbox","algo-midterm-solutions":"/algorithms/midterm-solutions","algo-final-solutions":"/algorithms/final-solutions","lab-solutions":"/data-structures/lab-solutions","midterm-solutions":"/data-structures/midterm-solutions","final-solutions":"/data-structures/final-solutions","db-erd":"/db-erd","db-eerd":"/db-eerd","db-schema":"/db-schema","db-normalization":"/db-normalization","relational-algebra":"/relational-algebra",transactions:"/transactions",btree:"/btree",nosql:"/nosql","schema-live":"/schema-live"},id={activeSection:"dashboard",setSection(t){if(window.Router){const e=pS[t]||`/${t}`;window.Router.navigateTo(e);return}this._legacySetSection(t)},_legacySetSection(t){var i,s,r;this.activeSection!==t&&(typeof window.pauseSorting=="function"&&window.pauseSorting(),typeof window.pausePath=="function"&&window.pausePath(),(i=window.SortEngine)!=null&&i.clearCompletionTimers&&window.SortEngine.clearCompletionTimers(),(s=window.PathEngine)!=null&&s.clearCompletionTimers&&window.PathEngine.clearCompletionTimers()),this.activeSection=t,Jn(".nav-item").forEach(n=>n.classList.remove("active"));const e=document.querySelector(`.nav-item[data-section="${t}"]`);e==null||e.classList.add("active"),Jn("section").forEach(n=>n.classList.add("section-hidden")),(r=v(`section-${t}`))==null||r.classList.remove("section-hidden"),typeof window.UXManager<"u"&&window.UXManager.saveSession(),setTimeout(()=>{var n,a;t==="algorithms"?(typeof window.initSorting=="function"&&window.initSorting(),typeof window.QuizManager<"u"&&window.QuizManager.renderQuiz("sortingQuizContainer","algorithms")):t==="pathfinding"?typeof window.initPathfinding=="function"&&window.initPathfinding():t.startsWith("ds-")?(n=window.DS)!=null&&n.renderAll&&window.DS.renderAll():t==="story-bigo"?typeof window.renderBigO=="function"&&window.renderBigO():(t==="sql-lab"||t==="sql-practice")&&(a=window.SQLModule)!=null&&a.ensureReady&&window.SQLModule.ensureReady()},60)},updateActiveSection(t){this.activeSection=t}};function Ju(){Jn(".nav-item").forEach(t=>{t.addEventListener("click",()=>{const e=t.dataset.route,i=t.dataset.section;e&&window.Router?window.Router.navigateTo(e):i&&id.setSection(i)})})}function fS(){const t=document.getElementById("topRightControls"),e=document.getElementById("mainContent");if(!t)return;(e||window).addEventListener("scroll",()=>{const s=e?e.scrollTop:window.pageYOffset||document.documentElement.scrollTop;s<0||(s<50?t.classList.remove("controls-hidden"):t.classList.add("controls-hidden"),lastScrollTop=s)},{passive:!0})}window.UI=id;function Zc(t){const e=document.createElement("div");return e.textContent=t,e.innerHTML}function gS(){document.querySelectorAll(".code-block").forEach(e=>{if(e.dataset.enhanced)return;const i=e.querySelector("code");if(!i)return;const s=i.textContent.split(`
`),r=e.querySelector("pre"),n=document.createElement("div");n.className="line-numbers",n.style.cssText=`
      position: absolute;
      left: 0;
      top: 0;
      width: 3rem;
      padding: 1rem 0;
      text-align: right;
      font-family: 'JetBrains Mono', monospace;
      font-size: 0.75rem;
      line-height: 1.7;
      color: #858585;
      background: #252526;
      border-right: 1px solid #333;
      user-select: none;
      z-index: 1;
    `,s.forEach((o,l)=>{const c=document.createElement("div");c.textContent=l+1,c.style.paddingRight="0.5rem",n.appendChild(c)}),r&&(r.style.position="relative",r.insertBefore(n,r.firstChild));const a=s.map((o,l)=>{const c=o.match(/^(\s*)/),h=c?c[1].length:0,d=Math.floor(h/2);if(d>0){let u="";for(let p=0;p<d;p++)u+=`<span class="indent-guide" style="border-left: 1px solid rgba(255,255,255,0.08); position: absolute; left: ${p*16+8}px; top: 0; bottom: 0;"></span>`;return`<span class="line" style="position: relative; display: block;">${u}${Zc(o)}</span>`}return`<span class="line" style="display: block;">${Zc(o)}</span>`});i.innerHTML=a.join(""),e.dataset.enhanced="true"})}window.enhanceCodeBlocks=gS;window.escapeHtml=Zc;const Li={colors:["#ff6b6b","#4ecdc4","#45b7d1","#96ceb4","#ffeaa7","#dfe6e9","#a29bfe","#fd79a8"],burst(t,e,i=50){for(let s=0;s<i;s++)this.createParticle(t,e)},createParticle(t,e){const i=document.createElement("div");i.className="confetti-particle";const s=this.colors[Math.floor(Math.random()*this.colors.length)],r=(Math.random()-.5)*400,n=-(Math.random()*350+100),a=Math.random()*720;i.style.cssText=`
      left: ${t}px;
      top: ${e}px;
      background: ${s};
      --x: ${r}px;
      --y: ${n}px;
      --r: ${a}deg;
      width: ${6+Math.random()*8}px;
      height: ${6+Math.random()*8}px;
      border-radius: ${Math.random()>.5?"50%":"2px"};
    `,document.body.appendChild(i),setTimeout(()=>i.remove(),1500)},celebrate(t=80){this.burst(window.innerWidth/2,window.innerHeight/2,t)}};typeof window<"u"&&(window.ConfettiSystem=Li);const hi={currentStep:0,answers:{},questions:[{question:"What brings you here today?",options:[{icon:"ðŸ“",text:"Preparing for interviews",value:"interview"},{icon:"ðŸŽ“",text:"Learning for class",value:"class"},{icon:"ðŸ§ ",text:"Just curious about DSA",value:"curious"},{icon:"ðŸ†",text:"Practice & challenges",value:"practice"}]},{question:"How much time can you dedicate daily?",options:[{icon:"âš¡",text:"5 minutes (Casual)",value:"casual"},{icon:"ðŸŽ¯",text:"15 minutes (Regular)",value:"regular"},{icon:"ðŸš€",text:"30+ minutes (Intensive)",value:"intensive"}]}],init(){localStorage.getItem("cse-has-visited")||this.showWelcome()},showWelcome(){const t=document.getElementById("welcomeOverlay");t&&t.classList.remove("hidden")},hideWelcome(){const t=document.getElementById("welcomeOverlay");t&&t.classList.add("hidden")},startSurvey(){this.hideWelcome(),this.currentStep=0,this.showSurvey(),this.renderQuestion()},showSurvey(){const t=document.getElementById("onboardingSurvey");t&&t.classList.remove("hidden")},hideSurvey(){const t=document.getElementById("onboardingSurvey");t&&t.classList.add("hidden")},renderQuestion(){const t=this.questions[this.currentStep],e=document.getElementById("surveyQuestion"),i=document.getElementById("surveyOptions");!e||!i||(e.textContent=t.question,i.innerHTML=t.options.map((s,r)=>`
      <div class="survey-option" onclick="OnboardingSystem.selectOption(${r}, '${s.value}')">
        <span class="survey-option-icon">${s.icon}</span>
        <span class="survey-option-text">${s.text}</span>
      </div>
    `).join(""),document.querySelectorAll(".survey-dot").forEach((s,r)=>{s.classList.toggle("active",r===this.currentStep)}))},selectOption(t,e){this.answers[this.currentStep]=e,document.querySelectorAll(".survey-option").forEach((i,s)=>{i.classList.toggle("selected",s===t)}),setTimeout(()=>{this.currentStep++,this.currentStep<this.questions.length?this.renderQuestion():this.completeSurvey()},400)},completeSurvey(){localStorage.setItem("cse-onboarding",JSON.stringify(this.answers)),localStorage.setItem("cse-has-visited","true"),this.hideSurvey(),Li.burst(window.innerWidth/2,window.innerHeight/2,80),T("ðŸŽ‰ Welcome! Let's get started!","success"),setTimeout(()=>{typeof window.AchievementSystem<"u"&&window.AchievementSystem.unlock("welcome")},1500)}};function mS(){hi.startSurvey()}typeof window<"u"&&(window.OnboardingSystem=hi,window.startOnboarding=mS);function Fi(t){const e=document.querySelector(`.nav-item[data-section="${t}"]`);return e?(e.click(),!0):(T(`Section "${t}" not found`,"error"),!1)}function Ag(){const t=document.querySelector('.back-to-dashboard-btn, [onclick*="dashboard"]');t?t.click():T("Already on dashboard or no back button","info")}function Lg(){const t=document.documentElement,e=t.getAttribute("data-theme");t.setAttribute("data-theme",e==="dark"?"light":"dark"),localStorage.setItem("cse-theme",t.getAttribute("data-theme")),T(e==="dark"?"â˜€ï¸ Light mode":"ðŸŒ™ Dark mode","success")}function Ng(){const t=document.getElementById("keyboardShortcutsModal");t&&t.classList.remove("collapsed")}const Ks={commands:[{icon:"ðŸ ",text:"Go to Dashboard",action:()=>Ag(),shortcut:""},{icon:"âš¡",text:"Sorting Algorithms",action:()=>Fi("algorithms"),shortcut:""},{icon:"ðŸ”",text:"Searching Visualization",action:()=>Fi("searching"),shortcut:""},{icon:"ðŸ—ºï¸",text:"Pathfinding",action:()=>Fi("pathfinding"),shortcut:""},{icon:"ðŸ’¾",text:"SQL Lab",action:()=>Fi("sql-lab"),shortcut:""},{icon:"ðŸ§ª",text:"Code Sandbox",action:()=>Fi("algorithm-sandbox"),shortcut:""},{icon:"ðŸŽ¯",text:"Daily Challenge",action:()=>Fi("daily-challenge"),shortcut:""},{icon:"ðŸ“Š",text:"Data Structures",action:()=>Fi("ds-array"),shortcut:""},{icon:"ðŸ”º",text:"Heaps & Priority Queue",action:()=>Fi("ds-heap"),shortcut:""},{icon:"ðŸŽ“",text:"E-Lecture: Quick Sort",action:()=>{window.ELectureMode&&window.ELectureMode.start("quicksort")},shortcut:""},{icon:"ðŸŽ“",text:"E-Lecture: BFS",action:()=>{window.ELectureMode&&window.ELectureMode.start("bfs")},shortcut:""},{icon:"ðŸŒ™",text:"Toggle Dark Mode",action:()=>Lg(),shortcut:"Ctrl+Shift+D"},{icon:"â“",text:"Keyboard Shortcuts",action:()=>Ng(),shortcut:"?"}],filteredCommands:[],selectedIndex:0,init(){this.filteredCommands=[...this.commands],document.addEventListener("keydown",t=>{(t.ctrlKey||t.metaKey)&&t.key==="k"&&(t.preventDefault(),this.toggle()),this.isOpen()&&(t.key==="ArrowDown"?(t.preventDefault(),this.selectedIndex=Math.min(this.selectedIndex+1,this.filteredCommands.length-1),this.renderResults()):t.key==="ArrowUp"?(t.preventDefault(),this.selectedIndex=Math.max(this.selectedIndex-1,0),this.renderResults()):t.key==="Enter"?(t.preventDefault(),this.executeSelected()):t.key==="Escape"&&this.close())})},isOpen(){var t;return(t=document.getElementById("commandPaletteOverlay"))==null?void 0:t.classList.contains("open")},toggle(){this.isOpen()?this.close():this.open()},open(){const t=document.getElementById("commandPaletteOverlay"),e=document.getElementById("commandPaletteInput");t&&(t.classList.add("open"),this.filteredCommands=[...this.commands],this.selectedIndex=0,this.renderResults(),e&&(e.value="",setTimeout(()=>e.focus(),100)))},close(){const t=document.getElementById("commandPaletteOverlay");t&&t.classList.remove("open")},filter(t){const e=t.toLowerCase();this.filteredCommands=this.commands.filter(i=>i.text.toLowerCase().includes(e)),this.selectedIndex=0,this.renderResults()},renderResults(){const t=document.getElementById("commandPaletteResults");t&&(t.innerHTML=this.filteredCommands.map((e,i)=>`
      <div class="command-item ${i===this.selectedIndex?"selected":""}" 
           data-index="${i}">
        <span class="command-item-icon">${e.icon}</span>
        <span class="command-item-text">${e.text}</span>
        ${e.shortcut?`<span class="command-item-shortcut">${e.shortcut}</span>`:""}
      </div>
    `).join(""),t.onclick=e=>{const i=e.target.closest(".command-item");if(i){const s=parseInt(i.dataset.index,10);this.execute(s)}},t.onmouseover=e=>{const i=e.target.closest(".command-item");if(i){const s=parseInt(i.dataset.index,10);this.updateSelected(s)}})},updateSelected(t){this.selectedIndex=t,document.querySelectorAll(".command-item").forEach((i,s)=>{i.classList.toggle("selected",s===t)})},execute(t){const e=this.filteredCommands[t];e&&(this.close(),e.action())},executeSelected(){this.execute(this.selectedIndex)}};function OS(){const t=document.getElementById("commandPaletteInput");t&&Ks.filter(t.value)}function yS(){Ks.close()}typeof window<"u"&&(window.CommandPalette=Ks,window.filterCommands=OS,window.closeCommandPalette=yS,window.clickSection=Fi,window.goToDashboard=Ag,window.toggleDarkMode=Lg,window.showShortcutsModal=Ng);const Ge={state:{current:0,longest:0,lastActiveDate:null,freezesAvailable:1,totalXP:0,activeDates:[]},init(){this.load(),this.checkIn()},load(){try{const t=localStorage.getItem("cse-helper-streak-data");t&&(this.state={...this.state,...JSON.parse(t)})}catch(t){console.warn("[StreakSystem] Failed to load state:",t)}},save(){localStorage.setItem("cse-helper-streak-data",JSON.stringify(this.state))},getDateString(t=0){const e=new Date;return e.setDate(e.getDate()+t),e.toISOString().split("T")[0]},checkIn(){const t=this.getDateString(),e=this.getDateString(-1);this.state.lastActiveDate!==t&&(this.state.lastActiveDate===e?(this.state.current++,this.state.current>this.state.longest&&(this.state.longest=this.state.current),T(`ðŸ”¥ ${this.state.current} day streak!`,"success")):this.state.lastActiveDate&&this.state.lastActiveDate!==t?(this.state.current=1,T("âš¡ New streak started!","success")):this.state.current=1,this.state.activeDates||(this.state.activeDates=[]),this.state.activeDates.includes(t)||(this.state.activeDates.push(t),this.state.activeDates.length>60&&(this.state.activeDates=this.state.activeDates.slice(-60))),this.state.lastActiveDate=t,this.save(),this.updateUI())},addXP(t,e=""){const i=this.state.totalXP;return this.state.totalXP+=t,this.save(),this.updateUI(),e&&T(`+${t} XP: ${e}`,"success"),{oldXP:i,newXP:this.state.totalXP}},updateUI(){document.querySelectorAll(".streak-count, #currentStreak").forEach(i=>i.textContent=this.state.current),document.querySelectorAll("#totalXP").forEach(i=>i.textContent=this.state.totalXP.toLocaleString())},freezesAvailableCount(){return this.state.freezesAvailable||0},useFreeze(){return this.state.freezesAvailable>0?(this.state.freezesAvailable--,this.save(),T("â„ï¸ Streak freeze used!","success"),!0):!1},awardFreeze(){this.state.freezesAvailable=(this.state.freezesAvailable||0)+1,this.save(),T("â„ï¸ Streak freeze earned!","success")},renderCalendar(t){const e=document.getElementById(t);if(!e)return;const i=new Date,s=this.state.activeDates||[],r=[];for(let n=27;n>=0;n--){const a=new Date(i);a.setDate(a.getDate()-n);const o=a.toISOString().split("T")[0],l=s.includes(o),c=n===0;r.push(`
        <div class="calendar-day ${l?"active":""} ${c?"today":""}">
          ${a.getDate()}
        </div>
      `)}e.innerHTML=`
      <div class="streak-calendar">
        ${r.join("")}
      </div>
    `}};typeof window<"u"&&(window.StreakSystem=Ge);const bs={definitions:{welcome:{name:"First Steps",desc:"Started your DSA journey",icon:"ðŸ‘£",xp:10},first_viz:{name:"Visual Learner",desc:"Watched your first visualization",icon:"ðŸ‘ï¸",xp:20},sql_first:{name:"SQL Rookie",desc:"Completed first SQL challenge",icon:"ðŸ“Š",xp:30},streak_3:{name:"Getting Started",desc:"3-day streak",icon:"ðŸ”¥",xp:50},streak_7:{name:"Week Warrior",desc:"7-day streak",icon:"ðŸ”¥",xp:100},streak_30:{name:"Monthly Master",desc:"30-day streak",icon:"ðŸŒŸ",xp:500},explorer:{name:"Explorer",desc:"Visited all sections",icon:"ðŸ§­",xp:75},night_owl:{name:"Night Owl",desc:"Study after midnight",icon:"ðŸ¦‰",xp:25},early_bird:{name:"Early Bird",desc:"Study before 6 AM",icon:"ðŸ¦",xp:25},speed_demon:{name:"Speed Demon",desc:"Complete 5 challenges in 10 min",icon:"âš¡",xp:75},perfectionist:{name:"Perfectionist",desc:"10 correct answers in a row",icon:"âœ¨",xp:100},bronze_league:{name:"Bronze Badge",desc:"Reach Bronze league",icon:"ðŸ¥‰",xp:50},silver_league:{name:"Silver Badge",desc:"Reach Silver league",icon:"ðŸ¥ˆ",xp:100},gold_league:{name:"Gold Badge",desc:"Reach Gold league",icon:"ðŸ¥‡",xp:200},deep_diver:{name:"Deep Diver",desc:"Complete an interactive solution",icon:"ðŸ¤¿",xp:150},xp_1000:{name:"XP Hunter",desc:"Earn 1000 total XP",icon:"ðŸ’°",xp:100,secret:!0}},unlocked:new Set,init(){try{const t=localStorage.getItem("cse-helper-achievements");t&&(this.unlocked=new Set(JSON.parse(t)))}catch(t){console.warn("[AchievementSystem] Failed to load achievements:",t)}},save(){localStorage.setItem("cse-helper-achievements",JSON.stringify([...this.unlocked]))},unlock(t){if(this.unlocked.has(t))return!1;const e=this.definitions[t];return e?(this.unlocked.add(t),this.save(),Ge.addXP(e.xp),this.showPopup(e),Li.burst(window.innerWidth/2,150,60),!0):!1},showPopup(t){const e=document.createElement("div");e.className="achievement-popup",e.innerHTML=`
      <div class="achievement-icon">${t.icon}</div>
      <div class="achievement-info">
        <div class="achievement-title">Achievement Unlocked!</div>
        <div class="achievement-name">${t.name}</div>
        <div class="achievement-xp">+${t.xp} XP</div>
      </div>
    `,document.body.appendChild(e),O&&O.play&&O.play("toast_success"),setTimeout(()=>e.remove(),4e3)},checkTimeBasedAchievements(){const t=new Date().getHours();t>=0&&t<5&&this.unlock("night_owl"),t>=4&&t<6&&this.unlock("early_bird")},renderGallery(t){const e=document.getElementById(t);if(!e)return;const i=Object.entries(this.definitions).map(([s,r])=>{const n=this.unlocked.has(s),a=r.secret&&!n;return`
        <div class="achievement-tile ${n?"unlocked":"locked"} ${a?"secret":""}"
             data-achievement="${s}"
             title="${a?"Secret achievement":r.desc}">
          <div class="tile-icon">${r.icon}</div>
          <div class="tile-name">${a?"???":r.name}</div>
          <div class="tile-xp">+${r.xp} XP</div>
        </div>
      `}).join("");e.innerHTML=`
      <div class="achievement-gallery">
        ${i}
      </div>
    `}};typeof window<"u"&&(window.AchievementSystem=bs);const Mg={tiers:[{name:"Bronze",icon:"ðŸ¥‰",minXP:0,maxXP:500,color:"#cd7f32"},{name:"Silver",icon:"ðŸ¥ˆ",minXP:500,maxXP:1500,color:"#c0c0c0"},{name:"Gold",icon:"ðŸ¥‡",minXP:1500,maxXP:3500,color:"#ffd700"},{name:"Platinum",icon:"ðŸ’Ž",minXP:3500,maxXP:7e3,color:"#e5e4e2"},{name:"Diamond",icon:"ðŸ’ ",minXP:7e3,maxXP:15e3,color:"#b9f2ff"},{name:"Master",icon:"ðŸ‘‘",minXP:15e3,maxXP:3e4,color:"#9b59b6"},{name:"Legend",icon:"ðŸ†",minXP:3e4,maxXP:1/0,color:"#f1c40f"}],getCurrentTier(){const t=Ge.state.totalXP||0;return this.tiers.find(e=>t>=e.minXP&&t<e.maxXP)||this.tiers[0]},getProgress(){const t=Ge.state.totalXP||0,e=this.getCurrentTier();if(e.maxXP===1/0)return 100;const i=(t-e.minXP)/(e.maxXP-e.minXP)*100;return Math.min(100,Math.max(0,i))},getXPToNextTier(){const t=Ge.state.totalXP||0,e=this.getCurrentTier();return e.maxXP===1/0?0:e.maxXP-t},checkPromotion(t,e){const i=this.tiers.find(r=>t>=r.minXP&&t<r.maxXP),s=this.tiers.find(r=>e>=r.minXP&&e<r.maxXP);return i&&s&&s.minXP>i.minXP?(this.showPromotionPopup(s),Li.burst(window.innerWidth/2,window.innerHeight/2,100),!0):!1},showPromotionPopup(t){const e=document.createElement("div");e.className="achievement-popup",e.innerHTML=`
      <div class="achievement-icon" style="font-size: 3rem">${t.icon}</div>
      <div class="achievement-info">
        <div class="achievement-title">League Promotion!</div>
        <div class="achievement-name">${t.name} League</div>
        <div class="achievement-xp" style="color: ${t.color}">Keep going!</div>
      </div>
    `,e.style.background=`linear-gradient(135deg, ${t.color}88, ${t.color}44)`,document.body.appendChild(e),O&&O.play&&O.play("toast_success"),setTimeout(()=>e.remove(),4e3)},renderLeagueCard(t){const e=document.getElementById(t);if(!e)return;const i=this.getCurrentTier(),s=this.getProgress(),r=this.getXPToNextTier(),n=Ge.state.totalXP||0;e.innerHTML=`
      <div class="league-card league-tier-${i.name.toLowerCase()}" style="--tier-color: ${i.color}; position: relative;">
        <div class="league-header">
          <span class="league-icon">${i.icon}</span>
          <div>
            <div class="league-name">${i.name} League</div>
            <div style="font-size: 0.85rem; color: var(--text-muted)">${n.toLocaleString()} XP Total</div>
          </div>
        </div>
        <div class="league-progress">
          <div class="progress-bar">
            <div class="progress-fill" style="width: ${s}%; background: linear-gradient(90deg, ${i.color}, ${i.color}cc)"></div>
          </div>
          <div class="progress-text">
            <span>${s.toFixed(0)}% to next tier</span>
            <span>${r>0?r.toLocaleString()+" XP needed":"Max tier!"}</span>
          </div>
        </div>
      </div>
    `}};typeof window<"u"&&(window.XPLeagueSystem=Mg);const Wn={presets:{casual:{name:"Casual",icon:"â˜•",xpGoal:30,description:"1-2 activities"},regular:{name:"Regular",icon:"ðŸ“š",xpGoal:75,description:"3-4 activities"},serious:{name:"Serious",icon:"ðŸŽ¯",xpGoal:150,description:"5-7 activities"},intense:{name:"Intense",icon:"ðŸ”¥",xpGoal:300,description:"10+ activities"}},state:{selectedPreset:"regular",todayXP:0,lastDate:null,completedToday:!1},init(){this.load(),this.checkNewDay()},load(){try{const t=localStorage.getItem("cse-helper-daily-goals");t&&(this.state={...this.state,...JSON.parse(t)})}catch(t){console.warn("[DailyGoalsSystem] Failed to load goals:",t)}},save(){localStorage.setItem("cse-helper-daily-goals",JSON.stringify(this.state))},checkNewDay(){const t=new Date().toISOString().split("T")[0];this.state.lastDate!==t&&(this.state.todayXP=0,this.state.completedToday=!1,this.state.lastDate=t,this.save())},addProgress(t){this.checkNewDay(),this.state.todayXP+=t;const e=this.presets[this.state.selectedPreset];!this.state.completedToday&&this.state.todayXP>=e.xpGoal&&(this.state.completedToday=!0,this.celebrate()),this.save(),this.updateUI()},celebrate(){T("ðŸŽ‰ Daily goal complete!","success"),Li.burst(window.innerWidth/2,window.innerHeight/2,60),Ge.addXP(25,"Daily goal bonus")},setPreset(t){this.presets[t]&&(this.state.selectedPreset=t,this.save(),this.updateUI())},getProgress(){const t=this.presets[this.state.selectedPreset];return Math.min(100,this.state.todayXP/t.xpGoal*100)},updateUI(){document.getElementById("dailyGoalsWidget")&&this.render("dailyGoalsWidget")},render(t){const e=document.getElementById(t);if(!e)return;const i=this.presets[this.state.selectedPreset],s=this.getProgress(),r=this.state.completedToday;e.innerHTML=`
      <div class="daily-goals-card">
        <div class="daily-goal-header">
          <h4>ðŸŽ¯ Daily Goal</h4>
          <span style="font-size: 0.85rem; color: var(--text-muted)">${i.description}</span>
        </div>
        <div class="daily-goal-progress">
          <div class="daily-goal-bar">
            <div class="daily-goal-fill ${r?"complete":""}" style="width: ${s}%"></div>
          </div>
          <div class="daily-goal-text">
            <span>${this.state.todayXP} / ${i.xpGoal} XP</span>
            <span>${r?"âœ… Complete!":`${Math.ceil(i.xpGoal-this.state.todayXP)} XP to go`}</span>
          </div>
        </div>
        <div class="goal-presets">
          ${Object.entries(this.presets).map(([n,a])=>`
            <button class="goal-preset-btn ${n===this.state.selectedPreset?"active":""}"
                    onclick="DailyGoalsSystem.setPreset('${n}')">
              ${a.icon} ${a.name}
            </button>
          `).join("")}
        </div>
      </div>
    `}};typeof window<"u"&&(window.DailyGoalsSystem=Wn);const vS={simulatedPlayers:[{name:"AlgoAce",baseXP:200,icon:"ðŸ§‘â€ðŸ’»"},{name:"RecursiveRita",baseXP:150,icon:"ðŸ‘©â€ðŸŽ“"},{name:"DataDan",baseXP:300,icon:"ðŸ‘¨â€ðŸ’¼"},{name:"QueryQueen",baseXP:180,icon:"ðŸ‘©â€ðŸ’»"},{name:"StackSam",baseXP:100,icon:"ðŸ§‘â€ðŸŽ“"},{name:"TreeTina",baseXP:250,icon:"ðŸ‘©â€ðŸ”¬"},{name:"HashHenry",baseXP:140,icon:"ðŸ‘¨â€ðŸ”¬"}],getWeeklyLeaderboard(){const t=Math.floor(Date.now()/6048e5),e=this.simulatedPlayers.map(i=>({...i,xp:Math.floor(i.baseXP+Math.sin(t+i.name.length)*50+Math.random()*30),isUser:!1}));return e.push({name:"You",icon:"â­",xp:Ge.state.totalXP||0,isUser:!0}),e.sort((i,s)=>s.xp-i.xp).map((i,s)=>({...i,rank:s+1,zone:s<3?"promotion":s>=e.length-2?"demotion":"safe"}))},getRankEmoji(t){return{1:"ðŸ¥‡",2:"ðŸ¥ˆ",3:"ðŸ¥‰"}[t]||t},render(t){const e=document.getElementById(t);if(!e)return;const i=this.getWeeklyLeaderboard();e.innerHTML=`
      <div class="leaderboard-list">
        ${i.map(s=>`
          <div class="leaderboard-row ${s.zone} ${s.isUser?"is-user":""}">
            <span class="leaderboard-rank ${s.rank<=3?"top-three":""}">${this.getRankEmoji(s.rank)}</span>
            <span style="font-size: 1.25rem">${s.icon}</span>
            <span class="leaderboard-name">${s.name}</span>
            <span class="leaderboard-xp">${s.xp} XP</span>
          </div>
        `).join("")}
      </div>
    `}};typeof window<"u"&&(window.LeaderboardSystem=vS);const bS={currentType:"array",onApplyCallback:null,parse(t,e=this.currentType){switch(t=t.trim(),e){case"array":return this.parseArray(t);case"graph":return this.parseGraph(t);case"tree":return this.parseTree(t);default:return this.parseArray(t)}},parseArray(t){t=t.replace(/[\[\]{}]/g,"");const i=t.split(/[,\s]+/).filter(s=>s.length>0).map(s=>{const r=parseFloat(s);return isNaN(r)?s:r});return{type:"array",data:i,valid:i.length>0}},parseGraph(t){const e=[],i=new Set,s=t.split(/[,\n]+/).map(r=>r.trim()).filter(r=>r);for(const r of s){const n=r.match(/(\w+)\s*[-â†’>]+\s*(\w+)(?:\s*:\s*(\d+))?/);if(n){const a=n[1],o=n[2],l=n[3]?parseInt(n[3]):1;i.add(a),i.add(o),e.push({from:a,to:o,weight:l})}}return{type:"graph",nodes:Array.from(i),edges:e,valid:e.length>0}},parseTree(t){return this.parseArray(t)},generateRandom(t="array",e=10){if(t==="array"){const i=[];for(let s=0;s<e;s++)i.push(Math.floor(Math.random()*100)+1);return i}return[]},render(t,e={}){const i=document.getElementById(t);if(!i)return;const{onApply:s}=e;i.innerHTML=`
      <div class="custom-input-panel">
        <div class="custom-input-header">
          <h4>ðŸ“ Custom Input</h4>
          <div class="input-type-tabs">
            <button class="input-type-tab ${this.currentType==="array"?"active":""}" 
                    onclick="CustomInputParser.setType('array', '${t}')">Array</button>
            <button class="input-type-tab ${this.currentType==="graph"?"active":""}" 
                    onclick="CustomInputParser.setType('graph', '${t}')">Graph</button>
          </div>
        </div>
        <input type="text" 
               class="custom-input-field" 
               id="${t}Input"
               placeholder="${this.getPlaceholder()}"
               onkeypress="if(event.key==='Enter') CustomInputParser.apply('${t}')">
        <div class="input-presets">
          <button class="input-preset-btn" onclick="CustomInputParser.preset('random', '${t}')">ðŸŽ² Random</button>
          <button class="input-preset-btn" onclick="CustomInputParser.preset('sorted', '${t}')">ðŸ“ˆ Sorted</button>
          <button class="input-preset-btn" onclick="CustomInputParser.preset('reversed', '${t}')">ðŸ“‰ Reversed</button>
          <button class="input-preset-btn" onclick="CustomInputParser.preset('nearly', '${t}')">ã€°ï¸ Nearly Sorted</button>
        </div>
        <button class="apply-input-btn" onclick="CustomInputParser.apply('${t}')">
          Apply & Visualize
        </button>
      </div>
    `,this.onApplyCallback=s},getPlaceholder(){switch(this.currentType){case"array":return"e.g., 5, 2, 8, 1, 9 or [3, 1, 4, 1, 5]";case"graph":return"e.g., A->B, B->C, C->A or 1-2:5, 2-3:3";default:return"Enter values..."}},setType(t,e){this.currentType=t,this.render(e,{onApply:this.onApplyCallback})},preset(t,e){const i=document.getElementById(e+"Input");if(!i)return;let s;switch(t){case"random":s=this.generateRandom("array",8);break;case"sorted":s=[1,2,3,4,5,6,7,8];break;case"reversed":s=[8,7,6,5,4,3,2,1];break;case"nearly":s=[1,3,2,4,6,5,7,8];break;default:s=this.generateRandom("array",8)}i.value=s.join(", ")},apply(t){const e=document.getElementById(t+"Input");if(!e)return;const i=this.parse(e.value);i.valid&&this.onApplyCallback?(this.onApplyCallback(i),T("âœ… Input applied!","success"),Ge.addXP(5,"Custom input used")):T("âŒ Invalid input format","error")}};typeof window<"u"&&(window.CustomInputParser=bS);const wS={code:[],steps:[],currentStep:0,variables:{},isPlaying:!1,playInterval:null,containerId:null,init(t,e){this.code=t,this.steps=e,this.currentStep=0,this.variables={},this.isPlaying=!1},step(){var e;if(this.currentStep>=this.steps.length)return!1;const t=this.steps[this.currentStep];if(t.variables)for(const[i,s]of Object.entries(t.variables))this.variables[i]={value:s,changed:((e=this.variables[i])==null?void 0:e.value)!==s};return this.currentStep++,this.updateUI(),this.currentStep<this.steps.length},stepBack(){if(this.currentStep<=0)return!1;this.currentStep--,this.variables={};for(let t=0;t<this.currentStep;t++){const e=this.steps[t];if(e.variables)for(const[i,s]of Object.entries(e.variables))this.variables[i]={value:s,changed:!1}}return this.updateUI(),!0},play(){this.isPlaying=!0,this.playInterval=setInterval(()=>{this.step()||this.pause()},800),this.updateUI()},pause(){this.isPlaying=!1,this.playInterval&&(clearInterval(this.playInterval),this.playInterval=null),this.updateUI()},reset(){this.pause(),this.currentStep=0,this.variables={},this.updateUI()},updateUI(){this.containerId&&this.render(this.containerId)},render(t){this.containerId=t;const e=document.getElementById(t);if(!e)return;const i=this.steps[this.currentStep-1]||this.steps[0]||{},s=i.line||0;e.innerHTML=`
      <div class="code-tracer">
        <div class="tracer-header">
          <div class="tracer-title">
            <span>ðŸ”</span> Code Tracer
          </div>
          <div class="tracer-controls">
            <button class="tracer-btn" onclick="CodeTracer.stepBack()" ${this.currentStep<=0?"disabled":""}>â®ï¸</button>
            <button class="tracer-btn ${this.isPlaying?"active":""}" 
                    onclick="CodeTracer.${this.isPlaying?"pause":"play"}()">
              ${this.isPlaying?"â¸ï¸":"â–¶ï¸"}
            </button>
            <button class="tracer-btn" onclick="CodeTracer.step()" ${this.currentStep>=this.steps.length?"disabled":""}>â­ï¸</button>
            <button class="tracer-btn" onclick="CodeTracer.reset()">ðŸ”„</button>
          </div>
        </div>
        <div class="tracer-code">
          <div class="tracer-line-numbers">
            ${this.code.map((r,n)=>`<div>${n+1}</div>`).join("")}
          </div>
          <div class="tracer-code-content">
            ${this.code.map((r,n)=>`
              <div class="tracer-line ${n+1===s?"current":""} ${n+1<s?"executed":""}">
                ${yg(r)}
              </div>
            `).join("")}
          </div>
        </div>
        <div class="variable-watch">
          <div class="variable-watch-title">Variables</div>
          <div class="variable-list">
            ${Object.entries(this.variables).map(([r,{value:n,changed:a}])=>`
              <div class="variable-item">
                <span class="variable-name">${r}</span>
                <span>=</span>
                <span class="variable-value ${a?"changed":""}">${JSON.stringify(n)}</span>
              </div>
            `).join("")||'<span style="color: #858585">No variables yet</span>'}
          </div>
        </div>
      </div>
      <div class="step-indicator">
        <span class="step-counter">Step ${this.currentStep} / ${this.steps.length}</span>
        <span class="step-description">${i.description||"Click play to start"}</span>
      </div>
    `}};typeof window<"u"&&(window.CodeTracer=wS);const SS={algorithms:{bubble:{name:"Bubble Sort",best:"O(n)",avg:"O(nÂ²)",worst:"O(nÂ²)",space:"O(1)"},quick:{name:"Quick Sort",best:"O(n log n)",avg:"O(n log n)",worst:"O(nÂ²)",space:"O(log n)"},merge:{name:"Merge Sort",best:"O(n log n)",avg:"O(n log n)",worst:"O(n log n)",space:"O(n)"},heap:{name:"Heap Sort",best:"O(n log n)",avg:"O(n log n)",worst:"O(n log n)",space:"O(1)"},insertion:{name:"Insertion Sort",best:"O(n)",avg:"O(nÂ²)",worst:"O(nÂ²)",space:"O(1)"},selection:{name:"Selection Sort",best:"O(nÂ²)",avg:"O(nÂ²)",worst:"O(nÂ²)",space:"O(1)"},linear:{name:"Linear Search",best:"O(1)",avg:"O(n)",worst:"O(n)",space:"O(1)"},binary:{name:"Binary Search",best:"O(1)",avg:"O(log n)",worst:"O(log n)",space:"O(1)"},bfs:{name:"BFS",best:"O(V+E)",avg:"O(V+E)",worst:"O(V+E)",space:"O(V)"},dfs:{name:"DFS",best:"O(V+E)",avg:"O(V+E)",worst:"O(V+E)",space:"O(V)"}},getComplexityValue(t){return{"O(1)":10,"O(log n)":30,"O(n)":50,"O(n log n)":70,"O(nÂ²)":100,"O(V+E)":60}[t]||50},getComplexityColor(t){return{"O(1)":"#4ecdc4","O(log n)":"#45b7d1","O(n)":"#96ceb4","O(n log n)":"#ffeaa7","O(nÂ²)":"#ff6b6b","O(V+E)":"#a29bfe"}[t]||"#858585"},render(t,e=["bubble","quick","merge"]){const i=document.getElementById(t);if(!i)return;const s=e.map(r=>this.algorithms[r]).filter(Boolean);i.innerHTML=`
      <div class="complexity-chart">
        <div class="complexity-header">
          <h4 style="margin: 0">ðŸ“Š Complexity Comparison</h4>
        </div>
        <div class="complexity-bars">
          ${s.map(r=>`
            <div class="complexity-bar">
              <div class="complexity-bar-fill" style="height: ${this.getComplexityValue(r.avg)}%; background: ${this.getComplexityColor(r.avg)}"></div>
              <div class="complexity-bar-label">${r.name.split(" ")[0]}</div>
              <div class="complexity-bar-value">${r.avg}</div>
            </div>
          `).join("")}
        </div>
        <div class="complexity-details" style="margin-top: 1rem; font-size: 0.85rem;">
          ${s.map(r=>`
            <div style="display: flex; justify-content: space-between; padding: 0.25rem 0; border-bottom: 1px solid var(--border-color);">
              <span>${r.name}</span>
              <span>Best: ${r.best} | Worst: ${r.worst} | Space: ${r.space}</span>
            </div>
          `).join("")}
        </div>
      </div>
    `}};typeof window<"u"&&(window.ComplexityAnalyzer=SS);const xS={isActive:!1,currentLesson:null,currentStepIndex:0,lessons:{quicksort:{title:"Quick Sort Explained",steps:[{title:"Choose a Pivot",desc:"We select the last element as our pivot. This is the element we'll use to partition the array."},{title:"Partition",desc:"Move all elements smaller than pivot to the left, and larger to the right."},{title:"Recursively Sort",desc:"Apply the same process to the left and right subarrays."},{title:"Combine",desc:"The array is now sorted! Each partition placed elements in correct relative positions."}]},bfs:{title:"Breadth-First Search",steps:[{title:"Start Node",desc:"Begin at the source node and mark it as visited."},{title:"Queue Neighbors",desc:"Add all unvisited neighbors to a queue."},{title:"Process Queue",desc:"Dequeue the next node, mark as visited, queue its neighbors."},{title:"Repeat",desc:"Continue until queue is empty or target is found."}]},dfs:{title:"Depth-First Search",steps:[{title:"Start Node",desc:"Begin at the source node and mark it as visited."},{title:"Go Deep",desc:"Visit an unvisited neighbor and continue from there."},{title:"Backtrack",desc:"When stuck, go back to explore other branches."},{title:"Complete",desc:"Continue until all reachable nodes are visited."}]},mergesort:{title:"Merge Sort Explained",steps:[{title:"Divide",desc:"Split the array in half recursively until each piece has one element."},{title:"Conquer",desc:"Each single element is already sorted by definition."},{title:"Merge",desc:"Combine sorted halves by comparing elements and placing in order."},{title:"Complete",desc:"Continue merging until the entire array is sorted."}]}},start(t){if(this.currentLesson=this.lessons[t],!this.currentLesson){T("Lesson not found","error");return}this.currentStepIndex=0,this.isActive=!0,this.render(),Ge.addXP(10,"Started E-Lecture")},close(){this.isActive=!1;const t=document.getElementById("lectureOverlay");t&&t.classList.remove("active")},goToStep(t){this.currentStepIndex=t,this.render()},nextStep(){this.currentStepIndex<this.currentLesson.steps.length-1?(this.currentStepIndex++,this.render()):this.completeLesson()},prevStep(){this.currentStepIndex>0&&(this.currentStepIndex--,this.render())},completeLesson(){T("ðŸŽ“ Lesson complete!","success"),Li.burst(window.innerWidth/2,window.innerHeight/2,60),Ge.addXP(50,"Completed E-Lecture"),bs.unlock("first_viz"),this.close()},render(){let t=document.getElementById("lectureOverlay");t||(t=document.createElement("div"),t.id="lectureOverlay",t.className="lecture-mode-overlay",document.body.appendChild(t)),t.classList.add("active"),t.innerHTML=`
      <button class="lecture-close-btn" onclick="ELectureMode.close()">âœ•</button>
      <div class="lecture-container">
        <div class="lecture-visualization">
          <h2 style="margin-bottom: 1rem; color: var(--text-dark)">${this.currentLesson.title}</h2>
          <div style="flex: 1; display: flex; align-items: center; justify-content: center; font-size: 4rem;">
            ðŸ“Š
          </div>
          <div style="display: flex; justify-content: space-between; margin-top: 1rem">
            <button class="btn btn-secondary" onclick="ELectureMode.prevStep()" 
                    ${this.currentStepIndex===0?"disabled":""}>â† Previous</button>
            <button class="btn btn-primary" onclick="ELectureMode.nextStep()">
              ${this.currentStepIndex===this.currentLesson.steps.length-1?"Complete âœ“":"Next â†’"}
            </button>
          </div>
        </div>
        <div class="lecture-sidebar">
          <h3 style="margin-bottom: 1rem">Lesson Steps</h3>
          ${this.currentLesson.steps.map((e,i)=>`
            <div class="lecture-step-card ${i===this.currentStepIndex?"active":""} ${i<this.currentStepIndex?"completed":""}"
                 onclick="ELectureMode.goToStep(${i})">
              <div class="lecture-step-number">Step ${i+1}</div>
              <div class="lecture-step-title">${e.title}</div>
              <div class="lecture-step-desc">${e.desc}</div>
            </div>
          `).join("")}
        </div>
      </div>
    `}};typeof window<"u"&&(window.ELectureMode=xS);const H={algo:"quick",size:40,speed:10,data:[],steps:[],stepIndex:0,playing:!1,timer:null,stats:{comparisons:0,swaps:0},completionTimers:[]},qg={bubble:{name:"ðŸ«§ Bubble Sort",desc:'Like bubbles rising to the surface! The largest elements slowly "bubble up" to the end of the array by repeatedly swapping neighbors.',best:"O(n)",avg:"O(nÂ²)",worst:"O(nÂ²)"},insertion:{name:"ðŸ“¥ Insertion Sort",desc:"Like sorting playing cards in your hand. Pick up each card and insert it into its correct position among the cards you already sorted.",best:"O(n)",avg:"O(nÂ²)",worst:"O(nÂ²)"},selection:{name:"ðŸ‘† Selection Sort",desc:"Find the smallest item, put it first. Find the next smallest, put it second. Simple but not the fastest!",best:"O(nÂ²)",avg:"O(nÂ²)",worst:"O(nÂ²)"},quick:{name:"âš¡ Quick Sort",desc:'Imagine splitting a deck of cards: pick a "pivot" card, put smaller cards left, bigger cards right. Then repeat for each pile!',best:"O(n log n)",avg:"O(n log n)",worst:"O(nÂ²)"},merge:{name:"ðŸ”€ Merge Sort",desc:"Divide and conquer! Split the array in half repeatedly until each piece has one element, then merge them back together in order.",best:"O(n log n)",avg:"O(n log n)",worst:"O(n log n)"},heap:{name:"ðŸ”ï¸ Heap Sort",desc:'Build a special tree structure called a "heap" where parents are always bigger than children. Then extract elements one by one!',best:"O(n log n)",avg:"O(n log n)",worst:"O(n log n)"}},Oo={bubble:{js:`function bubbleSort(arr) {
  const n = arr.length;
  for (let i = 0; i < n; i++) {
    for (let j = 0; j < n - 1 - i; j++) {
      if (arr[j] > arr[j + 1]) {
        [arr[j], arr[j + 1]] = [arr[j + 1], arr[j]];
      }
    }
  }
  return arr;
}`,python:`def bubble_sort(arr):
    n = len(arr)
    for i in range(n):
        for j in range(n - 1 - i):
            if arr[j] > arr[j + 1]:
                arr[j], arr[j + 1] = arr[j + 1], arr[j]
    return arr`,java:`void bubbleSort(int[] arr) {
    int n = arr.length;
    for (int i = 0; i < n; i++) {
        for (int j = 0; j < n - 1 - i; j++) {
            if (arr[j] > arr[j + 1]) {
                int temp = arr[j];
                arr[j] = arr[j + 1];
                arr[j + 1] = temp;
            }
        }
    }
}`},quick:{js:`function quickSort(arr, lo = 0, hi = arr.length - 1) {
  if (lo < hi) {
    const p = partition(arr, lo, hi);
    quickSort(arr, lo, p - 1);
    quickSort(arr, p + 1, hi);
  }
  return arr;
}

function partition(arr, lo, hi) {
  const pivot = arr[hi];
  let i = lo - 1;
  for (let j = lo; j < hi; j++) {
    if (arr[j] < pivot) {
      i++;
      [arr[i], arr[j]] = [arr[j], arr[i]];
    }
  }
  [arr[i + 1], arr[hi]] = [arr[hi], arr[i + 1]];
  return i + 1;
}`,python:`def quick_sort(arr, lo=0, hi=None):
    if hi is None: hi = len(arr) - 1
    if lo < hi:
        p = partition(arr, lo, hi)
        quick_sort(arr, lo, p - 1)
        quick_sort(arr, p + 1, hi)
    return arr

def partition(arr, lo, hi):
    pivot = arr[hi]
    i = lo - 1
    for j in range(lo, hi):
        if arr[j] < pivot:
            i += 1
            arr[i], arr[j] = arr[j], arr[i]
    arr[i + 1], arr[hi] = arr[hi], arr[i + 1]
    return i + 1`,java:`void quickSort(int[] arr, int lo, int hi) {
    if (lo < hi) {
        int p = partition(arr, lo, hi);
        quickSort(arr, lo, p - 1);
        quickSort(arr, p + 1, hi);
    }
}

int partition(int[] arr, int lo, int hi) {
    int pivot = arr[hi];
    int i = lo - 1;
    for (int j = lo; j < hi; j++) {
        if (arr[j] < pivot) {
            i++;
            int temp = arr[i];
            arr[i] = arr[j];
            arr[j] = temp;
        }
    }
    int temp = arr[i + 1];
    arr[i + 1] = arr[hi];
    arr[hi] = temp;
    return i + 1;
}`},merge:{js:`function mergeSort(arr) {
  if (arr.length <= 1) return arr;
  const mid = Math.floor(arr.length / 2);
  const left = mergeSort(arr.slice(0, mid));
  const right = mergeSort(arr.slice(mid));
  return merge(left, right);
}

function merge(left, right) {
  const result = [];
  while (left.length && right.length) {
    result.push(left[0] <= right[0] ? left.shift() : right.shift());
  }
  return [...result, ...left, ...right];
}`,python:`def merge_sort(arr):
    if len(arr) <= 1: return arr
    mid = len(arr) // 2
    left = merge_sort(arr[:mid])
    right = merge_sort(arr[mid:])
    return merge(left, right)

def merge(left, right):
    result = []
    while left and right:
        result.append(left.pop(0) if left[0] <= right[0] else right.pop(0))
    return result + left + right`,java:`void mergeSort(int[] arr, int l, int r) {
    if (l < r) {
        int m = (l + r) / 2;
        mergeSort(arr, l, m);
        mergeSort(arr, m + 1, r);
        merge(arr, l, m, r);
    }
}`},insertion:{js:`function insertionSort(arr) {
  for (let i = 1; i < arr.length; i++) {
    let key = arr[i], j = i - 1;
    while (j >= 0 && arr[j] > key) {
      arr[j + 1] = arr[j];
      j--;
    }
    arr[j + 1] = key;
  }
  return arr;
}`,python:`def insertion_sort(arr):
    for i in range(1, len(arr)):
        key = arr[i]
        j = i - 1
        while j >= 0 and arr[j] > key:
            arr[j + 1] = arr[j]
            j -= 1
        arr[j + 1] = key
    return arr`,java:`void insertionSort(int[] arr) {
    for (int i = 1; i < arr.length; i++) {
        int key = arr[i], j = i - 1;
        while (j >= 0 && arr[j] > key) {
            arr[j + 1] = arr[j];
            j--;
        }
        arr[j + 1] = key;
    }
}`},selection:{js:`function selectionSort(arr) {
  for (let i = 0; i < arr.length - 1; i++) {
    let minIdx = i;
    for (let j = i + 1; j < arr.length; j++) {
      if (arr[j] < arr[minIdx]) minIdx = j;
    }
    [arr[i], arr[minIdx]] = [arr[minIdx], arr[i]];
  }
  return arr;
}`,python:`def selection_sort(arr):
    for i in range(len(arr) - 1):
        min_idx = i
        for j in range(i + 1, len(arr)):
            if arr[j] < arr[min_idx]:
                min_idx = j
        arr[i], arr[min_idx] = arr[min_idx], arr[i]
    return arr`,java:`void selectionSort(int[] arr) {
    for (int i = 0; i < arr.length - 1; i++) {
        int minIdx = i;
        for (int j = i + 1; j < arr.length; j++) {
            if (arr[j] < arr[minIdx]) {
                minIdx = j;
            }
        }
        int temp = arr[i];
        arr[i] = arr[minIdx];
        arr[minIdx] = temp;
    }
}`},heap:{js:`function heapSort(arr) {
  const n = arr.length;
  for (let i = Math.floor(n/2) - 1; i >= 0; i--) heapify(arr, n, i);
  for (let i = n - 1; i > 0; i--) {
    [arr[0], arr[i]] = [arr[i], arr[0]];
    heapify(arr, i, 0);
  }
  return arr;
}

function heapify(arr, n, i) {
  let largest = i, l = 2*i + 1, r = 2*i + 2;
  if (l < n && arr[l] > arr[largest]) largest = l;
  if (r < n && arr[r] > arr[largest]) largest = r;
  if (largest !== i) {
    [arr[i], arr[largest]] = [arr[largest], arr[i]];
    heapify(arr, n, largest);
  }
}`,python:`def heap_sort(arr):
    n = len(arr)
    for i in range(n // 2 - 1, -1, -1): heapify(arr, n, i)
    for i in range(n - 1, 0, -1):
        arr[0], arr[i] = arr[i], arr[0]
        heapify(arr, i, 0)
    return arr

def heapify(arr, n, i):
    largest, l, r = i, 2*i + 1, 2*i + 2
    if l < n and arr[l] > arr[largest]: largest = l
    if r < n and arr[r] > arr[largest]: largest = r
    if largest != i:
        arr[i], arr[largest] = arr[largest], arr[i]
        heapify(arr, n, largest)`,java:`void heapSort(int[] arr) {
    int n = arr.length;
    for (int i = n/2 - 1; i >= 0; i--) {
        heapify(arr, n, i);
    }
    for (int i = n - 1; i > 0; i--) {
        int temp = arr[0];
        arr[0] = arr[i];
        arr[i] = temp;
        heapify(arr, i, 0);
    }
}`}},sd={clearCompletionTimers(){H.completionTimers.forEach(e=>clearTimeout(e)),H.completionTimers=[];const t=document.getElementById("shimmerOverlay");t&&t.classList.remove("active")}};function rd(t,e=280){return Array.from({length:t},()=>Math.floor(Math.random()*e)+20)}function Dg(t,e="random"){switch(e){case"reversed":return Array.from({length:t},(a,o)=>20+(t-o-1)/(t-1)*260);case"nearly":const r=Array.from({length:t},(a,o)=>20+o/(t-1)*260);for(let a=0;a<Math.floor(t*.1);a++){const o=Math.floor(Math.random()*t),l=Math.floor(Math.random()*t);[r[o],r[l]]=[r[l],r[o]]}return r;case"few":const n=[50,100,150,200,250];return Array.from({length:t},()=>n[Math.floor(Math.random()*n.length)]);default:return rd(t,280)}}let Hc="js";function kS(){var e;const t=(e=document.getElementById("algorithmCode"))==null?void 0:e.textContent;t&&navigator.clipboard.writeText(t).then(()=>{T("ðŸ“‹ Code copied to clipboard!")}).catch(()=>{T("Failed to copy","error")})}function TS(t){Hc=t,document.querySelectorAll(".lang-btn, .lang-tab").forEach(i=>{i.dataset.lang===t?(i.style.background="var(--accent-forest, #3d6b5c)",i.style.color="white",i.style.border="none"):(i.style.background="transparent",i.style.color="rgba(255, 255, 255, 0.7)",i.style.border="1px solid rgba(255, 255, 255, 0.1)")});const e=document.getElementById("algorithmCodeLang");if(e){const i={js:"JavaScript",python:"Python",java:"Java"};e.textContent=i[t]||t}Bg(H.algo)}function Bg(t){const e=document.getElementById("algorithmCode");if(e&&Oo[t]&&Oo[t][Hc]){const i=e.querySelector("code")||e;i.textContent=Oo[t][Hc],i.style.color="#e4e4e4"}}typeof window<"u"&&(window.sortState=H,window.ALGO_INFO=qg,window.ALGO_CODE=Oo,window.SortEngine=sd,window.randomArray=rd,window.generatePresetArray=Dg,window.copyAlgorithmCode=kS,window.switchCodeLanguage=TS,window.updateAlgorithmCode=Bg);const B={algo:"bfs",size:20,speed:1,grid:null,steps:[],stepIndex:0,playing:!1,timer:null,completionTimers:[],allowDiagonal:!1,isDrawing:!1,drawMode:null,lastCell:-1},ES={bfs:{name:"ðŸŒŠ Breadth-First Search",desc:"Explores all neighbors at the current depth before moving deeper. Guarantees shortest path in unweighted graphs.",complexity:"O(V + E)",weighted:!1,optimal:!0},dfs:{name:"ðŸŒ² Depth-First Search",desc:"Explores as far as possible along each branch before backtracking. Does not guarantee shortest path.",complexity:"O(V + E)",weighted:!1,optimal:!1},dijkstra:{name:"âš¡ Dijkstra's Algorithm",desc:"Finds shortest path in weighted graphs by always expanding the lowest-cost node first.",complexity:"O((V + E) log V)",weighted:!0,optimal:!0},astar:{name:"â­ A* Search",desc:"Uses heuristics to guide search toward goal. Often faster than Dijkstra while still optimal.",complexity:"O(E)",weighted:!0,optimal:!0},greedy:{name:"ðŸŽ¯ Greedy Best-First",desc:"Always expands the node that appears closest to goal. Fast but not optimal.",complexity:"O(E)",weighted:!1,optimal:!1}},nd={clearCompletionTimers(){B.completionTimers.forEach(e=>clearTimeout(e)),B.completionTimers=[];const t=document.getElementById("pathShimmerOverlay");t&&t.classList.remove("active")}};function al(){const t=["0","1","2","3","4","5","6","7"],e={0:[1,2,3],1:[0,4,5],2:[0,6],3:[0,7],4:[1],5:[1],6:[2],7:[3]},i={...e},s=[{x:400,y:80,label:"0"},{x:200,y:200,label:"1"},{x:400,y:200,label:"2"},{x:600,y:200,label:"3"},{x:120,y:320,label:"4"},{x:280,y:320,label:"5"},{x:400,y:320,label:"6"},{x:600,y:320,label:"7"}];B.grid={isGraph:!0,nodes:t,adjacency:e,adjacencyBFS:e,adjacencyDFS:i,positions:s,start:0,end:7,walls:new Set},B.steps=[],B.stepIndex=0}function jg(){const t=["A","B","C","D","E"],e={0:[{node:1,weight:10},{node:2,weight:3}],1:[{node:0,weight:10},{node:2,weight:4},{node:3,weight:2}],2:[{node:0,weight:3},{node:1,weight:4},{node:4,weight:2}],3:[{node:1,weight:2},{node:4,weight:9}],4:[{node:2,weight:2},{node:3,weight:9}]},i=[{x:200,y:100,label:"A"},{x:500,y:100,label:"B"},{x:200,y:300,label:"C"},{x:500,y:300,label:"D"},{x:350,y:300,label:"E"}];B.grid={isGraph:!0,isWeighted:!0,nodes:t,weightedAdjacency:e,adjacency:null,positions:i,start:0,end:3,walls:new Set},B.steps=[],B.stepIndex=0}function Wg(){const t=["A","B","C","D","E","F","G"],e={0:[1,2,3],1:[0],2:[0,4,5],3:[0],4:[2],5:[2,6],6:[5]},i={0:40,1:32,2:25,3:35,4:19,5:17,6:0},s=[{x:350,y:80,label:"A"},{x:200,y:180,label:"B"},{x:350,y:180,label:"C"},{x:500,y:180,label:"D"},{x:280,y:280,label:"E"},{x:420,y:280,label:"F"},{x:420,y:380,label:"G"}];B.grid={isGraph:!0,hasHeuristics:!0,nodes:t,adjacency:e,heuristics:i,positions:s,start:0,end:6,walls:new Set},B.steps=[],B.stepIndex=0}function Fg(){const t=["S","A","B","C","D","G"],e={0:[{node:1,weight:1},{node:2,weight:4}],1:[{node:0,weight:1},{node:2,weight:2},{node:3,weight:5}],2:[{node:0,weight:4},{node:1,weight:2},{node:4,weight:1}],3:[{node:1,weight:5},{node:5,weight:2}],4:[{node:2,weight:1},{node:5,weight:3}],5:[{node:3,weight:2},{node:4,weight:3}]},i={0:[1,2],1:[0,2,3],2:[0,1,4],3:[1,5],4:[2,5],5:[3,4]},s={0:7,1:6,2:4,3:2,4:3,5:0},r=[{x:150,y:200,label:"S"},{x:300,y:100,label:"A"},{x:300,y:300,label:"B"},{x:450,y:100,label:"C"},{x:450,y:300,label:"D"},{x:550,y:200,label:"G"}];B.grid={isGraph:!0,isWeighted:!0,hasHeuristics:!0,nodes:t,adjacency:i,weightedAdjacency:e,heuristics:s,positions:r,start:0,end:5,walls:new Set},B.steps=[],B.stepIndex=0}function PS(t=8,e=10){var _;const i="abcdefghijklmnopqrstuvwxyz",s=[];for(let R=0;R<t;R++)s.push(i[R]);const r={};for(let R=0;R<t;R++)r[R]=[];const n=new Set([0]),a=new Set;for(let R=1;R<t;R++)a.add(R);for(;a.size>0;){const R=[...n],C=[...a],D=R[Math.floor(Math.random()*R.length)],q=C[Math.floor(Math.random()*C.length)];r[D].push(q),r[q].push(D),n.add(q),a.delete(q)}const o=t-1,l=t*(t-1)/2,c=Math.min(Math.max(e,o),l);let h=o;const d=100;let u=0;for(;h<c&&u<d;){const R=Math.floor(Math.random()*t),C=Math.floor(Math.random()*t);R!==C&&!r[R].includes(C)&&(r[R].push(C),r[C].push(R),h++),u++}const p=0,f=t-1,g=new Array(t).fill(-1),m=new Array(t).fill(0);g[0]=0;const y=[0],b={};for(;y.length>0;){const R=y.shift(),C=g[R];b[C]||(b[C]=[]),m[R]=b[C].length,b[C].push(R);const D=r[R]||[];for(const q of D)g[q]===-1&&(g[q]=C+1,y.push(q))}for(let R=0;R<t;R++)g[R]===-1&&(g[R]=3,b[3]||(b[3]=[]),m[R]=b[3].length,b[3].push(R));const w=[],k=100,x=700,E=60;for(let R=0;R<t;R++){const C=g[R],D=((_=b[C])==null?void 0:_.length)||1,q=x/(D+1);w.push({x:q*(m[R]+1)+50,y:E+C*k,label:s[R]})}B.grid={isGraph:!0,nodes:s,adjacency:r,adjacencyBFS:r,adjacencyDFS:r,positions:w,start:p,end:f,walls:new Set,nodeCount:t,edgeCount:h,isRandomGraph:!1},B.steps=[],B.stepIndex=0,B.playing=!1}function CS(t,e,i,s=!1){const r=[],n=Math.floor(t/e),a=t%e,o=[{dr:-1,dc:0},{dr:1,dc:0},{dr:0,dc:-1},{dr:0,dc:1}];s&&o.push({dr:-1,dc:-1},{dr:-1,dc:1},{dr:1,dc:-1},{dr:1,dc:1});for(const{dr:l,dc:c}of o){const h=n+l,d=a+c;h>=0&&h<i&&d>=0&&d<e&&r.push(h*e+d)}return r}function _S(t,e,i){const s=Math.floor(t/i),r=t%i,n=Math.floor(e/i),a=e%i;return Math.abs(s-n)+Math.abs(r-a)}function RS(t=!0){return t?{start:"#00E676",end:"#FF5252",wall:"#5C6360",path:"#FFEB3B",current:"#E040FB",frontier:"#40C4FF",visited:"#7C4DFF",empty:"#F5F5F5"}:{start:"#1E8F5E",end:"#D4513D",wall:"#4A4A4A",path:"#E5A825",current:"#9C4D7A",frontier:"#4A9BB8",visited:"rgba(74, 155, 184, 0.45)",empty:"#FFFFFF"}}typeof window<"u"&&(window.pathState=B,window.PATHFINDING_ALGOS=ES,window.PathEngine=nd,window.generateMaze=al,window.generateDijkstraGraph=jg,window.generateGreedyGraph=Wg,window.generateAStarGraph=Fg,window.getNeighbors=CS,window.manhattanDistance=_S,window.getPathfindingColors=RS);const Ce={algo:"binary",size:20,speed:10,data:[],target:null,steps:[],stepIndex:0,playing:!1,timer:null,completionTimers:[]},$S={linear:{name:"ðŸ” Linear Search",desc:"Check each element one by one from start to end. Simple but slow for large arrays.",best:"O(1)",avg:"O(n)",worst:"O(n)",requiresSorted:!1},binary:{name:"âš¡ Binary Search",desc:"Divide and conquer! Compare with middle element and eliminate half the array each step.",best:"O(1)",avg:"O(log n)",worst:"O(log n)",requiresSorted:!0},jump:{name:"ðŸ¦˜ Jump Search",desc:"Jump ahead by fixed steps, then linear search backward. Better than linear for large arrays.",best:"O(1)",avg:"O(âˆšn)",worst:"O(âˆšn)",requiresSorted:!0},interpolation:{name:"ðŸ“Š Interpolation Search",desc:"Like binary search but estimates position based on value. Great for uniformly distributed data.",best:"O(1)",avg:"O(log log n)",worst:"O(n)",requiresSorted:!0},exponential:{name:"ðŸ“ˆ Exponential Search",desc:"Find range by doubling, then binary search within. Good when target is near the beginning.",best:"O(1)",avg:"O(log n)",worst:"O(log n)",requiresSorted:!0}},IS={linear:{js:`function linearSearch(arr, target) {
  for (let i = 0; i < arr.length; i++) {
    if (arr[i] === target) return i;
  }
  return -1;
}`,python:`def linear_search(arr, target):
    for i, val in enumerate(arr):
        if val == target:
            return i
    return -1`},binary:{js:`function binarySearch(arr, target) {
  let lo = 0, hi = arr.length - 1;
  while (lo <= hi) {
    const mid = Math.floor((lo + hi) / 2);
    if (arr[mid] === target) return mid;
    if (arr[mid] < target) lo = mid + 1;
    else hi = mid - 1;
  }
  return -1;
}`,python:`def binary_search(arr, target):
    lo, hi = 0, len(arr) - 1
    while lo <= hi:
        mid = (lo + hi) // 2
        if arr[mid] == target: return mid
        if arr[mid] < target: lo = mid + 1
        else: hi = mid - 1
    return -1`},jump:{js:`function jumpSearch(arr, target) {
  const n = arr.length;
  const step = Math.floor(Math.sqrt(n));
  let prev = 0;
  
  while (arr[Math.min(step, n) - 1] < target) {
    prev = step;
    step += Math.floor(Math.sqrt(n));
    if (prev >= n) return -1;
  }
  
  while (arr[prev] < target) {
    prev++;
    if (prev === Math.min(step, n)) return -1;
  }
  
  return arr[prev] === target ? prev : -1;
}`,python:`import math

def jump_search(arr, target):
    n = len(arr)
    step = int(math.sqrt(n))
    prev = 0
    
    while arr[min(step, n) - 1] < target:
        prev = step
        step += int(math.sqrt(n))
        if prev >= n: return -1
    
    while arr[prev] < target:
        prev += 1
        if prev == min(step, n): return -1
    
    return prev if arr[prev] == target else -1`}},Fn={clearCompletionTimers(){Ce.completionTimers.forEach(t=>clearTimeout(t)),Ce.completionTimers=[]},generateSortedArray(t,e=100){const i=e/t;return Array.from({length:t},(s,r)=>Math.floor(r*i)+1)}};function QS(t=20){return Fn.generateSortedArray(t)}typeof window<"u"&&(window.searchState=Ce,window.SEARCH_ALGOS=$S,window.SEARCH_CODE=IS,window.SearchEngine=Fn,window.generateSearchArray=QS);let Ug=!1,Ya=null;async function AS(t={}){const{showWelcome:e=!0,skipLegacy:i=!1}=t;return Ya||(Ya=new Promise(s=>{console.log("%c[CSE Helper] Initializing application...","color: #2f6a57");try{O.init(),Ei.init(),console.log("  âœ“ Core systems initialized"),Ks.init(),console.log("  âœ“ UI components initialized"),Ge.init(),bs.init(),bs.checkTimeBasedAchievements(),Wn.init(),console.log("  âœ“ Gamification systems initialized"),e&&hi.init(),console.log("  âœ“ Onboarding initialized"),Ug=!0,console.log("%c[CSE Helper] Application ready!","color: #2f6a57; font-weight: bold"),s(!0)}catch(r){console.error("[CSE Helper] Initialization failed:",r),s(!1)}}),Ya)}function LS(){return Ug}function NS(){const t={AudioEngine:typeof(O==null?void 0:O.init)=="function",ThemeManager:typeof(Ei==null?void 0:Ei.init)=="function",CommandPalette:typeof(Ks==null?void 0:Ks.init)=="function",OnboardingSystem:typeof(hi==null?void 0:hi.init)=="function",StreakSystem:typeof(Ge==null?void 0:Ge.init)=="function",AchievementSystem:typeof(bs==null?void 0:bs.init)=="function",DailyGoalsSystem:typeof(Wn==null?void 0:Wn.init)=="function"},e=Object.values(t).every(i=>i);return console.log("%c[CSE Helper] Health Check:",e?"color: #4ecdc4":"color: #ff6b6b"),Object.entries(t).forEach(([i,s])=>{console.log(`  ${s?"âœ“":"âœ—"} ${i}`)}),{allPassed:e,checks:t}}typeof window<"u"&&(window.CSEHelper={initApp:AS,isModulesReady:LS,healthCheck:NS,version:"2.0.0-modular"});const MS={hints:{sorting:[{level:1,title:"Basic Concept",content:"Sorting arranges elements in a specific order (ascending or descending)."},{level:2,title:"Key Insight",content:"Compare adjacent elements and swap if they are in wrong order."},{level:3,title:"Optimization",content:"Track if any swaps occurred - if not, the array is already sorted!"}],quicksort:[{level:1,title:"Pivot Selection",content:"Choose a pivot element - commonly the last, first, or middle element."},{level:2,title:"Partitioning",content:"Move elements smaller than pivot to left, larger to right."},{level:3,title:"Recursion",content:"Apply the same process to left and right subarrays independently."}],mergesort:[{level:1,title:"Divide",content:"Split the array in half recursively until each piece has one element."},{level:2,title:"Conquer",content:"Each single element is already sorted by definition."},{level:3,title:"Merge",content:"Combine sorted halves by comparing elements and placing in order."}],bfs:[{level:1,title:"Queue Usage",content:"BFS uses a queue (FIFO) to process nodes level by level."},{level:2,title:"Visited Set",content:"Track visited nodes to avoid infinite loops in graphs with cycles."},{level:3,title:"Shortest Path",content:"BFS guarantees shortest path in unweighted graphs!"}],dfs:[{level:1,title:"Stack/Recursion",content:"DFS uses a stack (or recursion) to go deep before backtracking."},{level:2,title:"Visited Tracking",content:"Mark nodes as visited to avoid revisiting them."},{level:3,title:"Use Cases",content:"Great for maze solving, topological sorting, and detecting cycles!"}],binary_search:[{level:1,title:"Prerequisites",content:"Binary search only works on SORTED arrays."},{level:2,title:"Divide",content:"Compare with middle element to eliminate half the search space."},{level:3,title:"Efficiency",content:"O(log n) - each step halves the problem size!"}],dijkstra:[{level:1,title:"Priority Queue",content:"Always expand the node with lowest total distance first."},{level:2,title:"Relaxation",content:"Update distances when you find a shorter path."},{level:3,title:"Non-negative",content:"Dijkstra requires non-negative edge weights!"}]},currentLevel:0,getHint(t){const e=this.hints[t];return!e||this.currentLevel>=e.length?null:e[this.currentLevel]},revealNext(t){this.currentLevel++;const e=this.getHint(t);return e?(Ge.addXP(2,"Used hint"),e):null},reset(){this.currentLevel=0},render(t,e){var n;const i=document.getElementById(t);if(!i)return;const s=this.getHint(e),r=this.currentLevel<(((n=this.hints[e])==null?void 0:n.length)||0)-1;i.innerHTML=`
      <div class="hint-panel">
        <div class="hint-header">
          <span class="hint-title">${s?s.title:"No more hints"}</span>
          <span class="hint-level">Level ${this.currentLevel+1}</span>
        </div>
        <div class="hint-content">
          ${s?s.content:"You've seen all hints for this topic!"}
        </div>
        ${r?`
          <button class="hint-reveal-btn" onclick="SmartHintSystem.revealAndRender('${t}', '${e}')">
            ðŸ”® Reveal Next Hint (-2 XP)
          </button>
        `:""}
      </div>
    `},revealAndRender(t,e){this.revealNext(e),this.render(t,e)},getTopics(){return Object.keys(this.hints)},addHints(t,e){this.hints[t]=e}};typeof window<"u"&&(window.SmartHintSystem=MS);const ad={levels:["easy","medium","hard"],currentLevel:"medium",performance:{correct:0,incorrect:0,streak:0},_encouragementEngine:null,_aiAssistant:null,setEncouragementEngine(t){this._encouragementEngine=t},setAIAssistant(t){this._aiAssistant=t},setDifficulty(t){this.levels.includes(t)&&(this.currentLevel=t,this.updateUI(),T(`Difficulty set to ${t}`,"success"))},recordAnswer(t){t?(this.performance.correct++,this.performance.streak++,this.performance.streak>=5&&this.currentLevel!=="hard"&&this.autoAdjust("up")):(this.performance.incorrect++,this.performance.streak=0,this.performance.incorrect>=3&&this.currentLevel!=="easy"&&this.autoAdjust("down"))},autoAdjust(t){const e=this.levels.indexOf(this.currentLevel);t==="up"&&e<this.levels.length-1?(this.currentLevel=this.levels[e+1],this._encouragementEngine&&this._encouragementEngine.show("levelUp"),this.performance.incorrect=0):t==="down"&&e>0&&(this.currentLevel=this.levels[e-1],this._aiAssistant&&this._aiAssistant.showTip("Don't worry! I've adjusted the difficulty to help you practice."),this.performance.streak=0),this.updateUI()},getStats(){const t=this.performance.correct+this.performance.incorrect;return{...this.performance,total:t,accuracy:t>0?Math.round(this.performance.correct/t*100):0}},reset(){this.performance={correct:0,incorrect:0,streak:0},this.currentLevel="medium",this.updateUI()},updateUI(){document.querySelectorAll(".difficulty-btn").forEach(t=>{t.classList.toggle("active",t.dataset.level===this.currentLevel)})},render(t){const e=document.getElementById(t);e&&(e.innerHTML=`
      <div class="difficulty-selector">
        ${this.levels.map(i=>`
          <button class="difficulty-btn ${i} ${i===this.currentLevel?"active":""}"
                  data-level="${i}"
                  onclick="AdaptiveDifficulty.setDifficulty('${i}')">
            ${i==="easy"?"ðŸŒ±":i==="medium"?"ðŸŒ¿":"ðŸŒ³"} 
            ${i.charAt(0).toUpperCase()+i.slice(1)}
          </button>
        `).join("")}
      </div>
    `)}};typeof window<"u"&&(window.AdaptiveDifficulty=ad);const od={messages:{correct:[{emoji:"ðŸŽ‰",message:"Excellent!",sub:"You nailed it!"},{emoji:"â­",message:"Brilliant!",sub:"Keep up the great work!"},{emoji:"ðŸ”¥",message:"On Fire!",sub:"You're unstoppable!"},{emoji:"ðŸ’ª",message:"Strong!",sub:"That was perfect!"},{emoji:"ðŸš€",message:"Amazing!",sub:"You're soaring!"},{emoji:"âœ¨",message:"Superb!",sub:"You're crushing it!"},{emoji:"ðŸ…",message:"Champion!",sub:"That was flawless!"}],incorrect:[{emoji:"ðŸ’ª",message:"Keep Going!",sub:"Mistakes help us learn!"},{emoji:"ðŸŒŸ",message:"Almost!",sub:"You're getting closer!"},{emoji:"ðŸ§ ",message:"Think Again!",sub:"You've got this!"}],streak:[{emoji:"ðŸ”¥",message:"5 in a row!",sub:"You're on fire!"},{emoji:"âš¡",message:"Streak Master!",sub:"Nothing can stop you!"},{emoji:"ðŸ’Ž",message:"Unstoppable!",sub:"Your streak is legendary!"}],levelUp:[{emoji:"ðŸ“ˆ",message:"Level Up!",sub:"You've earned harder challenges!"},{emoji:"ðŸŽ¯",message:"Promoted!",sub:"Ready for the next level!"}],milestone:[{emoji:"ðŸ†",message:"Milestone!",sub:"You've come so far!"},{emoji:"ðŸŽŠ",message:"Achievement!",sub:"What an accomplishment!"}],completion:[{emoji:"ðŸŽ“",message:"Complete!",sub:"You've mastered this topic!"},{emoji:"ðŸ¥‡",message:"Finished!",sub:"Congratulations on completing!"}]},show(t="correct"){const e=this.messages[t]||this.messages.correct,i=e[Math.floor(Math.random()*e.length)];let s=document.getElementById("encouragementPopup");s||(s=document.createElement("div"),s.id="encouragementPopup",s.className="encouragement-popup",document.body.appendChild(s)),s.innerHTML=`
      <div class="encouragement-emoji">${i.emoji}</div>
      <div class="encouragement-message">${i.message}</div>
      <div class="encouragement-sub">${i.sub}</div>
    `,s.classList.add("show"),t!=="incorrect"&&Li.burst(window.innerWidth/2,window.innerHeight/2,40),setTimeout(()=>s.classList.remove("show"),2e3)},hide(){const t=document.getElementById("encouragementPopup");t&&t.classList.remove("show")},addMessages(t,e){this.messages[t]||(this.messages[t]=[]),this.messages[t].push(...e)}};typeof window<"u"&&(window.EncouragementEngine=od);const qS={paths:{sorting:{title:"Sorting Mastery",icon:"âš¡",modules:["Bubble Sort","Selection Sort","Insertion Sort","Merge Sort","Quick Sort","Heap Sort"],completed:0},searching:{title:"Search Expert",icon:"ðŸ”",modules:["Linear Search","Binary Search","Jump Search","Interpolation"],completed:0},graphs:{title:"Graph Navigator",icon:"ðŸ—ºï¸",modules:["BFS","DFS","Dijkstra","A* Algorithm"],completed:0},dataStructures:{title:"Data Structure Pro",icon:"ðŸ“š",modules:["Arrays","Linked Lists","Stacks","Queues","Trees","Hash Tables"],completed:0},sql:{title:"SQL Master",icon:"ðŸ—„ï¸",modules:["SELECT Basics","WHERE Clauses","JOINs","GROUP BY","Subqueries"],completed:0}},completeModule(t,e){const i=this.paths[t];i&&e<i.modules.length&&(i.completed=Math.max(i.completed,e+1),this.save(),i.completed===i.modules.length&&(od.show("milestone"),bs.unlock("explorer")))},getProgress(t){const e=this.paths[t];return e?{completed:e.completed,total:e.modules.length,percentage:Math.round(e.completed/e.modules.length*100)}:{completed:0,total:0,percentage:0}},getTotalProgress(){let t=0,e=0;for(const i of Object.values(this.paths))t+=i.completed,e+=i.modules.length;return{completed:t,total:e,percentage:e>0?Math.round(t/e*100):0}},save(){localStorage.setItem("cse-helper-learning-paths",JSON.stringify(this.paths))},load(){try{const t=localStorage.getItem("cse-helper-learning-paths");if(t){const e=JSON.parse(t);for(const[i,s]of Object.entries(e))this.paths[i]&&(this.paths[i].completed=s.completed||0)}}catch(t){console.warn("[LearningPathSystem] Failed to load paths:",t)}},reset(){for(const t of Object.values(this.paths))t.completed=0;this.save()},render(t,e){const i=document.getElementById(t);if(!i)return;const s=this.paths[e];if(!s)return;const r=s.completed/s.modules.length*100;i.innerHTML=`
      <div class="learning-path-card">
        <div class="path-header">
          <div class="path-icon">${s.icon}</div>
          <div>
            <div class="path-title">${s.title}</div>
            <div class="path-subtitle">${s.completed}/${s.modules.length} modules completed</div>
          </div>
        </div>
        <div class="path-progress">
          <div class="path-progress-bar">
            <div class="path-progress-fill" style="width: ${r}%"></div>
          </div>
        </div>
        <div class="path-modules">
          ${s.modules.map((n,a)=>`
            <span class="path-module ${a<s.completed?"completed":""} ${a===s.completed?"current":""}">
              ${n}
            </span>
          `).join("")}
        </div>
      </div>
    `},renderAll(t){const e=document.getElementById(t);e&&(e.innerHTML=Object.keys(this.paths).map(i=>{const s=this.paths[i],r=s.completed/s.modules.length*100;return`
        <div class="learning-path-card" onclick="LearningPathSystem.render('${t}', '${i}')">
          <div class="path-header">
            <div class="path-icon">${s.icon}</div>
            <div>
              <div class="path-title">${s.title}</div>
              <div class="path-subtitle">${s.completed}/${s.modules.length}</div>
            </div>
          </div>
          <div class="path-progress">
            <div class="path-progress-bar">
              <div class="path-progress-fill" style="width: ${r}%"></div>
            </div>
          </div>
        </div>
      `}).join(""))}};typeof window<"u"&&(window.LearningPathSystem=qS);const Vg={tips:["Try using Ctrl+K to quickly navigate!","Complete your daily goal for bonus XP!","Watch an E-Lecture to understand concepts better.","Stuck? Click the ðŸ’¡ hint button for help.","Keep your streak alive - come back tomorrow!","Practice makes perfect - try a quiz!","Visualize algorithms to understand them better.","Check the leaderboard to see how you rank!","Use the code sandbox to experiment freely.","Dark mode is easier on the eyes at night!"],contextualTips:{sorting:["Quick Sort is usually fastest in practice!","Merge Sort is stable and great for linked lists.","Use Heap Sort when you need guaranteed O(n log n)."],pathfinding:["BFS finds the shortest path in unweighted graphs!","A* is often faster than Dijkstra with a good heuristic.","DFS uses less memory than BFS."],sql:["Always start with SELECT * to explore data.","Use LIMIT to preview large tables.","JOINs combine data from multiple tables."]},showTip(t=null){let e=document.getElementById("aiAssistantBubble");e||(e=document.createElement("div"),e.id="aiAssistantBubble",e.className="ai-assistant-bubble",document.body.appendChild(e));const i=t||this.tips[Math.floor(Math.random()*this.tips.length)];e.innerHTML=`
      <button class="ai-bubble-close" onclick="AIAssistant.hide()">âœ•</button>
      <div class="ai-bubble-header">ðŸ¤– Study Buddy</div>
      <div class="ai-bubble-text">${i}</div>
    `,e.classList.add("show"),setTimeout(()=>this.hide(),8e3)},showContextualTip(t){const e=this.contextualTips[t];if(e&&e.length>0){const i=e[Math.floor(Math.random()*e.length)];this.showTip(i)}},hide(){const t=document.getElementById("aiAssistantBubble");t&&t.classList.remove("show")},showRandomTipAfterDelay(t=3e4,e=.7){setTimeout(()=>{Math.random()>1-e&&this.showTip()},t)},addTips(t){this.tips.push(...t)},addContextualTips(t,e){this.contextualTips[t]||(this.contextualTips[t]=[]),this.contextualTips[t].push(...e)}};typeof window<"u"&&(window.AIAssistant=Vg);const cr={problems:{},register(t){this.problems[t.id]=t},get(t){return this.problems[t]||null},getByCategory(t){return Object.values(this.problems).filter(e=>e.category===t)},getByDifficulty(t){return Object.values(this.problems).filter(e=>e.difficulty===t)},getByPattern(t){return Object.values(this.problems).filter(e=>e.patterns&&e.patterns.includes(t))},listAll(){return Object.values(this.problems)},listCategories(){const t=new Set;return Object.values(this.problems).forEach(e=>t.add(e.category)),Array.from(t)},count(){return Object.keys(this.problems).length}};cr.register({id:"twoSum",title:"Two Sum",category:"arrays",patterns:["hashMap"],difficulty:"easy",description:"Find two numbers that add up to target",initialState:{nums:[2,7,11,15],target:9},naiveSolution:{name:"Brute Force",complexity:{time:"O(nÂ²)",space:"O(1)"},code:`function twoSum(nums, target) {
  for (let i = 0; i < nums.length; i++) {
    for (let j = i + 1; j < nums.length; j++) {
      if (nums[i] + nums[j] === target) {
        return [i, j];
      }
    }
  }
  return [];
}`},optimalSolution:{name:"Hash Map",complexity:{time:"O(n)",space:"O(n)"},code:`function twoSum(nums, target) {
  const map = new Map();
  for (let i = 0; i < nums.length; i++) {
    const complement = target - nums[i];
    if (map.has(complement)) {
      return [map.get(complement), i];
    }
    map.set(nums[i], i);
  }
  return [];
}`},whyOptimal:"Hash map lookup is O(1), reducing overall complexity from O(nÂ²) to O(n)."});cr.register({id:"containsDuplicate",title:"Contains Duplicate",category:"arrays",patterns:["hashMap","sorting"],difficulty:"easy",description:"Check if array contains any duplicates",initialState:{nums:[1,2,3,1]},naiveSolution:{name:"Brute Force",complexity:{time:"O(nÂ²)",space:"O(1)"},code:`function containsDuplicate(nums) {
  for (let i = 0; i < nums.length; i++) {
    for (let j = i + 1; j < nums.length; j++) {
      if (nums[i] === nums[j]) return true;
    }
  }
  return false;
}`},optimalSolution:{name:"Hash Set",complexity:{time:"O(n)",space:"O(n)"},code:`function containsDuplicate(nums) {
  const seen = new Set();
  for (const num of nums) {
    if (seen.has(num)) return true;
    seen.add(num);
  }
  return false;
}`},whyOptimal:"Set lookup is O(1) vs O(n) linear scan in brute force."});cr.register({id:"binarySearch",title:"Binary Search",category:"arrays",patterns:["divideConquer"],difficulty:"easy",description:"Find target in sorted array",initialState:{nums:[1,3,5,7,9,11,13,15],target:9},naiveSolution:{name:"Linear Search",complexity:{time:"O(n)",space:"O(1)"},code:`function search(nums, target) {
  for (let i = 0; i < nums.length; i++) {
    if (nums[i] === target) return i;
  }
  return -1;
}`},optimalSolution:{name:"Binary Search",complexity:{time:"O(log n)",space:"O(1)"},code:`function search(nums, target) {
  let left = 0, right = nums.length - 1;
  while (left <= right) {
    const mid = Math.floor((left + right) / 2);
    if (nums[mid] === target) return mid;
    if (nums[mid] < target) left = mid + 1;
    else right = mid - 1;
  }
  return -1;
}`},whyOptimal:"Halving search space each step reduces O(n) to O(log n)."});cr.register({id:"validParentheses",title:"Valid Parentheses",category:"stacks",patterns:["stack"],difficulty:"easy",description:"Check if parentheses are balanced",initialState:{s:"([{}])"},naiveSolution:{name:"String Replace",complexity:{time:"O(nÂ²)",space:"O(n)"},code:`function isValid(s) {
  while (s.includes('()') || s.includes('{}') || s.includes('[]')) {
    s = s.replace('()', '').replace('{}', '').replace('[]', '');
  }
  return s.length === 0;
}`},optimalSolution:{name:"Stack",complexity:{time:"O(n)",space:"O(n)"},code:`function isValid(s) {
  const stack = [];
  const pairs = { ')': '(', '}': '{', ']': '[' };
  for (const c of s) {
    if ('({['.includes(c)) stack.push(c);
    else if (stack.pop() !== pairs[c]) return false;
  }
  return stack.length === 0;
}`},whyOptimal:"Single pass through string with O(1) stack operations."});cr.register({id:"reverseLinkedList",title:"Reverse Linked List",category:"linkedLists",patterns:["twoPointers"],difficulty:"easy",description:"Reverse a singly linked list",initialState:{list:[1,2,3,4,5]},naiveSolution:{name:"Array to List",complexity:{time:"O(n)",space:"O(n)"},code:`function reverseList(head) {
  const arr = [];
  while (head) { arr.push(head.val); head = head.next; }
  return buildList(arr.reverse());
}`},optimalSolution:{name:"Iterative",complexity:{time:"O(n)",space:"O(1)"},code:`function reverseList(head) {
  let prev = null, curr = head;
  while (curr) {
    const next = curr.next;
    curr.next = prev;
    prev = curr;
    curr = next;
  }
  return prev;
}`},whyOptimal:"In-place reversal uses O(1) space vs O(n) for array approach."});typeof window<"u"&&(window.ProblemLibrary=cr);const zg={state:{problem:null,currentApproach:"naive",currentStep:0,isPlaying:!1,isPaused:!1,speed:1,variables:{},steps:[],comparisonStats:{naiveOps:0,optimalOps:0}},availableSpeeds:[.25,.5,.75,1,1.5,2,3,4],timeout:null,narratorEnabled:!0,load(t){const e=cr.get(t);return e?(this.state={problem:e,currentApproach:"naive",currentStep:0,isPlaying:!1,isPaused:!1,speed:1,variables:JSON.parse(JSON.stringify(e.initialState)),steps:this.generateSteps(e,"naive"),comparisonStats:{naiveOps:0,optimalOps:0}},this.showContainer(),this.render(),T(`Loaded: ${e.title}`,"success"),!0):(T(`Problem not found: ${t}`,"error"),!1)},generateSteps(t,e){const{nums:i,target:s}=t.initialState,r=[];if(t.id==="twoSum")if(e==="naive"){r.push({codeLine:1,narration:`Starting Two Sum with array [${i.join(", ")}] and target ${s}`,vars:{nums:[...i],target:s},highlight:[],operation:"start"});for(let n=0;n<i.length;n++){r.push({codeLine:2,narration:`Outer loop: i=${n}, value=${i[n]}`,vars:{i:n},highlight:[n],operation:"loop"});for(let a=n+1;a<i.length;a++){const o=i[n]+i[a];if(r.push({codeLine:3,narration:`Comparing ${i[n]} + ${i[a]} = ${o} with target ${s}`,vars:{j:a,sum:o},highlight:[n,a],operation:"compare"}),o===s)return r.push({codeLine:4,narration:`Found! Indices [${n}, ${a}]`,vars:{result:[n,a]},highlight:[n,a],operation:"found",isSuccess:!0}),r}}}else{const n={};r.push({codeLine:2,narration:"Creating empty hash map",vars:{map:{}},highlight:[],operation:"init"});for(let a=0;a<i.length;a++){const o=s-i[a];if(r.push({codeLine:4,narration:`Index ${a}: value=${i[a]}, need complement=${o}`,vars:{i:a,complement:o},highlight:[a],operation:"calculate"}),n.hasOwnProperty(o))return r.push({codeLine:5,narration:`Found ${o} in map! Return [${n[o]}, ${a}]`,vars:{result:[n[o],a]},highlight:[n[o],a],operation:"found",isSuccess:!0}),r;n[i[a]]=a,r.push({codeLine:7,narration:`Storing ${i[a]} â†’ ${a} in map`,vars:{map:{...n}},highlight:[a],operation:"store"})}}else if(t.id==="binarySearch"){const n=t.initialState.nums,a=t.initialState.target;if(e==="naive"){r.push({codeLine:1,narration:`Linear search for ${a} in [${n.join(", ")}]`,vars:{target:a},highlight:[],operation:"start"});for(let o=0;o<n.length;o++)if(r.push({codeLine:2,narration:`Checking index ${o}: is ${n[o]} === ${a}?`,vars:{i:o},highlight:[o],operation:"compare"}),n[o]===a)return r.push({codeLine:3,narration:`Found ${a} at index ${o}!`,vars:{result:o},highlight:[o],operation:"found",isSuccess:!0}),r}else{let o=0,l=n.length-1;for(r.push({codeLine:2,narration:`Binary search: left=${o}, right=${l}`,vars:{left:o,right:l},highlight:[],operation:"init"});o<=l;){const c=Math.floor((o+l)/2);if(r.push({codeLine:4,narration:`mid=${c}, value=${n[c]}`,vars:{mid:c,value:n[c]},highlight:[c],operation:"calculate"}),n[c]===a)return r.push({codeLine:5,narration:`Found ${a} at index ${c}!`,vars:{result:c},highlight:[c],operation:"found",isSuccess:!0}),r;n[c]<a?(r.push({codeLine:6,narration:`${n[c]} < ${a}, search right half`,vars:{left:c+1},highlight:[],operation:"narrow"}),o=c+1):(r.push({codeLine:7,narration:`${n[c]} > ${a}, search left half`,vars:{right:c-1},highlight:[],operation:"narrow"}),l=c-1)}}}return r},setApproach(t){this.pause(),this.state.currentApproach=t,this.state.currentStep=0,this.state.variables=JSON.parse(JSON.stringify(this.state.problem.initialState)),this.state.steps=this.generateSteps(this.state.problem,t),this.render()},play(){this.state.steps.length&&(this.state.isPlaying=!0,this.state.isPaused=!1,this.executeStep(this.state.currentStep))},pause(){this.state.isPlaying=!1,this.state.isPaused=!0,this.timeout&&clearTimeout(this.timeout)},togglePlay(){this.state.isPlaying?this.pause():this.play(),this.updateControls()},next(){this.pause(),this.state.currentStep<this.state.steps.length-1&&(this.state.currentStep++,this.renderStep(this.state.currentStep))},prev(){this.pause(),this.state.currentStep>0&&(this.state.currentStep--,this.renderStep(this.state.currentStep))},first(){this.pause(),this.state.currentStep=0,this.renderStep(0)},last(){this.pause(),this.state.currentStep=this.state.steps.length-1,this.renderStep(this.state.currentStep)},setSpeed(t){this.state.speed=Math.max(.25,Math.min(4,t)),this.updateSpeedDisplay()},executeStep(t){if(t>=this.state.steps.length){this.state.isPlaying=!1,T("Walkthrough complete!","success");return}if(this.state.currentStep=t,this.renderStep(t),this.state.isPlaying){const e=2e3/this.state.speed;this.timeout=setTimeout(()=>{this.executeStep(t+1)},e)}},renderStep(t){const e=this.state.steps[t];if(!e)return;const i=document.getElementById("walkthroughNarration");i&&(i.textContent=e.narration),this.narrate(e.narration),this.highlightCodeLine(e.codeLine),Object.assign(this.state.variables,e.vars||{}),this.renderVariables(),this.renderVisualization(e),this.updateProgress()},highlightCodeLine(t){document.querySelectorAll(".wt-code-line").forEach((i,s)=>{i.classList.remove("active","executed"),s<t&&i.classList.add("executed"),s===t&&i.classList.add("active")})},renderVariables(){const t=document.getElementById("walkthroughVars");if(!t)return;const e=Object.entries(this.state.variables);t.innerHTML=e.map(([i,s])=>`
      <div class="wt-var-item">
        <span class="wt-var-name">${i}</span>
        <span class="wt-var-value">${JSON.stringify(s)}</span>
      </div>
    `).join("")},renderVisualization(t){const e=document.getElementById("walkthroughViz");if(!e)return;const i=this.state.problem.initialState.nums,s=t.highlight||[];e.innerHTML=`
      <div class="wt-array-viz">
        ${i.map((r,n)=>`
          <div class="wt-array-cell ${s.includes(n)?"highlighted":""} ${t.isSuccess&&s.includes(n)?"success":""}">
            <span class="wt-cell-idx">${n}</span>
            <span class="wt-cell-val">${r}</span>
          </div>
        `).join("")}
      </div>
      ${this.state.variables.map?`
        <div class="wt-map-viz">
          <span class="wt-map-label">HashMap:</span>
          ${Object.entries(this.state.variables.map).map(([r,n])=>`<span class="wt-map-entry">${r}â†’${n}</span>`).join("")}
        </div>
      `:""}
    `},updateProgress(){const t=document.getElementById("walkthroughProgress");t&&(t.textContent=`Step ${this.state.currentStep+1} / ${this.state.steps.length}`)},updateSpeedDisplay(){const t=document.getElementById("walkthroughSpeedLabel");t&&(t.textContent=`${this.state.speed}x`)},updateControls(){const t=document.getElementById("walkthroughPlayBtn");t&&(t.textContent=this.state.isPlaying?"â¸ï¸":"â–¶ï¸")},showContainer(){const t=document.getElementById("problemWalkthroughContainer");t&&(t.style.display="block")},close(){this.pause();const t=document.getElementById("problemWalkthroughContainer");t&&(t.style.display="none")},highlightSyntax(t){const e=["function","const","let","var","if","else","for","while","return","new","true","false"];return t.replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/(\/\/.*$)/gm,'<span style="color:#6c7086;font-style:italic">$1</span>').replace(/(".*?"|'.*?'|`.*?`)/g,'<span style="color:#a6e3a1">$1</span>').replace(/\b(\d+)\b/g,'<span style="color:#fab387">$1</span>').replace(new RegExp(`\\b(${e.join("|")})\\b`,"g"),'<span style="color:#cba6f7;font-weight:600">$1</span>')},narrate(t){if(!(!this.narratorEnabled||!t)&&"speechSynthesis"in window){speechSynthesis.cancel();const e=new SpeechSynthesisUtterance(t);e.rate=Math.min(this.state.speed,2),e.pitch=1,speechSynthesis.speak(e)}},toggleNarration(){this.narratorEnabled=!this.narratorEnabled,T(this.narratorEnabled?"ðŸ”Š Narration ON":"ðŸ”‡ Narration OFF","info")},countOperations(){return this.state.steps.filter(t=>t.operation==="compare"||t.operation==="calculate").length},getComparisonStats(){const t=this.state.problem;if(!t)return null;const e=this.generateSteps(t,"naive"),i=this.generateSteps(t,"optimal");return{naiveOps:e.filter(s=>s.operation==="compare"||s.operation==="calculate").length,optimalOps:i.filter(s=>s.operation==="compare"||s.operation==="calculate").length,speedup:(e.length/i.length).toFixed(1)}},render(){const t=document.getElementById("problemWalkthroughContainer");if(!t||!this.state.problem)return;const e=this.state.problem,i=this.state.currentApproach,s=i==="naive"?e.naiveSolution:e.optimalSolution,n=s.code.split(`
`);t.innerHTML=`
      <div class="walkthrough-panel">
        <div class="wt-header">
          <h2>${e.title}</h2>
          <div class="wt-approach-toggle">
            <button class="wt-approach-btn ${i==="naive"?"active":""}" onclick="ProblemWalkthroughEngine.setApproach('naive')">
              ðŸ¢ ${e.naiveSolution.name} (${e.naiveSolution.complexity.time})
            </button>
            <button class="wt-approach-btn ${i==="optimal"?"active":""}" onclick="ProblemWalkthroughEngine.setApproach('optimal')">
              ðŸš€ ${e.optimalSolution.name} (${e.optimalSolution.complexity.time})
            </button>
          </div>
          <button class="wt-close-btn" onclick="ProblemWalkthroughEngine.close()">Ã—</button>
        </div>

        <div class="wt-main">
          <div class="wt-code-panel">
            <div class="wt-code-header">${s.name} Solution</div>
            <div class="wt-code-body">
              ${n.map((a,o)=>`
                <div class="wt-code-line" data-line="${o}">
                  <span class="wt-line-num">${o+1}</span>
                  <span class="wt-line-content">${this.highlightSyntax(a)}</span>
                </div>
              `).join("")}
            </div>
          </div>

          <div class="wt-viz-panel" id="walkthroughViz">
            <div class="wt-array-viz">
              ${e.initialState.nums.map((a,o)=>`
                <div class="wt-array-cell"><span class="wt-cell-idx">${o}</span><span class="wt-cell-val">${a}</span></div>
              `).join("")}
            </div>
          </div>

          <div class="wt-vars-panel">
            <div class="wt-vars-header">ðŸ” Variables</div>
            <div id="walkthroughVars" class="wt-vars-list"></div>
          </div>
        </div>

        <div class="wt-narration" id="walkthroughNarration">
          Click play to start the walkthrough...
        </div>

        <div class="wt-controls">
          <button onclick="ProblemWalkthroughEngine.first()">â®</button>
          <button onclick="ProblemWalkthroughEngine.prev()">âª</button>
          <button id="walkthroughPlayBtn" onclick="ProblemWalkthroughEngine.togglePlay()">â–¶ï¸</button>
          <button onclick="ProblemWalkthroughEngine.next()">â©</button>
          <button onclick="ProblemWalkthroughEngine.last()">â­</button>
          <span id="walkthroughProgress">Step 1 / ${this.state.steps.length}</span>
          <span>ðŸ¢</span>
          <input type="range" min="0" max="7" value="3" onchange="ProblemWalkthroughEngine.setSpeed(ProblemWalkthroughEngine.availableSpeeds[this.value])">
          <span>ðŸ‡</span>
          <span id="walkthroughSpeedLabel">1x</span>
        </div>

        <div class="wt-why-optimal">
          <strong>ðŸ’¡ Why ${e.optimalSolution.name}?</strong> ${e.whyOptimal}
        </div>
      </div>
    `,this.renderVariables()},handleKeyboard(t){if(t.target.tagName==="INPUT"||t.target.tagName==="TEXTAREA")return;const e=document.getElementById("problemWalkthroughContainer");if(!(!e||e.style.display==="none"))switch(t.key){case" ":t.preventDefault(),this.togglePlay();break;case"Escape":this.close();break;case"ArrowLeft":this.prev();break;case"ArrowRight":this.next();break;case"Home":this.first();break;case"End":this.last();break;case"1":this.setApproach("naive");break;case"2":this.setApproach("optimal");break;case"m":case"M":this.toggleNarration();break}}};typeof document<"u"&&document.addEventListener("keydown",t=>zg.handleKeyboard(t));typeof window<"u"&&(window.ProblemWalkthroughEngine=zg);const DS={problems:{"two-sum":{title:"Two Sum",difficulty:"Easy",category:"ðŸ—ƒï¸ Hash Map",description:"Given an array of integers nums and a target, return indices of two numbers that add up to target.",steps:[{title:"Understanding the Problem",narration:"We need to find two numbers in the array that add up to our target sum. The brute force approach would check every pair, but that would be O of n squared.",code:`// Input: nums = [2, 7, 11, 15], target = 9
// Output: [0, 1] because nums[0] + nums[1] = 9`},{title:"The Hash Map Insight",narration:"Heres the key insight: as we scan the array, for each number x, we need to find target minus x. A hash map lets us check this in O of 1 time!",code:`// For target = 9 and nums[0] = 2
// We need: 9 - 2 = 7
// Is 7 in our map? Check instantly!`},{title:"Building the Solution",narration:"We iterate through the array once. For each number, check if the complement exists in our map. If yes, we found our answer. If no, add the current number to the map.",code:`function twoSum(nums, target) {
  const map = new Map();
  for (let i = 0; i < nums.length; i++) {
    const complement = target - nums[i];
    if (map.has(complement)) {
      return [map.get(complement), i];
    }
    map.set(nums[i], i);
  }
}`},{title:"Complexity Analysis",narration:"Time complexity is O of n because we traverse the array once. Space complexity is O of n for the hash map. Much better than O of n squared brute force!",code:`// Time: O(n) - single pass
// Space: O(n) - hash map storage`}]},"valid-parentheses":{title:"Valid Parentheses",difficulty:"Easy",category:"ðŸ“š Stack",description:"Given a string containing brackets, determine if the input string is valid.",steps:[{title:"Understanding Validity",narration:"A valid string has every opening bracket closed by the same type in the correct order. Think of it like nesting: the most recent opening bracket must close first.",code:`// Valid: "([]){}" âœ“
// Invalid: "([)]" âœ— - wrong order
// Invalid: "(((" âœ— - not closed`},{title:"Stack Intuition",narration:"A stack is perfect here! Push opening brackets. When we see a closing bracket, pop and check if it matches. If they dont match, or stack is empty when we need to pop, its invalid.",code:`// For input "[()]"
// See "[" -> push
// See "(" -> push  Stack: ["[", "("]
// See ")" -> pop, matches "(" âœ“
// See "]" -> pop, matches "[" âœ“`},{title:"Implementation",narration:"We use a map for bracket pairs. Iterate through the string, pushing opening brackets and checking closing ones against the top of stack.",code:`function isValid(s) {
  const stack = [];
  const pairs = {"(": ")", "[": "]", "{": "}"};
  
  for (const char of s) {
    if (pairs[char]) {
      stack.push(char);
    } else {
      if (pairs[stack.pop()] !== char) {
        return false;
      }
    }
  }
  return stack.length === 0;
}`},{title:"Complexity",narration:"Time is O of n, we visit each character once. Space is O of n in worst case, like all opening brackets.",code:`// Time: O(n)
// Space: O(n)`}]},"climbing-stairs":{title:"Climbing Stairs",difficulty:"Easy",category:"ðŸ§® Dynamic Programming",description:"You can climb 1 or 2 steps at a time. How many distinct ways to reach step n?",steps:[{title:"Recognizing the Pattern",narration:"This is the classic Fibonacci problem in disguise! To reach step n, you either came from step n minus 1 or step n minus 2.",code:`// n=1: 1 way (1)
// n=2: 2 ways (1+1, 2)
// n=3: 3 ways (1+1+1, 1+2, 2+1)
// n=4: 5 ways
// See the pattern? 1, 2, 3, 5, 8...`},{title:"The Recurrence",narration:"Ways to reach step n equals ways to step n minus 1 plus ways to step n minus 2. This is exactly the Fibonacci formula!",code:`// f(n) = f(n-1) + f(n-2)
// Base cases:
// f(1) = 1
// f(2) = 2`},{title:"DP Solution",narration:"Instead of recursive calls which would be exponential, we build up from the base cases. We only need two previous values.",code:`function climbStairs(n) {
  if (n <= 2) return n;
  let prev1 = 1, prev2 = 2;
  for (let i = 3; i <= n; i++) {
    const current = prev1 + prev2;
    prev1 = prev2;
    prev2 = current;
  }
  return prev2;
}`},{title:"Optimal Complexity",narration:"Time is O of n, space is O of 1 since we only store two variables. Much better than the O of 2 to the n recursive approach!",code:`// Time: O(n)
// Space: O(1)`}]},"binary-search":{title:"Binary Search",difficulty:"Easy",category:"ðŸ” Searching",description:"Search for a target in a sorted array. Return index or -1.",steps:[{title:"The Power of Sorted Arrays",narration:"Binary search is one of the most important algorithms. With a sorted array, we can eliminate half the search space with each comparison.",code:`// Linear Search: Check EVERY element O(n)
// Binary Search: Eliminate HALF each time O(log n)
// For n=1000000: 1000000 vs 20 comparisons!`},{title:"How It Works",narration:"Look at the middle element. If its our target, done! If target is smaller, search left half. If larger, search right half. Repeat.",code:`// arr = [1, 3, 5, 7, 9, 11], target = 7
// mid = arr[2] = 5  ->  7 > 5, go right
// mid = arr[4] = 9  ->  7 < 9, go left
// mid = arr[3] = 7  ->  Found!`},{title:"Implementation",narration:"We maintain left and right pointers. Calculate mid, compare, and adjust pointers. Very important: use left plus right minus left divided by 2 to avoid overflow.",code:`function binarySearch(nums, target) {
  let left = 0, right = nums.length - 1;
  
  while (left <= right) {
    const mid = left + Math.floor((right-left)/2);
    if (nums[mid] === target) return mid;
    if (nums[mid] < target) left = mid + 1;
    else right = mid - 1;
  }
  return -1;
}`},{title:"Logarithmic Magic",narration:"Time is O of log n because we halve the search space each iteration. Space is O of 1. This is why binary search is so powerful!",code:`// Time: O(log n)
// Space: O(1)`}]}},currentProblem:null,currentStep:0,start(t){const e=this.problems[t];if(!e){window.showToast&&window.showToast("Problem not found","error");return}this.currentProblem=e,this.currentStep=0,this.showUI(),this.showStep(0)},showUI(){let t=document.getElementById("problemWalkthroughModal");t||(t=document.createElement("div"),t.id="problemWalkthroughModal",t.className="problem-walkthrough-modal",document.body.appendChild(t)),t.innerHTML=`
      <div class="problem-walkthrough-content">
        <div class="problem-header">
          <div class="problem-title-section">
            <h2>${this.currentProblem.title}</h2>
            <span class="problem-difficulty ${this.currentProblem.difficulty.toLowerCase()}">${this.currentProblem.difficulty}</span>
            <span class="problem-category">${this.currentProblem.category}</span>
          </div>
          <button class="modal-close" onclick="ProblemNarration.close()">âœ•</button>
        </div>
        
        <div class="problem-description">${this.currentProblem.description}</div>
        
        <div class="step-container" id="problemStepContainer"></div>
        
        <div class="walkthrough-controls">
          <button class="btn btn-secondary" onclick="ProblemNarration.prevStep()" id="problemPrevBtn" disabled>
            â®ï¸ Previous
          </button>
          <div class="step-progress">
            <span id="problemStepProgress">Step 1 of ${this.currentProblem.steps.length}</span>
          </div>
          <button class="btn btn-primary" onclick="ProblemNarration.nextStep()" id="problemNextBtn">
            Next â­ï¸
          </button>
        </div>
        
        <div class="narration-controls">
          <button class="btn btn-accent" onclick="ProblemNarration.narrateStep()" id="narrateBtn">
            ðŸŽ¤ Narrate
          </button>
        </div>
      </div>
    `,t.classList.add("active")},showStep(t){const e=this.currentProblem.steps[t],i=document.getElementById("problemStepContainer");i.innerHTML=`
      <div class="step-title">${e.title}</div>
      <div class="step-narration">${e.narration}</div>
      <pre class="step-code"><code>${this.escapeHtml(e.code)}</code></pre>
    `,document.getElementById("problemStepProgress").textContent=`Step ${t+1} of ${this.currentProblem.steps.length}`,document.getElementById("problemPrevBtn").disabled=t===0,document.getElementById("problemNextBtn").disabled=t>=this.currentProblem.steps.length-1},nextStep(){this.currentStep<this.currentProblem.steps.length-1&&(this.currentStep++,this.showStep(this.currentStep))},prevStep(){this.currentStep>0&&(this.currentStep--,this.showStep(this.currentStep))},narrateStep(){var e;const t=this.currentProblem.steps[this.currentStep];if((e=window.ELectureNarrator)!=null&&e.speak)window.ELectureNarrator.speak(t.narration);else{const i=new SpeechSynthesisUtterance(t.narration);i.rate=.9,speechSynthesis.speak(i)}},close(){const t=document.getElementById("problemWalkthroughModal");t&&t.classList.remove("active"),speechSynthesis.cancel()},escapeHtml(t){const e=document.createElement("div");return e.textContent=t,e.innerHTML},getAll(){return Object.entries(this.problems).map(([t,e])=>({id:t,...e}))}};typeof window<"u"&&(window.ProblemNarration=DS);const ol={approaches:new Map,register(t){this.approaches.set(t.id,t)},get(t){return this.approaches.get(t)},getForLecture(t){return Array.from(this.approaches.values()).filter(e=>e.lectureId===t)},renderApproach(t){const e=this.get(t);return e?`
      <div class="naive-approach">
        <div class="naive-header">
          <span class="naive-icon">âš ï¸</span>
          <h3>${e.title}</h3>
          <span class="complexity-badge bad">${e.naiveComplexity}</span>
        </div>
        
        <div class="naive-intro">
          <p>${e.intro}</p>
        </div>
        
        <div class="naive-code">
          <div class="code-label">The Obvious Approach:</div>
          <pre><code>${e.naiveCode}</code></pre>
        </div>
        
        <div class="naive-problem">
          <div class="problem-label">âŒ Why It Fails:</div>
          <p>${e.whyFails}</p>
        </div>
        
        <div class="scale-comparison">
          <div class="scale-label">At Scale:</div>
          <div class="scale-bars">
            ${e.scaleDemo.map(i=>`
              <div class="scale-item">
                <span class="n-label">n = ${i.n.toLocaleString()}</span>
                <div class="bar-container">
                  <div class="bar naive" style="width: ${Math.min(100,i.naiveOps/e.scaleDemo[e.scaleDemo.length-1].naiveOps*100)}%">
                    ${i.naiveOps.toLocaleString()} ops
                  </div>
                </div>
              </div>
            `).join("")}
          </div>
        </div>
        
        <div class="naive-transition">
          <p>ðŸ’¡ ${e.transition}</p>
        </div>
      </div>
    `:""},playApproach(t){var i;const e=this.get(t);e&&(i=window.ELectureNarrator)!=null&&i.speak&&window.ELectureNarrator.speak(e.narration)}};ol.register({id:"two-sum-naive",lectureId:"two-sum-sorted",title:"The Brute Force Trap",naiveComplexity:"O(nÂ²)",optimalComplexity:"O(n)",intro:"When you first see this problem, the obvious solution jumps out: just check every possible pair using two nested loops.",naiveCode:`function twoSumNaive(arr, target) {
  // Check every pair - O(nÂ²)
  for (let i = 0; i < arr.length; i++) {
    for (let j = i + 1; j < arr.length; j++) {
      if (arr[i] + arr[j] === target) {
        return [i, j];
      }
    }
  }
  return [-1, -1];
}`,whyFails:"With nested loops, we check nÃ—(n-1)/2 pairs. For 10,000 elements, that's nearly 50 million comparisons. The array is SORTED, but we're completely ignoring that valuable property!",scaleDemo:[{n:100,naiveOps:4950,optimalOps:100},{n:1e3,naiveOps:499500,optimalOps:1e3},{n:1e4,naiveOps:49995e3,optimalOps:1e4}],transition:"The array is sorted. That one word changes everything. With two pointers, we can find the answer in a single pass.",narration:"When you first see this problem, your brain immediately thinks: just check every pair. Two nested loops, compare each element with every other. And it works! But look at the cost. For a thousand elements, we make half a million comparisons. The array is sorted, but we're ignoring that completely. That's the trap. The optimal solution uses two pointers and solves it in just one pass."});ol.register({id:"binary-search-naive",lectureId:"binary-search",title:"Linear Scan: The Slow Path",naiveComplexity:"O(n)",optimalComplexity:"O(log n)",intro:"The simplest way to find an element? Start at the beginning and check each one until you find it.",naiveCode:`function linearSearch(arr, target) {
  // Check every element - O(n)
  for (let i = 0; i < arr.length; i++) {
    if (arr[i] === target) {
      return i;
    }
  }
  return -1;
}`,whyFails:"Linear search checks every element one by one. If the target is at the end (or not there), we check ALL n elements. But with a sorted array, we can eliminate HALF the remaining elements with each comparison!",scaleDemo:[{n:100,naiveOps:100,optimalOps:7},{n:1e3,naiveOps:1e3,optimalOps:10},{n:1e6,naiveOps:1e6,optimalOps:20}],transition:"Binary search cuts the search space in half each time. For a million elements, just 20 comparisons instead of a million!",narration:"Linear search is simple. Start at the beginning, check each element. But it's painfully slow. For a million elements, worst case is a million checks. Binary search? Just 20. Because each comparison eliminates half the remaining possibilities. That's the power of logarithmic time."});ol.register({id:"coin-change-naive",lectureId:"coin-change",title:"The Greedy Trap",naiveComplexity:"Wrong Answer!",optimalComplexity:"O(amount Ã— coins)",intro:"Greedy seems perfect: always pick the largest coin that fits. Simple, fast, intuitive. But fundamentally broken.",naiveCode:`function coinChangeGreedy(coins, amount) {
  // Sort coins descending - always pick largest
  coins.sort((a, b) => b - a);
  let count = 0;
  
  for (const coin of coins) {
    while (amount >= coin) {
      amount -= coin;
      count++;
    }
  }
  
  return amount === 0 ? count : -1;
}`,whyFails:"Coins [1, 3, 4], amount 6. Greedy picks: 4 + 1 + 1 = 3 coins. But 3 + 3 = 2 coins is better! Greedy makes locally optimal choices that lead to globally suboptimal results.",scaleDemo:[{n:6,naiveOps:3,optimalOps:2},{n:12,naiveOps:4,optimalOps:3},{n:15,naiveOps:5,optimalOps:4}],transition:"Dynamic Programming considers ALL combinations efficiently. Build up from smaller amounts, remembering optimal solutions.",narration:"Greedy is tempting. Always pick the biggest coin. It's fast, it's simple. But it's wrong. Coins 1, 3, 4. Amount 6. Greedy picks 4, then 1, then 1. Three coins. But 3 plus 3 is only two coins! Greedy makes locally optimal choices that lead to globally suboptimal results. We need Dynamic Programming to consider all paths and find the true minimum."});typeof window<"u"&&(window.NaiveApproachLibrary=ol);const hr={mistakes:new Map,register(t){this.mistakes.set(t.id,t)},get(t){return this.mistakes.get(t)},getByCategory(t){return Array.from(this.mistakes.values()).filter(e=>e.category===t)},getAll(){return Array.from(this.mistakes.values())},renderMistake(t){const e=this.get(t);return e?`
      <div class="mistake-card">
        <div class="mistake-header">
          <span class="mistake-category">${e.category}</span>
          <h3>${e.name}</h3>
        </div>
        
        <div class="code-comparison">
          <div class="code-side wrong">
            <div class="side-label">âŒ Wrong</div>
            <pre><code>${e.wrongCode}</code></pre>
          </div>
          <div class="code-side correct">
            <div class="side-label">âœ“ Correct</div>
            <pre><code>${e.correctCode}</code></pre>
          </div>
        </div>
        
        <div class="mistake-explanation">
          <strong>Why it fails:</strong> ${e.explanation}
        </div>
        
        ${e.context?`<div class="mistake-context">ðŸ“Œ Common in: ${e.context}</div>`:""}
      </div>
    `:""},playMistake(t){var i;const e=this.get(t);e&&(i=window.ELectureNarrator)!=null&&i.speak&&window.ELectureNarrator.speak(e.narration)}};hr.register({id:"off-by-one-length",category:"Off-By-One",name:"Array Length vs Last Index",context:"All array problems",wrongCode:`// WRONG: Goes one too far!
for (let i = 0; i <= arr.length; i++) {
  console.log(arr[i]); // undefined at last
}`,correctCode:`// CORRECT: Use < not <=
for (let i = 0; i < arr.length; i++) {
  console.log(arr[i]);
}`,explanation:"Array of length 5 has indices 0-4, not 0-5. Using <= goes one past the end.",narration:"Off by one. The most common bug in programming. An array with five elements has indices zero through four, not zero through five. Using less than or equal goes one step too far and accesses undefined."});hr.register({id:"off-by-one-pointers",category:"Off-By-One",name:"Two Pointers Same Element",context:"Two Sum, Container Water",wrongCode:`// WRONG: Can use same element twice!
while (left <= right) {
  // left === right means same index
}`,correctCode:`// CORRECT: Strict inequality
while (left < right) {
  // Ensures different indices
}`,explanation:"Two Sum needs TWO different elements. If left equals right, we add one number to itself.",narration:"When using two pointers for Two Sum, we need two different numbers. Less than or equal lets left equal right, which means adding one number to itself. That is not valid."});hr.register({id:"boundary-empty",category:"Boundary",name:"Empty Array Access",context:"Find Max, Binary Search",wrongCode:`// WRONG: Crashes on empty!
function findMax(arr) {
  let max = arr[0]; // undefined!
  ...
}`,correctCode:`// CORRECT: Check first
function findMax(arr) {
  if (arr.length === 0) return null;
  let max = arr[0];
  ...
}`,explanation:"Accessing arr[0] on empty array gives undefined. Always check length first.",narration:"Empty array is a classic edge case. Accessing index zero on an empty array gives undefined. Comparing with undefined gives unexpected results. Always check if the array is empty first."});hr.register({id:"type-string-number",category:"Type Mismatch",name:"Grid String Characters",context:"Number of Islands",wrongCode:`// WRONG: Grid uses strings!
if (grid[r][c] === 1) { // Never true
  // grid[r][c] is "1", not 1
}`,correctCode:`// CORRECT: Compare with string
if (grid[r][c] === '1') {
  // Now it matches
}`,explanation:'LeetCode grids often use string characters. "1" is not equal to 1.',narration:"Number of Islands is a classic trap. The grid uses string characters, not numbers. Comparing with number one never matches string quote one quote. Always check what type your data is."});hr.register({id:"init-dp-wrong",category:"Wrong Init",name:"DP Array Zero Default",context:"Coin Change, DP Problems",wrongCode:`// WRONG: Zero breaks Math.min!
const dp = new Array(n).fill(0);
// Math.min(0, something) = 0 always`,correctCode:`// CORRECT: Use Infinity
const dp = new Array(n).fill(Infinity);
dp[0] = 0; // Base case`,explanation:'Initialize DP to Infinity for minimization problems. Zero means "already solved" which breaks the logic.',narration:"In Coin Change, initializing to zero breaks the minimization. Zero means already solved with zero coins. We need Infinity to represent not yet solved, so any valid solution wins the minimum comparison."});hr.register({id:"logic-bst-local",category:"Logic Error",name:"BST Only Checks Parent",context:"Validate BST",wrongCode:`// WRONG: Only checks immediate parent
if (node.left.val >= node.val) return false;
if (node.right.val <= node.val) return false;`,correctCode:`// CORRECT: Track valid range
function isValid(node, min, max) {
  if (node.val <= min || node.val >= max) 
    return false;
  return isValid(node.left, min, node.val) &&
         isValid(node.right, node.val, max);
}`,explanation:"A BST node must be greater than ALL ancestors on left path, not just immediate parent.",narration:"A common BST validation mistake: only checking the immediate parent. But a node in the right subtree must be greater than all ancestors above it, not just its parent. Pass down the valid range as you recurse."});typeof window<"u"&&(window.MistakesLibrary=hr);const Br={questions:new Map,register(t){this.questions.set(t.id,t)},get(t){return this.questions.get(t)},getAll(){return Array.from(this.questions.values())},getByCategory(t){return this.getAll().filter(e=>e.category===t)},getByDifficulty(t){return this.getAll().filter(e=>e.difficulty===t)},isCompleted(t){return localStorage.getItem(`cse-helper-problem-completed-${t}`)==="true"},markCompleted(t){localStorage.setItem(`cse-helper-problem-completed-${t}`,"true")}},BS={currentProblem:null,currentStep:0,open(t){var i;const e=Br.get(t);if(!e){window.showToast&&window.showToast("Problem not found","error");return}this.currentProblem=e,this.currentStep=0,this.render(),(i=window.StreakSystem)!=null&&i.addXP&&window.StreakSystem.addXP(10,`Started problem: ${e.title}`)},close(){const t=document.getElementById("walkthroughOverlay");t&&t.classList.remove("active"),this.currentProblem=null},startNarratorMode(){var i;if(!this.currentProblem){window.showToast&&window.showToast("No problem selected","error");return}const t=this.currentProblem.id;if(!((i=window.LectureLibrary)==null?void 0:i.get(t))){window.showToast&&window.showToast("ðŸš§ Narrator lecture coming soon for this problem!","info");return}this.close(),setTimeout(()=>{var s;(s=window.ELectureEngineV5)!=null&&s.start&&window.ELectureEngineV5.start(t)},300)},goToStep(t){if(!this.currentProblem)return;const e=this.currentProblem.walkthrough.steps;if(t<0||t>=e.length)return;this.currentStep=t,this.updateStepDisplay();const i=document.querySelector(".walkthrough-container");i&&i.scrollTo({top:0,behavior:"smooth"})},nextStep(){if(!this.currentProblem)return;const t=this.currentProblem.walkthrough.steps;if(this.currentStep<t.length-1){this.currentStep++,this.updateStepDisplay();const e=document.querySelector(".walkthrough-container");e&&e.scrollTo({top:0,behavior:"smooth"})}else this.markComplete()},prevStep(){if(this.currentStep>0){this.currentStep--,this.updateStepDisplay();const t=document.querySelector(".walkthrough-container");t&&t.scrollTo({top:0,behavior:"smooth"})}},updateStepDisplay(){document.querySelectorAll(".walkthrough-step-tab").forEach((r,n)=>{r.classList.remove("active"),n===this.currentStep&&r.classList.add("active"),n<this.currentStep&&r.classList.add("completed")}),document.querySelectorAll(".walkthrough-step-section").forEach((r,n)=>{r.classList.remove("active"),n===this.currentStep&&r.classList.add("active")});const i=document.getElementById("walkthroughPrevBtn"),s=document.getElementById("walkthroughNextBtn");if(i&&(i.disabled=this.currentStep===0),s){const r=this.currentStep===this.currentProblem.walkthrough.steps.length-1;s.textContent=r?"Complete âœ“":"Next â†’",s.classList.toggle("primary",r)}},markComplete(){var t,e;this.currentProblem&&(Br.markCompleted(this.currentProblem.id),(t=window.StreakSystem)!=null&&t.addXP&&window.StreakSystem.addXP(this.currentProblem.xpReward,`Completed: ${this.currentProblem.title}`),(e=window.ConfettiSystem)!=null&&e.burst&&window.ConfettiSystem.burst(window.innerWidth/2,window.innerHeight/2,50),window.showToast&&window.showToast(`ðŸŽ‰ Problem Complete! +${this.currentProblem.xpReward} XP`,"success"),setTimeout(()=>this.close(),1500))},copyCode(t){const e=t.closest(".code-block-wrapper").querySelector(".code-block");e&&(navigator.clipboard.writeText(e.textContent),t.textContent="Copied!",setTimeout(()=>t.textContent="Copy",2e3))},render(){var s,r,n;const t=this.currentProblem;if(!t)return;let e=document.getElementById("walkthroughOverlay");e||(e=document.createElement("div"),e.id="walkthroughOverlay",e.className="walkthrough-overlay",document.body.appendChild(e));const i=`difficulty-${t.difficulty.toLowerCase()}`;e.innerHTML=`
      <div class="walkthrough-container">
        <div class="walkthrough-header">
          <button class="walkthrough-close-btn" onclick="ProblemWalkthrough.close()">Ã—</button>
          <button class="walkthrough-narrator-btn" onclick="event.stopPropagation(); ProblemWalkthrough.startNarratorMode();" title="ðŸŽ™ï¸ Narrator Walkthrough">
            ðŸŽ™ï¸ Narrator
          </button>
          <h1 class="walkthrough-title">${t.title}</h1>
          <div class="walkthrough-meta">
            <span class="walkthrough-meta-item"><span class="difficulty-badge ${i}">${t.difficulty}</span></span>
            <span class="walkthrough-meta-item">âš¡ ${t.xpReward} XP</span>
            <span class="walkthrough-meta-item">â±ï¸ ~${t.estimatedTime} min</span>
            <span class="walkthrough-meta-item">ðŸ“ ${t.category}</span>
          </div>
        </div>
        
        <div class="walkthrough-problem">
          <div class="problem-statement">${t.problem.description}</div>
        </div>
        
        <div class="walkthrough-steps-nav">
          ${t.walkthrough.steps.map((a,o)=>`
            <button class="walkthrough-step-tab ${o===0?"active":""}" onclick="ProblemWalkthrough.goToStep(${o})">
              ${a.title}
            </button>
          `).join("")}
        </div>
        
        <div class="walkthrough-content">
          ${t.walkthrough.steps.map((a,o)=>`
            <div class="walkthrough-step-section ${o===0?"active":""}">
              <h2 class="step-title">
                <span class="step-number">${o+1}</span>
                ${a.title}
              </h2>
              <p class="step-description">${a.content}</p>
              ${a.code?this.renderCodeBlock(a.code,a.lang||"javascript"):""}
            </div>
          `).join("")}
          
          ${((s=t.edgeCases)==null?void 0:s.length)>0?`
            <div class="edge-cases-section">
              <h3 class="section-subtitle">âš ï¸ Edge Cases to Test</h3>
              <table class="edge-cases-table">
                <thead><tr><th>Case</th><th>Input</th><th>Expected</th><th>Why It Matters</th></tr></thead>
                <tbody>
                  ${t.edgeCases.map(a=>`
                    <tr>
                      <td>${a.case}</td>
                      <td><code>${a.input}</code></td>
                      <td><code>${a.expected}</code></td>
                      <td>${a.why}</td>
                    </tr>
                  `).join("")}
                </tbody>
              </table>
            </div>
          `:""}
          
          ${((r=t.commonMistakes)==null?void 0:r.length)>0?`
            <div class="mistakes-section">
              <h3 class="section-subtitle">âŒ Common Mistakes</h3>
              ${t.commonMistakes.map(a=>`
                <div class="mistake-card">
                  <div class="mistake-header">
                    <span class="mistake-icon">âš ï¸</span>
                    <h4 class="mistake-title">${a.title}</h4>
                  </div>
                  <div class="mistake-comparison">
                    <div class="mistake-wrong">
                      <div class="mistake-label">âŒ Wrong</div>
                      <div class="mistake-code">${a.wrong}</div>
                    </div>
                    <div class="mistake-correct">
                      <div class="mistake-label">âœ“ Correct</div>
                      <div class="mistake-code">${a.correct}</div>
                    </div>
                  </div>
                  ${a.explanation?`<div class="mistake-explanation">${a.explanation}</div>`:""}
                </div>
              `).join("")}
            </div>
          `:""}
          
          ${(n=t.complexity)!=null&&n.approaches?`
            <div class="complexity-section">
              <h3 class="section-subtitle">ðŸ“Š Complexity Analysis</h3>
              <table class="complexity-table">
                <thead><tr><th>Approach</th><th>Time</th><th>Space</th><th>When to Use</th></tr></thead>
                <tbody>
                  ${t.complexity.approaches.map((a,o)=>`
                    <tr class="${o===0?"complexity-recommended":""}">
                      <td>${a.name}</td>
                      <td><code>${a.time}</code></td>
                      <td><code>${a.space}</code></td>
                      <td>${a.when}</td>
                    </tr>
                  `).join("")}
                </tbody>
              </table>
            </div>
          `:""}
        </div>
        
        <div class="walkthrough-footer">
          <button class="walkthrough-nav-btn" id="walkthroughPrevBtn" onclick="ProblemWalkthrough.prevStep()" disabled>
            â† Previous
          </button>
          <button class="walkthrough-nav-btn" id="walkthroughNextBtn" onclick="ProblemWalkthrough.nextStep()">
            Next â†’
          </button>
        </div>
      </div>
    `,e.classList.add("active")},renderCodeBlock(t,e="javascript"){if(typeof t=="string")return`
        <div class="code-block-wrapper">
          <div class="code-block-header">
            <span class="code-block-lang">${e}</span>
            <button class="code-copy-btn" onclick="ProblemWalkthrough.copyCode(this)">Copy</button>
          </div>
          <pre class="code-block">${this.escapeHtml(t)}</pre>
        </div>
      `;const i=Object.keys(t),s="code-"+Math.random().toString(36).substr(2,9);return`
      <div class="code-block-wrapper multi-lang" data-block-id="${s}">
        <div class="code-block-header">
          <div class="code-lang-tabs">
            ${i.map((r,n)=>`
              <button class="code-lang-tab ${n===0?"active":""}" 
                      onclick="ProblemWalkthrough.switchLang('${s}', '${r}')">
                ${r==="javascript"?"JavaScript":r==="python"?"Python":"Java"}
              </button>
            `).join("")}
          </div>
          <button class="code-copy-btn" onclick="ProblemWalkthrough.copyCode(this)">Copy</button>
        </div>
        ${i.map((r,n)=>`
          <pre class="code-block" data-lang="${r}" style="${n===0?"":"display:none"}">${this.escapeHtml(t[r])}</pre>
        `).join("")}
      </div>
    `},switchLang(t,e){const i=document.querySelector(`[data-block-id="${t}"]`);i&&(i.querySelectorAll(".code-lang-tab").forEach(s=>{s.classList.remove("active"),s.textContent.toLowerCase().includes(e.slice(0,4))&&s.classList.add("active")}),i.querySelectorAll(".code-block").forEach(s=>{s.style.display=s.dataset.lang===e?"":"none"}))},escapeHtml(t){const e=document.createElement("div");return e.textContent=t,e.innerHTML}},jS={currentFilter:"all",render(t){const e=document.getElementById(t);if(!e)return;const i=Br.getAll();e.innerHTML=`
      <div class="problem-browser">
        <div class="problem-browser-header">
          <h2 style="margin: 0; font-size: 1.5rem; color: var(--text-heading);">
            ðŸ§  Practice Problems
          </h2>
          <div class="problem-filter-tabs">
            <button class="problem-filter-btn ${this.currentFilter==="all"?"active":""}" 
                    onclick="ProblemBrowser.filter('all')">All</button>
            <button class="problem-filter-btn ${this.currentFilter==="sorting"?"active":""}" 
                    onclick="ProblemBrowser.filter('sorting')">Sorting</button>
            <button class="problem-filter-btn ${this.currentFilter==="searching"?"active":""}" 
                    onclick="ProblemBrowser.filter('searching')">Searching</button>
            <button class="problem-filter-btn ${this.currentFilter==="graph"?"active":""}" 
                    onclick="ProblemBrowser.filter('graph')">Graphs</button>
            <button class="problem-filter-btn ${this.currentFilter==="dp"?"active":""}" 
                    onclick="ProblemBrowser.filter('dp')">DP</button>
          </div>
        </div>
        <div class="problem-cards-grid" id="problemCardsGrid">
          ${this.renderCards(i)}
        </div>
      </div>
    `},renderCards(t){const e=this.currentFilter==="all"?t:t.filter(i=>i.category===this.currentFilter);return e.length===0?`<div style="grid-column: 1/-1; text-align: center; padding: 3rem; color: var(--text-muted);">
        No problems in this category yet.
      </div>`:e.map(i=>{const s=Br.isCompleted(i.id),r=`difficulty-${i.difficulty.toLowerCase()}`;return`
        <div class="problem-card" onclick="ProblemWalkthrough.open('${i.id}')">
          <div class="problem-card-header">
            <h3 class="problem-card-title">${i.title}</h3>
            <span class="difficulty-badge ${r}">${i.difficulty}</span>
          </div>
          <div class="problem-card-meta">
            <span>âš¡ ${i.xpReward} XP</span>
            <span>â±ï¸ ~${i.estimatedTime} min</span>
          </div>
          <p class="problem-card-desc">${i.problem.description.slice(0,100)}...</p>
          <div class="problem-card-footer">
            <div class="problem-tags">
              <span class="problem-tag">${i.category}</span>
              ${i.tags?i.tags.map(n=>`<span class="problem-tag">${n}</span>`).join(""):""}
            </div>
            ${s?'<span class="problem-completed-badge">âœ“</span>':""}
          </div>
        </div>
      `}).join("")},filter(t){this.currentFilter=t;const e=document.getElementById("problemCardsGrid");e&&(e.innerHTML=this.renderCards(Br.getAll())),document.querySelectorAll(".problem-filter-btn").forEach(i=>{i.classList.remove("active"),(i.textContent.toLowerCase().includes(t)||t==="all"&&i.textContent==="All")&&i.classList.add("active")})}};typeof window<"u"&&(window.QuestionBank=Br,window.ProblemWalkthrough=BS,window.ProblemBrowser=jS);const V={synth:typeof window<"u"?window.speechSynthesis:null,voice:null,rate:.95,enabled:!0,isSpeaking:!1,useMeSpeak:!1,pronunciationMap:{"O(nÂ²)":"O of n squared","O(n^2)":"O of n squared","O(nÂ³)":"O of n cubed","O(2^n)":"O of 2 to the n","O(n!)":"O of n factorial","O(log n)":"O of log n","O(n log n)":"O of n log n","O(âˆšn)":"O of square root of n","O(n)":"O of n, linear time","O(1)":"O of 1, constant time","âˆš":"square root of","âˆ‘":"sum of","âˆ":"product of","âˆž":"infinity","â‰ˆ":"approximately equals","â‰ ":"not equal to","â‰¤":"less than or equal to","â‰¥":"greater than or equal to","Ã—":"times","Ã·":"divided by","Â±":"plus or minus","Â²":" squared","Â³":" cubed","â´":" to the fourth",â¿:" to the n",Î±:"alpha",Î²:"beta",Î³:"gamma",Î¸:"theta",Î»:"lambda",Ï€:"pi",Î©:"big omega",Î˜:"big theta","i++":"i plus plus","++":" increment","--":" decrement","+=":"plus equals","-=":"minus equals","===":"triple equals","!==":"not triple equals","==":"double equals","<=":"less than or equal to",">=":"greater than or equal to","&&":" and ","||":" or ","=>":"arrow function","...":"spread operator",BFS:"Breadth First Search",DFS:"Depth First Search",DP:"Dynamic Programming",MST:"Minimum Spanning Tree","e.g.":"for example","i.e.":"that is","etc.":"et cetera","vs.":"versus",arr:"array",ptr:"pointer",idx:"index",len:"length",prev:"previous",curr:"current",SQL:"S Q L",SELECT:"select",WHERE:"where clause",JOIN:"join","INNER JOIN":"inner join","LEFT JOIN":"left join","RIGHT JOIN":"right join","FULL OUTER JOIN":"full outer join","CROSS JOIN":"cross join","GROUP BY":"group by clause","ORDER BY":"order by clause",HAVING:"having clause",LIMIT:"limit",OFFSET:"offset",DISTINCT:"distinct","INSERT INTO":"insert into",UPDATE:"update","DELETE FROM":"delete from","CREATE TABLE":"create table","ALTER TABLE":"alter table","DROP TABLE":"drop table",TRUNCATE:"truncate",DDL:"D D L, Data Definition Language",DML:"D M L, Data Manipulation Language",DQL:"D Q L, Data Query Language",DCL:"D C L, Data Control Language",TCL:"T C L, Transaction Control Language","PRIMARY KEY":"primary key","FOREIGN KEY":"foreign key","NOT NULL":"not null constraint",AUTO_INCREMENT:"auto increment",VARCHAR:"var char",DECIMAL:"decimal",BOOLEAN:"boolean",INT:"integer",CTE:"C T E, Common Table Expression",WITH:"with clause",RECURSIVE:"recursive",WINDOW:"window function",OVER:"over clause","PARTITION BY":"partition by",ROW_NUMBER:"row number",RANK:"rank",DENSE_RANK:"dense rank",LAG:"lag function",LEAD:"lead function",NTILE:"n tile",ACID:"A C I D",COMMIT:"commit",ROLLBACK:"rollback",SAVEPOINT:"savepoint","BEGIN TRANSACTION":"begin transaction",COALESCE:"coalesce",NULLIF:"null if","CASE WHEN":"case when",UNION:"union",INTERSECT:"intersect",EXCEPT:"except",SUBQUERY:"sub query","correlated subquery":"correlated subquery"},init(){if(!this.synth){console.warn("[Narrator] Web Speech API not available");return}const t=()=>{const e=this.synth.getVoices();return e.length===0?(console.warn("[Narrator] No TTS voices available"),!1):(this.voice=e.find(i=>i.name.includes("Google")&&i.lang.startsWith("en"))||e.find(i=>i.name.includes("Samantha"))||e.find(i=>i.name.includes("Microsoft")&&i.lang.startsWith("en"))||e.find(i=>i.name.toLowerCase().includes("english"))||e.find(i=>i.lang.startsWith("en-US")||i.lang.startsWith("en-GB"))||e.find(i=>i.lang.startsWith("en"))||e[0],this.voice?(console.log("[Narrator] âœ… Voice loaded:",this.voice.name,"- Total voices:",e.length),!0):!1)};this.synth.getVoices().length?t():(this.synth.onvoiceschanged=t,[100,500,1e3,2e3,3e3,5e3].forEach((i,s)=>{setTimeout(()=>{this.voice||t()&&console.log(`[Narrator] Voice loaded on retry ${s+1} (${i}ms)`)},i)}))},isReady(){return!!(this.synth&&this.voice&&this.enabled)},polishText(t){let e=t;const i=Object.keys(this.pronunciationMap).sort((s,r)=>r.length-s.length);for(const s of i){const r=s.replace(/[.*+?^${}()|[\]\\]/g,"\\$&"),n=new RegExp(r,"g");e=e.replace(n,this.pronunciationMap[s])}return e=e.replace(/\[(\d+)\]/g," at index $1"),e=e.replace(/\[([a-z])\]/gi," at index $1"),e=e.replace(/(\d+)\^(\d+)/g,"$1 to the power of $2"),e=e.replace(/(\d+)\/(\d+)/g,"$1 divided by $2"),e=e.replace(/\. /g,". ... "),e=e.replace(/: /g,": ... "),e=e.replace(/\s+/g," "),e},speak(t,e=null,i=1){var r;if(!this.enabled){e&&setTimeout(e,2e3);return}if(!t){e&&e();return}const s=this.polishText(t);if(this.synth&&!this.useMeSpeak){if(!this.voice){const n=this.synth.getVoices();n.length>0&&(this.voice=n.find(a=>a.name.includes("Google")&&a.lang.startsWith("en"))||n.find(a=>a.lang.startsWith("en-US")||a.lang.startsWith("en-GB"))||n[0],console.log("[Narrator] Voice loaded (JIT):",(r=this.voice)==null?void 0:r.name))}if(this.voice||this.synth.getVoices().length>0){this.synth.cancel();const n=new SpeechSynthesisUtterance(s);this.voice&&(n.voice=this.voice),n.rate=Math.min(1.5,Math.max(.8,this.rate*i)),n.pitch=1,this.isSpeaking=!0,this.updateSpeakingIndicator(!0),n.onend=()=>{this.isSpeaking=!1,this.updateSpeakingIndicator(!1),e&&e()},n.onerror=a=>{console.warn("[Narrator] Native TTS error:",a.error),a.error==="synthesis-failed"||a.error==="unavailable"?(this.useMeSpeak=!0,this.speakWithMeSpeak(s,e,i)):(this.isSpeaking=!1,this.updateSpeakingIndicator(!1),e&&e())},this.synth.speak(n);return}console.warn("[Narrator] Native TTS available but no voices found yet.")}this.speakWithOnlineTTS(s,e,i)},speakWithOnlineTTS(t,e=null,i=1){if(!navigator.onLine){console.warn("[Narrator] Offline, falling back to meSpeak"),this.speakWithMeSpeak(t,e,i);return}console.log("[Narrator] Trying Online TTS..."),this.isSpeaking=!0,this.updateSpeakingIndicator(!0);const s=t.match(/[^.!?]+[.!?]+|[^.!?]+$/g)||[t];let r=0;const n=()=>{if(r>=s.length){this.isSpeaking=!1,this.updateSpeakingIndicator(!1),e&&e();return}const a=s[r].trim();if(!a){r++,n();return}const l=`https://translate.google.com/translate_tts?ie=UTF-8&q=${encodeURIComponent(a)}&tl=en&client=gtx`,c=new Audio(l);c.playbackRate=i,this.currentAudio=c,c.onended=()=>{r++,n()},c.onerror=h=>{console.error("[Narrator] Online TTS failed (Network/Format):",h),this.showErrorToast("Online TTS Network Error"),this.currentAudio=null,this.speakWithMeSpeak(t,e,i)},c.play().catch(h=>{console.error("[Narrator] Online TTS play error (Autoplay/Policy):",h),this.showErrorToast("Online TTS Autoplay Blocked"),this.speakWithMeSpeak(t,e,i)})};n()},showErrorToast(t){let e=document.getElementById("narrator-toast");e||(e=document.createElement("div"),e.id="narrator-toast",e.style.cssText=`
        position: fixed; top: 20px; right: 20px;
        background: rgba(255, 0, 0, 0.8); color: white;
        padding: 10px 20px; border-radius: 4px;
        z-index: 10002; font-size: 14px;
        pointer-events: none; transition: opacity 0.5s;
      `,document.body.appendChild(e)),e.textContent=t,e.style.opacity="1",setTimeout(()=>{e.style.opacity="0"},3e3)},speakWithMeSpeak(t,e=null,i=1){if(typeof window.meSpeak<"u"&&window.meSpeak.speak){console.log("[Narrator] Using meSpeak.js fallback"),this.isSpeaking=!0,this.updateSpeakingIndicator(!0);const s=Math.round(130*i);window.meSpeak.speak(t,{speed:s,pitch:40,amplitude:80,wordgap:5,variant:"f2"},()=>{this.isSpeaking=!1,this.updateSpeakingIndicator(!1),e&&e()})}else console.warn("[Narrator] meSpeak not loaded"),e&&setTimeout(e,this.estimateReadTime(t))},estimateReadTime(t){const e=t.split(/\s+/).length;return Math.max(2e3,e/150*6e4)},showSubtitle(t){},hideSubtitle(){const t=document.getElementById("eLectureSubtitle");t&&t.remove()},pause(){this.synth&&this.synth.pause(),this.currentAudio&&this.currentAudio.pause(),this.isSpeaking=!1,this.updateSpeakingIndicator(!1)},resume(){this.synth&&this.synth.resume(),this.currentAudio&&this.currentAudio.play(),this.isSpeaking=!0,this.updateSpeakingIndicator(!0)},stop(){this.synth&&this.synth.cancel(),this.currentAudio&&(this.currentAudio.pause(),this.currentAudio=null),typeof window.meSpeak<"u"&&window.meSpeak.stop&&window.meSpeak.stop(),this.isSpeaking=!1,this.updateSpeakingIndicator(!1)},toggle(){return this.enabled=!this.enabled,this.enabled||this.stop(),this.enabled},updateSpeakingIndicator(t){const e=document.getElementById("eLectureSpeakingIndicator");e&&e.classList.toggle("active",t)},addPronunciation(t,e){this.pronunciationMap[t]=e},unlock(){var t;if(!this._unlocked){if(this.synth&&this.synth.cancel(),!this.voice&&this.synth){const e=this.synth.getVoices();e.length>0&&(this.voice=e.find(i=>i.name.includes("Google")&&i.lang.startsWith("en"))||e.find(i=>i.lang.startsWith("en-US")||i.lang.startsWith("en-GB"))||e[0],console.log("[Narrator] Unlocked with voice:",(t=this.voice)==null?void 0:t.name))}this._unlocked=!0}}};if(typeof window<"u"){V.init(),window.ELectureNarrator=V;const t=()=>{V.unlock(),document.removeEventListener("click",t),document.removeEventListener("keydown",t),document.removeEventListener("touchstart",t)};document.addEventListener("click",t,{once:!0}),document.addEventListener("keydown",t,{once:!0}),document.addEventListener("touchstart",t,{once:!0})}const WS={storageKey:"electure_progress",xpRewards:{STEP_COMPLETE:5,SECTION_COMPLETE:25,LESSON_COMPLETE:100,CORRECT_ANSWER:15,NO_HINTS:30,SPEED_BONUS:25},difficultyMultipliers:{beginner:1,Beginner:1,intermediate:1.5,Intermediate:1.5,hard:2,Hard:2,advanced:2,Advanced:2},levelThresholds:[0,100,300,600,1e3,1500,2500,4e3,6e3,1e4],achievements:{"first-lesson":{id:"first-lesson",title:"First Steps",description:"Complete your first E-Learning lesson",icon:"ðŸŽ¯",xpBonus:50,rarity:"common"},"five-lessons":{id:"five-lessons",title:"Getting Warmed Up",description:"Complete 5 E-Learning lessons",icon:"ðŸ”¥",xpBonus:100,rarity:"uncommon"},"streak-7":{id:"streak-7",title:"Week Warrior",description:"Maintain a 7-day learning streak",icon:"ðŸ“†",xpBonus:75,rarity:"uncommon"},"streak-30":{id:"streak-30",title:"Habit Master",description:"Maintain a 30-day learning streak",icon:"ðŸ†",xpBonus:500,rarity:"legendary"},"no-hints":{id:"no-hints",title:"Self-Reliant",description:"Complete a lesson without using hints",icon:"ðŸ§ ",xpBonus:50,rarity:"uncommon"},"speed-demon":{id:"speed-demon",title:"Speed Demon",description:"Complete a lesson in under 50% of estimated time",icon:"âš¡",xpBonus:75,rarity:"rare"},"algorithm-master":{id:"algorithm-master",title:"Algorithm Master",description:"Complete all E-Learning lessons",icon:"ðŸ‘‘",xpBonus:1e3,rarity:"legendary"}},load(){try{const t=localStorage.getItem(this.storageKey);return t?JSON.parse(t):this.getDefaultProgress()}catch{return this.getDefaultProgress()}},save(t){try{localStorage.setItem(this.storageKey,JSON.stringify(t))}catch(e){console.warn("Could not save progress:",e)}},getDefaultProgress(){return{totalXP:0,level:1,streakDays:0,lastActive:null,completedLessons:[],lessonsInProgress:{},unlockedAchievements:[],stats:{stepsCompleted:0,correctAnswers:0,hintsUsed:0,totalTimeSpent:0}}},getProgress(){return this.load()},getLevel(t){for(let e=this.levelThresholds.length-1;e>=0;e--)if(t>=this.levelThresholds[e])return e+1;return 1},getLevelProgress(t){const e=this.getLevel(t),i=this.levelThresholds[e-1]||0,s=this.levelThresholds[e]||this.levelThresholds[e-1]+1e3,r=t-i,n=s-i;return{progress:r,required:n,percentage:Math.min(100,r/n*100)}},awardXP(t,e=""){const i=this.load(),s=this.getLevel(i.totalXP);i.totalXP+=t;const r=this.getLevel(i.totalXP);return i.level=r,this.save(i),this.showXPNotification(t,e),r>s&&this.showLevelUpNotification(r),this.updateStreak(),{xp:t,newTotal:i.totalXP,leveledUp:r>s}},updateStreak(){const t=this.load(),e=new Date,i=t.lastActive?new Date(t.lastActive):null;if(!i)t.streakDays=1;else{const s=(e-i)/36e5,r=e.toDateString(),n=i.toDateString();r!==n&&(t.streakDays=s<48?t.streakDays+1:1)}return t.lastActive=e.toISOString(),this.save(t),this.checkAchievements(),t.streakDays},completeStep(t,e){const i=this.load();i.stats.stepsCompleted++,i.lessonsInProgress[t]||(i.lessonsInProgress[t]={stepsCompleted:[],startTime:Date.now()}),i.lessonsInProgress[t].stepsCompleted.includes(e)||i.lessonsInProgress[t].stepsCompleted.push(e),this.save(i),this.awardXP(this.xpRewards.STEP_COMPLETE,"Step Complete")},completeLesson(t,e={}){const i=this.load();if(!i.completedLessons.includes(t)){i.completedLessons.push(t);let s=0;e.hintsUsed===0&&(s+=this.xpRewards.NO_HINTS),e.timeSpent&&e.estimatedTime&&e.timeSpent<e.estimatedTime*.5&&(s+=this.xpRewards.SPEED_BONUS),delete i.lessonsInProgress[t],this.save(i),this.awardXP(this.xpRewards.LESSON_COMPLETE+s,"Lesson Complete!"),this.checkAchievements()}},correctAnswer(){const t=this.load();t.stats.correctAnswers++,this.save(t),this.awardXP(this.xpRewards.CORRECT_ANSWER,"Correct!")},checkAchievements(){const t=this.load(),e=[];t.completedLessons.length>=1&&!t.unlockedAchievements.includes("first-lesson")&&e.push("first-lesson"),t.completedLessons.length>=5&&!t.unlockedAchievements.includes("five-lessons")&&e.push("five-lessons"),t.streakDays>=7&&!t.unlockedAchievements.includes("streak-7")&&e.push("streak-7"),t.streakDays>=30&&!t.unlockedAchievements.includes("streak-30")&&e.push("streak-30"),e.forEach(i=>{t.unlockedAchievements.push(i);const s=this.achievements[i];t.totalXP+=s.xpBonus,this.showAchievementNotification(s)}),e.length>0&&this.save(t)},showXPNotification(t,e){const i=document.createElement("div");i.className="electure-xp-popup",i.innerHTML=`<span class="xp-amount">+${t} XP</span><span class="xp-reason">${e}</span>`,document.body.appendChild(i),setTimeout(()=>i.classList.add("visible"),10),setTimeout(()=>{i.classList.remove("visible"),setTimeout(()=>i.remove(),300)},1500)},showLevelUpNotification(t){T(`ðŸŽ‰ Level Up! You're now Level ${t}!`,"success")},showAchievementNotification(t){const e=document.createElement("div");e.className=`electure-achievement-popup ${t.rarity}`,e.innerHTML=`
      <div class="achievement-icon">${t.icon}</div>
      <div class="achievement-content">
        <div class="achievement-header">Achievement Unlocked!</div>
        <div class="achievement-title">${t.title}</div>
        <div class="achievement-desc">${t.description}</div>
        <div class="achievement-xp">+${t.xpBonus} XP</div>
      </div>
    `,document.body.appendChild(e),setTimeout(()=>e.classList.add("visible"),10),setTimeout(()=>{e.classList.remove("visible"),setTimeout(()=>e.remove(),500)},4e3)},renderDashboard(){const t=this.load(),e=this.getLevelProgress(t.totalXP);return`
      <div class="electure-progress-dashboard">
        <div class="progress-level-section">
          <div class="level-badge">
            <span class="level-number">${t.level}</span>
            <span class="level-label">Level</span>
          </div>
          <div class="xp-progress">
            <div class="xp-bar">
              <div class="xp-fill" style="width: ${e.percentage}%"></div>
            </div>
            <span class="xp-text">${e.progress} / ${e.required} XP</span>
          </div>
          <div class="total-xp">${t.totalXP.toLocaleString()} Total XP</div>
        </div>
        <div class="progress-streak-section">
          <div class="streak-flame">ðŸ”¥</div>
          <div class="streak-count">${t.streakDays}</div>
          <div class="streak-label">Day Streak</div>
        </div>
        <div class="progress-stats">
          <div class="stat-item">
            <span class="stat-value">${t.completedLessons.length}</span>
            <span class="stat-label">Lessons</span>
          </div>
          <div class="stat-item">
            <span class="stat-value">${t.unlockedAchievements.length}</span>
            <span class="stat-label">Badges</span>
          </div>
        </div>
      </div>
    `}};typeof window<"u"&&(window.ELectureGamification=WS);const ld={sounds:{flip:{frequency:440,duration:100,type:"sine"},correct:{frequency:880,duration:200,type:"sine"},incorrect:{frequency:220,duration:300,type:"triangle"},step:{frequency:660,duration:50,type:"sine"},complete:{frequency:1046.5,duration:500,type:"sine"}},audioContext:null,enabled:!0,ensureContext(){if(this.audioContext)return!0;try{return this.audioContext=new(window.AudioContext||window.webkitAudioContext),console.log("[LectureAudio] AudioContext created on user gesture"),!0}catch{return console.warn("[LectureAudio] Web Audio API not supported"),this.enabled=!1,!1}},init(){console.log("[LectureAudio] Ready (AudioContext will be created on first use)")},play(t){if(!this.enabled||!this.ensureContext())return;const e=this.sounds[t];if(!e)return;this.audioContext.state==="suspended"&&this.audioContext.resume();const i=this.audioContext.createOscillator(),s=this.audioContext.createGain();i.type=e.type,i.frequency.value=e.frequency,s.gain.setValueAtTime(.08,this.audioContext.currentTime),s.gain.exponentialRampToValueAtTime(.001,this.audioContext.currentTime+e.duration/1e3),i.connect(s),s.connect(this.audioContext.destination),i.start(),i.stop(this.audioContext.currentTime+e.duration/1e3)},playCompletionMelody(){if(!this.enabled||!this.ensureContext())return;this.audioContext.state==="suspended"&&this.audioContext.resume(),[523.25,659.25,783.99,1046.5].forEach((e,i)=>{setTimeout(()=>{const s=this.audioContext.createOscillator(),r=this.audioContext.createGain();s.type="sine",s.frequency.value=e,r.gain.setValueAtTime(.1,this.audioContext.currentTime),r.gain.exponentialRampToValueAtTime(.001,this.audioContext.currentTime+.3),s.connect(r),r.connect(this.audioContext.destination),s.start(),s.stop(this.audioContext.currentTime+.3)},i*150)})},toggle(){return this.enabled=!this.enabled,this.enabled}},FS={overlayEl:null,show(t){var s;this.overlayEl||(this.overlayEl=document.createElement("div"),this.overlayEl.className="electure-completion-overlay",this.overlayEl.id="eLectureCompletionOverlay",document.body.appendChild(this.overlayEl));const e=this.formatTime(t.timeSpent),i=this.checkStreakBonus();this.overlayEl.innerHTML=`
      <div class="completion-card">
        <div class="completion-confetti" id="completionConfetti"></div>
        
        <div class="completion-badge">
          <span class="badge-icon">ðŸ†</span>
          <span class="badge-glow"></span>
        </div>
        
        <h2 class="completion-title">Lecture Complete!</h2>
        <p class="completion-subtitle">${t.title}</p>
        
        ${i?'<div class="streak-bonus">ðŸ”¥ Streak Bonus! +50 XP</div>':""}
        
        <div class="completion-stats">
          <div class="completion-stat">
            <span class="completion-stat-value">${t.xpEarned}</span>
            <span class="completion-stat-label">XP Earned</span>
          </div>
          <div class="completion-stat">
            <span class="completion-stat-value">${t.score}</span>
            <span class="completion-stat-label">Quiz Points</span>
          </div>
          <div class="completion-stat">
            <span class="completion-stat-value">${e}</span>
            <span class="completion-stat-label">Time</span>
          </div>
        </div>
        
        <div class="completion-actions">
          <button class="completion-btn primary" onclick="LectureCompletion.continueNext()">
            Continue Learning â†’
          </button>
          <button class="completion-btn secondary" onclick="LectureCompletion.close()">
            Back to Library
          </button>
        </div>
      </div>
    `,this.overlayEl.classList.add("active"),this.triggerConfetti(),ld.playCompletionMelody(),i&&typeof((s=window.StreakSystem)==null?void 0:s.addXP)=="function"&&window.StreakSystem.addXP(50,"Lecture streak bonus"),this.saveToHistory(t)},triggerConfetti(){const t=document.getElementById("completionConfetti");if(!t)return;const e=["#667eea","#764ba2","#2ed573","#ffd700","#ff6b6b"];for(let i=0;i<50;i++){const s=document.createElement("div");s.className="confetti-piece",s.style.left=`${Math.random()*100}%`,s.style.backgroundColor=e[Math.floor(Math.random()*e.length)],s.style.animationDelay=`${Math.random()*.5}s`,t.appendChild(s)}},formatTime(t){const e=Math.floor(t/6e4),i=Math.floor(t%6e4/1e3);return`${e}:${i.toString().padStart(2,"0")}`},checkStreakBonus(){const t=new Date().toDateString();return JSON.parse(localStorage.getItem("cse-helper-lecture-history")||"[]").filter(s=>s.date===t).length>=2},saveToHistory(t){const e=JSON.parse(localStorage.getItem("cse-helper-lecture-history")||"[]");e.push({lectureId:t.lectureId,title:t.title,date:new Date().toDateString(),timestamp:Date.now(),xpEarned:t.xpEarned,score:t.score}),e.length>50&&e.shift(),localStorage.setItem("cse-helper-lecture-history",JSON.stringify(e))},continueNext(){var e,i,s,r,n,a;this.close();const t=(n=(e=window.LectureLibrary)==null?void 0:e.getNext)==null?void 0:n.call(e,(r=(s=(i=window.ELectureEngineV5)==null?void 0:i.state)==null?void 0:s.lecture)==null?void 0:r.id);t&&((a=window.ELectureEngineV5)!=null&&a.start)&&window.ELectureEngineV5.start(t.id)},close(){var t;this.overlayEl&&(this.overlayEl.classList.remove("active"),setTimeout(()=>{this.overlayEl&&(this.overlayEl.innerHTML="")},300)),(t=window.ELectureEngineV5)!=null&&t.exit&&window.ELectureEngineV5.exit()}};ld.init();typeof window<"u"&&(window.LectureAudio=ld,window.LectureCompletion=FS);const US={mode:"split",isAnimating:!1,syncEnabled:!0,setMode(t){this.mode=t;const e=document.querySelector(".electure-flip-container");e&&(e.dataset.mode=t,document.querySelectorAll(".view-mode-btn").forEach(i=>{i.classList.toggle("active",i.dataset.mode===t)}))},flipToCode(){if(this.isAnimating)return;this.isAnimating=!0;const t=document.getElementById("eLectureFlipCard");t&&(t.dataset.side="code",t.classList.add("flipping"),setTimeout(()=>{t.classList.remove("flipping"),this.isAnimating=!1},600))},flipToVisual(){if(this.isAnimating)return;this.isAnimating=!0;const t=document.getElementById("eLectureFlipCard");t&&(t.dataset.side="visual",t.classList.add("flipping"),setTimeout(()=>{t.classList.remove("flipping"),this.isAnimating=!1},600))},toggle(){const t=document.getElementById("eLectureFlipCard");t&&(t.dataset.side==="code"?this.flipToVisual():this.flipToCode())},syncWithNarration(t){if(!this.syncEnabled)return;const e=t.toLowerCase(),i=["look at","see how","watch","notice","observe","visualize","array looks","pointer moves"],s=["the code","this line","function","return","variable","loop","if statement"],r=i.some(a=>e.includes(a)),n=s.some(a=>e.includes(a));r&&!n?this.flipToVisual():n&&!r&&this.flipToCode()},highlightCodeLines(t){document.querySelectorAll(".electure-code-line").forEach(e=>{const i=parseInt(e.dataset.line);e.classList.toggle("highlighted",t.includes(i))})},renderControls(){return`
      <div class="view-mode-controls">
        <button class="view-mode-btn ${this.mode==="code"?"active":""}" 
                data-mode="code" onclick="FlipCardSync.setMode('code')">
          ðŸ’» Code
        </button>
        <button class="view-mode-btn ${this.mode==="split"?"active":""}" 
                data-mode="split" onclick="FlipCardSync.setMode('split')">
          âš¡ Split
        </button>
        <button class="view-mode-btn ${this.mode==="visual"?"active":""}" 
                data-mode="visual" onclick="FlipCardSync.setMode('visual')">
          ðŸ“Š Visual
        </button>
        <button class="flip-toggle-btn" onclick="FlipCardSync.toggle()" title="Flip (F key)">
          ðŸ”„
        </button>
      </div>
    `}},Xg={storageKey:"electure_settings",defaults:{narrationSpeed:1,narrationEnabled:!0,reducedMotion:!1,highContrast:!1,fontSize:"medium",autoAdvance:!1},speedOptions:[{label:"Slow",value:.7},{label:"Normal",value:1},{label:"Fast",value:1.3},{label:"Very Fast",value:1.6}],fontSizeOptions:[{label:"Small",value:"small"},{label:"Medium",value:"medium"},{label:"Large",value:"large"}],load(){try{const t=localStorage.getItem(this.storageKey);return t?{...this.defaults,...JSON.parse(t)}:{...this.defaults}}catch{return{...this.defaults}}},save(t){try{localStorage.setItem(this.storageKey,JSON.stringify(t)),this.apply(t)}catch(e){console.warn("Could not save settings:",e)}},get(t){return this.load()[t]},set(t,e){const i=this.load();i[t]=e,this.save(i)},apply(t){var e;(e=window.ELectureNarrator)!=null&&e.setSpeed&&window.ELectureNarrator.setSpeed(t.narrationSpeed),document.body.classList.toggle("reduce-motion",t.reducedMotion),document.body.classList.toggle("high-contrast",t.highContrast),document.body.dataset.fontSize=t.fontSize},render(){const t=this.load();return`
      <div class="settings-panel">
        <div class="settings-header">
          <h3>âš™ï¸ Settings</h3>
          <button class="settings-close" onclick="SettingsPanel.close()">âœ•</button>
        </div>
        <div class="settings-group">
          <label>Narration Speed</label>
          <div class="speed-buttons">
            ${this.speedOptions.map(e=>`
              <button class="speed-btn ${t.narrationSpeed===e.value?"active":""}"
                      onclick="SettingsPanel.set('narrationSpeed', ${e.value})">
                ${e.label}
              </button>
            `).join("")}
          </div>
        </div>
        <div class="settings-group">
          <label class="toggle-label">
            <input type="checkbox" ${t.narrationEnabled?"checked":""}
                   onchange="SettingsPanel.set('narrationEnabled', this.checked)">
            <span>Enable Narration</span>
          </label>
        </div>
        <div class="settings-group">
          <label class="toggle-label">
            <input type="checkbox" ${t.reducedMotion?"checked":""}
                   onchange="SettingsPanel.set('reducedMotion', this.checked)">
            <span>Reduce Motion</span>
          </label>
        </div>
        <div class="settings-group">
          <label class="toggle-label">
            <input type="checkbox" ${t.highContrast?"checked":""}
                   onchange="SettingsPanel.set('highContrast', this.checked)">
            <span>High Contrast</span>
          </label>
        </div>
        <div class="settings-group">
          <label>Font Size</label>
          <div class="font-buttons">
            ${this.fontSizeOptions.map(e=>`
              <button class="font-btn ${t.fontSize===e.value?"active":""}"
                      onclick="SettingsPanel.set('fontSize', '${e.value}')">
                ${e.label}
              </button>
            `).join("")}
          </div>
        </div>
      </div>
    `},show(){let t=document.getElementById("settingsPanelOverlay");t||(t=document.createElement("div"),t.id="settingsPanelOverlay",t.className="settings-overlay",document.body.appendChild(t)),t.innerHTML=this.render(),t.classList.add("active")},close(){const t=document.getElementById("settingsPanelOverlay");t&&t.classList.remove("active")},init(){window.matchMedia("(prefers-reduced-motion: reduce)").matches&&this.set("reducedMotion",!0),this.apply(this.load())}};Xg.init();typeof window<"u"&&(window.FlipCardSync=US,window.SettingsPanel=Xg);const rn={concepts:{},register(t){this.concepts[t.id]=t},get(t){return this.concepts[t]||null},getAll(){return Object.values(this.concepts)},getByCategory(t){return this.getAll().filter(e=>e.category===t)},renderConcept(t){const e=this.get(t);return e?`
      <div class="concept-explanation" data-concept="${e.id}">
        <div class="concept-header">
          <span class="concept-category">${e.category}</span>
          <h2 class="concept-title">${e.title}</h2>
        </div>
        
        <div class="concept-hook">
          <p>${e.hook}</p>
        </div>
        
        <div class="concept-steps" id="conceptSteps">
          ${e.steps.map((i,s)=>`
            <div class="concept-step" data-step="${s}">
              <div class="step-number">${s+1}</div>
              <div class="step-content">
                <h3>${i.title}</h3>
                <p class="step-narration">${i.narration}</p>
                ${i.visual?`<div class="step-visual">${i.visual}</div>`:""}
                ${i.code?`<pre class="step-code"><code>${i.code}</code></pre>`:""}
              </div>
            </div>
          `).join("")}
        </div>
        
        <div class="concept-takeaway">
          <h3>ðŸ’¡ Key Takeaway</h3>
          <p>${e.keyTakeaway}</p>
        </div>
        
        <div class="concept-when-to-use">
          <h3>ðŸŽ¯ When to Use This Pattern</h3>
          <ul>
            ${e.whenToUse.map(i=>`<li>${i}</li>`).join("")}
          </ul>
        </div>
      </div>
    `:""},async playConcept(t){const e=this.get(t);if(e){await this.narrateStep(e.hook);for(const i of e.steps)await this.narrateStep(i.narration);await this.narrateStep(e.keyTakeaway)}},narrateStep(t){return new Promise(e=>{var i;(i=window.ELectureNarrator)!=null&&i.speak?window.ELectureNarrator.speak(t,e):e()})}};rn.register({id:"two-pointer",title:"The Two-Pointer Technique",category:"Array Patterns",hook:"What if I told you there's a way to search through a sorted array without checking every possible pair? A technique so elegant, it reduces a quadratic problem to linear time.",steps:[{title:"The Problem with Brute Force",narration:"Let's say we want to find two numbers that add to a target. The naive way? Check every possible pair. That's O(nÂ²) operations - way too slow for large arrays.",visual:'<div class="visual-comparison"><div class="brute-force">Brute Force: O(nÂ²)</div><div class="optimal">Two Pointers: O(n)</div></div>'},{title:"The Sorted Array Advantage",narration:"But wait - the array is sorted! That's our secret weapon. In a sorted array, values increase as we move right. This property is the key to everything.",visual:'<div class="sorted-array">[1, 3, 5, 7, 9, 11] â†’ Values increase â†’</div>'},{title:"Two Pointers Converging",narration:"Here's the magic. Put a pointer at the start, and one at the end. Add them. If the sum is too small, move the left pointer right for a bigger number. If too big, move the right pointer left for a smaller number. They converge on the answer!",visual:'<div class="pointer-demo"><span class="left-ptr">Lâ†’</span> [1, 3, 5, 7, 9, 11] <span class="right-ptr">â†R</span></div>'},{title:"Why It Works",narration:"Each move eliminates many pairs at once. If 1 + 11 is too big, we know 1 paired with any number won't work - they'd all be too big or we'd have found our answer. One comparison eliminates an entire row of possibilities!",visual:'<div class="elimination">Each move eliminates O(n) possibilities â†’ Total: O(n) time</div>'}],keyTakeaway:"Two pointers work when the array is sorted and we can eliminate half the search space with each decision. It turns O(nÂ²) into O(n).",whenToUse:["The array is sorted","You're looking for a pair with a specific property (sum, difference)","You need to find a subarray with certain characteristics","Problems like Two Sum, Three Sum, Container With Most Water"],relatedProblems:["two-sum-sorted","three-sum","container-with-most-water"]});rn.register({id:"binary-search",title:"Binary Search: Divide and Conquer",category:"Searching Patterns",hook:"Binary search is like playing the number guessing game. Someone picks a number between 1 and 100. You could guess 1, 2, 3... that's 100 guesses worst case. Or you could guess 50, then 25 or 75, and find it in just 7 guesses. That's the power of halving.",steps:[{title:"The Requirement: Sorted Data",narration:"The one requirement is simple: the data must be sorted. With sorted data, each comparison tells us which half contains our answer.",visual:'<div class="sorted-emphasis">[2, 5, 8, 12, 16, 23, 38, 56, 72, 91] âœ“ Sorted</div>'},{title:"The Middle Element",narration:"We start in the middle. If the middle is too big, our answer must be in the left half. If too small, the right half. Either way, we've just eliminated half the search space.",visual:'<div class="binary-visual">[left half] | <span class="mid">middle</span> | [right half]</div>'},{title:"Halving Each Step",narration:"This halving continues until we find our target or run out of elements. Each step cuts the problem in half. That's why it's logarithmic.",code:"n=1000000 elements â†’ only ~20 comparisons needed!"},{title:"The O(log n) Power",narration:"A million elements? Just 20 comparisons. A billion? Only 30. This is the incredible efficiency of logarithmic time. It barely grows even as the input explodes.",visual:'<div class="log-power">100 â†’ 7 steps | 1,000 â†’ 10 steps | 1,000,000 â†’ 20 steps</div>'}],keyTakeaway:"Binary search achieves O(log n) by halving the search space with each comparison. It's one of the most powerful techniques for sorted data.",whenToUse:["The data is sorted (or can be sorted)","You need to find a specific value","You need to find the first/last occurrence","You need to find a boundary (first element >= x)"],relatedProblems:["search-rotated-array","find-peak-element"]});rn.register({id:"sliding-window",title:"The Sliding Window Pattern",category:"Array Patterns",hook:"Imagine looking through a window at a long street. You can only see a portion at a time. As you walk, the window slides, revealing new houses while old ones disappear. This is exactly how sliding window algorithms work!",steps:[{title:"The Window Concept",narration:"In an array, the window is a range of indices. We track two boundaries: the left edge and the right edge. The magic? We efficiently track what's inside without recalculating from scratch.",visual:'<div class="window-visual">[a, b, <span class="window">c, d, e</span>, f, g]</div>'},{title:"Expanding and Contracting",narration:"The right boundary expands to include new elements. When we have too much of something, the left boundary contracts to remove elements. This dance continues until we find our answer.",visual:'<div class="expand-contract">Expand â†’ [....window....] â† Contract</div>'},{title:"Incremental Updates",narration:"The key insight: instead of recalculating from scratch, we update incrementally. Add the new element coming in from the right. Subtract the element leaving from the left. This makes it O(n).",code:"sum = sum + newElement - oldElement  // O(1) update!"}],keyTakeaway:"Sliding window excels when tracking something over a contiguous portion of an array. By updating incrementally, we avoid redundant work and achieve O(n) time.",whenToUse:["Finding maximum/minimum in a contiguous subarray","Finding subarrays with a specific sum or property","Longest substring with certain constraints","Any problem involving 'contiguous' elements"],relatedProblems:["longest-substring-without-repeating","max-sum-subarray"]});rn.register({id:"graph-traversal",title:"Exploring Graphs: BFS vs DFS",category:"Graph Patterns",hook:"Imagine you're exploring a maze. There are two fundamentally different strategies. One explores all immediate neighbors first before going deeper. The other dives as deep as possible before backing up. Both find everything, but in very different orders.",steps:[{title:"BFS: The Ripple Effect",narration:"Breadth-First Search is like a ripple in a pond. You explore everything one step away, then two steps, then three. It's perfect for finding the shortest path because you explore layer by layer.",visual:'<div class="bfs-ripple">Start â†’ Layer 1 â†’ Layer 2 â†’ Layer 3 â†’ ...</div>'},{title:"DFS: The Deep Dive",narration:"Depth-First Search is like following one path as far as it goes. You keep going until you hit a dead end, then backtrack and try another branch. It's perfect for exploring all possibilities.",visual:'<div class="dfs-path">Start â†’ A â†’ B â†’ C â†’ (dead end) â†’ backtrack â†’ D â†’ ...</div>'},{title:"Queue vs Stack",narration:"BFS uses a queue: first in, first out. DFS uses a stack: last in, first out. This single difference creates completely different exploration patterns!",code:`BFS: Queue [a, b, c] â†’ process a first
DFS: Stack [a, b, c] â†’ process c first`},{title:"Choosing the Right Tool",narration:"Use BFS when you need shortest paths or level-by-level processing. Use DFS when you need to explore all paths, detect cycles, or find connected components. Both are O(V+E) time.",visual:'<div class="choice">Shortest path? â†’ BFS | All paths? â†’ DFS</div>'}],keyTakeaway:"BFS explores breadth-first using a queue (shortest paths, levels). DFS explores depth-first using a stack (all paths, backtracking). Choose based on what you need to find.",whenToUse:["BFS: Shortest path in unweighted graphs","BFS: Level-order traversal","DFS: Detecting cycles","DFS: Topological sorting","DFS: Finding connected components"],relatedProblems:["number-of-islands","word-ladder"]});rn.register({id:"dynamic-programming",title:"Dynamic Programming: Remember to Not Repeat",category:"Optimization Patterns",hook:"Dynamic programming sounds scary, but the core idea is beautifully simple. When solving a problem, you often solve the same subproblems over and over again. DP says: solve it once, remember the answer, and look it up next time. That's literally it.",steps:[{title:"The Fibonacci Example",narration:"Let's compute Fibonacci numbers naively. To get F(5), we need F(4) and F(3). F(4) needs F(3) and F(2). Wait - we're computing F(3) twice already! This gets exponentially worse.",code:`F(5) calls F(4) and F(3)
F(4) calls F(3) and F(2)  â† F(3) computed twice!`},{title:"Exponential Explosion",narration:"This tree explodes exponentially. Every level roughly doubles the work. To compute F(50), we'd need trillions of operations. That's completely impractical.",visual:'<div class="explosion">F(10): 177 calls | F(20): 21,891 calls | F(50): 25 billion+ calls!</div>'},{title:"Memoization: Remember Everything",narration:"But what if we remember? Store F(1). Store F(2). When we need F(3), compute it once and store it. Now F(4) just looks up F(3) and F(2) - instant! We go from exponential to linear.",code:`memo = {}
memo[1] = 1, memo[2] = 1
memo[3] = memo[1] + memo[2]  // Look up, don't recompute!`},{title:"Two Approaches",narration:"Top-down (memoization): Start from the main problem, cache as you go. Bottom-up (tabulation): Build from the smallest subproblems up. Both achieve the same result - just different thinking styles.",visual:'<div class="dp-approaches">Top-Down: F(n) â†’ F(n-1) â†’ ... â†’ F(1)<br>Bottom-Up: F(1) â†’ F(2) â†’ ... â†’ F(n)</div>'}],keyTakeaway:"DP = Recursion + Memoization. Identify overlapping subproblems, store their solutions, and avoid redundant work. This often transforms exponential problems into polynomial ones.",whenToUse:["Optimization problems (min/max)","Counting problems (number of ways)","Decision problems (is it possible?)","Problems with overlapping subproblems","Problems with optimal substructure"],relatedProblems:["coin-change","longest-common-subsequence"]});typeof window<"u"&&(window.ConceptLibrary=rn);const VS={activeCategory:"all",getCategories(){const t=new Set;return window.LectureLibrary&&window.LectureLibrary.getAll().forEach(e=>t.add(e.category)),["all",...Array.from(t)]},getLecturesByCategory(t){var i;const e=((i=window.LectureLibrary)==null?void 0:i.getAll())||[];return t==="all"?e:e.filter(s=>s.category===t)},showBrowser(){let t=document.getElementById("lectureBrowserOverlay");t||(t=document.createElement("div"),t.id="lectureBrowserOverlay",t.className="lecture-browser-overlay",document.body.appendChild(t)),t.classList.add("active"),this.renderBrowser()},closeBrowser(){const t=document.getElementById("lectureBrowserOverlay");t&&t.classList.remove("active")},setCategory(t){this.activeCategory=t,this.renderBrowser()},renderBrowser(){var r;const t=document.getElementById("lectureBrowserOverlay");if(!t)return;const e=this.getCategories(),i=this.getLecturesByCategory(this.activeCategory),s=((r=window.ELectureGamification)==null?void 0:r.getProgress())||{level:1,totalXP:0,streak:0,completedLessons:[]};t.innerHTML=`
      <div class="lecture-browser">
        <div class="browser-header">
          <h2>ðŸ“š E-Learning Library</h2>
          <button class="browser-close" onclick="LectureBrowser.closeBrowser()">âœ•</button>
        </div>
        
        <div class="browser-progress-bar">
          <div class="progress-info">
            <span class="level-badge">Level ${s.level}</span>
            <span class="xp-text">${s.totalXP} XP</span>
            <span class="streak-badge">${s.streak>0?"ðŸ”¥ "+s.streak+" day streak":""}</span>
          </div>
          <div class="xp-bar">
            <div class="xp-fill" style="width: ${Math.min(100,s.totalXP/(s.level*100)*100)}%"></div>
          </div>
        </div>
        
        <div class="browser-categories">
          ${e.map(n=>`
            <button class="category-btn ${n===this.activeCategory?"active":""}" 
                    onclick="LectureBrowser.setCategory('${n}')">
              ${n==="all"?"ðŸ“‹ All":this.getCategoryIcon(n)+" "+this.formatCategory(n)}
            </button>
          `).join("")}
          <button class="category-btn practice-problems-btn" 
                  onclick="LectureBrowser.showProblemsModal()" 
                  style="background: linear-gradient(135deg, #22c55e, #16a34a);">
            ðŸ“ Practice Problems
          </button>
        </div>
        
        <div class="browser-lectures">
          ${i.map(n=>{const a=s.completedLessons.includes(n.id),o=n.prerequisiteConcept&&window.ConceptLibrary?window.ConceptLibrary.get(n.prerequisiteConcept):null;return`
              <div class="lecture-card ${a?"completed":""}" onclick="LectureBrowser.startLecture('${n.id}')">
                <div class="card-header">
                  <span class="difficulty-badge ${n.difficulty}">${n.difficulty}</span>
                  ${a?'<span class="completed-badge">âœ“</span>':""}
                </div>
                <h3 class="card-title">${n.title}</h3>
                <p class="card-desc">${n.description}</p>
                <div class="card-meta">
                  <span class="meta-item">â±ï¸ ${n.duration}</span>
                  <span class="meta-item">ðŸ† ${n.xpReward} XP</span>
                </div>
                ${o?`
                  <div class="concept-link" onclick="event.stopPropagation(); LectureBrowser.showConcept('${o.id}')">
                    ðŸ’¡ Learn ${o.title} first
                  </div>
                `:""}
              </div>
            `}).join("")}
        </div>
      </div>
    `},showProblemsModal(){this.closeBrowser(),setTimeout(()=>{var s;let t=document.getElementById("problemsModal");t||(t=document.createElement("div"),t.id="problemsModal",t.className="learning-modal",document.body.appendChild(t));const i=(((s=window.ProblemNarration)==null?void 0:s.getAll())||[]).map(r=>`
        <div class="problem-card" onclick="document.getElementById('problemsModal').classList.remove('active'); ProblemNarration.start('${r.id}');">
          <div class="problem-card-header">
            <span class="problem-card-title">${r.title}</span>
            <span class="problem-difficulty ${r.difficulty.toLowerCase()}">${r.difficulty}</span>
          </div>
          <div class="problem-card-category">${r.category}</div>
          <div class="problem-card-desc">${r.description}</div>
          <div class="problem-card-steps">${r.steps.length} steps</div>
        </div>
      `).join("");t.innerHTML=`
        <div class="learning-modal-content" style="max-width: 700px;">
          <div class="learning-modal-header">
            <h3>ðŸ“ Practice Problems</h3>
            <button class="modal-close" onclick="document.getElementById('problemsModal').classList.remove('active')">âœ•</button>
          </div>
          <div class="problem-grid">
            ${i}
          </div>
        </div>
      `,t.classList.add("active")},100)},getCategoryIcon(t){return{sorting:"ðŸ“Š",searching:"ðŸ”",arrays:"ðŸ“‹",strings:"ðŸ“","dynamic-programming":"ðŸ§©",graphs:"ðŸ•¸ï¸",stacks:"ðŸ“š","linked-lists":"ðŸ”—","two-pointer":"ðŸ‘†","binary-search":"ðŸŽ¯",design:"ðŸ—ï¸"}[t]||"ðŸ“–"},formatCategory(t){return t.split("-").map(e=>e[0].toUpperCase()+e.slice(1)).join(" ")},startLecture(t){var e;this.closeBrowser(),(e=window.ELectureEngineV5)!=null&&e.load&&window.ELectureEngineV5.load(t)},showConcept(t){var s;if(!((s=window.ConceptLibrary)==null?void 0:s.get(t)))return;let i=document.getElementById("conceptModal");i||(i=document.createElement("div"),i.id="conceptModal",i.className="concept-modal-overlay",document.body.appendChild(i)),i.classList.add("active"),i.innerHTML=`
      <div class="concept-modal">
        <button class="modal-close" onclick="document.getElementById('conceptModal').classList.remove('active')">âœ•</button>
        ${window.ConceptLibrary.renderConcept(t)}
        <div class="concept-actions">
          <button class="play-concept-btn" onclick="ConceptLibrary.playConcept('${t}')">
            ðŸŽ™ï¸ Listen to Explanation
          </button>
          <button class="close-btn" onclick="document.getElementById('conceptModal').classList.remove('active')">
            Got it!
          </button>
        </div>
      </div>
    `}};typeof window<"u"&&(window.LectureBrowser=VS);function zS(t,e=null){if(!t)return null;const i=t.getBoundingClientRect(),s=i.width,r=i.height;if(s===0||r===0)return null;const n=t.getContext("2d"),a=window.devicePixelRatio||1;return t.width!==s*a||t.height!==r*a?(t.width=s*a,t.height=r*a,n.scale(a,a)):n.setTransform(a,0,0,a,0,0),e?(n.fillStyle=e,n.fillRect(0,0,s,r)):n.clearRect(0,0,s,r),{ctx:n,w:s,h:r}}const N={arrayData:[5,12,8,3,15,7],stackData:[4,23,8,15],queueData:[3,7,12,5],linkedListData:[5,12,8,3],linkedListType:"singly",bstRoot:null,hashTable:{name:"Alice",age:"25",city:"NYC"},heapData:[50,30,40,10,15,35,25],heapType:"max",highlighted:{structure:null,index:-1},initBST(){this.bstRoot=null,[10,5,15,3,7,12,18].forEach(t=>this.bstInsertNode(t))},bstInsertNode(t){const e={value:t,left:null,right:null};if(!this.bstRoot){this.bstRoot=e;return}let i=this.bstRoot;for(;;)if(t<i.value){if(!i.left){i.left=e;return}i=i.left}else{if(!i.right){i.right=e;return}i=i.right}},bstInOrder(t=this.bstRoot,e=[]){return t&&(this.bstInOrder(t.left,e),e.push(t.value),this.bstInOrder(t.right,e)),e},bstDeleteNode(t,e){if(!t)return null;if(e<t.value)return t.left=this.bstDeleteNode(t.left,e),t;if(e>t.value)return t.right=this.bstDeleteNode(t.right,e),t;if(!t.left)return t.right;if(!t.right)return t.left;let i=t,s=t.right;for(;s.left;)i=s,s=s.left;return i!==t?i.left=s.right:i.right=s.right,t.value=s.value,t},simpleHash(t,e=7){let i=0;for(let s=0;s<t.length;s++)i=(i*31+t.charCodeAt(s))%e;return Math.abs(i)},heapBubbleUp(t){for(;t>0;){const e=Math.floor((t-1)/2);if(!(this.heapType==="max"?this.heapData[t]>this.heapData[e]:this.heapData[t]<this.heapData[e]))break;[this.heapData[t],this.heapData[e]]=[this.heapData[e],this.heapData[t]],t=e}},heapBubbleDown(t){const e=this.heapData.length;for(;;){let i=t;const s=2*t+1,r=2*t+2;if(this.heapType==="max"?(s<e&&this.heapData[s]>this.heapData[i]&&(i=s),r<e&&this.heapData[r]>this.heapData[i]&&(i=r)):(s<e&&this.heapData[s]<this.heapData[i]&&(i=s),r<e&&this.heapData[r]<this.heapData[i]&&(i=r)),i===t)break;[this.heapData[t],this.heapData[i]]=[this.heapData[i],this.heapData[t]],t=i}},heapify(){for(let t=Math.floor(this.heapData.length/2)-1;t>=0;t--)this.heapBubbleDown(t)},formatValue(t,e,i,s){let r=String(e);return t.measureText(r).width>i?r.slice(0,4)+"..":r},updateHashPreview(t){const e=this.simpleHash(t||"",7),i=v("hashNextVal");i&&(i.textContent=e)},hash:{put(){var s,r,n,a,o;const t=(r=(s=v("hashKey"))==null?void 0:s.value)==null?void 0:r.trim(),e=(a=(n=v("hashValue"))==null?void 0:n.value)==null?void 0:a.trim();if(!t||!e){T("Enter both Key and Value!","error");return}const i=N.simpleHash(t,7);N.hashTable[t]=e,N.highlighted={structure:"hash",index:i,key:t},N.renderHash(),(o=O.play)==null||o.call(O,"ds_insert"),T(`âœ“ Put "${t}" in Bucket ${i}`),v("hashValue")&&(v("hashValue").value=""),v("hashKey")&&v("hashKey").focus(),setTimeout(()=>{N.highlighted={},N.renderHash()},1500)},get(){var i,s,r,n;const t=(s=(i=v("hashKey"))==null?void 0:i.value)==null?void 0:s.trim();if(!t){T("Enter a Key to find!","error");return}const e=N.simpleHash(t,7);if(N.hashTable.hasOwnProperty(t)){const a=N.hashTable[t];N.highlighted={structure:"hash",index:e,key:t},N.renderHash(),(r=O.play)==null||r.call(O,"ds_found"),T(`âœ“ Found "${t}": ${a}`)}else N.highlighted={structure:"hash",index:e},N.renderHash(),(n=O.play)==null||n.call(O,"ds_not_found"),T(`Key "${t}" not found in Bucket ${e}!`,"error");setTimeout(()=>{N.highlighted={},N.renderHash()},1500)},remove(){var e,i,s;const t=(i=(e=v("hashKey"))==null?void 0:e.value)==null?void 0:i.trim();if(!t){T("Enter a Key to remove!","error");return}if(N.hashTable.hasOwnProperty(t)){const r=N.simpleHash(t,7);delete N.hashTable[t],N.highlighted={structure:"hash",index:r},N.renderHash(),(s=O.play)==null||s.call(O,"ds_remove"),T(`âœ“ Removed "${t}"`)}else T(`Key "${t}" not found!`,"error");setTimeout(()=>{N.highlighted={},N.renderHash()},1500)}},stack:{push(){var e,i;const t=parseInt((e=v("stackInput"))==null?void 0:e.value);if(Number.isNaN(t)){T("Enter a value!","error");return}N.stackData.push(t),N.highlighted={structure:"stack",index:N.stackData.length-1},N.renderAll(),(i=O.play)==null||i.call(O,"ds_insert"),T(`âœ“ Pushed ${t}`),v("stackInput")&&(v("stackInput").value=""),setTimeout(()=>{N.highlighted={},N.renderStack()},1200)},pop(){var e;if(N.stackData.length===0){T("Stack is empty!","error");return}const t=N.stackData.pop();N.renderAll(),(e=O.play)==null||e.call(O,"ds_remove"),T(`âœ“ Popped ${t}`)},peek(){var t;if(N.stackData.length===0){T("Stack is empty!","error");return}N.highlighted={structure:"stack",index:N.stackData.length-1},N.renderStack(),(t=O.play)==null||t.call(O,"ds_found"),T(`Top: ${N.stackData[N.stackData.length-1]}`),setTimeout(()=>{N.highlighted={},N.renderStack()},1800)}},queue:{enqueue(){var e,i;const t=parseInt((e=v("queueInput"))==null?void 0:e.value);if(Number.isNaN(t)){T("Enter a value!","error");return}N.queueData.push(t),N.highlighted={structure:"queue",index:N.queueData.length-1},N.renderAll(),(i=O.play)==null||i.call(O,"ds_insert"),T(`âœ“ Enqueued ${t}`),v("queueInput")&&(v("queueInput").value=""),setTimeout(()=>{N.highlighted={},N.renderQueue()},1200)},dequeue(){var e;if(N.queueData.length===0){T("Queue is empty!","error");return}const t=N.queueData.shift();N.renderAll(),(e=O.play)==null||e.call(O,"ds_remove"),T(`âœ“ Dequeued ${t}`)},front(){var t;if(N.queueData.length===0){T("Queue is empty!","error");return}N.highlighted={structure:"queue",index:0},N.renderQueue(),(t=O.play)==null||t.call(O,"ds_found"),T(`Front: ${N.queueData[0]}`),setTimeout(()=>{N.highlighted={},N.renderQueue()},1800)}},array:{validateNumericInput(t,e,i={}){var o;const s=(o=t==null?void 0:t.value)==null?void 0:o.trim();if(!s||s==="")return{valid:!1,error:`Enter a ${e}!`};if(!/^-?\d+$/.test(s))return{valid:!1,error:`${e} must be a number!`};const r=parseInt(s),n=i.min??(t!=null&&t.min?parseInt(t.min):-1/0),a=i.max??(t!=null&&t.max?parseInt(t.max):1/0);return r<n||r>a?{valid:!1,error:`${e} must be between ${n} and ${a}!`}:{valid:!0,value:r}},insert(){var r,n,a;const t=this.validateNumericInput(v("arrayInput"),"value");if(!t.valid){T(t.error,"error");return}const e=t.value;if(e<-999||e>999){T("Value must be between -999 and 999!","error");return}const i=this.validateNumericInput(v("arrayIndex"),"index");let s=!i.valid&&((n=(r=v("arrayIndex"))==null?void 0:r.value)==null?void 0:n.trim())===""?N.arrayData.length:i.value;if(s<0||s>N.arrayData.length){T(`Index out of bounds! Valid: 0-${N.arrayData.length}`,"error");return}N.arrayData.splice(s,0,e),N.highlighted={structure:"array",index:s},N.renderAll(),(a=O.play)==null||a.call(O,"ds_insert"),T(`âœ“ Inserted ${e} at index ${s}`),v("arrayInput")&&(v("arrayInput").value=""),v("arrayIndex")&&(v("arrayIndex").value=""),setTimeout(()=>{N.highlighted={},N.renderArray()},1200)},remove(){var s,r,n;if(N.arrayData.length===0){T("Array is empty!","error");return}const t=this.validateNumericInput(v("arrayIndex"),"index");let e=!t.valid&&((r=(s=v("arrayIndex"))==null?void 0:s.value)==null?void 0:r.trim())===""?N.arrayData.length-1:t.value;if(e<0||e>=N.arrayData.length){T("Index out of bounds!","error");return}const i=N.arrayData.splice(e,1)[0];N.renderAll(),(n=O.play)==null||n.call(O,"ds_remove"),T(`âœ“ Removed ${i}`),v("arrayIndex")&&(v("arrayIndex").value="")},search(){var i,s;const t=this.validateNumericInput(v("arrayInput"),"value");if(!t.valid){T(t.error,"error");return}const e=N.arrayData.indexOf(t.value);e>=0?(N.highlighted={structure:"array",index:e},N.renderArray(),(i=O.play)==null||i.call(O,"ds_found"),T(`âœ“ Found at index ${e}`),setTimeout(()=>{N.highlighted={},N.renderArray()},1800)):((s=O.play)==null||s.call(O,"ds_not_found"),T("Not found!","error"))},update(){var n;const t=this.validateNumericInput(v("arrayInput"),"value");if(!t.valid){T(t.error,"error");return}const e=t.value;if(e<-999||e>999){T("Value must be between -999 and 999!","error");return}const i=this.validateNumericInput(v("arrayIndex"),"index");if(!i.valid){T("Enter an index to update!","error");return}const s=i.value;if(s<0||s>=N.arrayData.length){T(`Index out of bounds! Valid: 0-${N.arrayData.length-1}`,"error");return}const r=N.arrayData[s];N.arrayData[s]=e,N.highlighted={structure:"array",index:s},N.renderAll(),(n=O.play)==null||n.call(O,"ds_insert"),T(`âœ“ Updated index ${s}: ${r} â†’ ${e}. O(1) operation!`),v("arrayInput")&&(v("arrayInput").value=""),v("arrayIndex")&&(v("arrayIndex").value=""),setTimeout(()=>{N.highlighted={},N.renderArray()},1200)}},linkedList:{insert(){var s,r,n;const t=parseInt((s=v("llInput"))==null?void 0:s.value),e=parseInt((r=v("llIndex"))==null?void 0:r.value);if(Number.isNaN(t)){T("Enter a value!","error");return}const i=Number.isNaN(e)?N.linkedListData.length:Math.min(Math.max(0,e),N.linkedListData.length);N.linkedListData.splice(i,0,t),N.highlighted={structure:"linkedlist",index:i},N.renderAll(),(n=O.play)==null||n.call(O,"ds_insert"),T(`âœ“ Inserted ${t}`),v("llInput")&&(v("llInput").value=""),v("llIndex")&&(v("llIndex").value=""),setTimeout(()=>{N.highlighted={},N.renderLinkedList()},1200)},remove(){var s,r;const t=parseInt((s=v("llIndex"))==null?void 0:s.value);if(N.linkedListData.length===0){T("List is empty!","error");return}const e=Number.isNaN(t)?N.linkedListData.length-1:Math.min(Math.max(0,t),N.linkedListData.length-1),i=N.linkedListData.splice(e,1)[0];N.renderAll(),(r=O.play)==null||r.call(O,"ds_remove"),T(`âœ“ Removed ${i}`)}},bst:{init(t,e){this.bstRoot=null,e&&Array.isArray(e)?e.forEach(i=>this.bstInsertNode(i)):[10,5,15,3,7,12,18].forEach(i=>this.bstInsertNode(i)),setTimeout(()=>N.renderBST(),100)},highlightNode(t){if(!t||!t.data)return;const e=t.data.value;e!==void 0&&(N.highlighted={structure:"bst",index:e},N.renderBST())},insert(){var e,i;const t=parseInt((e=v("bstInput"))==null?void 0:e.value);if(Number.isNaN(t)){T("Enter a value!","error");return}if(N.bstInOrder().includes(t)){T("Already exists!","error");return}N.bstInsertNode(t),N.highlighted={structure:"bst",index:t},N.renderAll(),(i=O.play)==null||i.call(O,"ds_insert"),T(`âœ“ Inserted ${t}`),v("bstInput")&&(v("bstInput").value=""),setTimeout(()=>{N.highlighted={},N.renderBST()},1200)},search(){var e,i,s;const t=parseInt((e=v("bstInput"))==null?void 0:e.value);if(Number.isNaN(t)){T("Enter a value!","error");return}N.bstInOrder().includes(t)?(N.highlighted={structure:"bst",index:t},N.renderBST(),(i=O.play)==null||i.call(O,"ds_found"),T(`âœ“ Found ${t}!`),setTimeout(()=>{N.highlighted={},N.renderBST()},1800)):((s=O.play)==null||s.call(O,"ds_not_found"),T("Not found!","error"))},delete(){var e,i;const t=parseInt((e=v("bstInput"))==null?void 0:e.value);if(Number.isNaN(t)){T("Enter a value!","error");return}if(!N.bstInOrder().includes(t)){T("Not found!","error");return}N.bstRoot=N.bstDeleteNode(N.bstRoot,t),N.renderAll(),(i=O.play)==null||i.call(O,"ds_remove"),T(`âœ“ Deleted ${t}`)},traverseAnimated(t){const e=[],i=[];function s(l,c){l&&(c==="preorder"?(i.push(l.value),s(l.left,c),s(l.right,c)):c==="inorder"?(s(l.left,c),i.push(l.value),s(l.right,c)):c==="postorder"&&(s(l.left,c),s(l.right,c),i.push(l.value)))}if(s(N.bstRoot,t),i.length===0){T("Tree is empty!","error");return}const r=v("bstCanvas");r&&r.scrollIntoView({behavior:"smooth",block:"center"});const n=t==="preorder"?"Pre-order":t==="inorder"?"In-order":"Post-order";T(`ðŸš¶ ${n} traversal started...`),v("bstState")&&(v("bstState").textContent="[]",v("bstState").style.color="var(--accent-forest)");let a=0;function o(){var c,h;if(a>=i.length){N.highlighted={},N.renderBST(),v("bstState")&&(v("bstState").textContent=`[${e.join(", ")}]`,v("bstState").style.color=""),T(`âœ“ ${n}: ${e.join(" â†’ ")}`),(c=O.play)==null||c.call(O,"sort_complete");return}const l=i[a];if(e.push(l),N.highlighted={structure:"bst",index:l},N.renderBST(),v("bstState")){const d=e.map((u,p)=>p===e.length-1?`â†’${u}â†`:u);v("bstState").textContent=`[${d.join(", ")}]`}(h=O.play)==null||h.call(O,"slider_tick"),a++,setTimeout(o,800)}o()}},hash:{put(){var i,s,r;const t=(i=v("hashKey"))==null?void 0:i.value.trim(),e=(s=v("hashValue"))==null?void 0:s.value.trim();if(!t){T("Enter a key!","error");return}N.hashTable[t]=e||"null",N.highlighted={structure:"hash",index:t},N.renderAll(),(r=O.play)==null||r.call(O,"ds_insert"),T(`âœ“ Set "${t}"`),v("hashKey")&&(v("hashKey").value=""),v("hashValue")&&(v("hashValue").value=""),setTimeout(()=>{N.highlighted={},N.renderHash()},1200)},get(){var e,i,s;const t=(e=v("hashKey"))==null?void 0:e.value.trim();if(!t){T("Enter a key!","error");return}N.hashTable[t]!==void 0?(N.highlighted={structure:"hash",index:t},N.renderHash(),(i=O.play)==null||i.call(O,"ds_found"),T(`"${t}" = "${N.hashTable[t]}"`),setTimeout(()=>{N.highlighted={},N.renderHash()},1800)):((s=O.play)==null||s.call(O,"ds_not_found"),T("Key not found!","error"))},remove(){var e,i;const t=(e=v("hashKey"))==null?void 0:e.value.trim();if(!t){T("Enter a key!","error");return}N.hashTable[t]!==void 0?(delete N.hashTable[t],N.renderAll(),(i=O.play)==null||i.call(O,"ds_remove"),T(`âœ“ Removed "${t}"`)):T("Key not found!","error")}},heap:{insert(){var e,i;const t=parseInt((e=v("heapInput"))==null?void 0:e.value);if(isNaN(t)){T("Enter a valid number!","error");return}N.heapData.push(t),N.heapBubbleUp(N.heapData.length-1),N.highlighted={structure:"heap",index:N.heapData.length-1},N.renderHeap(),v("heapState")&&(v("heapState").textContent=`[${N.heapData.join(", ")}]`),(i=O.play)==null||i.call(O,"ds_insert"),T(`âœ“ Inserted ${t}`),v("heapInput")&&(v("heapInput").value=""),setTimeout(()=>{N.highlighted={},N.renderHeap()},1200)},extractRoot(){var i;if(N.heapData.length===0){T("Heap is empty!","error");return}const t=N.heapData[0],e=N.heapData.pop();N.heapData.length>0&&(N.heapData[0]=e,N.heapBubbleDown(0)),N.renderHeap(),v("heapState")&&(v("heapState").textContent=`[${N.heapData.join(", ")}]`),(i=O.play)==null||i.call(O,"ds_remove"),T(`âœ“ Extracted ${t}`)},peek(){var t;if(N.heapData.length===0){T("Heap is empty!","error");return}N.highlighted={structure:"heap",index:0},N.renderHeap(),(t=O.play)==null||t.call(O,"ds_found"),T(`Root: ${N.heapData[0]}`),setTimeout(()=>{N.highlighted={},N.renderHeap()},1800)}},renderAll(){this.renderArray(),this.renderStack(),this.renderQueue(),this.renderLinkedList(),this.renderBST(),this.renderHash(),this.renderHeap(),this.updateStates()},updateStates(){v("arrayState")&&(v("arrayState").textContent=`[${this.arrayData.join(", ")}]`),v("stackState")&&(v("stackState").textContent=`[${[...this.stackData].reverse().join(", ")}]`),v("queueState")&&(v("queueState").textContent=`[${this.queueData.join(", ")}]`),v("llState")&&(v("llState").textContent=this.linkedListData.join(" â†’ ")+" â†’ null"),v("bstState")&&(v("bstState").textContent=`[${this.bstInOrder().join(", ")}]`),v("hashState")&&(v("hashState").textContent=JSON.stringify(this.hashTable)),v("heapState")&&(v("heapState").textContent=`[${this.heapData.join(", ")}]`)},renderCanvas(t,e){const i=v(t);if(!i)return;const s=zS(i);s?e(s.ctx,s.w,s.h):requestAnimationFrame(()=>this.renderCanvas(t,e))},formatValue(t,e,i,s=14){const r=String(e);if(t.font=`bold ${s}px Inter`,t.measureText(r).width<=i-8)return r;const a=Number(e);if(!isNaN(a)&&Math.abs(a)>=1e3){const l=a.toExponential(1);if(t.measureText(l).width<=i-8)return l;const c=a.toExponential(0);if(t.measureText(c).width<=i-8)return c}let o=r;for(;o.length>1&&t.measureText(o+"â€¦").width>i-8;)o=o.slice(0,-1);return o.length<r.length?o+"â€¦":r.charAt(0)+"â€¦"},renderArray(){this.renderCanvas("arrayCanvas",(t,e,i)=>{const s=v("arrayCanvas");s&&s.setAttribute("aria-label",`Array visualization: ${this.arrayData.length} elements. Values: ${this.arrayData.join(", ")}`);const r=this.arrayData;if(r.length===0){t.fillStyle="#888",t.font="italic 16px Inter",t.textAlign="center",t.fillText("Array is empty",e/2,i/2);return}const n=40,a=90,l=e-60-60;let c=Math.min(a,l/r.length),h=r,d=0,u=c;if(c<n){const y=Math.floor(l/n);h=r.slice(0,y),d=r.length-y,u=n}const p=Math.min(70,u*.85),f=h.length*u+(d>0?50:0),g=(e-f)/2,m=(i-p)/2+10;if(t.fillStyle="rgba(95, 102, 99, 0.7)",t.font="bold 12px JetBrains Mono",t.textAlign="center",t.fillText("Memory blocks (contiguous)",e/2,m-25),t.strokeStyle="rgba(95, 102, 99, 0.3)",t.beginPath(),t.moveTo(g,m-8),t.lineTo(g+f,m-8),t.stroke(),h.forEach((y,b)=>{const w=g+b*u,k=this.highlighted.structure==="array"&&this.highlighted.index===b;k?(t.shadowColor="rgba(47, 106, 87, 0.4)",t.shadowBlur=15,t.shadowOffsetY=4):(t.shadowColor="rgba(0,0,0,0.1)",t.shadowBlur=4,t.shadowOffsetY=2),t.fillStyle=k?"#2F6A57":"#FFFFFF",t.strokeStyle="#2F6A57",t.lineWidth=k?3:2,t.beginPath();const x=w+3,E=u-6;t.roundRect(x,m,E,p,12),t.fill(),t.shadowColor="transparent",t.stroke(),t.fillStyle=k?"#FFF":"#1F2322";const _=Math.max(14,Math.min(24,u/2.5));t.font=`bold ${_}px Inter`,t.textAlign="center",t.textBaseline="middle";const R=this.formatValue(t,y,E-8,_);t.fillText(R,w+u/2,m+p/2),u>=30&&(t.fillStyle="#5F6663",t.font="10px JetBrains Mono",t.textBaseline="bottom",t.fillText(`0x${(1e3+b).toString(16)}`,w+u/2,m-4),t.font="bold 12px Inter",t.textBaseline="top",t.fillText(b,w+u/2,m+p+8))}),d>0){const y=g+h.length*u+25;t.fillStyle="#8B687F",t.beginPath(),t.roundRect(y-20,m+p/2-15,40,30,15),t.fill(),t.fillStyle="#FFF",t.font="bold 12px Inter",t.textAlign="center",t.textBaseline="middle",t.fillText(`+${d}`,y,m+p/2)}})},renderStack(){this.renderCanvas("stackCanvas",(t,e,i)=>{const s=v("stackCanvas");if(s){const g=this.stackData.length>0?this.stackData[this.stackData.length-1]:"empty";s.setAttribute("aria-label",`Stack visualization: ${this.stackData.length} elements. Top is ${g}.`)}const r=this.stackData;if(r.length===0)return;const n=180,a=i-40,o=(e-n)/2,l=a-40,c=40,h=4,d=Math.floor((l-20)/(c+h));let u=r,p=0,f=0;r.length>d&&(u=r.slice(r.length-d),p=r.length-d,f=p),t.strokeStyle="#5F6663",t.lineWidth=4,t.beginPath(),t.moveTo(o-30,a),t.lineTo(o+n+30,a),t.stroke(),p>0&&(t.fillStyle="#5F6663",t.font="italic 11px Inter",t.textAlign="center",t.fillText(`... ${p} more items below ...`,e/2,a-u.length*(c+h)-10)),u.forEach((g,m)=>{const y=a-(m+1)*(c+h);if(y<0)return;const b=m===u.length-1,w=f+m,k=this.highlighted.structure==="stack"&&this.highlighted.index===w;t.fillStyle=k?"#2F6A57":b?"#E8E0D4":"#F9FAFB",t.strokeStyle=k?"#2F6A57":b?"#8B687F":"#D1D5DB",t.lineWidth=2,t.shadowColor=k?"rgba(47, 106, 87, 0.4)":"rgba(0,0,0,0.05)",t.shadowBlur=10,t.shadowOffsetY=4,t.beginPath(),t.roundRect(o,y,n,c,8),t.fill(),t.shadowColor="transparent",t.stroke(),t.fillStyle=k?"#FFF":"#1F2937";const x=16;t.font=`bold ${x}px Inter`,t.textAlign="center",t.textBaseline="middle";const E=this.formatValue(t,g,n-20,x);t.fillText(E,o+n/2,y+c/2),t.fillStyle="#9CA3AF",t.font="11px JetBrains Mono",t.textAlign="left",t.fillText(`[${w}]`,o+n+15,y+c/2),b&&(t.fillStyle="#8B687F",t.font="bold 12px Inter",t.textAlign="right",t.fillText("TOP",o-15,y+c/2))})})},renderQueue(){this.renderCanvas("queueCanvas",(t,e,i)=>{const s=v("queueCanvas");if(s){const y=this.queueData.length>0?this.queueData[0]:"empty";s.setAttribute("aria-label",`Queue visualization: ${this.queueData.length} elements. Front is ${y}.`)}const r=this.queueData;if(r.length===0){t.fillStyle="#888",t.font="italic 16px Inter",t.textAlign="center",t.fillText("Queue is empty",e/2,i/2);return}const n=60,a=10,o=40,l=70,c=e-100;let h=Math.min(l,(c+a)/r.length-a),d=r,u=0;if(h<o){const y=Math.floor((c+a)/(o+a));d=r.slice(0,y),u=r.length-y,h=o}const p=d.length*h+(d.length-1)*a,f=(e-p)/2,g=(i-n)/2;t.strokeStyle="rgba(91, 139, 160, 0.2)",t.lineWidth=4,t.beginPath(),t.moveTo(f-20,g+n/2),t.lineTo(f+p+20,g+n/2),t.stroke(),t.fillStyle="#D4A853",t.font="bold 12px Inter",t.textAlign="right",t.fillText("FRONT â†’",f-10,g+n/2),d.forEach((y,b)=>{const w=f+b*(h+a),k=b===0,x=this.highlighted.structure==="queue"&&this.highlighted.index===b;t.shadowColor=x?"rgba(212, 168, 83, 0.4)":"rgba(0,0,0,0.1)",t.shadowBlur=10,t.shadowOffsetY=4,t.fillStyle=x?"#D4A853":k?"#FFF9E8":"#FFFEFA",t.strokeStyle=k?"#D4A853":"#5B8BA0",t.lineWidth=2,t.beginPath(),t.roundRect(w,g,h,n,12),t.fill(),t.shadowColor="transparent",t.stroke(),t.fillStyle=k?"#D4A853":"#1F2322";const E=Math.max(12,Math.min(20,h/2.5));t.font=`bold ${E}px Inter`,t.textAlign="center",t.textBaseline="middle";const _=this.formatValue(t,y,h-8,E);t.fillText(_,w+h/2,g+n/2),h>30&&(t.fillStyle="#9CA3AF",t.font="10px JetBrains Mono",t.fillText(b,w+h/2,g+n+12))});const m=f+p;u>0?(t.fillStyle="#8B687F",t.beginPath(),t.roundRect(m+10,g+n/2-12,50,24,12),t.fill(),t.fillStyle="#FFF",t.font="bold 11px Inter",t.fillText(`+${u}`,m+35,g+n/2),t.fillStyle="#5B8BA0",t.font="bold 12px Inter",t.textAlign="left",t.fillText("â† BACK",m+70,g+n/2)):(t.fillStyle="#5B8BA0",t.font="bold 12px Inter",t.textAlign="left",t.fillText("â† BACK",m+10,g+n/2))})},renderLinkedList(){this.renderCanvas("linkedListCanvas",(t,e,i)=>{const s=this.linkedListData,r=this.linkedListType||"singly",n=v("linkedListCanvas");if(n&&n.setAttribute("aria-label",`Linked List (${r}) visualization with ${s.length} nodes.`),s.length===0){t.fillStyle="#888",t.font="italic 16px Inter",t.textAlign="center",t.fillText("List is empty",e/2,i/2);return}const a=60,o=40,l=40,c=60,h=r==="doubly"||r==="doubly-circular",d=r==="circular"||r==="doubly-circular",u=r==="dummy-head",p=s.length+(u?1:0),f=p*a+(p-1)*l;let g=s,m=0,y=(e-f)/2;if(f>e-c*2){y=c;const E=Math.floor((e-c*2)/(a+l)),_=u?E-1:E;g=s.slice(0,_),m=s.length-g.length}const b=(i-o)/2;let w=y;u&&(t.fillStyle="#E5E7EB",t.strokeStyle="#9CA3AF",t.setLineDash([4,2]),t.lineWidth=2,t.beginPath(),t.roundRect(w,b,a,o,8),t.fill(),t.stroke(),t.setLineDash([]),t.fillStyle="#6B7280",t.font="bold 10px Inter",t.textAlign="center",t.textBaseline="middle",t.fillText("DUMMY",w+a/2,b+o/2),g.length>0&&this.drawArrow(t,w+a,b+o/2,w+a+l,b+o/2,!1),w+=a+l),g.forEach((E,_)=>{const R=w+_*(a+l),C=this.highlighted.structure==="linkedlist"&&this.highlighted.index===_;t.shadowColor=C?"rgba(91, 139, 160, 0.4)":"rgba(0,0,0,0.1)",t.shadowBlur=10,t.shadowOffsetY=4,t.fillStyle=C?"#5B8BA0":"#FFFEFA",t.strokeStyle="#5B8BA0",t.lineWidth=2,t.beginPath(),t.roundRect(R,b,a,o,12),t.fill(),t.shadowColor="transparent",t.stroke(),t.fillStyle=C?"#FFF":"#1F2322";const D=Math.max(12,Math.min(18,a/2.5));t.font=`bold ${D}px Inter`,t.textAlign="center",t.textBaseline="middle";const q=this.formatValue(t,E,a-8,D);if(t.fillText(q,R+a/2,b+o/2),_<g.length-1){const A=R+a,F=R+a+l,L=h?-6:0;this.drawArrow(t,A,b+o/2+L,F,b+o/2+L,!1)}if(h&&_>0){const A=R,F=R-l,L=6;this.drawArrow(t,A,b+o/2+L,F,b+o/2+L,!0,"#A08B5B")}});const k=w+(g.length-1)*(a+l);if(!d&&m===0){const E=k+a+10;t.fillStyle="#6B7280",t.font="bold 12px Inter",t.textAlign="left",t.fillText("null",E,b+o/2),t.beginPath(),t.moveTo(k+a,b+o/2),t.lineTo(E-5,b+o/2),t.strokeStyle="#9CA3AF",t.lineWidth=2,t.stroke()}if(d&&g.length>0&&m===0){const E=u?y+a+l:y,_=k+a;t.strokeStyle="#6BA05B",t.lineWidth=2,t.setLineDash([5,5]),t.beginPath();const R=(_+E)/2,C=50;t.moveTo(_,b+o/2),t.quadraticCurveTo(_+20,b+o+C,R,b+o+C),t.quadraticCurveTo(E-20,b+o+C,E,b+o/2+0),t.stroke(),t.setLineDash([]),this.drawArrowHead(t,E,b+o/2+20,-Math.PI/2,"#6BA05B")}if(m>0){const E=k+a+l;t.fillStyle="#8B687F",t.beginPath(),t.roundRect(E,b+o/2-12,60,24,12),t.fill(),t.fillStyle="#FFF",t.font="bold 11px Inter",t.textAlign="center",t.fillText(`+${m} more`,E+30,b+o/2)}const x=u?y+a+l+a/2:y+a/2;t.fillStyle="#5B8BA0",t.font="bold 11px Inter",t.textAlign="center",g.length>0&&t.fillText("HEAD",x,b-12)})},drawArrow(t,e,i,s,r,n,a="#5B8BA0"){t.strokeStyle=a,t.fillStyle=a,t.lineWidth=2,t.beginPath(),t.moveTo(e,i),t.lineTo(s,r),t.stroke();const o=Math.atan2(r-i,s-e);this.drawArrowHead(t,s,r,o,a)},drawArrowHead(t,e,i,s,r){t.fillStyle=r,t.beginPath(),t.moveTo(e,i),t.lineTo(e-8*Math.cos(s-Math.PI/6),i-8*Math.sin(s-Math.PI/6)),t.lineTo(e-8*Math.cos(s+Math.PI/6),i-8*Math.sin(s+Math.PI/6)),t.fill()},renderBST(){this.renderCanvas("bstCanvas",(t,e,i)=>{const s=v("bstCanvas");if(s){const C=this.bstRoot?"non-empty":"empty";s.setAttribute("aria-label",`Binary Search Tree visualization. Tree is ${C}.`)}if(!this.bstRoot){t.fillStyle="#888",t.font="italic 16px Inter",t.textAlign="center",t.fillText("Tree is empty",e/2,i/2);return}const r=new Map,n=25,a=70;let o=1/0,l=-1/0,c=0;const h=(C,D,q,A,F)=>{if(!C)return;o=Math.min(o,D-n),l=Math.max(l,D+n),c=Math.max(c,q+n),r.set(C.value,{x:D,y:q});const L=Math.max(n*1.5,F/2);h(C.left,D-F,q+a,A+1,L),h(C.right,D+F,q+a,A+1,L)},d=C=>C?1+Math.max(d(C.left),d(C.right)):0,u=d(this.bstRoot),p=Math.pow(2,Math.max(u-2,0))*(n*3);h(this.bstRoot,0,n+20,0,p);const f=40,g=l-o,m=c,y=(e-f*2)/Math.max(g,1),b=(i-f*2)/Math.max(m,1);let w=Math.min(y,b,1.2);t.save();const k=(o+l)/2,x=e/2-k*w;t.translate(x,20),t.scale(w,w);const _=C=>{if(!C)return;const{x:D,y:q}=r.get(C.value);if(C.left){const A=r.get(C.left.value);this.drawTreeEdge(t,D,q,A.x,A.y),_(C.left)}if(C.right){const A=r.get(C.right.value);this.drawTreeEdge(t,D,q,A.x,A.y),_(C.right)}};_(this.bstRoot);const R=C=>{if(!C)return;const{x:D,y:q}=r.get(C.value),A=this.highlighted.structure==="bst"&&this.highlighted.index===C.value,F=this.highlighted.path&&this.highlighted.path.includes(C.value);if(t.shadowColor=A?"rgba(47, 106, 87, 0.4)":"rgba(0,0,0,0.2)",t.shadowBlur=10,t.shadowOffsetY=4,t.beginPath(),t.arc(D,q,n,0,Math.PI*2),t.fillStyle=A?"#2F6A57":F?"#E8F5E9":"#FFFEFA",t.fill(),t.shadowColor="transparent",t.lineWidth=A?3:2,t.strokeStyle=A?"#2F6A57":F?"#66BB6A":"#2F6A57",t.stroke(),t.fillStyle=A?"#FFF":"#1F2322",t.textAlign="center",t.textBaseline="middle",t.font="bold 14px Inter",t.fillText(C.value,D,q),C===this.bstRoot){const L=v("bstRootVal");L&&L.textContent!=C.value&&(L.textContent=C.value)}R(C.left),R(C.right)};R(this.bstRoot),t.restore()})},drawTreeEdge(t,e,i,s,r){t.strokeStyle="#8DA399",t.lineWidth=2,t.beginPath(),t.moveTo(e,i),t.lineTo(s,r),t.stroke()},renderHash(){this.renderCanvas("hashCanvas",(t,e,i)=>{const s=v("hashCanvas");if(s){const re=Object.keys(this.hashTable).length;s.setAttribute("aria-label",`Hash Table visualization with ${re} active buckets.`)}t.fillStyle="#FFFBF7",t.fillRect(0,0,e,i);const r=7,n=Object.entries(this.hashTable),a=90,o=15,l=70,c=60,h=80,d=380,u=140,p=50,f="#6D4C5E",g="#FFFFFF",m="#F3EBF0",y="#6D4C5E",b="#FFFFFF",w="#374151",k="#FFFFFF",x="#000000",E=Array(r).fill(null).map(()=>[]);n.forEach(([re,le])=>{const oe=this.simpleHash(re,r);E[oe].push({key:re,val:le})});let _=l+a,R=r*(a+o);const C=E.map(re=>{let le=l+a+c;const oe=re.map(ke=>{const Qe={...ke,w:d};return le+=d+p,Qe});return oe.length>0&&(_=Math.max(_,le)),oe}),D=20,q=_,A=R,F=(e-D*2)/Math.max(q,100),L=(i-D*2)/Math.max(A,100),W=Math.min(F,L,2.5),M=q*W,G=A*W,J=(e-M)/2,ce=(i-G)/2;t.save(),t.translate(J,ce),t.scale(W,W);for(let re=0;re<r;re++){const le=re*(a+o),oe=C[re],ke=oe.length>0;t.fillStyle=w,t.font='bold 24px "JetBrains Mono"',t.textAlign="right",t.textBaseline="middle",t.fillText(`[${re}]`,l-15,le+a/2);const Qe=l,qt=this.highlighted.structure==="hash"&&this.highlighted.index===re;t.fillStyle=ke||qt?m:g,t.strokeStyle=f,t.lineWidth=3,t.beginPath(),t.roundRect(Qe,le,a,a,8),t.fill(),t.stroke();const Ze=le+a/2,Dt=Qe+a;if(ke){let Xt=Dt+c;this.drawArrow(t,Dt+2,Ze,Xt-2,Ze),oe.forEach((fr,Ia)=>{const $s=Ze-h/2,qi=this.highlighted.key===fr.key;t.strokeStyle=qi?"#2F6A57":f,t.lineWidth=qi?4:2,t.beginPath(),t.roundRect(Xt,$s,d,h,12),t.save(),t.clip(),t.fillStyle=qi?"#2F6A57":y,t.fillRect(Xt,$s,u,h),t.fillStyle=qi?"#FFFFFF":b,t.fillRect(Xt+u,$s,d-u,h),t.restore(),t.beginPath(),t.roundRect(Xt,$s,d,h,12),t.strokeStyle=qi?"#2F6A57":f,t.lineWidth=qi?4:2,t.stroke(),t.textBaseline="middle",t.fillStyle=k,t.font="bold 24px Inter",t.textAlign="center";let ls=fr.key;t.measureText(ls).width>u-10&&(ls=ls.slice(0,3)+".."),t.fillText(ls,Xt+u/2,Ze),t.fillStyle=x,t.font="bold 30px Inter",t.textAlign="center";let Is=fr.val;t.measureText(Is).width>d-u-10&&(Is=Is.slice(0,6)+".."),t.fillText(Is,Xt+u+(d-u)/2,Ze);const gn=Xt+d;if(Ia<oe.length-1){const gr=gn+p;this.drawArrow(t,gn+2,Ze,gr-2,Ze),Xt=gr}})}}t.restore()})},drawArrow(t,e,i,s,r){const a=Math.atan2(r-i,s-e);t.strokeStyle="#5F6663",t.lineWidth=1.5,t.beginPath(),t.moveTo(e,i),t.lineTo(s,r),t.stroke(),t.beginPath(),t.moveTo(s,r),t.lineTo(s-6*Math.cos(a-Math.PI/6),r-6*Math.sin(a-Math.PI/6)),t.lineTo(s-6*Math.cos(a+Math.PI/6),r-6*Math.sin(a+Math.PI/6)),t.fillStyle="#5F6663",t.fill()},switchHeapType(t,e){if(this.heapType===t)return;this.heapType=t;const i=e.closest(".segmented-control");i&&(i.querySelectorAll(".seg-btn").forEach(s=>s.classList.remove("active")),e.classList.add("active")),this.heapify(),this.renderHeap(),v("heapState")&&(v("heapState").textContent=`[${this.heapData.join(", ")}]`),T(`Converted to ${t==="max"?"Max":"Min"}-Heap`)},renderHeap(){this.renderCanvas("heapCanvas",(t,e,i)=>{const s=this.heapData,r=v("heapCanvas");if(r){const M=s.length>0?`${s.length} items`:"empty";r.setAttribute("aria-label",`Heap visualization. Tree is ${M}.`)}if(s.length===0){t.fillStyle="#6B7280",t.font="italic 24px Inter",t.textAlign="center",t.fillText("Heap is empty",e/2,i/2);return}const n=25,a=70,o=2,l=14,c="#2F6A57",h="#FFFFFF",d="#FFFEFA",u="#2F6A57",p="#1F2322",f="#2F6A57",g=new Map;let m=1/0,y=-1/0,b=0;const w=(M,G,J,ce,re)=>{if(M>=s.length)return;g.set(M,{x:G,y:J}),m=Math.min(m,G-n),y=Math.max(y,G+n),b=Math.max(b,J+n);const le=Math.max(n*1.5,re/2);w(2*M+1,G-re,J+a,ce+1,le),w(2*M+2,G+re,J+a,ce+1,le)},k=Math.floor(Math.log2(s.length))+1,x=Math.pow(2,Math.max(k-2,0))*(n*3);w(0,0,n+20,0,x);const E=40,_=y-m,R=b,C=(e-E*2)/Math.max(_,100),D=(i-E*2)/Math.max(R,100),q=Math.min(C,D,1.2),A=(m+y)/2,F=e/2-A*q,L=20;t.save(),t.translate(F,L),t.scale(q,q);const W=M=>{if(M>=s.length)return;const G=g.get(M),J=2*M+1,ce=2*M+2;if(t.strokeStyle=f,t.lineWidth=o,J<s.length){const re=g.get(J);t.beginPath(),t.moveTo(G.x,G.y),t.lineTo(re.x,re.y),t.stroke(),W(J)}if(ce<s.length){const re=g.get(ce);t.beginPath(),t.moveTo(G.x,G.y),t.lineTo(re.x,re.y),t.stroke(),W(ce)}};W(0);for(let M=0;M<s.length;M++){const{x:G,y:J}=g.get(M),re=M===0;t.shadowColor="rgba(0,0,0,0.2)",t.shadowBlur=10,t.shadowOffsetY=4,t.beginPath(),t.arc(G,J,n,0,Math.PI*2),re?(t.fillStyle=c,t.fill(),t.strokeStyle=c):(t.fillStyle=d,t.fill(),t.strokeStyle=u),t.lineWidth=o,t.shadowColor="transparent",t.stroke(),t.fillStyle=re?h:p,t.font=`bold ${l}px Inter`,t.textAlign="center",t.textBaseline="middle",t.fillText(s[M],G,J)}t.restore()})}};N.initBST();typeof window<"u"&&(window.DS=N,window.DataStructures=N);function Gg(t,e="#F8F4EC"){if(!t)return null;const i=t.getBoundingClientRect(),s=Math.min(2,window.devicePixelRatio||1),r=Math.max(1,Math.floor(i.width)),n=Math.max(1,Math.floor(i.height));t.width=r*s,t.height=n*s;const a=t.getContext("2d");return a.setTransform(1,0,0,1,0,0),a.scale(s,s),a.clearRect(0,0,r,n),a.fillStyle=e,a.fillRect(0,0,r,n),{ctx:a,w:r,h:n,dpr:s}}function Vt(t=-1){var b,w;const e=document.getElementById("sortCanvas"),i=Gg(e);if(!i)return;const{ctx:s,w:r,h:n}=i,a=H.data,o=a.length;if(o===0)return;const l=H.steps[H.stepIndex-1]||{},c=l.sorted||new Set,h=l.comparing||[],d=l.swapping||[],u=l.pivot??-1,p=Math.max(...a,1),f=15,g=(r-f*2)/o,m=((b=document.getElementById("showValuesToggle"))==null?void 0:b.checked)??!1,y=((w=document.getElementById("rainbowModeToggle"))==null?void 0:w.checked)??!1;for(let k=0;k<o;k++){const x=a[k],E=x/p*(n-f*2-30),_=f+k*g,R=n-f-E,C=(q,A)=>getComputedStyle(document.documentElement).getPropertyValue(q).trim()||A;let D;if(t>=0&&k<=t){const q=s.createLinearGradient(_,R,_,R+E);q.addColorStop(0,C("--viz-gradient-1","#FFD700")),q.addColorStop(.55,C("--viz-gradient-2","#FFA500")),q.addColorStop(1,C("--viz-gradient-3","#2F6A57")),D=q}else y?D=`hsl(${x/p*270}, 70%, 55%)`:c.has(k)?D=C("--viz-sorted","#2F6A57"):d.includes(k)?D=C("--viz-swap","#E07A5F"):h.includes(k)?D=C("--viz-compare","#5B8BA0"):k===u?D=C("--viz-pivot","#D4A853"):D=C("--viz-default","#C8BFB0");if(s.fillStyle=D,s.beginPath(),s.roundRect(_+1,R,Math.max(1,g-2),E,2),s.fill(),t>=0&&k===t&&(s.fillStyle="rgba(255, 255, 255, 0.85)",s.beginPath(),s.arc(_+g/2,R+10,4,0,Math.PI*2),s.fill()),m&&g>16){const q=Math.max(10,Math.min(14,g*.5));s.font=`bold ${q}px system-ui`,s.textAlign="center",E>24?(s.fillStyle="rgba(255, 255, 255, 0.9)",s.fillText(x,_+g/2,R+16)):(s.fillStyle=C("--text-body","#333"),s.fillText(x,_+g/2,R-4))}}}function ll(){const t=H.data.slice(),e=[],i={comparisons:0,swaps:0},s=new Set;function r(a={}){a.compare&&i.comparisons++,a.swap&&i.swaps++,e.push({arr:t.slice(),sorted:new Set(s),comparing:a.comparing||[],swapping:a.swapping||[],pivot:a.pivot??-1,compareVals:a.compareVals,swapVals:a.swapVals,pan:a.pan})}const n=H.algo;if(n==="bubble")for(let a=0;a<t.length;a++){for(let o=0;o<t.length-1-a;o++)if(r({comparing:[o,o+1],compare:!0,compareVals:[t[o],t[o+1]],pan:o/t.length*.6-.3}),t[o]>t[o+1]){const l=t[o],c=t[o+1];[t[o],t[o+1]]=[t[o+1],t[o]],r({swapping:[o,o+1],swap:!0,swapVals:[l,c],pan:o/t.length*.6-.3})}s.add(t.length-1-a)}else if(n==="insertion"){for(let a=1;a<t.length;a++){let o=a;for(;o>0&&(r({comparing:[o,o-1],compare:!0,compareVals:[t[o],t[o-1]],pan:o/t.length*.6-.3}),t[o]<t[o-1]);){const l=t[o],c=t[o-1];[t[o],t[o-1]]=[t[o-1],t[o]],r({swapping:[o,o-1],swap:!0,swapVals:[l,c],pan:o/t.length*.6-.3}),o--}}for(let a=0;a<t.length;a++)s.add(a)}else if(n==="selection")for(let a=0;a<t.length;a++){let o=a;for(let l=a+1;l<t.length;l++)r({comparing:[o,l],compare:!0,compareVals:[t[o],t[l]],pan:l/t.length*.6-.3}),t[l]<t[o]&&(o=l);if(o!==a){const l=t[a],c=t[o];[t[a],t[o]]=[t[o],t[a]],r({swapping:[a,o],swap:!0,swapVals:[l,c],pan:a/t.length*.6-.3})}s.add(a)}else if(n==="quick"){let a=function(l,c){const h=t[c];let d=l;r({pivot:c});for(let u=l;u<c;u++)if(r({comparing:[u,c],pivot:c,compare:!0,compareVals:[t[u],t[c]],pan:u/t.length*.6-.3}),t[u]<=h){if(d!==u){const p=t[d],f=t[u];[t[d],t[u]]=[t[u],t[d]],r({swapping:[d,u],pivot:c,swap:!0,swapVals:[p,f],pan:u/t.length*.6-.3})}d++}if(d!==c){const u=t[d],p=t[c];[t[d],t[c]]=[t[c],t[d]],r({swapping:[d,c],swap:!0,swapVals:[u,p],pan:d/t.length*.6-.3})}return s.add(d),d};const o=[[0,t.length-1]];for(;o.length;){const[l,c]=o.pop();if(l>=c){l===c&&s.add(l);continue}const h=a(l,c);o.push([l,h-1],[h+1,c])}}else if(n==="merge"){let a=function(o,l,c){const h=t.slice(o,l+1),d=t.slice(l+1,c+1);let u=0,p=0,f=o;for(;u<h.length&&p<d.length;)r({comparing:[o+u,l+1+p],compare:!0,compareVals:[h[u],d[p]],pan:f/t.length*.6-.3}),t[f++]=h[u]<=d[p]?h[u++]:d[p++],r({swapping:[f-1],swap:!0,pan:f/t.length*.6-.3});for(;u<h.length;)t[f++]=h[u++];for(;p<d.length;)t[f++]=d[p++]};for(let o=1;o<t.length;o*=2)for(let l=0;l<t.length-o;l+=o*2)a(l,l+o-1,Math.min(l+o*2-1,t.length-1));for(let o=0;o<t.length;o++)s.add(o)}else if(n==="heap"){let a=function(o,l){let c=l;const h=2*l+1,d=2*l+2;if(h<o&&(r({comparing:[h,c],compare:!0,compareVals:[t[h],t[c]],pan:h/t.length*.6-.3}),t[h]>t[c]&&(c=h)),d<o&&(r({comparing:[d,c],compare:!0,compareVals:[t[d],t[c]],pan:d/t.length*.6-.3}),t[d]>t[c]&&(c=d)),c!==l){const u=t[l],p=t[c];[t[l],t[c]]=[t[c],t[l]],r({swapping:[l,c],swap:!0,swapVals:[u,p],pan:l/t.length*.6-.3}),a(o,c)}};for(let o=Math.floor(t.length/2)-1;o>=0;o--)a(t.length,o);for(let o=t.length-1;o>0;o--){const l=t[0],c=t[o];[t[0],t[o]]=[t[o],t[0]],r({swapping:[0,o],swap:!0,swapVals:[l,c],pan:o/t.length*.6-.3}),s.add(o),a(o,0)}s.add(0)}r(),H.steps=e,H.stats=i}function ir(){const t=document.getElementById("statCompares"),e=document.getElementById("statSwaps"),i=document.getElementById("statSteps");t&&(t.textContent=H.stats.comparisons),e&&(e.textContent=H.stats.swaps),i&&(i.textContent=H.stepIndex);const s=qg[H.algo],r=document.getElementById("algoTitle"),n=document.getElementById("algoDesc"),a=document.getElementById("bestCase"),o=document.getElementById("avgCase"),l=document.getElementById("worstCase");r&&(r.textContent=s.name),n&&(n.textContent=s.desc),a&&(a.textContent=s.best),o&&(o.textContent=s.avg),l&&(l.textContent=s.worst)}function cd(){var t,e;H.steps.length===0&&ll(),H.stepIndex>=H.steps.length&&(H.stepIndex=0),H.playing=!0,(t=document.getElementById("btnPlay"))==null||t.classList.add("section-hidden"),(e=document.getElementById("btnPause"))==null||e.classList.remove("section-hidden"),Yg()}function Js(){var t,e;H.playing=!1,clearTimeout(H.timer),(t=document.getElementById("btnPlay"))==null||t.classList.remove("section-hidden"),(e=document.getElementById("btnPause"))==null||e.classList.add("section-hidden")}function Yg(){var t,e;if(H.playing)if(H.stepIndex<H.steps.length){const i=H.steps[H.stepIndex];H.data=i.arr.slice();const s=Math.max(...H.data),r=i.pan||0;i.compareVals&&i.compareVals.length===2&&((t=O.playCompare)==null||t.call(O,i.compareVals[0],i.compareVals[1],s,r)),i.swapVals&&i.swapVals.length===2&&((e=O.playSwap)==null||e.call(O,i.swapVals[0],i.swapVals[1],s,r)),H.stepIndex++,ir(),Vt(),H.timer=setTimeout(Yg,Math.max(10,240/H.speed))}else Js(),hd()}function hd(){sd.clearCompletionTimers();const t=H.data.length;let e=0;const i=document.getElementById("shimmerOverlay");i==null||i.classList.add("active");const s=()=>{var r;e<t?((r=O.playSweepSound)==null||r.call(O,e,t),Vt(e),e++,H.completionTimers.push(setTimeout(s,Math.max(14,780/t)))):H.completionTimers.push(setTimeout(()=>{var n,a;i==null||i.classList.remove("active"),Vt(t),(n=O.play)==null||n.call(O,"sort_complete"),(a=O.playCompletionMelody)==null||a.call(O)},200))};s()}function Us(){var e,i;Js(),sd.clearCompletionTimers(),H.stepIndex=0,H.steps=[],H.stats={comparisons:0,swaps:0};const t=((e=document.getElementById("arrayTypeSelect"))==null?void 0:e.value)||"random";H.data=Dg(H.size,t),ir(),Vt(),(i=O.play)==null||i.call(O,"reset")}function aa(){H.data.length||(H.data=rd(H.size)),ir(),Vt()}typeof window<"u"&&(window.renderSort=Vt,window.generateSortSteps=ll,window.updateSortUI=ir,window.playSorting=cd,window.pauseSorting=Js,window.playCompletionAnimation=hd,window.resetSorting=Us,window.initSorting=aa);class XS{constructor(){this.container=null}init(e,i){this.container=e,e.querySelector("#sortCanvas")||(e.innerHTML='<canvas id="sortCanvas" style="width:100%; height:100%;"></canvas>'),i?(H.data=i.data||[],H.size=H.data.length,i.algo&&(H.algo=i.algo)):aa()}update(e){e.arr&&(H.data=e.arr);const i={sorted:new Set(e.sorted||[]),comparing:e.comparing||[],swapping:e.swapping||[],pivot:e.pivot};H.steps=[i],H.stepIndex=1,Vt()}renderGhostState(e,i){const s=document.createElement("canvas");s.style.width="100%",s.style.height="100%",s.style.position="absolute",s.style.top="0",s.style.left="0",s.style.pointerEvents="none",i.appendChild(s);const r=Gg(s,"transparent");if(!r)return;const{ctx:n,w:a,h:o}=r,l=e.data||[],c=l.length;if(c===0)return;const h=Math.max(...l,1),d=15,u=(a-d*2)/c;for(let p=0;p<c;p++){const g=l[p]/h*(o-d*2-30),m=d+p*u,y=o-d-g;n.fillStyle="rgba(239, 68, 68, 0.4)",n.beginPath(),n.roundRect(m+1,y,Math.max(1,u-2),g,2),n.fill(),e.highlightIndices&&e.highlightIndices.includes(p)&&(n.fillStyle="#ef4444",n.font="bold 20px sans-serif",n.textAlign="center",n.fillText("?",m+u/2,y-10))}}setSpeed(e){H.speed=e}handleAction(e,i){if(e==="HIGHLIGHT_BARS"){const s=document.getElementById("sortCanvas");s.getContext("2d"),s.getBoundingClientRect(),i&&i.indices&&({...H.steps[H.stepIndex-1]||{},comparing:i.indices},console.log("Highlighting bars:",i.indices))}}}const n$=Object.freeze(Object.defineProperty({__proto__:null,SortingRenderer:XS,generateSortSteps:ll,initSorting:aa,pauseSorting:Js,playCompletionAnimation:hd,playSorting:cd,renderSort:Vt,resetSorting:Us,updateSortUI:ir},Symbol.toStringTag,{value:"Module"}));function Zg(t,e="#E8DFD0"){if(!t)return null;const i=t.getBoundingClientRect(),s=Math.min(2,window.devicePixelRatio||1),r=Math.max(1,Math.floor(i.width)),n=Math.max(1,Math.floor(i.height));t.width=r*s,t.height=n*s;const a=t.getContext("2d");return a.setTransform(1,0,0,1,0,0),a.scale(s,s),a.clearRect(0,0,r,n),a.fillStyle=e,a.fillRect(0,0,r,n),{ctx:a,w:r,h:n,dpr:s}}function GS(t,e){const i=parseInt(t.replace("#",""),16),s=Math.round(2.55*e),r=Math.min(255,(i>>16)+s),n=Math.min(255,(i>>8&255)+s),a=Math.min(255,(i&255)+s);return`rgb(${r}, ${n}, ${a})`}function YS(t,e){const i=parseInt(t.replace("#",""),16),s=Math.round(2.55*e),r=Math.max(0,(i>>16)-s),n=Math.max(0,(i>>8&255)-s),a=Math.max(0,(i&255)-s);return`rgb(${r}, ${n}, ${a})`}function ep(t,e){const i=parseInt(t.replace("#",""),16),s=i>>16&255,r=i>>8&255,n=i&255;return`rgba(${s}, ${r}, ${n}, ${e})`}function ZS(t,e,i,s,r,n={}){const{isGlowing:a=!1,glowIntensity:o=1,isCurrent:l=!1,isHovered:c=!1,isGoalReached:h=!1}=n;t.save();let d=s;if(c&&(d*=1.1),h){const m=Date.now()%1e3/1e3,y=1+.15*Math.sin(m*Math.PI*2);d*=y}if(h){const m=Date.now()%1500/1500,y=.5+.5*Math.sin(m*Math.PI*2);t.beginPath(),t.arc(e,i,d+35*y,0,Math.PI*2),t.fillStyle=`rgba(255, 215, 0, ${.15*y})`,t.fill(),t.beginPath(),t.arc(e,i,d+20*y,0,Math.PI*2),t.fillStyle=`rgba(72, 187, 120, ${.25*y})`,t.fill(),t.beginPath(),t.arc(e,i,d+10,0,Math.PI*2),t.fillStyle="rgba(255, 255, 255, 0.3)",t.fill()}if((a||l)&&!h){const m=l?1.3:o;t.beginPath(),t.arc(e,i,d+12*m,0,Math.PI*2),t.fillStyle=ep(r,.12*m),t.fill(),t.beginPath(),t.arc(e,i,d+6*m,0,Math.PI*2),t.fillStyle=ep(r,.3*m),t.fill()}t.beginPath(),t.arc(e,i,d,0,Math.PI*2);const u=t.createRadialGradient(e-d*.3,i-d*.3,d*.1,e,i,d),p=h?"#FFD700":r,f=GS(p,30),g=YS(p,15);u.addColorStop(0,f),u.addColorStop(.5,p),u.addColorStop(1,g),t.fillStyle=u,t.fill(),t.strokeStyle=h?"rgba(255, 215, 0, 0.8)":"rgba(255, 255, 255, 0.3)",t.lineWidth=h?3:1.5,t.stroke(),(l||c||h)&&(t.beginPath(),t.arc(e,i,d+3,0,Math.PI*2),t.strokeStyle=h?"#48bb78":"#d4a853",t.lineWidth=h?3.5:2.5,t.stroke()),t.restore()}const dt={REPULSION_STRENGTH:1500,LINK_STRENGTH:.03,LINK_DISTANCE:150,CENTER_STRENGTH:.03,VELOCITY_DECAY:.4,ALPHA_INITIAL:1,ALPHA_DECAY:.0228,ALPHA_MIN:.001,MIN_DISTANCE:80,CANVAS_PADDING:40,MAX_VELOCITY:50};let Ti=null;class HS{constructor(e){this.canvas=e,this.ctx=e.getContext("2d"),this.dpr=Math.min(2,window.devicePixelRatio||1),this.nodes=[],this.edges=[],this.alpha=dt.ALPHA_INITIAL,this.isRunning=!1,this.animationId=null,this.dragNode=null,this.hoveredNode=null,this.isDragging=!1,this.mousePos={x:0,y:0},this.displayWidth=800,this.displayHeight=400,this._onMouseDown=this.onMouseDown.bind(this),this._onMouseMove=this.onMouseMove.bind(this),this._onMouseUp=this.onMouseUp.bind(this),this._onMouseLeave=this.onMouseLeave.bind(this),this.setupEventListeners()}initFromPathState(){if(!B.grid)return;const{nodes:e,adjacency:i,adjacencyBFS:s,weightedAdjacency:r,positions:n}=B.grid;let a=i||s;if(!a&&r){a={};for(const[u,p]of Object.entries(r))a[u]=p.map(f=>f.node)}a||(a={});const o=(e==null?void 0:e.length)||8,l=30,c=this.canvas.getBoundingClientRect();this.displayWidth=c.width||800,this.displayHeight=c.height||400;let h;if(n&&!B.grid.isRandomGraph){const u=this.displayWidth/800,p=this.displayHeight/400;h=n.map(f=>({x:f.x*u,y:f.y*p,label:f.label}))}else h=Kg(this.displayWidth,this.displayHeight,l,o,e);this.nodes=h.map((u,p)=>({x:u.x,y:u.y,vx:0,vy:0,fx:null,fy:null,label:u.label,index:p,isHovered:!1,isDragging:!1,radius:l})),this.edges=[];const d=new Set;for(let u=0;u<o;u++){const p=a[u]||[];for(const f of p){const g=[Math.min(u,f),Math.max(u,f)].join("-");d.has(g)||(d.add(g),this.edges.push({source:u,target:f}))}}this.start()}start(){this.isRunning||(this.isRunning=!0,this.alpha=dt.ALPHA_INITIAL,this.tick())}stop(){this.isRunning=!1,this.animationId&&(cancelAnimationFrame(this.animationId),this.animationId=null)}tick(){this.isRunning&&(this.applyRepulsion(),this.applyAttraction(),this.applyCentering(),this.applyCollision(),this.updatePositions(),this.alpha+=(0-this.alpha)*dt.ALPHA_DECAY,Le(),this.alpha<dt.ALPHA_MIN?this.isRunning=!1:this.animationId=requestAnimationFrame(()=>this.tick()))}applyRepulsion(){const e=dt.MIN_DISTANCE*dt.MIN_DISTANCE;for(let i=0;i<this.nodes.length;i++){const s=this.nodes[i];if(!(s.fx!==null&&s.fy!==null))for(let r=i+1;r<this.nodes.length;r++){const n=this.nodes[r],a=n.x-s.x,o=n.y-s.y,l=a*a+o*o,c=Math.sqrt(l+e),h=dt.REPULSION_STRENGTH*this.alpha/(l+e),d=a/c*h,u=o/c*h;s.fx===null&&(s.vx-=d,s.vy-=u),n.fx===null&&(n.vx+=d,n.vy+=u)}}}applyAttraction(){for(const e of this.edges){const i=this.nodes[e.source],s=this.nodes[e.target];if(!i||!s)continue;const r=s.x-i.x,n=s.y-i.y,a=Math.sqrt(r*r+n*n)||dt.MIN_DISTANCE,l=(a-dt.LINK_DISTANCE)*dt.LINK_STRENGTH*this.alpha,c=r/a*l,h=n/a*l;i.fx===null&&(i.vx+=c,i.vy+=h),s.fx===null&&(s.vx-=c,s.vy-=h)}}applyCentering(){let e=0,i=0,s=0;for(const h of this.nodes)h.fx===null&&(e+=h.x,i+=h.y,s++);if(s===0)return;const r=e/s,n=i/s,a=this.displayWidth/2,o=this.displayHeight/2,l=(a-r)*dt.CENTER_STRENGTH,c=(o-n)*dt.CENTER_STRENGTH;for(const h of this.nodes)h.fx===null&&(h.vx+=l*this.alpha,h.vy+=c*this.alpha)}applyCollision(){for(let i=0;i<this.nodes.length;i++){const s=this.nodes[i];if(!(s.fx!==null&&s.fy!==null))for(let r=i+1;r<this.nodes.length;r++){const n=this.nodes[r],a=n.x-s.x,o=n.y-s.y,l=Math.sqrt(a*a+o*o)||1,c=45*2;if(l<c){const h=c-l,d=a/l*h*.5,u=o/l*h*.5;s.fx===null&&(s.x-=d,s.y-=u),n.fx===null&&(n.x+=d,n.y+=u)}}}}updatePositions(){const e=dt.CANVAS_PADDING;for(const i of this.nodes){if(i.isDragging)continue;if(i.fx!==null&&(i.x=i.fx),i.fy!==null&&(i.y=i.fy),i.fx!==null||i.fy!==null){i.vx=0,i.vy=0;continue}const s=Math.sqrt(i.vx*i.vx+i.vy*i.vy);if(s>dt.MAX_VELOCITY){const r=dt.MAX_VELOCITY/s;i.vx*=r,i.vy*=r}i.x+=i.vx,i.y+=i.vy,i.vx*=1-dt.VELOCITY_DECAY,i.vy*=1-dt.VELOCITY_DECAY,i.x<e&&(i.x=e,i.vx=Math.abs(i.vx)*.5),i.x>this.displayWidth-e&&(i.x=this.displayWidth-e,i.vx=-Math.abs(i.vx)*.5),i.y<e&&(i.y=e,i.vy=Math.abs(i.vy)*.5),i.y>this.displayHeight-e&&(i.y=this.displayHeight-e,i.vy=-Math.abs(i.vy)*.5)}}reheat(e=.3){this.alpha=Math.max(this.alpha,e),this.isRunning||(this.isRunning=!0,this.tick())}setupEventListeners(){this.canvas.addEventListener("mousedown",this._onMouseDown),this.canvas.addEventListener("mousemove",this._onMouseMove),this.canvas.addEventListener("mouseup",this._onMouseUp),this.canvas.addEventListener("mouseleave",this._onMouseLeave),this.canvas.addEventListener("contextmenu",e=>e.preventDefault())}getMousePos(e){const i=this.canvas.getBoundingClientRect(),s=this.displayWidth/i.width,r=this.displayHeight/i.height;return{x:(e.clientX-i.left)*s,y:(e.clientY-i.top)*r}}getNodeAt(e,i){for(let s=this.nodes.length-1;s>=0;s--){const r=this.nodes[s],n=e-r.x,a=i-r.y;if(n*n+a*a<=(r.radius+8)*(r.radius+8))return r}return null}onMouseDown(e){const i=this.getMousePos(e),s=this.getNodeAt(i.x,i.y);s&&(this.dragNode=s,this.isDragging=!0,s.isDragging=!0,s.fx=s.x,s.fy=s.y,this.canvas.style.cursor="grabbing",this.reheat(.3))}onMouseMove(e){const i=this.getMousePos(e);this.mousePos=i;const s=this.hoveredNode;this.hoveredNode=this.getNodeAt(i.x,i.y),s!==this.hoveredNode&&(s&&(s.isHovered=!1),this.hoveredNode&&(this.hoveredNode.isHovered=!0),Le()),this.isDragging&&this.dragNode&&(this.dragNode.x=i.x,this.dragNode.y=i.y,this.dragNode.fx=i.x,this.dragNode.fy=i.y,this.alpha=Math.max(this.alpha,.1),Le()),this.isDragging?this.canvas.style.cursor="grabbing":this.hoveredNode?this.canvas.style.cursor="grab":this.canvas.style.cursor="default"}onMouseUp(e){this.dragNode&&(this.dragNode.isDragging=!1,this.dragNode.fx=null,this.dragNode.fy=null,this.dragNode=null,this.isDragging=!1,this.reheat(.3)),this.canvas.style.cursor=this.hoveredNode?"grab":"default",Le()}onMouseLeave(){this.dragNode&&(this.dragNode.isDragging=!1,this.dragNode.fx=null,this.dragNode.fy=null,this.dragNode=null,this.isDragging=!1,this.reheat(.3)),this.hoveredNode&&(this.hoveredNode.isHovered=!1,this.hoveredNode=null),this.canvas.style.cursor="default",Le()}destroy(){this.stop(),this.canvas.removeEventListener("mousedown",this._onMouseDown),this.canvas.removeEventListener("mousemove",this._onMouseMove),this.canvas.removeEventListener("mouseup",this._onMouseUp),this.canvas.removeEventListener("mouseleave",this._onMouseLeave)}}function KS(){const t=document.getElementById("pathCanvas");return t?((!Ti||Ti.canvas!==t)&&(Ti&&Ti.destroy(),Ti=new HS(t)),Ti):null}function Hg(){const t=KS();t&&t.initFromPathState()}function JS(){var e,i;const t=((i=(e=B.grid)==null?void 0:e.nodes)==null?void 0:i.length)||0;return Ti&&Ti.nodes.length>0?Ti.nodes.length!==t?null:Ti.nodes.map(s=>({x:s.x,y:s.y,label:s.label,isHovered:s.isHovered,isDragging:s.isDragging})):null}function Kg(t,e,i,s=8,r=null){const n=i+30,a=t-n*2,o=e-n*2,l=Math.ceil(s/2),c=s>l?2:1,h=l>1?a/(l-1):0,d=c>1?o:0,u="abcdefghijklmnopqrstuvwxyz",p=[];for(let f=0;f<s;f++){const g=Math.floor(f/l),m=f%l,y=g===0?Math.min(l,s):s-l,b=g===1&&y<l?(l-y)*h/2:0;p.push({x:n+m*h+b,y:n+g*d,label:r?r[f]:u[f]})}return p}function Le(){var q;const t=document.getElementById("pathCanvas");if(!t||!B.grid)return;const i=document.documentElement.getAttribute("data-theme")==="dark"?"#1e1e1e":"#1a1a2e",s=Zg(t,i);if(!s)return;const{ctx:r,w:n,h:a}=s,{isGraph:o,nodes:l,start:c,end:h,nodeCount:d,weightedAdjacency:u}=B.grid;if(!o)return;let p=B.grid.adjacency||B.grid.adjacencyBFS;if(!p&&u){p={};for(const[A,F]of Object.entries(u))p[A]=F.map(L=>L.node)}p||(p={});const f=30,g=d||l.length||8;let m=JS();if(!m)if(B.grid.positions&&!B.grid.isRandomGraph){const A=n/800,F=a/400;m=B.grid.positions.map(L=>({x:L.x*A,y:L.y*F,label:L.label,isHovered:!1,isDragging:!1}))}else m=Kg(n,a,f,g,l).map(A=>({...A,isHovered:!1,isDragging:!1}));const y=B.steps[B.stepIndex-1]||{},b=y.visited||new Set,w=y.frontier||new Set;y.path;const k=y.current??-1,x=y.traversedEdges||new Set,E=y.pathEdges||new Set,_=y.currentEdge||null;y.traversalOrder,y.parent;const R={default:"rgba(140, 200, 255, 0.50)",traversed:"#48bb78",path:"#d4a853",current:"#f6e05e"},C=new Set;for(let A=0;A<l.length;A++){const F=p[A];for(const L of F){const W=[Math.min(A,L),Math.max(A,L)].join("-");if(!C.has(W)){C.add(W);const M=m[A],G=m[L];let J=R.default,ce=2;if(E.has(W)?(J=R.path,ce=5):_===W?(J=R.current,ce=6):x.has(W)&&(J=R.traversed,ce=3),r.save(),r.strokeStyle=J,r.lineWidth=ce,r.lineCap="round",E.has(W)||_===W?(r.shadowColor="rgba(100, 180, 255, 0.6)",r.shadowBlur=_===W?12:8):x.has(W)?(r.shadowColor="rgba(72, 187, 120, 0.4)",r.shadowBlur=6):(r.shadowColor="rgba(100, 180, 255, 0.25)",r.shadowBlur=4),r.beginPath(),r.moveTo(M.x,M.y),r.lineTo(G.x,G.y),r.stroke(),r.restore(),B.grid.isDirected){const oe=Math.atan2(G.y-M.y,G.x-M.x),ke=G.x-f*Math.cos(oe),Qe=G.y-f*Math.sin(oe);r.save(),r.fillStyle=J,r.beginPath(),r.moveTo(ke,Qe),r.lineTo(ke-12*Math.cos(oe-Math.PI/6),Qe-12*Math.sin(oe-Math.PI/6)),r.lineTo(ke-12*Math.cos(oe+Math.PI/6),Qe-12*Math.sin(oe+Math.PI/6)),r.closePath(),r.fill(),r.restore()}_===W&&(r.save(),r.strokeStyle="rgba(246, 224, 94, 0.4)",r.lineWidth=12,r.beginPath(),r.moveTo(M.x,M.y),r.lineTo(G.x,G.y),r.stroke(),r.restore());const re=y.edgeTraversalOrder||new Map;if(x.has(W)&&re.has(W)){const le=re.get(W),oe=(M.x+G.x)/2,ke=(M.y+G.y)/2;r.save(),r.fillStyle="#48bb78",r.beginPath(),r.arc(oe,ke,14,0,Math.PI*2),r.fill(),r.strokeStyle="#2d6a4f",r.lineWidth=2,r.stroke(),r.fillStyle="#fff",r.font="bold 11px Inter, sans-serif",r.textAlign="center",r.textBaseline="middle",r.fillText(String(le),oe,ke),r.restore()}if(B.grid.isWeighted&&B.grid.weightedAdjacency){const oe=(q=B.grid.weightedAdjacency[A])==null?void 0:q.find(ke=>ke.node===L);if(oe){const ke=(M.x+G.x)/2,Qe=(M.y+G.y)/2;r.fillStyle="rgba(255, 255, 255, 0.9)",r.beginPath(),r.arc(ke,Qe,14,0,Math.PI*2),r.fill(),r.strokeStyle="#666",r.lineWidth=1,r.stroke(),r.fillStyle="#333",r.font="bold 12px Inter, sans-serif",r.textAlign="center",r.textBaseline="middle",r.fillText(oe.weight,ke,Qe)}}}}}const D=y.distance||new Map;for(let A=0;A<l.length;A++){const F=m[A];let L,W="#fff",M=!1,G=!1;A===c?(L="#48bb78",W="#000",G=!0):A===h?(L="#e07a5f",W="#fff",G=!0):A===k?(L="#808080",W="#fff",M=!0,G=!0):w.has(A)?(L="#A0A0A0",W="#000"):b.has(A)?(L="#1a1a1a",W="#fff"):(L="#FFFFFF",W="#000");const J=A===h&&(k===h||b.has(h));ZS(r,F.x,F.y,f,L,{isGlowing:G,isCurrent:M,isHovered:F.isHovered||F.isDragging,isGoalReached:J});const ce=D.get?D.get(A):void 0,re=ce!==void 0?ce:"âˆž";r.save();const le=12;if(r.beginPath(),r.arc(F.x,F.y-4,le,0,Math.PI*2),r.fillStyle=W==="#000"?"rgba(255, 255, 255, 0.5)":"rgba(0, 0, 0, 0.4)",r.fill(),r.font="bold 14px Inter, sans-serif",r.textAlign="center",r.textBaseline="middle",r.shadowColor=W==="#000"?"rgba(255, 255, 255, 0.8)":"rgba(0, 0, 0, 0.8)",r.shadowBlur=3,r.fillStyle=W,r.fillText(String(re),F.x,F.y-4),r.shadowBlur=0,r.globalAlpha=.85,r.font="bold 11px Inter, sans-serif",r.fillStyle=W,r.fillText(F.label.toUpperCase(),F.x,F.y+12),r.globalAlpha=1,r.restore(),B.grid.hasHeuristics&&B.grid.heuristics){const oe=B.grid.heuristics[A];oe!==void 0&&(r.save(),r.fillStyle="#e07a5f",r.font="bold 12px Inter, sans-serif",r.textAlign="center",r.textBaseline="top",r.shadowColor="rgba(0, 0, 0, 0.5)",r.shadowBlur=2,r.fillText(`h=${oe}`,F.x,F.y+f+8),r.restore())}}typeof window.updateGoalNodeDropdown=="function"&&window.updateGoalNodeDropdown()}function tp(t,e,i="bfs"){if(e.isGraph)return i==="dfs"&&e.adjacencyDFS?e.adjacencyDFS[t]||[]:e.adjacencyBFS?e.adjacencyBFS[t]:e.adjacency[t]||[];const{rows:s,cols:r,walls:n}=e,a=Math.floor(t/r),o=t%r,l=[];return a>0&&!n.has(t-r)&&l.push(t-r),a<s-1&&!n.has(t+r)&&l.push(t+r),o>0&&!n.has(t-1)&&l.push(t-1),o<r-1&&!n.has(t+1)&&l.push(t+1),B.allowDiagonal&&(a>0&&o>0&&!n.has(t-r-1)&&l.push(t-r-1),a>0&&o<r-1&&!n.has(t-r+1)&&l.push(t-r+1),a<s-1&&o>0&&!n.has(t+r-1)&&l.push(t+r-1),a<s-1&&o<r-1&&!n.has(t+r+1)&&l.push(t+r+1)),l}function cl(){const{start:t,end:e,cols:i}=B.grid,s=[],r=new Map,n=B.algo;function a(o){s.push({visited:new Set(o.visited||[]),frontier:new Set(o.frontier||[]),current:o.current??-1,path:o.path?new Set(o.path):new Set,traversedEdges:o.traversedEdges?new Set(o.traversedEdges):new Set,currentEdge:o.currentEdge||null,pathEdges:o.pathEdges?new Set(o.pathEdges):new Set,edgeTraversalOrder:o.edgeTraversalOrder?new Map(o.edgeTraversalOrder):new Map,queue:o.queue?[...o.queue]:[],distance:o.distance?new Map(o.distance):new Map,parent:o.parent?new Map(o.parent):new Map,stack:o.stack?[...o.stack]:[],startTime:o.startTime?new Map(o.startTime):new Map,endTime:o.endTime?new Map(o.endTime):new Map,globalTimer:o.globalTimer||0,priorityQueue:o.priorityQueue?[...o.priorityQueue]:[],openList:o.openList?[...o.openList]:[],closedList:o.closedList?[...o.closedList]:[],astarOpenList:o.astarOpenList?[...o.astarOpenList]:[],astarClosedList:o.astarClosedList?[...o.astarClosedList]:[],gScore:o.gScore?new Map(o.gScore):new Map,fScore:o.fScore?new Map(o.fScore):new Map})}if(n==="bfs"){const o=[],l=new Map,c=new Map,h=new Map,d=new Set,u=new Map;let p=0;for(l.set(t,1),h.set(t,-1),c.set(t,0),o.push(t),a({visited:[t],frontier:o,current:-1,queue:o,distance:c,parent:h,traversedEdges:d,edgeTraversalOrder:u});o.length>0;){const f=o.shift();if(f===e)break;for(const m of tp(f,B.grid,"bfs"))if(!l.has(m)||l.get(m)===0){l.set(m,1),c.set(m,c.get(f)+1),h.set(m,f),o.push(m),r.set(m,f);const y=[Math.min(f,m),Math.max(f,m)].join("-");d.add(y),p++,u.set(y,p);const b=Array.from(l.entries()).filter(([w,k])=>k===1).map(([w,k])=>w);a({visited:b,frontier:[...o],current:f,queue:[...o],distance:c,parent:h,traversedEdges:d,edgeTraversalOrder:u,currentEdge:y})}const g=Array.from(l.entries()).filter(([m,y])=>y===1).map(([m,y])=>m);a({visited:g,frontier:[...o],current:f,queue:[...o],distance:c,parent:h,traversedEdges:d,edgeTraversalOrder:u,currentEdge:null})}}else if(n==="dfs"){const o=[t],l=new Map,c=new Map,h=new Map;let d=0;const u=new Set;let p=null;for(a({visited:[],frontier:o,current:-1,stack:o,startTime:c,endTime:h,globalTimer:d,traversedEdges:u});o.length>0;){const f=o.pop();if(l.has(f)&&l.get(f)===1)continue;const g=r.get(f);if(g!==void 0&&g!==-1&&(p=[Math.min(g,f),Math.max(g,f)].join("-"),u.add(p)),l.set(f,1),d++,c.set(f,d),f===e){d++,h.set(f,d);const b=Array.from(l.entries()).filter(([w,k])=>k===1).map(([w,k])=>w);a({visited:b,frontier:[...o],current:f,stack:[...o],startTime:c,endTime:h,globalTimer:d,traversedEdges:u,currentEdge:p});break}const m=tp(f,B.grid,"dfs").filter(b=>!l.has(b)||l.get(b)===0);for(const b of m)o.push(b),r.set(b,f);const y=Array.from(l.entries()).filter(([b,w])=>w===1).map(([b,w])=>b);a({visited:y,frontier:[...o],current:f,stack:[...o],startTime:c,endTime:h,globalTimer:d,traversedEdges:u,currentEdge:p})}}else if(n==="dijkstra"){const o=[],l=new Map,c=new Map,h=new Map,d=B.grid.nodes||[],u=B.grid.weightedAdjacency;for(let p=0;p<d.length;p++)l.set(p,1/0),c.set(p,null),h.set(p,0);for(l.set(t,0),c.set(t,-1),o.push({dist:0,node:t}),a({visited:[],frontier:[],current:-1,priorityQueue:[...o],distance:new Map(l),parent:new Map(c)}),h.set(t,1),a({visited:[t],frontier:[],current:t,priorityQueue:[...o],distance:new Map(l),parent:new Map(c)});o.length>0;){o.sort((m,y)=>m.dist-y.dist);const{dist:p,node:f}=o.shift();if(h.get(f)===1&&p>l.get(f))continue;if(h.set(f,1),u&&u[f])for(const{node:m,weight:y}of u[f]){const b=l.get(f)+y;b<l.get(m)&&(l.set(m,b),c.set(m,f),o.push({dist:b,node:m}),r.set(m,f))}const g=Array.from(h.entries()).filter(([m,y])=>y===1).map(([m,y])=>m);if(a({visited:g,frontier:o.map(m=>m.node),current:f,priorityQueue:[...o],distance:new Map(l),parent:new Map(c)}),f===e)break}}else if(n==="greedy"){const o=[],l=[],c=B.grid.adjacency||{},h=B.grid.heuristics||{},d=new Map,u=new Map;for(d.set(t,0),u.set(t,-1),o.push({node:t,h:h[t]||0}),a({visited:[],frontier:o.map(p=>p.node),current:-1,openList:[...o],closedList:[...l],distance:new Map(d),parent:new Map(u)});o.length>0;){o.sort((g,m)=>g.h-m.h);const{node:p}=o.shift();if(l.includes(p))continue;if(l.push(p),a({visited:[...l],frontier:o.map(g=>g.node),current:p,openList:[...o],closedList:[...l],distance:new Map(d),parent:new Map(u)}),p===e)break;const f=c[p]||[];for(const g of f)if(!l.includes(g)&&!o.find(m=>m.node===g)){const m=h[g]||0;o.push({node:g,h:m}),d.set(g,d.get(p)+1),u.set(g,p),r.set(g,p)}}}else if(n==="astar"){const o=[],l=[],c=new Map,h=new Map,d=new Map,u=B.grid.adjacency||{},p=B.grid.weightedAdjacency||{},f=B.grid.heuristics||{};c.set(t,0),d.set(t,-1);const g=f[t]||0;for(h.set(t,g),o.push({node:t,f:g,g:0,h:g}),a({visited:[],frontier:o.map(m=>m.node),current:-1,astarOpenList:[...o],astarClosedList:[...l],gScore:new Map(c),fScore:new Map(h),distance:new Map(c),parent:new Map(d)});o.length>0;){o.sort((b,w)=>b.f-w.f||b.h-w.h);const m=o.shift();if(l.includes(m.node))continue;if(l.push(m.node),a({visited:[...l],frontier:o.map(b=>b.node),current:m.node,astarOpenList:[...o],astarClosedList:[...l],gScore:new Map(c),fScore:new Map(h),distance:new Map(c),parent:new Map(d)}),m.node===e)break;const y=u[m.node]||[];for(const b of y){if(l.includes(b))continue;let w=1;if(p[m.node]){const x=p[m.node].find(E=>E.node===b);x&&(w=x.weight)}const k=c.get(m.node)+w;if(!c.has(b)||k<c.get(b)){c.set(b,k),d.set(b,m.node);const x=f[b]||0,E=k+x;h.set(b,E);const _=o.findIndex(R=>R.node===b);_>=0?o[_]={node:b,f:E,g:k,h:x}:o.push({node:b,f:E,g:k,h:x}),r.set(b,m.node)}}}}if(r.has(e)||t===e){const o=[];let l=e;for(;l!==void 0;)o.push(l),l=r.get(l);const c=s[s.length-1]||{};a({...c,path:o})}B.steps=s}function hl(){B.grid||al(),B.steps.length===0&&cl(),B.stepIndex>=B.steps.length&&(B.stepIndex=0),B.playing=!0;const t=document.getElementById("btnPathPlay");t&&(t.innerHTML="â¸ Pause"),Jg()}function nn(){B.playing=!1,clearTimeout(B.timer);const t=document.getElementById("btnPathPlay");t&&(t.innerHTML="â–¶ Play")}function Jg(){var t,e,i,s;if(B.playing)if(B.stepIndex<B.steps.length){B.stepIndex++,Le(),em(),Ys();const r=document.getElementById("stepNumber");r&&(r.textContent=`Step ${B.stepIndex} of ${B.steps.length}`);const n=B.steps[B.stepIndex-1];if(n){const a=document.getElementById("nodesExploredStat"),o=document.getElementById("currentStepStat"),l=document.getElementById("pathLengthStat");a&&(a.textContent=n.visited?n.visited.size:0),o&&(o.textContent=B.stepIndex),l&&(l.textContent=n.path&&n.path.size>0?n.path.size:"â€”")}(t=O.play)==null||t.call(O,"slider_tick"),B.timer=setTimeout(Jg,Math.max(300,1500/B.speed))}else nn(),nd.clearCompletionTimers(),(e=document.getElementById("pathShimmerOverlay"))==null||e.classList.add("active"),B.completionTimers.push(setTimeout(()=>{var r;return(r=document.getElementById("pathShimmerOverlay"))==null?void 0:r.classList.remove("active")},1400)),(i=O.play)==null||i.call(O,"path_complete"),(s=O.playCompletionMelody)==null||s.call(O)}function em(){const t=B.steps[B.stepIndex-1];if(!t)return;const e=B.algo,i=document.getElementById("stepCounter");i&&(i.textContent=`Step ${B.stepIndex} / ${B.steps.length}`);const s=document.getElementById("currentNodeDisplay");s&&(s.textContent=t.current>=0?t.current:"-");const r=document.getElementById("visitedCount");if(r&&(r.textContent=t.visited?t.visited.size:0),e==="bfs"){const n=document.getElementById("queueDisplay");n&&t.queue&&(t.queue.length>0?n.innerHTML=t.queue.slice(0,15).map(l=>`<span class="node-badge queue">${l}</span>`).join("")+(t.queue.length>15?`<span class="node-badge more">+${t.queue.length-15}</span>`:""):n.innerHTML='<span class="empty-state">Empty</span>');const a=document.getElementById("distanceTableBody");if(a&&t.distance){const l=Array.from(t.distance.entries()).slice(-10);a.innerHTML=l.map(([c,h])=>`<tr><td>${c}</td><td>${h}</td></tr>`).join("")}const o=document.getElementById("parentTableBody");if(o&&t.parent){const l=Array.from(t.parent.entries()).slice(-10);o.innerHTML=l.map(([c,h])=>`<tr><td>${c}</td><td>${h===-1?"src":h}</td></tr>`).join("")}}else if(e==="dfs"){const n=document.getElementById("stackDisplay");n&&t.stack&&(t.stack.length>0?n.innerHTML=t.stack.slice(-15).reverse().map(c=>`<span class="node-badge stack">${c}</span>`).join("")+(t.stack.length>15?`<span class="node-badge more">...${t.stack.length-15} more</span>`:""):n.innerHTML='<span class="empty-state">Empty</span>');const a=document.getElementById("globalTimerDisplay");a&&(a.textContent=t.globalTimer||0);const o=document.getElementById("startTimeTableBody");if(o&&t.startTime){const c=Array.from(t.startTime.entries()).slice(-10);o.innerHTML=c.map(([h,d])=>`<tr><td>${h}</td><td>${d}</td></tr>`).join("")}const l=document.getElementById("endTimeTableBody");if(l&&t.endTime){const c=Array.from(t.endTime.entries()).slice(-10);l.innerHTML=c.map(([h,d])=>`<tr><td>${h}</td><td>${d}</td></tr>`).join("")}}}function Ft(){var n;nn(),nd.clearCompletionTimers(),B.stepIndex=0,B.steps=[],Le(),ki(),Ys();const t=document.getElementById("stepNumber");t&&(t.textContent="Step 0");const e=document.getElementById("nodesExploredStat"),i=document.getElementById("currentStepStat"),s=document.getElementById("pathLengthStat");e&&(e.textContent="0"),i&&(i.textContent="0"),s&&(s.textContent="â€”");const r=document.getElementById("pathInstructionOverlay");r&&(r.style.display="flex",r.style.opacity="1"),(n=O.play)==null||n.call(O,"reset")}let ip=!1;function dd(){const t=document.getElementById("pathCanvas");!t||ip||(ip=!0,t.addEventListener("click",e=>{var k,x;if(!B.grid||B.playing)return;const i=t.getBoundingClientRect(),{rows:s,cols:r,start:n,end:a,walls:o}=B.grid,l=i.width,c=i.height,h=Math.floor((l-20)/r),d=Math.floor((c-20)/s),u=Math.min(h,d,24),p=(l-r*u)/2,f=(c-s*u)/2,g=e.clientX-i.left,m=e.clientY-i.top,y=Math.floor((g-p)/u),b=Math.floor((m-f)/u);if(y<0||y>=r||b<0||b>=s)return;const w=b*r+y;w===n||w===a||(o.has(w)?(o.delete(w),(k=O.play)==null||k.call(O,"pop")):(o.add(w),(x=O.play)==null||x.call(O,"click")),B.steps=[],B.stepIndex=0,Le())}))}let sp=!1;function Xr(){B.grid||al(),dd(),pd(),ki(),Le(),Ys();const t=document.getElementById("stepNumber");if(t&&(t.textContent="Step 0"),sp)return;sp=!0;let e=document.getElementById("btnStartPathSim");const i=document.getElementById("pathInstructionOverlay");if(e&&i){const w=e.cloneNode(!0);e.parentNode.replaceChild(w,e),e=w,e.addEventListener("click",()=>{i.style.opacity="0",i.style.transition="opacity 0.4s ease",setTimeout(()=>{i.style.display="none"},400)})}let s=document.getElementById("btnPathStep");if(s){const w=s.cloneNode(!0);s.parentNode.replaceChild(w,s),s=w,s.addEventListener("click",()=>{ud()})}let r=document.getElementById("btnPathPlay");if(r){const w=r.cloneNode(!0);r.parentNode.replaceChild(w,r),r=w,r.addEventListener("click",()=>{B.playing?nn():hl()})}let n=document.getElementById("btnPathReset");if(n){const w=n.cloneNode(!0);n.parentNode.replaceChild(w,n),n=w,n.addEventListener("click",()=>{Ft()})}const a=document.getElementById("pathAlgoSelect");a&&a.addEventListener("change",()=>{const w=a.value;B.algo=w,document.querySelectorAll(".state-array-box:not(#dfsStateArrays *)");const k=document.getElementById("dfsStateArrays"),x=document.querySelector("#section-pathfinding .page-header h1");x&&(w==="dfs"?x.textContent="ðŸ§­ DFS Simulation (Depth-First Search)":w==="dijkstra"?x.textContent="âš¡ Dijkstra Simulation (Weighted Shortest Path)":w==="greedy"?x.textContent="ðŸŽ¯ Greedy Best-First Search (Heuristic-based)":w==="astar"?x.textContent="â­ A* Search Algorithm (Optimal + Heuristic)":x.textContent="ðŸ§­ BFS Simulation (Breadth-First Search)");const E=document.getElementById("pathAlgoDescription");if(E){const M={bfs:"Explores all neighbors at the current depth before moving deeper. Uses a Queue (FIFO) data structure. Guarantees the shortest path in unweighted graphs. Time complexity: O(V+E).",dfs:"Explores as far as possible along each branch before backtracking. Uses a Stack (LIFO) data structure. Useful for cycle detection, topological sorting, and maze solving. Time complexity: O(V+E).",dijkstra:"Finds the shortest path in weighted graphs using a priority queue. Always expands the node with minimum distance from source. Guarantees optimal paths for non-negative edge weights.",greedy:"A heuristic search that prioritizes nodes appearing closest to the goal. Uses h(n) to estimate distance to target. Fast but does not guarantee the shortest path.",astar:"Optimal pathfinding combining Dijkstra's algorithm with heuristics. Uses f(n) = g(n) + h(n) where g is the cost so far and h is the estimated remaining cost."};E.textContent=M[w]||M.bfs}const _=document.getElementById("overlayAlgoDescription"),R=document.getElementById("overlayGreyLabel");if(_){const M={bfs:'<strong style="color:#48bb78;">BFS</strong> uses <strong>Queue (FIFO)</strong> â€” explores level by level, always finds shortest path in unweighted graphs',dfs:'<strong style="color:#9f7aea;">DFS</strong> uses <strong>Stack (LIFO)</strong> â€” explores as deep as possible before backtracking',dijkstra:'<strong style="color:#4299e1;">Dijkstra</strong> uses <strong>Priority Queue</strong> â€” always picks minimum distance node, finds shortest path in weighted graphs',greedy:'<strong style="color:#ed8936;">Greedy Best-First</strong> uses <strong>Priority Queue by h(n)</strong> â€” picks node with lowest heuristic, fast but not always optimal',astar:'<strong style="color:#f6e05e;">A* Search</strong> uses <strong>Priority Queue by f(n)=g(n)+h(n)</strong> â€” combines cost and heuristic for optimal pathfinding'};_.innerHTML=M[w]||M.bfs}if(R){const M={bfs:"In Queue",dfs:"In Stack",dijkstra:"In Priority Queue",greedy:"In Open List",astar:"In Open List"};R.textContent=M[w]||"In Queue/Stack"}const C=document.getElementById("bfsQueueBox"),D=document.getElementById("dfsStackBox"),q=document.getElementById("dijkstraPQBox"),A=document.getElementById("greedyOpenListBox"),F=document.getElementById("greedyClosedListBox"),L=document.getElementById("astarOpenListBox"),W=document.getElementById("astarClosedListBox");C&&(C.style.display=w==="bfs"?"block":"none"),D&&(D.style.display=w==="dfs"?"block":"none"),q&&(q.style.display=w==="dijkstra"?"block":"none"),A&&(A.style.display=w==="greedy"?"block":"none"),F&&(F.style.display=w==="greedy"?"block":"none"),L&&(L.style.display=w==="astar"?"block":"none"),W&&(W.style.display=w==="astar"?"block":"none"),k&&(k.style.display=w==="dfs"?"block":"none"),w==="dijkstra"?(jg(),window.populateGoalDropdown&&window.populateGoalDropdown(),Le(),ki()):w==="greedy"?(Wg(),window.populateGoalDropdown&&window.populateGoalDropdown(),Le(),ki()):w==="astar"?(Fg(),window.populateGoalDropdown&&window.populateGoalDropdown(),Le(),ki()):window.populateGoalDropdown&&window.populateGoalDropdown(),Ft(),Ys()});const o=document.getElementById("pathSpeedSlider"),l=document.getElementById("pathSpeedLabel");o&&l&&o.addEventListener("input",()=>{B.speed=parseInt(o.value),l.textContent=`${B.speed}x`});function c(){const w=document.getElementById("goalNodeSelect");if(!w||!B.grid)return;const k=B.grid.nodes||[],x=B.grid.end;w.innerHTML="",k.forEach((E,_)=>{const R=document.createElement("option");R.value=_,R.textContent=E,_===x&&(R.selected=!0),w.appendChild(R)})}window.populateGoalDropdown=c;let h=document.getElementById("goalNodeSelect");if(h){const w=h.cloneNode(!0);h.parentNode.replaceChild(w,h),h=w,h.addEventListener("change",()=>{const k=parseInt(h.value);if(isNaN(k)||!B.grid)return;B.grid.end=k,B.steps=[],B.stepIndex=0,ki(),Le(),Ys();const x=document.getElementById("nodesExploredStat"),E=document.getElementById("currentStepStat"),_=document.getElementById("pathLengthStat");x&&(x.textContent="0"),E&&(E.textContent="0"),_&&(_.textContent="â€”")})}c();function d(w){const k=document.getElementById("graphEdgesSlider"),x=document.getElementById("graphEdgesLabel");if(!k)return;const E=w-1,_=w*(w-1)/2;k.min=E,k.max=_;let R=parseInt(k.value);R<E?R=E:R>_&&(R=Math.floor((E+_)/2)),k.value=R,x&&(x.textContent=R)}let u=document.getElementById("graphNodesSlider");const p=document.getElementById("graphNodesLabel");if(u){const w=u.cloneNode(!0);u.parentNode.replaceChild(w,u),u=w,u.addEventListener("input",()=>{const k=parseInt(u.value);p&&(p.textContent=k),d(k)})}let f=document.getElementById("graphEdgesSlider");const g=document.getElementById("graphEdgesLabel");if(f){const w=f.cloneNode(!0);f.parentNode.replaceChild(w,f),f=w,f.addEventListener("input",()=>{g&&(g.textContent=f.value)})}let m=document.getElementById("btnGenerateRandomGraph");if(m){const w=m.cloneNode(!0);m.parentNode.replaceChild(w,m),m=w,m.addEventListener("click",()=>{var _,R,C;const k=parseInt(((_=document.getElementById("graphNodesSlider"))==null?void 0:_.value)||8),x=parseInt(((R=document.getElementById("graphEdgesSlider"))==null?void 0:R.value)||10);PS(k,x),window.populateGoalDropdown&&window.populateGoalDropdown(),Le(),Ys(),tm(),ki();const E=document.getElementById("pathInstructionOverlay");E&&(E.style.opacity="0",setTimeout(()=>E.style.display="none",400)),(C=O.play)==null||C.call(O,"path_complete")})}const y=document.getElementById("pathEdgeListInput");function b(){if(!y)return;const w=y.value.trim();if(!w)return;const k=w.trim().split(`
`).filter(L=>L.trim()),x=new Set,E=[],_=B.algo==="dijkstra"||B.algo==="astar"||B.algo==="greedy";if(k.forEach(L=>{const W=L.trim().split(/\s+/);if(!(W.length===0||W[0]===""))if(W.length===1)x.add(W[0]);else{const M=W[0],G=W[1];x.add(M),x.add(G);let J=1;W.length>2?(J=parseFloat(W[2]),isNaN(J)&&(J=1)):_&&(J=Math.floor(Math.random()*9)+1),E.push({u:M,v:G,w:J})}}),x.size===0)return;const R=Array.from(x).sort(),C=new Map(R.map((L,W)=>[L,W])),D=R.length,q={},A={},F={};for(let L=0;L<D;L++)q[L]=[],A[L]=[],F[L]=Math.floor(Math.random()*20);E.forEach(L=>{const W=C.get(L.u),M=C.get(L.v);W===void 0||M===void 0||W===M||(q[W].includes(M)||(q[W].push(M),A[W].push({node:M,weight:L.w})),q[M].includes(W)||(q[M].push(W),A[M].push({node:W,weight:L.w})))}),B.grid={nodes:Array.from({length:D},(L,W)=>W),nodeLabels:R,adjacency:q,weightedAdjacency:A,heuristics:F,start:0,end:D-1,isRandomGraph:!0,rows:10,cols:10},B.grid.positions=null,window.populateGoalDropdown&&window.populateGoalDropdown(),ki(),Ft(),Le()}y&&y.addEventListener("input",()=>{clearTimeout(y.timeout),y.timeout=setTimeout(b,300)}),d(8)}function ud(){var t,e;if(B.algo||(t=document.getElementById("pathAlgoSelect"))!=null&&t.value,B.steps.length===0&&cl(),B.stepIndex<B.steps.length){B.stepIndex++,Le(),em(),Ys(),tm();const i=B.steps[B.stepIndex-1];if(i){const s=document.getElementById("nodesExploredStat"),r=document.getElementById("currentStepStat"),n=document.getElementById("pathLengthStat");s&&(s.textContent=i.visited?i.visited.size:0),r&&(r.textContent=B.stepIndex),n&&(n.textContent=i.path&&i.path.size>0?i.path.size:"â€”")}(e=O.play)==null||e.call(O,"step")}}function tm(){const t=document.getElementById("stepNumber");if(t){const e=B.steps.length;e>0?t.textContent=`Step ${B.stepIndex} of ${e}`:t.textContent="Step 0"}}function Ys(){var u,p;const t=((u=B.grid)==null?void 0:u.nodes)||["r","s","t","u","v","w","x","y"],e=B.steps[B.stepIndex-1]||{},i=B.algo||((p=document.getElementById("pathAlgoSelect"))==null?void 0:p.value)||"bfs",s=document.getElementById("queueGrid");s&&(e.queue&&e.queue.length>0?s.innerHTML=e.queue.map(f=>`<div style="background:#fff; border:1px solid #4299e1; padding:8px 14px; border-radius:8px; 
                    text-align:center; font-weight:600; font-size:0.9rem; box-shadow: 0 2px 6px rgba(66,153,225,0.25);
                    color: #1a365d;">
          ${t[f]!==void 0?t[f]:f}
        </div>`).join(""):s.innerHTML='<div style="color:var(--text-muted); padding:0.5rem; font-style:italic;">Empty</div>');const r=document.getElementById("priorityQueueGrid");r&&i==="dijkstra"&&(e.priorityQueue&&e.priorityQueue.length>0?r.innerHTML=e.priorityQueue.map(f=>`<div style="background:linear-gradient(135deg, #ffecd2 0%, #fcb69f 100%); border:1px solid #e0a87a; 
                    padding:8px 12px; border-radius:8px; text-align:center; font-weight:600; font-size:0.85rem; 
                    box-shadow: 0 1px 3px rgba(0,0,0,0.1);">
          (${f.dist===1/0?"âˆž":f.dist}, ${t[f.node]!==void 0?t[f.node]:f.node})
        </div>`).join(""):r.innerHTML='<div style="color:#999; padding:0.5rem; font-style:italic;">Empty</div>');const n=document.getElementById("openListGrid");n&&i==="greedy"&&(e.openList&&e.openList.length>0?n.innerHTML=e.openList.map(f=>`<div style="background:linear-gradient(135deg, #a8edea 0%, #fed6e3 100%); border:1px solid #82c5a7; 
                    padding:8px 12px; border-radius:8px; text-align:center; font-weight:600; font-size:0.85rem; 
                    box-shadow: 0 1px 3px rgba(0,0,0,0.1);">
          (${f.h}, ${t[f.node]!==void 0?t[f.node]:f.node})
        </div>`).join(""):n.innerHTML='<div style="color:#999; padding:0.5rem; font-style:italic;">Empty</div>');const a=document.getElementById("closedListGrid");a&&i==="greedy"&&(e.closedList&&e.closedList.length>0?a.innerHTML=e.closedList.map(f=>`<div style="background:#2C2C2C; color:#fff; border:1px solid #444; 
                    padding:8px 12px; border-radius:8px; text-align:center; font-weight:600; font-size:0.85rem; 
                    box-shadow: 0 1px 3px rgba(0,0,0,0.1);">
          ${t[f]!==void 0?t[f]:f}
        </div>`).join(""):a.innerHTML='<div style="color:#999; padding:0.5rem; font-style:italic;">Empty</div>');const o=document.getElementById("astarOpenListGrid");o&&i==="astar"&&(e.astarOpenList&&e.astarOpenList.length>0?o.innerHTML=e.astarOpenList.map(f=>`<div style="background:linear-gradient(135deg, #667eea 0%, #764ba2 100%); color:#fff; border:1px solid #5a67d8; 
                    padding:8px 12px; border-radius:8px; text-align:center; font-weight:600; font-size:0.8rem; 
                    box-shadow: 0 2px 4px rgba(0,0,0,0.2);">
          <div style="font-size:0.9rem;">f=${f.f}</div>
          <div style="font-size:0.7rem; opacity:0.9;">${t[f.node]!==void 0?t[f.node]:f.node}</div>
          <div style="font-size:0.65rem; opacity:0.8;">g=${f.g} h=${f.h}</div>
        </div>`).join(""):o.innerHTML='<div style="color:#999; padding:0.5rem; font-style:italic;">Empty</div>');const l=document.getElementById("astarClosedListGrid");l&&i==="astar"&&(e.astarClosedList&&e.astarClosedList.length>0?l.innerHTML=e.astarClosedList.map(f=>`<div style="background:#1a1a2e; color:#fff; border:1px solid #16213e; 
                    padding:8px 12px; border-radius:8px; text-align:center; font-weight:600; font-size:0.85rem; 
                    box-shadow: 0 1px 3px rgba(0,0,0,0.2);">
          ${t[f]!==void 0?t[f]:f}
        </div>`).join(""):l.innerHTML='<div style="color:#999; padding:0.5rem; font-style:italic;">Empty</div>');const c=document.getElementById("visitedGrid");if(c){const f=new Set(e.visited||[]),g=Math.min(t.length,6);c.style.gridTemplateColumns=`repeat(${g}, 1fr)`,c.innerHTML=t.map((m,y)=>`<div style="border:1px solid var(--border-subtle);padding:4px 2px;text-align:center;background:var(--bg-elevated);">
        <div style="font-weight:600;font-size:0.85rem;color:var(--text-primary);">${f.has(y)?1:0}</div>
        <div style="font-size:0.55rem;color:var(--text-muted);">${m}</div>
      </div>`).join("")}const h=document.getElementById("distanceGrid");if(h){const f=e.distance||new Map,g=Math.min(t.length,6);h.style.gridTemplateColumns=`repeat(${g}, 1fr)`,h.innerHTML=t.map((m,y)=>`<div style="border:1px solid var(--border-subtle);padding:4px 2px;text-align:center;background:var(--bg-elevated);">
        <div style="font-weight:600;font-size:0.85rem;color:var(--text-primary);">${f.get?f.get(y)??"âˆž":"âˆž"}</div>
        <div style="font-size:0.55rem;color:var(--text-muted);">${m}</div>
      </div>`).join("")}const d=document.getElementById("parentGrid");if(d){const f=e.parent||new Map,g=Math.min(t.length,6);d.style.gridTemplateColumns=`repeat(${g}, 1fr)`,d.innerHTML=t.map((m,y)=>{const b=f.get?f.get(y):void 0;return`<div style="border:1px solid var(--border-subtle);padding:4px 2px;text-align:center;background:var(--bg-elevated);">
        <div style="font-weight:600;font-size:0.85rem;color:var(--text-primary);">${b===-1?"-1":b!==void 0?t[b]:"-"}</div>
        <div style="font-size:0.55rem;color:var(--text-muted);">${m}</div>
      </div>`}).join("")}if(i==="dfs"){const f=document.getElementById("stackGrid");f&&(e.stack&&e.stack.length>0?f.innerHTML=e.stack.map(y=>`<div style="background:#fff; border:1px solid #9f7aea; padding:8px 14px; border-radius:8px; 
                      text-align:center; font-weight:600; font-size:0.9rem; box-shadow: 0 2px 6px rgba(159,122,234,0.25);
                      color: #44337a;">
            ${t[y]!==void 0?t[y]:y}
          </div>`).join(""):f.innerHTML='<div style="color:#999; padding:0.5rem; font-style:italic;">Empty</div>');const g=document.getElementById("startTimeGrid");if(g){const y=e.startTime||new Map,b=Math.min(t.length,6);g.style.gridTemplateColumns=`repeat(${b}, 1fr)`,g.innerHTML=t.map((w,k)=>`<div style="border:1px solid #ddd;padding:4px 2px;text-align:center;">
          <div style="font-weight:600;font-size:0.85rem;">${y.get?y.get(k)??0:0}</div>
          <div style="font-size:0.55rem;color:#888;">${w}</div>
        </div>`).join("")}const m=document.getElementById("endTimeGrid");if(m){const y=e.endTime||new Map,b=Math.min(t.length,6);m.style.gridTemplateColumns=`repeat(${b}, 1fr)`,m.innerHTML=t.map((w,k)=>`<div style="border:1px solid #ddd;padding:4px 2px;text-align:center;">
          <div style="font-weight:600;font-size:0.85rem;">${y.get?y.get(k)??0:0}</div>
          <div style="font-size:0.55rem;color:#888;">${w}</div>
        </div>`).join("")}}}function ki(){Hg()}function im(){}const wt={isDragging:!1,draggedNode:-1,offsetX:0,offsetY:0};function pd(){const t=document.getElementById("pathCanvas");if(!t)return;const e=30,i=r=>{const n=t.getBoundingClientRect();return{x:r.clientX-n.left,y:r.clientY-n.top}},s=(r,n)=>{var c;if(!((c=B.grid)!=null&&c.positions))return-1;const a=B.grid.positions,o=t.getBoundingClientRect().width/800,l=t.getBoundingClientRect().height/400;for(let h=0;h<a.length;h++){const d=a[h],u=d.x*o,p=d.y*l,f=r-u,g=n-p;if(f*f+g*g<=e*e)return h}return-1};t.addEventListener("mousedown",r=>{var l;const{x:n,y:a}=i(r),o=s(n,a);if(o!==-1&&((l=B.grid)!=null&&l.positions)){wt.isDragging=!0,wt.draggedNode=o;const c=B.grid.positions[o],h=t.getBoundingClientRect().width/800,d=t.getBoundingClientRect().height/400;wt.offsetX=n-c.x*h,wt.offsetY=a-c.y*d,t.style.cursor="grabbing"}}),t.addEventListener("mousemove",r=>{var o;const{x:n,y:a}=i(r);if(wt.isDragging&&wt.draggedNode!==-1&&((o=B.grid)!=null&&o.positions)){const l=t.getBoundingClientRect().width/800,c=t.getBoundingClientRect().height/400;B.grid.positions[wt.draggedNode].x=(n-wt.offsetX)/l,B.grid.positions[wt.draggedNode].y=(a-wt.offsetY)/c,Le()}else{const l=s(n,a);t.style.cursor=l>=0?"grab":"default"}}),t.addEventListener("mouseup",()=>{wt.isDragging&&(wt.isDragging=!1,wt.draggedNode=-1,t.style.cursor="default")}),t.addEventListener("mouseleave",()=>{wt.isDragging&&(wt.isDragging=!1,wt.draggedNode=-1,t.style.cursor="default")})}typeof window<"u"&&(window.renderPath=Le,window.generatePathSteps=cl,window.playPath=hl,window.pausePath=nn,window.resetPath=Ft,window.stepPath=ud,window.initPathfinding=Xr,window.setupWallClickHandler=dd,window.setupDraggableNodes=pd,window.startPhysicsAnimation=ki,window.stopPhysicsAnimation=im);class e1{constructor(){this.container=null}init(e,i){this.container=e,e.querySelector("#pathCanvas")||(e.innerHTML='<canvas id="pathCanvas" style="width:100%; height:100%;"></canvas>'),Xr()}update(e){e.grid&&(B.grid=e.grid);const i={visited:new Set(e.visited||[]),frontier:new Set(e.frontier||[]),path:new Set(e.path||[]),current:e.current};B.steps=[i],B.stepIndex=1,Le()}setSpeed(e){B.speed=e}renderGhostState(e,i){const s=document.createElement("canvas");s.style.width="100%",s.style.height="100%",s.style.position="absolute",s.style.top="0",s.style.left="0",s.style.pointerEvents="none",i.appendChild(s);const r=Zg(s,"transparent");if(!r)return;const{ctx:n,w:a,h:o}=r,{rows:l,cols:c}=B.grid||{rows:20,cols:20},h=Math.floor((a-20)/c),d=Math.floor((o-20)/l),u=Math.min(h,d,24),p=(a-c*u)/2,f=(o-l*u)/2;e.path&&e.path.forEach(g=>{const m=Math.floor(g/c),y=g%c,b=p+y*u,w=f+m*u;n.fillStyle="rgba(239, 68, 68, 0.5)",n.beginPath(),n.roundRect(b+1,w+1,u-2,u-2,3),n.fill()})}handleAction(e,i){e==="HIGHLIGHT_CELLS"&&console.log("Highlighting cells:",i.indices)}}const a$=Object.freeze(Object.defineProperty({__proto__:null,PathfindingRenderer:e1,generatePathSteps:cl,initPathfinding:Xr,initPathfindingPhysics:Hg,pausePath:nn,playPath:hl,renderPath:Le,resetPath:Ft,setupDraggableNodes:pd,setupWallClickHandler:dd,startPhysicsAnimation:ki,stepPath:ud,stopPhysicsAnimation:im},Symbol.toStringTag,{value:"Module"}));function t1(t,e="#F8F4EC"){if(!t)return null;const i=t.getBoundingClientRect(),s=Math.min(2,window.devicePixelRatio||1),r=Math.max(1,Math.floor(i.width)),n=Math.max(1,Math.floor(i.height));t.width=r*s,t.height=n*s;const a=t.getContext("2d");return a.setTransform(1,0,0,1,0,0),a.scale(s,s),a.clearRect(0,0,r,n),a.fillStyle=e,a.fillRect(0,0,r,n),{ctx:a,w:r,h:n,dpr:s}}function dl(){const t=document.getElementById("searchCanvas"),e=t1(t);if(!e)return;const{ctx:i,w:s,h:r}=e,n=Ce.data,a=n.length;if(a===0)return;const o=Ce.steps[Ce.stepIndex-1]||{},l=o.checked||new Set,c=o.found??-1,h=o.low??-1,d=o.high??-1,u=o.mid??-1,p=Math.max(...n,1),f=15,g=(s-f*2)/a;for(let m=0;m<a;m++){const y=n[m],b=y/p*(r-f*2-30),w=f+m*g,k=r-f-b;let x;c===m?x="#2F6A57":u===m?x="#E07A5F":l.has(m)?x="#5B8BA0":m>=h&&m<=d?x="#D4A853":x="#C8BFB0",i.fillStyle=x,i.beginPath(),i.roundRect(w+1,k,Math.max(1,g-2),b,2),i.fill(),a<=30&&g>12&&(i.fillStyle="#333",i.font=`bold ${Math.min(10,g-4)}px system-ui`,i.textAlign="center",i.fillText(y,w+g/2,k-4))}Ce.target!==null&&(i.fillStyle="#8B687F",i.font="bold 14px Inter",i.textAlign="right",i.fillText(`Target: ${Ce.target}`,s-f,f+15))}function sm(){const t=Ce.data.slice(),e=Ce.target,i=Ce.algo,s=[],r=new Set;function n(a={}){s.push({arr:t.slice(),checked:new Set(r),low:a.low??-1,high:a.high??-1,mid:a.mid??-1,found:a.found??-1})}if(i==="linear"){for(let a=0;a<t.length;a++)if(r.add(a),n({mid:a}),t[a]===e){n({found:a});break}}else if(i==="binary"){let a=0,o=t.length-1;for(;a<=o;){const l=Math.floor((a+o)/2);if(r.add(l),n({low:a,high:o,mid:l}),t[l]===e){n({found:l});break}else t[l]<e?a=l+1:o=l-1}}else if(i==="jump"){const a=t.length,o=Math.floor(Math.sqrt(a));let l=0,c=o;for(;c<a&&t[Math.min(c,a-1)]<e;)r.add(Math.min(c,a-1)),n({low:l,high:Math.min(c,a-1),mid:Math.min(c,a-1)}),l=c,c+=o;for(let h=l;h<=Math.min(c,a-1);h++)if(r.add(h),n({low:l,high:Math.min(c,a-1),mid:h}),t[h]===e){n({found:h});break}}else if(i==="interpolation"){let a=0,o=t.length-1;for(;a<=o&&e>=t[a]&&e<=t[o];){if(a===o){r.add(a),n({low:a,high:o,mid:a}),t[a]===e&&n({found:a});break}const l=a+Math.floor((e-t[a])*(o-a)/(t[o]-t[a]));if(r.add(l),n({low:a,high:o,mid:l}),t[l]===e){n({found:l});break}else t[l]<e?a=l+1:o=l-1}}else if(i==="exponential")if(t[0]===e)r.add(0),n({found:0});else{let a=1;for(;a<t.length&&t[a]<e;)r.add(a),n({mid:a}),a*=2;let o=Math.floor(a/2),l=Math.min(a,t.length-1);for(;o<=l;){const c=Math.floor((o+l)/2);if(r.add(c),n({low:o,high:l,mid:c}),t[c]===e){n({found:c});break}else t[c]<e?o=c+1:l=c-1}}Ce.steps=s}function i1(){var t,e;Ce.steps.length===0&&sm(),Ce.stepIndex>=Ce.steps.length&&(Ce.stepIndex=0),Ce.playing=!0,(t=document.getElementById("btnSearchPlay"))==null||t.classList.add("section-hidden"),(e=document.getElementById("btnSearchPause"))==null||e.classList.remove("section-hidden"),rm()}function Io(){var t,e;Ce.playing=!1,clearTimeout(Ce.timer),(t=document.getElementById("btnSearchPlay"))==null||t.classList.remove("section-hidden"),(e=document.getElementById("btnSearchPause"))==null||e.classList.add("section-hidden")}function rm(){var t,e;if(Ce.playing)if(Ce.stepIndex<Ce.steps.length){const i=Ce.steps[Ce.stepIndex];if(Ce.stepIndex++,dl(),(t=O.play)==null||t.call(O,"slider_tick"),i.found>=0){Io(),(e=O.play)==null||e.call(O,"search_found");return}Ce.timer=setTimeout(rm,Math.max(50,300/Ce.speed))}else Io()}function s1(){var t,e;Io(),(t=Fn.clearTimers)==null||t.call(Fn),Ce.stepIndex=0,Ce.steps=[],dl(),(e=O.play)==null||e.call(O,"reset")}function r1(){Ce.data.length||(Ce.data=Array.from({length:30},(t,e)=>e*3+1),Ce.target=Ce.data[Math.floor(Math.random()*Ce.data.length)]),dl()}typeof window<"u"&&(window.renderSearch=dl,window.generateSearchSteps=sm,window.playSearch=i1,window.pauseSearch=Io,window.resetSearch=s1,window.initSearch=r1);const n1={parseArray(t){if(t=t.trim(),t.match(/^random\((\d+)\)$/i)){const r=parseInt(RegExp.$1);return Array.from({length:Math.min(r,50)},()=>Math.floor(Math.random()*100)+5)}if(t.match(/^sorted\((\d+)\)$/i)){const r=parseInt(RegExp.$1);return Array.from({length:Math.min(r,50)},(n,a)=>a*10+5)}if(t.match(/^reversed\((\d+)\)$/i)){const r=parseInt(RegExp.$1);return Array.from({length:Math.min(r,50)},(n,a)=>(r-a)*10)}if(t.match(/^nearlysorted\((\d+)\)$/i)){const r=parseInt(RegExp.$1),n=Array.from({length:Math.min(r,50)},(a,o)=>o*10+5);for(let a=0;a<Math.ceil(r*.1);a++){const o=Math.floor(Math.random()*n.length),l=Math.floor(Math.random()*n.length);[n[o],n[l]]=[n[l],n[o]]}return n}const e=t.replace(/[\[\]]/g,"").trim(),i=e.includes(",")?/,\s*/:/\s+/,s=e.split(i).map(r=>parseInt(r.trim()));if(s.some(isNaN))throw new Error("Invalid number format");return s},validate(t){return!t||t.length<2?{valid:!1,error:"Need at least 2 elements"}:t.length>50?{valid:!1,error:"Maximum 50 elements allowed"}:t.some(e=>e<0||e>500)?{valid:!1,error:"Values must be 0-500"}:{valid:!0}},applyToSort(t){try{const e=this.parseArray(t),i=this.validate(e);if(!i.valid)return window.showToast&&window.showToast(i.error,"error"),!1;window.sortState&&(window.sortState.data=e,window.sortState.size=e.length,window.sortState.steps=[],window.sortState.stepIndex=0,window.sortState.stats={comparisons:0,swaps:0});const s=document.getElementById("sizeSlider");if(s){s.value=e.length;const r=document.getElementById("sizeLabel");r&&(r.textContent=e.length)}return window.renderSort&&window.renderSort(),window.generateSortSteps&&window.generateSortSteps(),window.showToast&&window.showToast(`Custom array applied (${e.length} elements)`,"success"),!0}catch{return window.showToast&&window.showToast("Invalid input format","error"),!1}}};typeof window<"u"&&(window.InputParser=n1);const a1={simulatedPlayers:[{name:"AlgoAce",baseXP:200,icon:"ðŸ§‘â€ðŸ’»",style:"steady"},{name:"RecursiveRita",baseXP:150,icon:"ðŸ‘©â€ðŸŽ“",style:"sporadic"},{name:"DataDan",baseXP:300,icon:"ðŸ‘¨â€ðŸ’¼",style:"competitive"},{name:"QueryQueen",baseXP:180,icon:"ðŸ‘©â€ðŸ’»",style:"steady"},{name:"StackSam",baseXP:100,icon:"ðŸ§‘â€ðŸŽ“",style:"casual"},{name:"TreeTina",baseXP:250,icon:"ðŸ‘©â€ðŸ”¬",style:"competitive"},{name:"HashHenry",baseXP:140,icon:"ðŸ‘¨â€ðŸ”¬",style:"sporadic"}],calculatePlayerXP(t,e){const i={steady:()=>t.baseXP+Math.random()*50,sporadic:()=>Math.random()>.5?t.baseXP*2:t.baseXP*.5,competitive:()=>t.baseXP*(1+Math.random()*.8),casual:()=>t.baseXP*(.5+Math.random()*.5)},s=Math.sin(e*.7+t.name.length)*30;return Math.max(0,Math.floor(i[t.style]()+s))},getWeeklyLeaderboard(t){const e=Math.floor(Date.now()/6048e5),i=this.simulatedPlayers.map(s=>({...s,xp:this.calculatePlayerXP(s,e),isUser:!1}));return i.push({name:"You",icon:"â­",xp:t,isUser:!0}),i.sort((s,r)=>r.xp-s.xp).map((s,r)=>({...s,rank:r+1,zone:r<3?"promotion":r>=i.length-2?"demotion":"safe"}))},getRankEmoji(t){return{1:"ðŸ¥‡",2:"ðŸ¥ˆ",3:"ðŸ¥‰"}[t]||t},render(t){var r,n;const e=document.getElementById(t);if(!e)return;const i=((r=Ge.data)==null?void 0:r.totalXP)||((n=Ge.state)==null?void 0:n.totalXP)||0,s=this.getWeeklyLeaderboard(i);e.innerHTML=`
      <div class="leaderboard-card">
        <div class="leaderboard-header">
          <span class="trophy">ðŸ†</span>
          <span class="title">Weekly Leaderboard</span>
          <span class="reset-timer" id="leaderboardTimer"></span>
        </div>
        <div class="leaderboard-list">
          ${s.map(a=>`
            <div class="leaderboard-row ${a.zone} ${a.isUser?"is-user":""}">
              <span class="rank ${a.rank<=3?"top-three":""}">${this.getRankEmoji(a.rank)}</span>
              <span class="player-icon">${a.icon}</span>
              <span class="player-name">${a.name}</span>
              <span class="player-xp">${a.xp} XP</span>
            </div>
          `).join("")}
        </div>
        <div class="leaderboard-legend">
          <span>ðŸ”¼ Top 3 = Promotion</span>
          <span>ðŸ”½ Bottom 2 = Demotion</span>
        </div>
      </div>
    `,this.updateTimer()},updateTimer(){const t=document.getElementById("leaderboardTimer");if(!t)return;const e=new Date,i=new Date;i.setDate(e.getDate()+((8-e.getDay())%7||7)),i.setHours(0,0,0,0);const s=i-e,r=Math.floor(s/(1e3*60*60*24)),n=Math.floor(s%(1e3*60*60*24)/(1e3*60*60));t.textContent=`Resets in ${r}d ${n}h`}},o1={getStats(){var t,e,i;return{streak:((t=Ge.data)==null?void 0:t.currentStreak)||0,xp:((e=Ge.data)==null?void 0:e.totalXP)||0,rank:((i=Mg.getCurrentTier())==null?void 0:i.name)||"Bronze"}},shareToClipboard(){const t=this.getStats(),e=`ðŸŽ“ I'm on a ${t.streak}-day DSA learning streak!
âš¡ ${t.xp} XP earned â€¢ ðŸ† ${t.rank} League

Join me at DSA Study Sanctuary!`;navigator.clipboard.writeText(e).then(()=>{T("ðŸ“‹ Copied to clipboard!","success")})},shareNative(){const t=this.getStats();navigator.share?navigator.share({title:"DSA Study Sanctuary Progress",text:`I'm on a ${t.streak}-day streak with ${t.xp} XP! ðŸ”¥`,url:window.location.href}):this.shareToClipboard()},render(t){const e=document.getElementById(t);if(!e)return;const i=this.getStats();e.innerHTML=`
      <div class="share-panel">
        <h3>ðŸ“¤ Share Your Progress</h3>
        <div class="share-preview">
          <div class="share-preview-title">ðŸŽ“ DSA Study Sanctuary</div>
          <div class="share-preview-streak">ðŸ”¥ ${i.streak} Day Streak</div>
          <div class="share-preview-stats">âš¡ ${i.xp} XP â€¢ ðŸ† ${i.rank}</div>
        </div>
        <div class="share-buttons">
          <button class="share-btn copy" onclick="ShareSystem.shareToClipboard()">ðŸ“‹ Copy</button>
          <button class="share-btn native" onclick="ShareSystem.shareNative()">ðŸ“¤ Share</button>
        </div>
      </div>
    `}};typeof window<"u"&&(window.SocialLeaderboard=a1,window.ShareSystem=o1);const l1={settings:{focusDuration:25*60*1e3,breakDuration:5*60*1e3,longBreakDuration:15*60*1e3,sessionsUntilLongBreak:4},state:{isRunning:!1,isPaused:!1,mode:"focus",timeRemaining:25*60*1e3,sessionsCompleted:0,intervalId:null},start(){this.state.isRunning&&!this.state.isPaused||(this.state.isRunning=!0,this.state.isPaused=!1,this.state.intervalId||(this.state.intervalId=setInterval(()=>this.tick(),1e3)),this.updateUI(),T(`ðŸŽ¯ ${this.state.mode==="focus"?"Focus":"Break"} time started!`,"success"))},pause(){this.state.isPaused=!0,this.updateUI()},reset(){this.state.isRunning=!1,this.state.isPaused=!1,this.state.mode="focus",this.state.timeRemaining=this.settings.focusDuration,this.state.intervalId&&(clearInterval(this.state.intervalId),this.state.intervalId=null),this.updateUI()},tick(){!this.state.isRunning||this.state.isPaused||(this.state.timeRemaining-=1e3,this.state.timeRemaining<=0&&this.handleSessionComplete(),this.updateUI())},handleSessionComplete(){this.state.mode==="focus"?(this.state.sessionsCompleted++,Ge.addXP(50,"Focus session completed"),Li.burst(window.innerWidth/2,window.innerHeight/2,30),T("ðŸŽ‰ Focus session complete! +50 XP","success"),this.state.sessionsCompleted%this.settings.sessionsUntilLongBreak===0?(this.state.mode="longBreak",this.state.timeRemaining=this.settings.longBreakDuration):(this.state.mode="break",this.state.timeRemaining=this.settings.breakDuration)):(this.state.mode="focus",this.state.timeRemaining=this.settings.focusDuration,T("ðŸŽ¯ Break over! Ready to focus?","info"))},formatTime(t){const e=Math.floor(t/6e4),i=Math.floor(t%6e4/1e3);return`${e.toString().padStart(2,"0")}:${i.toString().padStart(2,"0")}`},getModeLabel(){return{focus:"ðŸŽ¯ Focus Time",break:"â˜• Short Break",longBreak:"ðŸ§˜ Long Break"}[this.state.mode]},updateUI(){const t=document.getElementById("pomodoroTime"),e=document.getElementById("pomodoroMode"),i=document.getElementById("pomodoroSessions"),s=document.querySelector(".pomodoro-timer");t&&(t.textContent=this.formatTime(this.state.timeRemaining)),e&&(e.textContent=this.getModeLabel()),i&&(i.textContent=`Session ${this.state.sessionsCompleted+1}`),s&&s.classList.toggle("running",this.state.isRunning&&!this.state.isPaused)},setFocusDuration(t){this.settings.focusDuration=t*60*1e3,this.state.mode==="focus"&&!this.state.isRunning&&(this.state.timeRemaining=this.settings.focusDuration,this.updateUI())},setBreakDuration(t){this.settings.breakDuration=t*60*1e3},render(t){const e=document.getElementById(t);e&&(e.innerHTML=`
      <div class="pomodoro-card">
        <h3>â±ï¸ Focus Timer</h3>
        <div class="pomodoro-timer">
          <div class="pomodoro-time" id="pomodoroTime">${this.formatTime(this.state.timeRemaining)}</div>
          <div class="pomodoro-mode" id="pomodoroMode">${this.getModeLabel()}</div>
        </div>
        <div class="pomodoro-controls">
          <button class="pomodoro-btn primary" onclick="PomodoroTimer.start()">â–¶ Start</button>
          <button class="pomodoro-btn secondary" onclick="PomodoroTimer.pause()">â¸ Pause</button>
          <button class="pomodoro-btn secondary" onclick="PomodoroTimer.reset()">â†º Reset</button>
        </div>
        <div class="pomodoro-sessions" id="pomodoroSessions">Session ${this.state.sessionsCompleted+1}</div>
      </div>
    `)}};typeof window<"u"&&(window.PomodoroTimer=l1);const Zi={startTime:Date.now(),celebratedMilestones:new Set,MILESTONES:[{minutes:5,message:"ðŸŒŸ 5 minutes of focused learning!"},{minutes:15,message:"ðŸŽ¯ 15 minutes! Great momentum!"},{minutes:30,message:"ðŸ”¥ 30 minutes! You're on fire!"},{minutes:60,message:"ðŸ† 1 HOUR! Amazing dedication!"}],init(){this.startTime=Date.now(),this.loadCelebratedMilestones(),this.startMilestoneCheck()},loadCelebratedMilestones(){const t=new Date().toISOString().slice(0,10);try{const e=localStorage.getItem("cse-helper-milestones-"+t);e&&(this.celebratedMilestones=new Set(JSON.parse(e)))}catch(e){console.warn("[SessionManager] Failed to load milestones:",e)}},startMilestoneCheck(){setInterval(()=>this.checkMilestones(),3e4)},checkMilestones(){const t=Math.floor((Date.now()-this.startTime)/6e4);for(const e of this.MILESTONES)if(t>=e.minutes&&!this.celebratedMilestones.has(e.minutes)){this.celebrateMilestone(e),this.celebratedMilestones.add(e.minutes),this.saveMilestones();break}},celebrateMilestone(t){var i;const e=document.getElementById("toast");e&&(e.innerHTML=`
        <span style="font-size: 1.3em;">ðŸŽ‰</span>
        <span>${t.message}</span>
      `,e.className="toast milestone",e.classList.add("show"),setTimeout(()=>e.classList.remove("show"),4e3)),this.triggerConfetti(),(i=O.play)==null||i.call(O,"toast_success")},triggerConfetti(){const t=document.getElementById("celebrationOverlay");if(!t)return;const e=["#2F6A57","#7BA38C","#5B8BA0","#D4A853","#E07A5F"],i=50;for(let s=0;s<i;s++){const r=document.createElement("div");r.className="confetti",r.style.left=Math.random()*100+"vw",r.style.backgroundColor=e[Math.floor(Math.random()*e.length)],r.style.animationDelay=Math.random()*.5+"s",r.style.animationDuration=2+Math.random()*2+"s",t.appendChild(r),setTimeout(()=>r.remove(),4e3)}},getStudyTime(){return Math.floor((Date.now()-this.startTime)/1e3)},getFormattedStudyTime(){const t=this.getStudyTime(),e=Math.floor(t/60),i=t%60;return`${e}:${i.toString().padStart(2,"0")}`},saveMilestones(){const t=new Date().toISOString().slice(0,10);localStorage.setItem("cse-helper-milestones-"+t,JSON.stringify([...this.celebratedMilestones]))},saveStudyTime(){const t=new Date().toISOString().slice(0,10),e=Math.floor((Date.now()-this.startTime)/1e3);localStorage.setItem("cse-helper-study-"+t,String(e))},saveSettings(t,e){try{const i=JSON.parse(localStorage.getItem("cse-helper-settings")||"{}");i[t]=e,localStorage.setItem("cse-helper-settings",JSON.stringify(i))}catch(i){console.warn("[SessionManager] Failed to save settings:",i)}},loadSettings(t,e){try{const i=JSON.parse(localStorage.getItem("cse-helper-settings")||"{}");return i[t]!==void 0?i[t]:e}catch{return e}}};typeof window<"u"&&(window.SessionManager=Zi);const Vs={xp:0,level:1,streak:0,lastActiveDate:null,achievements:[],xpHistory:[],streakFreezes:0,maxFreezes:2,lastFreezeEarned:null,weekendMode:!0,LEVELS:[{level:1,xp:0,title:"ðŸŒ± Beginner"},{level:2,xp:50,title:"ðŸ” Explorer"},{level:3,xp:150,title:"ðŸ“š Student"},{level:4,xp:300,title:"âš¡ Practitioner"},{level:5,xp:500,title:"ðŸŽ¯ Specialist"},{level:6,xp:750,title:"ðŸ’Ž Expert"},{level:7,xp:1e3,title:"ðŸ† Master"},{level:8,xp:1500,title:"ðŸ”¥ Grandmaster"},{level:9,xp:2e3,title:"â­ Legend"},{level:10,xp:3e3,title:"ðŸ‘‘ Algorithm God"}],XP_VALUES:{sort_complete:10,sort_step:1,path_found:15,sql_challenge_solved:25,sql_query_run:3,quiz_correct:10,quiz_attempt:2,ds_operation:2,daily_login:5,streak_bonus:3},ACHIEVEMENTS:{first_sort:{id:"first_sort",title:"ðŸŽ¯ First Sort",desc:"Complete your first sorting visualization",check:t=>t.sorts>=1},sort_master:{id:"sort_master",title:"ðŸ“Š Sort Collector",desc:"Complete 10 sorting visualizations",check:t=>t.sorts>=10},sql_rookie:{id:"sql_rookie",title:"ðŸ§ª SQL Rookie",desc:"Solve your first SQL challenge",check:t=>t.sqlSolved>=1},sql_ninja:{id:"sql_ninja",title:"ðŸ¥· SQL Ninja",desc:"Solve 5 SQL challenges",check:t=>t.sqlSolved>=5},pathfinder:{id:"pathfinder",title:"ðŸ—ºï¸ Pathfinder",desc:"Find your first path",check:t=>t.paths>=1},streak_3:{id:"streak_3",title:"ðŸ”¥ Warming Up",desc:"Maintain a 3-day streak",check:t=>t.maxStreak>=3},streak_7:{id:"streak_7",title:"ðŸ”¥ On Fire",desc:"Maintain a 7-day streak",check:t=>t.maxStreak>=7},streak_30:{id:"streak_30",title:"ðŸ”¥ Consistency King",desc:"Maintain a 30-day streak",check:t=>t.maxStreak>=30},level_5:{id:"level_5",title:"â­ Rising Star",desc:"Reach level 5",check:t=>t.level>=5},level_10:{id:"level_10",title:"ðŸ‘‘ Algorithm God",desc:"Reach maximum level",check:t=>t.level>=10},quiz_whiz:{id:"quiz_whiz",title:"ðŸ§  Quiz Whiz",desc:"Answer 10 quiz questions correctly",check:t=>t.quizCorrect>=10}},stats:{sorts:0,paths:0,sqlSolved:0,sqlQueries:0,quizCorrect:0,dsOps:0,maxStreak:0,level:1},init(){this.load(),this.checkDailyLogin(),this.updateUI()},load(){try{const t=localStorage.getItem("cse-helper-progress");if(t){const e=JSON.parse(t);this.xp=e.xp||0,this.level=e.level||1,this.streak=e.streak||0,this.lastActiveDate=e.lastActiveDate||null,this.achievements=e.achievements||[],this.stats={...this.stats,...e.stats},this.streakFreezes=e.streakFreezes||0,this.lastFreezeEarned=e.lastFreezeEarned||null,this.weekendMode=e.weekendMode!==!1}}catch(t){console.warn("[ProgressManager] Failed to load progress:",t)}},save(){try{localStorage.setItem("cse-helper-progress",JSON.stringify({xp:this.xp,level:this.level,streak:this.streak,lastActiveDate:this.lastActiveDate,achievements:this.achievements,stats:this.stats,streakFreezes:this.streakFreezes,lastFreezeEarned:this.lastFreezeEarned,weekendMode:this.weekendMode}))}catch(t){console.warn("[ProgressManager] Failed to save progress:",t)}},checkDailyLogin(){const t=new Date().toISOString().slice(0,10);if(this.lastActiveDate!==t){const e=this.lastActiveDate?new Date(this.lastActiveDate+"T00:00:00"):null,i=new Date(t+"T00:00:00");if(e){const s=Math.floor((i-e)/864e5);s===1?(this.streak++,this.addXP(this.XP_VALUES.daily_login+this.streak*this.XP_VALUES.streak_bonus,"ðŸ”¥ Daily streak bonus!")):s>1&&(this.streakFreezes>0&&s-1<=this.streakFreezes?(this.streakFreezes-=s-1,this.streak++,T(`â„ï¸ Streak freeze used! ${this.streakFreezes} remaining.`),this.addXP(this.XP_VALUES.daily_login,"ðŸ”¥ Streak protected!")):(this.streak=1,this.addXP(this.XP_VALUES.daily_login,"ðŸ‘‹ Welcome back!")))}else this.streak=1;this.lastActiveDate=t,this.streak>this.stats.maxStreak&&(this.stats.maxStreak=this.streak),this.save()}},addXP(t,e=""){if(t<=0)return;this.xp+=t,this.xpHistory.push({amount:t,reason:e,time:Date.now()});const i=this.level;this.calculateLevel(),this.level>i?this.onLevelUp(i,this.level):e&&T(`+${t} XP ${e}`),this.stats.level=this.level,this.save(),this.updateUI(),this.checkAchievements()},calculateLevel(){for(let t=this.LEVELS.length-1;t>=0;t--)if(this.xp>=this.LEVELS[t].xp){this.level=this.LEVELS[t].level;return}this.level=1},getCurrentLevelInfo(){return this.LEVELS.find(t=>t.level===this.level)||this.LEVELS[0]},getNextLevelInfo(){return this.LEVELS.find(t=>t.level===this.level+1)||null},getProgressToNextLevel(){const t=this.getCurrentLevelInfo(),e=this.getNextLevelInfo();if(!e)return 100;const i=this.xp-t.xp,s=e.xp-t.xp;return Math.min(100,Math.floor(i/s*100))},onLevelUp(t,e){var r,n;const i=this.LEVELS.find(a=>a.level===e);if(!i)return;const s=document.getElementById("toast");s&&(s.innerHTML=`<span style="font-size: 1.5em;">ðŸŽ‰</span><span>LEVEL UP! You're now <strong>${i.title}</strong></span>`,s.className="toast milestone",s.classList.add("show"),setTimeout(()=>s.classList.remove("show"),4e3)),(r=Zi.triggerConfetti)==null||r.call(Zi),(n=O.play)==null||n.call(O,"sort_complete")},checkAchievements(){for(const[t,e]of Object.entries(this.ACHIEVEMENTS))!this.achievements.includes(t)&&e.check(this.stats)&&this.unlockAchievement(t)},unlockAchievement(t){var s;const e=this.ACHIEVEMENTS[t];if(!e||this.achievements.includes(t))return;this.achievements.push(t),this.save();const i=document.getElementById("toast");i&&(i.innerHTML=`<span style="font-size: 1.3em;">ðŸ†</span><span><strong>Achievement Unlocked!</strong> ${e.title}</span>`,i.className="toast milestone",i.classList.add("show"),setTimeout(()=>i.classList.remove("show"),4e3)),(s=O.play)==null||s.call(O,"sql_solve_success")},onSortComplete(){this.stats.sorts++,this.addXP(this.XP_VALUES.sort_complete,"Sort complete!")},onPathFound(){this.stats.paths++,this.addXP(this.XP_VALUES.path_found,"Path found!")},onSQLSolved(){this.stats.sqlSolved++,this.addXP(this.XP_VALUES.sql_challenge_solved,"SQL solved!")},onSQLQuery(){this.stats.sqlQueries++,this.addXP(this.XP_VALUES.sql_query_run,"")},onQuizCorrect(){this.stats.quizCorrect++,this.addXP(this.XP_VALUES.quiz_correct,"Quiz correct!")},onDSOperation(){this.stats.dsOps++,this.addXP(this.XP_VALUES.ds_operation,"")},updateUI(){const t=document.getElementById("progressLevel"),e=document.getElementById("progressXP"),i=document.getElementById("progressBar"),s=document.getElementById("progressStreak");t&&(t.textContent=this.getCurrentLevelInfo().title),e&&(e.textContent=`${this.xp} XP`),i&&(i.style.width=`${this.getProgressToNextLevel()}%`),s&&(s.textContent=`ðŸ”¥ ${this.streak}`)}};typeof window<"u"&&(window.ProgressManager=Vs);const c1={focusableElements:'button, [href], input, select, textarea, [tabindex]:not([tabindex="-1"])',init(){document.addEventListener("mousedown",()=>document.body.classList.add("using-mouse")),document.addEventListener("keydown",t=>{t.key==="Tab"&&document.body.classList.remove("using-mouse"),t.key==="Escape"&&document.querySelectorAll(".modal.open, .electure-overlay.active").forEach(e=>{e.classList.remove("open","active")})})},trapFocus(t){const e=t.querySelectorAll(this.focusableElements);if(e.length===0)return;const i=e[0],s=e[e.length-1];t.addEventListener("keydown",r=>{r.key==="Tab"&&(r.shiftKey&&document.activeElement===i?(r.preventDefault(),s.focus()):!r.shiftKey&&document.activeElement===s&&(r.preventDefault(),i.focus()))}),i.focus()}},h1={region:null,init(){this.region=document.createElement("div"),this.region.setAttribute("role","status"),this.region.setAttribute("aria-live","polite"),this.region.setAttribute("aria-atomic","true"),this.region.className="sr-only",this.region.style.cssText="position:absolute;width:1px;height:1px;padding:0;margin:-1px;overflow:hidden;clip:rect(0,0,0,0);border:0;",document.body.appendChild(this.region)},announce(t,e="polite"){this.region||this.init(),this.region.setAttribute("aria-live",e),this.region.textContent="",requestAnimationFrame(()=>{this.region.textContent=t})}},d1={init(){window.onerror=(t,e,i,s,r)=>(this.handle(r||new Error(t)),!0),window.onunhandledrejection=t=>this.handle(t.reason)},handle(t){console.error("CSE Helper Error:",t),typeof T=="function"&&T("Something went wrong. Please try again.","error")}},u1={showSkeleton(t,e="card"){const i=document.getElementById(t);if(!i)return;const s={card:'<div class="skeleton skeleton-card"></div>'.repeat(3),text:'<div class="skeleton skeleton-text" style="width:80%"></div><div class="skeleton skeleton-text" style="width:60%"></div><div class="skeleton skeleton-text" style="width:70%"></div>',list:'<div style="display:flex;gap:1rem;align-items:center;margin:1rem 0"><div class="skeleton skeleton-circle"></div><div class="skeleton skeleton-text" style="flex:1"></div></div>'.repeat(5)};i.innerHTML=`<div class="stagger-children">${s[e]||s.card}</div>`},showSpinner(t){const e=document.getElementById(t);e&&(e.innerHTML='<div style="display:flex;justify-content:center;padding:2rem"><div class="loading-spinner"></div></div>')},showEmpty(t,e="ðŸ“­",i="Nothing here yet",s=""){const r=document.getElementById(t);r&&(r.innerHTML=`
      <div class="empty-state animate-fade-in">
        <div class="empty-state-icon">${e}</div>
        <div class="empty-state-title">${i}</div>
        ${s?`<div class="empty-state-text">${s}</div>`:""}
      </div>
    `)}},p1={render(t,e={}){const i=document.getElementById(t);if(!i)return;const s=e.streak||0,r=e.xp||0,n=e.achievements||0,a=e.tierName||"Bronze";i.innerHTML=`
      <div class="profile-card">
        <div class="profile-header">
          <div class="profile-avatar">ðŸ‘¨â€ðŸ’»</div>
          <div>
            <h3 class="profile-name">Study Champion</h3>
            <div class="profile-title">${a} League</div>
          </div>
        </div>
        <div class="profile-stats">
          <div class="stat">
            <span class="stat-value">${s}</span>
            <span class="stat-label">Day Streak</span>
          </div>
          <div class="stat">
            <span class="stat-value">${r}</span>
            <span class="stat-label">Total XP</span>
          </div>
          <div class="stat">
            <span class="stat-value">${n}</span>
            <span class="stat-label">Badges</span>
          </div>
        </div>
      </div>
    `}},f1={favorites:new Set,init(){try{const t=localStorage.getItem("cse-helper-favorites");t&&(this.favorites=new Set(JSON.parse(t)))}catch(t){console.warn("[FavoritesManager] Failed to load favorites:",t)}},add(t,e="challenge"){const i=`${e}:${t}`;this.favorites.add(i),this.save(),T("â­ Added to favorites!")},remove(t,e="challenge"){const i=`${e}:${t}`;this.favorites.delete(i),this.save(),T("Removed from favorites")},toggle(t,e="challenge"){const i=`${e}:${t}`;return this.favorites.has(i)?(this.remove(t,e),!1):(this.add(t,e),!0)},isFavorite(t,e="challenge"){return this.favorites.has(`${e}:${t}`)},getAll(t=null){return t===null?[...this.favorites]:[...this.favorites].filter(e=>e.startsWith(t+":")).map(e=>e.split(":")[1])},save(){try{localStorage.setItem("cse-helper-favorites",JSON.stringify([...this.favorites]))}catch(t){console.warn("[FavoritesManager] Failed to save favorites:",t)}}};typeof window<"u"&&(window.KeyboardNavigation=c1,window.ScreenReaderAnnouncer=h1,window.ErrorHandler=d1,window.LoadingStates=u1,window.ProfileCard=p1,window.FavoritesManager=f1);const zs={quizzes:{algorithms:[{id:"sort_q1",question:"Which sorting algorithm has the best average-case time complexity?",choices:["Bubble Sort - O(nÂ²)","Merge Sort - O(n log n)","Selection Sort - O(nÂ²)","Insertion Sort - O(nÂ²)"],correctIndex:1,explanation:"Merge Sort has O(n log n) time complexity in all cases, making it more efficient than O(nÂ²) algorithms for large datasets."},{id:"sort_q2",question:'What does "stable" mean in sorting algorithms?',choices:["Never crashes","Same speed always","Equal elements keep original order","Uses constant memory"],correctIndex:2,explanation:"A stable sort preserves the relative order of elements with equal keys. Merge Sort and Insertion Sort are stable; Quick Sort is not."},{id:"sort_q3",question:'Which algorithm uses "divide and conquer"?',choices:["Bubble Sort","Insertion Sort","Quick Sort","Selection Sort"],correctIndex:2,explanation:"Quick Sort divides the array around a pivot, then recursively sorts the subarrays. Merge Sort also uses divide and conquer."}],pathfinding:[{id:"path_q1",question:"Which pathfinding algorithm guarantees the shortest path?",choices:["DFS (Depth-First Search)","BFS (Breadth-First Search)","Random Walk","Greedy Best-First"],correctIndex:1,explanation:"BFS explores all neighbors at current depth before moving deeper, guaranteeing the shortest path in unweighted graphs."},{id:"path_q2",question:"What heuristic does A* use by default?",choices:["Euclidean distance","Manhattan distance","Chebyshev distance","Random guess"],correctIndex:1,explanation:"Manhattan distance (|x1-x2| + |y1-y2|) is commonly used for grid-based pathfinding where diagonal movement is not allowed."}],"sql-practice":[{id:"sql_q1",question:"What does LIMIT do in a SQL query?",choices:["Filters rows by condition","Restricts number of returned rows","Joins two tables","Orders results"],correctIndex:1,explanation:'LIMIT restricts the maximum number of rows returned. "LIMIT 5" returns at most 5 rows.'},{id:"sql_q2",question:"What is the difference between WHERE and HAVING?",choices:["No difference","WHERE filters before grouping, HAVING after","HAVING is faster","WHERE only works on strings"],correctIndex:1,explanation:"WHERE filters individual rows before GROUP BY; HAVING filters aggregated groups after GROUP BY."},{id:"sql_q3",question:"Which JOIN returns all rows from the left table even without matches?",choices:["INNER JOIN","RIGHT JOIN","LEFT JOIN","CROSS JOIN"],correctIndex:2,explanation:"LEFT JOIN returns all rows from the left table, with NULL for unmatched right table columns."},{id:"sql_q4",question:"What does GROUP BY do?",choices:["Sorts results","Combines rows with same values into summary rows","Joins tables","Limits output"],correctIndex:1,explanation:"GROUP BY groups rows with the same values, allowing aggregate functions like COUNT, SUM, AVG per group."},{id:"sql_q5",question:'What will COUNT(*) return for a table with 10 rows and 3 NULL values in column "age"?',choices:["7","10","3","0"],correctIndex:1,explanation:"COUNT(*) counts all rows regardless of NULL values. COUNT(age) would return 7."},{id:"sql_q6",question:"What does DISTINCT do?",choices:["Sorts alphabetically","Removes duplicate rows","Counts unique values","Filters NULL values"],correctIndex:1,explanation:"DISTINCT removes duplicate rows from the result set, showing only unique combinations."},{id:"sql_q7",question:'In "SELECT name FROM products WHERE price > 100 ORDER BY name LIMIT 5", what happens first?',choices:["LIMIT","ORDER BY","WHERE","SELECT"],correctIndex:2,explanation:"Execution order: WHERE filters rows, then ORDER BY sorts, then LIMIT truncates, finally SELECT chooses columns."},{id:"sql_q8",question:"What is a subquery?",choices:["A query inside another query","A query that runs slowly","A query with JOIN","A query with GROUP BY"],correctIndex:0,explanation:"A subquery is a SELECT inside another SQL statement, often used in WHERE or FROM clauses."},{id:"sql_q9",question:'What does "c.id" mean in SQL?',choices:['Column "c" in table "id"','Column "id" in table aliased as "c"',"A function call","A syntax error"],correctIndex:1,explanation:'The dot notation refers to column "id" from the table aliased as "c". Aliases make JOINs cleaner.'},{id:"sql_q10",question:"What does AVG() ignore?",choices:["Zero values","Negative values","NULL values","String values"],correctIndex:2,explanation:"AVG() ignores NULL values when calculating the average. It only considers non-NULL numeric values."},{id:"sql_q11",question:"Which keyword is used to combine results from multiple SELECT statements?",choices:["MERGE","COMBINE","UNION","CONCAT"],correctIndex:2,explanation:"UNION combines the result sets of two or more SELECT statements. UNION removes duplicates; UNION ALL keeps them."},{id:"sql_q12",question:"What is the result of 5 + NULL in SQL?",choices:["5","0","NULL","Error"],correctIndex:2,explanation:'Any operation with NULL results in NULL. NULL represents "unknown" so 5 + unknown = unknown.'},{id:"sql_q13",question:"Which is correct to check for NULL values?",choices:["WHERE column = NULL","WHERE column IS NULL","WHERE column == NULL","WHERE column EQUALS NULL"],correctIndex:1,explanation:"Use IS NULL or IS NOT NULL to check for NULL. The = operator cannot compare to NULL."},{id:"sql_q14",question:"What does ORDER BY column DESC do?",choices:["Sorts A-Z","Sorts Z-A (or highest to lowest)","Describes the column","Removes duplicates"],correctIndex:1,explanation:"DESC means descending order - Z to A for text, highest to lowest for numbers. ASC is the default (ascending)."},{id:"sql_q15",question:"Given: SELECT COUNT(*) FROM orders GROUP BY customer_id. What does this return?",choices:["Total number of customers","Number of orders per customer","Total number of orders","Customer with most orders"],correctIndex:1,explanation:"GROUP BY customer_id creates groups per customer, then COUNT(*) counts orders in each group."},{id:"sql_q16",question:"What is a foreign key?",choices:["A unique identifier for each row","A column that references another table's primary key","An encrypted column","A key from a different database"],correctIndex:1,explanation:"A foreign key creates a link between tables by referencing the primary key of another table."},{id:"sql_q17",question:"What does BETWEEN 10 AND 20 include?",choices:["Values 11-19 only","Values 10-20 inclusive","Values 10-19","Values 11-20"],correctIndex:1,explanation:'BETWEEN is inclusive on both ends. "BETWEEN 10 AND 20" matches 10, 11, 12... 19, 20.'},{id:"sql_q18",question:"Which aggregate function finds the total?",choices:["COUNT()","SUM()","AVG()","MAX()"],correctIndex:1,explanation:"SUM() adds up all values in a column. COUNT() counts rows, AVG() finds the mean, MAX() finds the largest."},{id:"sql_q19",question:"What does INNER JOIN exclude?",choices:["Duplicate rows","NULL values","Rows without matches in both tables","Rows with foreign keys"],correctIndex:2,explanation:"INNER JOIN only returns rows where there is a match in BOTH tables. Unmatched rows are excluded."},{id:"sql_q20",question:"What is AS used for in SQL?",choices:["Arithmetic operations","Creating aliases for columns or tables","Sorting results","Filtering data"],correctIndex:1,explanation:"AS creates an alias - a temporary name for a column or table. Example: SELECT price AS cost"}],datastructures:[{id:"ds_q1",question:"What is the time complexity of array access by index?",choices:["O(1)","O(log n)","O(n)","O(nÂ²)"],correctIndex:0,explanation:"Array access is O(1) because elements are stored contiguously in memory, allowing direct calculation of memory address."}]},currentQuiz:null,currentSection:null,getRandomQuiz(t){const e=this.quizzes[t];return!e||e.length===0?null:e[Math.floor(Math.random()*e.length)]},renderQuiz(t,e){const i=document.getElementById(t);if(!i)return;const s=this.getRandomQuiz(e);if(!s){i.innerHTML="";return}this.currentQuiz=s,this.currentSection=e;const r=["A","B","C","D"];i.innerHTML=`
      <div class="quiz-container" id="quiz-${s.id}">
        <div class="quiz-header">
          <span class="quiz-icon">ðŸ§ </span>
          <span class="quiz-title">Quick Check!</span>
        </div>
        <p class="quiz-question">${s.question}</p>
        <div class="quiz-choices">
          ${s.choices.map((n,a)=>`
            <button class="quiz-choice" data-index="${a}">
              <span class="quiz-choice-letter">${r[a]}</span>
              <span>${n}</span>
            </button>
          `).join("")}
        </div>
        <div class="quiz-feedback" id="quiz-feedback-${s.id}"></div>
      </div>
    `,i.querySelectorAll(".quiz-choice").forEach(n=>{n.addEventListener("click",()=>{this.checkAnswer(s,parseInt(n.dataset.index),i)})})},checkAnswer(t,e,i){var a;const s=i.querySelectorAll(".quiz-choice"),r=i.querySelector(`#quiz-feedback-${t.id}`);s.forEach((o,l)=>{o.style.pointerEvents="none",l===t.correctIndex?o.classList.add("correct"):l===e&&o.classList.add("incorrect")});const n=e===t.correctIndex;r.className=`quiz-feedback show ${n?"correct":"incorrect"}`,r.innerHTML=`
      <strong>${n?"âœ… Correct!":"âŒ Not quite!"}</strong>
      <p style="margin-top: 0.5rem;">${t.explanation}</p>
    `,(a=O.play)==null||a.call(O,n?"toast_success":"toast_error"),this.trackQuizResult(t.id,n),n&&this.onCorrectAnswer&&this.onCorrectAnswer()},trackQuizResult(t,e){try{const i=localStorage.getItem("cse-helper-quiz-stats")||"{}",s=JSON.parse(i);s[t]||(s[t]={attempts:0,correct:0}),s[t].attempts++,e&&s[t].correct++,localStorage.setItem("cse-helper-quiz-stats",JSON.stringify(s))}catch(i){console.warn("[QuizManager] Failed to track result:",i)}},getStats(){try{return JSON.parse(localStorage.getItem("cse-helper-quiz-stats")||"{}")}catch{return{}}},onCorrectAnswer:null,setOnCorrectCallback(t){this.onCorrectAnswer=t}};typeof window<"u"&&(window.QuizManager=zs);const we=t=>{const e=[document.getElementById(t),document.getElementById(t+"2")].filter(Boolean);return e.length===0?null:new Proxy(e[0],{get(i,s){if(s==="addEventListener")return(n,a)=>e.forEach(o=>o.addEventListener(n,a));if(s==="scrollIntoView")return n=>e.forEach(a=>a.scrollIntoView(n));if(s==="style")return new Proxy(i.style,{set(n,a,o){return e.forEach(l=>l.style[a]=o),!0},get(n,a){return n[a]}});const r=Reflect.get(i,s);return typeof r=="function"?r.bind(i):r},set(i,s,r){return e.forEach(n=>n[s]=r),!0}})},Rr={array:[],treeData:null,currentPhase:"idle",divideLevel:0,mergeLevel:0,maxDepth:0,isPlaying:!1,animationId:null,totalSteps:0,currentStep:0,currentAlgo:"merge",currentCodeLang:"python",codeSnippets:{merge:{python:`def merge_sort(arr):
    if len(arr) <= 1:
        return arr
    mid = len(arr) // 2
    left = merge_sort(arr[:mid])
    right = merge_sort(arr[mid:])
    return merge(left, right)

def merge(left, right):
    result = []
    i = j = 0
    while i < len(left) and j < len(right):
        if left[i] <= right[j]:
            result.append(left[i])
            i += 1
        else:
            result.append(right[j])
            j += 1
    result.extend(left[i:])
    result.extend(right[j:])
    return result

# Time: O(n log n), Space: O(n)`,java:`public static void mergeSort(int[] arr, int l, int r) {
    if (l < r) {
        int mid = l + (r - l) / 2;
        mergeSort(arr, l, mid);
        mergeSort(arr, mid + 1, r);
        merge(arr, l, mid, r);
    }
}

public static void merge(int[] arr, int l, int m, int r) {
    int[] left = Arrays.copyOfRange(arr, l, m + 1);
    int[] right = Arrays.copyOfRange(arr, m + 1, r + 1);
    int i = 0, j = 0, k = l;
    while (i < left.length && j < right.length) {
        if (left[i] <= right[j])
            arr[k++] = left[i++];
        else
            arr[k++] = right[j++];
    }
    while (i < left.length) arr[k++] = left[i++];
    while (j < right.length) arr[k++] = right[j++];
}

// Time: O(n log n), Space: O(n)`,cpp:`void merge(vector<int>& arr, int l, int m, int r) {
    vector<int> left(arr.begin() + l, arr.begin() + m + 1);
    vector<int> right(arr.begin() + m + 1, arr.begin() + r + 1);
    int i = 0, j = 0, k = l;
    while (i < left.size() && j < right.size()) {
        if (left[i] <= right[j])
            arr[k++] = left[i++];
        else
            arr[k++] = right[j++];
    }
    while (i < left.size()) arr[k++] = left[i++];
    while (j < right.size()) arr[k++] = right[j++];
}

void mergeSort(vector<int>& arr, int l, int r) {
    if (l < r) {
        int mid = l + (r - l) / 2;
        mergeSort(arr, l, mid);
        mergeSort(arr, mid + 1, r);
        merge(arr, l, mid, r);
    }
}

// Time: O(n log n), Space: O(n)`},quick:{python:`def quick_sort(arr, low, high):
    if low < high:
        pi = partition(arr, low, high)
        quick_sort(arr, low, pi - 1)
        quick_sort(arr, pi + 1, high)

def partition(arr, low, high):
    pivot = arr[high]
    i = low - 1
    for j in range(low, high):
        if arr[j] <= pivot:
            i += 1
            arr[i], arr[j] = arr[j], arr[i]
    arr[i + 1], arr[high] = arr[high], arr[i + 1]
    return i + 1

# Time: O(n log n) avg, O(nÂ²) worst
# Space: O(log n)`,java:`public static void quickSort(int[] arr, int low, int high) {
    if (low < high) {
        int pi = partition(arr, low, high);
        quickSort(arr, low, pi - 1);
        quickSort(arr, pi + 1, high);
    }
}

public static int partition(int[] arr, int low, int high) {
    int pivot = arr[high];
    int i = low - 1;
    for (int j = low; j < high; j++) {
        if (arr[j] <= pivot) {
            i++;
            int temp = arr[i];
            arr[i] = arr[j];
            arr[j] = temp;
        }
    }
    int temp = arr[i + 1];
    arr[i + 1] = arr[high];
    arr[high] = temp;
    return i + 1;
}

// Time: O(n log n) avg, O(nÂ²) worst
// Space: O(log n)`,cpp:`int partition(vector<int>& arr, int low, int high) {
    int pivot = arr[high];
    int i = low - 1;
    for (int j = low; j < high; j++) {
        if (arr[j] <= pivot) {
            i++;
            swap(arr[i], arr[j]);
        }
    }
    swap(arr[i + 1], arr[high]);
    return i + 1;
}

void quickSort(vector<int>& arr, int low, int high) {
    if (low < high) {
        int pi = partition(arr, low, high);
        quickSort(arr, low, pi - 1);
        quickSort(arr, pi + 1, high);
    }
}

// Time: O(n log n) avg, O(nÂ²) worst
// Space: O(log n)`}},init(){var t,e,i,s,r,n,a,o,l,c;(t=we("btnDCStart"))==null||t.addEventListener("click",()=>this.start()),(e=we("btnDCReset"))==null||e.addEventListener("click",()=>this.reset()),(i=we("btnDCRandomize"))==null||i.addEventListener("click",()=>this.randomize()),(s=we("btnDCSkipBack"))==null||s.addEventListener("click",()=>this.skipBack()),(r=we("btnDCStepBack"))==null||r.addEventListener("click",()=>this.stepBack()),(n=we("btnDCPlayPause"))==null||n.addEventListener("click",()=>this.togglePlayPause()),(a=we("btnDCStepForward"))==null||a.addEventListener("click",()=>this.stepForward()),(o=we("btnDCSkipForward"))==null||o.addEventListener("click",()=>this.skipForward()),(l=we("dcSizeSlider"))==null||l.addEventListener("input",h=>{we("dcSizeLabel").textContent=h.target.value}),(c=we("dcAlgoSelect"))==null||c.addEventListener("change",h=>this.switchAlgorithm(h.target.value)),document.querySelectorAll(".dc-code-tab").forEach(h=>{const d=h.cloneNode(!0);h.parentNode.replaceChild(d,h)}),document.querySelectorAll(".dc-code-tab").forEach(h=>{h.addEventListener("click",d=>{document.querySelectorAll(".dc-code-tab").forEach(u=>u.classList.remove("active")),d.currentTarget.classList.add("active"),this.currentCodeLang=d.currentTarget.dataset.lang,console.log("[DCViz] Switched language to:",this.currentCodeLang),this.renderCode()})}),this.randomize(),this.renderCode()},switchAlgorithm(t){var i;this.currentAlgo=t,this.reset();const e=t==="merge";we("mergeSortPseudo")&&(we("mergeSortPseudo").style.display=e?"block":"none"),we("quickSortPseudo")&&(we("quickSortPseudo").style.display=e?"none":"block"),we("mergeSortLegend")&&(we("mergeSortLegend").style.display=e?"block":"none"),we("quickSortLegend")&&(we("quickSortLegend").style.display=e?"none":"block"),this.renderCode(),this.explain(e?'Merge Sort selected. Click "Start" to begin.':"Quick Sort selected. Note: Quick Sort visualization uses the sorting bars from the Sorting tab."),(i=O.play)==null||i.call(O,"pop")},renderCode(){const t=we("dcCodeContainer");if(t){const e=this.codeSnippets[this.currentAlgo][this.currentCodeLang];t.innerHTML=`<pre style="margin: 0; white-space: pre-wrap;">${this.escapeHtml(e)}</pre>`}},escapeHtml(t){return t.replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;")},parseArray(){var e;return(((e=we("dcArray"))==null?void 0:e.value)||"").split(",").map(i=>parseInt(i.trim())).filter(i=>!isNaN(i))},randomize(){var i,s;const t=parseInt((i=we("dcSizeSlider"))==null?void 0:i.value)||7,e=[];for(let r=0;r<t;r++)e.push(Math.floor(Math.random()*90)+10);this.array=e,we("dcArray")&&(we("dcArray").value=e.join(", ")),this.reset(),this.explain('Array randomized! Click "Start" to begin.'),(s=O.play)==null||s.call(O,"pop")},getSpeed(){var t;return 2200-parseInt(((t=we("dcSpeedSlider"))==null?void 0:t.value)||800)},buildTree(t,e=0){const i=[...t].sort((n,a)=>n-a),s={original:[...t],sorted:i,depth:e};if(t.length<=1)return s.isLeaf=!0,s;const r=Math.floor(t.length/2);return s.left=this.buildTree(t.slice(0,r),e+1),s.right=this.buildTree(t.slice(r),e+1),s},buildQuickSortTree(t,e=0){if(t.length===0)return null;const i={original:[...t],sorted:[...t].sort((a,o)=>a-o),depth:e};if(t.length<=1)return i.isLeaf=!0,i.pivot=t[0],i;const s=t[t.length-1];i.pivot=s;const r=[],n=[];for(let a=0;a<t.length-1;a++)t[a]<=s?r.push(t[a]):n.push(t[a]);return i.partitioned=[...r,s,...n],i.pivotIndex=r.length,i.leftCount=r.length,i.rightCount=n.length,r.length>0&&(i.left=this.buildQuickSortTree(r,e+1)),n.length>0&&(i.right=this.buildQuickSortTree(n,e+1)),r.length===0&&n.length===0&&(i.isLeaf=!0),i},getNodesAtDepthQS(t,e,i=[]){return t&&(t.depth===e?i.push(t):(this.getNodesAtDepthQS(t.left,e,i),this.getNodesAtDepthQS(t.right,e,i))),i},getMaxDepth(t){return t?t.isLeaf?t.depth:Math.max(this.getMaxDepth(t.left),this.getMaxDepth(t.right)):0},getNodesAtDepth(t,e,i=[]){return t&&(t.depth===e?i.push(t):(this.getNodesAtDepth(t.left,e,i),this.getNodesAtDepth(t.right,e,i))),i},start(){this.isPlaying||(this.array=this.parseArray(),this.array.length!==0&&(this.currentAlgo==="quick"?this.treeData=this.buildQuickSortTree(this.array):this.treeData=this.buildTree(this.array),this.maxDepth=this.getMaxDepth(this.treeData),this.totalSteps=this.maxDepth+1+(this.maxDepth+1),this.currentStep=0,this.currentPhase="divide",this.divideLevel=0,this.mergeLevel=-1,this.isPlaying=!0,this.updatePlayPauseButton(),this.updateStepIndicator(),this.render(),this.autoPlay()))},autoPlay(){this.isPlaying&&(this.animationId=setTimeout(()=>{var t;this.stepForwardInternal()?this.autoPlay():(this.isPlaying=!1,this.updatePlayPauseButton(),(t=O.play)==null||t.call(O,"sql_run_success"))},this.getSpeed()))},stepForwardInternal(){var t,e,i;return this.currentPhase==="divide"?this.divideLevel<this.maxDepth?(this.divideLevel++,this.currentStep++,this.render(),(t=O.play)==null||t.call(O,"card_flip"),!0):(this.currentPhase="merge",this.mergeLevel=this.maxDepth,this.currentStep++,this.render(),(e=O.play)==null||e.call(O,"card_flip"),!0):this.currentPhase==="merge"?this.mergeLevel>0?(this.mergeLevel--,this.currentStep++,this.render(),(i=O.play)==null||i.call(O,"card_flip"),!0):(this.currentPhase="complete",this.currentStep++,this.render(),!1):!1},stepBackInternal(){return this.currentPhase==="complete"?(this.currentPhase="merge",this.mergeLevel=0,this.currentStep--,this.render(),!0):this.currentPhase==="merge"?this.mergeLevel<this.maxDepth?(this.mergeLevel++,this.currentStep--,this.render(),!0):(this.currentPhase="divide",this.divideLevel=this.maxDepth,this.currentStep--,this.render(),!0):this.currentPhase==="divide"&&this.divideLevel>0?(this.divideLevel--,this.currentStep--,this.render(),!0):!1},skipBack(){var t;this.pause(),this.currentPhase="divide",this.divideLevel=0,this.mergeLevel=-1,this.currentStep=0,this.render(),this.updateStepIndicator(),(t=O.play)==null||t.call(O,"card_flip")},stepBack(){var t;this.pause(),this.stepBackInternal()&&(this.updateStepIndicator(),(t=O.play)==null||t.call(O,"card_flip"))},togglePlayPause(){if(this.treeData===null){this.start();return}this.isPlaying?this.pause():this.play()},play(){this.currentPhase!=="complete"&&(this.isPlaying=!0,this.updatePlayPauseButton(),this.autoPlay())},pause(){this.isPlaying=!1,this.animationId&&clearTimeout(this.animationId),this.updatePlayPauseButton()},stepForward(){this.pause(),this.stepForwardInternal()&&this.updateStepIndicator()},skipForward(){var t;this.pause(),this.currentPhase="complete",this.divideLevel=this.maxDepth,this.mergeLevel=0,this.currentStep=this.totalSteps,this.render(),this.updateStepIndicator(),(t=O.play)==null||t.call(O,"sql_run_success")},explain(t){const e=we("dcExplanation");e&&(e.innerHTML=t)},render(){const t=we("dcLevels");if(!t||!this.treeData){t&&(t.innerHTML='<p style="color: var(--text-muted); text-align: center;">Click "Start" to visualize the algorithm</p>');return}if(this.currentAlgo==="quick"){this.renderQuickSort(t);return}this.renderMergeSort(t)},renderQuickSort(t){const e=`
      display: inline-flex;
      align-items: center;
      justify-content: center;
      width: 46px;
      height: 40px;
      border: 2px solid var(--border-soft);
      background: var(--bg-card);
      font-weight: 600;
      font-size: 1rem;
      color: var(--text-body);
      margin: 0 -1px;
    `;if(this.currentPhase==="divide"){const o=this.getNodesAtDepthQS(this.treeData,this.divideLevel).map(l=>`pivot=${l.pivot}`).join(", ");this.explain(`<strong>PARTITION:</strong> Level ${this.divideLevel} - ${o}`),this.highlightQuickSortPseudo(2)}else if(this.currentPhase==="merge")this.explain(`<strong>SORTED:</strong> Level ${this.mergeLevel} elements are now in correct position`),this.highlightQuickSortPseudo(3);else{const a=this.treeData.sorted.join(", ");this.explain(`<strong>âœ… COMPLETE:</strong> Array sorted! [${a}]`),this.highlightQuickSortPseudo(-1)}let i='<div style="display: flex; flex-direction: column; align-items: center; gap: 1rem;">';const s=this.currentPhase==="divide"?this.divideLevel:this.maxDepth,r=this.currentPhase==="merge"||this.currentPhase==="complete";for(let a=0;a<=s;a++){const o=this.getNodesAtDepthQS(this.treeData,a),l=a===this.divideLevel&&this.currentPhase==="divide"||a===this.mergeLevel&&this.currentPhase==="merge",c=r&&a>=this.mergeLevel,h=l?'id="dc-active-level"':"";let d="";if(l&&this.currentPhase==="divide"?d="background: rgba(245, 158, 11, 0.15); box-shadow: 0 0 10px rgba(245, 158, 11, 0.3);":l&&this.currentPhase==="merge"&&(d="background: rgba(34, 197, 94, 0.15); box-shadow: 0 0 10px rgba(34, 197, 94, 0.3);"),a>0){const u=this.getNodesAtDepthQS(this.treeData,a-1);i+='<div style="display: flex; justify-content: center; gap: 4rem; margin: 0.25rem 0;">',u.forEach(p=>{if(!p.isLeaf&&(p.left||p.right)){if(i+='<div style="display: flex; gap: 1rem; align-items: center;">',r){const f=a-1>=this.mergeLevel;if(p.left){const g=f?"#22c55e":"#94a3b8";i+=`<div style="display: flex; flex-direction: column; align-items: center;">
                  <span style="color: ${g}; font-size: 1.2rem;">â†–</span>
                  <span style="font-size: 0.65rem; color: ${g};">sorted</span>
                </div>`}if(p.right){const g=f?"#22c55e":"#94a3b8";i+=`<div style="display: flex; flex-direction: column; align-items: center;">
                  <span style="color: ${g}; font-size: 1.2rem;">â†—</span>
                  <span style="font-size: 0.65rem; color: ${g};">sorted</span>
                </div>`}}else p.left&&(i+=`<div style="display: flex; flex-direction: column; align-items: center;">
                  <span style="font-size: 0.7rem; color: #22c55e;">â‰¤ ${p.pivot}</span>
                  <span style="color: #22c55e; font-size: 1.2rem;">â†™</span>
                </div>`),p.right&&(i+=`<div style="display: flex; flex-direction: column; align-items: center;">
                  <span style="font-size: 0.7rem; color: #ef4444;">> ${p.pivot}</span>
                  <span style="color: #ef4444; font-size: 1.2rem;">â†˜</span>
                </div>`);i+="</div>"}}),i+="</div>"}i+=`<div ${h} style="display: flex; justify-content: center; gap: 2rem; padding: 0.5rem 1rem; border-radius: 8px; ${d}">`,o.forEach(u=>{const p=c?u.sorted:u.original;i+='<div style="display: flex; position: relative;">',this.currentPhase==="divide"&&a===this.divideLevel&&!u.isLeaf&&p.length>1&&(i+='<div style="position: absolute; top: -20px; right: 0; font-size: 0.65rem; color: #fcd34d; font-weight: 600;">Pivot</div>'),p.forEach((f,g)=>{const m=g===0,y=g===p.length-1,b=m&&y?"6px":m?"6px 0 0 6px":y?"0 6px 6px 0":"0",w=f===u.pivot&&y&&this.currentPhase==="divide";let k,x,E;c?(k=a===0&&this.currentPhase==="complete"?"#22c55e":"#86efac",x=a===0&&this.currentPhase==="complete"?"#fff":"#166534",E="#22c55e"):w?(k="#fcd34d",x="#78350f",E="#f59e0b"):l?(k="#fed7aa",x="#9a3412",E="#f97316"):(k="var(--bg-card)",x="var(--text-body)",E="var(--border-soft)"),i+=`<div style="${e} background: ${k}; color: ${x}; border-color: ${E}; border-radius: ${b}; ${w?"border-width: 3px;":""}">${f}</div>`}),i+="</div>"}),i+="</div>"}i+="</div>",t.innerHTML=i;const n=we("dc-active-level");n&&n.scrollIntoView({behavior:"smooth",block:"center"})},renderMergeSort(t){const e=`
      display: inline-flex;
      align-items: center;
      justify-content: center;
      width: 46px;
      height: 40px;
      border: 2px solid var(--border-soft);
      background: var(--bg-card);
      font-weight: 600;
      font-size: 1rem;
      color: var(--text-body);
      margin: 0 -1px;
    `;if(this.currentPhase==="divide"){const n=this.getNodesAtDepth(this.treeData,this.divideLevel).map(a=>`[${a.original.join(", ")}]`).join(" ");this.explain(`<strong>DIVIDE:</strong> Level ${this.divideLevel} - ${n}`),this.highlightPseudo(this.divideLevel===0?0:2)}else if(this.currentPhase==="merge"){const n=this.getNodesAtDepth(this.treeData,this.mergeLevel).map(a=>`[${a.sorted.join(", ")}]`).join(" ");this.explain(`<strong>MERGE:</strong> Level ${this.mergeLevel} - Merging to: ${n}`),this.highlightPseudo(5)}else{const r=this.treeData.sorted.join(", ");this.explain(`<strong>âœ… COMPLETE:</strong> Array sorted! [${r}]`),this.highlightPseudo(-1)}let i="";if(this.currentPhase==="divide"){i+='<div style="display: flex; flex-direction: column; align-items: center; gap: 0.75rem;">';for(let r=0;r<=this.divideLevel;r++){const n=this.getNodesAtDepth(this.treeData,r),a=r===this.divideLevel,o=a?'id="dc-active-level"':"",l=a?"background: rgba(245, 158, 11, 0.2); box-shadow: 0 0 10px rgba(245, 158, 11, 0.5);":"";if(r>0){const c=this.getNodesAtDepth(this.treeData,r-1);i+='<div style="display: flex; justify-content: center; gap: 3rem;">',c.forEach(h=>{if(!h.isLeaf){const d=h.original.length*46+"px";i+=`<div style="display: flex; justify-content: space-between; width: ${d}; padding: 0 10px;">
                <span style="color: #f59e0b;">â†™</span>
                <span style="color: #f59e0b;">â†˜</span>
              </div>`}}),i+="</div>"}i+=`<div ${o} style="display: flex; justify-content: center; gap: 2.5rem; padding: 0.5rem 1rem; border-radius: 8px; ${l}">`,n.forEach(c=>{const h=a?"#f59e0b":"var(--bg-card)",d=a?"#fff":"var(--text-body)",u=a?"#d97706":"var(--border-soft)";i+='<div style="display: flex;">',c.original.forEach((p,f)=>{const g=f===0,m=f===c.original.length-1;i+=`<div style="${e} background: ${h}; color: ${d}; border-color: ${u}; border-radius: ${g&&m?"6px":g?"6px 0 0 6px":m?"0 6px 6px 0":"0"};">${p}</div>`}),i+="</div>"}),i+="</div>"}i+="</div>"}else if(this.currentPhase==="merge"||this.currentPhase==="complete"){i+='<div style="display: flex; flex-direction: column; align-items: center; gap: 0.75rem;">';for(let r=0;r<=this.maxDepth;r++){const n=this.getNodesAtDepth(this.treeData,r),a=r>=this.mergeLevel,o=r===this.mergeLevel&&this.currentPhase!=="complete",l=o?'id="dc-active-level"':"",c=o?"background: rgba(59, 130, 246, 0.2); box-shadow: 0 0 10px rgba(59, 130, 246, 0.5);":"";if(r>0){const h=this.getNodesAtDepth(this.treeData,r-1),d=r-1>=this.mergeLevel;i+='<div style="display: flex; justify-content: center; gap: 3rem;">',h.forEach(u=>{if(!u.isLeaf&&d){const p=u.sorted.length*46+"px";i+=`<div style="display: flex; justify-content: space-between; width: ${p}; padding: 0 10px;">
                <span style="color: #3b82f6;">â†–</span>
                <span style="color: #3b82f6;">â†—</span>
              </div>`}else if(!u.isLeaf){const p=u.original.length*46+"px";i+=`<div style="width: ${p};"></div>`}}),i+="</div>"}i+=`<div ${l} style="display: flex; justify-content: center; gap: 2.5rem; padding: 0.5rem 1rem; border-radius: 8px; ${c}">`,n.forEach(h=>{const d=a?h.sorted:h.original,u=r===0&&this.currentPhase==="complete"?"#a855f7":o?"#3b82f6":a?"#93c5fd":"var(--bg-card)",p=r===0&&this.currentPhase==="complete"||o?"#fff":a?"#1e3a8a":"var(--text-body)",f=r===0&&this.currentPhase==="complete"?"#7e22ce":o?"#2563eb":a?"#60a5fa":"var(--border-soft)";i+='<div style="display: flex;">',d.forEach((g,m)=>{const y=m===0,b=m===d.length-1;i+=`<div style="${e} background: ${u}; color: ${p}; border-color: ${f}; border-radius: ${y&&b?"6px":y?"6px 0 0 6px":b?"0 6px 6px 0":"0"};">${g}</div>`}),i+="</div>"}),i+="</div>"}i+="</div>"}t.innerHTML=i;const s=we("dc-active-level");s&&s.scrollIntoView({behavior:"smooth",block:"center"})},highlightQuickSortPseudo(t){for(let e=0;e<=4;e++){const i=we(`qs-pseudo-${e}`);i&&(i.style.background="transparent")}if(t>=0&&t<=4){const e=we(`qs-pseudo-${t}`);e&&(e.style.background="rgba(255, 255, 0, 0.3)")}},highlightPseudo(t){for(let e=0;e<=5;e++){const i=we(`dc-pseudo-${e}`);i&&(i.style.background="transparent")}if(t>=0&&t<=5){const e=we(`dc-pseudo-${t}`);e&&(e.style.background="rgba(255, 255, 0, 0.3)")}},updateStepIndicator(){const t=we("dcStepIndicator");t&&(t.textContent=`Step ${this.currentStep} / ${this.totalSteps}`)},updatePlayPauseButton(){const t=we("btnDCPlayPause");t&&(t.innerHTML=this.isPlaying?"â¸ï¸ Pause":"â–¶ï¸ Play")},reset(){this.isPlaying=!1,this.animationId&&clearTimeout(this.animationId),this.treeData=null,this.currentPhase="idle",this.divideLevel=0,this.mergeLevel=-1,this.currentStep=0,this.totalSteps=0,this.updateStepIndicator(),this.updatePlayPauseButton(),this.highlightPseudo(-1),this.explain('Click "Start" to begin the visualization.');const t=we("dcLevels");t&&(t.innerHTML='<p style="color: var(--text-muted); text-align: center;">Click "Start" to visualize the algorithm</p>')}};typeof window<"u"&&(window.DCViz=Rr);const Ee=t=>document.getElementById(t),g1={leftState:null,rightState:null,racing:!1,sharedArray:[],algorithms:{bubble:async function*(t,e){let i=t.length;for(let s=0;s<i-1;s++)for(let r=0;r<i-s-1;r++)yield{type:"compare",indices:[r,r+1],side:e},t[r]>t[r+1]&&([t[r],t[r+1]]=[t[r+1],t[r]],yield{type:"swap",indices:[r,r+1],side:e});yield{type:"done",side:e}},selection:async function*(t,e){let i=t.length;for(let s=0;s<i-1;s++){let r=s;for(let n=s+1;n<i;n++)yield{type:"compare",indices:[r,n],side:e},t[n]<t[r]&&(r=n);r!==s&&([t[s],t[r]]=[t[r],t[s]],yield{type:"swap",indices:[s,r],side:e})}yield{type:"done",side:e}},insertion:async function*(t,e){for(let i=1;i<t.length;i++){let s=t[i],r=i-1;for(;r>=0&&(yield{type:"compare",indices:[r,r+1],side:e},t[r]>s);)t[r+1]=t[r],yield{type:"swap",indices:[r,r+1],side:e},r--;t[r+1]=s}yield{type:"done",side:e}},merge:async function*(t,e,i=0,s=t.length-1){if(i<s){const r=Math.floor((i+s)/2);yield*this.merge(t,e,i,r),yield*this.merge(t,e,r+1,s);const n=t.slice(i,r+1),a=t.slice(r+1,s+1);let o=0,l=0,c=i;for(;o<n.length&&l<a.length;)yield{type:"compare",indices:[i+o,r+1+l],side:e},n[o]<=a[l]?t[c++]=n[o++]:t[c++]=a[l++],yield{type:"swap",indices:[c-1],side:e};for(;o<n.length;)t[c++]=n[o++],yield{type:"swap",indices:[c-1],side:e};for(;l<a.length;)t[c++]=a[l++],yield{type:"swap",indices:[c-1],side:e}}i===0&&s===t.length-1&&(yield{type:"done",side:e})},quick:async function*(t,e,i=0,s=t.length-1){if(i<s){const r=t[s];let n=i-1;for(let o=i;o<s;o++)yield{type:"compare",indices:[o,s],side:e},t[o]<r&&(n++,[t[n],t[o]]=[t[o],t[n]],yield{type:"swap",indices:[n,o],side:e});[t[n+1],t[s]]=[t[s],t[n+1]],yield{type:"swap",indices:[n+1,s],side:e};const a=n+1;yield*this.quick(t,e,i,a-1),yield*this.quick(t,e,a+1,s)}i===0&&s===t.length-1&&(yield{type:"done",side:e})},heap:async function*(t,e){const i=t.length,s=async function*(r,n,a,o){let l=a;const c=2*a+1,h=2*a+2;c<n&&(yield{type:"compare",indices:[c,l],side:o},r[c]>r[l]&&(l=c)),h<n&&(yield{type:"compare",indices:[h,l],side:o},r[h]>r[l]&&(l=h)),l!==a&&([r[a],r[l]]=[r[l],r[a]],yield{type:"swap",indices:[a,l],side:o},yield*s(r,n,l,o))};for(let r=Math.floor(i/2)-1;r>=0;r--)yield*s(t,i,r,e);for(let r=i-1;r>0;r--)[t[0],t[r]]=[t[r],t[0]],yield{type:"swap",indices:[0,r],side:e},yield*s(t,r,0,e);yield{type:"done",side:e}}},init(){this.bindEvents(),this.generateArray(),this.updateTitles()},bindEvents(){var t,e,i,s,r,n;(t=Ee("btnRaceStart"))==null||t.addEventListener("click",()=>this.startRace()),(e=Ee("btnRaceReset"))==null||e.addEventListener("click",()=>this.reset()),(i=Ee("raceArraySize"))==null||i.addEventListener("input",a=>{Ee("raceArraySizeLabel").textContent=`${a.target.value} elements`}),(s=Ee("raceArraySize"))==null||s.addEventListener("change",()=>this.generateArray()),(r=Ee("raceAlgoLeft"))==null||r.addEventListener("change",()=>this.updateTitles()),(n=Ee("raceAlgoRight"))==null||n.addEventListener("change",()=>this.updateTitles())},updateTitles(){var s,r;const t={bubble:"Bubble Sort",selection:"Selection Sort",insertion:"Insertion Sort",merge:"Merge Sort",quick:"Quick Sort",heap:"Heap Sort"},e=Ee("raceLeftTitle"),i=Ee("raceRightTitle");e&&(e.textContent=t[(s=Ee("raceAlgoLeft"))==null?void 0:s.value]||"Left"),i&&(i.textContent=t[(r=Ee("raceAlgoRight"))==null?void 0:r.value]||"Right")},generateArray(){var e;const t=parseInt(((e=Ee("raceArraySize"))==null?void 0:e.value)||20);this.sharedArray=Array.from({length:t},()=>Math.floor(Math.random()*100)+1),this.renderBars("left",this.sharedArray),this.renderBars("right",this.sharedArray)},renderBars(t,e,i=[]){const s=Ee(t==="left"?"raceLeftCanvas":"raceRightCanvas");if(!s)return;const r=Math.max(...e),n=100/e.length;s.innerHTML=e.map((a,o)=>{const l=a/r*100,h=i.includes(o)?"var(--accent-amber)":t==="left"?"var(--accent-forest)":"var(--accent-coral)";return`<div style="position: absolute; bottom: 0; left: ${o*n}%; width: ${n-.5}%; height: ${l}%; background: ${h}; transition: height 0.05s;"></div>`}).join("")},async startRace(){var c,h,d;if(this.racing)return;this.racing=!0,(c=Ee("raceWinnerBanner"))==null||c.classList.add("collapsed");const t=((h=Ee("raceAlgoLeft"))==null?void 0:h.value)||"merge",e=((d=Ee("raceAlgoRight"))==null?void 0:d.value)||"bubble",i=[...this.sharedArray],s=[...this.sharedArray];this.leftState={arr:i,comparisons:0,swaps:0,done:!1,startTime:Date.now()},this.rightState={arr:s,comparisons:0,swaps:0,done:!1,startTime:Date.now()};const r=Ee("raceLeftStatus"),n=Ee("raceRightStatus");r&&(r.textContent="Racing...",r.style.background="var(--accent-forest)",r.style.color="white"),n&&(n.textContent="Racing...",n.style.background="var(--accent-coral)",n.style.color="white");const a=this.algorithms[t].bind(this.algorithms)(i,"left"),o=this.algorithms[e].bind(this.algorithms)(s,"right"),l=async(u,p,f)=>{if(p.done)return;const g=await u.next();if(g.done)return;const m=g.value;m.type==="compare"?(p.comparisons++,this.renderBars(f,p.arr,m.indices)):m.type==="swap"?(p.swaps++,this.renderBars(f,p.arr,m.indices)):m.type==="done"&&(p.done=!0,p.endTime=Date.now()),this.updateStats(f,p),!p.done&&this.racing&&(await new Promise(y=>setTimeout(y,5)),await l(u,p,f))};await Promise.all([l(a,this.leftState,"left"),l(o,this.rightState,"right")]),this.showWinner(),this.racing=!1},updateStats(t,e){const i=t==="left"?"raceLeft":"raceRight",s=Ee(i+"Comparisons"),r=Ee(i+"Swaps"),n=Ee(i+"Time"),a=Ee(i+"ProgressBar"),o=Ee(i+"Status");s&&(s.textContent=e.comparisons),r&&(r.textContent=e.swaps),n&&(n.textContent=`${Date.now()-e.startTime}ms`);const l=e.comparisons+e.swaps,c=e.arr.length*e.arr.length,h=Math.min(100,l/c*100);a&&(a.style.width=`${h}%`),e.done&&(o&&(o.textContent="Done!"),a&&(a.style.width="100%"))},showWinner(){var h,d,u;const t=this.leftState.endTime-this.leftState.startTime,e=this.rightState.endTime-this.rightState.startTime,i=(h=Ee("raceLeftTitle"))==null?void 0:h.textContent,s=(d=Ee("raceRightTitle"))==null?void 0:d.textContent;let r,n,a;t<e?(r=i,n=t,a=e):e<t?(r=s,n=e,a=t):(r="It's a tie!",n=t,a=e);const o=Ee("raceWinnerText"),l=Ee("raceWinnerStats"),c=Ee("raceWinnerBanner");o&&(o.textContent=r==="It's a tie!"?"ðŸ¤ It's a Tie!":`ðŸ† ${r} Wins!`),l&&(l.textContent=`Finished in ${n}ms vs ${a}ms (${Math.round((a-n)/n*100)}% faster)`),c==null||c.classList.remove("collapsed"),(u=O.play)==null||u.call(O,"challenge_complete"),T(`ðŸ Race complete! ${r} wins!`)},reset(){var n;this.racing=!1,this.generateArray();const t=Ee("raceLeftStatus"),e=Ee("raceRightStatus");t&&(t.textContent="Ready",t.style.background="var(--bg-card)",t.style.color=""),e&&(e.textContent="Ready",e.style.background="var(--bg-card)",e.style.color=""),["raceLeftComparisons","raceRightComparisons","raceLeftSwaps","raceRightSwaps"].forEach(a=>{const o=Ee(a);o&&(o.textContent="0")}),["raceLeftTime","raceRightTime"].forEach(a=>{const o=Ee(a);o&&(o.textContent="0ms")}),["raceLeftProgressBar","raceRightProgressBar"].forEach(a=>{const o=Ee(a);o&&(o.style.width="0%")}),(n=Ee("raceWinnerBanner"))==null||n.classList.add("collapsed")}};typeof window<"u"&&(window.AlgorithmRace=g1);const gt={COLORS:{BACKGROUND:"#1e1e1e",BACKGROUND_SECONDARY:"#16213e",NODE_PRIMARY:"#4a9eff",NODE_ACCENT:"#e07a5f",NODE_GLOW_PRIMARY:"rgba(74, 158, 255, 0.5)",NODE_GLOW_ACCENT:"rgba(224, 122, 95, 0.6)",SELECTED:"#d4a853",EDGE:"rgba(140, 200, 255, 0.50)",EDGE_HIGHLIGHTED:"rgba(180, 220, 255, 0.85)",EDGE_DIMMED:"rgba(100, 180, 255, 0.08)",DIMMED_OPACITY:.2,WEIGHT_BG:"#1e1e1e",WEIGHT_TEXT:"#e07a5f",ALGORITHM_PATH:"rgba(212, 168, 83, 0.6)"},NODE:{BASE_RADIUS:14,MAX_RADIUS:28,MIN_RADIUS:10,HITBOX_PADDING:8,HOVER_SCALE:1.25,CENTRALITY_FACTOR:2},EDGE:{WIDTH:2,WIDTH_HIGHLIGHTED:4,LINE_CAP:"round",ARROW_LENGTH:16,ARROW_ANGLE:Math.PI/7,HITBOX_DISTANCE:12},EDGE_CURVING:{CURVE_RADIUS:50,CURVE_STRENGTH:1.2,MIN_DEFLECTION:5,MAX_DEFLECTION:80,RETURN_ANIMATION:"spring",SPRING_STIFFNESS:.15,SPRING_DAMPING:.75,SETTLE_THRESHOLD:.5,TENSION_REDUCTION:.4},EFFECTS:{GLOW_INNER_RADIUS:6,GLOW_OUTER_RADIUS:12,GLOW_INNER_OPACITY:.3,GLOW_OUTER_OPACITY:.12,SELECTION_RING_WIDTH:3,DRAG_GLOW_MULTIPLIER:1.3},PHYSICS:{ALPHA_INITIAL:1,ALPHA_MIN:.001,ALPHA_DECAY:.0228,VELOCITY_DECAY:.4,REPULSION_STRENGTH:1500,LINK_STRENGTH:.03,LINK_DISTANCE:250,CENTER_STRENGTH:.03,MIN_DISTANCE:80,CANVAS_PADDING:30},LABELS:{FONT_FAMILY:"Inter, -apple-system, BlinkMacSystemFont, sans-serif",FONT_SIZE:11},INTERACTION:{DOUBLE_CLICK_UNPIN:!0,DOUBLE_CLICK_THRESHOLD:300,CURSORS:{force:"grab",force_dragging:"grabbing",force_hover:"grab",draw:"crosshair",draw_hover:"pointer",delete:"not-allowed",delete_hover:"pointer",edit:"text",default:"default"}}};class rp{constructor(e,i,s,r=null){this.id=e,this.label=r!==null?r.toString():e.toString(),this.x=i,this.y=s,this.vx=0,this.vy=0,this.fx=null,this.fy=null,this.connections=0,this.isHovered=!1,this.isSelected=!1,this.isDimmed=!1,this.isAccent=!1,this.isDragging=!1}get radius(){const{NODE:e}=gt,i=Math.log2(this.connections+1)*e.CENTRALITY_FACTOR,s=e.BASE_RADIUS+i;return Math.max(e.MIN_RADIUS,Math.min(s,e.MAX_RADIUS))}get isPinned(){return this.fx!==null||this.fy!==null}containsPoint(e,i){const{NODE:s}=gt,r=e-this.x,n=i-this.y,a=this.radius+s.HITBOX_PADDING;return r*r+n*n<=a*a}draw(e){const{COLORS:i,EFFECTS:s}=gt;e.save();const r=this.isAccent?i.NODE_ACCENT:i.NODE_PRIMARY,n=this.isAccent?i.NODE_GLOW_ACCENT:i.NODE_GLOW_PRIMARY;e.globalAlpha=this.isDimmed?i.DIMMED_OPACITY:1;let a=this.radius;if(this.isHovered&&!this.isDragging?a*=gt.NODE.HOVER_SCALE:this.isDragging&&(a*=1.1),!this.isDimmed){const h=this.isDragging?s.DRAG_GLOW_MULTIPLIER:1;e.beginPath(),e.arc(this.x,this.y,a+s.GLOW_OUTER_RADIUS*h,0,Math.PI*2),e.fillStyle=this._adjustGlowOpacity(n,s.GLOW_OUTER_OPACITY*h),e.fill(),e.beginPath(),e.arc(this.x,this.y,a+s.GLOW_INNER_RADIUS*h,0,Math.PI*2),e.fillStyle=this._adjustGlowOpacity(n,s.GLOW_INNER_OPACITY*h),e.fill()}e.beginPath(),e.arc(this.x,this.y,a,0,Math.PI*2);const o=e.createRadialGradient(this.x-a*.3,this.y-a*.3,a*.1,this.x,this.y,a),l=this._lightenColor(r,30),c=this._darkenColor(r,15);o.addColorStop(0,l),o.addColorStop(.5,r),o.addColorStop(1,c),e.fillStyle=o,e.fill(),e.strokeStyle="rgba(255, 255, 255, 0.3)",e.lineWidth=1.5,e.stroke(),(this.isHovered||this.isSelected)&&(e.beginPath(),e.arc(this.x,this.y,a+3,0,Math.PI*2),e.strokeStyle=i.SELECTED,e.lineWidth=s.SELECTION_RING_WIDTH,e.stroke()),e.restore()}_lightenColor(e,i){const s=parseInt(e.replace("#",""),16),r=Math.round(2.55*i),n=Math.min(255,(s>>16)+r),a=Math.min(255,(s>>8&255)+r),o=Math.min(255,(s&255)+r);return`rgb(${n}, ${a}, ${o})`}_darkenColor(e,i){const s=parseInt(e.replace("#",""),16),r=Math.round(2.55*i),n=Math.max(0,(s>>16)-r),a=Math.max(0,(s>>8&255)-r),o=Math.max(0,(s&255)-r);return`rgb(${n}, ${a}, ${o})`}drawLabel(e){const{COLORS:i,LABELS:s}=gt;e.save(),e.globalAlpha=this.isDimmed?i.DIMMED_OPACITY:1;const r=Math.max(11,Math.min(this.radius*1.1,18)),n=r*.7;e.beginPath(),e.arc(this.x,this.y,n,0,Math.PI*2),e.fillStyle="rgba(0, 0, 0, 0.5)",e.fill(),e.font=`bold ${r}px ${s.FONT_FAMILY}`,e.textAlign="center",e.textBaseline="middle",e.shadowColor="rgba(0, 0, 0, 0.9)",e.shadowBlur=4,e.shadowOffsetX=0,e.shadowOffsetY=0,e.fillStyle="#ffffff",e.fillText(this.label,this.x,this.y),e.restore()}_adjustGlowOpacity(e,i){const s=e.match(/rgba?\((\d+),\s*(\d+),\s*(\d+)/);return s?`rgba(${s[1]}, ${s[2]}, ${s[3]}, ${i})`:e}unpin(){this.fx=null,this.fy=null}pin(){this.fx=this.x,this.fy=this.y}resetVisualState(){this.isHovered=!1,this.isSelected=!1,this.isDimmed=!1,this.isAccent=!1}}class np{constructor(e,i,s=1){this.source=e,this.target=i,this.weight=s,this.directed=!1,this.isHighlighted=!1,this.isDimmed=!1,this.isAlgorithmPath=!1,this.curveControlPoint=null,this.deflectionAmount=0,this.targetControlPoint=null,this.animatedControlPoint=null,this.springVelocity={x:0,y:0},this.isAnimating=!1}draw(e){const{COLORS:i,EDGE:s,EDGE_CURVING:r}=gt;e.save();let n;this.isAlgorithmPath?n=i.ALGORITHM_PATH:this.isDimmed?n=i.EDGE_DIMMED:this.isHighlighted?n=i.EDGE_HIGHLIGHTED:n=i.EDGE,e.strokeStyle=n;let a=this.isHighlighted?s.WIDTH_HIGHLIGHTED:s.WIDTH;if(this.deflectionAmount>0){const d=this.deflectionAmount*r.TENSION_REDUCTION;a*=1-d}if(e.lineWidth=a,e.lineCap=s.LINE_CAP,!this.isDimmed)if(this.deflectionAmount>0){const d=.4+this.deflectionAmount*.4;e.shadowColor=`rgba(100, 180, 255, ${d})`,e.shadowBlur=this.isHighlighted?12:8}else e.shadowColor="rgba(100, 180, 255, 0.4)",e.shadowBlur=this.isHighlighted?8:4;const o=this.source.x,l=this.source.y,c=this.target.x,h=this.target.y;e.beginPath(),e.moveTo(o,l),this.curveControlPoint?e.quadraticCurveTo(this.curveControlPoint.x,this.curveControlPoint.y,c,h):e.lineTo(c,h),e.stroke(),e.shadowBlur=0,this.directed&&this.drawArrow(e,o,l,c,h),this.weight!==1&&this.drawWeight(e,o,l,c,h),e.restore()}calculateCurve(e){const{EDGE_CURVING:i}=gt;if(!e)return this.curveControlPoint=null,this.deflectionAmount=0,!1;if(this.source.id===e.id||this.target.id===e.id)return this.curveControlPoint=null,this.deflectionAmount=0,!1;const s=this.source.x,r=this.source.y,n=this.target.x,a=this.target.y,o=e.x,l=e.y,c=i.CURVE_RADIUS,h=Math.min(s,n)-c,d=Math.max(s,n)+c,u=Math.min(r,a)-c,p=Math.max(r,a)+c;if(o<h||o>d||l<u||l>p)return this.curveControlPoint=null,this.deflectionAmount=0,!1;const f=n-s,g=a-r,m=f*f+g*g;if(m===0)return this.curveControlPoint=null,this.deflectionAmount=0,!1;const y=Math.max(0,Math.min(1,((o-s)*f+(l-r)*g)/m)),b=s+y*f,w=r+y*g,k=o-b,x=l-w,E=Math.sqrt(k*k+x*x);if(E>=i.CURVE_RADIUS)return this.curveControlPoint=null,this.deflectionAmount=0,!1;const _=E/i.CURVE_RADIUS;let C=(1-Math.pow(_,3))*i.CURVE_STRENGTH*i.CURVE_RADIUS;C=Math.max(i.MIN_DEFLECTION,Math.min(i.MAX_DEFLECTION,C)),this.deflectionAmount=C/i.MAX_DEFLECTION;const D=Math.sqrt(m),q=-g/D,A=f/D,L=(o-s)*g-(l-r)*f>0?1:-1,W=s+y*f,M=r+y*g;return this.curveControlPoint={x:W+q*C*L,y:M+A*C*L},this.targetControlPoint={...this.curveControlPoint},this.isAnimating=!1,!0}clearCurve(){const{EDGE_CURVING:e}=gt;this.curveControlPoint&&e.RETURN_ANIMATION==="spring"?(this.animatedControlPoint={...this.curveControlPoint},this.targetControlPoint=null,this.isAnimating=!0):(this.curveControlPoint=null,this.animatedControlPoint=null,this.targetControlPoint=null,this.isAnimating=!1),this.deflectionAmount=0,this.springVelocity={x:0,y:0}}updateSpringAnimation(){const{EDGE_CURVING:e}=gt;if(!this.isAnimating||!this.animatedControlPoint)return!1;const i=this.source.x,s=this.source.y,r=this.target.x,n=this.target.y,a=(i+r)/2,o=(s+n)/2,l=a-this.animatedControlPoint.x,c=o-this.animatedControlPoint.y;this.springVelocity.x=this.springVelocity.x*e.SPRING_DAMPING+l*e.SPRING_STIFFNESS,this.springVelocity.y=this.springVelocity.y*e.SPRING_DAMPING+c*e.SPRING_STIFFNESS,this.animatedControlPoint.x+=this.springVelocity.x,this.animatedControlPoint.y+=this.springVelocity.y,this.curveControlPoint={...this.animatedControlPoint};const h=Math.hypot(l,c);return this.deflectionAmount=Math.min(1,h/e.MAX_DEFLECTION),Math.abs(l)<e.SETTLE_THRESHOLD&&Math.abs(c)<e.SETTLE_THRESHOLD&&Math.abs(this.springVelocity.x)<.1&&Math.abs(this.springVelocity.y)<.1?(this.curveControlPoint=null,this.animatedControlPoint=null,this.isAnimating=!1,this.deflectionAmount=0,this.springVelocity={x:0,y:0},!1):!0}drawArrow(e,i,s,r,n){const{EDGE:a}=gt;let o;if(this.curveControlPoint){const h=r-this.curveControlPoint.x,d=n-this.curveControlPoint.y;o=Math.atan2(d,h)}else o=Math.atan2(n-s,r-i);const l=r-this.target.radius*Math.cos(o),c=n-this.target.radius*Math.sin(o);e.beginPath(),e.moveTo(l,c),e.lineTo(l-a.ARROW_LENGTH*Math.cos(o-a.ARROW_ANGLE),c-a.ARROW_LENGTH*Math.sin(o-a.ARROW_ANGLE)),e.lineTo(l-a.ARROW_LENGTH*Math.cos(o+a.ARROW_ANGLE),c-a.ARROW_LENGTH*Math.sin(o+a.ARROW_ANGLE)),e.closePath(),e.fillStyle=e.strokeStyle,e.fill()}drawWeight(e,i,s,r,n){const{COLORS:a,LABELS:o}=gt;let l,c;if(this.curveControlPoint){const f=this.curveControlPoint.x,g=this.curveControlPoint.y;l=(1-.5)*(1-.5)*i+2*(1-.5)*.5*f+.5*.5*r,c=(1-.5)*(1-.5)*s+2*(1-.5)*.5*g+.5*.5*n}else l=(i+r)/2,c=(s+n)/2;const h=this.weight.toString();e.font=`bold ${o.FONT_SIZE}px ${o.FONT_FAMILY}`,e.textAlign="center",e.textBaseline="middle";const d=e.measureText(h),u=4;e.fillStyle=a.WEIGHT_BG,e.fillRect(l-d.width/2-u,c-o.FONT_SIZE/2-2,d.width+u*2,o.FONT_SIZE+4),e.fillStyle=a.WEIGHT_TEXT,e.fillText(h,l,c)}containsPoint(e,i){const{EDGE:s}=gt,r=this.source.x,n=this.source.y,a=this.target.x,o=this.target.y;if(this.curveControlPoint){const p=this.curveControlPoint.x,f=this.curveControlPoint.y,g=12;for(let m=0;m<=g;m++){const y=m/g,b=(1-y)*(1-y)*r+2*(1-y)*y*p+y*y*a,w=(1-y)*(1-y)*n+2*(1-y)*y*f+y*y*o;if(Math.hypot(e-b,i-w)<s.HITBOX_DISTANCE)return!0}return!1}const l=(a-r)**2+(o-n)**2;if(l===0)return Math.hypot(e-r,i-n)<s.HITBOX_DISTANCE;const c=Math.max(0,Math.min(1,((e-r)*(a-r)+(i-n)*(o-n))/l)),h=r+c*(a-r),d=n+c*(o-n);return Math.hypot(e-h,i-d)<s.HITBOX_DISTANCE}connectsTo(e){return this.source.id===e.id||this.target.id===e.id}getOther(e){return this.source.id===e.id?this.target:this.target.id===e.id?this.source:null}resetVisualState(){this.isHighlighted=!1,this.isDimmed=!1,this.isAlgorithmPath=!1}}class m1{constructor(e){this.graphCanvas=e,this.isRunning=!1,this.isPaused=!1,this.animationId=null,this.velocities=new Map;const i=gt.PHYSICS;this.alphaInitial=i.ALPHA_INITIAL,this.alpha=this.alphaInitial,this.alphaDecay=i.ALPHA_DECAY,this.alphaMin=i.ALPHA_MIN,this.alphaTarget=0,this.repulsionStrength=Math.abs(i.REPULSION_STRENGTH),this.linkStrength=i.LINK_STRENGTH,this.linkDistance=i.LINK_DISTANCE,this.minDistance=i.MIN_DISTANCE,this.centeringStrength=i.CENTER_STRENGTH,this.velocityDecay=i.VELOCITY_DECAY,this.maxVelocity=50,this.listeners={tick:[],end:[],start:[]},this.cachedNodes=null,this.nodesCacheInvalid=!0}start(){if(this.isPaused){this.resume();return}this.isRunning||(this.isRunning=!0,this.isPaused=!1,this.alpha=this.alphaInitial,this.initVelocities(),this.emit("start",{}),this.tick())}stop(){this.isRunning=!1,this.isPaused=!1,this.animationId&&(cancelAnimationFrame(this.animationId),this.animationId=null)}initVelocities(){this.velocities.clear(),this.graphCanvas.nodes.forEach((e,i)=>{this.velocities.set(i,{vx:0,vy:0})})}tick(){!this.isRunning||this.isPaused||(this.applyRepulsion(),this.applyAttraction(),this.applyCentering(),this.applyCollision(),this.updatePositions(),this.alpha+=(this.alphaTarget-this.alpha)*this.alphaDecay,this.emit("tick",{alpha:this.alpha}),this.graphCanvas.render(),this.alpha<this.alphaMin&&this.alphaTarget===0?(this.stop(),this.emit("end",{})):this.animationId=requestAnimationFrame(()=>this.tick()))}isNodePinned(e){return e.fx!==null||e.fy!==null}get nodes(){return(this.nodesCacheInvalid||!this.cachedNodes)&&(this.cachedNodes=Array.from(this.graphCanvas.nodes.values()),this.nodesCacheInvalid=!1),this.cachedNodes}applyRepulsion(){const e=this.nodes,i=e.length,s=this.minDistance*this.minDistance;for(let r=0;r<i;r++){const n=e[r],a=this.isNodePinned(n);for(let o=r+1;o<i;o++){const l=e[o],c=this.isNodePinned(l);if(a&&c)continue;const h=l.x-n.x,d=l.y-n.y,u=h*h+d*d,p=Math.sqrt(u+s),f=this.repulsionStrength*this.alpha/(u+s),g=h/p*f,m=d/p*f,y=this.velocities.get(n.id),b=this.velocities.get(l.id);y&&!a&&(y.vx-=g,y.vy-=m),b&&!c&&(b.vx+=g,b.vy+=m)}}}applyAttraction(){for(const e of this.graphCanvas.edges){const i=e.source,s=e.target,r=this.isNodePinned(i),n=this.isNodePinned(s);if(r&&n)continue;const a=s.x-i.x,o=s.y-i.y,l=Math.sqrt(a*a+o*o)||this.minDistance,c=e.weight||1,h=this.linkDistance/Math.sqrt(c),u=(l-h)*this.linkStrength*this.alpha,p=a/l*u,f=o/l*u,g=this.velocities.get(i.id),m=this.velocities.get(s.id);g&&!r&&(g.vx+=p,g.vy+=f),m&&!n&&(m.vx-=p,m.vy-=f)}}applyCentering(){const e=this.nodes;if(e.length===0)return;let s=0,r=0,n=0;for(const u of e)this.isNodePinned(u)||(s+=u.x,r+=u.y,n++);if(n===0)return;const a=s/n,o=r/n,l=this.graphCanvas.displayWidth/2,c=this.graphCanvas.displayHeight/2,h=(l-a)*this.centeringStrength,d=(c-o)*this.centeringStrength;for(const u of e){if(this.isNodePinned(u))continue;const p=this.velocities.get(u.id);p&&(p.vx+=h*this.alpha,p.vy+=d*this.alpha)}}applyCollision(){const e=this.nodes,i=e.length,s=40,r=1;for(let n=0;n<i;n++){const a=e[n];if(!this.isNodePinned(a))for(let o=n+1;o<i;o++){const l=e[o],c=l.x-a.x,h=l.y-a.y,d=Math.sqrt(c*c+h*h)||1,u=s*2;if(d<u){const p=u-d,f=c/d*p*r*.5,g=h/d*p*r*.5;this.isNodePinned(a)||(a.x-=f,a.y-=g),this.isNodePinned(l)||(l.x+=f,l.y+=g)}}}}updatePositions(){const e=gt.PHYSICS.CANVAS_PADDING,i=this.graphCanvas.displayWidth,s=this.graphCanvas.displayHeight;this.graphCanvas.nodes.forEach((r,n)=>{if(this.graphCanvas.dragNode===r)return;const a=this.velocities.get(n);if(!a)return;if(r.fx!==null&&(r.x=r.fx),r.fy!==null&&(r.y=r.fy),this.isNodePinned(r)){a.vx=0,a.vy=0;return}const o=Math.sqrt(a.vx*a.vx+a.vy*a.vy);if(o>this.maxVelocity){const l=this.maxVelocity/o;a.vx*=l,a.vy*=l}r.x+=a.vx,r.y+=a.vy,a.vx*=1-this.velocityDecay,a.vy*=1-this.velocityDecay,r.x<e&&(r.x=e,a.vx=Math.abs(a.vx)*.5),r.x>i-e&&(r.x=i-e,a.vx=-Math.abs(a.vx)*.5),r.y<e&&(r.y=e,a.vy=Math.abs(a.vy)*.5),r.y>s-e&&(r.y=s-e,a.vy=-Math.abs(a.vy)*.5)})}fixNode(e){const i=this.velocities.get(e);i&&(i.vx=0,i.vy=0)}on(e,i){return this.listeners[e]&&this.listeners[e].push(i),this}emit(e,i){for(const s of this.listeners[e]||[])s(i)}pause(){this.isRunning&&(this.isPaused=!0,this.animationId&&(cancelAnimationFrame(this.animationId),this.animationId=null))}resume(){this.isPaused&&(this.isPaused=!1,this.tick())}get paused(){return this.isPaused}restart(){this.stop(),this.alpha=this.alphaInitial,this.alphaTarget=0,this.initVelocities(),this.isRunning=!0,this.isPaused=!1,this.emit("start",{}),this.tick()}reheat(e=.3,i=!1){this.alpha=Math.max(this.alpha,e),i&&this.initVelocities(),this.isRunning?this.isPaused&&this.resume():(this.isRunning=!0,this.isPaused=!1,this.emit("start",{}),this.tick())}onNodeAdded(e){this.velocities.set(e.id,{vx:0,vy:0}),this.nodesCacheInvalid=!0,this.reheat(.5)}onNodeRemoved(e){this.velocities.delete(e),this.nodesCacheInvalid=!0,this.reheat(.3)}onEdgeAdded(){this.reheat(.3)}onEdgeRemoved(){this.reheat(.2)}onNodeDragStart(e){this.fixNode(e.id),this.alphaTarget=.3,this.isRunning||(this.isRunning=!0,this.isPaused=!1,this.tick())}onNodeDragged(e){this.fixNode(e.id),this.alpha=Math.max(this.alpha,.1)}onNodeDragEnd(e){this.alphaTarget=0,this.reheat(.3)}setRepulsion(e){this.repulsionStrength=Math.abs(e),this.reheat(.3)}setLinkDistance(e){this.linkDistance=e,this.reheat(.3)}setLinkStrength(e){this.linkStrength=e,this.reheat(.3)}setCenteringStrength(e){this.centeringStrength=e,this.reheat(.3)}}class O1{constructor(e){this.canvas=e,this.ctx=e.getContext("2d"),this.dpr=Math.min(2,window.devicePixelRatio||1),this.displayWidth=800,this.displayHeight=500,this.resizeObserver=null,this.nodes=new Map,this.edges=[],this.nextNodeId=0,this.directed=!1,this.weighted=!1,this.mode="force",this.hoveredNode=null,this.selectedNode=null,this.dragNode=null,this.isDragging=!1,this.edgeStartNode=null,this.lastClickTime=0,this.simulation=null,this.textArea=null,this.setupCanvas(),this.bindResizeObserver(),this.setupEventListeners(),this.initSimulation(),this.render(),console.log("[GraphCanvas] Initialized")}initSimulation(){this.simulation=new m1(this),this.mode==="force"&&this.simulation.start()}setupCanvas(){const e=this.canvas.getBoundingClientRect(),i=this.canvas.parentElement,s=i==null?void 0:i.getBoundingClientRect();let r=e.width,n=e.height;(r<50||n<50)&&(r=(s==null?void 0:s.width)||(i==null?void 0:i.offsetWidth)||800,n=(s==null?void 0:s.height)||(i==null?void 0:i.offsetHeight)||500),this.displayWidth=Math.max(r,200),this.displayHeight=Math.max(n,200),this.canvas.width=this.displayWidth*this.dpr,this.canvas.height=this.displayHeight*this.dpr,this.ctx.setTransform(1,0,0,1,0,0),this.ctx.scale(this.dpr,this.dpr),this.canvas.style.width="100%",this.canvas.style.height=`${this.displayHeight}px`,console.log(`[GraphCanvas] Canvas setup: ${this.displayWidth}x${this.displayHeight} @${this.dpr}x DPR`)}bindResizeObserver(){this.resizeObserver&&this.resizeObserver.disconnect(),this.resizeObserver=new ResizeObserver(e=>{for(const i of e){const{width:s}=i.contentRect;s>0&&(this.setupCanvas(),this.render())}}),this.canvas.parentElement&&this.resizeObserver.observe(this.canvas.parentElement),setTimeout(()=>{this.setupCanvas(),this.render()},100)}forceResize(){this.setupCanvas(),this.render()}addNode(e,i,s=null){const r=this.nextNodeId++,n=new rp(r,e,i,s);return this.nodes.set(r,n),this.simulation&&this.simulation.onNodeAdded(n),this.syncTextFromCanvas(),this.render(),console.log(`[GraphCanvas] Added node ${r} at (${e}, ${i})`),n}removeNode(e){this.edges=this.edges.filter(i=>i.source.id!==e&&i.target.id!==e),this.nodes.delete(e),this.simulation&&this.simulation.onNodeRemoved(e),this.updateConnectionCounts(),this.syncTextFromCanvas(),this.render(),console.log(`[GraphCanvas] Removed node ${e}`)}removeNodeSilent(e){this.edges=this.edges.filter(i=>i.source.id!==e&&i.target.id!==e),this.nodes.delete(e),this.simulation&&this.simulation.onNodeRemoved(e),this.updateConnectionCounts()}getNodeAt(e,i){const s=Array.from(this.nodes.values()).reverse();for(const r of s)if(r.containsPoint(e,i))return r;return null}addEdge(e,i,s=1){const r=this.nodes.get(e),n=this.nodes.get(i);if(!r||!n)return console.warn("[GraphCanvas] Cannot add edge: invalid node IDs"),null;if(e===i)return console.warn("[GraphCanvas] Cannot add self-loop"),null;if(this.edges.some(l=>l.source.id===e&&l.target.id===i))return console.warn("[GraphCanvas] Edge already exists"),null;const o=new np(r,n,s);return o.directed=this.directed,this.edges.push(o),this.updateConnectionCounts(),this.simulation&&this.simulation.reheat(),this.syncTextFromCanvas(),this.render(),console.log(`[GraphCanvas] Added edge ${e} â†’ ${i}`),o}removeEdge(e){const i=this.edges.indexOf(e);i>-1&&(this.edges.splice(i,1),this.simulation&&this.simulation.onEdgeRemoved(),this.updateConnectionCounts(),this.syncTextFromCanvas(),this.render(),console.log("[GraphCanvas] Removed edge"))}getEdgeAt(e,i){for(const s of this.edges)if(s.containsPoint(e,i))return s;return null}updateConnectionCounts(){for(const e of this.nodes.values())e.connections=0;for(const e of this.edges)e.source.connections++,e.target.connections++}render(){const{COLORS:e}=gt,i=this.ctx,s=this.displayWidth,r=this.displayHeight;{const a=i.createLinearGradient(0,0,s,r);a.addColorStop(0,e.BACKGROUND),a.addColorStop(1,e.BACKGROUND_SECONDARY),i.fillStyle=a}i.fillRect(0,0,s,r);let n=!1;for(const a of this.edges)this.isDragging&&this.dragNode?a.calculateCurve(this.dragNode):a.isAnimating?a.updateSpringAnimation()&&(n=!0):a.curveControlPoint&&!a.isAnimating&&(a.clearCurve(),a.isAnimating&&(n=!0));for(const a of this.edges)a.draw(i);for(const a of this.nodes.values())a.draw(i);for(const a of this.nodes.values())a.drawLabel(i);this.edgeStartNode&&this.mode==="draw"&&this.drawEdgePreview(),n&&requestAnimationFrame(()=>this.render())}drawEdgePreview(){}setupEventListeners(){this.canvas.addEventListener("mousedown",this.onMouseDown.bind(this)),this.canvas.addEventListener("mousemove",this.onMouseMove.bind(this)),this.canvas.addEventListener("mouseup",this.onMouseUp.bind(this)),this.canvas.addEventListener("mouseleave",this.onMouseLeave.bind(this)),this.canvas.addEventListener("contextmenu",e=>e.preventDefault()),this.canvas.tabIndex=0}getMousePos(e){const i=this.canvas.getBoundingClientRect(),s=this.displayWidth/i.width,r=this.displayHeight/i.height;return{x:(e.clientX-i.left)*s,y:(e.clientY-i.top)*r}}onMouseDown(e){const i=this.getMousePos(e),s=this.getNodeAt(i.x,i.y),{INTERACTION:r}=gt,n=Date.now(),a=n-this.lastClickTime<r.DOUBLE_CLICK_THRESHOLD;switch(this.lastClickTime=n,this.mode){case"force":s&&(a&&r.DOUBLE_CLICK_UNPIN&&s.isPinned?(s.unpin(),this.render()):(this.dragNode=s,this.isDragging=!0,s.isDragging=!0,s.fx=s.x,s.fy=s.y,this.canvas.style.cursor=r.CURSORS.force_dragging,this.simulation&&this.simulation.onNodeDragStart(s)));break;case"draw":s?(this.edgeStartNode=s,s.isSelected=!0,this.render()):this.addNode(i.x,i.y);break;case"delete":if(s)this.removeNode(s.id);else{const o=this.getEdgeAt(i.x,i.y);o&&this.removeEdge(o)}break}}onMouseMove(e){const i=this.getMousePos(e),s=this.hoveredNode;this.hoveredNode=this.getNodeAt(i.x,i.y),s!==this.hoveredNode&&(s&&(s.isHovered=!1),this.hoveredNode&&(this.hoveredNode.isHovered=!0),this.updateHoverFocus()),this.isDragging&&this.dragNode&&(this.dragNode.x=i.x,this.dragNode.y=i.y,this.dragNode.fx=i.x,this.dragNode.fy=i.y,this.simulation&&this.simulation.onNodeDragged(this.dragNode),this.render()),this.updateCursor()}onMouseUp(e){const i=this.getMousePos(e);if(this.edgeStartNode){const s=this.getNodeAt(i.x,i.y);if(s&&s!==this.edgeStartNode){const r=(this.weighted,1);this.addEdge(this.edgeStartNode.id,s.id,r)}this.edgeStartNode.isSelected=!1,this.edgeStartNode=null}this.dragNode&&(this.dragNode.isDragging=!1,this.dragNode.unpin(),this.simulation&&this.simulation.onNodeDragEnd(this.dragNode),this.dragNode=null,this.isDragging=!1),this.updateCursor(),this.render()}onMouseLeave(){this.dragNode&&(this.dragNode.isDragging=!1,this.dragNode.unpin(),this.simulation&&this.simulation.onNodeDragEnd(this.dragNode),this.dragNode=null,this.isDragging=!1),this.edgeStartNode&&(this.edgeStartNode.isSelected=!1,this.edgeStartNode=null),this.hoveredNode&&(this.hoveredNode.isHovered=!1,this.hoveredNode=null),this.clearHoverFocus(),this.updateCursor(),this.render()}updateHoverFocus(){if(!this.hoveredNode){this.clearHoverFocus();return}const e=new Set([this.hoveredNode.id]);for(const i of this.edges)i.source.id===this.hoveredNode.id&&e.add(i.target.id),i.target.id===this.hoveredNode.id&&e.add(i.source.id);for(const i of this.edges){const s=i.connectsTo(this.hoveredNode);i.isHighlighted=s}this.render()}clearHoverFocus(){for(const e of this.nodes.values())e.isDimmed=!1;for(const e of this.edges)e.isDimmed=!1,e.isHighlighted=!1;this.render()}updateCursor(){const{INTERACTION:e}=gt;if(this.isDragging){this.canvas.style.cursor=e.CURSORS.force_dragging;return}const i=e.CURSORS[this.mode]||e.CURSORS.default,s=e.CURSORS[`${this.mode}_hover`]||i;this.canvas.style.cursor=this.hoveredNode?s:i}setMode(e){this.mode=e,this.edgeStartNode&&(this.edgeStartNode.isSelected=!1,this.edgeStartNode=null),this.dragNode=null,this.isDragging=!1,this.simulation&&(e==="force"?this.simulation.start():this.simulation.stop()),this.updateCursor(),this.render(),this.canvas.dispatchEvent(new CustomEvent("modechange",{detail:{mode:e}})),console.log(`[GraphCanvas] Mode changed to: ${e}`)}setDirected(e){this.directed=e;for(const i of this.edges)i.directed=e;this.render(),console.log(`[GraphCanvas] Directed: ${e}`)}setWeighted(e){this.weighted=e,this.render(),console.log(`[GraphCanvas] Weighted: ${e}`)}setupTextSync(e){this.textArea=e,this._parseDebounceTimeout=null,e.addEventListener("input",()=>{clearTimeout(this._parseDebounceTimeout),this._parseDebounceTimeout=setTimeout(()=>{this.parseFromText(e.value)},150)})}syncTextFromCanvas(){this.textArea&&(this.textArea.value=this.serializeToText())}parseFromText(e){if(!this._isParsing){this._isParsing=!0;try{const i=e.trim().split(`
`).filter(h=>h.trim()),s=new Set,r=[];for(const h of i){const d=h.trim().split(/\s+/);if(!(d.length===0||d[0]===""))if(d.length===1)s.add(d[0]);else{const[u,p,f]=d;s.add(u),s.add(p);const g=f&&parseFloat(f)||1;r.push({source:u,target:p,weight:g})}}const n=new Map;for(const h of this.nodes.values())n.set(h.label,h);const a=Array.from(s);for(const h of a)if(!n.has(h)){const d=this.canvas.width/2,u=this.canvas.height/2,p=Math.random()*2*Math.PI,f=50+Math.random()*100,g=d+f*Math.cos(p),m=u+f*Math.sin(p),y=this.addNodeSilent(g,m,h);n.set(h,y)}const o=[];for(const[h,d]of n)s.has(h)||o.push(d.id);for(const h of o)this.removeNodeSilent(h);const l=new Set(r.map(h=>`${h.source}-${h.target}`)),c=this.edges.filter(h=>{const d=`${h.source.label}-${h.target.label}`,u=`${h.target.label}-${h.source.label}`;return!l.has(d)&&!l.has(u)});for(const h of c){const d=this.edges.indexOf(h);d!==-1&&this.edges.splice(d,1)}for(const{source:h,target:d,weight:u}of r){const p=n.get(h),f=n.get(d);p&&f&&(this.edges.some(m=>m.source.id===p.id&&m.target.id===f.id||m.source.id===f.id&&m.target.id===p.id)||this.addEdgeSilent(p.id,f.id,u))}this.simulation&&this.simulation.reheat(.5),this.render()}finally{this._isParsing=!1}}}addNodeSilent(e,i,s=null){const r=this.nextNodeId++,n=new rp(r,e,i,s);return this.nodes.set(r,n),this.simulation&&this.simulation.onNodeAdded(n),n}addEdgeSilent(e,i,s=1){const r=this.nodes.get(e),n=this.nodes.get(i);if(!r||!n||e===i)return null;const a=new np(r,n,s);return a.directed=this.directed,this.edges.push(a),this.updateConnectionCounts(),this.simulation&&this.simulation.onEdgeAdded(),a}serializeToText(){const e=[];for(const s of this.edges){const r=s.source.label,n=s.target.label;this.weighted&&s.weight!==1?e.push(`${r} ${n} ${s.weight}`):e.push(`${r} ${n}`)}const i=new Set;for(const s of this.edges)i.add(s.source.id),i.add(s.target.id);for(const s of this.nodes.values())i.has(s.id)||e.push(s.label);return e.join(`
`)}clear(){this.nodes.clear(),this.edges=[],this.nextNodeId=0,this.syncTextFromCanvas(),this.render(),console.log("[GraphCanvas] Cleared")}loadSampleGraph(){this.clear();const e=this.canvas.width/2,i=this.canvas.height/2,s=120;for(let n=0;n<5;n++){const a=n*2*Math.PI/5-Math.PI/2,o=e+s*Math.cos(a),l=i+s*Math.sin(a);this.addNode(o,l,String(n))}const r=[[0,1],[1,2],[2,3],[3,4],[4,0],[0,2],[1,3]];for(const[n,a]of r)this.addEdge(n,a);console.log("[GraphCanvas] Loaded sample graph")}}class y1{constructor(e){this.graphCanvas=e}analyze(){const e=this.graphCanvas.nodes,i=this.graphCanvas.edges,s=this.graphCanvas.directed,r=e.size,n=i.length;if(r===0)return{vertices:0,edges:0,isTree:null,isConnected:null,hasCycle:null};if(r===1)return{vertices:1,edges:0,isTree:!0,isConnected:!0,hasCycle:!1};const a=this.buildAdjacencyList(s),o=s?this.isStronglyConnected(a):this.isConnected(a),l=s?this.hasCycleDirected(a):this.hasCycleUndirected(a);let c=null;return s?c=o&&n===r-1:c=o&&!l&&n===r-1,{vertices:r,edges:n,isTree:c,isConnected:o,hasCycle:l}}buildAdjacencyList(e){const i=new Map;for(const[s]of this.graphCanvas.nodes)i.set(s,[]);for(const s of this.graphCanvas.edges)i.get(s.source.id).push(s.target.id),e||i.get(s.target.id).push(s.source.id);return i}isConnected(e){if(e.size===0)return!0;const i=new Set,s=e.keys().next().value,r=[s];for(i.add(s);r.length>0;){const n=r.shift();for(const a of e.get(n)||[])i.has(a)||(i.add(a),r.push(a))}return i.size===e.size}isStronglyConnected(e){if(e.size===0)return!0;const i=e.keys().next().value;if(this.bfs(e,i).size!==e.size)return!1;const r=new Map;for(const[a]of e)r.set(a,[]);for(const a of this.graphCanvas.edges)r.get(a.target.id).push(a.source.id);return this.bfs(r,i).size===e.size}bfs(e,i){const s=new Set,r=[i];for(s.add(i);r.length>0;){const n=r.shift();for(const a of e.get(n)||[])s.has(a)||(s.add(a),r.push(a))}return s}hasCycleUndirected(e){const i=new Set;for(const[s]of e)if(!i.has(s)&&this.dfsCycleUndirected(e,s,-1,i))return!0;return!1}dfsCycleUndirected(e,i,s,r){r.add(i);for(const n of e.get(i)||[])if(r.has(n)){if(n!==s)return!0}else if(this.dfsCycleUndirected(e,n,i,r))return!0;return!1}hasCycleDirected(e){const i=new Map;for(const[s]of e)i.set(s,0);for(const[s]of e)if(i.get(s)===0&&this.dfsCycleDirected(e,s,i))return!0;return!1}dfsCycleDirected(e,i,s){s.set(i,1);for(const r of e.get(i)||[])if(s.get(r)===1||s.get(r)===0&&this.dfsCycleDirected(e,r,s))return!0;return s.set(i,2),!1}}const ap={force:'<span class="help-mode">Force Mode:</span> Drag nodes to reposition. Physics simulation keeps graph organized.',draw:'<span class="help-mode">Draw Mode:</span> Click canvas to add node. Drag from node to node to create edge.',delete:'<span class="help-mode">Delete Mode:</span> Click node or edge to remove it.'};function op(){const t=document.getElementById("graphEditorCanvas");if(!t){console.log("[GraphEditor] Canvas not found, skipping initialization");return}console.log("[GraphEditor] Initializing...");const e=new O1(t);window.graphEditor=e;const i=document.querySelectorAll(".graph-mode-btn");i.forEach(d=>{d.addEventListener("click",()=>{i.forEach(p=>p.classList.remove("active")),d.classList.add("active");const u=d.dataset.mode;e.setMode(u),lp(u)})});const s=document.getElementById("graphDirectedToggle");s&&s.addEventListener("change",d=>{e.setDirected(d.target.checked)});const r=document.getElementById("graphWeightedToggle");r&&r.addEventListener("change",d=>{e.setWeighted(d.target.checked)});const n=document.getElementById("graphLoadSample");n&&n.addEventListener("click",()=>{e.loadSampleGraph()});const a=document.getElementById("graphClear");a?a.addEventListener("click",()=>{console.log("[GraphEditor] Clear All clicked"),confirm("Clear all nodes and edges?")&&(console.log("[GraphEditor] User confirmed clear"),e.clear())}):console.warn("[GraphEditor] Clear button not found!");const o=document.getElementById("graphEdgeInput");o?e.setupTextSync(o):console.warn("[GraphEditor] Sync text area #graphEdgeInput not found"),t.addEventListener("modechange",d=>{lp(d.detail.mode)});const l=new y1(e),c=()=>{const d=l.analyze(),u=document.getElementById("propVertices");u&&(u.textContent=d.vertices);const p=document.getElementById("propEdges");p&&(p.textContent=d.edges);const f=document.getElementById("propIsTree");f&&(f.textContent=d.isTree===null?"â€”":d.isTree?"âœ“":"âœ—");const g=document.getElementById("propConnected");g&&(g.textContent=d.isConnected===null?"â€”":d.isConnected?"âœ“":"âœ—");const m=document.getElementById("propHasCycle");m&&(m.textContent=d.hasCycle===null?"â€”":d.hasCycle?"âœ“":"âœ—")};c();const h=e.render.bind(e);e.render=function(){h(),c()},console.log("[GraphEditor] Initialization complete")}function lp(t){const e=document.getElementById("graphContextHelp");e&&ap[t]&&(e.innerHTML=ap[t])}document.readyState==="loading"?document.addEventListener("DOMContentLoaded",op):op();let Kc=[],nm=[];(()=>{let t="lc,34,7n,7,7b,19,,,,2,,2,,,20,b,1c,l,g,,2t,7,2,6,2,2,,4,z,,u,r,2j,b,1m,9,9,,o,4,,9,,3,,5,17,3,3b,f,,w,1j,,,,4,8,4,,3,7,a,2,t,,1m,,,,2,4,8,,9,,a,2,q,,2,2,1l,,4,2,4,2,2,3,3,,u,2,3,,b,2,1l,,4,5,,2,4,,k,2,m,6,,,1m,,,2,,4,8,,7,3,a,2,u,,1n,,,,c,,9,,14,,3,,1l,3,5,3,,4,7,2,b,2,t,,1m,,2,,2,,3,,5,2,7,2,b,2,s,2,1l,2,,,2,4,8,,9,,a,2,t,,20,,4,,2,3,,,8,,29,,2,7,c,8,2q,,2,9,b,6,22,2,r,,,,,,1j,e,,5,,2,5,b,,10,9,,2u,4,,6,,2,2,2,p,2,4,3,g,4,d,,2,2,6,,f,,jj,3,qa,3,t,3,t,2,u,2,1s,2,,7,8,,2,b,9,,19,3,3b,2,y,,3a,3,4,2,9,,6,3,63,2,2,,1m,,,7,,,,,2,8,6,a,2,,1c,h,1r,4,1c,7,,,5,,14,9,c,2,w,4,2,2,,3,1k,,,2,3,,,3,1m,8,2,2,48,3,,d,,7,4,,6,,3,2,5i,1m,,5,ek,,5f,x,2da,3,3x,,2o,w,fe,6,2x,2,n9w,4,,a,w,2,28,2,7k,,3,,4,,p,2,5,,47,2,q,i,d,,12,8,p,b,1a,3,1c,,2,4,2,2,13,,1v,6,2,2,2,2,c,,8,,1b,,1f,,,3,2,2,5,2,,,16,2,8,,6m,,2,,4,,fn4,,kh,g,g,g,a6,2,gt,,6a,,45,5,1ae,3,,2,5,4,14,3,4,,4l,2,fx,4,ar,2,49,b,4w,,1i,f,1k,3,1d,4,2,2,1x,3,10,5,,8,1q,,c,2,1g,9,a,4,2,,2n,3,2,,,2,6,,4g,,3,8,l,2,1l,2,,,,,m,,e,7,3,5,5f,8,2,3,,,n,,29,,2,6,,,2,,,2,,2,6j,,2,4,6,2,,2,r,2,2d,8,2,,,2,2y,,,,2,6,,,2t,3,2,4,,5,77,9,,2,6t,,a,2,,,4,,40,4,2,2,4,,w,a,14,6,2,4,8,,9,6,2,3,1a,d,,2,ba,7,,6,,,2a,m,2,7,,2,,2,3e,6,3,,,2,,7,,,20,2,3,,,,9n,2,f0b,5,1n,7,t4,,1r,4,29,,f5k,2,43q,,,3,4,5,8,8,2,7,u,4,44,3,1iz,1j,4,1e,8,,e,,m,5,,f,11s,7,,h,2,7,,2,,5,79,7,c5,4,15s,7,31,7,240,5,gx7k,2o,3k,6o".split(",").map(e=>e?parseInt(e,36):1);for(let e=0,i=0;e<t.length;e++)(e%2?nm:Kc).push(i=i+t[e])})();function v1(t){if(t<768)return!1;for(let e=0,i=Kc.length;;){let s=e+i>>1;if(t<Kc[s])i=s;else if(t>=nm[s])e=s+1;else return!0;if(e==i)return!1}}function cp(t){return t>=127462&&t<=127487}const hp=8205;function b1(t,e,i=!0,s=!0){return(i?am:w1)(t,e,s)}function am(t,e,i){if(e==t.length)return e;e&&om(t.charCodeAt(e))&&lm(t.charCodeAt(e-1))&&e--;let s=nc(t,e);for(e+=dp(s);e<t.length;){let r=nc(t,e);if(s==hp||r==hp||i&&v1(r))e+=dp(r),s=r;else if(cp(r)){let n=0,a=e-2;for(;a>=0&&cp(nc(t,a));)n++,a-=2;if(n%2==0)break;e+=2}else break}return e}function w1(t,e,i){for(;e>0;){let s=am(t,e-2,i);if(s<e)return s;e--}return 0}function nc(t,e){let i=t.charCodeAt(e);if(!lm(i)||e+1==t.length)return i;let s=t.charCodeAt(e+1);return om(s)?(i-55296<<10)+(s-56320)+65536:i}function om(t){return t>=56320&&t<57344}function lm(t){return t>=55296&&t<56320}function dp(t){return t<65536?1:2}class $e{lineAt(e){if(e<0||e>this.length)throw new RangeError(`Invalid position ${e} in document of length ${this.length}`);return this.lineInner(e,!1,1,0)}line(e){if(e<1||e>this.lines)throw new RangeError(`Invalid line number ${e} in ${this.lines}-line document`);return this.lineInner(e,!0,1,0)}replace(e,i,s){[e,i]=Gr(this,e,i);let r=[];return this.decompose(0,e,r,2),s.length&&s.decompose(0,s.length,r,3),this.decompose(i,this.length,r,1),Pi.from(r,this.length-(i-e)+s.length)}append(e){return this.replace(this.length,this.length,e)}slice(e,i=this.length){[e,i]=Gr(this,e,i);let s=[];return this.decompose(e,i,s,0),Pi.from(s,i-e)}eq(e){if(e==this)return!0;if(e.length!=this.length||e.lines!=this.lines)return!1;let i=this.scanIdentical(e,1),s=this.length-this.scanIdentical(e,-1),r=new Un(this),n=new Un(e);for(let a=i,o=i;;){if(r.next(a),n.next(a),a=0,r.lineBreak!=n.lineBreak||r.done!=n.done||r.value!=n.value)return!1;if(o+=r.value.length,r.done||o>=s)return!0}}iter(e=1){return new Un(this,e)}iterRange(e,i=this.length){return new cm(this,e,i)}iterLines(e,i){let s;if(e==null)s=this.iter();else{i==null&&(i=this.lines+1);let r=this.line(e).from;s=this.iterRange(r,Math.max(r,i==this.lines+1?this.length:i<=1?0:this.line(i-1).to))}return new hm(s)}toString(){return this.sliceString(0)}toJSON(){let e=[];return this.flatten(e),e}constructor(){}static of(e){if(e.length==0)throw new RangeError("A document must have at least one line");return e.length==1&&!e[0]?$e.empty:e.length<=32?new Xe(e):Pi.from(Xe.split(e,[]))}}class Xe extends $e{constructor(e,i=S1(e)){super(),this.text=e,this.length=i}get lines(){return this.text.length}get children(){return null}lineInner(e,i,s,r){for(let n=0;;n++){let a=this.text[n],o=r+a.length;if((i?s:o)>=e)return new x1(r,o,s,a);r=o+1,s++}}decompose(e,i,s,r){let n=e<=0&&i>=this.length?this:new Xe(up(this.text,e,i),Math.min(i,this.length)-Math.max(0,e));if(r&1){let a=s.pop(),o=yo(n.text,a.text.slice(),0,n.length);if(o.length<=32)s.push(new Xe(o,a.length+n.length));else{let l=o.length>>1;s.push(new Xe(o.slice(0,l)),new Xe(o.slice(l)))}}else s.push(n)}replace(e,i,s){if(!(s instanceof Xe))return super.replace(e,i,s);[e,i]=Gr(this,e,i);let r=yo(this.text,yo(s.text,up(this.text,0,e)),i),n=this.length+s.length-(i-e);return r.length<=32?new Xe(r,n):Pi.from(Xe.split(r,[]),n)}sliceString(e,i=this.length,s=`
`){[e,i]=Gr(this,e,i);let r="";for(let n=0,a=0;n<=i&&a<this.text.length;a++){let o=this.text[a],l=n+o.length;n>e&&a&&(r+=s),e<l&&i>n&&(r+=o.slice(Math.max(0,e-n),i-n)),n=l+1}return r}flatten(e){for(let i of this.text)e.push(i)}scanIdentical(){return 0}static split(e,i){let s=[],r=-1;for(let n of e)s.push(n),r+=n.length+1,s.length==32&&(i.push(new Xe(s,r)),s=[],r=-1);return r>-1&&i.push(new Xe(s,r)),i}}class Pi extends $e{constructor(e,i){super(),this.children=e,this.length=i,this.lines=0;for(let s of e)this.lines+=s.lines}lineInner(e,i,s,r){for(let n=0;;n++){let a=this.children[n],o=r+a.length,l=s+a.lines-1;if((i?l:o)>=e)return a.lineInner(e,i,s,r);r=o+1,s=l+1}}decompose(e,i,s,r){for(let n=0,a=0;a<=i&&n<this.children.length;n++){let o=this.children[n],l=a+o.length;if(e<=l&&i>=a){let c=r&((a<=e?1:0)|(l>=i?2:0));a>=e&&l<=i&&!c?s.push(o):o.decompose(e-a,i-a,s,c)}a=l+1}}replace(e,i,s){if([e,i]=Gr(this,e,i),s.lines<this.lines)for(let r=0,n=0;r<this.children.length;r++){let a=this.children[r],o=n+a.length;if(e>=n&&i<=o){let l=a.replace(e-n,i-n,s),c=this.lines-a.lines+l.lines;if(l.lines<c>>4&&l.lines>c>>6){let h=this.children.slice();return h[r]=l,new Pi(h,this.length-(i-e)+s.length)}return super.replace(n,o,l)}n=o+1}return super.replace(e,i,s)}sliceString(e,i=this.length,s=`
`){[e,i]=Gr(this,e,i);let r="";for(let n=0,a=0;n<this.children.length&&a<=i;n++){let o=this.children[n],l=a+o.length;a>e&&n&&(r+=s),e<l&&i>a&&(r+=o.sliceString(e-a,i-a,s)),a=l+1}return r}flatten(e){for(let i of this.children)i.flatten(e)}scanIdentical(e,i){if(!(e instanceof Pi))return 0;let s=0,[r,n,a,o]=i>0?[0,0,this.children.length,e.children.length]:[this.children.length-1,e.children.length-1,-1,-1];for(;;r+=i,n+=i){if(r==a||n==o)return s;let l=this.children[r],c=e.children[n];if(l!=c)return s+l.scanIdentical(c,i);s+=l.length+1}}static from(e,i=e.reduce((s,r)=>s+r.length+1,-1)){let s=0;for(let p of e)s+=p.lines;if(s<32){let p=[];for(let f of e)f.flatten(p);return new Xe(p,i)}let r=Math.max(32,s>>5),n=r<<1,a=r>>1,o=[],l=0,c=-1,h=[];function d(p){let f;if(p.lines>n&&p instanceof Pi)for(let g of p.children)d(g);else p.lines>a&&(l>a||!l)?(u(),o.push(p)):p instanceof Xe&&l&&(f=h[h.length-1])instanceof Xe&&p.lines+f.lines<=32?(l+=p.lines,c+=p.length+1,h[h.length-1]=new Xe(f.text.concat(p.text),f.length+1+p.length)):(l+p.lines>r&&u(),l+=p.lines,c+=p.length+1,h.push(p))}function u(){l!=0&&(o.push(h.length==1?h[0]:Pi.from(h,c)),c=-1,l=h.length=0)}for(let p of e)d(p);return u(),o.length==1?o[0]:new Pi(o,i)}}$e.empty=new Xe([""],0);function S1(t){let e=-1;for(let i of t)e+=i.length+1;return e}function yo(t,e,i=0,s=1e9){for(let r=0,n=0,a=!0;n<t.length&&r<=s;n++){let o=t[n],l=r+o.length;l>=i&&(l>s&&(o=o.slice(0,s-r)),r<i&&(o=o.slice(i-r)),a?(e[e.length-1]+=o,a=!1):e.push(o)),r=l+1}return e}function up(t,e,i){return yo(t,[""],e,i)}class Un{constructor(e,i=1){this.dir=i,this.done=!1,this.lineBreak=!1,this.value="",this.nodes=[e],this.offsets=[i>0?1:(e instanceof Xe?e.text.length:e.children.length)<<1]}nextInner(e,i){for(this.done=this.lineBreak=!1;;){let s=this.nodes.length-1,r=this.nodes[s],n=this.offsets[s],a=n>>1,o=r instanceof Xe?r.text.length:r.children.length;if(a==(i>0?o:0)){if(s==0)return this.done=!0,this.value="",this;i>0&&this.offsets[s-1]++,this.nodes.pop(),this.offsets.pop()}else if((n&1)==(i>0?0:1)){if(this.offsets[s]+=i,e==0)return this.lineBreak=!0,this.value=`
`,this;e--}else if(r instanceof Xe){let l=r.text[a+(i<0?-1:0)];if(this.offsets[s]+=i,l.length>Math.max(0,e))return this.value=e==0?l:i>0?l.slice(e):l.slice(0,l.length-e),this;e-=l.length}else{let l=r.children[a+(i<0?-1:0)];e>l.length?(e-=l.length,this.offsets[s]+=i):(i<0&&this.offsets[s]--,this.nodes.push(l),this.offsets.push(i>0?1:(l instanceof Xe?l.text.length:l.children.length)<<1))}}}next(e=0){return e<0&&(this.nextInner(-e,-this.dir),e=this.value.length),this.nextInner(e,this.dir)}}class cm{constructor(e,i,s){this.value="",this.done=!1,this.cursor=new Un(e,i>s?-1:1),this.pos=i>s?e.length:0,this.from=Math.min(i,s),this.to=Math.max(i,s)}nextInner(e,i){if(i<0?this.pos<=this.from:this.pos>=this.to)return this.value="",this.done=!0,this;e+=Math.max(0,i<0?this.pos-this.to:this.from-this.pos);let s=i<0?this.pos-this.from:this.to-this.pos;e>s&&(e=s),s-=e;let{value:r}=this.cursor.next(e);return this.pos+=(r.length+e)*i,this.value=r.length<=s?r:i<0?r.slice(r.length-s):r.slice(0,s),this.done=!this.value,this}next(e=0){return e<0?e=Math.max(e,this.from-this.pos):e>0&&(e=Math.min(e,this.to-this.pos)),this.nextInner(e,this.cursor.dir)}get lineBreak(){return this.cursor.lineBreak&&this.value!=""}}class hm{constructor(e){this.inner=e,this.afterBreak=!0,this.value="",this.done=!1}next(e=0){let{done:i,lineBreak:s,value:r}=this.inner.next(e);return i&&this.afterBreak?(this.value="",this.afterBreak=!1):i?(this.done=!0,this.value=""):s?this.afterBreak?this.value="":(this.afterBreak=!0,this.next()):(this.value=r,this.afterBreak=!1),this}get lineBreak(){return!1}}typeof Symbol<"u"&&($e.prototype[Symbol.iterator]=function(){return this.iter()},Un.prototype[Symbol.iterator]=cm.prototype[Symbol.iterator]=hm.prototype[Symbol.iterator]=function(){return this});class x1{constructor(e,i,s,r){this.from=e,this.to=i,this.number=s,this.text=r}get length(){return this.to-this.from}}function Gr(t,e,i){return e=Math.max(0,Math.min(t.length,e)),[e,Math.max(e,Math.min(t.length,i))]}function Ot(t,e,i=!0,s=!0){return b1(t,e,i,s)}function k1(t){return t>=56320&&t<57344}function T1(t){return t>=55296&&t<56320}function dm(t,e){let i=t.charCodeAt(e);if(!T1(i)||e+1==t.length)return i;let s=t.charCodeAt(e+1);return k1(s)?(i-55296<<10)+(s-56320)+65536:i}function E1(t){return t<65536?1:2}const Jc=/\r\n?|\n/;var Ct=function(t){return t[t.Simple=0]="Simple",t[t.TrackDel=1]="TrackDel",t[t.TrackBefore=2]="TrackBefore",t[t.TrackAfter=3]="TrackAfter",t}(Ct||(Ct={}));class Qi{constructor(e){this.sections=e}get length(){let e=0;for(let i=0;i<this.sections.length;i+=2)e+=this.sections[i];return e}get newLength(){let e=0;for(let i=0;i<this.sections.length;i+=2){let s=this.sections[i+1];e+=s<0?this.sections[i]:s}return e}get empty(){return this.sections.length==0||this.sections.length==2&&this.sections[1]<0}iterGaps(e){for(let i=0,s=0,r=0;i<this.sections.length;){let n=this.sections[i++],a=this.sections[i++];a<0?(e(s,r,n),r+=n):r+=a,s+=n}}iterChangedRanges(e,i=!1){eh(this,e,i)}get invertedDesc(){let e=[];for(let i=0;i<this.sections.length;){let s=this.sections[i++],r=this.sections[i++];r<0?e.push(s,r):e.push(r,s)}return new Qi(e)}composeDesc(e){return this.empty?e:e.empty?this:um(this,e)}mapDesc(e,i=!1){return e.empty?this:th(this,e,i)}mapPos(e,i=-1,s=Ct.Simple){let r=0,n=0;for(let a=0;a<this.sections.length;){let o=this.sections[a++],l=this.sections[a++],c=r+o;if(l<0){if(c>e)return n+(e-r);n+=o}else{if(s!=Ct.Simple&&c>=e&&(s==Ct.TrackDel&&r<e&&c>e||s==Ct.TrackBefore&&r<e||s==Ct.TrackAfter&&c>e))return null;if(c>e||c==e&&i<0&&!o)return e==r||i<0?n:n+l;n+=l}r=c}if(e>r)throw new RangeError(`Position ${e} is out of range for changeset of length ${r}`);return n}touchesRange(e,i=e){for(let s=0,r=0;s<this.sections.length&&r<=i;){let n=this.sections[s++],a=this.sections[s++],o=r+n;if(a>=0&&r<=i&&o>=e)return r<e&&o>i?"cover":!0;r=o}return!1}toString(){let e="";for(let i=0;i<this.sections.length;){let s=this.sections[i++],r=this.sections[i++];e+=(e?" ":"")+s+(r>=0?":"+r:"")}return e}toJSON(){return this.sections}static fromJSON(e){if(!Array.isArray(e)||e.length%2||e.some(i=>typeof i!="number"))throw new RangeError("Invalid JSON representation of ChangeDesc");return new Qi(e)}static create(e){return new Qi(e)}}class rt extends Qi{constructor(e,i){super(e),this.inserted=i}apply(e){if(this.length!=e.length)throw new RangeError("Applying change set to a document with the wrong length");return eh(this,(i,s,r,n,a)=>e=e.replace(r,r+(s-i),a),!1),e}mapDesc(e,i=!1){return th(this,e,i,!0)}invert(e){let i=this.sections.slice(),s=[];for(let r=0,n=0;r<i.length;r+=2){let a=i[r],o=i[r+1];if(o>=0){i[r]=o,i[r+1]=a;let l=r>>1;for(;s.length<l;)s.push($e.empty);s.push(a?e.slice(n,n+a):$e.empty)}n+=a}return new rt(i,s)}compose(e){return this.empty?e:e.empty?this:um(this,e,!0)}map(e,i=!1){return e.empty?this:th(this,e,i,!0)}iterChanges(e,i=!1){eh(this,e,i)}get desc(){return Qi.create(this.sections)}filter(e){let i=[],s=[],r=[],n=new oa(this);e:for(let a=0,o=0;;){let l=a==e.length?1e9:e[a++];for(;o<l||o==l&&n.len==0;){if(n.done)break e;let h=Math.min(n.len,l-o);xt(r,h,-1);let d=n.ins==-1?-1:n.off==0?n.ins:0;xt(i,h,d),d>0&&ys(s,i,n.text),n.forward(h),o+=h}let c=e[a++];for(;o<c;){if(n.done)break e;let h=Math.min(n.len,c-o);xt(i,h,-1),xt(r,h,n.ins==-1?-1:n.off==0?n.ins:0),n.forward(h),o+=h}}return{changes:new rt(i,s),filtered:Qi.create(r)}}toJSON(){let e=[];for(let i=0;i<this.sections.length;i+=2){let s=this.sections[i],r=this.sections[i+1];r<0?e.push(s):r==0?e.push([s]):e.push([s].concat(this.inserted[i>>1].toJSON()))}return e}static of(e,i,s){let r=[],n=[],a=0,o=null;function l(h=!1){if(!h&&!r.length)return;a<i&&xt(r,i-a,-1);let d=new rt(r,n);o=o?o.compose(d.map(o)):d,r=[],n=[],a=0}function c(h){if(Array.isArray(h))for(let d of h)c(d);else if(h instanceof rt){if(h.length!=i)throw new RangeError(`Mismatched change set length (got ${h.length}, expected ${i})`);l(),o=o?o.compose(h.map(o)):h}else{let{from:d,to:u=d,insert:p}=h;if(d>u||d<0||u>i)throw new RangeError(`Invalid change range ${d} to ${u} (in doc of length ${i})`);let f=p?typeof p=="string"?$e.of(p.split(s||Jc)):p:$e.empty,g=f.length;if(d==u&&g==0)return;d<a&&l(),d>a&&xt(r,d-a,-1),xt(r,u-d,g),ys(n,r,f),a=u}}return c(e),l(!o),o}static empty(e){return new rt(e?[e,-1]:[],[])}static fromJSON(e){if(!Array.isArray(e))throw new RangeError("Invalid JSON representation of ChangeSet");let i=[],s=[];for(let r=0;r<e.length;r++){let n=e[r];if(typeof n=="number")i.push(n,-1);else{if(!Array.isArray(n)||typeof n[0]!="number"||n.some((a,o)=>o&&typeof a!="string"))throw new RangeError("Invalid JSON representation of ChangeSet");if(n.length==1)i.push(n[0],0);else{for(;s.length<r;)s.push($e.empty);s[r]=$e.of(n.slice(1)),i.push(n[0],s[r].length)}}}return new rt(i,s)}static createSet(e,i){return new rt(e,i)}}function xt(t,e,i,s=!1){if(e==0&&i<=0)return;let r=t.length-2;r>=0&&i<=0&&i==t[r+1]?t[r]+=e:r>=0&&e==0&&t[r]==0?t[r+1]+=i:s?(t[r]+=e,t[r+1]+=i):t.push(e,i)}function ys(t,e,i){if(i.length==0)return;let s=e.length-2>>1;if(s<t.length)t[t.length-1]=t[t.length-1].append(i);else{for(;t.length<s;)t.push($e.empty);t.push(i)}}function eh(t,e,i){let s=t.inserted;for(let r=0,n=0,a=0;a<t.sections.length;){let o=t.sections[a++],l=t.sections[a++];if(l<0)r+=o,n+=o;else{let c=r,h=n,d=$e.empty;for(;c+=o,h+=l,l&&s&&(d=d.append(s[a-2>>1])),!(i||a==t.sections.length||t.sections[a+1]<0);)o=t.sections[a++],l=t.sections[a++];e(r,c,n,h,d),r=c,n=h}}}function th(t,e,i,s=!1){let r=[],n=s?[]:null,a=new oa(t),o=new oa(e);for(let l=-1;;){if(a.done&&o.len||o.done&&a.len)throw new Error("Mismatched change set lengths");if(a.ins==-1&&o.ins==-1){let c=Math.min(a.len,o.len);xt(r,c,-1),a.forward(c),o.forward(c)}else if(o.ins>=0&&(a.ins<0||l==a.i||a.off==0&&(o.len<a.len||o.len==a.len&&!i))){let c=o.len;for(xt(r,o.ins,-1);c;){let h=Math.min(a.len,c);a.ins>=0&&l<a.i&&a.len<=h&&(xt(r,0,a.ins),n&&ys(n,r,a.text),l=a.i),a.forward(h),c-=h}o.next()}else if(a.ins>=0){let c=0,h=a.len;for(;h;)if(o.ins==-1){let d=Math.min(h,o.len);c+=d,h-=d,o.forward(d)}else if(o.ins==0&&o.len<h)h-=o.len,o.next();else break;xt(r,c,l<a.i?a.ins:0),n&&l<a.i&&ys(n,r,a.text),l=a.i,a.forward(a.len-h)}else{if(a.done&&o.done)return n?rt.createSet(r,n):Qi.create(r);throw new Error("Mismatched change set lengths")}}}function um(t,e,i=!1){let s=[],r=i?[]:null,n=new oa(t),a=new oa(e);for(let o=!1;;){if(n.done&&a.done)return r?rt.createSet(s,r):Qi.create(s);if(n.ins==0)xt(s,n.len,0,o),n.next();else if(a.len==0&&!a.done)xt(s,0,a.ins,o),r&&ys(r,s,a.text),a.next();else{if(n.done||a.done)throw new Error("Mismatched change set lengths");{let l=Math.min(n.len2,a.len),c=s.length;if(n.ins==-1){let h=a.ins==-1?-1:a.off?0:a.ins;xt(s,l,h,o),r&&h&&ys(r,s,a.text)}else a.ins==-1?(xt(s,n.off?0:n.len,l,o),r&&ys(r,s,n.textBit(l))):(xt(s,n.off?0:n.len,a.off?0:a.ins,o),r&&!a.off&&ys(r,s,a.text));o=(n.ins>l||a.ins>=0&&a.len>l)&&(o||s.length>c),n.forward2(l),a.forward(l)}}}}class oa{constructor(e){this.set=e,this.i=0,this.next()}next(){let{sections:e}=this.set;this.i<e.length?(this.len=e[this.i++],this.ins=e[this.i++]):(this.len=0,this.ins=-2),this.off=0}get done(){return this.ins==-2}get len2(){return this.ins<0?this.len:this.ins}get text(){let{inserted:e}=this.set,i=this.i-2>>1;return i>=e.length?$e.empty:e[i]}textBit(e){let{inserted:i}=this.set,s=this.i-2>>1;return s>=i.length&&!e?$e.empty:i[s].slice(this.off,e==null?void 0:this.off+e)}forward(e){e==this.len?this.next():(this.len-=e,this.off+=e)}forward2(e){this.ins==-1?this.forward(e):e==this.ins?this.next():(this.ins-=e,this.off+=e)}}class Zs{constructor(e,i,s){this.from=e,this.to=i,this.flags=s}get anchor(){return this.flags&32?this.to:this.from}get head(){return this.flags&32?this.from:this.to}get empty(){return this.from==this.to}get assoc(){return this.flags&8?-1:this.flags&16?1:0}get bidiLevel(){let e=this.flags&7;return e==7?null:e}get goalColumn(){let e=this.flags>>6;return e==16777215?void 0:e}map(e,i=-1){let s,r;return this.empty?s=r=e.mapPos(this.from,i):(s=e.mapPos(this.from,1),r=e.mapPos(this.to,-1)),s==this.from&&r==this.to?this:new Zs(s,r,this.flags)}extend(e,i=e){if(e<=this.anchor&&i>=this.anchor)return X.range(e,i);let s=Math.abs(e-this.anchor)>Math.abs(i-this.anchor)?e:i;return X.range(this.anchor,s)}eq(e,i=!1){return this.anchor==e.anchor&&this.head==e.head&&this.goalColumn==e.goalColumn&&(!i||!this.empty||this.assoc==e.assoc)}toJSON(){return{anchor:this.anchor,head:this.head}}static fromJSON(e){if(!e||typeof e.anchor!="number"||typeof e.head!="number")throw new RangeError("Invalid JSON representation for SelectionRange");return X.range(e.anchor,e.head)}static create(e,i,s){return new Zs(e,i,s)}}class X{constructor(e,i){this.ranges=e,this.mainIndex=i}map(e,i=-1){return e.empty?this:X.create(this.ranges.map(s=>s.map(e,i)),this.mainIndex)}eq(e,i=!1){if(this.ranges.length!=e.ranges.length||this.mainIndex!=e.mainIndex)return!1;for(let s=0;s<this.ranges.length;s++)if(!this.ranges[s].eq(e.ranges[s],i))return!1;return!0}get main(){return this.ranges[this.mainIndex]}asSingle(){return this.ranges.length==1?this:new X([this.main],0)}addRange(e,i=!0){return X.create([e].concat(this.ranges),i?0:this.mainIndex+1)}replaceRange(e,i=this.mainIndex){let s=this.ranges.slice();return s[i]=e,X.create(s,this.mainIndex)}toJSON(){return{ranges:this.ranges.map(e=>e.toJSON()),main:this.mainIndex}}static fromJSON(e){if(!e||!Array.isArray(e.ranges)||typeof e.main!="number"||e.main>=e.ranges.length)throw new RangeError("Invalid JSON representation for EditorSelection");return new X(e.ranges.map(i=>Zs.fromJSON(i)),e.main)}static single(e,i=e){return new X([X.range(e,i)],0)}static create(e,i=0){if(e.length==0)throw new RangeError("A selection needs at least one range");for(let s=0,r=0;r<e.length;r++){let n=e[r];if(n.empty?n.from<=s:n.from<s)return X.normalized(e.slice(),i);s=n.to}return new X(e,i)}static cursor(e,i=0,s,r){return Zs.create(e,e,(i==0?0:i<0?8:16)|(s==null?7:Math.min(6,s))|(r??16777215)<<6)}static range(e,i,s,r){let n=(s??16777215)<<6|(r==null?7:Math.min(6,r));return i<e?Zs.create(i,e,48|n):Zs.create(e,i,(i>e?8:0)|n)}static normalized(e,i=0){let s=e[i];e.sort((r,n)=>r.from-n.from),i=e.indexOf(s);for(let r=1;r<e.length;r++){let n=e[r],a=e[r-1];if(n.empty?n.from<=a.to:n.from<a.to){let o=a.from,l=Math.max(n.to,a.to);r<=i&&i--,e.splice(--r,2,n.anchor>n.head?X.range(l,o):X.range(o,l))}}return new X(e,i)}}function pm(t,e){for(let i of t.ranges)if(i.to>e)throw new RangeError("Selection points outside of document")}let fd=0;class se{constructor(e,i,s,r,n){this.combine=e,this.compareInput=i,this.compare=s,this.isStatic=r,this.id=fd++,this.default=e([]),this.extensions=typeof n=="function"?n(this):n}get reader(){return this}static define(e={}){return new se(e.combine||(i=>i),e.compareInput||((i,s)=>i===s),e.compare||(e.combine?(i,s)=>i===s:gd),!!e.static,e.enables)}of(e){return new vo([],this,0,e)}compute(e,i){if(this.isStatic)throw new Error("Can't compute a static facet");return new vo(e,this,1,i)}computeN(e,i){if(this.isStatic)throw new Error("Can't compute a static facet");return new vo(e,this,2,i)}from(e,i){return i||(i=s=>s),this.compute([e],s=>i(s.field(e)))}}function gd(t,e){return t==e||t.length==e.length&&t.every((i,s)=>i===e[s])}class vo{constructor(e,i,s,r){this.dependencies=e,this.facet=i,this.type=s,this.value=r,this.id=fd++}dynamicSlot(e){var i;let s=this.value,r=this.facet.compareInput,n=this.id,a=e[n]>>1,o=this.type==2,l=!1,c=!1,h=[];for(let d of this.dependencies)d=="doc"?l=!0:d=="selection"?c=!0:((i=e[d.id])!==null&&i!==void 0?i:1)&1||h.push(e[d.id]);return{create(d){return d.values[a]=s(d),1},update(d,u){if(l&&u.docChanged||c&&(u.docChanged||u.selection)||ih(d,h)){let p=s(d);if(o?!pp(p,d.values[a],r):!r(p,d.values[a]))return d.values[a]=p,1}return 0},reconfigure:(d,u)=>{let p,f=u.config.address[n];if(f!=null){let g=Ao(u,f);if(this.dependencies.every(m=>m instanceof se?u.facet(m)===d.facet(m):m instanceof Mt?u.field(m,!1)==d.field(m,!1):!0)||(o?pp(p=s(d),g,r):r(p=s(d),g)))return d.values[a]=g,0}else p=s(d);return d.values[a]=p,1}}}}function pp(t,e,i){if(t.length!=e.length)return!1;for(let s=0;s<t.length;s++)if(!i(t[s],e[s]))return!1;return!0}function ih(t,e){let i=!1;for(let s of e)Vn(t,s)&1&&(i=!0);return i}function P1(t,e,i){let s=i.map(l=>t[l.id]),r=i.map(l=>l.type),n=s.filter(l=>!(l&1)),a=t[e.id]>>1;function o(l){let c=[];for(let h=0;h<s.length;h++){let d=Ao(l,s[h]);if(r[h]==2)for(let u of d)c.push(u);else c.push(d)}return e.combine(c)}return{create(l){for(let c of s)Vn(l,c);return l.values[a]=o(l),1},update(l,c){if(!ih(l,n))return 0;let h=o(l);return e.compare(h,l.values[a])?0:(l.values[a]=h,1)},reconfigure(l,c){let h=ih(l,s),d=c.config.facets[e.id],u=c.facet(e);if(d&&!h&&gd(i,d))return l.values[a]=u,0;let p=o(l);return e.compare(p,u)?(l.values[a]=u,0):(l.values[a]=p,1)}}}const Za=se.define({static:!0});class Mt{constructor(e,i,s,r,n){this.id=e,this.createF=i,this.updateF=s,this.compareF=r,this.spec=n,this.provides=void 0}static define(e){let i=new Mt(fd++,e.create,e.update,e.compare||((s,r)=>s===r),e);return e.provide&&(i.provides=e.provide(i)),i}create(e){let i=e.facet(Za).find(s=>s.field==this);return((i==null?void 0:i.create)||this.createF)(e)}slot(e){let i=e[this.id]>>1;return{create:s=>(s.values[i]=this.create(s),1),update:(s,r)=>{let n=s.values[i],a=this.updateF(n,r);return this.compareF(n,a)?0:(s.values[i]=a,1)},reconfigure:(s,r)=>{let n=s.facet(Za),a=r.facet(Za),o;return(o=n.find(l=>l.field==this))&&o!=a.find(l=>l.field==this)?(s.values[i]=o.create(s),1):r.config.address[this.id]!=null?(s.values[i]=r.field(this),0):(s.values[i]=this.create(s),1)}}}init(e){return[this,Za.of({field:this,create:e})]}get extension(){return this}}const Xs={lowest:4,low:3,default:2,high:1,highest:0};function Tn(t){return e=>new fm(e,t)}const wa={highest:Tn(Xs.highest),high:Tn(Xs.high),default:Tn(Xs.default),low:Tn(Xs.low),lowest:Tn(Xs.lowest)};class fm{constructor(e,i){this.inner=e,this.prec=i}}class an{of(e){return new sh(this,e)}reconfigure(e){return an.reconfigure.of({compartment:this,extension:e})}get(e){return e.config.compartments.get(this)}}class sh{constructor(e,i){this.compartment=e,this.inner=i}}class Qo{constructor(e,i,s,r,n,a){for(this.base=e,this.compartments=i,this.dynamicSlots=s,this.address=r,this.staticValues=n,this.facets=a,this.statusTemplate=[];this.statusTemplate.length<s.length;)this.statusTemplate.push(0)}staticFacet(e){let i=this.address[e.id];return i==null?e.default:this.staticValues[i>>1]}static resolve(e,i,s){let r=[],n=Object.create(null),a=new Map;for(let u of C1(e,i,a))u instanceof Mt?r.push(u):(n[u.facet.id]||(n[u.facet.id]=[])).push(u);let o=Object.create(null),l=[],c=[];for(let u of r)o[u.id]=c.length<<1,c.push(p=>u.slot(p));let h=s==null?void 0:s.config.facets;for(let u in n){let p=n[u],f=p[0].facet,g=h&&h[u]||[];if(p.every(m=>m.type==0))if(o[f.id]=l.length<<1|1,gd(g,p))l.push(s.facet(f));else{let m=f.combine(p.map(y=>y.value));l.push(s&&f.compare(m,s.facet(f))?s.facet(f):m)}else{for(let m of p)m.type==0?(o[m.id]=l.length<<1|1,l.push(m.value)):(o[m.id]=c.length<<1,c.push(y=>m.dynamicSlot(y)));o[f.id]=c.length<<1,c.push(m=>P1(m,f,p))}}let d=c.map(u=>u(o));return new Qo(e,a,d,o,l,n)}}function C1(t,e,i){let s=[[],[],[],[],[]],r=new Map;function n(a,o){let l=r.get(a);if(l!=null){if(l<=o)return;let c=s[l].indexOf(a);c>-1&&s[l].splice(c,1),a instanceof sh&&i.delete(a.compartment)}if(r.set(a,o),Array.isArray(a))for(let c of a)n(c,o);else if(a instanceof sh){if(i.has(a.compartment))throw new RangeError("Duplicate use of compartment in extensions");let c=e.get(a.compartment)||a.inner;i.set(a.compartment,c),n(c,o)}else if(a instanceof fm)n(a.inner,a.prec);else if(a instanceof Mt)s[o].push(a),a.provides&&n(a.provides,o);else if(a instanceof vo)s[o].push(a),a.facet.extensions&&n(a.facet.extensions,Xs.default);else{let c=a.extension;if(!c)throw new Error(`Unrecognized extension value in extension set (${a}). This sometimes happens because multiple instances of @codemirror/state are loaded, breaking instanceof checks.`);n(c,o)}}return n(t,Xs.default),s.reduce((a,o)=>a.concat(o))}function Vn(t,e){if(e&1)return 2;let i=e>>1,s=t.status[i];if(s==4)throw new Error("Cyclic dependency between fields and/or facets");if(s&2)return s;t.status[i]=4;let r=t.computeSlot(t,t.config.dynamicSlots[i]);return t.status[i]=2|r}function Ao(t,e){return e&1?t.config.staticValues[e>>1]:t.values[e>>1]}const gm=se.define(),rh=se.define({combine:t=>t.some(e=>e),static:!0}),mm=se.define({combine:t=>t.length?t[0]:void 0,static:!0}),Om=se.define(),ym=se.define(),vm=se.define(),bm=se.define({combine:t=>t.length?t[0]:!1});class ns{constructor(e,i){this.type=e,this.value=i}static define(){return new _1}}class _1{of(e){return new ns(this,e)}}class R1{constructor(e){this.map=e}of(e){return new Ie(this,e)}}class Ie{constructor(e,i){this.type=e,this.value=i}map(e){let i=this.type.map(this.value,e);return i===void 0?void 0:i==this.value?this:new Ie(this.type,i)}is(e){return this.type==e}static define(e={}){return new R1(e.map||(i=>i))}static mapEffects(e,i){if(!e.length)return e;let s=[];for(let r of e){let n=r.map(i);n&&s.push(n)}return s}}Ie.reconfigure=Ie.define();Ie.appendConfig=Ie.define();class et{constructor(e,i,s,r,n,a){this.startState=e,this.changes=i,this.selection=s,this.effects=r,this.annotations=n,this.scrollIntoView=a,this._doc=null,this._state=null,s&&pm(s,i.newLength),n.some(o=>o.type==et.time)||(this.annotations=n.concat(et.time.of(Date.now())))}static create(e,i,s,r,n,a){return new et(e,i,s,r,n,a)}get newDoc(){return this._doc||(this._doc=this.changes.apply(this.startState.doc))}get newSelection(){return this.selection||this.startState.selection.map(this.changes)}get state(){return this._state||this.startState.applyTransaction(this),this._state}annotation(e){for(let i of this.annotations)if(i.type==e)return i.value}get docChanged(){return!this.changes.empty}get reconfigured(){return this.startState.config!=this.state.config}isUserEvent(e){let i=this.annotation(et.userEvent);return!!(i&&(i==e||i.length>e.length&&i.slice(0,e.length)==e&&i[e.length]=="."))}}et.time=ns.define();et.userEvent=ns.define();et.addToHistory=ns.define();et.remote=ns.define();function $1(t,e){let i=[];for(let s=0,r=0;;){let n,a;if(s<t.length&&(r==e.length||e[r]>=t[s]))n=t[s++],a=t[s++];else if(r<e.length)n=e[r++],a=e[r++];else return i;!i.length||i[i.length-1]<n?i.push(n,a):i[i.length-1]<a&&(i[i.length-1]=a)}}function wm(t,e,i){var s;let r,n,a;return i?(r=e.changes,n=rt.empty(e.changes.length),a=t.changes.compose(e.changes)):(r=e.changes.map(t.changes),n=t.changes.mapDesc(e.changes,!0),a=t.changes.compose(r)),{changes:a,selection:e.selection?e.selection.map(n):(s=t.selection)===null||s===void 0?void 0:s.map(r),effects:Ie.mapEffects(t.effects,r).concat(Ie.mapEffects(e.effects,n)),annotations:t.annotations.length?t.annotations.concat(e.annotations):e.annotations,scrollIntoView:t.scrollIntoView||e.scrollIntoView}}function nh(t,e,i){let s=e.selection,r=jr(e.annotations);return e.userEvent&&(r=r.concat(et.userEvent.of(e.userEvent))),{changes:e.changes instanceof rt?e.changes:rt.of(e.changes||[],i,t.facet(mm)),selection:s&&(s instanceof X?s:X.single(s.anchor,s.head)),effects:jr(e.effects),annotations:r,scrollIntoView:!!e.scrollIntoView}}function Sm(t,e,i){let s=nh(t,e.length?e[0]:{},t.doc.length);e.length&&e[0].filter===!1&&(i=!1);for(let n=1;n<e.length;n++){e[n].filter===!1&&(i=!1);let a=!!e[n].sequential;s=wm(s,nh(t,e[n],a?s.changes.newLength:t.doc.length),a)}let r=et.create(t,s.changes,s.selection,s.effects,s.annotations,s.scrollIntoView);return Q1(i?I1(r):r)}function I1(t){let e=t.startState,i=!0;for(let r of e.facet(Om)){let n=r(t);if(n===!1){i=!1;break}Array.isArray(n)&&(i=i===!0?n:$1(i,n))}if(i!==!0){let r,n;if(i===!1)n=t.changes.invertedDesc,r=rt.empty(e.doc.length);else{let a=t.changes.filter(i);r=a.changes,n=a.filtered.mapDesc(a.changes).invertedDesc}t=et.create(e,r,t.selection&&t.selection.map(n),Ie.mapEffects(t.effects,n),t.annotations,t.scrollIntoView)}let s=e.facet(ym);for(let r=s.length-1;r>=0;r--){let n=s[r](t);n instanceof et?t=n:Array.isArray(n)&&n.length==1&&n[0]instanceof et?t=n[0]:t=Sm(e,jr(n),!1)}return t}function Q1(t){let e=t.startState,i=e.facet(vm),s=t;for(let r=i.length-1;r>=0;r--){let n=i[r](t);n&&Object.keys(n).length&&(s=wm(s,nh(e,n,t.changes.newLength),!0))}return s==t?t:et.create(e,t.changes,t.selection,s.effects,s.annotations,s.scrollIntoView)}const A1=[];function jr(t){return t==null?A1:Array.isArray(t)?t:[t]}var Ki=function(t){return t[t.Word=0]="Word",t[t.Space=1]="Space",t[t.Other=2]="Other",t}(Ki||(Ki={}));const L1=/[\u00df\u0587\u0590-\u05f4\u0600-\u06ff\u3040-\u309f\u30a0-\u30ff\u3400-\u4db5\u4e00-\u9fcc\uac00-\ud7af]/;let ah;try{ah=new RegExp("[\\p{Alphabetic}\\p{Number}_]","u")}catch{}function N1(t){if(ah)return ah.test(t);for(let e=0;e<t.length;e++){let i=t[e];if(/\w/.test(i)||i>"Â€"&&(i.toUpperCase()!=i.toLowerCase()||L1.test(i)))return!0}return!1}function M1(t){return e=>{if(!/\S/.test(e))return Ki.Space;if(N1(e))return Ki.Word;for(let i=0;i<t.length;i++)if(e.indexOf(t[i])>-1)return Ki.Word;return Ki.Other}}class Pe{constructor(e,i,s,r,n,a){this.config=e,this.doc=i,this.selection=s,this.values=r,this.status=e.statusTemplate.slice(),this.computeSlot=n,a&&(a._state=this);for(let o=0;o<this.config.dynamicSlots.length;o++)Vn(this,o<<1);this.computeSlot=null}field(e,i=!0){let s=this.config.address[e.id];if(s==null){if(i)throw new RangeError("Field is not present in this state");return}return Vn(this,s),Ao(this,s)}update(...e){return Sm(this,e,!0)}applyTransaction(e){let i=this.config,{base:s,compartments:r}=i;for(let o of e.effects)o.is(an.reconfigure)?(i&&(r=new Map,i.compartments.forEach((l,c)=>r.set(c,l)),i=null),r.set(o.value.compartment,o.value.extension)):o.is(Ie.reconfigure)?(i=null,s=o.value):o.is(Ie.appendConfig)&&(i=null,s=jr(s).concat(o.value));let n;i?n=e.startState.values.slice():(i=Qo.resolve(s,r,this),n=new Pe(i,this.doc,this.selection,i.dynamicSlots.map(()=>null),(l,c)=>c.reconfigure(l,this),null).values);let a=e.startState.facet(rh)?e.newSelection:e.newSelection.asSingle();new Pe(i,e.newDoc,a,n,(o,l)=>l.update(o,e),e)}replaceSelection(e){return typeof e=="string"&&(e=this.toText(e)),this.changeByRange(i=>({changes:{from:i.from,to:i.to,insert:e},range:X.cursor(i.from+e.length)}))}changeByRange(e){let i=this.selection,s=e(i.ranges[0]),r=this.changes(s.changes),n=[s.range],a=jr(s.effects);for(let o=1;o<i.ranges.length;o++){let l=e(i.ranges[o]),c=this.changes(l.changes),h=c.map(r);for(let u=0;u<o;u++)n[u]=n[u].map(h);let d=r.mapDesc(c,!0);n.push(l.range.map(d)),r=r.compose(h),a=Ie.mapEffects(a,h).concat(Ie.mapEffects(jr(l.effects),d))}return{changes:r,selection:X.create(n,i.mainIndex),effects:a}}changes(e=[]){return e instanceof rt?e:rt.of(e,this.doc.length,this.facet(Pe.lineSeparator))}toText(e){return $e.of(e.split(this.facet(Pe.lineSeparator)||Jc))}sliceDoc(e=0,i=this.doc.length){return this.doc.sliceString(e,i,this.lineBreak)}facet(e){let i=this.config.address[e.id];return i==null?e.default:(Vn(this,i),Ao(this,i))}toJSON(e){let i={doc:this.sliceDoc(),selection:this.selection.toJSON()};if(e)for(let s in e){let r=e[s];r instanceof Mt&&this.config.address[r.id]!=null&&(i[s]=r.spec.toJSON(this.field(e[s]),this))}return i}static fromJSON(e,i={},s){if(!e||typeof e.doc!="string")throw new RangeError("Invalid JSON representation for EditorState");let r=[];if(s){for(let n in s)if(Object.prototype.hasOwnProperty.call(e,n)){let a=s[n],o=e[n];r.push(a.init(l=>a.spec.fromJSON(o,l)))}}return Pe.create({doc:e.doc,selection:X.fromJSON(e.selection),extensions:i.extensions?r.concat([i.extensions]):r})}static create(e={}){let i=Qo.resolve(e.extensions||[],new Map),s=e.doc instanceof $e?e.doc:$e.of((e.doc||"").split(i.staticFacet(Pe.lineSeparator)||Jc)),r=e.selection?e.selection instanceof X?e.selection:X.single(e.selection.anchor,e.selection.head):X.single(0);return pm(r,s.length),i.staticFacet(rh)||(r=r.asSingle()),new Pe(i,s,r,i.dynamicSlots.map(()=>null),(n,a)=>a.create(n),null)}get tabSize(){return this.facet(Pe.tabSize)}get lineBreak(){return this.facet(Pe.lineSeparator)||`
`}get readOnly(){return this.facet(bm)}phrase(e,...i){for(let s of this.facet(Pe.phrases))if(Object.prototype.hasOwnProperty.call(s,e)){e=s[e];break}return i.length&&(e=e.replace(/\$(\$|\d*)/g,(s,r)=>{if(r=="$")return"$";let n=+(r||1);return!n||n>i.length?s:i[n-1]})),e}languageDataAt(e,i,s=-1){let r=[];for(let n of this.facet(gm))for(let a of n(this,i,s))Object.prototype.hasOwnProperty.call(a,e)&&r.push(a[e]);return r}charCategorizer(e){let i=this.languageDataAt("wordChars",e);return M1(i.length?i[0]:"")}wordAt(e){let{text:i,from:s,length:r}=this.doc.lineAt(e),n=this.charCategorizer(e),a=e-s,o=e-s;for(;a>0;){let l=Ot(i,a,!1);if(n(i.slice(l,a))!=Ki.Word)break;a=l}for(;o<r;){let l=Ot(i,o);if(n(i.slice(o,l))!=Ki.Word)break;o=l}return a==o?null:X.range(a+s,o+s)}}Pe.allowMultipleSelections=rh;Pe.tabSize=se.define({combine:t=>t.length?t[0]:4});Pe.lineSeparator=mm;Pe.readOnly=bm;Pe.phrases=se.define({compare(t,e){let i=Object.keys(t),s=Object.keys(e);return i.length==s.length&&i.every(r=>t[r]==e[r])}});Pe.languageData=gm;Pe.changeFilter=Om;Pe.transactionFilter=ym;Pe.transactionExtender=vm;an.reconfigure=Ie.define();function on(t,e,i={}){let s={};for(let r of t)for(let n of Object.keys(r)){let a=r[n],o=s[n];if(o===void 0)s[n]=a;else if(!(o===a||a===void 0))if(Object.hasOwnProperty.call(i,n))s[n]=i[n](o,a);else throw new Error("Config merge conflict for field "+n)}for(let r in e)s[r]===void 0&&(s[r]=e[r]);return s}class Ss{eq(e){return this==e}range(e,i=e){return oh.create(e,i,this)}}Ss.prototype.startSide=Ss.prototype.endSide=0;Ss.prototype.point=!1;Ss.prototype.mapMode=Ct.TrackDel;function md(t,e){return t==e||t.constructor==e.constructor&&t.eq(e)}let oh=class xm{constructor(e,i,s){this.from=e,this.to=i,this.value=s}static create(e,i,s){return new xm(e,i,s)}};function lh(t,e){return t.from-e.from||t.value.startSide-e.value.startSide}class Od{constructor(e,i,s,r){this.from=e,this.to=i,this.value=s,this.maxPoint=r}get length(){return this.to[this.to.length-1]}findIndex(e,i,s,r=0){let n=s?this.to:this.from;for(let a=r,o=n.length;;){if(a==o)return a;let l=a+o>>1,c=n[l]-e||(s?this.value[l].endSide:this.value[l].startSide)-i;if(l==a)return c>=0?a:o;c>=0?o=l:a=l+1}}between(e,i,s,r){for(let n=this.findIndex(i,-1e9,!0),a=this.findIndex(s,1e9,!1,n);n<a;n++)if(r(this.from[n]+e,this.to[n]+e,this.value[n])===!1)return!1}map(e,i){let s=[],r=[],n=[],a=-1,o=-1;for(let l=0;l<this.value.length;l++){let c=this.value[l],h=this.from[l]+e,d=this.to[l]+e,u,p;if(h==d){let f=i.mapPos(h,c.startSide,c.mapMode);if(f==null||(u=p=f,c.startSide!=c.endSide&&(p=i.mapPos(h,c.endSide),p<u)))continue}else if(u=i.mapPos(h,c.startSide),p=i.mapPos(d,c.endSide),u>p||u==p&&c.startSide>0&&c.endSide<=0)continue;(p-u||c.endSide-c.startSide)<0||(a<0&&(a=u),c.point&&(o=Math.max(o,p-u)),s.push(c),r.push(u-a),n.push(p-a))}return{mapped:s.length?new Od(r,n,s,o):null,pos:a}}}class Se{constructor(e,i,s,r){this.chunkPos=e,this.chunk=i,this.nextLayer=s,this.maxPoint=r}static create(e,i,s,r){return new Se(e,i,s,r)}get length(){let e=this.chunk.length-1;return e<0?0:Math.max(this.chunkEnd(e),this.nextLayer.length)}get size(){if(this.isEmpty)return 0;let e=this.nextLayer.size;for(let i of this.chunk)e+=i.value.length;return e}chunkEnd(e){return this.chunkPos[e]+this.chunk[e].length}update(e){let{add:i=[],sort:s=!1,filterFrom:r=0,filterTo:n=this.length}=e,a=e.filter;if(i.length==0&&!a)return this;if(s&&(i=i.slice().sort(lh)),this.isEmpty)return i.length?Se.of(i):this;let o=new km(this,null,-1).goto(0),l=0,c=[],h=new sr;for(;o.value||l<i.length;)if(l<i.length&&(o.from-i[l].from||o.startSide-i[l].value.startSide)>=0){let d=i[l++];h.addInner(d.from,d.to,d.value)||c.push(d)}else o.rangeIndex==1&&o.chunkIndex<this.chunk.length&&(l==i.length||this.chunkEnd(o.chunkIndex)<i[l].from)&&(!a||r>this.chunkEnd(o.chunkIndex)||n<this.chunkPos[o.chunkIndex])&&h.addChunk(this.chunkPos[o.chunkIndex],this.chunk[o.chunkIndex])?o.nextChunk():((!a||r>o.to||n<o.from||a(o.from,o.to,o.value))&&(h.addInner(o.from,o.to,o.value)||c.push(oh.create(o.from,o.to,o.value))),o.next());return h.finishInner(this.nextLayer.isEmpty&&!c.length?Se.empty:this.nextLayer.update({add:c,filter:a,filterFrom:r,filterTo:n}))}map(e){if(e.empty||this.isEmpty)return this;let i=[],s=[],r=-1;for(let a=0;a<this.chunk.length;a++){let o=this.chunkPos[a],l=this.chunk[a],c=e.touchesRange(o,o+l.length);if(c===!1)r=Math.max(r,l.maxPoint),i.push(l),s.push(e.mapPos(o));else if(c===!0){let{mapped:h,pos:d}=l.map(o,e);h&&(r=Math.max(r,h.maxPoint),i.push(h),s.push(d))}}let n=this.nextLayer.map(e);return i.length==0?n:new Se(s,i,n||Se.empty,r)}between(e,i,s){if(!this.isEmpty){for(let r=0;r<this.chunk.length;r++){let n=this.chunkPos[r],a=this.chunk[r];if(i>=n&&e<=n+a.length&&a.between(n,e-n,i-n,s)===!1)return}this.nextLayer.between(e,i,s)}}iter(e=0){return la.from([this]).goto(e)}get isEmpty(){return this.nextLayer==this}static iter(e,i=0){return la.from(e).goto(i)}static compare(e,i,s,r,n=-1){let a=e.filter(d=>d.maxPoint>0||!d.isEmpty&&d.maxPoint>=n),o=i.filter(d=>d.maxPoint>0||!d.isEmpty&&d.maxPoint>=n),l=fp(a,o,s),c=new En(a,l,n),h=new En(o,l,n);s.iterGaps((d,u,p)=>gp(c,d,h,u,p,r)),s.empty&&s.length==0&&gp(c,0,h,0,0,r)}static eq(e,i,s=0,r){r==null&&(r=999999999);let n=e.filter(h=>!h.isEmpty&&i.indexOf(h)<0),a=i.filter(h=>!h.isEmpty&&e.indexOf(h)<0);if(n.length!=a.length)return!1;if(!n.length)return!0;let o=fp(n,a),l=new En(n,o,0).goto(s),c=new En(a,o,0).goto(s);for(;;){if(l.to!=c.to||!ch(l.active,c.active)||l.point&&(!c.point||!md(l.point,c.point)))return!1;if(l.to>r)return!0;l.next(),c.next()}}static spans(e,i,s,r,n=-1){let a=new En(e,null,n).goto(i),o=i,l=a.openStart;for(;;){let c=Math.min(a.to,s);if(a.point){let h=a.activeForPoint(a.to),d=a.pointFrom<i?h.length+1:a.point.startSide<0?h.length:Math.min(h.length,l);r.point(o,c,a.point,h,d,a.pointRank),l=Math.min(a.openEnd(c),h.length)}else c>o&&(r.span(o,c,a.active,l),l=a.openEnd(c));if(a.to>s)return l+(a.point&&a.to>s?1:0);o=a.to,a.next()}}static of(e,i=!1){let s=new sr;for(let r of e instanceof oh?[e]:i?q1(e):e)s.add(r.from,r.to,r.value);return s.finish()}static join(e){if(!e.length)return Se.empty;let i=e[e.length-1];for(let s=e.length-2;s>=0;s--)for(let r=e[s];r!=Se.empty;r=r.nextLayer)i=new Se(r.chunkPos,r.chunk,i,Math.max(r.maxPoint,i.maxPoint));return i}}Se.empty=new Se([],[],null,-1);function q1(t){if(t.length>1)for(let e=t[0],i=1;i<t.length;i++){let s=t[i];if(lh(e,s)>0)return t.slice().sort(lh);e=s}return t}Se.empty.nextLayer=Se.empty;class sr{finishChunk(e){this.chunks.push(new Od(this.from,this.to,this.value,this.maxPoint)),this.chunkPos.push(this.chunkStart),this.chunkStart=-1,this.setMaxPoint=Math.max(this.setMaxPoint,this.maxPoint),this.maxPoint=-1,e&&(this.from=[],this.to=[],this.value=[])}constructor(){this.chunks=[],this.chunkPos=[],this.chunkStart=-1,this.last=null,this.lastFrom=-1e9,this.lastTo=-1e9,this.from=[],this.to=[],this.value=[],this.maxPoint=-1,this.setMaxPoint=-1,this.nextLayer=null}add(e,i,s){this.addInner(e,i,s)||(this.nextLayer||(this.nextLayer=new sr)).add(e,i,s)}addInner(e,i,s){let r=e-this.lastTo||s.startSide-this.last.endSide;if(r<=0&&(e-this.lastFrom||s.startSide-this.last.startSide)<0)throw new Error("Ranges must be added sorted by `from` position and `startSide`");return r<0?!1:(this.from.length==250&&this.finishChunk(!0),this.chunkStart<0&&(this.chunkStart=e),this.from.push(e-this.chunkStart),this.to.push(i-this.chunkStart),this.last=s,this.lastFrom=e,this.lastTo=i,this.value.push(s),s.point&&(this.maxPoint=Math.max(this.maxPoint,i-e)),!0)}addChunk(e,i){if((e-this.lastTo||i.value[0].startSide-this.last.endSide)<0)return!1;this.from.length&&this.finishChunk(!0),this.setMaxPoint=Math.max(this.setMaxPoint,i.maxPoint),this.chunks.push(i),this.chunkPos.push(e);let s=i.value.length-1;return this.last=i.value[s],this.lastFrom=i.from[s]+e,this.lastTo=i.to[s]+e,!0}finish(){return this.finishInner(Se.empty)}finishInner(e){if(this.from.length&&this.finishChunk(!1),this.chunks.length==0)return e;let i=Se.create(this.chunkPos,this.chunks,this.nextLayer?this.nextLayer.finishInner(e):e,this.setMaxPoint);return this.from=null,i}}function fp(t,e,i){let s=new Map;for(let n of t)for(let a=0;a<n.chunk.length;a++)n.chunk[a].maxPoint<=0&&s.set(n.chunk[a],n.chunkPos[a]);let r=new Set;for(let n of e)for(let a=0;a<n.chunk.length;a++){let o=s.get(n.chunk[a]);o!=null&&(i?i.mapPos(o):o)==n.chunkPos[a]&&!(i!=null&&i.touchesRange(o,o+n.chunk[a].length))&&r.add(n.chunk[a])}return r}class km{constructor(e,i,s,r=0){this.layer=e,this.skip=i,this.minPoint=s,this.rank=r}get startSide(){return this.value?this.value.startSide:0}get endSide(){return this.value?this.value.endSide:0}goto(e,i=-1e9){return this.chunkIndex=this.rangeIndex=0,this.gotoInner(e,i,!1),this}gotoInner(e,i,s){for(;this.chunkIndex<this.layer.chunk.length;){let r=this.layer.chunk[this.chunkIndex];if(!(this.skip&&this.skip.has(r)||this.layer.chunkEnd(this.chunkIndex)<e||r.maxPoint<this.minPoint))break;this.chunkIndex++,s=!1}if(this.chunkIndex<this.layer.chunk.length){let r=this.layer.chunk[this.chunkIndex].findIndex(e-this.layer.chunkPos[this.chunkIndex],i,!0);(!s||this.rangeIndex<r)&&this.setRangeIndex(r)}this.next()}forward(e,i){(this.to-e||this.endSide-i)<0&&this.gotoInner(e,i,!0)}next(){for(;;)if(this.chunkIndex==this.layer.chunk.length){this.from=this.to=1e9,this.value=null;break}else{let e=this.layer.chunkPos[this.chunkIndex],i=this.layer.chunk[this.chunkIndex],s=e+i.from[this.rangeIndex];if(this.from=s,this.to=e+i.to[this.rangeIndex],this.value=i.value[this.rangeIndex],this.setRangeIndex(this.rangeIndex+1),this.minPoint<0||this.value.point&&this.to-this.from>=this.minPoint)break}}setRangeIndex(e){if(e==this.layer.chunk[this.chunkIndex].value.length){if(this.chunkIndex++,this.skip)for(;this.chunkIndex<this.layer.chunk.length&&this.skip.has(this.layer.chunk[this.chunkIndex]);)this.chunkIndex++;this.rangeIndex=0}else this.rangeIndex=e}nextChunk(){this.chunkIndex++,this.rangeIndex=0,this.next()}compare(e){return this.from-e.from||this.startSide-e.startSide||this.rank-e.rank||this.to-e.to||this.endSide-e.endSide}}class la{constructor(e){this.heap=e}static from(e,i=null,s=-1){let r=[];for(let n=0;n<e.length;n++)for(let a=e[n];!a.isEmpty;a=a.nextLayer)a.maxPoint>=s&&r.push(new km(a,i,s,n));return r.length==1?r[0]:new la(r)}get startSide(){return this.value?this.value.startSide:0}goto(e,i=-1e9){for(let s of this.heap)s.goto(e,i);for(let s=this.heap.length>>1;s>=0;s--)ac(this.heap,s);return this.next(),this}forward(e,i){for(let s of this.heap)s.forward(e,i);for(let s=this.heap.length>>1;s>=0;s--)ac(this.heap,s);(this.to-e||this.value.endSide-i)<0&&this.next()}next(){if(this.heap.length==0)this.from=this.to=1e9,this.value=null,this.rank=-1;else{let e=this.heap[0];this.from=e.from,this.to=e.to,this.value=e.value,this.rank=e.rank,e.value&&e.next(),ac(this.heap,0)}}}function ac(t,e){for(let i=t[e];;){let s=(e<<1)+1;if(s>=t.length)break;let r=t[s];if(s+1<t.length&&r.compare(t[s+1])>=0&&(r=t[s+1],s++),i.compare(r)<0)break;t[s]=i,t[e]=r,e=s}}class En{constructor(e,i,s){this.minPoint=s,this.active=[],this.activeTo=[],this.activeRank=[],this.minActive=-1,this.point=null,this.pointFrom=0,this.pointRank=0,this.to=-1e9,this.endSide=0,this.openStart=-1,this.cursor=la.from(e,i,s)}goto(e,i=-1e9){return this.cursor.goto(e,i),this.active.length=this.activeTo.length=this.activeRank.length=0,this.minActive=-1,this.to=e,this.endSide=i,this.openStart=-1,this.next(),this}forward(e,i){for(;this.minActive>-1&&(this.activeTo[this.minActive]-e||this.active[this.minActive].endSide-i)<0;)this.removeActive(this.minActive);this.cursor.forward(e,i)}removeActive(e){Ha(this.active,e),Ha(this.activeTo,e),Ha(this.activeRank,e),this.minActive=mp(this.active,this.activeTo)}addActive(e){let i=0,{value:s,to:r,rank:n}=this.cursor;for(;i<this.activeRank.length&&(n-this.activeRank[i]||r-this.activeTo[i])>0;)i++;Ka(this.active,i,s),Ka(this.activeTo,i,r),Ka(this.activeRank,i,n),e&&Ka(e,i,this.cursor.from),this.minActive=mp(this.active,this.activeTo)}next(){let e=this.to,i=this.point;this.point=null;let s=this.openStart<0?[]:null;for(;;){let r=this.minActive;if(r>-1&&(this.activeTo[r]-this.cursor.from||this.active[r].endSide-this.cursor.startSide)<0){if(this.activeTo[r]>e){this.to=this.activeTo[r],this.endSide=this.active[r].endSide;break}this.removeActive(r),s&&Ha(s,r)}else if(this.cursor.value)if(this.cursor.from>e){this.to=this.cursor.from,this.endSide=this.cursor.startSide;break}else{let n=this.cursor.value;if(!n.point)this.addActive(s),this.cursor.next();else if(i&&this.cursor.to==this.to&&this.cursor.from<this.cursor.to)this.cursor.next();else{this.point=n,this.pointFrom=this.cursor.from,this.pointRank=this.cursor.rank,this.to=this.cursor.to,this.endSide=n.endSide,this.cursor.next(),this.forward(this.to,this.endSide);break}}else{this.to=this.endSide=1e9;break}}if(s){this.openStart=0;for(let r=s.length-1;r>=0&&s[r]<e;r--)this.openStart++}}activeForPoint(e){if(!this.active.length)return this.active;let i=[];for(let s=this.active.length-1;s>=0&&!(this.activeRank[s]<this.pointRank);s--)(this.activeTo[s]>e||this.activeTo[s]==e&&this.active[s].endSide>=this.point.endSide)&&i.push(this.active[s]);return i.reverse()}openEnd(e){let i=0;for(let s=this.activeTo.length-1;s>=0&&this.activeTo[s]>e;s--)i++;return i}}function gp(t,e,i,s,r,n){t.goto(e),i.goto(s);let a=s+r,o=s,l=s-e,c=!!n.boundChange;for(let h=!1;;){let d=t.to+l-i.to,u=d||t.endSide-i.endSide,p=u<0?t.to+l:i.to,f=Math.min(p,a);if(t.point||i.point?(t.point&&i.point&&md(t.point,i.point)&&ch(t.activeForPoint(t.to),i.activeForPoint(i.to))||n.comparePoint(o,f,t.point,i.point),h=!1):(h&&n.boundChange(o),f>o&&!ch(t.active,i.active)&&n.compareRange(o,f,t.active,i.active),c&&f<a&&(d||t.openEnd(p)!=i.openEnd(p))&&(h=!0)),p>a)break;o=p,u<=0&&t.next(),u>=0&&i.next()}}function ch(t,e){if(t.length!=e.length)return!1;for(let i=0;i<t.length;i++)if(t[i]!=e[i]&&!md(t[i],e[i]))return!1;return!0}function Ha(t,e){for(let i=e,s=t.length-1;i<s;i++)t[i]=t[i+1];t.pop()}function Ka(t,e,i){for(let s=t.length-1;s>=e;s--)t[s+1]=t[s];t[e]=i}function mp(t,e){let i=-1,s=1e9;for(let r=0;r<e.length;r++)(e[r]-s||t[r].endSide-t[i].endSide)<0&&(i=r,s=e[r]);return i}function ln(t,e,i=t.length){let s=0;for(let r=0;r<i&&r<t.length;)t.charCodeAt(r)==9?(s+=e-s%e,r++):(s++,r=Ot(t,r));return s}function hh(t,e,i,s){for(let r=0,n=0;;){if(n>=e)return r;if(r==t.length)break;n+=t.charCodeAt(r)==9?i-n%i:1,r=Ot(t,r)}return s===!0?-1:t.length}const dh="Í¼",Op=typeof Symbol>"u"?"__"+dh:Symbol.for(dh),uh=typeof Symbol>"u"?"__styleSet"+Math.floor(Math.random()*1e8):Symbol("styleSet"),yp=typeof globalThis<"u"?globalThis:typeof window<"u"?window:{};class xs{constructor(e,i){this.rules=[];let{finish:s}=i||{};function r(a){return/^@/.test(a)?[a]:a.split(/,\s*/)}function n(a,o,l,c){let h=[],d=/^@(\w+)\b/.exec(a[0]),u=d&&d[1]=="keyframes";if(d&&o==null)return l.push(a[0]+";");for(let p in o){let f=o[p];if(/&/.test(p))n(p.split(/,\s*/).map(g=>a.map(m=>g.replace(/&/,m))).reduce((g,m)=>g.concat(m)),f,l);else if(f&&typeof f=="object"){if(!d)throw new RangeError("The value of a property ("+p+") should be a primitive value.");n(r(p),f,h,u)}else f!=null&&h.push(p.replace(/_.*/,"").replace(/[A-Z]/g,g=>"-"+g.toLowerCase())+": "+f+";")}(h.length||u)&&l.push((s&&!d&&!c?a.map(s):a).join(", ")+" {"+h.join(" ")+"}")}for(let a in e)n(r(a),e[a],this.rules)}getRules(){return this.rules.join(`
`)}static newName(){let e=yp[Op]||1;return yp[Op]=e+1,dh+e.toString(36)}static mount(e,i,s){let r=e[uh],n=s&&s.nonce;r?n&&r.setNonce(n):r=new D1(e,n),r.mount(Array.isArray(i)?i:[i],e)}}let vp=new Map;class D1{constructor(e,i){let s=e.ownerDocument||e,r=s.defaultView;if(!e.head&&e.adoptedStyleSheets&&r.CSSStyleSheet){let n=vp.get(s);if(n)return e[uh]=n;this.sheet=new r.CSSStyleSheet,vp.set(s,this)}else this.styleTag=s.createElement("style"),i&&this.styleTag.setAttribute("nonce",i);this.modules=[],e[uh]=this}mount(e,i){let s=this.sheet,r=0,n=0;for(let a=0;a<e.length;a++){let o=e[a],l=this.modules.indexOf(o);if(l<n&&l>-1&&(this.modules.splice(l,1),n--,l=-1),l==-1){if(this.modules.splice(n++,0,o),s)for(let c=0;c<o.rules.length;c++)s.insertRule(o.rules[c],r++)}else{for(;n<l;)r+=this.modules[n++].rules.length;r+=o.rules.length,n++}}if(s)i.adoptedStyleSheets.indexOf(this.sheet)<0&&(i.adoptedStyleSheets=[this.sheet,...i.adoptedStyleSheets]);else{let a="";for(let l=0;l<this.modules.length;l++)a+=this.modules[l].getRules()+`
`;this.styleTag.textContent=a;let o=i.head||i;this.styleTag.parentNode!=o&&o.insertBefore(this.styleTag,o.firstChild)}}setNonce(e){this.styleTag&&this.styleTag.getAttribute("nonce")!=e&&this.styleTag.setAttribute("nonce",e)}}var ks={8:"Backspace",9:"Tab",10:"Enter",12:"NumLock",13:"Enter",16:"Shift",17:"Control",18:"Alt",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",44:"PrintScreen",45:"Insert",46:"Delete",59:";",61:"=",91:"Meta",92:"Meta",106:"*",107:"+",108:",",109:"-",110:".",111:"/",144:"NumLock",145:"ScrollLock",160:"Shift",161:"Shift",162:"Control",163:"Control",164:"Alt",165:"Alt",173:"-",186:";",187:"=",188:",",189:"-",190:".",191:"/",192:"`",219:"[",220:"\\",221:"]",222:"'"},ca={48:")",49:"!",50:"@",51:"#",52:"$",53:"%",54:"^",55:"&",56:"*",57:"(",59:":",61:"+",173:"_",186:":",187:"+",188:"<",189:"_",190:">",191:"?",192:"~",219:"{",220:"|",221:"}",222:'"'},B1=typeof navigator<"u"&&/Mac/.test(navigator.platform),j1=typeof navigator<"u"&&/MSIE \d|Trident\/(?:[7-9]|\d{2,})\..*rv:(\d+)/.exec(navigator.userAgent);for(var mt=0;mt<10;mt++)ks[48+mt]=ks[96+mt]=String(mt);for(var mt=1;mt<=24;mt++)ks[mt+111]="F"+mt;for(var mt=65;mt<=90;mt++)ks[mt]=String.fromCharCode(mt+32),ca[mt]=String.fromCharCode(mt);for(var oc in ks)ca.hasOwnProperty(oc)||(ca[oc]=ks[oc]);function W1(t){var e=B1&&t.metaKey&&t.shiftKey&&!t.ctrlKey&&!t.altKey||j1&&t.shiftKey&&t.key&&t.key.length==1||t.key=="Unidentified",i=!e&&t.key||(t.shiftKey?ca:ks)[t.keyCode]||t.key||"Unidentified";return i=="Esc"&&(i="Escape"),i=="Del"&&(i="Delete"),i=="Left"&&(i="ArrowLeft"),i=="Up"&&(i="ArrowUp"),i=="Right"&&(i="ArrowRight"),i=="Down"&&(i="ArrowDown"),i}let Pt=typeof navigator<"u"?navigator:{userAgent:"",vendor:"",platform:""},ph=typeof document<"u"?document:{documentElement:{style:{}}};const fh=/Edge\/(\d+)/.exec(Pt.userAgent),Tm=/MSIE \d/.test(Pt.userAgent),gh=/Trident\/(?:[7-9]|\d{2,})\..*rv:(\d+)/.exec(Pt.userAgent),ul=!!(Tm||gh||fh),bp=!ul&&/gecko\/(\d+)/i.test(Pt.userAgent),lc=!ul&&/Chrome\/(\d+)/.exec(Pt.userAgent),F1="webkitFontSmoothing"in ph.documentElement.style,mh=!ul&&/Apple Computer/.test(Pt.vendor),wp=mh&&(/Mobile\/\w+/.test(Pt.userAgent)||Pt.maxTouchPoints>2);var K={mac:wp||/Mac/.test(Pt.platform),windows:/Win/.test(Pt.platform),linux:/Linux|X11/.test(Pt.platform),ie:ul,ie_version:Tm?ph.documentMode||6:gh?+gh[1]:fh?+fh[1]:0,gecko:bp,gecko_version:bp?+(/Firefox\/(\d+)/.exec(Pt.userAgent)||[0,0])[1]:0,chrome:!!lc,chrome_version:lc?+lc[1]:0,ios:wp,android:/Android\b/.test(Pt.userAgent),webkit_version:F1?+(/\bAppleWebKit\/(\d+)/.exec(Pt.userAgent)||[0,0])[1]:0,safari:mh,safari_version:mh?+(/\bVersion\/(\d+(\.\d+)?)/.exec(Pt.userAgent)||[0,0])[1]:0,tabSize:ph.documentElement.style.tabSize!=null?"tab-size":"-moz-tab-size"};function yd(t,e){for(let i in t)i=="class"&&e.class?e.class+=" "+t.class:i=="style"&&e.style?e.style+=";"+t.style:e[i]=t[i];return e}const Lo=Object.create(null);function vd(t,e,i){if(t==e)return!0;t||(t=Lo),e||(e=Lo);let s=Object.keys(t),r=Object.keys(e);if(s.length-0!=r.length-0)return!1;for(let n of s)if(n!=i&&(r.indexOf(n)==-1||t[n]!==e[n]))return!1;return!0}function U1(t,e){for(let i=t.attributes.length-1;i>=0;i--){let s=t.attributes[i].name;e[s]==null&&t.removeAttribute(s)}for(let i in e){let s=e[i];i=="style"?t.style.cssText=s:t.getAttribute(i)!=s&&t.setAttribute(i,s)}}function Sp(t,e,i){let s=!1;if(e)for(let r in e)i&&r in i||(s=!0,r=="style"?t.style.cssText="":t.removeAttribute(r));if(i)for(let r in i)e&&e[r]==i[r]||(s=!0,r=="style"?t.style.cssText=i[r]:t.setAttribute(r,i[r]));return s}function V1(t){let e=Object.create(null);for(let i=0;i<t.attributes.length;i++){let s=t.attributes[i];e[s.name]=s.value}return e}class gi{eq(e){return!1}updateDOM(e,i){return!1}compare(e){return this==e||this.constructor==e.constructor&&this.eq(e)}get estimatedHeight(){return-1}get lineBreaks(){return 0}ignoreEvent(e){return!0}coordsAt(e,i,s){return null}get isHidden(){return!1}get editable(){return!1}destroy(e){}}var yt=function(t){return t[t.Text=0]="Text",t[t.WidgetBefore=1]="WidgetBefore",t[t.WidgetAfter=2]="WidgetAfter",t[t.WidgetRange=3]="WidgetRange",t}(yt||(yt={}));class fe extends Ss{constructor(e,i,s,r){super(),this.startSide=e,this.endSide=i,this.widget=s,this.spec=r}get heightRelevant(){return!1}static mark(e){return new Sa(e)}static widget(e){let i=Math.max(-1e4,Math.min(1e4,e.side||0)),s=!!e.block;return i+=s&&!e.inlineOrder?i>0?3e8:-4e8:i>0?1e8:-1e8,new rr(e,i,i,s,e.widget||null,!1)}static replace(e){let i=!!e.block,s,r;if(e.isBlockGap)s=-5e8,r=4e8;else{let{start:n,end:a}=Em(e,i);s=(n?i?-3e8:-1:5e8)-1,r=(a?i?2e8:1:-6e8)+1}return new rr(e,s,r,i,e.widget||null,!0)}static line(e){return new xa(e)}static set(e,i=!1){return Se.of(e,i)}hasHeight(){return this.widget?this.widget.estimatedHeight>-1:!1}}fe.none=Se.empty;class Sa extends fe{constructor(e){let{start:i,end:s}=Em(e);super(i?-1:5e8,s?1:-6e8,null,e),this.tagName=e.tagName||"span",this.attrs=e.class&&e.attributes?yd(e.attributes,{class:e.class}):e.class?{class:e.class}:e.attributes||Lo}eq(e){return this==e||e instanceof Sa&&this.tagName==e.tagName&&vd(this.attrs,e.attrs)}range(e,i=e){if(e>=i)throw new RangeError("Mark decorations may not be empty");return super.range(e,i)}}Sa.prototype.point=!1;class xa extends fe{constructor(e){super(-2e8,-2e8,null,e)}eq(e){return e instanceof xa&&this.spec.class==e.spec.class&&vd(this.spec.attributes,e.spec.attributes)}range(e,i=e){if(i!=e)throw new RangeError("Line decoration ranges must be zero-length");return super.range(e,i)}}xa.prototype.mapMode=Ct.TrackBefore;xa.prototype.point=!0;class rr extends fe{constructor(e,i,s,r,n,a){super(i,s,n,e),this.block=r,this.isReplace=a,this.mapMode=r?i<=0?Ct.TrackBefore:Ct.TrackAfter:Ct.TrackDel}get type(){return this.startSide!=this.endSide?yt.WidgetRange:this.startSide<=0?yt.WidgetBefore:yt.WidgetAfter}get heightRelevant(){return this.block||!!this.widget&&(this.widget.estimatedHeight>=5||this.widget.lineBreaks>0)}eq(e){return e instanceof rr&&z1(this.widget,e.widget)&&this.block==e.block&&this.startSide==e.startSide&&this.endSide==e.endSide}range(e,i=e){if(this.isReplace&&(e>i||e==i&&this.startSide>0&&this.endSide<=0))throw new RangeError("Invalid range for replacement decoration");if(!this.isReplace&&i!=e)throw new RangeError("Widget decorations can only have zero-length ranges");return super.range(e,i)}}rr.prototype.point=!0;function Em(t,e=!1){let{inclusiveStart:i,inclusiveEnd:s}=t;return i==null&&(i=t.inclusive),s==null&&(s=t.inclusive),{start:i??e,end:s??e}}function z1(t,e){return t==e||!!(t&&e&&t.compare(e))}function Wr(t,e,i,s=0){let r=i.length-1;r>=0&&i[r]+s>=t?i[r]=Math.max(i[r],e):i.push(t,e)}class ha extends Ss{constructor(e,i){super(),this.tagName=e,this.attributes=i}eq(e){return e==this||e instanceof ha&&this.tagName==e.tagName&&vd(this.attributes,e.attributes)}static create(e){return new ha(e.tagName,e.attributes||Lo)}static set(e,i=!1){return Se.of(e,i)}}ha.prototype.startSide=ha.prototype.endSide=-1;function Yr(t){let e;return t.nodeType==11?e=t.getSelection?t:t.ownerDocument:e=t,e.getSelection()}function Oh(t,e){return e?t==e||t.contains(e.nodeType!=1?e.parentNode:e):!1}function zn(t,e){if(!e.anchorNode)return!1;try{return Oh(t,e.anchorNode)}catch{return!1}}function bo(t){return t.nodeType==3?da(t,0,t.nodeValue.length).getClientRects():t.nodeType==1?t.getClientRects():[]}function Xn(t,e,i,s){return i?xp(t,e,i,s,-1)||xp(t,e,i,s,1):!1}function Ts(t){for(var e=0;;e++)if(t=t.previousSibling,!t)return e}function No(t){return t.nodeType==1&&/^(DIV|P|LI|UL|OL|BLOCKQUOTE|DD|DT|H\d|SECTION|PRE)$/.test(t.nodeName)}function xp(t,e,i,s,r){for(;;){if(t==i&&e==s)return!0;if(e==(r<0?0:es(t))){if(t.nodeName=="DIV")return!1;let n=t.parentNode;if(!n||n.nodeType!=1)return!1;e=Ts(t)+(r<0?0:1),t=n}else if(t.nodeType==1){if(t=t.childNodes[e+(r<0?-1:0)],t.nodeType==1&&t.contentEditable=="false")return!1;e=r<0?es(t):0}else return!1}}function es(t){return t.nodeType==3?t.nodeValue.length:t.childNodes.length}function Mo(t,e){let i=e?t.left:t.right;return{left:i,right:i,top:t.top,bottom:t.bottom}}function X1(t){let e=t.visualViewport;return e?{left:0,right:e.width,top:0,bottom:e.height}:{left:0,right:t.innerWidth,top:0,bottom:t.innerHeight}}function Pm(t,e){let i=e.width/t.offsetWidth,s=e.height/t.offsetHeight;return(i>.995&&i<1.005||!isFinite(i)||Math.abs(e.width-t.offsetWidth)<1)&&(i=1),(s>.995&&s<1.005||!isFinite(s)||Math.abs(e.height-t.offsetHeight)<1)&&(s=1),{scaleX:i,scaleY:s}}function G1(t,e,i,s,r,n,a,o){let l=t.ownerDocument,c=l.defaultView||window;for(let h=t,d=!1;h&&!d;)if(h.nodeType==1){let u,p=h==l.body,f=1,g=1;if(p)u=X1(c);else{if(/^(fixed|sticky)$/.test(getComputedStyle(h).position)&&(d=!0),h.scrollHeight<=h.clientHeight&&h.scrollWidth<=h.clientWidth){h=h.assignedSlot||h.parentNode;continue}let b=h.getBoundingClientRect();({scaleX:f,scaleY:g}=Pm(h,b)),u={left:b.left,right:b.left+h.clientWidth*f,top:b.top,bottom:b.top+h.clientHeight*g}}let m=0,y=0;if(r=="nearest")e.top<u.top?(y=e.top-(u.top+a),i>0&&e.bottom>u.bottom+y&&(y=e.bottom-u.bottom+a)):e.bottom>u.bottom&&(y=e.bottom-u.bottom+a,i<0&&e.top-y<u.top&&(y=e.top-(u.top+a)));else{let b=e.bottom-e.top,w=u.bottom-u.top;y=(r=="center"&&b<=w?e.top+b/2-w/2:r=="start"||r=="center"&&i<0?e.top-a:e.bottom-w+a)-u.top}if(s=="nearest"?e.left<u.left?(m=e.left-(u.left+n),i>0&&e.right>u.right+m&&(m=e.right-u.right+n)):e.right>u.right&&(m=e.right-u.right+n,i<0&&e.left<u.left+m&&(m=e.left-(u.left+n))):m=(s=="center"?e.left+(e.right-e.left)/2-(u.right-u.left)/2:s=="start"==o?e.left-n:e.right-(u.right-u.left)+n)-u.left,m||y)if(p)c.scrollBy(m,y);else{let b=0,w=0;if(y){let k=h.scrollTop;h.scrollTop+=y/g,w=(h.scrollTop-k)*g}if(m){let k=h.scrollLeft;h.scrollLeft+=m/f,b=(h.scrollLeft-k)*f}e={left:e.left-b,top:e.top-w,right:e.right-b,bottom:e.bottom-w},b&&Math.abs(b-m)<1&&(s="nearest"),w&&Math.abs(w-y)<1&&(r="nearest")}if(p)break;(e.top<u.top||e.bottom>u.bottom||e.left<u.left||e.right>u.right)&&(e={left:Math.max(e.left,u.left),right:Math.min(e.right,u.right),top:Math.max(e.top,u.top),bottom:Math.min(e.bottom,u.bottom)}),h=h.assignedSlot||h.parentNode}else if(h.nodeType==11)h=h.host;else break}function Y1(t){let e=t.ownerDocument,i,s;for(let r=t.parentNode;r&&!(r==e.body||i&&s);)if(r.nodeType==1)!s&&r.scrollHeight>r.clientHeight&&(s=r),!i&&r.scrollWidth>r.clientWidth&&(i=r),r=r.assignedSlot||r.parentNode;else if(r.nodeType==11)r=r.host;else break;return{x:i,y:s}}class Z1{constructor(){this.anchorNode=null,this.anchorOffset=0,this.focusNode=null,this.focusOffset=0}eq(e){return this.anchorNode==e.anchorNode&&this.anchorOffset==e.anchorOffset&&this.focusNode==e.focusNode&&this.focusOffset==e.focusOffset}setRange(e){let{anchorNode:i,focusNode:s}=e;this.set(i,Math.min(e.anchorOffset,i?es(i):0),s,Math.min(e.focusOffset,s?es(s):0))}set(e,i,s,r){this.anchorNode=e,this.anchorOffset=i,this.focusNode=s,this.focusOffset=r}}let Bs=null;K.safari&&K.safari_version>=26&&(Bs=!1);function Cm(t){if(t.setActive)return t.setActive();if(Bs)return t.focus(Bs);let e=[];for(let i=t;i&&(e.push(i,i.scrollTop,i.scrollLeft),i!=i.ownerDocument);i=i.parentNode);if(t.focus(Bs==null?{get preventScroll(){return Bs={preventScroll:!0},!0}}:void 0),!Bs){Bs=!1;for(let i=0;i<e.length;){let s=e[i++],r=e[i++],n=e[i++];s.scrollTop!=r&&(s.scrollTop=r),s.scrollLeft!=n&&(s.scrollLeft=n)}}}let kp;function da(t,e,i=e){let s=kp||(kp=document.createRange());return s.setEnd(t,i),s.setStart(t,e),s}function Fr(t,e,i,s){let r={key:e,code:e,keyCode:i,which:i,cancelable:!0};s&&({altKey:r.altKey,ctrlKey:r.ctrlKey,shiftKey:r.shiftKey,metaKey:r.metaKey}=s);let n=new KeyboardEvent("keydown",r);n.synthetic=!0,t.dispatchEvent(n);let a=new KeyboardEvent("keyup",r);return a.synthetic=!0,t.dispatchEvent(a),n.defaultPrevented||a.defaultPrevented}function H1(t){for(;t;){if(t&&(t.nodeType==9||t.nodeType==11&&t.host))return t;t=t.assignedSlot||t.parentNode}return null}function K1(t,e){let i=e.focusNode,s=e.focusOffset;if(!i||e.anchorNode!=i||e.anchorOffset!=s)return!1;for(s=Math.min(s,es(i));;)if(s){if(i.nodeType!=1)return!1;let r=i.childNodes[s-1];r.contentEditable=="false"?s--:(i=r,s=es(i))}else{if(i==t)return!0;s=Ts(i),i=i.parentNode}}function _m(t){return t.scrollTop>Math.max(1,t.scrollHeight-t.clientHeight-4)}function Rm(t,e){for(let i=t,s=e;;){if(i.nodeType==3&&s>0)return{node:i,offset:s};if(i.nodeType==1&&s>0){if(i.contentEditable=="false")return null;i=i.childNodes[s-1],s=es(i)}else if(i.parentNode&&!No(i))s=Ts(i),i=i.parentNode;else return null}}function $m(t,e){for(let i=t,s=e;;){if(i.nodeType==3&&s<i.nodeValue.length)return{node:i,offset:s};if(i.nodeType==1&&s<i.childNodes.length){if(i.contentEditable=="false")return null;i=i.childNodes[s],s=0}else if(i.parentNode&&!No(i))s=Ts(i)+1,i=i.parentNode;else return null}}class ui{constructor(e,i,s=!0){this.node=e,this.offset=i,this.precise=s}static before(e,i){return new ui(e.parentNode,Ts(e),i)}static after(e,i){return new ui(e.parentNode,Ts(e)+1,i)}}var Fe=function(t){return t[t.LTR=0]="LTR",t[t.RTL=1]="RTL",t}(Fe||(Fe={}));const nr=Fe.LTR,bd=Fe.RTL;function Im(t){let e=[];for(let i=0;i<t.length;i++)e.push(1<<+t[i]);return e}const J1=Im("88888888888888888888888888888888888666888888787833333333337888888000000000000000000000000008888880000000000000000000000000088888888888888888888888888888888888887866668888088888663380888308888800000000000000000000000800000000000000000000000000000008"),ex=Im("4444448826627288999999999992222222222222222222222222222222222222222222222229999999999999999999994444444444644222822222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222999999949999999229989999223333333333"),yh=Object.create(null),vi=[];for(let t of["()","[]","{}"]){let e=t.charCodeAt(0),i=t.charCodeAt(1);yh[e]=i,yh[i]=-e}function Qm(t){return t<=247?J1[t]:1424<=t&&t<=1524?2:1536<=t&&t<=1785?ex[t-1536]:1774<=t&&t<=2220?4:8192<=t&&t<=8204?256:64336<=t&&t<=65023?4:1}const tx=/[\u0590-\u05f4\u0600-\u06ff\u0700-\u08ac\ufb50-\ufdff]/;class Ji{get dir(){return this.level%2?bd:nr}constructor(e,i,s){this.from=e,this.to=i,this.level=s}side(e,i){return this.dir==i==e?this.to:this.from}forward(e,i){return e==(this.dir==i)}static find(e,i,s,r){let n=-1;for(let a=0;a<e.length;a++){let o=e[a];if(o.from<=i&&o.to>=i){if(o.level==s)return a;(n<0||(r!=0?r<0?o.from<i:o.to>i:e[n].level>o.level))&&(n=a)}}if(n<0)throw new RangeError("Index out of range");return n}}function Am(t,e){if(t.length!=e.length)return!1;for(let i=0;i<t.length;i++){let s=t[i],r=e[i];if(s.from!=r.from||s.to!=r.to||s.direction!=r.direction||!Am(s.inner,r.inner))return!1}return!0}const Ae=[];function ix(t,e,i,s,r){for(let n=0;n<=s.length;n++){let a=n?s[n-1].to:e,o=n<s.length?s[n].from:i,l=n?256:r;for(let c=a,h=l,d=l;c<o;c++){let u=Qm(t.charCodeAt(c));u==512?u=h:u==8&&d==4&&(u=16),Ae[c]=u==4?2:u,u&7&&(d=u),h=u}for(let c=a,h=l,d=l;c<o;c++){let u=Ae[c];if(u==128)c<o-1&&h==Ae[c+1]&&h&24?u=Ae[c]=h:Ae[c]=256;else if(u==64){let p=c+1;for(;p<o&&Ae[p]==64;)p++;let f=c&&h==8||p<i&&Ae[p]==8?d==1?1:8:256;for(let g=c;g<p;g++)Ae[g]=f;c=p-1}else u==8&&d==1&&(Ae[c]=1);h=u,u&7&&(d=u)}}}function sx(t,e,i,s,r){let n=r==1?2:1;for(let a=0,o=0,l=0;a<=s.length;a++){let c=a?s[a-1].to:e,h=a<s.length?s[a].from:i;for(let d=c,u,p,f;d<h;d++)if(p=yh[u=t.charCodeAt(d)])if(p<0){for(let g=o-3;g>=0;g-=3)if(vi[g+1]==-p){let m=vi[g+2],y=m&2?r:m&4?m&1?n:r:0;y&&(Ae[d]=Ae[vi[g]]=y),o=g;break}}else{if(vi.length==189)break;vi[o++]=d,vi[o++]=u,vi[o++]=l}else if((f=Ae[d])==2||f==1){let g=f==r;l=g?0:1;for(let m=o-3;m>=0;m-=3){let y=vi[m+2];if(y&2)break;if(g)vi[m+2]|=2;else{if(y&4)break;vi[m+2]|=4}}}}}function rx(t,e,i,s){for(let r=0,n=s;r<=i.length;r++){let a=r?i[r-1].to:t,o=r<i.length?i[r].from:e;for(let l=a;l<o;){let c=Ae[l];if(c==256){let h=l+1;for(;;)if(h==o){if(r==i.length)break;h=i[r++].to,o=r<i.length?i[r].from:e}else if(Ae[h]==256)h++;else break;let d=n==1,u=(h<e?Ae[h]:s)==1,p=d==u?d?1:2:s;for(let f=h,g=r,m=g?i[g-1].to:t;f>l;)f==m&&(f=i[--g].from,m=g?i[g-1].to:t),Ae[--f]=p;l=h}else n=c,l++}}}function vh(t,e,i,s,r,n,a){let o=s%2?2:1;if(s%2==r%2)for(let l=e,c=0;l<i;){let h=!0,d=!1;if(c==n.length||l<n[c].from){let g=Ae[l];g!=o&&(h=!1,d=g==16)}let u=!h&&o==1?[]:null,p=h?s:s+1,f=l;e:for(;;)if(c<n.length&&f==n[c].from){if(d)break e;let g=n[c];if(!h)for(let m=g.to,y=c+1;;){if(m==i)break e;if(y<n.length&&n[y].from==m)m=n[y++].to;else{if(Ae[m]==o)break e;break}}if(c++,u)u.push(g);else{g.from>l&&a.push(new Ji(l,g.from,p));let m=g.direction==nr!=!(p%2);bh(t,m?s+1:s,r,g.inner,g.from,g.to,a),l=g.to}f=g.to}else{if(f==i||(h?Ae[f]!=o:Ae[f]==o))break;f++}u?vh(t,l,f,s+1,r,u,a):l<f&&a.push(new Ji(l,f,p)),l=f}else for(let l=i,c=n.length;l>e;){let h=!0,d=!1;if(!c||l>n[c-1].to){let g=Ae[l-1];g!=o&&(h=!1,d=g==16)}let u=!h&&o==1?[]:null,p=h?s:s+1,f=l;e:for(;;)if(c&&f==n[c-1].to){if(d)break e;let g=n[--c];if(!h)for(let m=g.from,y=c;;){if(m==e)break e;if(y&&n[y-1].to==m)m=n[--y].from;else{if(Ae[m-1]==o)break e;break}}if(u)u.push(g);else{g.to<l&&a.push(new Ji(g.to,l,p));let m=g.direction==nr!=!(p%2);bh(t,m?s+1:s,r,g.inner,g.from,g.to,a),l=g.from}f=g.from}else{if(f==e||(h?Ae[f-1]!=o:Ae[f-1]==o))break;f--}u?vh(t,f,l,s+1,r,u,a):f<l&&a.push(new Ji(f,l,p)),l=f}}function bh(t,e,i,s,r,n,a){let o=e%2?2:1;ix(t,r,n,s,o),sx(t,r,n,s,o),rx(r,n,s,o),vh(t,r,n,e,i,s,a)}function nx(t,e,i){if(!t)return[new Ji(0,0,e==bd?1:0)];if(e==nr&&!i.length&&!tx.test(t))return Lm(t.length);if(i.length)for(;t.length>Ae.length;)Ae[Ae.length]=256;let s=[],r=e==nr?0:1;return bh(t,r,r,i,0,t.length,s),s}function Lm(t){return[new Ji(0,t,0)]}let Nm="";function ax(t,e,i,s,r){var n;let a=s.head-t.from,o=Ji.find(e,a,(n=s.bidiLevel)!==null&&n!==void 0?n:-1,s.assoc),l=e[o],c=l.side(r,i);if(a==c){let u=o+=r?1:-1;if(u<0||u>=e.length)return null;l=e[o=u],a=l.side(!r,i),c=l.side(r,i)}let h=Ot(t.text,a,l.forward(r,i));(h<l.from||h>l.to)&&(h=c),Nm=t.text.slice(Math.min(a,h),Math.max(a,h));let d=o==(r?e.length-1:0)?null:e[o+(r?1:-1)];return d&&h==c&&d.level+(r?0:1)<l.level?X.cursor(d.side(!r,i)+t.from,d.forward(r,i)?1:-1,d.level):X.cursor(h+t.from,l.forward(r,i)?-1:1,l.level)}function ox(t,e,i){for(let s=e;s<i;s++){let r=Qm(t.charCodeAt(s));if(r==1)return nr;if(r==2||r==4)return bd}return nr}const Mm=se.define(),qm=se.define(),Dm=se.define(),Bm=se.define(),wh=se.define(),jm=se.define(),Wm=se.define(),wd=se.define(),Sd=se.define(),Fm=se.define({combine:t=>t.some(e=>e)}),Um=se.define({combine:t=>t.some(e=>e)}),Vm=se.define();class Ur{constructor(e,i="nearest",s="nearest",r=5,n=5,a=!1){this.range=e,this.y=i,this.x=s,this.yMargin=r,this.xMargin=n,this.isSnapshot=a}map(e){return e.empty?this:new Ur(this.range.map(e),this.y,this.x,this.yMargin,this.xMargin,this.isSnapshot)}clip(e){return this.range.to<=e.doc.length?this:new Ur(X.cursor(e.doc.length),this.y,this.x,this.yMargin,this.xMargin,this.isSnapshot)}}const Ja=Ie.define({map:(t,e)=>t.map(e)}),zm=Ie.define();function _i(t,e,i){let s=t.facet(Bm);s.length?s[0](e):window.onerror&&window.onerror(String(e),i,void 0,void 0,e)||(i?console.error(i+":",e):console.error(e))}const Hi=se.define({combine:t=>t.length?t[0]:!0});let lx=0;const Nr=se.define({combine(t){return t.filter((e,i)=>{for(let s=0;s<i;s++)if(t[s].plugin==e.plugin)return!1;return!0})}});class Lt{constructor(e,i,s,r,n){this.id=e,this.create=i,this.domEventHandlers=s,this.domEventObservers=r,this.baseExtensions=n(this),this.extension=this.baseExtensions.concat(Nr.of({plugin:this,arg:void 0}))}of(e){return this.baseExtensions.concat(Nr.of({plugin:this,arg:e}))}static define(e,i){const{eventHandlers:s,eventObservers:r,provide:n,decorations:a}=i||{};return new Lt(lx++,e,s,r,o=>{let l=[];return a&&l.push(pl.of(c=>{let h=c.plugin(o);return h?a(h):fe.none})),n&&l.push(n(o)),l})}static fromClass(e,i){return Lt.define((s,r)=>new e(s,r),i)}}class cc{constructor(e){this.spec=e,this.mustUpdate=null,this.value=null}get plugin(){return this.spec&&this.spec.plugin}update(e){if(this.value){if(this.mustUpdate){let i=this.mustUpdate;if(this.mustUpdate=null,this.value.update)try{this.value.update(i)}catch(s){if(_i(i.state,s,"CodeMirror plugin crashed"),this.value.destroy)try{this.value.destroy()}catch{}this.deactivate()}}}else if(this.spec)try{this.value=this.spec.plugin.create(e,this.spec.arg)}catch(i){_i(e.state,i,"CodeMirror plugin crashed"),this.deactivate()}return this}destroy(e){var i;if(!((i=this.value)===null||i===void 0)&&i.destroy)try{this.value.destroy()}catch(s){_i(e.state,s,"CodeMirror plugin crashed")}}deactivate(){this.spec=this.value=null}}const Xm=se.define(),xd=se.define(),pl=se.define(),Gm=se.define(),kd=se.define(),ka=se.define(),Ym=se.define();function Tp(t,e){let i=t.state.facet(Ym);if(!i.length)return i;let s=i.map(n=>n instanceof Function?n(t):n),r=[];return Se.spans(s,e.from,e.to,{point(){},span(n,a,o,l){let c=n-e.from,h=a-e.from,d=r;for(let u=o.length-1;u>=0;u--,l--){let p=o[u].spec.bidiIsolate,f;if(p==null&&(p=ox(e.text,c,h)),l>0&&d.length&&(f=d[d.length-1]).to==c&&f.direction==p)f.to=h,d=f.inner;else{let g={from:c,to:h,direction:p,inner:[]};d.push(g),d=g.inner}}}}),r}const Zm=se.define();function Hm(t){let e=0,i=0,s=0,r=0;for(let n of t.state.facet(Zm)){let a=n(t);a&&(a.left!=null&&(e=Math.max(e,a.left)),a.right!=null&&(i=Math.max(i,a.right)),a.top!=null&&(s=Math.max(s,a.top)),a.bottom!=null&&(r=Math.max(r,a.bottom)))}return{left:e,right:i,top:s,bottom:r}}const Ln=se.define();class ei{constructor(e,i,s,r){this.fromA=e,this.toA=i,this.fromB=s,this.toB=r}join(e){return new ei(Math.min(this.fromA,e.fromA),Math.max(this.toA,e.toA),Math.min(this.fromB,e.fromB),Math.max(this.toB,e.toB))}addToSet(e){let i=e.length,s=this;for(;i>0;i--){let r=e[i-1];if(!(r.fromA>s.toA)){if(r.toA<s.fromA)break;s=s.join(r),e.splice(i-1,1)}}return e.splice(i,0,s),e}static extendWithRanges(e,i){if(i.length==0)return e;let s=[];for(let r=0,n=0,a=0;;){let o=r<e.length?e[r].fromB:1e9,l=n<i.length?i[n]:1e9,c=Math.min(o,l);if(c==1e9)break;let h=c+a,d=c,u=h;for(;;)if(n<i.length&&i[n]<=d){let p=i[n+1];n+=2,d=Math.max(d,p);for(let f=r;f<e.length&&e[f].fromB<=d;f++)a=e[f].toA-e[f].toB;u=Math.max(u,p+a)}else if(r<e.length&&e[r].fromB<=d){let p=e[r++];d=Math.max(d,p.toB),u=Math.max(u,p.toA),a=p.toA-p.toB}else break;s.push(new ei(h,u,c,d))}return s}}class qo{constructor(e,i,s){this.view=e,this.state=i,this.transactions=s,this.flags=0,this.startState=e.state,this.changes=rt.empty(this.startState.doc.length);for(let n of s)this.changes=this.changes.compose(n.changes);let r=[];this.changes.iterChangedRanges((n,a,o,l)=>r.push(new ei(n,a,o,l))),this.changedRanges=r}static create(e,i,s){return new qo(e,i,s)}get viewportChanged(){return(this.flags&4)>0}get viewportMoved(){return(this.flags&8)>0}get heightChanged(){return(this.flags&2)>0}get geometryChanged(){return this.docChanged||(this.flags&18)>0}get focusChanged(){return(this.flags&1)>0}get docChanged(){return!this.changes.empty}get selectionSet(){return this.transactions.some(e=>e.selection)}get empty(){return this.flags==0&&this.transactions.length==0}}const cx=[];class tt{constructor(e,i,s=0){this.dom=e,this.length=i,this.flags=s,this.parent=null,e.cmTile=this}get breakAfter(){return this.flags&1}get children(){return cx}isWidget(){return!1}get isHidden(){return!1}isComposite(){return!1}isLine(){return!1}isText(){return!1}isBlock(){return!1}get domAttrs(){return null}sync(e){if(this.flags|=2,this.flags&4){this.flags&=-5;let i=this.domAttrs;i&&U1(this.dom,i)}}toString(){return this.constructor.name+(this.children.length?`(${this.children})`:"")+(this.breakAfter?"#":"")}destroy(){this.parent=null}setDOM(e){this.dom=e,e.cmTile=this}get posAtStart(){return this.parent?this.parent.posBefore(this):0}get posAtEnd(){return this.posAtStart+this.length}posBefore(e,i=this.posAtStart){let s=i;for(let r of this.children){if(r==e)return s;s+=r.length+r.breakAfter}throw new RangeError("Invalid child in posBefore")}posAfter(e){return this.posBefore(e)+e.length}covers(e){return!0}coordsIn(e,i){return null}domPosFor(e,i){let s=Ts(this.dom),r=this.length?e>0:i>0;return new ui(this.parent.dom,s+(r?1:0),e==0||e==this.length)}markDirty(e){this.flags&=-3,e&&(this.flags|=4),this.parent&&this.parent.flags&2&&this.parent.markDirty(!1)}get overrideDOMText(){return null}get root(){for(let e=this;e;e=e.parent)if(e instanceof gl)return e;return null}static get(e){return e.cmTile}}class fl extends tt{constructor(e){super(e,0),this._children=[]}isComposite(){return!0}get children(){return this._children}get lastChild(){return this.children.length?this.children[this.children.length-1]:null}append(e){this.children.push(e),e.parent=this}sync(e){if(this.flags&2)return;super.sync(e);let i=this.dom,s=null,r,n=(e==null?void 0:e.node)==i?e:null,a=0;for(let o of this.children){if(o.sync(e),a+=o.length+o.breakAfter,r=s?s.nextSibling:i.firstChild,n&&r!=o.dom&&(n.written=!0),o.dom.parentNode==i)for(;r&&r!=o.dom;)r=Ep(r);else i.insertBefore(o.dom,r);s=o.dom}for(r=s?s.nextSibling:i.firstChild,n&&r&&(n.written=!0);r;)r=Ep(r);this.length=a}}function Ep(t){let e=t.nextSibling;return t.parentNode.removeChild(t),e}class gl extends fl{constructor(e,i){super(i),this.view=e}owns(e){for(;e;e=e.parent)if(e==this)return!0;return!1}isBlock(){return!0}nearest(e){for(;;){if(!e)return null;let i=tt.get(e);if(i&&this.owns(i))return i;e=e.parentNode}}blockTiles(e){for(let i=[],s=this,r=0,n=0;;)if(r==s.children.length){if(!i.length)return;s=s.parent,s.breakAfter&&n++,r=i.pop()}else{let a=s.children[r++];if(a instanceof ws)i.push(r),s=a,r=0;else{let o=n+a.length,l=e(a,n);if(l!==void 0)return l;n=o+a.breakAfter}}}resolveBlock(e,i){let s,r=-1,n,a=-1;if(this.blockTiles((o,l)=>{let c=l+o.length;if(e>=l&&e<=c){if(o.isWidget()&&i>=-1&&i<=1){if(o.flags&32)return!0;o.flags&16&&(s=void 0)}(l<e||e==c&&(i<-1?o.length:o.covers(1)))&&(!s||!o.isWidget()&&s.isWidget())&&(s=o,r=e-l),(c>e||e==l&&(i>1?o.length:o.covers(-1)))&&(!n||!o.isWidget()&&n.isWidget())&&(n=o,a=e-l)}}),!s&&!n)throw new Error("No tile at position "+e);return s&&i<0||!n?{tile:s,offset:r}:{tile:n,offset:a}}}class ws extends fl{constructor(e,i){super(e),this.wrapper=i}isBlock(){return!0}covers(e){return this.children.length?e<0?this.children[0].covers(-1):this.lastChild.covers(1):!1}get domAttrs(){return this.wrapper.attributes}static of(e,i){let s=new ws(i||document.createElement(e.tagName),e);return i||(s.flags|=4),s}}class Zr extends fl{constructor(e,i){super(e),this.attrs=i}isLine(){return!0}static start(e,i,s){let r=new Zr(i||document.createElement("div"),e);return(!i||!s)&&(r.flags|=4),r}get domAttrs(){return this.attrs}resolveInline(e,i,s){let r=null,n=-1,a=null,o=-1;function l(h,d){for(let u=0,p=0;u<h.children.length&&p<=d;u++){let f=h.children[u],g=p+f.length;g>=d&&(f.isComposite()?l(f,d-p):(!a||a.isHidden&&(i>0||s&&dx(a,f)))&&(g>d||f.flags&32)?(a=f,o=d-p):(p<d||f.flags&16&&!f.isHidden)&&(r=f,n=d-p)),p=g}}l(this,e);let c=(i<0?r:a)||r||a;return c?{tile:c,offset:c==r?n:o}:null}coordsIn(e,i){let s=this.resolveInline(e,i,!0);return s?s.tile.coordsIn(Math.max(0,s.offset),i):hx(this)}domIn(e,i){let s=this.resolveInline(e,i);if(s){let{tile:r,offset:n}=s;if(this.dom.contains(r.dom))return r.isText()?new ui(r.dom,Math.min(r.dom.nodeValue.length,n)):r.domPosFor(n,r.flags&16?1:r.flags&32?-1:i);let a=s.tile.parent,o=!1;for(let l of a.children){if(o)return new ui(l.dom,0);l==s.tile&&(o=!0)}}return new ui(this.dom,0)}}function hx(t){let e=t.dom.lastChild;if(!e)return t.dom.getBoundingClientRect();let i=bo(e);return i[i.length-1]||null}function dx(t,e){let i=t.coordsIn(0,1),s=e.coordsIn(0,1);return i&&s&&s.top<i.bottom}class It extends fl{constructor(e,i){super(e),this.mark=i}get domAttrs(){return this.mark.attrs}static of(e,i){let s=new It(i||document.createElement(e.tagName),e);return i||(s.flags|=4),s}}class Hs extends tt{constructor(e,i){super(e,i.length),this.text=i}sync(e){this.flags&2||(super.sync(e),this.dom.nodeValue!=this.text&&(e&&e.node==this.dom&&(e.written=!0),this.dom.nodeValue=this.text))}isText(){return!0}toString(){return JSON.stringify(this.text)}coordsIn(e,i){let s=this.dom.nodeValue.length;e>s&&(e=s);let r=e,n=e,a=0;e==0&&i<0||e==s&&i>=0?K.chrome||K.gecko||(e?(r--,a=1):n<s&&(n++,a=-1)):i<0?r--:n<s&&n++;let o=da(this.dom,r,n).getClientRects();if(!o.length)return null;let l=o[(a?a<0:i>=0)?0:o.length-1];return K.safari&&!a&&l.width==0&&(l=Array.prototype.find.call(o,c=>c.width)||l),a?Mo(l,a<0):l||null}static of(e,i){let s=new Hs(i||document.createTextNode(e),e);return i||(s.flags|=2),s}}class ar extends tt{constructor(e,i,s,r){super(e,i,r),this.widget=s}isWidget(){return!0}get isHidden(){return this.widget.isHidden}covers(e){return this.flags&48?!1:(this.flags&(e<0?64:128))>0}coordsIn(e,i){return this.coordsInWidget(e,i,!1)}coordsInWidget(e,i,s){let r=this.widget.coordsAt(this.dom,e,i);if(r)return r;if(s)return Mo(this.dom.getBoundingClientRect(),this.length?e==0:i<=0);{let n=this.dom.getClientRects(),a=null;if(!n.length)return null;let o=this.flags&16?!0:this.flags&32?!1:e>0;for(let l=o?n.length-1:0;a=n[l],!(e>0?l==0:l==n.length-1||a.top<a.bottom);l+=o?-1:1);return Mo(a,!o)}}get overrideDOMText(){if(!this.length)return $e.empty;let{root:e}=this;if(!e)return $e.empty;let i=this.posAtStart;return e.view.state.doc.slice(i,i+this.length)}destroy(){super.destroy(),this.widget.destroy(this.dom)}static of(e,i,s,r,n){return n||(n=e.toDOM(i),e.editable||(n.contentEditable="false")),new ar(n,s,e,r)}}class Do extends tt{constructor(e){let i=document.createElement("img");i.className="cm-widgetBuffer",i.setAttribute("aria-hidden","true"),super(i,0,e)}get isHidden(){return!0}get overrideDOMText(){return $e.empty}coordsIn(e){return this.dom.getBoundingClientRect()}}class ux{constructor(e){this.index=0,this.beforeBreak=!1,this.parents=[],this.tile=e}advance(e,i,s){let{tile:r,index:n,beforeBreak:a,parents:o}=this;for(;e||i>0;)if(r.isComposite())if(a){if(!e)break;s&&s.break(),e--,a=!1}else if(n==r.children.length){if(!e&&!o.length)break;s&&s.leave(r),a=!!r.breakAfter,{tile:r,index:n}=o.pop(),n++}else{let l=r.children[n],c=l.breakAfter;(i>0?l.length<=e:l.length<e)&&(!s||s.skip(l,0,l.length)!==!1||!l.isComposite)?(a=!!c,n++,e-=l.length):(o.push({tile:r,index:n}),r=l,n=0,s&&l.isComposite()&&s.enter(l))}else if(n==r.length)a=!!r.breakAfter,{tile:r,index:n}=o.pop(),n++;else if(e){let l=Math.min(e,r.length-n);s&&s.skip(r,n,n+l),e-=l,n+=l}else break;return this.tile=r,this.index=n,this.beforeBreak=a,this}get root(){return this.parents.length?this.parents[0].tile:this.tile}}class px{constructor(e,i,s,r){this.from=e,this.to=i,this.wrapper=s,this.rank=r}}class fx{constructor(e,i,s){this.cache=e,this.root=i,this.blockWrappers=s,this.curLine=null,this.lastBlock=null,this.afterWidget=null,this.pos=0,this.wrappers=[],this.wrapperPos=0}addText(e,i,s,r){var n;this.flushBuffer();let a=this.ensureMarks(i,s),o=a.lastChild;if(o&&o.isText()&&!(o.flags&8)){this.cache.reused.set(o,2);let l=a.children[a.children.length-1]=new Hs(o.dom,o.text+e);l.parent=a}else a.append(r||Hs.of(e,(n=this.cache.find(Hs))===null||n===void 0?void 0:n.dom));this.pos+=e.length,this.afterWidget=null}addComposition(e,i){let s=this.curLine;s.dom!=i.line.dom&&(s.setDOM(this.cache.reused.has(i.line)?hc(i.line.dom):i.line.dom),this.cache.reused.set(i.line,2));let r=s;for(let o=i.marks.length-1;o>=0;o--){let l=i.marks[o],c=r.lastChild;if(c instanceof It&&c.mark.eq(l.mark))c.dom!=l.dom&&c.setDOM(hc(l.dom)),r=c;else{if(this.cache.reused.get(l)){let d=tt.get(l.dom);d&&d.setDOM(hc(l.dom))}let h=It.of(l.mark,l.dom);r.append(h),r=h}this.cache.reused.set(l,2)}let n=tt.get(e.text);n&&this.cache.reused.set(n,2);let a=new Hs(e.text,e.text.nodeValue);a.flags|=8,r.append(a)}addInlineWidget(e,i,s){let r=this.afterWidget&&e.flags&48&&(this.afterWidget.flags&48)==(e.flags&48);r||this.flushBuffer();let n=this.ensureMarks(i,s);!r&&!(e.flags&16)&&n.append(this.getBuffer(1)),n.append(e),this.pos+=e.length,this.afterWidget=e}addMark(e,i,s){this.flushBuffer(),this.ensureMarks(i,s).append(e),this.pos+=e.length,this.afterWidget=null}addBlockWidget(e){this.getBlockPos().append(e),this.pos+=e.length,this.lastBlock=e,this.endLine()}continueWidget(e){let i=this.afterWidget||this.lastBlock;i.length+=e,this.pos+=e}addLineStart(e,i){var s;e||(e=Km);let r=Zr.start(e,i||((s=this.cache.find(Zr))===null||s===void 0?void 0:s.dom),!!i);this.getBlockPos().append(this.lastBlock=this.curLine=r)}addLine(e){this.getBlockPos().append(e),this.pos+=e.length,this.lastBlock=e,this.endLine()}addBreak(){this.lastBlock.flags|=1,this.endLine(),this.pos++}addLineStartIfNotCovered(e){this.blockPosCovered()||this.addLineStart(e)}ensureLine(e){this.curLine||this.addLineStart(e)}ensureMarks(e,i){var s;let r=this.curLine;for(let n=e.length-1;n>=0;n--){let a=e[n],o;if(i>0&&(o=r.lastChild)&&o instanceof It&&o.mark.eq(a))r=o,i--;else{let l=It.of(a,(s=this.cache.find(It,c=>c.mark.eq(a)))===null||s===void 0?void 0:s.dom);r.append(l),r=l,i=0}}return r}endLine(){if(this.curLine){this.flushBuffer();let e=this.curLine.lastChild;(!e||!Pp(this.curLine,!1)||e.dom.nodeName!="BR"&&e.isWidget()&&!(K.ios&&Pp(this.curLine,!0)))&&this.curLine.append(this.cache.findWidget(dc,0,32)||new ar(dc.toDOM(),0,dc,32)),this.curLine=this.afterWidget=null}}updateBlockWrappers(){this.wrapperPos>this.pos+1e4&&(this.blockWrappers.goto(this.pos),this.wrappers.length=0);for(let e=this.wrappers.length-1;e>=0;e--)this.wrappers[e].to<this.pos&&this.wrappers.splice(e,1);for(let e=this.blockWrappers;e.value&&e.from<=this.pos;e.next())if(e.to>=this.pos){let i=new px(e.from,e.to,e.value,e.rank),s=this.wrappers.length;for(;s>0&&(this.wrappers[s-1].rank-i.rank||this.wrappers[s-1].to-i.to)<0;)s--;this.wrappers.splice(s,0,i)}this.wrapperPos=this.pos}getBlockPos(){var e;this.updateBlockWrappers();let i=this.root;for(let s of this.wrappers){let r=i.lastChild;if(s.from<this.pos&&r instanceof ws&&r.wrapper.eq(s.wrapper))i=r;else{let n=ws.of(s.wrapper,(e=this.cache.find(ws,a=>a.wrapper.eq(s.wrapper)))===null||e===void 0?void 0:e.dom);i.append(n),i=n}}return i}blockPosCovered(){let e=this.lastBlock;return e!=null&&!e.breakAfter&&(!e.isWidget()||(e.flags&160)>0)}getBuffer(e){let i=2|(e<0?16:32),s=this.cache.find(Do,void 0,1);return s&&(s.flags=i),s||new Do(i)}flushBuffer(){this.afterWidget&&!(this.afterWidget.flags&32)&&(this.afterWidget.parent.append(this.getBuffer(-1)),this.afterWidget=null)}}class gx{constructor(e){this.skipCount=0,this.text="",this.textOff=0,this.cursor=e.iter()}skip(e){this.textOff+e<=this.text.length?this.textOff+=e:(this.skipCount+=e-(this.text.length-this.textOff),this.text="",this.textOff=0)}next(e){if(this.textOff==this.text.length){let{value:r,lineBreak:n,done:a}=this.cursor.next(this.skipCount);if(this.skipCount=0,a)throw new Error("Ran out of text content when drawing inline views");this.text=r;let o=this.textOff=Math.min(e,r.length);return n?null:r.slice(0,o)}let i=Math.min(this.text.length,this.textOff+e),s=this.text.slice(this.textOff,i);return this.textOff=i,s}}const Bo=[ar,Zr,Hs,It,Do,ws,gl];for(let t=0;t<Bo.length;t++)Bo[t].bucket=t;class mx{constructor(e){this.view=e,this.buckets=Bo.map(()=>[]),this.index=Bo.map(()=>0),this.reused=new Map}add(e){let i=e.constructor.bucket,s=this.buckets[i];s.length<6?s.push(e):s[this.index[i]=(this.index[i]+1)%6]=e}find(e,i,s=2){let r=e.bucket,n=this.buckets[r],a=this.index[r];for(let o=n.length-1;o>=0;o--){let l=(o+a)%n.length,c=n[l];if((!i||i(c))&&!this.reused.has(c))return n.splice(l,1),l<a&&this.index[r]--,this.reused.set(c,s),c}return null}findWidget(e,i,s){let r=this.buckets[0];if(r.length)for(let n=0,a=0;;n++){if(n==r.length){if(a)return null;a=1,n=0}let o=r[n];if(!this.reused.has(o)&&(a==0?o.widget.compare(e):o.widget.constructor==e.constructor&&e.updateDOM(o.dom,this.view)))return r.splice(n,1),n<this.index[0]&&this.index[0]--,o.widget==e&&o.length==i&&(o.flags&497)==s?(this.reused.set(o,1),o):(this.reused.set(o,2),new ar(o.dom,i,e,o.flags&-498|s))}}reuse(e){return this.reused.set(e,1),e}maybeReuse(e,i=2){if(!this.reused.has(e))return this.reused.set(e,i),e.dom}clear(){for(let e=0;e<this.buckets.length;e++)this.buckets[e].length=this.index[e]=0}}class Ox{constructor(e,i,s,r,n){this.view=e,this.decorations=r,this.disallowBlockEffectsFor=n,this.openWidget=!1,this.openMarks=0,this.cache=new mx(e),this.text=new gx(e.state.doc),this.builder=new fx(this.cache,new gl(e,e.contentDOM),Se.iter(s)),this.cache.reused.set(i,2),this.old=new ux(i),this.reuseWalker={skip:(a,o,l)=>{if(this.cache.add(a),a.isComposite())return!1},enter:a=>this.cache.add(a),leave:()=>{},break:()=>{}}}run(e,i){let s=i&&this.getCompositionContext(i.text);for(let r=0,n=0,a=0;;){let o=a<e.length?e[a++]:null,l=o?o.fromA:this.old.root.length;if(l>r){let c=l-r;this.preserve(c,!a,!o),r=l,n+=c}if(!o)break;i&&o.fromA<=i.range.fromA&&o.toA>=i.range.toA?(this.forward(o.fromA,i.range.fromA,i.range.fromA<i.range.toA?1:-1),this.emit(n,i.range.fromB),this.cache.clear(),this.builder.addComposition(i,s),this.text.skip(i.range.toB-i.range.fromB),this.forward(i.range.fromA,o.toA),this.emit(i.range.toB,o.toB)):(this.forward(o.fromA,o.toA),this.emit(n,o.toB)),n=o.toB,r=o.toA}return this.builder.curLine&&this.builder.endLine(),this.builder.root}preserve(e,i,s){let r=bx(this.old),n=this.openMarks;this.old.advance(e,s?1:-1,{skip:(a,o,l)=>{if(a.isWidget())if(this.openWidget)this.builder.continueWidget(l-o);else{let c=l>0||o<a.length?ar.of(a.widget,this.view,l-o,a.flags&496,this.cache.maybeReuse(a)):this.cache.reuse(a);c.flags&256?(c.flags&=-2,this.builder.addBlockWidget(c)):(this.builder.ensureLine(null),this.builder.addInlineWidget(c,r,n),n=r.length)}else if(a.isText())this.builder.ensureLine(null),!o&&l==a.length?this.builder.addText(a.text,r,n,this.cache.reuse(a)):(this.cache.add(a),this.builder.addText(a.text.slice(o,l),r,n)),n=r.length;else if(a.isLine())a.flags&=-2,this.cache.reused.set(a,1),this.builder.addLine(a);else if(a instanceof Do)this.cache.add(a);else if(a instanceof It)this.builder.ensureLine(null),this.builder.addMark(a,r,n),this.cache.reused.set(a,1),n=r.length;else return!1;this.openWidget=!1},enter:a=>{a.isLine()?this.builder.addLineStart(a.attrs,this.cache.maybeReuse(a)):(this.cache.add(a),a instanceof It&&r.unshift(a.mark)),this.openWidget=!1},leave:a=>{a.isLine()?r.length&&(r.length=n=0):a instanceof It&&(r.shift(),n=Math.min(n,r.length))},break:()=>{this.builder.addBreak(),this.openWidget=!1}}),this.text.skip(e)}emit(e,i){let s=null,r=this.builder,n=0,a=Se.spans(this.decorations,e,i,{point:(o,l,c,h,d,u)=>{if(c instanceof rr){if(this.disallowBlockEffectsFor[u]){if(c.block)throw new RangeError("Block decorations may not be specified via plugins");if(l>this.view.state.doc.lineAt(o).to)throw new RangeError("Decorations that replace line breaks may not be specified via plugins")}if(n=h.length,d>h.length)r.continueWidget(l-o);else{let p=c.widget||(c.block?Hr.block:Hr.inline),f=yx(c),g=this.cache.findWidget(p,l-o,f)||ar.of(p,this.view,l-o,f);c.block?(c.startSide>0&&r.addLineStartIfNotCovered(s),r.addBlockWidget(g)):(r.ensureLine(s),r.addInlineWidget(g,h,d))}s=null}else s=vx(s,c);l>o&&this.text.skip(l-o)},span:(o,l,c,h)=>{for(let d=o;d<l;){let u=this.text.next(Math.min(512,l-d));u==null?(r.addLineStartIfNotCovered(s),r.addBreak(),d++):(r.ensureLine(s),r.addText(u,c,h),d+=u.length),s=null}}});r.addLineStartIfNotCovered(s),this.openWidget=a>n,this.openMarks=a}forward(e,i,s=1){i-e<=10?this.old.advance(i-e,s,this.reuseWalker):(this.old.advance(5,-1,this.reuseWalker),this.old.advance(i-e-10,-1),this.old.advance(5,s,this.reuseWalker))}getCompositionContext(e){let i=[],s=null;for(let r=e.parentNode;;r=r.parentNode){let n=tt.get(r);if(r==this.view.contentDOM)break;n instanceof It?i.push(n):n!=null&&n.isLine()?s=n:r.nodeName=="DIV"&&!s&&r!=this.view.contentDOM?s=new Zr(r,Km):i.push(It.of(new Sa({tagName:r.nodeName.toLowerCase(),attributes:V1(r)}),r))}return{line:s,marks:i}}}function Pp(t,e){let i=s=>{for(let r of s.children)if((e?r.isText():r.length)||i(r))return!0;return!1};return i(t)}function yx(t){let e=t.isReplace?(t.startSide<0?64:0)|(t.endSide>0?128:0):t.startSide>0?32:16;return t.block&&(e|=256),e}const Km={class:"cm-line"};function vx(t,e){let i=e.spec.attributes,s=e.spec.class;return!i&&!s||(t||(t={class:"cm-line"}),i&&yd(i,t),s&&(t.class+=" "+s)),t}function bx(t){let e=[];for(let i=t.parents.length;i>1;i--){let s=i==t.parents.length?t.tile:t.parents[i].tile;s instanceof It&&e.push(s.mark)}return e}function hc(t){let e=tt.get(t);return e&&e.setDOM(t.cloneNode()),t}class Hr extends gi{constructor(e){super(),this.tag=e}eq(e){return e.tag==this.tag}toDOM(){return document.createElement(this.tag)}updateDOM(e){return e.nodeName.toLowerCase()==this.tag}get isHidden(){return!0}}Hr.inline=new Hr("span");Hr.block=new Hr("div");const dc=new class extends gi{toDOM(){return document.createElement("br")}get isHidden(){return!0}get editable(){return!0}};class Cp{constructor(e){this.view=e,this.decorations=[],this.blockWrappers=[],this.dynamicDecorationMap=[!1],this.domChanged=null,this.hasComposition=null,this.editContextFormatting=fe.none,this.lastCompositionAfterCursor=!1,this.minWidth=0,this.minWidthFrom=0,this.minWidthTo=0,this.impreciseAnchor=null,this.impreciseHead=null,this.forceSelection=!1,this.lastUpdate=Date.now(),this.updateDeco(),this.tile=new gl(e,e.contentDOM),this.updateInner([new ei(0,0,0,e.state.doc.length)],null)}update(e){var i;let s=e.changedRanges;this.minWidth>0&&s.length&&(s.every(({fromA:h,toA:d})=>d<this.minWidthFrom||h>this.minWidthTo)?(this.minWidthFrom=e.changes.mapPos(this.minWidthFrom,1),this.minWidthTo=e.changes.mapPos(this.minWidthTo,1)):this.minWidth=this.minWidthFrom=this.minWidthTo=0),this.updateEditContextFormatting(e);let r=-1;this.view.inputState.composing>=0&&!this.view.observer.editContext&&(!((i=this.domChanged)===null||i===void 0)&&i.newSel?r=this.domChanged.newSel.head:!_x(e.changes,this.hasComposition)&&!e.selectionSet&&(r=e.state.selection.main.head));let n=r>-1?Sx(this.view,e.changes,r):null;if(this.domChanged=null,this.hasComposition){let{from:h,to:d}=this.hasComposition;s=new ei(h,d,e.changes.mapPos(h,-1),e.changes.mapPos(d,1)).addToSet(s.slice())}this.hasComposition=n?{from:n.range.fromB,to:n.range.toB}:null,(K.ie||K.chrome)&&!n&&e&&e.state.doc.lines!=e.startState.doc.lines&&(this.forceSelection=!0);let a=this.decorations,o=this.blockWrappers;this.updateDeco();let l=Tx(a,this.decorations,e.changes);l.length&&(s=ei.extendWithRanges(s,l));let c=Px(o,this.blockWrappers,e.changes);return c.length&&(s=ei.extendWithRanges(s,c)),n&&!s.some(h=>h.fromA<=n.range.fromA&&h.toA>=n.range.toA)&&(s=n.range.addToSet(s.slice())),this.tile.flags&2&&s.length==0?!1:(this.updateInner(s,n),e.transactions.length&&(this.lastUpdate=Date.now()),!0)}updateInner(e,i){this.view.viewState.mustMeasureContent=!0;let{observer:s}=this.view;s.ignore(()=>{if(i||e.length){let a=this.tile,o=new Ox(this.view,a,this.blockWrappers,this.decorations,this.dynamicDecorationMap);this.tile=o.run(e,i),Sh(a,o.cache.reused)}this.tile.dom.style.height=this.view.viewState.contentHeight/this.view.scaleY+"px",this.tile.dom.style.flexBasis=this.minWidth?this.minWidth+"px":"";let n=K.chrome||K.ios?{node:s.selectionRange.focusNode,written:!1}:void 0;this.tile.sync(n),n&&(n.written||s.selectionRange.focusNode!=n.node||!this.tile.dom.contains(n.node))&&(this.forceSelection=!0),this.tile.dom.style.height=""});let r=[];if(this.view.viewport.from||this.view.viewport.to<this.view.state.doc.length)for(let n of this.tile.children)n.isWidget()&&n.widget instanceof uc&&r.push(n.dom);s.updateGaps(r)}updateEditContextFormatting(e){this.editContextFormatting=this.editContextFormatting.map(e.changes);for(let i of e.transactions)for(let s of i.effects)s.is(zm)&&(this.editContextFormatting=s.value)}updateSelection(e=!1,i=!1){(e||!this.view.observer.selectionRange.focusNode)&&this.view.observer.readSelectionRange();let{dom:s}=this.tile,r=this.view.root.activeElement,n=r==s,a=!n&&!(this.view.state.facet(Hi)||s.tabIndex>-1)&&zn(s,this.view.observer.selectionRange)&&!(r&&s.contains(r));if(!(n||i||a))return;let o=this.forceSelection;this.forceSelection=!1;let l=this.view.state.selection.main,c,h;if(l.empty?h=c=this.inlineDOMNearPos(l.anchor,l.assoc||1):(h=this.inlineDOMNearPos(l.head,l.head==l.from?1:-1),c=this.inlineDOMNearPos(l.anchor,l.anchor==l.from?1:-1)),K.gecko&&l.empty&&!this.hasComposition&&wx(c)){let u=document.createTextNode("");this.view.observer.ignore(()=>c.node.insertBefore(u,c.node.childNodes[c.offset]||null)),c=h=new ui(u,0),o=!0}let d=this.view.observer.selectionRange;(o||!d.focusNode||(!Xn(c.node,c.offset,d.anchorNode,d.anchorOffset)||!Xn(h.node,h.offset,d.focusNode,d.focusOffset))&&!this.suppressWidgetCursorChange(d,l))&&(this.view.observer.ignore(()=>{K.android&&K.chrome&&s.contains(d.focusNode)&&Cx(d.focusNode,s)&&(s.blur(),s.focus({preventScroll:!0}));let u=Yr(this.view.root);if(u)if(l.empty){if(K.gecko){let p=xx(c.node,c.offset);if(p&&p!=3){let f=(p==1?Rm:$m)(c.node,c.offset);f&&(c=new ui(f.node,f.offset))}}u.collapse(c.node,c.offset),l.bidiLevel!=null&&u.caretBidiLevel!==void 0&&(u.caretBidiLevel=l.bidiLevel)}else if(u.extend){u.collapse(c.node,c.offset);try{u.extend(h.node,h.offset)}catch{}}else{let p=document.createRange();l.anchor>l.head&&([c,h]=[h,c]),p.setEnd(h.node,h.offset),p.setStart(c.node,c.offset),u.removeAllRanges(),u.addRange(p)}a&&this.view.root.activeElement==s&&(s.blur(),r&&r.focus())}),this.view.observer.setSelectionRange(c,h)),this.impreciseAnchor=c.precise?null:new ui(d.anchorNode,d.anchorOffset),this.impreciseHead=h.precise?null:new ui(d.focusNode,d.focusOffset)}suppressWidgetCursorChange(e,i){return this.hasComposition&&i.empty&&Xn(e.focusNode,e.focusOffset,e.anchorNode,e.anchorOffset)&&this.posFromDOM(e.focusNode,e.focusOffset)==i.head}enforceCursorAssoc(){if(this.hasComposition)return;let{view:e}=this,i=e.state.selection.main,s=Yr(e.root),{anchorNode:r,anchorOffset:n}=e.observer.selectionRange;if(!s||!i.empty||!i.assoc||!s.modify)return;let a=this.lineAt(i.head,i.assoc);if(!a)return;let o=a.posAtStart;if(i.head==o||i.head==o+a.length)return;let l=this.coordsAt(i.head,-1),c=this.coordsAt(i.head,1);if(!l||!c||l.bottom>c.top)return;let h=this.domAtPos(i.head+i.assoc,i.assoc);s.collapse(h.node,h.offset),s.modify("move",i.assoc<0?"forward":"backward","lineboundary"),e.observer.readSelectionRange();let d=e.observer.selectionRange;e.docView.posFromDOM(d.anchorNode,d.anchorOffset)!=i.from&&s.collapse(r,n)}posFromDOM(e,i){let s=this.tile.nearest(e);if(!s)return this.tile.dom.compareDocumentPosition(e)&2?0:this.view.state.doc.length;let r=s.posAtStart;if(s.isComposite()){let n;if(e==s.dom)n=s.dom.childNodes[i];else{let a=es(e)==0?0:i==0?-1:1;for(;;){let o=e.parentNode;if(o==s.dom)break;a==0&&o.firstChild!=o.lastChild&&(e==o.firstChild?a=-1:a=1),e=o}a<0?n=e:n=e.nextSibling}if(n==s.dom.firstChild)return r;for(;n&&!tt.get(n);)n=n.nextSibling;if(!n)return r+s.length;for(let a=0,o=r;;a++){let l=s.children[a];if(l.dom==n)return o;o+=l.length+l.breakAfter}}else return s.isText()?e==s.dom?r+i:r+(i?s.length:0):r}domAtPos(e,i){let{tile:s,offset:r}=this.tile.resolveBlock(e,i);return s.isWidget()?s.domPosFor(e,i):s.domIn(r,i)}inlineDOMNearPos(e,i){let s,r=-1,n=!1,a,o=-1,l=!1;return this.tile.blockTiles((c,h)=>{if(c.isWidget()){if(c.flags&32&&h>=e)return!0;c.flags&16&&(n=!0)}else{let d=h+c.length;if(h<=e&&(s=c,r=e-h,n=d<e),d>=e&&!a&&(a=c,o=e-h,l=h>e),h>e&&a)return!0}}),!s&&!a?this.domAtPos(e,i):(n&&a?s=null:l&&s&&(a=null),s&&i<0||!a?s.domIn(r,i):a.domIn(o,i))}coordsAt(e,i){let{tile:s,offset:r}=this.tile.resolveBlock(e,i);return s.isWidget()?s.widget instanceof uc?null:s.coordsInWidget(r,i,!0):s.coordsIn(r,i)}lineAt(e,i){let{tile:s}=this.tile.resolveBlock(e,i);return s.isLine()?s:null}coordsForChar(e){let{tile:i,offset:s}=this.tile.resolveBlock(e,1);if(!i.isLine())return null;function r(n,a){if(n.isComposite())for(let o of n.children){if(o.length>=a){let l=r(o,a);if(l)return l}if(a-=o.length,a<0)break}else if(n.isText()&&a<n.length){let o=Ot(n.text,a);if(o==a)return null;let l=da(n.dom,a,o).getClientRects();for(let c=0;c<l.length;c++){let h=l[c];if(c==l.length-1||h.top<h.bottom&&h.left<h.right)return h}}return null}return r(i,s)}measureVisibleLineHeights(e){let i=[],{from:s,to:r}=e,n=this.view.contentDOM.clientWidth,a=n>Math.max(this.view.scrollDOM.clientWidth,this.minWidth)+1,o=-1,l=this.view.textDirection==Fe.LTR,c=0,h=(d,u,p)=>{for(let f=0;f<d.children.length&&!(u>r);f++){let g=d.children[f],m=u+g.length,y=g.dom.getBoundingClientRect(),{height:b}=y;if(p&&!f&&(c+=y.top-p.top),g instanceof ws)m>s&&h(g,u,y);else if(u>=s&&(c>0&&i.push(-c),i.push(b+c),c=0,a)){let w=g.dom.lastChild,k=w?bo(w):[];if(k.length){let x=k[k.length-1],E=l?x.right-y.left:y.right-x.left;E>o&&(o=E,this.minWidth=n,this.minWidthFrom=u,this.minWidthTo=m)}}p&&f==d.children.length-1&&(c+=p.bottom-y.bottom),u=m+g.breakAfter}};return h(this.tile,0,null),i}textDirectionAt(e){let{tile:i}=this.tile.resolveBlock(e,1);return getComputedStyle(i.dom).direction=="rtl"?Fe.RTL:Fe.LTR}measureTextSize(){let e=this.tile.blockTiles(a=>{if(a.isLine()&&a.children.length&&a.length<=20){let o=0,l;for(let c of a.children){if(!c.isText()||/[^ -~]/.test(c.text))return;let h=bo(c.dom);if(h.length!=1)return;o+=h[0].width,l=h[0].height}if(o)return{lineHeight:a.dom.getBoundingClientRect().height,charWidth:o/a.length,textHeight:l}}});if(e)return e;let i=document.createElement("div"),s,r,n;return i.className="cm-line",i.style.width="99999px",i.style.position="absolute",i.textContent="abc def ghi jkl mno pqr stu",this.view.observer.ignore(()=>{this.tile.dom.appendChild(i);let a=bo(i.firstChild)[0];s=i.getBoundingClientRect().height,r=a&&a.width?a.width/27:7,n=a&&a.height?a.height:s,i.remove()}),{lineHeight:s,charWidth:r,textHeight:n}}computeBlockGapDeco(){let e=[],i=this.view.viewState;for(let s=0,r=0;;r++){let n=r==i.viewports.length?null:i.viewports[r],a=n?n.from-1:this.view.state.doc.length;if(a>s){let o=(i.lineBlockAt(a).bottom-i.lineBlockAt(s).top)/this.view.scaleY;e.push(fe.replace({widget:new uc(o),block:!0,inclusive:!0,isBlockGap:!0}).range(s,a))}if(!n)break;s=n.to+1}return fe.set(e)}updateDeco(){let e=1,i=this.view.state.facet(pl).map(n=>(this.dynamicDecorationMap[e++]=typeof n=="function")?n(this.view):n),s=!1,r=this.view.state.facet(kd).map((n,a)=>{let o=typeof n=="function";return o&&(s=!0),o?n(this.view):n});for(r.length&&(this.dynamicDecorationMap[e++]=s,i.push(Se.join(r))),this.decorations=[this.editContextFormatting,...i,this.computeBlockGapDeco(),this.view.viewState.lineGapDeco];e<this.decorations.length;)this.dynamicDecorationMap[e++]=!1;this.blockWrappers=this.view.state.facet(Gm).map(n=>typeof n=="function"?n(this.view):n)}scrollIntoView(e){if(e.isSnapshot){let c=this.view.viewState.lineBlockAt(e.range.head);this.view.scrollDOM.scrollTop=c.top-e.yMargin,this.view.scrollDOM.scrollLeft=e.xMargin;return}for(let c of this.view.state.facet(Vm))try{if(c(this.view,e.range,e))return!0}catch(h){_i(this.view.state,h,"scroll handler")}let{range:i}=e,s=this.coordsAt(i.head,i.empty?i.assoc:i.head>i.anchor?-1:1),r;if(!s)return;!i.empty&&(r=this.coordsAt(i.anchor,i.anchor>i.head?-1:1))&&(s={left:Math.min(s.left,r.left),top:Math.min(s.top,r.top),right:Math.max(s.right,r.right),bottom:Math.max(s.bottom,r.bottom)});let n=Hm(this.view),a={left:s.left-n.left,top:s.top-n.top,right:s.right+n.right,bottom:s.bottom+n.bottom},{offsetWidth:o,offsetHeight:l}=this.view.scrollDOM;G1(this.view.scrollDOM,a,i.head<i.anchor?-1:1,e.x,e.y,Math.max(Math.min(e.xMargin,o),-o),Math.max(Math.min(e.yMargin,l),-l),this.view.textDirection==Fe.LTR)}lineHasWidget(e){let i=s=>s.isWidget()||s.children.some(i);return i(this.tile.resolveBlock(e,1).tile)}destroy(){Sh(this.tile)}}function Sh(t,e){let i=e==null?void 0:e.get(t);if(i!=1){i==null&&t.destroy();for(let s of t.children)Sh(s,e)}}function wx(t){return t.node.nodeType==1&&t.node.firstChild&&(t.offset==0||t.node.childNodes[t.offset-1].contentEditable=="false")&&(t.offset==t.node.childNodes.length||t.node.childNodes[t.offset].contentEditable=="false")}function Jm(t,e){let i=t.observer.selectionRange;if(!i.focusNode)return null;let s=Rm(i.focusNode,i.focusOffset),r=$m(i.focusNode,i.focusOffset),n=s||r;if(r&&s&&r.node!=s.node){let o=tt.get(r.node);if(!o||o.isText()&&o.text!=r.node.nodeValue)n=r;else if(t.docView.lastCompositionAfterCursor){let l=tt.get(s.node);!l||l.isText()&&l.text!=s.node.nodeValue||(n=r)}}if(t.docView.lastCompositionAfterCursor=n!=s,!n)return null;let a=e-n.offset;return{from:a,to:a+n.node.nodeValue.length,node:n.node}}function Sx(t,e,i){let s=Jm(t,i);if(!s)return null;let{node:r,from:n,to:a}=s,o=r.nodeValue;if(/[\n\r]/.test(o)||t.state.doc.sliceString(s.from,s.to)!=o)return null;let l=e.invertedDesc;return{range:new ei(l.mapPos(n),l.mapPos(a),n,a),text:r}}function xx(t,e){return t.nodeType!=1?0:(e&&t.childNodes[e-1].contentEditable=="false"?1:0)|(e<t.childNodes.length&&t.childNodes[e].contentEditable=="false"?2:0)}let kx=class{constructor(){this.changes=[]}compareRange(e,i){Wr(e,i,this.changes)}comparePoint(e,i){Wr(e,i,this.changes)}boundChange(e){Wr(e,e,this.changes)}};function Tx(t,e,i){let s=new kx;return Se.compare(t,e,i,s),s.changes}class Ex{constructor(){this.changes=[]}compareRange(e,i){Wr(e,i,this.changes)}comparePoint(){}boundChange(e){Wr(e,e,this.changes)}}function Px(t,e,i){let s=new Ex;return Se.compare(t,e,i,s),s.changes}function Cx(t,e){for(let i=t;i&&i!=e;i=i.assignedSlot||i.parentNode)if(i.nodeType==1&&i.contentEditable=="false")return!0;return!1}function _x(t,e){let i=!1;return e&&t.iterChangedRanges((s,r)=>{s<e.to&&r>e.from&&(i=!0)}),i}class uc extends gi{constructor(e){super(),this.height=e}toDOM(){let e=document.createElement("div");return e.className="cm-gap",this.updateDOM(e),e}eq(e){return e.height==this.height}updateDOM(e){return e.style.height=this.height+"px",!0}get editable(){return!0}get estimatedHeight(){return this.height}ignoreEvent(){return!1}}function Rx(t,e,i=1){let s=t.charCategorizer(e),r=t.doc.lineAt(e),n=e-r.from;if(r.length==0)return X.cursor(e);n==0?i=1:n==r.length&&(i=-1);let a=n,o=n;i<0?a=Ot(r.text,n,!1):o=Ot(r.text,n);let l=s(r.text.slice(a,o));for(;a>0;){let c=Ot(r.text,a,!1);if(s(r.text.slice(c,a))!=l)break;a=c}for(;o<r.length;){let c=Ot(r.text,o);if(s(r.text.slice(o,c))!=l)break;o=c}return X.range(a+r.from,o+r.from)}function $x(t,e,i,s,r){let n=Math.round((s-e.left)*t.defaultCharacterWidth);if(t.lineWrapping&&i.height>t.defaultLineHeight*1.5){let o=t.viewState.heightOracle.textHeight,l=Math.floor((r-i.top-(t.defaultLineHeight-o)*.5)/o);n+=l*t.viewState.heightOracle.lineLength}let a=t.state.sliceDoc(i.from,i.to);return i.from+hh(a,n,t.state.tabSize)}function xh(t,e,i){let s=t.lineBlockAt(e);if(Array.isArray(s.type)){let r;for(let n of s.type){if(n.from>e)break;if(!(n.to<e)){if(n.from<e&&n.to>e)return n;(!r||n.type==yt.Text&&(r.type!=n.type||(i<0?n.from<e:n.to>e)))&&(r=n)}}return r||s}return s}function Ix(t,e,i,s){let r=xh(t,e.head,e.assoc||-1),n=!s||r.type!=yt.Text||!(t.lineWrapping||r.widgetLineBreaks)?null:t.coordsAtPos(e.assoc<0&&e.head>r.from?e.head-1:e.head);if(n){let a=t.dom.getBoundingClientRect(),o=t.textDirectionAt(r.from),l=t.posAtCoords({x:i==(o==Fe.LTR)?a.right-1:a.left+1,y:(n.top+n.bottom)/2});if(l!=null)return X.cursor(l,i?-1:1)}return X.cursor(i?r.to:r.from,i?-1:1)}function _p(t,e,i,s){let r=t.state.doc.lineAt(e.head),n=t.bidiSpans(r),a=t.textDirectionAt(r.from);for(let o=e,l=null;;){let c=ax(r,n,a,o,i),h=Nm;if(!c){if(r.number==(i?t.state.doc.lines:1))return o;h=`
`,r=t.state.doc.line(r.number+(i?1:-1)),n=t.bidiSpans(r),c=t.visualLineSide(r,!i)}if(l){if(!l(h))return o}else{if(!s)return c;l=s(h)}o=c}}function Qx(t,e,i){let s=t.state.charCategorizer(e),r=s(i);return n=>{let a=s(n);return r==Ki.Space&&(r=a),r==a}}function Ax(t,e,i,s){let r=e.head,n=i?1:-1;if(r==(i?t.state.doc.length:0))return X.cursor(r,e.assoc);let a=e.goalColumn,o,l=t.contentDOM.getBoundingClientRect(),c=t.coordsAtPos(r,e.assoc||-1),h=t.documentTop;if(c)a==null&&(a=c.left-l.left),o=n<0?c.top:c.bottom;else{let f=t.viewState.lineBlockAt(r);a==null&&(a=Math.min(l.right-l.left,t.defaultCharacterWidth*(r-f.from))),o=(n<0?f.top:f.bottom)+h}let d=l.left+a,u=s??t.viewState.heightOracle.textHeight>>1,p=kh(t,{x:d,y:o+u*n},!1,n);return X.cursor(p.pos,p.assoc,void 0,a)}function Gn(t,e,i){for(;;){let s=0;for(let r of t)r.between(e-1,e+1,(n,a,o)=>{if(e>n&&e<a){let l=s||i||(e-n<a-e?-1:1);e=l<0?n:a,s=l}});if(!s)return e}}function eO(t,e){let i=null;for(let s=0;s<e.ranges.length;s++){let r=e.ranges[s],n=null;if(r.empty){let a=Gn(t,r.from,0);a!=r.from&&(n=X.cursor(a,-1))}else{let a=Gn(t,r.from,-1),o=Gn(t,r.to,1);(a!=r.from||o!=r.to)&&(n=X.range(r.from==r.anchor?a:o,r.from==r.head?a:o))}n&&(i||(i=e.ranges.slice()),i[s]=n)}return i?X.create(i,e.mainIndex):e}function pc(t,e,i){let s=Gn(t.state.facet(ka).map(r=>r(t)),i.from,e.head>i.from?-1:1);return s==i.from?i:X.cursor(s,s<i.from?1:-1)}class Ci{constructor(e,i){this.pos=e,this.assoc=i}}function kh(t,e,i,s){let r=t.contentDOM.getBoundingClientRect(),n=r.top+t.viewState.paddingTop,{x:a,y:o}=e,l=o-n,c;for(;;){if(l<0)return new Ci(0,1);if(l>t.viewState.docHeight)return new Ci(t.state.doc.length,-1);if(c=t.elementAtHeight(l),s==null)break;if(c.type==yt.Text){let u=t.docView.coordsAt(s<0?c.from:c.to,s);if(u&&(s<0?u.top<=l+n:u.bottom>=l+n))break}let d=t.viewState.heightOracle.textHeight/2;l=s>0?c.bottom+d:c.top-d}if(t.viewport.from>=c.to||t.viewport.to<=c.from){if(i)return null;if(c.type==yt.Text){let d=$x(t,r,c,a,o);return new Ci(d,d==c.from?1:-1)}}if(c.type!=yt.Text)return l<(c.top+c.bottom)/2?new Ci(c.from,1):new Ci(c.to,-1);let h=t.docView.lineAt(c.from,2);return(!h||h.length!=c.length)&&(h=t.docView.lineAt(c.from,-2)),tO(t,h,c.from,a,o)}function tO(t,e,i,s,r){let n=-1,a=null,o=1e9,l=1e9,c=r,h=r,d=(u,p)=>{for(let f=0;f<u.length;f++){let g=u[f];if(g.top==g.bottom)continue;let m=g.left>s?g.left-s:g.right<s?s-g.right:0,y=g.top>r?g.top-r:g.bottom<r?r-g.bottom:0;g.top<=h&&g.bottom>=c&&(c=Math.min(g.top,c),h=Math.max(g.bottom,h),y=0),(n<0||(y-l||m-o)<0)&&(n>=0&&l&&o<m&&a.top<=h-2&&a.bottom>=c+2?l=0:(n=p,o=m,l=y,a=g))}};if(e.isText()){for(let p=0;p<e.length;){let f=Ot(e.text,p);if(d(da(e.dom,p,f).getClientRects(),p),!o&&!l)break;p=f}return s>(a.left+a.right)/2==(Rp(t,n+i)==Fe.LTR)?new Ci(i+Ot(e.text,n),-1):new Ci(i+n,1)}else{if(!e.length)return new Ci(i,1);for(let g=0;g<e.children.length;g++){let m=e.children[g];if(m.flags&48)continue;let y=(m.dom.nodeType==1?m.dom:da(m.dom,0,m.length)).getClientRects();if(d(y,g),!o&&!l)break}let u=e.children[n],p=e.posBefore(u,i);return u.isComposite()||u.isText()?tO(t,u,p,Math.max(a.left,Math.min(a.right,s)),r):s>(a.left+a.right)/2==(Rp(t,n+i)==Fe.LTR)?new Ci(p+u.length,-1):new Ci(p,1)}}function Rp(t,e){let i=t.state.doc.lineAt(e);return t.bidiSpans(i)[Ji.find(t.bidiSpans(i),e-i.from,-1,1)].dir}const Nn="ï¿¿";class Lx{constructor(e,i){this.points=e,this.view=i,this.text="",this.lineSeparator=i.state.facet(Pe.lineSeparator)}append(e){this.text+=e}lineBreak(){this.text+=Nn}readRange(e,i){if(!e)return this;let s=e.parentNode;for(let r=e;;){this.findPointBefore(s,r);let n=this.text.length;this.readNode(r);let a=tt.get(r),o=r.nextSibling;if(o==i){a!=null&&a.breakAfter&&!o&&s!=this.view.contentDOM&&this.lineBreak();break}let l=tt.get(o);(a&&l?a.breakAfter:(a?a.breakAfter:No(r))||No(o)&&(r.nodeName!="BR"||a!=null&&a.isWidget())&&this.text.length>n)&&!Mx(o,i)&&this.lineBreak(),r=o}return this.findPointBefore(s,i),this}readTextNode(e){let i=e.nodeValue;for(let s of this.points)s.node==e&&(s.pos=this.text.length+Math.min(s.offset,i.length));for(let s=0,r=this.lineSeparator?null:/\r\n?|\n/g;;){let n=-1,a=1,o;if(this.lineSeparator?(n=i.indexOf(this.lineSeparator,s),a=this.lineSeparator.length):(o=r.exec(i))&&(n=o.index,a=o[0].length),this.append(i.slice(s,n<0?i.length:n)),n<0)break;if(this.lineBreak(),a>1)for(let l of this.points)l.node==e&&l.pos>this.text.length&&(l.pos-=a-1);s=n+a}}readNode(e){let i=tt.get(e),s=i&&i.overrideDOMText;if(s!=null){this.findPointInside(e,s.length);for(let r=s.iter();!r.next().done;)r.lineBreak?this.lineBreak():this.append(r.value)}else e.nodeType==3?this.readTextNode(e):e.nodeName=="BR"?e.nextSibling&&this.lineBreak():e.nodeType==1&&this.readRange(e.firstChild,null)}findPointBefore(e,i){for(let s of this.points)s.node==e&&e.childNodes[s.offset]==i&&(s.pos=this.text.length)}findPointInside(e,i){for(let s of this.points)(e.nodeType==3?s.node==e:e.contains(s.node))&&(s.pos=this.text.length+(Nx(e,s.node,s.offset)?i:0))}}function Nx(t,e,i){for(;;){if(!e||i<es(e))return!1;if(e==t)return!0;i=Ts(e)+1,e=e.parentNode}}function Mx(t,e){let i;for(;!(t==e||!t);t=t.nextSibling){let s=tt.get(t);if(!(s!=null&&s.isWidget()))return!1;s&&(i||(i=[])).push(s)}if(i)for(let s of i){let r=s.overrideDOMText;if(r!=null&&r.length)return!1}return!0}class $p{constructor(e,i){this.node=e,this.offset=i,this.pos=-1}}class qx{constructor(e,i,s,r){this.typeOver=r,this.bounds=null,this.text="",this.domChanged=i>-1;let{impreciseHead:n,impreciseAnchor:a}=e.docView;if(e.state.readOnly&&i>-1)this.newSel=null;else if(i>-1&&(this.bounds=iO(e.docView.tile,i,s,0))){let o=n||a?[]:Bx(e),l=new Lx(o,e);l.readRange(this.bounds.startDOM,this.bounds.endDOM),this.text=l.text,this.newSel=jx(o,this.bounds.from)}else{let o=e.observer.selectionRange,l=n&&n.node==o.focusNode&&n.offset==o.focusOffset||!Oh(e.contentDOM,o.focusNode)?e.state.selection.main.head:e.docView.posFromDOM(o.focusNode,o.focusOffset),c=a&&a.node==o.anchorNode&&a.offset==o.anchorOffset||!Oh(e.contentDOM,o.anchorNode)?e.state.selection.main.anchor:e.docView.posFromDOM(o.anchorNode,o.anchorOffset),h=e.viewport;if((K.ios||K.chrome)&&e.state.selection.main.empty&&l!=c&&(h.from>0||h.to<e.state.doc.length)){let d=Math.min(l,c),u=Math.max(l,c),p=h.from-d,f=h.to-u;(p==0||p==1||d==0)&&(f==0||f==-1||u==e.state.doc.length)&&(l=0,c=e.state.doc.length)}e.inputState.composing>-1&&e.state.selection.ranges.length>1?this.newSel=e.state.selection.replaceRange(X.range(c,l)):this.newSel=X.single(c,l)}}}function iO(t,e,i,s){if(t.isComposite()){let r=-1,n=-1,a=-1,o=-1;for(let l=0,c=s,h=s;l<t.children.length;l++){let d=t.children[l],u=c+d.length;if(c<e&&u>i)return iO(d,e,i,c);if(u>=e&&r==-1&&(r=l,n=c),c>i&&d.dom.parentNode==t.dom){a=l,o=h;break}h=u,c=u+d.breakAfter}return{from:n,to:o<0?s+t.length:o,startDOM:(r?t.children[r-1].dom.nextSibling:null)||t.dom.firstChild,endDOM:a<t.children.length&&a>=0?t.children[a].dom:null}}else return t.isText()?{from:s,to:s+t.length,startDOM:t.dom,endDOM:t.dom.nextSibling}:null}function sO(t,e){let i,{newSel:s}=e,r=t.state.selection.main,n=t.inputState.lastKeyTime>Date.now()-100?t.inputState.lastKeyCode:-1;if(e.bounds){let{from:a,to:o}=e.bounds,l=r.from,c=null;(n===8||K.android&&e.text.length<o-a)&&(l=r.to,c="end");let h=rO(t.state.doc.sliceString(a,o,Nn),e.text,l-a,c);h&&(K.chrome&&n==13&&h.toB==h.from+2&&e.text.slice(h.from,h.toB)==Nn+Nn&&h.toB--,i={from:a+h.from,to:a+h.toA,insert:$e.of(e.text.slice(h.from,h.toB).split(Nn))})}else s&&(!t.hasFocus&&t.state.facet(Hi)||jo(s,r))&&(s=null);if(!i&&!s)return!1;if(!i&&e.typeOver&&!r.empty&&s&&s.main.empty?i={from:r.from,to:r.to,insert:t.state.doc.slice(r.from,r.to)}:(K.mac||K.android)&&i&&i.from==i.to&&i.from==r.head-1&&/^\. ?$/.test(i.insert.toString())&&t.contentDOM.getAttribute("autocorrect")=="off"?(s&&i.insert.length==2&&(s=X.single(s.main.anchor-1,s.main.head-1)),i={from:i.from,to:i.to,insert:$e.of([i.insert.toString().replace("."," ")])}):i&&i.from>=r.from&&i.to<=r.to&&(i.from!=r.from||i.to!=r.to)&&r.to-r.from-(i.to-i.from)<=4?i={from:r.from,to:r.to,insert:t.state.doc.slice(r.from,i.from).append(i.insert).append(t.state.doc.slice(i.to,r.to))}:t.state.doc.lineAt(r.from).to<r.to&&t.docView.lineHasWidget(r.to)&&t.inputState.insertingTextAt>Date.now()-50?i={from:r.from,to:r.to,insert:t.state.toText(t.inputState.insertingText)}:K.chrome&&i&&i.from==i.to&&i.from==r.head&&i.insert.toString()==`
 `&&t.lineWrapping&&(s&&(s=X.single(s.main.anchor-1,s.main.head-1)),i={from:r.from,to:r.to,insert:$e.of([" "])}),i)return Td(t,i,s,n);if(s&&!jo(s,r)){let a=!1,o="select";return t.inputState.lastSelectionTime>Date.now()-50&&(t.inputState.lastSelectionOrigin=="select"&&(a=!0),o=t.inputState.lastSelectionOrigin,o=="select.pointer"&&(s=eO(t.state.facet(ka).map(l=>l(t)),s))),t.dispatch({selection:s,scrollIntoView:a,userEvent:o}),!0}else return!1}function Td(t,e,i,s=-1){if(K.ios&&t.inputState.flushIOSKey(e))return!0;let r=t.state.selection.main;if(K.android&&(e.to==r.to&&(e.from==r.from||e.from==r.from-1&&t.state.sliceDoc(e.from,r.from)==" ")&&e.insert.length==1&&e.insert.lines==2&&Fr(t.contentDOM,"Enter",13)||(e.from==r.from-1&&e.to==r.to&&e.insert.length==0||s==8&&e.insert.length<e.to-e.from&&e.to>r.head)&&Fr(t.contentDOM,"Backspace",8)||e.from==r.from&&e.to==r.to+1&&e.insert.length==0&&Fr(t.contentDOM,"Delete",46)))return!0;let n=e.insert.toString();t.inputState.composing>=0&&t.inputState.composing++;let a,o=()=>a||(a=Dx(t,e,i));return t.state.facet(jm).some(l=>l(t,e.from,e.to,n,o))||t.dispatch(o()),!0}function Dx(t,e,i){let s,r=t.state,n=r.selection.main,a=-1;if(e.from==e.to&&e.from<n.from||e.from>n.to){let l=e.from<n.from?-1:1,c=l<0?n.from:n.to,h=Gn(r.facet(ka).map(d=>d(t)),c,l);e.from==h&&(a=h)}if(a>-1)s={changes:e,selection:X.cursor(e.from+e.insert.length,-1)};else if(e.from>=n.from&&e.to<=n.to&&e.to-e.from>=(n.to-n.from)/3&&(!i||i.main.empty&&i.main.from==e.from+e.insert.length)&&t.inputState.composing<0){let l=n.from<e.from?r.sliceDoc(n.from,e.from):"",c=n.to>e.to?r.sliceDoc(e.to,n.to):"";s=r.replaceSelection(t.state.toText(l+e.insert.sliceString(0,void 0,t.state.lineBreak)+c))}else{let l=r.changes(e),c=i&&i.main.to<=l.newLength?i.main:void 0;if(r.selection.ranges.length>1&&(t.inputState.composing>=0||t.inputState.compositionPendingChange)&&e.to<=n.to+10&&e.to>=n.to-10){let h=t.state.sliceDoc(e.from,e.to),d,u=i&&Jm(t,i.main.head);if(u){let f=e.insert.length-(e.to-e.from);d={from:u.from,to:u.to-f}}else d=t.state.doc.lineAt(n.head);let p=n.to-e.to;s=r.changeByRange(f=>{if(f.from==n.from&&f.to==n.to)return{changes:l,range:c||f.map(l)};let g=f.to-p,m=g-h.length;if(t.state.sliceDoc(m,g)!=h||g>=d.from&&m<=d.to)return{range:f};let y=r.changes({from:m,to:g,insert:e.insert}),b=f.to-n.to;return{changes:y,range:c?X.range(Math.max(0,c.anchor+b),Math.max(0,c.head+b)):f.map(y)}})}else s={changes:l,selection:c&&r.selection.replaceRange(c)}}let o="input.type";return(t.composing||t.inputState.compositionPendingChange&&t.inputState.compositionEndedAt>Date.now()-50)&&(t.inputState.compositionPendingChange=!1,o+=".compose",t.inputState.compositionFirstChange&&(o+=".start",t.inputState.compositionFirstChange=!1)),r.update(s,{userEvent:o,scrollIntoView:!0})}function rO(t,e,i,s){let r=Math.min(t.length,e.length),n=0;for(;n<r&&t.charCodeAt(n)==e.charCodeAt(n);)n++;if(n==r&&t.length==e.length)return null;let a=t.length,o=e.length;for(;a>0&&o>0&&t.charCodeAt(a-1)==e.charCodeAt(o-1);)a--,o--;if(s=="end"){let l=Math.max(0,n-Math.min(a,o));i-=a+l-n}if(a<n&&t.length<e.length){let l=i<=n&&i>=a?n-i:0;n-=l,o=n+(o-a),a=n}else if(o<n){let l=i<=n&&i>=o?n-i:0;n-=l,a=n+(a-o),o=n}return{from:n,toA:a,toB:o}}function Bx(t){let e=[];if(t.root.activeElement!=t.contentDOM)return e;let{anchorNode:i,anchorOffset:s,focusNode:r,focusOffset:n}=t.observer.selectionRange;return i&&(e.push(new $p(i,s)),(r!=i||n!=s)&&e.push(new $p(r,n))),e}function jx(t,e){if(t.length==0)return null;let i=t[0].pos,s=t.length==2?t[1].pos:i;return i>-1&&s>-1?X.single(i+e,s+e):null}function jo(t,e){return e.head==t.main.head&&e.anchor==t.main.anchor}class Wx{setSelectionOrigin(e){this.lastSelectionOrigin=e,this.lastSelectionTime=Date.now()}constructor(e){this.view=e,this.lastKeyCode=0,this.lastKeyTime=0,this.lastTouchTime=0,this.lastFocusTime=0,this.lastScrollTop=0,this.lastScrollLeft=0,this.pendingIOSKey=void 0,this.tabFocusMode=-1,this.lastSelectionOrigin=null,this.lastSelectionTime=0,this.lastContextMenu=0,this.scrollHandlers=[],this.handlers=Object.create(null),this.composing=-1,this.compositionFirstChange=null,this.compositionEndedAt=0,this.compositionPendingKey=!1,this.compositionPendingChange=!1,this.insertingText="",this.insertingTextAt=0,this.mouseSelection=null,this.draggedContent=null,this.handleEvent=this.handleEvent.bind(this),this.notifiedFocused=e.hasFocus,K.safari&&e.contentDOM.addEventListener("input",()=>null),K.gecko&&sk(e.contentDOM.ownerDocument)}handleEvent(e){!Zx(this.view,e)||this.ignoreDuringComposition(e)||e.type=="keydown"&&this.keydown(e)||(this.view.updateState!=0?Promise.resolve().then(()=>this.runHandlers(e.type,e)):this.runHandlers(e.type,e))}runHandlers(e,i){let s=this.handlers[e];if(s){for(let r of s.observers)r(this.view,i);for(let r of s.handlers){if(i.defaultPrevented)break;if(r(this.view,i)){i.preventDefault();break}}}}ensureHandlers(e){let i=Fx(e),s=this.handlers,r=this.view.contentDOM;for(let n in i)if(n!="scroll"){let a=!i[n].handlers.length,o=s[n];o&&a!=!o.handlers.length&&(r.removeEventListener(n,this.handleEvent),o=null),o||r.addEventListener(n,this.handleEvent,{passive:a})}for(let n in s)n!="scroll"&&!i[n]&&r.removeEventListener(n,this.handleEvent);this.handlers=i}keydown(e){if(this.lastKeyCode=e.keyCode,this.lastKeyTime=Date.now(),e.keyCode==9&&this.tabFocusMode>-1&&(!this.tabFocusMode||Date.now()<=this.tabFocusMode))return!0;if(this.tabFocusMode>0&&e.keyCode!=27&&aO.indexOf(e.keyCode)<0&&(this.tabFocusMode=-1),K.android&&K.chrome&&!e.synthetic&&(e.keyCode==13||e.keyCode==8))return this.view.observer.delayAndroidKey(e.key,e.keyCode),!0;let i;return K.ios&&!e.synthetic&&!e.altKey&&!e.metaKey&&((i=nO.find(s=>s.keyCode==e.keyCode))&&!e.ctrlKey||Ux.indexOf(e.key)>-1&&e.ctrlKey&&!e.shiftKey)?(this.pendingIOSKey=i||e,setTimeout(()=>this.flushIOSKey(),250),!0):(e.keyCode!=229&&this.view.observer.forceFlush(),!1)}flushIOSKey(e){let i=this.pendingIOSKey;return!i||i.key=="Enter"&&e&&e.from<e.to&&/^\S+$/.test(e.insert.toString())?!1:(this.pendingIOSKey=void 0,Fr(this.view.contentDOM,i.key,i.keyCode,i instanceof KeyboardEvent?i:void 0))}ignoreDuringComposition(e){return!/^key/.test(e.type)||e.synthetic?!1:this.composing>0?!0:K.safari&&!K.ios&&this.compositionPendingKey&&Date.now()-this.compositionEndedAt<100?(this.compositionPendingKey=!1,!0):!1}startMouseSelection(e){this.mouseSelection&&this.mouseSelection.destroy(),this.mouseSelection=e}update(e){this.view.observer.update(e),this.mouseSelection&&this.mouseSelection.update(e),this.draggedContent&&e.docChanged&&(this.draggedContent=this.draggedContent.map(e.changes)),e.transactions.length&&(this.lastKeyCode=this.lastSelectionTime=0)}destroy(){this.mouseSelection&&this.mouseSelection.destroy()}}function Ip(t,e){return(i,s)=>{try{return e.call(t,s,i)}catch(r){_i(i.state,r)}}}function Fx(t){let e=Object.create(null);function i(s){return e[s]||(e[s]={observers:[],handlers:[]})}for(let s of t){let r=s.spec,n=r&&r.plugin.domEventHandlers,a=r&&r.plugin.domEventObservers;if(n)for(let o in n){let l=n[o];l&&i(o).handlers.push(Ip(s.value,l))}if(a)for(let o in a){let l=a[o];l&&i(o).observers.push(Ip(s.value,l))}}for(let s in fi)i(s).handlers.push(fi[s]);for(let s in ii)i(s).observers.push(ii[s]);return e}const nO=[{key:"Backspace",keyCode:8,inputType:"deleteContentBackward"},{key:"Enter",keyCode:13,inputType:"insertParagraph"},{key:"Enter",keyCode:13,inputType:"insertLineBreak"},{key:"Delete",keyCode:46,inputType:"deleteContentForward"}],Ux="dthko",aO=[16,17,18,20,91,92,224,225],eo=6;function to(t){return Math.max(0,t)*.7+8}function Vx(t,e){return Math.max(Math.abs(t.clientX-e.clientX),Math.abs(t.clientY-e.clientY))}class zx{constructor(e,i,s,r){this.view=e,this.startEvent=i,this.style=s,this.mustSelect=r,this.scrollSpeed={x:0,y:0},this.scrolling=-1,this.lastEvent=i,this.scrollParents=Y1(e.contentDOM),this.atoms=e.state.facet(ka).map(a=>a(e));let n=e.contentDOM.ownerDocument;n.addEventListener("mousemove",this.move=this.move.bind(this)),n.addEventListener("mouseup",this.up=this.up.bind(this)),this.extend=i.shiftKey,this.multiple=e.state.facet(Pe.allowMultipleSelections)&&Xx(e,i),this.dragging=Yx(e,i)&&cO(i)==1?null:!1}start(e){this.dragging===!1&&this.select(e)}move(e){if(e.buttons==0)return this.destroy();if(this.dragging||this.dragging==null&&Vx(this.startEvent,e)<10)return;this.select(this.lastEvent=e);let i=0,s=0,r=0,n=0,a=this.view.win.innerWidth,o=this.view.win.innerHeight;this.scrollParents.x&&({left:r,right:a}=this.scrollParents.x.getBoundingClientRect()),this.scrollParents.y&&({top:n,bottom:o}=this.scrollParents.y.getBoundingClientRect());let l=Hm(this.view);e.clientX-l.left<=r+eo?i=-to(r-e.clientX):e.clientX+l.right>=a-eo&&(i=to(e.clientX-a)),e.clientY-l.top<=n+eo?s=-to(n-e.clientY):e.clientY+l.bottom>=o-eo&&(s=to(e.clientY-o)),this.setScrollSpeed(i,s)}up(e){this.dragging==null&&this.select(this.lastEvent),this.dragging||e.preventDefault(),this.destroy()}destroy(){this.setScrollSpeed(0,0);let e=this.view.contentDOM.ownerDocument;e.removeEventListener("mousemove",this.move),e.removeEventListener("mouseup",this.up),this.view.inputState.mouseSelection=this.view.inputState.draggedContent=null}setScrollSpeed(e,i){this.scrollSpeed={x:e,y:i},e||i?this.scrolling<0&&(this.scrolling=setInterval(()=>this.scroll(),50)):this.scrolling>-1&&(clearInterval(this.scrolling),this.scrolling=-1)}scroll(){let{x:e,y:i}=this.scrollSpeed;e&&this.scrollParents.x&&(this.scrollParents.x.scrollLeft+=e,e=0),i&&this.scrollParents.y&&(this.scrollParents.y.scrollTop+=i,i=0),(e||i)&&this.view.win.scrollBy(e,i),this.dragging===!1&&this.select(this.lastEvent)}select(e){let{view:i}=this,s=eO(this.atoms,this.style.get(e,this.extend,this.multiple));(this.mustSelect||!s.eq(i.state.selection,this.dragging===!1))&&this.view.dispatch({selection:s,userEvent:"select.pointer"}),this.mustSelect=!1}update(e){e.transactions.some(i=>i.isUserEvent("input.type"))?this.destroy():this.style.update(e)&&setTimeout(()=>this.select(this.lastEvent),20)}}function Xx(t,e){let i=t.state.facet(Mm);return i.length?i[0](e):K.mac?e.metaKey:e.ctrlKey}function Gx(t,e){let i=t.state.facet(qm);return i.length?i[0](e):K.mac?!e.altKey:!e.ctrlKey}function Yx(t,e){let{main:i}=t.state.selection;if(i.empty)return!1;let s=Yr(t.root);if(!s||s.rangeCount==0)return!0;let r=s.getRangeAt(0).getClientRects();for(let n=0;n<r.length;n++){let a=r[n];if(a.left<=e.clientX&&a.right>=e.clientX&&a.top<=e.clientY&&a.bottom>=e.clientY)return!0}return!1}function Zx(t,e){if(!e.bubbles)return!0;if(e.defaultPrevented)return!1;for(let i=e.target,s;i!=t.contentDOM;i=i.parentNode)if(!i||i.nodeType==11||(s=tt.get(i))&&s.isWidget()&&!s.isHidden&&s.widget.ignoreEvent(e))return!1;return!0}const fi=Object.create(null),ii=Object.create(null),oO=K.ie&&K.ie_version<15||K.ios&&K.webkit_version<604;function Hx(t){let e=t.dom.parentNode;if(!e)return;let i=e.appendChild(document.createElement("textarea"));i.style.cssText="position: fixed; left: -10000px; top: 10px",i.focus(),setTimeout(()=>{t.focus(),i.remove(),lO(t,i.value)},50)}function ml(t,e,i){for(let s of t.facet(e))i=s(i,t);return i}function lO(t,e){e=ml(t.state,wd,e);let{state:i}=t,s,r=1,n=i.toText(e),a=n.lines==i.selection.ranges.length;if(Th!=null&&i.selection.ranges.every(l=>l.empty)&&Th==n.toString()){let l=-1;s=i.changeByRange(c=>{let h=i.doc.lineAt(c.from);if(h.from==l)return{range:c};l=h.from;let d=i.toText((a?n.line(r++).text:e)+i.lineBreak);return{changes:{from:h.from,insert:d},range:X.cursor(c.from+d.length)}})}else a?s=i.changeByRange(l=>{let c=n.line(r++);return{changes:{from:l.from,to:l.to,insert:c.text},range:X.cursor(l.from+c.length)}}):s=i.replaceSelection(n);t.dispatch(s,{userEvent:"input.paste",scrollIntoView:!0})}ii.scroll=t=>{t.inputState.lastScrollTop=t.scrollDOM.scrollTop,t.inputState.lastScrollLeft=t.scrollDOM.scrollLeft};fi.keydown=(t,e)=>(t.inputState.setSelectionOrigin("select"),e.keyCode==27&&t.inputState.tabFocusMode!=0&&(t.inputState.tabFocusMode=Date.now()+2e3),!1);ii.touchstart=(t,e)=>{t.inputState.lastTouchTime=Date.now(),t.inputState.setSelectionOrigin("select.pointer")};ii.touchmove=t=>{t.inputState.setSelectionOrigin("select.pointer")};fi.mousedown=(t,e)=>{if(t.observer.flush(),t.inputState.lastTouchTime>Date.now()-2e3)return!1;let i=null;for(let s of t.state.facet(Dm))if(i=s(t,e),i)break;if(!i&&e.button==0&&(i=Jx(t,e)),i){let s=!t.hasFocus;t.inputState.startMouseSelection(new zx(t,e,i,s)),s&&t.observer.ignore(()=>{Cm(t.contentDOM);let n=t.root.activeElement;n&&!n.contains(t.contentDOM)&&n.blur()});let r=t.inputState.mouseSelection;if(r)return r.start(e),r.dragging===!1}else t.inputState.setSelectionOrigin("select.pointer");return!1};function Qp(t,e,i,s){if(s==1)return X.cursor(e,i);if(s==2)return Rx(t.state,e,i);{let r=t.docView.lineAt(e,i),n=t.state.doc.lineAt(r?r.posAtEnd:e),a=r?r.posAtStart:n.from,o=r?r.posAtEnd:n.to;return o<t.state.doc.length&&o==n.to&&o++,X.range(a,o)}}const Kx=K.ie&&K.ie_version<=11;let Ap=null,Lp=0,Np=0;function cO(t){if(!Kx)return t.detail;let e=Ap,i=Np;return Ap=t,Np=Date.now(),Lp=!e||i>Date.now()-400&&Math.abs(e.clientX-t.clientX)<2&&Math.abs(e.clientY-t.clientY)<2?(Lp+1)%3:1}function Jx(t,e){let i=t.posAndSideAtCoords({x:e.clientX,y:e.clientY},!1),s=cO(e),r=t.state.selection;return{update(n){n.docChanged&&(i.pos=n.changes.mapPos(i.pos),r=r.map(n.changes))},get(n,a,o){let l=t.posAndSideAtCoords({x:n.clientX,y:n.clientY},!1),c,h=Qp(t,l.pos,l.assoc,s);if(i.pos!=l.pos&&!a){let d=Qp(t,i.pos,i.assoc,s),u=Math.min(d.from,h.from),p=Math.max(d.to,h.to);h=u<h.from?X.range(u,p):X.range(p,u)}return a?r.replaceRange(r.main.extend(h.from,h.to)):o&&s==1&&r.ranges.length>1&&(c=ek(r,l.pos))?c:o?r.addRange(h):X.create([h])}}}function ek(t,e){for(let i=0;i<t.ranges.length;i++){let{from:s,to:r}=t.ranges[i];if(s<=e&&r>=e)return X.create(t.ranges.slice(0,i).concat(t.ranges.slice(i+1)),t.mainIndex==i?0:t.mainIndex-(t.mainIndex>i?1:0))}return null}fi.dragstart=(t,e)=>{let{selection:{main:i}}=t.state;if(e.target.draggable){let r=t.docView.tile.nearest(e.target);if(r&&r.isWidget()){let n=r.posAtStart,a=n+r.length;(n>=i.to||a<=i.from)&&(i=X.range(n,a))}}let{inputState:s}=t;return s.mouseSelection&&(s.mouseSelection.dragging=!0),s.draggedContent=i,e.dataTransfer&&(e.dataTransfer.setData("Text",ml(t.state,Sd,t.state.sliceDoc(i.from,i.to))),e.dataTransfer.effectAllowed="copyMove"),!1};fi.dragend=t=>(t.inputState.draggedContent=null,!1);function Mp(t,e,i,s){if(i=ml(t.state,wd,i),!i)return;let r=t.posAtCoords({x:e.clientX,y:e.clientY},!1),{draggedContent:n}=t.inputState,a=s&&n&&Gx(t,e)?{from:n.from,to:n.to}:null,o={from:r,insert:i},l=t.state.changes(a?[a,o]:o);t.focus(),t.dispatch({changes:l,selection:{anchor:l.mapPos(r,-1),head:l.mapPos(r,1)},userEvent:a?"move.drop":"input.drop"}),t.inputState.draggedContent=null}fi.drop=(t,e)=>{if(!e.dataTransfer)return!1;if(t.state.readOnly)return!0;let i=e.dataTransfer.files;if(i&&i.length){let s=Array(i.length),r=0,n=()=>{++r==i.length&&Mp(t,e,s.filter(a=>a!=null).join(t.state.lineBreak),!1)};for(let a=0;a<i.length;a++){let o=new FileReader;o.onerror=n,o.onload=()=>{/[\x00-\x08\x0e-\x1f]{2}/.test(o.result)||(s[a]=o.result),n()},o.readAsText(i[a])}return!0}else{let s=e.dataTransfer.getData("Text");if(s)return Mp(t,e,s,!0),!0}return!1};fi.paste=(t,e)=>{if(t.state.readOnly)return!0;t.observer.flush();let i=oO?null:e.clipboardData;return i?(lO(t,i.getData("text/plain")||i.getData("text/uri-list")),!0):(Hx(t),!1)};function tk(t,e){let i=t.dom.parentNode;if(!i)return;let s=i.appendChild(document.createElement("textarea"));s.style.cssText="position: fixed; left: -10000px; top: 10px",s.value=e,s.focus(),s.selectionEnd=e.length,s.selectionStart=0,setTimeout(()=>{s.remove(),t.focus()},50)}function ik(t){let e=[],i=[],s=!1;for(let r of t.selection.ranges)r.empty||(e.push(t.sliceDoc(r.from,r.to)),i.push(r));if(!e.length){let r=-1;for(let{from:n}of t.selection.ranges){let a=t.doc.lineAt(n);a.number>r&&(e.push(a.text),i.push({from:a.from,to:Math.min(t.doc.length,a.to+1)})),r=a.number}s=!0}return{text:ml(t,Sd,e.join(t.lineBreak)),ranges:i,linewise:s}}let Th=null;fi.copy=fi.cut=(t,e)=>{let i=Yr(t.root);if(i&&!zn(t.contentDOM,i))return!1;let{text:s,ranges:r,linewise:n}=ik(t.state);if(!s&&!n)return!1;Th=n?s:null,e.type=="cut"&&!t.state.readOnly&&t.dispatch({changes:r,scrollIntoView:!0,userEvent:"delete.cut"});let a=oO?null:e.clipboardData;return a?(a.clearData(),a.setData("text/plain",s),!0):(tk(t,s),!1)};const hO=ns.define();function dO(t,e){let i=[];for(let s of t.facet(Wm)){let r=s(t,e);r&&i.push(r)}return i.length?t.update({effects:i,annotations:hO.of(!0)}):null}function uO(t){setTimeout(()=>{let e=t.hasFocus;if(e!=t.inputState.notifiedFocused){let i=dO(t.state,e);i?t.dispatch(i):t.update([])}},10)}ii.focus=t=>{t.inputState.lastFocusTime=Date.now(),!t.scrollDOM.scrollTop&&(t.inputState.lastScrollTop||t.inputState.lastScrollLeft)&&(t.scrollDOM.scrollTop=t.inputState.lastScrollTop,t.scrollDOM.scrollLeft=t.inputState.lastScrollLeft),uO(t)};ii.blur=t=>{t.observer.clearSelectionRange(),uO(t)};ii.compositionstart=ii.compositionupdate=t=>{t.observer.editContext||(t.inputState.compositionFirstChange==null&&(t.inputState.compositionFirstChange=!0),t.inputState.composing<0&&(t.inputState.composing=0))};ii.compositionend=t=>{t.observer.editContext||(t.inputState.composing=-1,t.inputState.compositionEndedAt=Date.now(),t.inputState.compositionPendingKey=!0,t.inputState.compositionPendingChange=t.observer.pendingRecords().length>0,t.inputState.compositionFirstChange=null,K.chrome&&K.android?t.observer.flushSoon():t.inputState.compositionPendingChange?Promise.resolve().then(()=>t.observer.flush()):setTimeout(()=>{t.inputState.composing<0&&t.docView.hasComposition&&t.update([])},50))};ii.contextmenu=t=>{t.inputState.lastContextMenu=Date.now()};fi.beforeinput=(t,e)=>{var i,s;if((e.inputType=="insertText"||e.inputType=="insertCompositionText")&&(t.inputState.insertingText=e.data,t.inputState.insertingTextAt=Date.now()),e.inputType=="insertReplacementText"&&t.observer.editContext){let n=(i=e.dataTransfer)===null||i===void 0?void 0:i.getData("text/plain"),a=e.getTargetRanges();if(n&&a.length){let o=a[0],l=t.posAtDOM(o.startContainer,o.startOffset),c=t.posAtDOM(o.endContainer,o.endOffset);return Td(t,{from:l,to:c,insert:t.state.toText(n)},null),!0}}let r;if(K.chrome&&K.android&&(r=nO.find(n=>n.inputType==e.inputType))&&(t.observer.delayAndroidKey(r.key,r.keyCode),r.key=="Backspace"||r.key=="Delete")){let n=((s=window.visualViewport)===null||s===void 0?void 0:s.height)||0;setTimeout(()=>{var a;(((a=window.visualViewport)===null||a===void 0?void 0:a.height)||0)>n+10&&t.hasFocus&&(t.contentDOM.blur(),t.focus())},100)}return K.ios&&e.inputType=="deleteContentForward"&&t.observer.flushSoon(),K.safari&&e.inputType=="insertText"&&t.inputState.composing>=0&&setTimeout(()=>ii.compositionend(t,e),20),!1};const qp=new Set;function sk(t){qp.has(t)||(qp.add(t),t.addEventListener("copy",()=>{}),t.addEventListener("cut",()=>{}))}const Dp=["pre-wrap","normal","pre-line","break-spaces"];let Kr=!1;function Bp(){Kr=!1}class rk{constructor(e){this.lineWrapping=e,this.doc=$e.empty,this.heightSamples={},this.lineHeight=14,this.charWidth=7,this.textHeight=14,this.lineLength=30}heightForGap(e,i){let s=this.doc.lineAt(i).number-this.doc.lineAt(e).number+1;return this.lineWrapping&&(s+=Math.max(0,Math.ceil((i-e-s*this.lineLength*.5)/this.lineLength))),this.lineHeight*s}heightForLine(e){return this.lineWrapping?(1+Math.max(0,Math.ceil((e-this.lineLength)/Math.max(1,this.lineLength-5))))*this.lineHeight:this.lineHeight}setDoc(e){return this.doc=e,this}mustRefreshForWrapping(e){return Dp.indexOf(e)>-1!=this.lineWrapping}mustRefreshForHeights(e){let i=!1;for(let s=0;s<e.length;s++){let r=e[s];r<0?s++:this.heightSamples[Math.floor(r*10)]||(i=!0,this.heightSamples[Math.floor(r*10)]=!0)}return i}refresh(e,i,s,r,n,a){let o=Dp.indexOf(e)>-1,l=Math.abs(i-this.lineHeight)>.3||this.lineWrapping!=o||Math.abs(s-this.charWidth)>.1;if(this.lineWrapping=o,this.lineHeight=i,this.charWidth=s,this.textHeight=r,this.lineLength=n,l){this.heightSamples={};for(let c=0;c<a.length;c++){let h=a[c];h<0?c++:this.heightSamples[Math.floor(h*10)]=!0}}return l}}class nk{constructor(e,i){this.from=e,this.heights=i,this.index=0}get more(){return this.index<this.heights.length}}class di{constructor(e,i,s,r,n){this.from=e,this.length=i,this.top=s,this.height=r,this._content=n}get type(){return typeof this._content=="number"?yt.Text:Array.isArray(this._content)?this._content:this._content.type}get to(){return this.from+this.length}get bottom(){return this.top+this.height}get widget(){return this._content instanceof rr?this._content.widget:null}get widgetLineBreaks(){return typeof this._content=="number"?this._content:0}join(e){let i=(Array.isArray(this._content)?this._content:[this]).concat(Array.isArray(e._content)?e._content:[e]);return new di(this.from,this.length+e.length,this.top,this.height+e.height,i)}}var Me=function(t){return t[t.ByPos=0]="ByPos",t[t.ByHeight=1]="ByHeight",t[t.ByPosNoHeight=2]="ByPosNoHeight",t}(Me||(Me={}));const wo=.001;class _t{constructor(e,i,s=2){this.length=e,this.height=i,this.flags=s}get outdated(){return(this.flags&2)>0}set outdated(e){this.flags=(e?2:0)|this.flags&-3}setHeight(e){this.height!=e&&(Math.abs(this.height-e)>wo&&(Kr=!0),this.height=e)}replace(e,i,s){return _t.of(s)}decomposeLeft(e,i){i.push(this)}decomposeRight(e,i){i.push(this)}applyChanges(e,i,s,r){let n=this,a=s.doc;for(let o=r.length-1;o>=0;o--){let{fromA:l,toA:c,fromB:h,toB:d}=r[o],u=n.lineAt(l,Me.ByPosNoHeight,s.setDoc(i),0,0),p=u.to>=c?u:n.lineAt(c,Me.ByPosNoHeight,s,0,0);for(d+=p.to-c,c=p.to;o>0&&u.from<=r[o-1].toA;)l=r[o-1].fromA,h=r[o-1].fromB,o--,l<u.from&&(u=n.lineAt(l,Me.ByPosNoHeight,s,0,0));h+=u.from-l,l=u.from;let f=Ed.build(s.setDoc(a),e,h,d);n=Wo(n,n.replace(l,c,f))}return n.updateHeight(s,0)}static empty(){return new Ut(0,0,0)}static of(e){if(e.length==1)return e[0];let i=0,s=e.length,r=0,n=0;for(;;)if(i==s)if(r>n*2){let o=e[i-1];o.break?e.splice(--i,1,o.left,null,o.right):e.splice(--i,1,o.left,o.right),s+=1+o.break,r-=o.size}else if(n>r*2){let o=e[s];o.break?e.splice(s,1,o.left,null,o.right):e.splice(s,1,o.left,o.right),s+=2+o.break,n-=o.size}else break;else if(r<n){let o=e[i++];o&&(r+=o.size)}else{let o=e[--s];o&&(n+=o.size)}let a=0;return e[i-1]==null?(a=1,i--):e[i]==null&&(a=1,s++),new ok(_t.of(e.slice(0,i)),a,_t.of(e.slice(s)))}}function Wo(t,e){return t==e?t:(t.constructor!=e.constructor&&(Kr=!0),e)}_t.prototype.size=1;const ak=fe.replace({});class pO extends _t{constructor(e,i,s){super(e,i),this.deco=s,this.spaceAbove=0}mainBlock(e,i){return new di(i,this.length,e+this.spaceAbove,this.height-this.spaceAbove,this.deco||0)}blockAt(e,i,s,r){return this.spaceAbove&&e<s+this.spaceAbove?new di(r,0,s,this.spaceAbove,ak):this.mainBlock(s,r)}lineAt(e,i,s,r,n){let a=this.mainBlock(r,n);return this.spaceAbove?this.blockAt(0,s,r,n).join(a):a}forEachLine(e,i,s,r,n,a){e<=n+this.length&&i>=n&&a(this.lineAt(0,Me.ByPos,s,r,n))}setMeasuredHeight(e){let i=e.heights[e.index++];i<0?(this.spaceAbove=-i,i=e.heights[e.index++]):this.spaceAbove=0,this.setHeight(i)}updateHeight(e,i=0,s=!1,r){return r&&r.from<=i&&r.more&&this.setMeasuredHeight(r),this.outdated=!1,this}toString(){return`block(${this.length})`}}class Ut extends pO{constructor(e,i,s){super(e,i,null),this.collapsed=0,this.widgetHeight=0,this.breaks=0,this.spaceAbove=s}mainBlock(e,i){return new di(i,this.length,e+this.spaceAbove,this.height-this.spaceAbove,this.breaks)}replace(e,i,s){let r=s[0];return s.length==1&&(r instanceof Ut||r instanceof ft&&r.flags&4)&&Math.abs(this.length-r.length)<10?(r instanceof ft?r=new Ut(r.length,this.height,this.spaceAbove):r.height=this.height,this.outdated||(r.outdated=!1),r):_t.of(s)}updateHeight(e,i=0,s=!1,r){return r&&r.from<=i&&r.more?this.setMeasuredHeight(r):(s||this.outdated)&&(this.spaceAbove=0,this.setHeight(Math.max(this.widgetHeight,e.heightForLine(this.length-this.collapsed))+this.breaks*e.lineHeight)),this.outdated=!1,this}toString(){return`line(${this.length}${this.collapsed?-this.collapsed:""}${this.widgetHeight?":"+this.widgetHeight:""})`}}class ft extends _t{constructor(e){super(e,0)}heightMetrics(e,i){let s=e.doc.lineAt(i).number,r=e.doc.lineAt(i+this.length).number,n=r-s+1,a,o=0;if(e.lineWrapping){let l=Math.min(this.height,e.lineHeight*n);a=l/n,this.length>n+1&&(o=(this.height-l)/(this.length-n-1))}else a=this.height/n;return{firstLine:s,lastLine:r,perLine:a,perChar:o}}blockAt(e,i,s,r){let{firstLine:n,lastLine:a,perLine:o,perChar:l}=this.heightMetrics(i,r);if(i.lineWrapping){let c=r+(e<i.lineHeight?0:Math.round(Math.max(0,Math.min(1,(e-s)/this.height))*this.length)),h=i.doc.lineAt(c),d=o+h.length*l,u=Math.max(s,e-d/2);return new di(h.from,h.length,u,d,0)}else{let c=Math.max(0,Math.min(a-n,Math.floor((e-s)/o))),{from:h,length:d}=i.doc.line(n+c);return new di(h,d,s+o*c,o,0)}}lineAt(e,i,s,r,n){if(i==Me.ByHeight)return this.blockAt(e,s,r,n);if(i==Me.ByPosNoHeight){let{from:p,to:f}=s.doc.lineAt(e);return new di(p,f-p,0,0,0)}let{firstLine:a,perLine:o,perChar:l}=this.heightMetrics(s,n),c=s.doc.lineAt(e),h=o+c.length*l,d=c.number-a,u=r+o*d+l*(c.from-n-d);return new di(c.from,c.length,Math.max(r,Math.min(u,r+this.height-h)),h,0)}forEachLine(e,i,s,r,n,a){e=Math.max(e,n),i=Math.min(i,n+this.length);let{firstLine:o,perLine:l,perChar:c}=this.heightMetrics(s,n);for(let h=e,d=r;h<=i;){let u=s.doc.lineAt(h);if(h==e){let f=u.number-o;d+=l*f+c*(e-n-f)}let p=l+c*u.length;a(new di(u.from,u.length,d,p,0)),d+=p,h=u.to+1}}replace(e,i,s){let r=this.length-i;if(r>0){let n=s[s.length-1];n instanceof ft?s[s.length-1]=new ft(n.length+r):s.push(null,new ft(r-1))}if(e>0){let n=s[0];n instanceof ft?s[0]=new ft(e+n.length):s.unshift(new ft(e-1),null)}return _t.of(s)}decomposeLeft(e,i){i.push(new ft(e-1),null)}decomposeRight(e,i){i.push(null,new ft(this.length-e-1))}updateHeight(e,i=0,s=!1,r){let n=i+this.length;if(r&&r.from<=i+this.length&&r.more){let a=[],o=Math.max(i,r.from),l=-1;for(r.from>i&&a.push(new ft(r.from-i-1).updateHeight(e,i));o<=n&&r.more;){let h=e.doc.lineAt(o).length;a.length&&a.push(null);let d=r.heights[r.index++],u=0;d<0&&(u=-d,d=r.heights[r.index++]),l==-1?l=d:Math.abs(d-l)>=wo&&(l=-2);let p=new Ut(h,d,u);p.outdated=!1,a.push(p),o+=h+1}o<=n&&a.push(null,new ft(n-o).updateHeight(e,o));let c=_t.of(a);return(l<0||Math.abs(c.height-this.height)>=wo||Math.abs(l-this.heightMetrics(e,i).perLine)>=wo)&&(Kr=!0),Wo(this,c)}else(s||this.outdated)&&(this.setHeight(e.heightForGap(i,i+this.length)),this.outdated=!1);return this}toString(){return`gap(${this.length})`}}class ok extends _t{constructor(e,i,s){super(e.length+i+s.length,e.height+s.height,i|(e.outdated||s.outdated?2:0)),this.left=e,this.right=s,this.size=e.size+s.size}get break(){return this.flags&1}blockAt(e,i,s,r){let n=s+this.left.height;return e<n?this.left.blockAt(e,i,s,r):this.right.blockAt(e,i,n,r+this.left.length+this.break)}lineAt(e,i,s,r,n){let a=r+this.left.height,o=n+this.left.length+this.break,l=i==Me.ByHeight?e<a:e<o,c=l?this.left.lineAt(e,i,s,r,n):this.right.lineAt(e,i,s,a,o);if(this.break||(l?c.to<o:c.from>o))return c;let h=i==Me.ByPosNoHeight?Me.ByPosNoHeight:Me.ByPos;return l?c.join(this.right.lineAt(o,h,s,a,o)):this.left.lineAt(o,h,s,r,n).join(c)}forEachLine(e,i,s,r,n,a){let o=r+this.left.height,l=n+this.left.length+this.break;if(this.break)e<l&&this.left.forEachLine(e,i,s,r,n,a),i>=l&&this.right.forEachLine(e,i,s,o,l,a);else{let c=this.lineAt(l,Me.ByPos,s,r,n);e<c.from&&this.left.forEachLine(e,c.from-1,s,r,n,a),c.to>=e&&c.from<=i&&a(c),i>c.to&&this.right.forEachLine(c.to+1,i,s,o,l,a)}}replace(e,i,s){let r=this.left.length+this.break;if(i<r)return this.balanced(this.left.replace(e,i,s),this.right);if(e>this.left.length)return this.balanced(this.left,this.right.replace(e-r,i-r,s));let n=[];e>0&&this.decomposeLeft(e,n);let a=n.length;for(let o of s)n.push(o);if(e>0&&jp(n,a-1),i<this.length){let o=n.length;this.decomposeRight(i,n),jp(n,o)}return _t.of(n)}decomposeLeft(e,i){let s=this.left.length;if(e<=s)return this.left.decomposeLeft(e,i);i.push(this.left),this.break&&(s++,e>=s&&i.push(null)),e>s&&this.right.decomposeLeft(e-s,i)}decomposeRight(e,i){let s=this.left.length,r=s+this.break;if(e>=r)return this.right.decomposeRight(e-r,i);e<s&&this.left.decomposeRight(e,i),this.break&&e<r&&i.push(null),i.push(this.right)}balanced(e,i){return e.size>2*i.size||i.size>2*e.size?_t.of(this.break?[e,null,i]:[e,i]):(this.left=Wo(this.left,e),this.right=Wo(this.right,i),this.setHeight(e.height+i.height),this.outdated=e.outdated||i.outdated,this.size=e.size+i.size,this.length=e.length+this.break+i.length,this)}updateHeight(e,i=0,s=!1,r){let{left:n,right:a}=this,o=i+n.length+this.break,l=null;return r&&r.from<=i+n.length&&r.more?l=n=n.updateHeight(e,i,s,r):n.updateHeight(e,i,s),r&&r.from<=o+a.length&&r.more?l=a=a.updateHeight(e,o,s,r):a.updateHeight(e,o,s),l?this.balanced(n,a):(this.height=this.left.height+this.right.height,this.outdated=!1,this)}toString(){return this.left+(this.break?" ":"-")+this.right}}function jp(t,e){let i,s;t[e]==null&&(i=t[e-1])instanceof ft&&(s=t[e+1])instanceof ft&&t.splice(e-1,3,new ft(i.length+1+s.length))}const lk=5;class Ed{constructor(e,i){this.pos=e,this.oracle=i,this.nodes=[],this.lineStart=-1,this.lineEnd=-1,this.covering=null,this.writtenTo=e}get isCovered(){return this.covering&&this.nodes[this.nodes.length-1]==this.covering}span(e,i){if(this.lineStart>-1){let s=Math.min(i,this.lineEnd),r=this.nodes[this.nodes.length-1];r instanceof Ut?r.length+=s-this.pos:(s>this.pos||!this.isCovered)&&this.nodes.push(new Ut(s-this.pos,-1,0)),this.writtenTo=s,i>s&&(this.nodes.push(null),this.writtenTo++,this.lineStart=-1)}this.pos=i}point(e,i,s){if(e<i||s.heightRelevant){let r=s.widget?s.widget.estimatedHeight:0,n=s.widget?s.widget.lineBreaks:0;r<0&&(r=this.oracle.lineHeight);let a=i-e;s.block?this.addBlock(new pO(a,r,s)):(a||n||r>=lk)&&this.addLineDeco(r,n,a)}else i>e&&this.span(e,i);this.lineEnd>-1&&this.lineEnd<this.pos&&(this.lineEnd=this.oracle.doc.lineAt(this.pos).to)}enterLine(){if(this.lineStart>-1)return;let{from:e,to:i}=this.oracle.doc.lineAt(this.pos);this.lineStart=e,this.lineEnd=i,this.writtenTo<e&&((this.writtenTo<e-1||this.nodes[this.nodes.length-1]==null)&&this.nodes.push(this.blankContent(this.writtenTo,e-1)),this.nodes.push(null)),this.pos>e&&this.nodes.push(new Ut(this.pos-e,-1,0)),this.writtenTo=this.pos}blankContent(e,i){let s=new ft(i-e);return this.oracle.doc.lineAt(e).to==i&&(s.flags|=4),s}ensureLine(){this.enterLine();let e=this.nodes.length?this.nodes[this.nodes.length-1]:null;if(e instanceof Ut)return e;let i=new Ut(0,-1,0);return this.nodes.push(i),i}addBlock(e){this.enterLine();let i=e.deco;i&&i.startSide>0&&!this.isCovered&&this.ensureLine(),this.nodes.push(e),this.writtenTo=this.pos=this.pos+e.length,i&&i.endSide>0&&(this.covering=e)}addLineDeco(e,i,s){let r=this.ensureLine();r.length+=s,r.collapsed+=s,r.widgetHeight=Math.max(r.widgetHeight,e),r.breaks+=i,this.writtenTo=this.pos=this.pos+s}finish(e){let i=this.nodes.length==0?null:this.nodes[this.nodes.length-1];this.lineStart>-1&&!(i instanceof Ut)&&!this.isCovered?this.nodes.push(new Ut(0,-1,0)):(this.writtenTo<this.pos||i==null)&&this.nodes.push(this.blankContent(this.writtenTo,this.pos));let s=e;for(let r of this.nodes)r instanceof Ut&&r.updateHeight(this.oracle,s),s+=r?r.length:1;return this.nodes}static build(e,i,s,r){let n=new Ed(s,e);return Se.spans(i,s,r,n,0),n.finish(s)}}function ck(t,e,i){let s=new hk;return Se.compare(t,e,i,s,0),s.changes}class hk{constructor(){this.changes=[]}compareRange(){}comparePoint(e,i,s,r){(e<i||s&&s.heightRelevant||r&&r.heightRelevant)&&Wr(e,i,this.changes,5)}}function dk(t,e){let i=t.getBoundingClientRect(),s=t.ownerDocument,r=s.defaultView||window,n=Math.max(0,i.left),a=Math.min(r.innerWidth,i.right),o=Math.max(0,i.top),l=Math.min(r.innerHeight,i.bottom);for(let c=t.parentNode;c&&c!=s.body;)if(c.nodeType==1){let h=c,d=window.getComputedStyle(h);if((h.scrollHeight>h.clientHeight||h.scrollWidth>h.clientWidth)&&d.overflow!="visible"){let u=h.getBoundingClientRect();n=Math.max(n,u.left),a=Math.min(a,u.right),o=Math.max(o,u.top),l=Math.min(c==t.parentNode?r.innerHeight:l,u.bottom)}c=d.position=="absolute"||d.position=="fixed"?h.offsetParent:h.parentNode}else if(c.nodeType==11)c=c.host;else break;return{left:n-i.left,right:Math.max(n,a)-i.left,top:o-(i.top+e),bottom:Math.max(o,l)-(i.top+e)}}function uk(t){let e=t.getBoundingClientRect(),i=t.ownerDocument.defaultView||window;return e.left<i.innerWidth&&e.right>0&&e.top<i.innerHeight&&e.bottom>0}function pk(t,e){let i=t.getBoundingClientRect();return{left:0,right:i.right-i.left,top:e,bottom:i.bottom-(i.top+e)}}class fc{constructor(e,i,s,r){this.from=e,this.to=i,this.size=s,this.displaySize=r}static same(e,i){if(e.length!=i.length)return!1;for(let s=0;s<e.length;s++){let r=e[s],n=i[s];if(r.from!=n.from||r.to!=n.to||r.size!=n.size)return!1}return!0}draw(e,i){return fe.replace({widget:new fk(this.displaySize*(i?e.scaleY:e.scaleX),i)}).range(this.from,this.to)}}class fk extends gi{constructor(e,i){super(),this.size=e,this.vertical=i}eq(e){return e.size==this.size&&e.vertical==this.vertical}toDOM(){let e=document.createElement("div");return this.vertical?e.style.height=this.size+"px":(e.style.width=this.size+"px",e.style.height="2px",e.style.display="inline-block"),e}get estimatedHeight(){return this.vertical?this.size:-1}}class Wp{constructor(e){this.state=e,this.pixelViewport={left:0,right:window.innerWidth,top:0,bottom:0},this.inView=!0,this.paddingTop=0,this.paddingBottom=0,this.contentDOMWidth=0,this.contentDOMHeight=0,this.editorHeight=0,this.editorWidth=0,this.scrollTop=0,this.scrolledToBottom=!1,this.scaleX=1,this.scaleY=1,this.scrollAnchorPos=0,this.scrollAnchorHeight=-1,this.scaler=Fp,this.scrollTarget=null,this.printing=!1,this.mustMeasureContent=!0,this.defaultTextDirection=Fe.LTR,this.visibleRanges=[],this.mustEnforceCursorAssoc=!1;let i=e.facet(xd).some(s=>typeof s!="function"&&s.class=="cm-lineWrapping");this.heightOracle=new rk(i),this.stateDeco=Up(e),this.heightMap=_t.empty().applyChanges(this.stateDeco,$e.empty,this.heightOracle.setDoc(e.doc),[new ei(0,0,0,e.doc.length)]);for(let s=0;s<2&&(this.viewport=this.getViewport(0,null),!!this.updateForViewport());s++);this.updateViewportLines(),this.lineGaps=this.ensureLineGaps([]),this.lineGapDeco=fe.set(this.lineGaps.map(s=>s.draw(this,!1))),this.computeVisibleRanges()}updateForViewport(){let e=[this.viewport],{main:i}=this.state.selection;for(let s=0;s<=1;s++){let r=s?i.head:i.anchor;if(!e.some(({from:n,to:a})=>r>=n&&r<=a)){let{from:n,to:a}=this.lineBlockAt(r);e.push(new io(n,a))}}return this.viewports=e.sort((s,r)=>s.from-r.from),this.updateScaler()}updateScaler(){let e=this.scaler;return this.scaler=this.heightMap.height<=7e6?Fp:new Pd(this.heightOracle,this.heightMap,this.viewports),e.eq(this.scaler)?0:2}updateViewportLines(){this.viewportLines=[],this.heightMap.forEachLine(this.viewport.from,this.viewport.to,this.heightOracle.setDoc(this.state.doc),0,0,e=>{this.viewportLines.push(Mn(e,this.scaler))})}update(e,i=null){this.state=e.state;let s=this.stateDeco;this.stateDeco=Up(this.state);let r=e.changedRanges,n=ei.extendWithRanges(r,ck(s,this.stateDeco,e?e.changes:rt.empty(this.state.doc.length))),a=this.heightMap.height,o=this.scrolledToBottom?null:this.scrollAnchorAt(this.scrollTop);Bp(),this.heightMap=this.heightMap.applyChanges(this.stateDeco,e.startState.doc,this.heightOracle.setDoc(this.state.doc),n),(this.heightMap.height!=a||Kr)&&(e.flags|=2),o?(this.scrollAnchorPos=e.changes.mapPos(o.from,-1),this.scrollAnchorHeight=o.top):(this.scrollAnchorPos=-1,this.scrollAnchorHeight=a);let l=n.length?this.mapViewport(this.viewport,e.changes):this.viewport;(i&&(i.range.head<l.from||i.range.head>l.to)||!this.viewportIsAppropriate(l))&&(l=this.getViewport(0,i));let c=l.from!=this.viewport.from||l.to!=this.viewport.to;this.viewport=l,e.flags|=this.updateForViewport(),(c||!e.changes.empty||e.flags&2)&&this.updateViewportLines(),(this.lineGaps.length||this.viewport.to-this.viewport.from>4e3)&&this.updateLineGaps(this.ensureLineGaps(this.mapLineGaps(this.lineGaps,e.changes))),e.flags|=this.computeVisibleRanges(e.changes),i&&(this.scrollTarget=i),!this.mustEnforceCursorAssoc&&(e.selectionSet||e.focusChanged)&&e.view.lineWrapping&&e.state.selection.main.empty&&e.state.selection.main.assoc&&!e.state.facet(Um)&&(this.mustEnforceCursorAssoc=!0)}measure(e){let i=e.contentDOM,s=window.getComputedStyle(i),r=this.heightOracle,n=s.whiteSpace;this.defaultTextDirection=s.direction=="rtl"?Fe.RTL:Fe.LTR;let a=this.heightOracle.mustRefreshForWrapping(n)||this.mustMeasureContent,o=i.getBoundingClientRect(),l=a||this.mustMeasureContent||this.contentDOMHeight!=o.height;this.contentDOMHeight=o.height,this.mustMeasureContent=!1;let c=0,h=0;if(o.width&&o.height){let{scaleX:k,scaleY:x}=Pm(i,o);(k>.005&&Math.abs(this.scaleX-k)>.005||x>.005&&Math.abs(this.scaleY-x)>.005)&&(this.scaleX=k,this.scaleY=x,c|=16,a=l=!0)}let d=(parseInt(s.paddingTop)||0)*this.scaleY,u=(parseInt(s.paddingBottom)||0)*this.scaleY;(this.paddingTop!=d||this.paddingBottom!=u)&&(this.paddingTop=d,this.paddingBottom=u,c|=18),this.editorWidth!=e.scrollDOM.clientWidth&&(r.lineWrapping&&(l=!0),this.editorWidth=e.scrollDOM.clientWidth,c|=16);let p=e.scrollDOM.scrollTop*this.scaleY;this.scrollTop!=p&&(this.scrollAnchorHeight=-1,this.scrollTop=p),this.scrolledToBottom=_m(e.scrollDOM);let f=(this.printing?pk:dk)(i,this.paddingTop),g=f.top-this.pixelViewport.top,m=f.bottom-this.pixelViewport.bottom;this.pixelViewport=f;let y=this.pixelViewport.bottom>this.pixelViewport.top&&this.pixelViewport.right>this.pixelViewport.left;if(y!=this.inView&&(this.inView=y,y&&(l=!0)),!this.inView&&!this.scrollTarget&&!uk(e.dom))return 0;let b=o.width;if((this.contentDOMWidth!=b||this.editorHeight!=e.scrollDOM.clientHeight)&&(this.contentDOMWidth=o.width,this.editorHeight=e.scrollDOM.clientHeight,c|=16),l){let k=e.docView.measureVisibleLineHeights(this.viewport);if(r.mustRefreshForHeights(k)&&(a=!0),a||r.lineWrapping&&Math.abs(b-this.contentDOMWidth)>r.charWidth){let{lineHeight:x,charWidth:E,textHeight:_}=e.docView.measureTextSize();a=x>0&&r.refresh(n,x,E,_,Math.max(5,b/E),k),a&&(e.docView.minWidth=0,c|=16)}g>0&&m>0?h=Math.max(g,m):g<0&&m<0&&(h=Math.min(g,m)),Bp();for(let x of this.viewports){let E=x.from==this.viewport.from?k:e.docView.measureVisibleLineHeights(x);this.heightMap=(a?_t.empty().applyChanges(this.stateDeco,$e.empty,this.heightOracle,[new ei(0,0,0,e.state.doc.length)]):this.heightMap).updateHeight(r,0,a,new nk(x.from,E))}Kr&&(c|=2)}let w=!this.viewportIsAppropriate(this.viewport,h)||this.scrollTarget&&(this.scrollTarget.range.head<this.viewport.from||this.scrollTarget.range.head>this.viewport.to);return w&&(c&2&&(c|=this.updateScaler()),this.viewport=this.getViewport(h,this.scrollTarget),c|=this.updateForViewport()),(c&2||w)&&this.updateViewportLines(),(this.lineGaps.length||this.viewport.to-this.viewport.from>4e3)&&this.updateLineGaps(this.ensureLineGaps(a?[]:this.lineGaps,e)),c|=this.computeVisibleRanges(),this.mustEnforceCursorAssoc&&(this.mustEnforceCursorAssoc=!1,e.docView.enforceCursorAssoc()),c}get visibleTop(){return this.scaler.fromDOM(this.pixelViewport.top)}get visibleBottom(){return this.scaler.fromDOM(this.pixelViewport.bottom)}getViewport(e,i){let s=.5-Math.max(-.5,Math.min(.5,e/1e3/2)),r=this.heightMap,n=this.heightOracle,{visibleTop:a,visibleBottom:o}=this,l=new io(r.lineAt(a-s*1e3,Me.ByHeight,n,0,0).from,r.lineAt(o+(1-s)*1e3,Me.ByHeight,n,0,0).to);if(i){let{head:c}=i.range;if(c<l.from||c>l.to){let h=Math.min(this.editorHeight,this.pixelViewport.bottom-this.pixelViewport.top),d=r.lineAt(c,Me.ByPos,n,0,0),u;i.y=="center"?u=(d.top+d.bottom)/2-h/2:i.y=="start"||i.y=="nearest"&&c<l.from?u=d.top:u=d.bottom-h,l=new io(r.lineAt(u-1e3/2,Me.ByHeight,n,0,0).from,r.lineAt(u+h+1e3/2,Me.ByHeight,n,0,0).to)}}return l}mapViewport(e,i){let s=i.mapPos(e.from,-1),r=i.mapPos(e.to,1);return new io(this.heightMap.lineAt(s,Me.ByPos,this.heightOracle,0,0).from,this.heightMap.lineAt(r,Me.ByPos,this.heightOracle,0,0).to)}viewportIsAppropriate({from:e,to:i},s=0){if(!this.inView)return!0;let{top:r}=this.heightMap.lineAt(e,Me.ByPos,this.heightOracle,0,0),{bottom:n}=this.heightMap.lineAt(i,Me.ByPos,this.heightOracle,0,0),{visibleTop:a,visibleBottom:o}=this;return(e==0||r<=a-Math.max(10,Math.min(-s,250)))&&(i==this.state.doc.length||n>=o+Math.max(10,Math.min(s,250)))&&r>a-2*1e3&&n<o+2*1e3}mapLineGaps(e,i){if(!e.length||i.empty)return e;let s=[];for(let r of e)i.touchesRange(r.from,r.to)||s.push(new fc(i.mapPos(r.from),i.mapPos(r.to),r.size,r.displaySize));return s}ensureLineGaps(e,i){let s=this.heightOracle.lineWrapping,r=s?1e4:2e3,n=r>>1,a=r<<1;if(this.defaultTextDirection!=Fe.LTR&&!s)return[];let o=[],l=(h,d,u,p)=>{if(d-h<n)return;let f=this.state.selection.main,g=[f.from];f.empty||g.push(f.to);for(let y of g)if(y>h&&y<d){l(h,y-10,u,p),l(y+10,d,u,p);return}let m=mk(e,y=>y.from>=u.from&&y.to<=u.to&&Math.abs(y.from-h)<n&&Math.abs(y.to-d)<n&&!g.some(b=>y.from<b&&y.to>b));if(!m){if(d<u.to&&i&&s&&i.visibleRanges.some(w=>w.from<=d&&w.to>=d)){let w=i.moveToLineBoundary(X.cursor(d),!1,!0).head;w>h&&(d=w)}let y=this.gapSize(u,h,d,p),b=s||y<2e6?y:2e6;m=new fc(h,d,y,b)}o.push(m)},c=h=>{if(h.length<a||h.type!=yt.Text)return;let d=gk(h.from,h.to,this.stateDeco);if(d.total<a)return;let u=this.scrollTarget?this.scrollTarget.range.head:null,p,f;if(s){let g=r/this.heightOracle.lineLength*this.heightOracle.lineHeight,m,y;if(u!=null){let b=ro(d,u),w=((this.visibleBottom-this.visibleTop)/2+g)/h.height;m=b-w,y=b+w}else m=(this.visibleTop-h.top-g)/h.height,y=(this.visibleBottom-h.top+g)/h.height;p=so(d,m),f=so(d,y)}else{let g=d.total*this.heightOracle.charWidth,m=r*this.heightOracle.charWidth,y=0;if(g>2e6)for(let E of e)E.from>=h.from&&E.from<h.to&&E.size!=E.displaySize&&E.from*this.heightOracle.charWidth+y<this.pixelViewport.left&&(y=E.size-E.displaySize);let b=this.pixelViewport.left+y,w=this.pixelViewport.right+y,k,x;if(u!=null){let E=ro(d,u),_=((w-b)/2+m)/g;k=E-_,x=E+_}else k=(b-m)/g,x=(w+m)/g;p=so(d,k),f=so(d,x)}p>h.from&&l(h.from,p,h,d),f<h.to&&l(f,h.to,h,d)};for(let h of this.viewportLines)Array.isArray(h.type)?h.type.forEach(c):c(h);return o}gapSize(e,i,s,r){let n=ro(r,s)-ro(r,i);return this.heightOracle.lineWrapping?e.height*n:r.total*this.heightOracle.charWidth*n}updateLineGaps(e){fc.same(e,this.lineGaps)||(this.lineGaps=e,this.lineGapDeco=fe.set(e.map(i=>i.draw(this,this.heightOracle.lineWrapping))))}computeVisibleRanges(e){let i=this.stateDeco;this.lineGaps.length&&(i=i.concat(this.lineGapDeco));let s=[];Se.spans(i,this.viewport.from,this.viewport.to,{span(n,a){s.push({from:n,to:a})},point(){}},20);let r=0;if(s.length!=this.visibleRanges.length)r=12;else for(let n=0;n<s.length&&!(r&8);n++){let a=this.visibleRanges[n],o=s[n];(a.from!=o.from||a.to!=o.to)&&(r|=4,e&&e.mapPos(a.from,-1)==o.from&&e.mapPos(a.to,1)==o.to||(r|=8))}return this.visibleRanges=s,r}lineBlockAt(e){return e>=this.viewport.from&&e<=this.viewport.to&&this.viewportLines.find(i=>i.from<=e&&i.to>=e)||Mn(this.heightMap.lineAt(e,Me.ByPos,this.heightOracle,0,0),this.scaler)}lineBlockAtHeight(e){return e>=this.viewportLines[0].top&&e<=this.viewportLines[this.viewportLines.length-1].bottom&&this.viewportLines.find(i=>i.top<=e&&i.bottom>=e)||Mn(this.heightMap.lineAt(this.scaler.fromDOM(e),Me.ByHeight,this.heightOracle,0,0),this.scaler)}scrollAnchorAt(e){let i=this.lineBlockAtHeight(e+8);return i.from>=this.viewport.from||this.viewportLines[0].top-e>200?i:this.viewportLines[0]}elementAtHeight(e){return Mn(this.heightMap.blockAt(this.scaler.fromDOM(e),this.heightOracle,0,0),this.scaler)}get docHeight(){return this.scaler.toDOM(this.heightMap.height)}get contentHeight(){return this.docHeight+this.paddingTop+this.paddingBottom}}class io{constructor(e,i){this.from=e,this.to=i}}function gk(t,e,i){let s=[],r=t,n=0;return Se.spans(i,t,e,{span(){},point(a,o){a>r&&(s.push({from:r,to:a}),n+=a-r),r=o}},20),r<e&&(s.push({from:r,to:e}),n+=e-r),{total:n,ranges:s}}function so({total:t,ranges:e},i){if(i<=0)return e[0].from;if(i>=1)return e[e.length-1].to;let s=Math.floor(t*i);for(let r=0;;r++){let{from:n,to:a}=e[r],o=a-n;if(s<=o)return n+s;s-=o}}function ro(t,e){let i=0;for(let{from:s,to:r}of t.ranges){if(e<=r){i+=e-s;break}i+=r-s}return i/t.total}function mk(t,e){for(let i of t)if(e(i))return i}const Fp={toDOM(t){return t},fromDOM(t){return t},scale:1,eq(t){return t==this}};function Up(t){let e=t.facet(pl).filter(s=>typeof s!="function"),i=t.facet(kd).filter(s=>typeof s!="function");return i.length&&e.push(Se.join(i)),e}class Pd{constructor(e,i,s){let r=0,n=0,a=0;this.viewports=s.map(({from:o,to:l})=>{let c=i.lineAt(o,Me.ByPos,e,0,0).top,h=i.lineAt(l,Me.ByPos,e,0,0).bottom;return r+=h-c,{from:o,to:l,top:c,bottom:h,domTop:0,domBottom:0}}),this.scale=(7e6-r)/(i.height-r);for(let o of this.viewports)o.domTop=a+(o.top-n)*this.scale,a=o.domBottom=o.domTop+(o.bottom-o.top),n=o.bottom}toDOM(e){for(let i=0,s=0,r=0;;i++){let n=i<this.viewports.length?this.viewports[i]:null;if(!n||e<n.top)return r+(e-s)*this.scale;if(e<=n.bottom)return n.domTop+(e-n.top);s=n.bottom,r=n.domBottom}}fromDOM(e){for(let i=0,s=0,r=0;;i++){let n=i<this.viewports.length?this.viewports[i]:null;if(!n||e<n.domTop)return s+(e-r)/this.scale;if(e<=n.domBottom)return n.top+(e-n.domTop);s=n.bottom,r=n.domBottom}}eq(e){return e instanceof Pd?this.scale==e.scale&&this.viewports.length==e.viewports.length&&this.viewports.every((i,s)=>i.from==e.viewports[s].from&&i.to==e.viewports[s].to):!1}}function Mn(t,e){if(e.scale==1)return t;let i=e.toDOM(t.top),s=e.toDOM(t.bottom);return new di(t.from,t.length,i,s-i,Array.isArray(t._content)?t._content.map(r=>Mn(r,e)):t._content)}const no=se.define({combine:t=>t.join(" ")}),Eh=se.define({combine:t=>t.indexOf(!0)>-1}),Ph=xs.newName(),fO=xs.newName(),gO=xs.newName(),mO={"&light":"."+fO,"&dark":"."+gO};function Ch(t,e,i){return new xs(e,{finish(s){return/&/.test(s)?s.replace(/&\w*/,r=>{if(r=="&")return t;if(!i||!i[r])throw new RangeError(`Unsupported selector: ${r}`);return i[r]}):t+" "+s}})}const Ok=Ch("."+Ph,{"&":{position:"relative !important",boxSizing:"border-box","&.cm-focused":{outline:"1px dotted #212121"},display:"flex !important",flexDirection:"column"},".cm-scroller":{display:"flex !important",alignItems:"flex-start !important",fontFamily:"monospace",lineHeight:1.4,height:"100%",overflowX:"auto",position:"relative",zIndex:0,overflowAnchor:"none"},".cm-content":{margin:0,flexGrow:2,flexShrink:0,display:"block",whiteSpace:"pre",wordWrap:"normal",boxSizing:"border-box",minHeight:"100%",padding:"4px 0",outline:"none","&[contenteditable=true]":{WebkitUserModify:"read-write-plaintext-only"}},".cm-lineWrapping":{whiteSpace_fallback:"pre-wrap",whiteSpace:"break-spaces",wordBreak:"break-word",overflowWrap:"anywhere",flexShrink:1},"&light .cm-content":{caretColor:"black"},"&dark .cm-content":{caretColor:"white"},".cm-line":{display:"block",padding:"0 2px 0 6px"},".cm-layer":{position:"absolute",left:0,top:0,contain:"size style","& > *":{position:"absolute"}},"&light .cm-selectionBackground":{background:"#d9d9d9"},"&dark .cm-selectionBackground":{background:"#222"},"&light.cm-focused > .cm-scroller > .cm-selectionLayer .cm-selectionBackground":{background:"#d7d4f0"},"&dark.cm-focused > .cm-scroller > .cm-selectionLayer .cm-selectionBackground":{background:"#233"},".cm-cursorLayer":{pointerEvents:"none"},"&.cm-focused > .cm-scroller > .cm-cursorLayer":{animation:"steps(1) cm-blink 1.2s infinite"},"@keyframes cm-blink":{"0%":{},"50%":{opacity:0},"100%":{}},"@keyframes cm-blink2":{"0%":{},"50%":{opacity:0},"100%":{}},".cm-cursor, .cm-dropCursor":{borderLeft:"1.2px solid black",marginLeft:"-0.6px",pointerEvents:"none"},".cm-cursor":{display:"none"},"&dark .cm-cursor":{borderLeftColor:"#ddd"},".cm-dropCursor":{position:"absolute"},"&.cm-focused > .cm-scroller > .cm-cursorLayer .cm-cursor":{display:"block"},".cm-iso":{unicodeBidi:"isolate"},".cm-announced":{position:"fixed",top:"-10000px"},"@media print":{".cm-announced":{display:"none"}},"&light .cm-activeLine":{backgroundColor:"#cceeff44"},"&dark .cm-activeLine":{backgroundColor:"#99eeff33"},"&light .cm-specialChar":{color:"red"},"&dark .cm-specialChar":{color:"#f78"},".cm-gutters":{flexShrink:0,display:"flex",height:"100%",boxSizing:"border-box",zIndex:200},".cm-gutters-before":{insetInlineStart:0},".cm-gutters-after":{insetInlineEnd:0},"&light .cm-gutters":{backgroundColor:"#f5f5f5",color:"#6c6c6c",border:"0px solid #ddd","&.cm-gutters-before":{borderRightWidth:"1px"},"&.cm-gutters-after":{borderLeftWidth:"1px"}},"&dark .cm-gutters":{backgroundColor:"#333338",color:"#ccc"},".cm-gutter":{display:"flex !important",flexDirection:"column",flexShrink:0,boxSizing:"border-box",minHeight:"100%",overflow:"hidden"},".cm-gutterElement":{boxSizing:"border-box"},".cm-lineNumbers .cm-gutterElement":{padding:"0 3px 0 5px",minWidth:"20px",textAlign:"right",whiteSpace:"nowrap"},"&light .cm-activeLineGutter":{backgroundColor:"#e2f2ff"},"&dark .cm-activeLineGutter":{backgroundColor:"#222227"},".cm-panels":{boxSizing:"border-box",position:"sticky",left:0,right:0,zIndex:300},"&light .cm-panels":{backgroundColor:"#f5f5f5",color:"black"},"&light .cm-panels-top":{borderBottom:"1px solid #ddd"},"&light .cm-panels-bottom":{borderTop:"1px solid #ddd"},"&dark .cm-panels":{backgroundColor:"#333338",color:"white"},".cm-dialog":{padding:"2px 19px 4px 6px",position:"relative","& label":{fontSize:"80%"}},".cm-dialog-close":{position:"absolute",top:"3px",right:"4px",backgroundColor:"inherit",border:"none",font:"inherit",fontSize:"14px",padding:"0"},".cm-tab":{display:"inline-block",overflow:"hidden",verticalAlign:"bottom"},".cm-widgetBuffer":{verticalAlign:"text-top",height:"1em",width:0,display:"inline"},".cm-placeholder":{color:"#888",display:"inline-block",verticalAlign:"top",userSelect:"none"},".cm-highlightSpace":{backgroundImage:"radial-gradient(circle at 50% 55%, #aaa 20%, transparent 5%)",backgroundPosition:"center"},".cm-highlightTab":{backgroundImage:`url('data:image/svg+xml,<svg xmlns="http://www.w3.org/2000/svg" width="200" height="20"><path stroke="%23888" stroke-width="1" fill="none" d="M1 10H196L190 5M190 15L196 10M197 4L197 16"/></svg>')`,backgroundSize:"auto 100%",backgroundPosition:"right 90%",backgroundRepeat:"no-repeat"},".cm-trailingSpace":{backgroundColor:"#ff332255"},".cm-button":{verticalAlign:"middle",color:"inherit",fontSize:"70%",padding:".2em 1em",borderRadius:"1px"},"&light .cm-button":{backgroundImage:"linear-gradient(#eff1f5, #d9d9df)",border:"1px solid #888","&:active":{backgroundImage:"linear-gradient(#b4b4b4, #d0d3d6)"}},"&dark .cm-button":{backgroundImage:"linear-gradient(#393939, #111)",border:"1px solid #888","&:active":{backgroundImage:"linear-gradient(#111, #333)"}},".cm-textfield":{verticalAlign:"middle",color:"inherit",fontSize:"70%",border:"1px solid silver",padding:".2em .5em"},"&light .cm-textfield":{backgroundColor:"white"},"&dark .cm-textfield":{border:"1px solid #555",backgroundColor:"inherit"}},mO),yk={childList:!0,characterData:!0,subtree:!0,attributes:!0,characterDataOldValue:!0},gc=K.ie&&K.ie_version<=11;class vk{constructor(e){this.view=e,this.active=!1,this.editContext=null,this.selectionRange=new Z1,this.selectionChanged=!1,this.delayedFlush=-1,this.resizeTimeout=-1,this.queue=[],this.delayedAndroidKey=null,this.flushingAndroidKey=-1,this.lastChange=0,this.scrollTargets=[],this.intersection=null,this.resizeScroll=null,this.intersecting=!1,this.gapIntersection=null,this.gaps=[],this.printQuery=null,this.parentCheck=-1,this.dom=e.contentDOM,this.observer=new MutationObserver(i=>{for(let s of i)this.queue.push(s);(K.ie&&K.ie_version<=11||K.ios&&e.composing)&&i.some(s=>s.type=="childList"&&s.removedNodes.length||s.type=="characterData"&&s.oldValue.length>s.target.nodeValue.length)?this.flushSoon():this.flush()}),window.EditContext&&K.android&&e.constructor.EDIT_CONTEXT!==!1&&!(K.chrome&&K.chrome_version<126)&&(this.editContext=new wk(e),e.state.facet(Hi)&&(e.contentDOM.editContext=this.editContext.editContext)),gc&&(this.onCharData=i=>{this.queue.push({target:i.target,type:"characterData",oldValue:i.prevValue}),this.flushSoon()}),this.onSelectionChange=this.onSelectionChange.bind(this),this.onResize=this.onResize.bind(this),this.onPrint=this.onPrint.bind(this),this.onScroll=this.onScroll.bind(this),window.matchMedia&&(this.printQuery=window.matchMedia("print")),typeof ResizeObserver=="function"&&(this.resizeScroll=new ResizeObserver(()=>{var i;((i=this.view.docView)===null||i===void 0?void 0:i.lastUpdate)<Date.now()-75&&this.onResize()}),this.resizeScroll.observe(e.scrollDOM)),this.addWindowListeners(this.win=e.win),this.start(),typeof IntersectionObserver=="function"&&(this.intersection=new IntersectionObserver(i=>{this.parentCheck<0&&(this.parentCheck=setTimeout(this.listenForScroll.bind(this),1e3)),i.length>0&&i[i.length-1].intersectionRatio>0!=this.intersecting&&(this.intersecting=!this.intersecting,this.intersecting!=this.view.inView&&this.onScrollChanged(document.createEvent("Event")))},{threshold:[0,.001]}),this.intersection.observe(this.dom),this.gapIntersection=new IntersectionObserver(i=>{i.length>0&&i[i.length-1].intersectionRatio>0&&this.onScrollChanged(document.createEvent("Event"))},{})),this.listenForScroll(),this.readSelectionRange()}onScrollChanged(e){this.view.inputState.runHandlers("scroll",e),this.intersecting&&this.view.measure()}onScroll(e){this.intersecting&&this.flush(!1),this.editContext&&this.view.requestMeasure(this.editContext.measureReq),this.onScrollChanged(e)}onResize(){this.resizeTimeout<0&&(this.resizeTimeout=setTimeout(()=>{this.resizeTimeout=-1,this.view.requestMeasure()},50))}onPrint(e){(e.type=="change"||!e.type)&&!e.matches||(this.view.viewState.printing=!0,this.view.measure(),setTimeout(()=>{this.view.viewState.printing=!1,this.view.requestMeasure()},500))}updateGaps(e){if(this.gapIntersection&&(e.length!=this.gaps.length||this.gaps.some((i,s)=>i!=e[s]))){this.gapIntersection.disconnect();for(let i of e)this.gapIntersection.observe(i);this.gaps=e}}onSelectionChange(e){let i=this.selectionChanged;if(!this.readSelectionRange()||this.delayedAndroidKey)return;let{view:s}=this,r=this.selectionRange;if(s.state.facet(Hi)?s.root.activeElement!=this.dom:!zn(this.dom,r))return;let n=r.anchorNode&&s.docView.tile.nearest(r.anchorNode);if(n&&n.isWidget()&&n.widget.ignoreEvent(e)){i||(this.selectionChanged=!1);return}(K.ie&&K.ie_version<=11||K.android&&K.chrome)&&!s.state.selection.main.empty&&r.focusNode&&Xn(r.focusNode,r.focusOffset,r.anchorNode,r.anchorOffset)?this.flushSoon():this.flush(!1)}readSelectionRange(){let{view:e}=this,i=Yr(e.root);if(!i)return!1;let s=K.safari&&e.root.nodeType==11&&e.root.activeElement==this.dom&&bk(this.view,i)||i;if(!s||this.selectionRange.eq(s))return!1;let r=zn(this.dom,s);return r&&!this.selectionChanged&&e.inputState.lastFocusTime>Date.now()-200&&e.inputState.lastTouchTime<Date.now()-300&&K1(this.dom,s)?(this.view.inputState.lastFocusTime=0,e.docView.updateSelection(),!1):(this.selectionRange.setRange(s),r&&(this.selectionChanged=!0),!0)}setSelectionRange(e,i){this.selectionRange.set(e.node,e.offset,i.node,i.offset),this.selectionChanged=!1}clearSelectionRange(){this.selectionRange.set(null,0,null,0)}listenForScroll(){this.parentCheck=-1;let e=0,i=null;for(let s=this.dom;s;)if(s.nodeType==1)!i&&e<this.scrollTargets.length&&this.scrollTargets[e]==s?e++:i||(i=this.scrollTargets.slice(0,e)),i&&i.push(s),s=s.assignedSlot||s.parentNode;else if(s.nodeType==11)s=s.host;else break;if(e<this.scrollTargets.length&&!i&&(i=this.scrollTargets.slice(0,e)),i){for(let s of this.scrollTargets)s.removeEventListener("scroll",this.onScroll);for(let s of this.scrollTargets=i)s.addEventListener("scroll",this.onScroll)}}ignore(e){if(!this.active)return e();try{return this.stop(),e()}finally{this.start(),this.clear()}}start(){this.active||(this.observer.observe(this.dom,yk),gc&&this.dom.addEventListener("DOMCharacterDataModified",this.onCharData),this.active=!0)}stop(){this.active&&(this.active=!1,this.observer.disconnect(),gc&&this.dom.removeEventListener("DOMCharacterDataModified",this.onCharData))}clear(){this.processRecords(),this.queue.length=0,this.selectionChanged=!1}delayAndroidKey(e,i){var s;if(!this.delayedAndroidKey){let r=()=>{let n=this.delayedAndroidKey;n&&(this.clearDelayedAndroidKey(),this.view.inputState.lastKeyCode=n.keyCode,this.view.inputState.lastKeyTime=Date.now(),!this.flush()&&n.force&&Fr(this.dom,n.key,n.keyCode))};this.flushingAndroidKey=this.view.win.requestAnimationFrame(r)}(!this.delayedAndroidKey||e=="Enter")&&(this.delayedAndroidKey={key:e,keyCode:i,force:this.lastChange<Date.now()-50||!!(!((s=this.delayedAndroidKey)===null||s===void 0)&&s.force)})}clearDelayedAndroidKey(){this.win.cancelAnimationFrame(this.flushingAndroidKey),this.delayedAndroidKey=null,this.flushingAndroidKey=-1}flushSoon(){this.delayedFlush<0&&(this.delayedFlush=this.view.win.requestAnimationFrame(()=>{this.delayedFlush=-1,this.flush()}))}forceFlush(){this.delayedFlush>=0&&(this.view.win.cancelAnimationFrame(this.delayedFlush),this.delayedFlush=-1),this.flush()}pendingRecords(){for(let e of this.observer.takeRecords())this.queue.push(e);return this.queue}processRecords(){let e=this.pendingRecords();e.length&&(this.queue=[]);let i=-1,s=-1,r=!1;for(let n of e){let a=this.readMutation(n);a&&(a.typeOver&&(r=!0),i==-1?{from:i,to:s}=a:(i=Math.min(a.from,i),s=Math.max(a.to,s)))}return{from:i,to:s,typeOver:r}}readChange(){let{from:e,to:i,typeOver:s}=this.processRecords(),r=this.selectionChanged&&zn(this.dom,this.selectionRange);if(e<0&&!r)return null;e>-1&&(this.lastChange=Date.now()),this.view.inputState.lastFocusTime=0,this.selectionChanged=!1;let n=new qx(this.view,e,i,s);return this.view.docView.domChanged={newSel:n.newSel?n.newSel.main:null},n}flush(e=!0){if(this.delayedFlush>=0||this.delayedAndroidKey)return!1;e&&this.readSelectionRange();let i=this.readChange();if(!i)return this.view.requestMeasure(),!1;let s=this.view.state,r=sO(this.view,i);return this.view.state==s&&(i.domChanged||i.newSel&&!jo(this.view.state.selection,i.newSel.main))&&this.view.update([]),r}readMutation(e){let i=this.view.docView.tile.nearest(e.target);if(!i||i.isWidget())return null;if(i.markDirty(e.type=="attributes"),e.type=="childList"){let s=Vp(i,e.previousSibling||e.target.previousSibling,-1),r=Vp(i,e.nextSibling||e.target.nextSibling,1);return{from:s?i.posAfter(s):i.posAtStart,to:r?i.posBefore(r):i.posAtEnd,typeOver:!1}}else return e.type=="characterData"?{from:i.posAtStart,to:i.posAtEnd,typeOver:e.target.nodeValue==e.oldValue}:null}setWindow(e){e!=this.win&&(this.removeWindowListeners(this.win),this.win=e,this.addWindowListeners(this.win))}addWindowListeners(e){e.addEventListener("resize",this.onResize),this.printQuery?this.printQuery.addEventListener?this.printQuery.addEventListener("change",this.onPrint):this.printQuery.addListener(this.onPrint):e.addEventListener("beforeprint",this.onPrint),e.addEventListener("scroll",this.onScroll),e.document.addEventListener("selectionchange",this.onSelectionChange)}removeWindowListeners(e){e.removeEventListener("scroll",this.onScroll),e.removeEventListener("resize",this.onResize),this.printQuery?this.printQuery.removeEventListener?this.printQuery.removeEventListener("change",this.onPrint):this.printQuery.removeListener(this.onPrint):e.removeEventListener("beforeprint",this.onPrint),e.document.removeEventListener("selectionchange",this.onSelectionChange)}update(e){this.editContext&&(this.editContext.update(e),e.startState.facet(Hi)!=e.state.facet(Hi)&&(e.view.contentDOM.editContext=e.state.facet(Hi)?this.editContext.editContext:null))}destroy(){var e,i,s;this.stop(),(e=this.intersection)===null||e===void 0||e.disconnect(),(i=this.gapIntersection)===null||i===void 0||i.disconnect(),(s=this.resizeScroll)===null||s===void 0||s.disconnect();for(let r of this.scrollTargets)r.removeEventListener("scroll",this.onScroll);this.removeWindowListeners(this.win),clearTimeout(this.parentCheck),clearTimeout(this.resizeTimeout),this.win.cancelAnimationFrame(this.delayedFlush),this.win.cancelAnimationFrame(this.flushingAndroidKey),this.editContext&&(this.view.contentDOM.editContext=null,this.editContext.destroy())}}function Vp(t,e,i){for(;e;){let s=tt.get(e);if(s&&s.parent==t)return s;let r=e.parentNode;e=r!=t.dom?r:i>0?e.nextSibling:e.previousSibling}return null}function zp(t,e){let i=e.startContainer,s=e.startOffset,r=e.endContainer,n=e.endOffset,a=t.docView.domAtPos(t.state.selection.main.anchor,1);return Xn(a.node,a.offset,r,n)&&([i,s,r,n]=[r,n,i,s]),{anchorNode:i,anchorOffset:s,focusNode:r,focusOffset:n}}function bk(t,e){if(e.getComposedRanges){let r=e.getComposedRanges(t.root)[0];if(r)return zp(t,r)}let i=null;function s(r){r.preventDefault(),r.stopImmediatePropagation(),i=r.getTargetRanges()[0]}return t.contentDOM.addEventListener("beforeinput",s,!0),t.dom.ownerDocument.execCommand("indent"),t.contentDOM.removeEventListener("beforeinput",s,!0),i?zp(t,i):null}class wk{constructor(e){this.from=0,this.to=0,this.pendingContextChange=null,this.handlers=Object.create(null),this.composing=null,this.resetRange(e.state);let i=this.editContext=new window.EditContext({text:e.state.doc.sliceString(this.from,this.to),selectionStart:this.toContextPos(Math.max(this.from,Math.min(this.to,e.state.selection.main.anchor))),selectionEnd:this.toContextPos(e.state.selection.main.head)});this.handlers.textupdate=s=>{let r=e.state.selection.main,{anchor:n,head:a}=r,o=this.toEditorPos(s.updateRangeStart),l=this.toEditorPos(s.updateRangeEnd);e.inputState.composing>=0&&!this.composing&&(this.composing={contextBase:s.updateRangeStart,editorBase:o,drifted:!1});let c=l-o>s.text.length;o==this.from&&n<this.from?o=n:l==this.to&&n>this.to&&(l=n);let h=rO(e.state.sliceDoc(o,l),s.text,(c?r.from:r.to)-o,c?"end":null);if(!h){let u=X.single(this.toEditorPos(s.selectionStart),this.toEditorPos(s.selectionEnd));jo(u,r)||e.dispatch({selection:u,userEvent:"select"});return}let d={from:h.from+o,to:h.toA+o,insert:$e.of(s.text.slice(h.from,h.toB).split(`
`))};if((K.mac||K.android)&&d.from==a-1&&/^\. ?$/.test(s.text)&&e.contentDOM.getAttribute("autocorrect")=="off"&&(d={from:o,to:l,insert:$e.of([s.text.replace("."," ")])}),this.pendingContextChange=d,!e.state.readOnly){let u=this.to-this.from+(d.to-d.from+d.insert.length);Td(e,d,X.single(this.toEditorPos(s.selectionStart,u),this.toEditorPos(s.selectionEnd,u)))}this.pendingContextChange&&(this.revertPending(e.state),this.setSelection(e.state)),d.from<d.to&&!d.insert.length&&e.inputState.composing>=0&&!/[\\p{Alphabetic}\\p{Number}_]/.test(i.text.slice(Math.max(0,s.updateRangeStart-1),Math.min(i.text.length,s.updateRangeStart+1)))&&this.handlers.compositionend(s)},this.handlers.characterboundsupdate=s=>{let r=[],n=null;for(let a=this.toEditorPos(s.rangeStart),o=this.toEditorPos(s.rangeEnd);a<o;a++){let l=e.coordsForChar(a);n=l&&new DOMRect(l.left,l.top,l.right-l.left,l.bottom-l.top)||n||new DOMRect,r.push(n)}i.updateCharacterBounds(s.rangeStart,r)},this.handlers.textformatupdate=s=>{let r=[];for(let n of s.getTextFormats()){let a=n.underlineStyle,o=n.underlineThickness;if(!/none/i.test(a)&&!/none/i.test(o)){let l=this.toEditorPos(n.rangeStart),c=this.toEditorPos(n.rangeEnd);if(l<c){let h=`text-decoration: underline ${/^[a-z]/.test(a)?a+" ":a=="Dashed"?"dashed ":a=="Squiggle"?"wavy ":""}${/thin/i.test(o)?1:2}px`;r.push(fe.mark({attributes:{style:h}}).range(l,c))}}}e.dispatch({effects:zm.of(fe.set(r))})},this.handlers.compositionstart=()=>{e.inputState.composing<0&&(e.inputState.composing=0,e.inputState.compositionFirstChange=!0)},this.handlers.compositionend=()=>{if(e.inputState.composing=-1,e.inputState.compositionFirstChange=null,this.composing){let{drifted:s}=this.composing;this.composing=null,s&&this.reset(e.state)}};for(let s in this.handlers)i.addEventListener(s,this.handlers[s]);this.measureReq={read:s=>{this.editContext.updateControlBounds(s.contentDOM.getBoundingClientRect());let r=Yr(s.root);r&&r.rangeCount&&this.editContext.updateSelectionBounds(r.getRangeAt(0).getBoundingClientRect())}}}applyEdits(e){let i=0,s=!1,r=this.pendingContextChange;return e.changes.iterChanges((n,a,o,l,c)=>{if(s)return;let h=c.length-(a-n);if(r&&a>=r.to)if(r.from==n&&r.to==a&&r.insert.eq(c)){r=this.pendingContextChange=null,i+=h,this.to+=h;return}else r=null,this.revertPending(e.state);if(n+=i,a+=i,a<=this.from)this.from+=h,this.to+=h;else if(n<this.to){if(n<this.from||a>this.to||this.to-this.from+c.length>3e4){s=!0;return}this.editContext.updateText(this.toContextPos(n),this.toContextPos(a),c.toString()),this.to+=h}i+=h}),r&&!s&&this.revertPending(e.state),!s}update(e){let i=this.pendingContextChange,s=e.startState.selection.main;this.composing&&(this.composing.drifted||!e.changes.touchesRange(s.from,s.to)&&e.transactions.some(r=>!r.isUserEvent("input.type")&&r.changes.touchesRange(this.from,this.to)))?(this.composing.drifted=!0,this.composing.editorBase=e.changes.mapPos(this.composing.editorBase)):!this.applyEdits(e)||!this.rangeIsValid(e.state)?(this.pendingContextChange=null,this.reset(e.state)):(e.docChanged||e.selectionSet||i)&&this.setSelection(e.state),(e.geometryChanged||e.docChanged||e.selectionSet)&&e.view.requestMeasure(this.measureReq)}resetRange(e){let{head:i}=e.selection.main;this.from=Math.max(0,i-1e4),this.to=Math.min(e.doc.length,i+1e4)}reset(e){this.resetRange(e),this.editContext.updateText(0,this.editContext.text.length,e.doc.sliceString(this.from,this.to)),this.setSelection(e)}revertPending(e){let i=this.pendingContextChange;this.pendingContextChange=null,this.editContext.updateText(this.toContextPos(i.from),this.toContextPos(i.from+i.insert.length),e.doc.sliceString(i.from,i.to))}setSelection(e){let{main:i}=e.selection,s=this.toContextPos(Math.max(this.from,Math.min(this.to,i.anchor))),r=this.toContextPos(i.head);(this.editContext.selectionStart!=s||this.editContext.selectionEnd!=r)&&this.editContext.updateSelection(s,r)}rangeIsValid(e){let{head:i}=e.selection.main;return!(this.from>0&&i-this.from<500||this.to<e.doc.length&&this.to-i<500||this.to-this.from>1e4*3)}toEditorPos(e,i=this.to-this.from){e=Math.min(e,i);let s=this.composing;return s&&s.drifted?s.editorBase+(e-s.contextBase):e+this.from}toContextPos(e){let i=this.composing;return i&&i.drifted?i.contextBase+(e-i.editorBase):e-this.from}destroy(){for(let e in this.handlers)this.editContext.removeEventListener(e,this.handlers[e])}}class te{get state(){return this.viewState.state}get viewport(){return this.viewState.viewport}get visibleRanges(){return this.viewState.visibleRanges}get inView(){return this.viewState.inView}get composing(){return!!this.inputState&&this.inputState.composing>0}get compositionStarted(){return!!this.inputState&&this.inputState.composing>=0}get root(){return this._root}get win(){return this.dom.ownerDocument.defaultView||window}constructor(e={}){var i;this.plugins=[],this.pluginMap=new Map,this.editorAttrs={},this.contentAttrs={},this.bidiCache=[],this.destroyed=!1,this.updateState=2,this.measureScheduled=-1,this.measureRequests=[],this.contentDOM=document.createElement("div"),this.scrollDOM=document.createElement("div"),this.scrollDOM.tabIndex=-1,this.scrollDOM.className="cm-scroller",this.scrollDOM.appendChild(this.contentDOM),this.announceDOM=document.createElement("div"),this.announceDOM.className="cm-announced",this.announceDOM.setAttribute("aria-live","polite"),this.dom=document.createElement("div"),this.dom.appendChild(this.announceDOM),this.dom.appendChild(this.scrollDOM),e.parent&&e.parent.appendChild(this.dom);let{dispatch:s}=e;this.dispatchTransactions=e.dispatchTransactions||s&&(r=>r.forEach(n=>s(n,this)))||(r=>this.update(r)),this.dispatch=this.dispatch.bind(this),this._root=e.root||H1(e.parent)||document,this.viewState=new Wp(e.state||Pe.create(e)),e.scrollTo&&e.scrollTo.is(Ja)&&(this.viewState.scrollTarget=e.scrollTo.value.clip(this.viewState.state)),this.plugins=this.state.facet(Nr).map(r=>new cc(r));for(let r of this.plugins)r.update(this);this.observer=new vk(this),this.inputState=new Wx(this),this.inputState.ensureHandlers(this.plugins),this.docView=new Cp(this),this.mountStyles(),this.updateAttrs(),this.updateState=0,this.requestMeasure(),!((i=document.fonts)===null||i===void 0)&&i.ready&&document.fonts.ready.then(()=>{this.viewState.mustMeasureContent=!0,this.requestMeasure()})}dispatch(...e){let i=e.length==1&&e[0]instanceof et?e:e.length==1&&Array.isArray(e[0])?e[0]:[this.state.update(...e)];this.dispatchTransactions(i,this)}update(e){if(this.updateState!=0)throw new Error("Calls to EditorView.update are not allowed while an update is in progress");let i=!1,s=!1,r,n=this.state;for(let u of e){if(u.startState!=n)throw new RangeError("Trying to update state with a transaction that doesn't start from the previous state.");n=u.state}if(this.destroyed){this.viewState.state=n;return}let a=this.hasFocus,o=0,l=null;e.some(u=>u.annotation(hO))?(this.inputState.notifiedFocused=a,o=1):a!=this.inputState.notifiedFocused&&(this.inputState.notifiedFocused=a,l=dO(n,a),l||(o=1));let c=this.observer.delayedAndroidKey,h=null;if(c?(this.observer.clearDelayedAndroidKey(),h=this.observer.readChange(),(h&&!this.state.doc.eq(n.doc)||!this.state.selection.eq(n.selection))&&(h=null)):this.observer.clear(),n.facet(Pe.phrases)!=this.state.facet(Pe.phrases))return this.setState(n);r=qo.create(this,n,e),r.flags|=o;let d=this.viewState.scrollTarget;try{this.updateState=2;for(let u of e){if(d&&(d=d.map(u.changes)),u.scrollIntoView){let{main:p}=u.state.selection;d=new Ur(p.empty?p:X.cursor(p.head,p.head>p.anchor?-1:1))}for(let p of u.effects)p.is(Ja)&&(d=p.value.clip(this.state))}this.viewState.update(r,d),this.bidiCache=Fo.update(this.bidiCache,r.changes),r.empty||(this.updatePlugins(r),this.inputState.update(r)),i=this.docView.update(r),this.state.facet(Ln)!=this.styleModules&&this.mountStyles(),s=this.updateAttrs(),this.showAnnouncements(e),this.docView.updateSelection(i,e.some(u=>u.isUserEvent("select.pointer")))}finally{this.updateState=0}if(r.startState.facet(no)!=r.state.facet(no)&&(this.viewState.mustMeasureContent=!0),(i||s||d||this.viewState.mustEnforceCursorAssoc||this.viewState.mustMeasureContent)&&this.requestMeasure(),i&&this.docViewUpdate(),!r.empty)for(let u of this.state.facet(wh))try{u(r)}catch(p){_i(this.state,p,"update listener")}(l||h)&&Promise.resolve().then(()=>{l&&this.state==l.startState&&this.dispatch(l),h&&!sO(this,h)&&c.force&&Fr(this.contentDOM,c.key,c.keyCode)})}setState(e){if(this.updateState!=0)throw new Error("Calls to EditorView.setState are not allowed while an update is in progress");if(this.destroyed){this.viewState.state=e;return}this.updateState=2;let i=this.hasFocus;try{for(let s of this.plugins)s.destroy(this);this.viewState=new Wp(e),this.plugins=e.facet(Nr).map(s=>new cc(s)),this.pluginMap.clear();for(let s of this.plugins)s.update(this);this.docView.destroy(),this.docView=new Cp(this),this.inputState.ensureHandlers(this.plugins),this.mountStyles(),this.updateAttrs(),this.bidiCache=[]}finally{this.updateState=0}i&&this.focus(),this.requestMeasure()}updatePlugins(e){let i=e.startState.facet(Nr),s=e.state.facet(Nr);if(i!=s){let r=[];for(let n of s){let a=i.indexOf(n);if(a<0)r.push(new cc(n));else{let o=this.plugins[a];o.mustUpdate=e,r.push(o)}}for(let n of this.plugins)n.mustUpdate!=e&&n.destroy(this);this.plugins=r,this.pluginMap.clear()}else for(let r of this.plugins)r.mustUpdate=e;for(let r=0;r<this.plugins.length;r++)this.plugins[r].update(this);i!=s&&this.inputState.ensureHandlers(this.plugins)}docViewUpdate(){for(let e of this.plugins){let i=e.value;if(i&&i.docViewUpdate)try{i.docViewUpdate(this)}catch(s){_i(this.state,s,"doc view update listener")}}}measure(e=!0){if(this.destroyed)return;if(this.measureScheduled>-1&&this.win.cancelAnimationFrame(this.measureScheduled),this.observer.delayedAndroidKey){this.measureScheduled=-1,this.requestMeasure();return}this.measureScheduled=0,e&&this.observer.forceFlush();let i=null,s=this.scrollDOM,r=s.scrollTop*this.scaleY,{scrollAnchorPos:n,scrollAnchorHeight:a}=this.viewState;Math.abs(r-this.viewState.scrollTop)>1&&(a=-1),this.viewState.scrollAnchorHeight=-1;try{for(let o=0;;o++){if(a<0)if(_m(s))n=-1,a=this.viewState.heightMap.height;else{let p=this.viewState.scrollAnchorAt(r);n=p.from,a=p.top}this.updateState=1;let l=this.viewState.measure(this);if(!l&&!this.measureRequests.length&&this.viewState.scrollTarget==null)break;if(o>5){console.warn(this.measureRequests.length?"Measure loop restarted more than 5 times":"Viewport failed to stabilize");break}let c=[];l&4||([this.measureRequests,c]=[c,this.measureRequests]);let h=c.map(p=>{try{return p.read(this)}catch(f){return _i(this.state,f),Xp}}),d=qo.create(this,this.state,[]),u=!1;d.flags|=l,i?i.flags|=l:i=d,this.updateState=2,d.empty||(this.updatePlugins(d),this.inputState.update(d),this.updateAttrs(),u=this.docView.update(d),u&&this.docViewUpdate());for(let p=0;p<c.length;p++)if(h[p]!=Xp)try{let f=c[p];f.write&&f.write(h[p],this)}catch(f){_i(this.state,f)}if(u&&this.docView.updateSelection(!0),!d.viewportChanged&&this.measureRequests.length==0){if(this.viewState.editorHeight)if(this.viewState.scrollTarget){this.docView.scrollIntoView(this.viewState.scrollTarget),this.viewState.scrollTarget=null,a=-1;continue}else{let f=(n<0?this.viewState.heightMap.height:this.viewState.lineBlockAt(n).top)-a;if(f>1||f<-1){r=r+f,s.scrollTop=r/this.scaleY,a=-1;continue}}break}}}finally{this.updateState=0,this.measureScheduled=-1}if(i&&!i.empty)for(let o of this.state.facet(wh))o(i)}get themeClasses(){return Ph+" "+(this.state.facet(Eh)?gO:fO)+" "+this.state.facet(no)}updateAttrs(){let e=Gp(this,Xm,{class:"cm-editor"+(this.hasFocus?" cm-focused ":" ")+this.themeClasses}),i={spellcheck:"false",autocorrect:"off",autocapitalize:"off",writingsuggestions:"false",translate:"no",contenteditable:this.state.facet(Hi)?"true":"false",class:"cm-content",style:`${K.tabSize}: ${this.state.tabSize}`,role:"textbox","aria-multiline":"true"};this.state.readOnly&&(i["aria-readonly"]="true"),Gp(this,xd,i);let s=this.observer.ignore(()=>{let r=Sp(this.contentDOM,this.contentAttrs,i),n=Sp(this.dom,this.editorAttrs,e);return r||n});return this.editorAttrs=e,this.contentAttrs=i,s}showAnnouncements(e){let i=!0;for(let s of e)for(let r of s.effects)if(r.is(te.announce)){i&&(this.announceDOM.textContent=""),i=!1;let n=this.announceDOM.appendChild(document.createElement("div"));n.textContent=r.value}}mountStyles(){this.styleModules=this.state.facet(Ln);let e=this.state.facet(te.cspNonce);xs.mount(this.root,this.styleModules.concat(Ok).reverse(),e?{nonce:e}:void 0)}readMeasured(){if(this.updateState==2)throw new Error("Reading the editor layout isn't allowed during an update");this.updateState==0&&this.measureScheduled>-1&&this.measure(!1)}requestMeasure(e){if(this.measureScheduled<0&&(this.measureScheduled=this.win.requestAnimationFrame(()=>this.measure())),e){if(this.measureRequests.indexOf(e)>-1)return;if(e.key!=null){for(let i=0;i<this.measureRequests.length;i++)if(this.measureRequests[i].key===e.key){this.measureRequests[i]=e;return}}this.measureRequests.push(e)}}plugin(e){let i=this.pluginMap.get(e);return(i===void 0||i&&i.plugin!=e)&&this.pluginMap.set(e,i=this.plugins.find(s=>s.plugin==e)||null),i&&i.update(this).value}get documentTop(){return this.contentDOM.getBoundingClientRect().top+this.viewState.paddingTop}get documentPadding(){return{top:this.viewState.paddingTop,bottom:this.viewState.paddingBottom}}get scaleX(){return this.viewState.scaleX}get scaleY(){return this.viewState.scaleY}elementAtHeight(e){return this.readMeasured(),this.viewState.elementAtHeight(e)}lineBlockAtHeight(e){return this.readMeasured(),this.viewState.lineBlockAtHeight(e)}get viewportLineBlocks(){return this.viewState.viewportLines}lineBlockAt(e){return this.viewState.lineBlockAt(e)}get contentHeight(){return this.viewState.contentHeight}moveByChar(e,i,s){return pc(this,e,_p(this,e,i,s))}moveByGroup(e,i){return pc(this,e,_p(this,e,i,s=>Qx(this,e.head,s)))}visualLineSide(e,i){let s=this.bidiSpans(e),r=this.textDirectionAt(e.from),n=s[i?s.length-1:0];return X.cursor(n.side(i,r)+e.from,n.forward(!i,r)?1:-1)}moveToLineBoundary(e,i,s=!0){return Ix(this,e,i,s)}moveVertically(e,i,s){return pc(this,e,Ax(this,e,i,s))}domAtPos(e,i=1){return this.docView.domAtPos(e,i)}posAtDOM(e,i=0){return this.docView.posFromDOM(e,i)}posAtCoords(e,i=!0){this.readMeasured();let s=kh(this,e,i);return s&&s.pos}posAndSideAtCoords(e,i=!0){return this.readMeasured(),kh(this,e,i)}coordsAtPos(e,i=1){this.readMeasured();let s=this.docView.coordsAt(e,i);if(!s||s.left==s.right)return s;let r=this.state.doc.lineAt(e),n=this.bidiSpans(r),a=n[Ji.find(n,e-r.from,-1,i)];return Mo(s,a.dir==Fe.LTR==i>0)}coordsForChar(e){return this.readMeasured(),this.docView.coordsForChar(e)}get defaultCharacterWidth(){return this.viewState.heightOracle.charWidth}get defaultLineHeight(){return this.viewState.heightOracle.lineHeight}get textDirection(){return this.viewState.defaultTextDirection}textDirectionAt(e){return!this.state.facet(Fm)||e<this.viewport.from||e>this.viewport.to?this.textDirection:(this.readMeasured(),this.docView.textDirectionAt(e))}get lineWrapping(){return this.viewState.heightOracle.lineWrapping}bidiSpans(e){if(e.length>Sk)return Lm(e.length);let i=this.textDirectionAt(e.from),s;for(let n of this.bidiCache)if(n.from==e.from&&n.dir==i&&(n.fresh||Am(n.isolates,s=Tp(this,e))))return n.order;s||(s=Tp(this,e));let r=nx(e.text,i,s);return this.bidiCache.push(new Fo(e.from,e.to,i,s,!0,r)),r}get hasFocus(){var e;return(this.dom.ownerDocument.hasFocus()||K.safari&&((e=this.inputState)===null||e===void 0?void 0:e.lastContextMenu)>Date.now()-3e4)&&this.root.activeElement==this.contentDOM}focus(){this.observer.ignore(()=>{Cm(this.contentDOM),this.docView.updateSelection()})}setRoot(e){this._root!=e&&(this._root=e,this.observer.setWindow((e.nodeType==9?e:e.ownerDocument).defaultView||window),this.mountStyles())}destroy(){this.root.activeElement==this.contentDOM&&this.contentDOM.blur();for(let e of this.plugins)e.destroy(this);this.plugins=[],this.inputState.destroy(),this.docView.destroy(),this.dom.remove(),this.observer.destroy(),this.measureScheduled>-1&&this.win.cancelAnimationFrame(this.measureScheduled),this.destroyed=!0}static scrollIntoView(e,i={}){return Ja.of(new Ur(typeof e=="number"?X.cursor(e):e,i.y,i.x,i.yMargin,i.xMargin))}scrollSnapshot(){let{scrollTop:e,scrollLeft:i}=this.scrollDOM,s=this.viewState.scrollAnchorAt(e);return Ja.of(new Ur(X.cursor(s.from),"start","start",s.top-e,i,!0))}setTabFocusMode(e){e==null?this.inputState.tabFocusMode=this.inputState.tabFocusMode<0?0:-1:typeof e=="boolean"?this.inputState.tabFocusMode=e?0:-1:this.inputState.tabFocusMode!=0&&(this.inputState.tabFocusMode=Date.now()+e)}static domEventHandlers(e){return Lt.define(()=>({}),{eventHandlers:e})}static domEventObservers(e){return Lt.define(()=>({}),{eventObservers:e})}static theme(e,i){let s=xs.newName(),r=[no.of(s),Ln.of(Ch(`.${s}`,e))];return i&&i.dark&&r.push(Eh.of(!0)),r}static baseTheme(e){return wa.lowest(Ln.of(Ch("."+Ph,e,mO)))}static findFromDOM(e){var i;let s=e.querySelector(".cm-content"),r=s&&tt.get(s)||tt.get(e);return((i=r==null?void 0:r.root)===null||i===void 0?void 0:i.view)||null}}te.styleModule=Ln;te.inputHandler=jm;te.clipboardInputFilter=wd;te.clipboardOutputFilter=Sd;te.scrollHandler=Vm;te.focusChangeEffect=Wm;te.perLineTextDirection=Fm;te.exceptionSink=Bm;te.updateListener=wh;te.editable=Hi;te.mouseSelectionStyle=Dm;te.dragMovesSelection=qm;te.clickAddsSelectionRange=Mm;te.decorations=pl;te.blockWrappers=Gm;te.outerDecorations=kd;te.atomicRanges=ka;te.bidiIsolatedRanges=Ym;te.scrollMargins=Zm;te.darkTheme=Eh;te.cspNonce=se.define({combine:t=>t.length?t[0]:""});te.contentAttributes=xd;te.editorAttributes=Xm;te.lineWrapping=te.contentAttributes.of({class:"cm-lineWrapping"});te.announce=Ie.define();const Sk=4096,Xp={};class Fo{constructor(e,i,s,r,n,a){this.from=e,this.to=i,this.dir=s,this.isolates=r,this.fresh=n,this.order=a}static update(e,i){if(i.empty&&!e.some(n=>n.fresh))return e;let s=[],r=e.length?e[e.length-1].dir:Fe.LTR;for(let n=Math.max(0,e.length-10);n<e.length;n++){let a=e[n];a.dir==r&&!i.touchesRange(a.from,a.to)&&s.push(new Fo(i.mapPos(a.from,1),i.mapPos(a.to,-1),a.dir,a.isolates,!1,a.order))}return s}}function Gp(t,e,i){for(let s=t.state.facet(e),r=s.length-1;r>=0;r--){let n=s[r],a=typeof n=="function"?n(t):n;a&&yd(a,i)}return i}const xk=K.mac?"mac":K.windows?"win":K.linux?"linux":"key";function kk(t,e){const i=t.split(/-(?!$)/);let s=i[i.length-1];s=="Space"&&(s=" ");let r,n,a,o;for(let l=0;l<i.length-1;++l){const c=i[l];if(/^(cmd|meta|m)$/i.test(c))o=!0;else if(/^a(lt)?$/i.test(c))r=!0;else if(/^(c|ctrl|control)$/i.test(c))n=!0;else if(/^s(hift)?$/i.test(c))a=!0;else if(/^mod$/i.test(c))e=="mac"?o=!0:n=!0;else throw new Error("Unrecognized modifier name: "+c)}return r&&(s="Alt-"+s),n&&(s="Ctrl-"+s),o&&(s="Meta-"+s),a&&(s="Shift-"+s),s}function ao(t,e,i){return e.altKey&&(t="Alt-"+t),e.ctrlKey&&(t="Ctrl-"+t),e.metaKey&&(t="Meta-"+t),i!==!1&&e.shiftKey&&(t="Shift-"+t),t}const Tk=wa.default(te.domEventHandlers({keydown(t,e){return _k(Ek(e.state),t,e,"editor")}})),Cd=se.define({enables:Tk}),Yp=new WeakMap;function Ek(t){let e=t.facet(Cd),i=Yp.get(e);return i||Yp.set(e,i=Ck(e.reduce((s,r)=>s.concat(r),[]))),i}let Os=null;const Pk=4e3;function Ck(t,e=xk){let i=Object.create(null),s=Object.create(null),r=(a,o)=>{let l=s[a];if(l==null)s[a]=o;else if(l!=o)throw new Error("Key binding "+a+" is used both as a regular binding and as a multi-stroke prefix")},n=(a,o,l,c,h)=>{var d,u;let p=i[a]||(i[a]=Object.create(null)),f=o.split(/ (?!$)/).map(y=>kk(y,e));for(let y=1;y<f.length;y++){let b=f.slice(0,y).join(" ");r(b,!0),p[b]||(p[b]={preventDefault:!0,stopPropagation:!1,run:[w=>{let k=Os={view:w,prefix:b,scope:a};return setTimeout(()=>{Os==k&&(Os=null)},Pk),!0}]})}let g=f.join(" ");r(g,!1);let m=p[g]||(p[g]={preventDefault:!1,stopPropagation:!1,run:((u=(d=p._any)===null||d===void 0?void 0:d.run)===null||u===void 0?void 0:u.slice())||[]});l&&m.run.push(l),c&&(m.preventDefault=!0),h&&(m.stopPropagation=!0)};for(let a of t){let o=a.scope?a.scope.split(" "):["editor"];if(a.any)for(let c of o){let h=i[c]||(i[c]=Object.create(null));h._any||(h._any={preventDefault:!1,stopPropagation:!1,run:[]});let{any:d}=a;for(let u in h)h[u].run.push(p=>d(p,_h))}let l=a[e]||a.key;if(l)for(let c of o)n(c,l,a.run,a.preventDefault,a.stopPropagation),a.shift&&n(c,"Shift-"+l,a.shift,a.preventDefault,a.stopPropagation)}return i}let _h=null;function _k(t,e,i,s){_h=e;let r=W1(e),n=dm(r,0),a=E1(n)==r.length&&r!=" ",o="",l=!1,c=!1,h=!1;Os&&Os.view==i&&Os.scope==s&&(o=Os.prefix+" ",aO.indexOf(e.keyCode)<0&&(c=!0,Os=null));let d=new Set,u=m=>{if(m){for(let y of m.run)if(!d.has(y)&&(d.add(y),y(i)))return m.stopPropagation&&(h=!0),!0;m.preventDefault&&(m.stopPropagation&&(h=!0),c=!0)}return!1},p=t[s],f,g;return p&&(u(p[o+ao(r,e,!a)])?l=!0:a&&(e.altKey||e.metaKey||e.ctrlKey)&&!(K.windows&&e.ctrlKey&&e.altKey)&&!(K.mac&&e.altKey&&!(e.ctrlKey||e.metaKey))&&(f=ks[e.keyCode])&&f!=r?(u(p[o+ao(f,e,!0)])||e.shiftKey&&(g=ca[e.keyCode])!=r&&g!=f&&u(p[o+ao(g,e,!1)]))&&(l=!0):a&&e.shiftKey&&u(p[o+ao(r,e,!0)])&&(l=!0),!l&&u(p._any)&&(l=!0)),c&&(l=!0),l&&h&&e.stopPropagation(),_h=null,l}class Ta{constructor(e,i,s,r,n){this.className=e,this.left=i,this.top=s,this.width=r,this.height=n}draw(){let e=document.createElement("div");return e.className=this.className,this.adjust(e),e}update(e,i){return i.className!=this.className?!1:(this.adjust(e),!0)}adjust(e){e.style.left=this.left+"px",e.style.top=this.top+"px",this.width!=null&&(e.style.width=this.width+"px"),e.style.height=this.height+"px"}eq(e){return this.left==e.left&&this.top==e.top&&this.width==e.width&&this.height==e.height&&this.className==e.className}static forRange(e,i,s){if(s.empty){let r=e.coordsAtPos(s.head,s.assoc||1);if(!r)return[];let n=OO(e);return[new Ta(i,r.left-n.left,r.top-n.top,null,r.bottom-r.top)]}else return Rk(e,i,s)}}function OO(t){let e=t.scrollDOM.getBoundingClientRect();return{left:(t.textDirection==Fe.LTR?e.left:e.right-t.scrollDOM.clientWidth*t.scaleX)-t.scrollDOM.scrollLeft*t.scaleX,top:e.top-t.scrollDOM.scrollTop*t.scaleY}}function Zp(t,e,i,s){let r=t.coordsAtPos(e,i*2);if(!r)return s;let n=t.dom.getBoundingClientRect(),a=(r.top+r.bottom)/2,o=t.posAtCoords({x:n.left+1,y:a}),l=t.posAtCoords({x:n.right-1,y:a});return o==null||l==null?s:{from:Math.max(s.from,Math.min(o,l)),to:Math.min(s.to,Math.max(o,l))}}function Rk(t,e,i){if(i.to<=t.viewport.from||i.from>=t.viewport.to)return[];let s=Math.max(i.from,t.viewport.from),r=Math.min(i.to,t.viewport.to),n=t.textDirection==Fe.LTR,a=t.contentDOM,o=a.getBoundingClientRect(),l=OO(t),c=a.querySelector(".cm-line"),h=c&&window.getComputedStyle(c),d=o.left+(h?parseInt(h.paddingLeft)+Math.min(0,parseInt(h.textIndent)):0),u=o.right-(h?parseInt(h.paddingRight):0),p=xh(t,s,1),f=xh(t,r,-1),g=p.type==yt.Text?p:null,m=f.type==yt.Text?f:null;if(g&&(t.lineWrapping||p.widgetLineBreaks)&&(g=Zp(t,s,1,g)),m&&(t.lineWrapping||f.widgetLineBreaks)&&(m=Zp(t,r,-1,m)),g&&m&&g.from==m.from&&g.to==m.to)return b(w(i.from,i.to,g));{let x=g?w(i.from,null,g):k(p,!1),E=m?w(null,i.to,m):k(f,!0),_=[];return(g||p).to<(m||f).from-(g&&m?1:0)||p.widgetLineBreaks>1&&x.bottom+t.defaultLineHeight/2<E.top?_.push(y(d,x.bottom,u,E.top)):x.bottom<E.top&&t.elementAtHeight((x.bottom+E.top)/2).type==yt.Text&&(x.bottom=E.top=(x.bottom+E.top)/2),b(x).concat(_).concat(b(E))}function y(x,E,_,R){return new Ta(e,x-l.left,E-l.top,_-x,R-E)}function b({top:x,bottom:E,horizontal:_}){let R=[];for(let C=0;C<_.length;C+=2)R.push(y(_[C],x,_[C+1],E));return R}function w(x,E,_){let R=1e9,C=-1e9,D=[];function q(L,W,M,G,J){let ce=t.coordsAtPos(L,L==_.to?-2:2),re=t.coordsAtPos(M,M==_.from?2:-2);!ce||!re||(R=Math.min(ce.top,re.top,R),C=Math.max(ce.bottom,re.bottom,C),J==Fe.LTR?D.push(n&&W?d:ce.left,n&&G?u:re.right):D.push(!n&&G?d:re.left,!n&&W?u:ce.right))}let A=x??_.from,F=E??_.to;for(let L of t.visibleRanges)if(L.to>A&&L.from<F)for(let W=Math.max(L.from,A),M=Math.min(L.to,F);;){let G=t.state.doc.lineAt(W);for(let J of t.bidiSpans(G)){let ce=J.from+G.from,re=J.to+G.from;if(ce>=M)break;re>W&&q(Math.max(ce,W),x==null&&ce<=A,Math.min(re,M),E==null&&re>=F,J.dir)}if(W=G.to+1,W>=M)break}return D.length==0&&q(A,x==null,F,E==null,t.textDirection),{top:R,bottom:C,horizontal:D}}function k(x,E){let _=o.top+(E?x.top:x.bottom);return{top:_,bottom:_,horizontal:[]}}}function $k(t,e){return t.constructor==e.constructor&&t.eq(e)}class Ik{constructor(e,i){this.view=e,this.layer=i,this.drawn=[],this.scaleX=1,this.scaleY=1,this.measureReq={read:this.measure.bind(this),write:this.draw.bind(this)},this.dom=e.scrollDOM.appendChild(document.createElement("div")),this.dom.classList.add("cm-layer"),i.above&&this.dom.classList.add("cm-layer-above"),i.class&&this.dom.classList.add(i.class),this.scale(),this.dom.setAttribute("aria-hidden","true"),this.setOrder(e.state),e.requestMeasure(this.measureReq),i.mount&&i.mount(this.dom,e)}update(e){e.startState.facet(So)!=e.state.facet(So)&&this.setOrder(e.state),(this.layer.update(e,this.dom)||e.geometryChanged)&&(this.scale(),e.view.requestMeasure(this.measureReq))}docViewUpdate(e){this.layer.updateOnDocViewUpdate!==!1&&e.requestMeasure(this.measureReq)}setOrder(e){let i=0,s=e.facet(So);for(;i<s.length&&s[i]!=this.layer;)i++;this.dom.style.zIndex=String((this.layer.above?150:-1)-i)}measure(){return this.layer.markers(this.view)}scale(){let{scaleX:e,scaleY:i}=this.view;(e!=this.scaleX||i!=this.scaleY)&&(this.scaleX=e,this.scaleY=i,this.dom.style.transform=`scale(${1/e}, ${1/i})`)}draw(e){if(e.length!=this.drawn.length||e.some((i,s)=>!$k(i,this.drawn[s]))){let i=this.dom.firstChild,s=0;for(let r of e)r.update&&i&&r.constructor&&this.drawn[s].constructor&&r.update(i,this.drawn[s])?(i=i.nextSibling,s++):this.dom.insertBefore(r.draw(),i);for(;i;){let r=i.nextSibling;i.remove(),i=r}this.drawn=e,K.safari&&K.safari_version>=26&&(this.dom.style.display=this.dom.firstChild?"":"none")}}destroy(){this.layer.destroy&&this.layer.destroy(this.dom,this.view),this.dom.remove()}}const So=se.define();function yO(t){return[Lt.define(e=>new Ik(e,t)),So.of(t)]}const ua=se.define({combine(t){return on(t,{cursorBlinkRate:1200,drawRangeCursor:!0},{cursorBlinkRate:(e,i)=>Math.min(e,i),drawRangeCursor:(e,i)=>e||i})}});function Qk(t={}){return[ua.of(t),Ak,Lk,Nk,Um.of(!0)]}function vO(t){return t.startState.facet(ua)!=t.state.facet(ua)}const Ak=yO({above:!0,markers(t){let{state:e}=t,i=e.facet(ua),s=[];for(let r of e.selection.ranges){let n=r==e.selection.main;if(r.empty||i.drawRangeCursor){let a=n?"cm-cursor cm-cursor-primary":"cm-cursor cm-cursor-secondary",o=r.empty?r:X.cursor(r.head,r.head>r.anchor?-1:1);for(let l of Ta.forRange(t,a,o))s.push(l)}}return s},update(t,e){t.transactions.some(s=>s.selection)&&(e.style.animationName=e.style.animationName=="cm-blink"?"cm-blink2":"cm-blink");let i=vO(t);return i&&Hp(t.state,e),t.docChanged||t.selectionSet||i},mount(t,e){Hp(e.state,t)},class:"cm-cursorLayer"});function Hp(t,e){e.style.animationDuration=t.facet(ua).cursorBlinkRate+"ms"}const Lk=yO({above:!1,markers(t){return t.state.selection.ranges.map(e=>e.empty?[]:Ta.forRange(t,"cm-selectionBackground",e)).reduce((e,i)=>e.concat(i))},update(t,e){return t.docChanged||t.selectionSet||t.viewportChanged||vO(t)},class:"cm-selectionLayer"}),Nk=wa.highest(te.theme({".cm-line":{"& ::selection, &::selection":{backgroundColor:"transparent !important"},caretColor:"transparent !important"},".cm-content":{caretColor:"transparent !important","& :focus":{caretColor:"initial !important","&::selection, & ::selection":{backgroundColor:"Highlight !important"}}}})),bO=Ie.define({map(t,e){return t==null?null:e.mapPos(t)}}),qn=Mt.define({create(){return null},update(t,e){return t!=null&&(t=e.changes.mapPos(t)),e.effects.reduce((i,s)=>s.is(bO)?s.value:i,t)}}),Mk=Lt.fromClass(class{constructor(t){this.view=t,this.cursor=null,this.measureReq={read:this.readPos.bind(this),write:this.drawCursor.bind(this)}}update(t){var e;let i=t.state.field(qn);i==null?this.cursor!=null&&((e=this.cursor)===null||e===void 0||e.remove(),this.cursor=null):(this.cursor||(this.cursor=this.view.scrollDOM.appendChild(document.createElement("div")),this.cursor.className="cm-dropCursor"),(t.startState.field(qn)!=i||t.docChanged||t.geometryChanged)&&this.view.requestMeasure(this.measureReq))}readPos(){let{view:t}=this,e=t.state.field(qn),i=e!=null&&t.coordsAtPos(e);if(!i)return null;let s=t.scrollDOM.getBoundingClientRect();return{left:i.left-s.left+t.scrollDOM.scrollLeft*t.scaleX,top:i.top-s.top+t.scrollDOM.scrollTop*t.scaleY,height:i.bottom-i.top}}drawCursor(t){if(this.cursor){let{scaleX:e,scaleY:i}=this.view;t?(this.cursor.style.left=t.left/e+"px",this.cursor.style.top=t.top/i+"px",this.cursor.style.height=t.height/i+"px"):this.cursor.style.left="-100000px"}}destroy(){this.cursor&&this.cursor.remove()}setDropPos(t){this.view.state.field(qn)!=t&&this.view.dispatch({effects:bO.of(t)})}},{eventObservers:{dragover(t){this.setDropPos(this.view.posAtCoords({x:t.clientX,y:t.clientY}))},dragleave(t){(t.target==this.view.contentDOM||!this.view.contentDOM.contains(t.relatedTarget))&&this.setDropPos(null)},dragend(){this.setDropPos(null)},drop(){this.setDropPos(null)}}});function qk(){return[qn,Mk]}function Kp(t,e,i,s,r){e.lastIndex=0;for(let n=t.iterRange(i,s),a=i,o;!n.next().done;a+=n.value.length)if(!n.lineBreak)for(;o=e.exec(n.value);)r(a+o.index,o)}function Dk(t,e){let i=t.visibleRanges;if(i.length==1&&i[0].from==t.viewport.from&&i[0].to==t.viewport.to)return i;let s=[];for(let{from:r,to:n}of i)r=Math.max(t.state.doc.lineAt(r).from,r-e),n=Math.min(t.state.doc.lineAt(n).to,n+e),s.length&&s[s.length-1].to>=r?s[s.length-1].to=n:s.push({from:r,to:n});return s}class Bk{constructor(e){const{regexp:i,decoration:s,decorate:r,boundary:n,maxLength:a=1e3}=e;if(!i.global)throw new RangeError("The regular expression given to MatchDecorator should have its 'g' flag set");if(this.regexp=i,r)this.addMatch=(o,l,c,h)=>r(h,c,c+o[0].length,o,l);else if(typeof s=="function")this.addMatch=(o,l,c,h)=>{let d=s(o,l,c);d&&h(c,c+o[0].length,d)};else if(s)this.addMatch=(o,l,c,h)=>h(c,c+o[0].length,s);else throw new RangeError("Either 'decorate' or 'decoration' should be provided to MatchDecorator");this.boundary=n,this.maxLength=a}createDeco(e){let i=new sr,s=i.add.bind(i);for(let{from:r,to:n}of Dk(e,this.maxLength))Kp(e.state.doc,this.regexp,r,n,(a,o)=>this.addMatch(o,e,a,s));return i.finish()}updateDeco(e,i){let s=1e9,r=-1;return e.docChanged&&e.changes.iterChanges((n,a,o,l)=>{l>=e.view.viewport.from&&o<=e.view.viewport.to&&(s=Math.min(o,s),r=Math.max(l,r))}),e.viewportMoved||r-s>1e3?this.createDeco(e.view):r>-1?this.updateRange(e.view,i.map(e.changes),s,r):i}updateRange(e,i,s,r){for(let n of e.visibleRanges){let a=Math.max(n.from,s),o=Math.min(n.to,r);if(o>=a){let l=e.state.doc.lineAt(a),c=l.to<o?e.state.doc.lineAt(o):l,h=Math.max(n.from,l.from),d=Math.min(n.to,c.to);if(this.boundary){for(;a>l.from;a--)if(this.boundary.test(l.text[a-1-l.from])){h=a;break}for(;o<c.to;o++)if(this.boundary.test(c.text[o-c.from])){d=o;break}}let u=[],p,f=(g,m,y)=>u.push(y.range(g,m));if(l==c)for(this.regexp.lastIndex=h-l.from;(p=this.regexp.exec(l.text))&&p.index<d-l.from;)this.addMatch(p,e,p.index+l.from,f);else Kp(e.state.doc,this.regexp,h,d,(g,m)=>this.addMatch(m,e,g,f));i=i.update({filterFrom:h,filterTo:d,filter:(g,m)=>g<h||m>d,add:u})}}return i}}const Rh=/x/.unicode!=null?"gu":"g",jk=new RegExp(`[\0-\b
--ÂŸÂ­Øœâ€‹â€Žâ€\u2028\u2029â€­â€®â¦â§â©\uFEFFï¿¹-ï¿¼]`,Rh),Wk={0:"null",7:"bell",8:"backspace",10:"newline",11:"vertical tab",13:"carriage return",27:"escape",8203:"zero width space",8204:"zero width non-joiner",8205:"zero width joiner",8206:"left-to-right mark",8207:"right-to-left mark",8232:"line separator",8237:"left-to-right override",8238:"right-to-left override",8294:"left-to-right isolate",8295:"right-to-left isolate",8297:"pop directional isolate",8233:"paragraph separator",65279:"zero width no-break space",65532:"object replacement"};let mc=null;function Fk(){var t;if(mc==null&&typeof document<"u"&&document.body){let e=document.body.style;mc=((t=e.tabSize)!==null&&t!==void 0?t:e.MozTabSize)!=null}return mc||!1}const xo=se.define({combine(t){let e=on(t,{render:null,specialChars:jk,addSpecialChars:null});return(e.replaceTabs=!Fk())&&(e.specialChars=new RegExp("	|"+e.specialChars.source,Rh)),e.addSpecialChars&&(e.specialChars=new RegExp(e.specialChars.source+"|"+e.addSpecialChars.source,Rh)),e}});function Uk(t={}){return[xo.of(t),Vk()]}let Jp=null;function Vk(){return Jp||(Jp=Lt.fromClass(class{constructor(t){this.view=t,this.decorations=fe.none,this.decorationCache=Object.create(null),this.decorator=this.makeDecorator(t.state.facet(xo)),this.decorations=this.decorator.createDeco(t)}makeDecorator(t){return new Bk({regexp:t.specialChars,decoration:(e,i,s)=>{let{doc:r}=i.state,n=dm(e[0],0);if(n==9){let a=r.lineAt(s),o=i.state.tabSize,l=ln(a.text,o,s-a.from);return fe.replace({widget:new Yk((o-l%o)*this.view.defaultCharacterWidth/this.view.scaleX)})}return this.decorationCache[n]||(this.decorationCache[n]=fe.replace({widget:new Gk(t,n)}))},boundary:t.replaceTabs?void 0:/[^]/})}update(t){let e=t.state.facet(xo);t.startState.facet(xo)!=e?(this.decorator=this.makeDecorator(e),this.decorations=this.decorator.createDeco(t.view)):this.decorations=this.decorator.updateDeco(t,this.decorations)}},{decorations:t=>t.decorations}))}const zk="â€¢";function Xk(t){return t>=32?zk:t==10?"â¤":String.fromCharCode(9216+t)}class Gk extends gi{constructor(e,i){super(),this.options=e,this.code=i}eq(e){return e.code==this.code}toDOM(e){let i=Xk(this.code),s=e.state.phrase("Control character")+" "+(Wk[this.code]||"0x"+this.code.toString(16)),r=this.options.render&&this.options.render(this.code,s,i);if(r)return r;let n=document.createElement("span");return n.textContent=i,n.title=s,n.setAttribute("aria-label",s),n.className="cm-specialChar",n}ignoreEvent(){return!1}}class Yk extends gi{constructor(e){super(),this.width=e}eq(e){return e.width==this.width}toDOM(){let e=document.createElement("span");return e.textContent="	",e.className="cm-tab",e.style.width=this.width+"px",e}ignoreEvent(){return!1}}function Zk(){return Kk}const Hk=fe.line({class:"cm-activeLine"}),Kk=Lt.fromClass(class{constructor(t){this.decorations=this.getDeco(t)}update(t){(t.docChanged||t.selectionSet)&&(this.decorations=this.getDeco(t.view))}getDeco(t){let e=-1,i=[];for(let s of t.state.selection.ranges){let r=t.lineBlockAt(s.head);r.from>e&&(i.push(Hk.range(r.from)),e=r.from)}return fe.set(i)}},{decorations:t=>t.decorations}),$h=2e3;function Jk(t,e,i){let s=Math.min(e.line,i.line),r=Math.max(e.line,i.line),n=[];if(e.off>$h||i.off>$h||e.col<0||i.col<0){let a=Math.min(e.off,i.off),o=Math.max(e.off,i.off);for(let l=s;l<=r;l++){let c=t.doc.line(l);c.length<=o&&n.push(X.range(c.from+a,c.to+o))}}else{let a=Math.min(e.col,i.col),o=Math.max(e.col,i.col);for(let l=s;l<=r;l++){let c=t.doc.line(l),h=hh(c.text,a,t.tabSize,!0);if(h<0)n.push(X.cursor(c.to));else{let d=hh(c.text,o,t.tabSize);n.push(X.range(c.from+h,c.from+d))}}}return n}function eT(t,e){let i=t.coordsAtPos(t.viewport.from);return i?Math.round(Math.abs((i.left-e)/t.defaultCharacterWidth)):-1}function ef(t,e){let i=t.posAtCoords({x:e.clientX,y:e.clientY},!1),s=t.state.doc.lineAt(i),r=i-s.from,n=r>$h?-1:r==s.length?eT(t,e.clientX):ln(s.text,t.state.tabSize,i-s.from);return{line:s.number,col:n,off:r}}function tT(t,e){let i=ef(t,e),s=t.state.selection;return i?{update(r){if(r.docChanged){let n=r.changes.mapPos(r.startState.doc.line(i.line).from),a=r.state.doc.lineAt(n);i={line:a.number,col:i.col,off:Math.min(i.off,a.length)},s=s.map(r.changes)}},get(r,n,a){let o=ef(t,r);if(!o)return s;let l=Jk(t.state,i,o);return l.length?a?X.create(l.concat(s.ranges)):X.create(l):s}}:null}function iT(t){let e=i=>i.altKey&&i.button==0;return te.mouseSelectionStyle.of((i,s)=>e(s)?tT(i,s):null)}const sT={Alt:[18,t=>!!t.altKey],Control:[17,t=>!!t.ctrlKey],Shift:[16,t=>!!t.shiftKey],Meta:[91,t=>!!t.metaKey]},rT={style:"cursor: crosshair"};function nT(t={}){let[e,i]=sT[t.key||"Alt"],s=Lt.fromClass(class{constructor(r){this.view=r,this.isDown=!1}set(r){this.isDown!=r&&(this.isDown=r,this.view.update([]))}},{eventObservers:{keydown(r){this.set(r.keyCode==e||i(r))},keyup(r){(r.keyCode==e||!i(r))&&this.set(!1)},mousemove(r){this.set(i(r))}}});return[s,te.contentAttributes.of(r=>{var n;return!((n=r.plugin(s))===null||n===void 0)&&n.isDown?rT:null})]}class ts extends Ss{compare(e){return this==e||this.constructor==e.constructor&&this.eq(e)}eq(e){return!1}destroy(e){}}ts.prototype.elementClass="";ts.prototype.toDOM=void 0;ts.prototype.mapMode=Ct.TrackBefore;ts.prototype.startSide=ts.prototype.endSide=-1;ts.prototype.point=!0;const ko=se.define(),aT=se.define(),oT={class:"",renderEmptyElements:!1,elementStyle:"",markers:()=>Se.empty,lineMarker:()=>null,widgetMarker:()=>null,lineMarkerChange:null,initialSpacer:null,updateSpacer:null,domEventHandlers:{},side:"before"},Yn=se.define();function lT(t){return[wO(),Yn.of({...oT,...t})]}const tf=se.define({combine:t=>t.some(e=>e)});function wO(t){return[cT]}const cT=Lt.fromClass(class{constructor(t){this.view=t,this.domAfter=null,this.prevViewport=t.viewport,this.dom=document.createElement("div"),this.dom.className="cm-gutters cm-gutters-before",this.dom.setAttribute("aria-hidden","true"),this.dom.style.minHeight=this.view.contentHeight/this.view.scaleY+"px",this.gutters=t.state.facet(Yn).map(e=>new rf(t,e)),this.fixed=!t.state.facet(tf);for(let e of this.gutters)e.config.side=="after"?this.getDOMAfter().appendChild(e.dom):this.dom.appendChild(e.dom);this.fixed&&(this.dom.style.position="sticky"),this.syncGutters(!1),t.scrollDOM.insertBefore(this.dom,t.contentDOM)}getDOMAfter(){return this.domAfter||(this.domAfter=document.createElement("div"),this.domAfter.className="cm-gutters cm-gutters-after",this.domAfter.setAttribute("aria-hidden","true"),this.domAfter.style.minHeight=this.view.contentHeight/this.view.scaleY+"px",this.domAfter.style.position=this.fixed?"sticky":"",this.view.scrollDOM.appendChild(this.domAfter)),this.domAfter}update(t){if(this.updateGutters(t)){let e=this.prevViewport,i=t.view.viewport,s=Math.min(e.to,i.to)-Math.max(e.from,i.from);this.syncGutters(s<(i.to-i.from)*.8)}if(t.geometryChanged){let e=this.view.contentHeight/this.view.scaleY+"px";this.dom.style.minHeight=e,this.domAfter&&(this.domAfter.style.minHeight=e)}this.view.state.facet(tf)!=!this.fixed&&(this.fixed=!this.fixed,this.dom.style.position=this.fixed?"sticky":"",this.domAfter&&(this.domAfter.style.position=this.fixed?"sticky":"")),this.prevViewport=t.view.viewport}syncGutters(t){let e=this.dom.nextSibling;t&&(this.dom.remove(),this.domAfter&&this.domAfter.remove());let i=Se.iter(this.view.state.facet(ko),this.view.viewport.from),s=[],r=this.gutters.map(n=>new hT(n,this.view.viewport,-this.view.documentPadding.top));for(let n of this.view.viewportLineBlocks)if(s.length&&(s=[]),Array.isArray(n.type)){let a=!0;for(let o of n.type)if(o.type==yt.Text&&a){Ih(i,s,o.from);for(let l of r)l.line(this.view,o,s);a=!1}else if(o.widget)for(let l of r)l.widget(this.view,o)}else if(n.type==yt.Text){Ih(i,s,n.from);for(let a of r)a.line(this.view,n,s)}else if(n.widget)for(let a of r)a.widget(this.view,n);for(let n of r)n.finish();t&&(this.view.scrollDOM.insertBefore(this.dom,e),this.domAfter&&this.view.scrollDOM.appendChild(this.domAfter))}updateGutters(t){let e=t.startState.facet(Yn),i=t.state.facet(Yn),s=t.docChanged||t.heightChanged||t.viewportChanged||!Se.eq(t.startState.facet(ko),t.state.facet(ko),t.view.viewport.from,t.view.viewport.to);if(e==i)for(let r of this.gutters)r.update(t)&&(s=!0);else{s=!0;let r=[];for(let n of i){let a=e.indexOf(n);a<0?r.push(new rf(this.view,n)):(this.gutters[a].update(t),r.push(this.gutters[a]))}for(let n of this.gutters)n.dom.remove(),r.indexOf(n)<0&&n.destroy();for(let n of r)n.config.side=="after"?this.getDOMAfter().appendChild(n.dom):this.dom.appendChild(n.dom);this.gutters=r}return s}destroy(){for(let t of this.gutters)t.destroy();this.dom.remove(),this.domAfter&&this.domAfter.remove()}},{provide:t=>te.scrollMargins.of(e=>{let i=e.plugin(t);if(!i||i.gutters.length==0||!i.fixed)return null;let s=i.dom.offsetWidth*e.scaleX,r=i.domAfter?i.domAfter.offsetWidth*e.scaleX:0;return e.textDirection==Fe.LTR?{left:s,right:r}:{right:s,left:r}})});function sf(t){return Array.isArray(t)?t:[t]}function Ih(t,e,i){for(;t.value&&t.from<=i;)t.from==i&&e.push(t.value),t.next()}class hT{constructor(e,i,s){this.gutter=e,this.height=s,this.i=0,this.cursor=Se.iter(e.markers,i.from)}addElement(e,i,s){let{gutter:r}=this,n=(i.top-this.height)/e.scaleY,a=i.height/e.scaleY;if(this.i==r.elements.length){let o=new SO(e,a,n,s);r.elements.push(o),r.dom.appendChild(o.dom)}else r.elements[this.i].update(e,a,n,s);this.height=i.bottom,this.i++}line(e,i,s){let r=[];Ih(this.cursor,r,i.from),s.length&&(r=r.concat(s));let n=this.gutter.config.lineMarker(e,i,r);n&&r.unshift(n);let a=this.gutter;r.length==0&&!a.config.renderEmptyElements||this.addElement(e,i,r)}widget(e,i){let s=this.gutter.config.widgetMarker(e,i.widget,i),r=s?[s]:null;for(let n of e.state.facet(aT)){let a=n(e,i.widget,i);a&&(r||(r=[])).push(a)}r&&this.addElement(e,i,r)}finish(){let e=this.gutter;for(;e.elements.length>this.i;){let i=e.elements.pop();e.dom.removeChild(i.dom),i.destroy()}}}class rf{constructor(e,i){this.view=e,this.config=i,this.elements=[],this.spacer=null,this.dom=document.createElement("div"),this.dom.className="cm-gutter"+(this.config.class?" "+this.config.class:"");for(let s in i.domEventHandlers)this.dom.addEventListener(s,r=>{let n=r.target,a;if(n!=this.dom&&this.dom.contains(n)){for(;n.parentNode!=this.dom;)n=n.parentNode;let l=n.getBoundingClientRect();a=(l.top+l.bottom)/2}else a=r.clientY;let o=e.lineBlockAtHeight(a-e.documentTop);i.domEventHandlers[s](e,o,r)&&r.preventDefault()});this.markers=sf(i.markers(e)),i.initialSpacer&&(this.spacer=new SO(e,0,0,[i.initialSpacer(e)]),this.dom.appendChild(this.spacer.dom),this.spacer.dom.style.cssText+="visibility: hidden; pointer-events: none")}update(e){let i=this.markers;if(this.markers=sf(this.config.markers(e.view)),this.spacer&&this.config.updateSpacer){let r=this.config.updateSpacer(this.spacer.markers[0],e);r!=this.spacer.markers[0]&&this.spacer.update(e.view,0,0,[r])}let s=e.view.viewport;return!Se.eq(this.markers,i,s.from,s.to)||(this.config.lineMarkerChange?this.config.lineMarkerChange(e):!1)}destroy(){for(let e of this.elements)e.destroy()}}class SO{constructor(e,i,s,r){this.height=-1,this.above=0,this.markers=[],this.dom=document.createElement("div"),this.dom.className="cm-gutterElement",this.update(e,i,s,r)}update(e,i,s,r){this.height!=i&&(this.height=i,this.dom.style.height=i+"px"),this.above!=s&&(this.dom.style.marginTop=(this.above=s)?s+"px":""),dT(this.markers,r)||this.setMarkers(e,r)}setMarkers(e,i){let s="cm-gutterElement",r=this.dom.firstChild;for(let n=0,a=0;;){let o=a,l=n<i.length?i[n++]:null,c=!1;if(l){let h=l.elementClass;h&&(s+=" "+h);for(let d=a;d<this.markers.length;d++)if(this.markers[d].compare(l)){o=d,c=!0;break}}else o=this.markers.length;for(;a<o;){let h=this.markers[a++];if(h.toDOM){h.destroy(r);let d=r.nextSibling;r.remove(),r=d}}if(!l)break;l.toDOM&&(c?r=r.nextSibling:this.dom.insertBefore(l.toDOM(e),r)),c&&a++}this.dom.className=s,this.markers=i}destroy(){this.setMarkers(null,[])}}function dT(t,e){if(t.length!=e.length)return!1;for(let i=0;i<t.length;i++)if(!t[i].compare(e[i]))return!1;return!0}const uT=se.define(),pT=se.define(),Mr=se.define({combine(t){return on(t,{formatNumber:String,domEventHandlers:{}},{domEventHandlers(e,i){let s=Object.assign({},e);for(let r in i){let n=s[r],a=i[r];s[r]=n?(o,l,c)=>n(o,l,c)||a(o,l,c):a}return s}})}});class Oc extends ts{constructor(e){super(),this.number=e}eq(e){return this.number==e.number}toDOM(){return document.createTextNode(this.number)}}function yc(t,e){return t.state.facet(Mr).formatNumber(e,t.state)}const fT=Yn.compute([Mr],t=>({class:"cm-lineNumbers",renderEmptyElements:!1,markers(e){return e.state.facet(uT)},lineMarker(e,i,s){return s.some(r=>r.toDOM)?null:new Oc(yc(e,e.state.doc.lineAt(i.from).number))},widgetMarker:(e,i,s)=>{for(let r of e.state.facet(pT)){let n=r(e,i,s);if(n)return n}return null},lineMarkerChange:e=>e.startState.facet(Mr)!=e.state.facet(Mr),initialSpacer(e){return new Oc(yc(e,nf(e.state.doc.lines)))},updateSpacer(e,i){let s=yc(i.view,nf(i.view.state.doc.lines));return s==e.number?e:new Oc(s)},domEventHandlers:t.facet(Mr).domEventHandlers,side:"before"}));function gT(t={}){return[Mr.of(t),wO(),fT]}function nf(t){let e=9;for(;e<t;)e=e*10+9;return e}const mT=new class extends ts{constructor(){super(...arguments),this.elementClass="cm-activeLineGutter"}},OT=ko.compute(["selection"],t=>{let e=[],i=-1;for(let s of t.selection.ranges){let r=t.doc.lineAt(s.head).from;r>i&&(i=r,e.push(mT.range(r)))}return Se.of(e)});function yT(){return OT}const xO=1024;let vT=0;class vc{constructor(e,i){this.from=e,this.to=i}}class ve{constructor(e={}){this.id=vT++,this.perNode=!!e.perNode,this.deserialize=e.deserialize||(()=>{throw new Error("This node type doesn't define a deserialize function")}),this.combine=e.combine||null}add(e){if(this.perNode)throw new RangeError("Can't add per-node props to node types");return typeof e!="function"&&(e=si.match(e)),i=>{let s=e(i);return s===void 0?null:[this,s]}}}ve.closedBy=new ve({deserialize:t=>t.split(" ")});ve.openedBy=new ve({deserialize:t=>t.split(" ")});ve.group=new ve({deserialize:t=>t.split(" ")});ve.isolate=new ve({deserialize:t=>{if(t&&t!="rtl"&&t!="ltr"&&t!="auto")throw new RangeError("Invalid value for isolate: "+t);return t||"auto"}});ve.contextHash=new ve({perNode:!0});ve.lookAhead=new ve({perNode:!0});ve.mounted=new ve({perNode:!0});class Zn{constructor(e,i,s,r=!1){this.tree=e,this.overlay=i,this.parser=s,this.bracketed=r}static get(e){return e&&e.props&&e.props[ve.mounted.id]}}const bT=Object.create(null);let si=class kO{constructor(e,i,s,r=0){this.name=e,this.props=i,this.id=s,this.flags=r}static define(e){let i=e.props&&e.props.length?Object.create(null):bT,s=(e.top?1:0)|(e.skipped?2:0)|(e.error?4:0)|(e.name==null?8:0),r=new kO(e.name||"",i,e.id,s);if(e.props){for(let n of e.props)if(Array.isArray(n)||(n=n(r)),n){if(n[0].perNode)throw new RangeError("Can't store a per-node prop on a node type");i[n[0].id]=n[1]}}return r}prop(e){return this.props[e.id]}get isTop(){return(this.flags&1)>0}get isSkipped(){return(this.flags&2)>0}get isError(){return(this.flags&4)>0}get isAnonymous(){return(this.flags&8)>0}is(e){if(typeof e=="string"){if(this.name==e)return!0;let i=this.prop(ve.group);return i?i.indexOf(e)>-1:!1}return this.id==e}static match(e){let i=Object.create(null);for(let s in e)for(let r of s.split(" "))i[r]=e[s];return s=>{for(let r=s.prop(ve.group),n=-1;n<(r?r.length:0);n++){let a=i[n<0?s.name:r[n]];if(a)return a}}}};si.none=new si("",Object.create(null),0,8);class _d{constructor(e){this.types=e;for(let i=0;i<e.length;i++)if(e[i].id!=i)throw new RangeError("Node type ids should correspond to array positions when creating a node set")}extend(...e){let i=[];for(let s of this.types){let r=null;for(let n of e){let a=n(s);if(a){r||(r=Object.assign({},s.props));let o=a[1],l=a[0];l.combine&&l.id in r&&(o=l.combine(r[l.id],o)),r[l.id]=o}}i.push(r?new si(s.name,r,s.id,s.flags):s)}return new _d(i)}}const oo=new WeakMap,af=new WeakMap;var je;(function(t){t[t.ExcludeBuffers=1]="ExcludeBuffers",t[t.IncludeAnonymous=2]="IncludeAnonymous",t[t.IgnoreMounts=4]="IgnoreMounts",t[t.IgnoreOverlays=8]="IgnoreOverlays",t[t.EnterBracketed=16]="EnterBracketed"})(je||(je={}));class Ye{constructor(e,i,s,r,n){if(this.type=e,this.children=i,this.positions=s,this.length=r,this.props=null,n&&n.length){this.props=Object.create(null);for(let[a,o]of n)this.props[typeof a=="number"?a:a.id]=o}}toString(){let e=Zn.get(this);if(e&&!e.overlay)return e.tree.toString();let i="";for(let s of this.children){let r=s.toString();r&&(i&&(i+=","),i+=r)}return this.type.name?(/\W/.test(this.type.name)&&!this.type.isError?JSON.stringify(this.type.name):this.type.name)+(i.length?"("+i+")":""):i}cursor(e=0){return new Ah(this.topNode,e)}cursorAt(e,i=0,s=0){let r=oo.get(this)||this.topNode,n=new Ah(r);return n.moveTo(e,i),oo.set(this,n._tree),n}get topNode(){return new At(this,0,0,null)}resolve(e,i=0){let s=pa(oo.get(this)||this.topNode,e,i,!1);return oo.set(this,s),s}resolveInner(e,i=0){let s=pa(af.get(this)||this.topNode,e,i,!0);return af.set(this,s),s}resolveStack(e,i=0){return xT(this,e,i)}iterate(e){let{enter:i,leave:s,from:r=0,to:n=this.length}=e,a=e.mode||0,o=(a&je.IncludeAnonymous)>0;for(let l=this.cursor(a|je.IncludeAnonymous);;){let c=!1;if(l.from<=n&&l.to>=r&&(!o&&l.type.isAnonymous||i(l)!==!1)){if(l.firstChild())continue;c=!0}for(;c&&s&&(o||!l.type.isAnonymous)&&s(l),!l.nextSibling();){if(!l.parent())return;c=!0}}}prop(e){return e.perNode?this.props?this.props[e.id]:void 0:this.type.prop(e)}get propValues(){let e=[];if(this.props)for(let i in this.props)e.push([+i,this.props[i]]);return e}balance(e={}){return this.children.length<=8?this:Id(si.none,this.children,this.positions,0,this.children.length,0,this.length,(i,s,r)=>new Ye(this.type,i,s,r,this.propValues),e.makeTree||((i,s,r)=>new Ye(si.none,i,s,r)))}static build(e){return kT(e)}}Ye.empty=new Ye(si.none,[],[],0);class Rd{constructor(e,i){this.buffer=e,this.index=i}get id(){return this.buffer[this.index-4]}get start(){return this.buffer[this.index-3]}get end(){return this.buffer[this.index-2]}get size(){return this.buffer[this.index-1]}get pos(){return this.index}next(){this.index-=4}fork(){return new Rd(this.buffer,this.index)}}class Es{constructor(e,i,s){this.buffer=e,this.length=i,this.set=s}get type(){return si.none}toString(){let e=[];for(let i=0;i<this.buffer.length;)e.push(this.childString(i)),i=this.buffer[i+3];return e.join(",")}childString(e){let i=this.buffer[e],s=this.buffer[e+3],r=this.set.types[i],n=r.name;if(/\W/.test(n)&&!r.isError&&(n=JSON.stringify(n)),e+=4,s==e)return n;let a=[];for(;e<s;)a.push(this.childString(e)),e=this.buffer[e+3];return n+"("+a.join(",")+")"}findChild(e,i,s,r,n){let{buffer:a}=this,o=-1;for(let l=e;l!=i&&!(TO(n,r,a[l+1],a[l+2])&&(o=l,s>0));l=a[l+3]);return o}slice(e,i,s){let r=this.buffer,n=new Uint16Array(i-e),a=0;for(let o=e,l=0;o<i;){n[l++]=r[o++],n[l++]=r[o++]-s;let c=n[l++]=r[o++]-s;n[l++]=r[o++]-e,a=Math.max(a,c)}return new Es(n,a,this.set)}}function TO(t,e,i,s){switch(t){case-2:return i<e;case-1:return s>=e&&i<e;case 0:return i<e&&s>e;case 1:return i<=e&&s>e;case 2:return s>e;case 4:return!0}}function pa(t,e,i,s){for(var r;t.from==t.to||(i<1?t.from>=e:t.from>e)||(i>-1?t.to<=e:t.to<e);){let a=!s&&t instanceof At&&t.index<0?null:t.parent;if(!a)return t;t=a}let n=s?0:je.IgnoreOverlays;if(s)for(let a=t,o=a.parent;o;a=o,o=a.parent)a instanceof At&&a.index<0&&((r=o.enter(e,i,n))===null||r===void 0?void 0:r.from)!=a.from&&(t=o);for(;;){let a=t.enter(e,i,n);if(!a)return t;t=a}}class EO{cursor(e=0){return new Ah(this,e)}getChild(e,i=null,s=null){let r=of(this,e,i,s);return r.length?r[0]:null}getChildren(e,i=null,s=null){return of(this,e,i,s)}resolve(e,i=0){return pa(this,e,i,!1)}resolveInner(e,i=0){return pa(this,e,i,!0)}matchContext(e){return Qh(this.parent,e)}enterUnfinishedNodesBefore(e){let i=this.childBefore(e),s=this;for(;i;){let r=i.lastChild;if(!r||r.to!=i.to)break;r.type.isError&&r.from==r.to?(s=i,i=r.prevSibling):i=r}return s}get node(){return this}get next(){return this.parent}}class At extends EO{constructor(e,i,s,r){super(),this._tree=e,this.from=i,this.index=s,this._parent=r}get type(){return this._tree.type}get name(){return this._tree.type.name}get to(){return this.from+this._tree.length}nextChild(e,i,s,r,n=0){var a;for(let o=this;;){for(let{children:l,positions:c}=o._tree,h=i>0?l.length:-1;e!=h;e+=i){let d=l[e],u=c[e]+o.from;if(!(!(n&je.EnterBracketed&&d instanceof Ye&&((a=Zn.get(d))===null||a===void 0?void 0:a.overlay)===null&&(u>=s||u+d.length<=s))&&!TO(r,s,u,u+d.length))){if(d instanceof Es){if(n&je.ExcludeBuffers)continue;let p=d.findChild(0,d.buffer.length,i,s-u,r);if(p>-1)return new Ri(new wT(o,d,e,u),null,p)}else if(n&je.IncludeAnonymous||!d.type.isAnonymous||$d(d)){let p;if(!(n&je.IgnoreMounts)&&(p=Zn.get(d))&&!p.overlay)return new At(p.tree,u,e,o);let f=new At(d,u,e,o);return n&je.IncludeAnonymous||!f.type.isAnonymous?f:f.nextChild(i<0?d.children.length-1:0,i,s,r,n)}}}if(n&je.IncludeAnonymous||!o.type.isAnonymous||(o.index>=0?e=o.index+i:e=i<0?-1:o._parent._tree.children.length,o=o._parent,!o))return null}}get firstChild(){return this.nextChild(0,1,0,4)}get lastChild(){return this.nextChild(this._tree.children.length-1,-1,0,4)}childAfter(e){return this.nextChild(0,1,e,2)}childBefore(e){return this.nextChild(this._tree.children.length-1,-1,e,-2)}prop(e){return this._tree.prop(e)}enter(e,i,s=0){let r;if(!(s&je.IgnoreOverlays)&&(r=Zn.get(this._tree))&&r.overlay){let n=e-this.from,a=s&je.EnterBracketed&&r.bracketed;for(let{from:o,to:l}of r.overlay)if((i>0||a?o<=n:o<n)&&(i<0||a?l>=n:l>n))return new At(r.tree,r.overlay[0].from+this.from,-1,this)}return this.nextChild(0,1,e,i,s)}nextSignificantParent(){let e=this;for(;e.type.isAnonymous&&e._parent;)e=e._parent;return e}get parent(){return this._parent?this._parent.nextSignificantParent():null}get nextSibling(){return this._parent&&this.index>=0?this._parent.nextChild(this.index+1,1,0,4):null}get prevSibling(){return this._parent&&this.index>=0?this._parent.nextChild(this.index-1,-1,0,4):null}get tree(){return this._tree}toTree(){return this._tree}toString(){return this._tree.toString()}}function of(t,e,i,s){let r=t.cursor(),n=[];if(!r.firstChild())return n;if(i!=null){for(let a=!1;!a;)if(a=r.type.is(i),!r.nextSibling())return n}for(;;){if(s!=null&&r.type.is(s))return n;if(r.type.is(e)&&n.push(r.node),!r.nextSibling())return s==null?n:[]}}function Qh(t,e,i=e.length-1){for(let s=t;i>=0;s=s.parent){if(!s)return!1;if(!s.type.isAnonymous){if(e[i]&&e[i]!=s.name)return!1;i--}}return!0}class wT{constructor(e,i,s,r){this.parent=e,this.buffer=i,this.index=s,this.start=r}}class Ri extends EO{get name(){return this.type.name}get from(){return this.context.start+this.context.buffer.buffer[this.index+1]}get to(){return this.context.start+this.context.buffer.buffer[this.index+2]}constructor(e,i,s){super(),this.context=e,this._parent=i,this.index=s,this.type=e.buffer.set.types[e.buffer.buffer[s]]}child(e,i,s){let{buffer:r}=this.context,n=r.findChild(this.index+4,r.buffer[this.index+3],e,i-this.context.start,s);return n<0?null:new Ri(this.context,this,n)}get firstChild(){return this.child(1,0,4)}get lastChild(){return this.child(-1,0,4)}childAfter(e){return this.child(1,e,2)}childBefore(e){return this.child(-1,e,-2)}prop(e){return this.type.prop(e)}enter(e,i,s=0){if(s&je.ExcludeBuffers)return null;let{buffer:r}=this.context,n=r.findChild(this.index+4,r.buffer[this.index+3],i>0?1:-1,e-this.context.start,i);return n<0?null:new Ri(this.context,this,n)}get parent(){return this._parent||this.context.parent.nextSignificantParent()}externalSibling(e){return this._parent?null:this.context.parent.nextChild(this.context.index+e,e,0,4)}get nextSibling(){let{buffer:e}=this.context,i=e.buffer[this.index+3];return i<(this._parent?e.buffer[this._parent.index+3]:e.buffer.length)?new Ri(this.context,this._parent,i):this.externalSibling(1)}get prevSibling(){let{buffer:e}=this.context,i=this._parent?this._parent.index+4:0;return this.index==i?this.externalSibling(-1):new Ri(this.context,this._parent,e.findChild(i,this.index,-1,0,4))}get tree(){return null}toTree(){let e=[],i=[],{buffer:s}=this.context,r=this.index+4,n=s.buffer[this.index+3];if(n>r){let a=s.buffer[this.index+1];e.push(s.slice(r,n,a)),i.push(0)}return new Ye(this.type,e,i,this.to-this.from)}toString(){return this.context.buffer.childString(this.index)}}function PO(t){if(!t.length)return null;let e=0,i=t[0];for(let n=1;n<t.length;n++){let a=t[n];(a.from>i.from||a.to<i.to)&&(i=a,e=n)}let s=i instanceof At&&i.index<0?null:i.parent,r=t.slice();return s?r[e]=s:r.splice(e,1),new ST(r,i)}class ST{constructor(e,i){this.heads=e,this.node=i}get next(){return PO(this.heads)}}function xT(t,e,i){let s=t.resolveInner(e,i),r=null;for(let n=s instanceof At?s:s.context.parent;n;n=n.parent)if(n.index<0){let a=n.parent;(r||(r=[s])).push(a.resolve(e,i)),n=a}else{let a=Zn.get(n.tree);if(a&&a.overlay&&a.overlay[0].from<=e&&a.overlay[a.overlay.length-1].to>=e){let o=new At(a.tree,a.overlay[0].from+n.from,-1,n);(r||(r=[s])).push(pa(o,e,i,!1))}}return r?PO(r):s}class Ah{get name(){return this.type.name}constructor(e,i=0){if(this.buffer=null,this.stack=[],this.index=0,this.bufferNode=null,this.mode=i&~je.EnterBracketed,e instanceof At)this.yieldNode(e);else{this._tree=e.context.parent,this.buffer=e.context;for(let s=e._parent;s;s=s._parent)this.stack.unshift(s.index);this.bufferNode=e,this.yieldBuf(e.index)}}yieldNode(e){return e?(this._tree=e,this.type=e.type,this.from=e.from,this.to=e.to,!0):!1}yieldBuf(e,i){this.index=e;let{start:s,buffer:r}=this.buffer;return this.type=i||r.set.types[r.buffer[e]],this.from=s+r.buffer[e+1],this.to=s+r.buffer[e+2],!0}yield(e){return e?e instanceof At?(this.buffer=null,this.yieldNode(e)):(this.buffer=e.context,this.yieldBuf(e.index,e.type)):!1}toString(){return this.buffer?this.buffer.buffer.childString(this.index):this._tree.toString()}enterChild(e,i,s){if(!this.buffer)return this.yield(this._tree.nextChild(e<0?this._tree._tree.children.length-1:0,e,i,s,this.mode));let{buffer:r}=this.buffer,n=r.findChild(this.index+4,r.buffer[this.index+3],e,i-this.buffer.start,s);return n<0?!1:(this.stack.push(this.index),this.yieldBuf(n))}firstChild(){return this.enterChild(1,0,4)}lastChild(){return this.enterChild(-1,0,4)}childAfter(e){return this.enterChild(1,e,2)}childBefore(e){return this.enterChild(-1,e,-2)}enter(e,i,s=this.mode){return this.buffer?s&je.ExcludeBuffers?!1:this.enterChild(1,e,i):this.yield(this._tree.enter(e,i,s))}parent(){if(!this.buffer)return this.yieldNode(this.mode&je.IncludeAnonymous?this._tree._parent:this._tree.parent);if(this.stack.length)return this.yieldBuf(this.stack.pop());let e=this.mode&je.IncludeAnonymous?this.buffer.parent:this.buffer.parent.nextSignificantParent();return this.buffer=null,this.yieldNode(e)}sibling(e){if(!this.buffer)return this._tree._parent?this.yield(this._tree.index<0?null:this._tree._parent.nextChild(this._tree.index+e,e,0,4,this.mode)):!1;let{buffer:i}=this.buffer,s=this.stack.length-1;if(e<0){let r=s<0?0:this.stack[s]+4;if(this.index!=r)return this.yieldBuf(i.findChild(r,this.index,-1,0,4))}else{let r=i.buffer[this.index+3];if(r<(s<0?i.buffer.length:i.buffer[this.stack[s]+3]))return this.yieldBuf(r)}return s<0?this.yield(this.buffer.parent.nextChild(this.buffer.index+e,e,0,4,this.mode)):!1}nextSibling(){return this.sibling(1)}prevSibling(){return this.sibling(-1)}atLastNode(e){let i,s,{buffer:r}=this;if(r){if(e>0){if(this.index<r.buffer.buffer.length)return!1}else for(let n=0;n<this.index;n++)if(r.buffer.buffer[n+3]<this.index)return!1;({index:i,parent:s}=r)}else({index:i,_parent:s}=this._tree);for(;s;{index:i,_parent:s}=s)if(i>-1)for(let n=i+e,a=e<0?-1:s._tree.children.length;n!=a;n+=e){let o=s._tree.children[n];if(this.mode&je.IncludeAnonymous||o instanceof Es||!o.type.isAnonymous||$d(o))return!1}return!0}move(e,i){if(i&&this.enterChild(e,0,4))return!0;for(;;){if(this.sibling(e))return!0;if(this.atLastNode(e)||!this.parent())return!1}}next(e=!0){return this.move(1,e)}prev(e=!0){return this.move(-1,e)}moveTo(e,i=0){for(;(this.from==this.to||(i<1?this.from>=e:this.from>e)||(i>-1?this.to<=e:this.to<e))&&this.parent(););for(;this.enterChild(1,e,i););return this}get node(){if(!this.buffer)return this._tree;let e=this.bufferNode,i=null,s=0;if(e&&e.context==this.buffer)e:for(let r=this.index,n=this.stack.length;n>=0;){for(let a=e;a;a=a._parent)if(a.index==r){if(r==this.index)return a;i=a,s=n+1;break e}r=this.stack[--n]}for(let r=s;r<this.stack.length;r++)i=new Ri(this.buffer,i,this.stack[r]);return this.bufferNode=new Ri(this.buffer,i,this.index)}get tree(){return this.buffer?null:this._tree._tree}iterate(e,i){for(let s=0;;){let r=!1;if(this.type.isAnonymous||e(this)!==!1){if(this.firstChild()){s++;continue}this.type.isAnonymous||(r=!0)}for(;;){if(r&&i&&i(this),r=this.type.isAnonymous,!s)return;if(this.nextSibling())break;this.parent(),s--,r=!0}}}matchContext(e){if(!this.buffer)return Qh(this.node.parent,e);let{buffer:i}=this.buffer,{types:s}=i.set;for(let r=e.length-1,n=this.stack.length-1;r>=0;n--){if(n<0)return Qh(this._tree,e,r);let a=s[i.buffer[this.stack[n]]];if(!a.isAnonymous){if(e[r]&&e[r]!=a.name)return!1;r--}}return!0}}function $d(t){return t.children.some(e=>e instanceof Es||!e.type.isAnonymous||$d(e))}function kT(t){var e;let{buffer:i,nodeSet:s,maxBufferLength:r=xO,reused:n=[],minRepeatType:a=s.types.length}=t,o=Array.isArray(i)?new Rd(i,i.length):i,l=s.types,c=0,h=0;function d(x,E,_,R,C,D){let{id:q,start:A,end:F,size:L}=o,W=h,M=c;if(L<0)if(o.next(),L==-1){let le=n[q];_.push(le),R.push(A-x);return}else if(L==-3){c=q;return}else if(L==-4){h=q;return}else throw new RangeError(`Unrecognized record size: ${L}`);let G=l[q],J,ce,re=A-x;if(F-A<=r&&(ce=m(o.pos-E,C))){let le=new Uint16Array(ce.size-ce.skip),oe=o.pos-ce.size,ke=le.length;for(;o.pos>oe;)ke=y(ce.start,le,ke);J=new Es(le,F-ce.start,s),re=ce.start-x}else{let le=o.pos-L;o.next();let oe=[],ke=[],Qe=q>=a?q:-1,qt=0,Ze=F;for(;o.pos>le;)Qe>=0&&o.id==Qe&&o.size>=0?(o.end<=Ze-r&&(f(oe,ke,A,qt,o.end,Ze,Qe,W,M),qt=oe.length,Ze=o.end),o.next()):D>2500?u(A,le,oe,ke):d(A,le,oe,ke,Qe,D+1);if(Qe>=0&&qt>0&&qt<oe.length&&f(oe,ke,A,qt,A,Ze,Qe,W,M),oe.reverse(),ke.reverse(),Qe>-1&&qt>0){let Dt=p(G,M);J=Id(G,oe,ke,0,oe.length,0,F-A,Dt,Dt)}else J=g(G,oe,ke,F-A,W-F,M)}_.push(J),R.push(re)}function u(x,E,_,R){let C=[],D=0,q=-1;for(;o.pos>E;){let{id:A,start:F,end:L,size:W}=o;if(W>4)o.next();else{if(q>-1&&F<q)break;q<0&&(q=L-r),C.push(A,F,L),D++,o.next()}}if(D){let A=new Uint16Array(D*4),F=C[C.length-2];for(let L=C.length-3,W=0;L>=0;L-=3)A[W++]=C[L],A[W++]=C[L+1]-F,A[W++]=C[L+2]-F,A[W++]=W;_.push(new Es(A,C[2]-F,s)),R.push(F-x)}}function p(x,E){return(_,R,C)=>{let D=0,q=_.length-1,A,F;if(q>=0&&(A=_[q])instanceof Ye){if(!q&&A.type==x&&A.length==C)return A;(F=A.prop(ve.lookAhead))&&(D=R[q]+A.length+F)}return g(x,_,R,C,D,E)}}function f(x,E,_,R,C,D,q,A,F){let L=[],W=[];for(;x.length>R;)L.push(x.pop()),W.push(E.pop()+_-C);x.push(g(s.types[q],L,W,D-C,A-D,F)),E.push(C-_)}function g(x,E,_,R,C,D,q){if(D){let A=[ve.contextHash,D];q=q?[A].concat(q):[A]}if(C>25){let A=[ve.lookAhead,C];q=q?[A].concat(q):[A]}return new Ye(x,E,_,R,q)}function m(x,E){let _=o.fork(),R=0,C=0,D=0,q=_.end-r,A={size:0,start:0,skip:0};e:for(let F=_.pos-x;_.pos>F;){let L=_.size;if(_.id==E&&L>=0){A.size=R,A.start=C,A.skip=D,D+=4,R+=4,_.next();continue}let W=_.pos-L;if(L<0||W<F||_.start<q)break;let M=_.id>=a?4:0,G=_.start;for(_.next();_.pos>W;){if(_.size<0)if(_.size==-3||_.size==-4)M+=4;else break e;else _.id>=a&&(M+=4);_.next()}C=G,R+=L,D+=M}return(E<0||R==x)&&(A.size=R,A.start=C,A.skip=D),A.size>4?A:void 0}function y(x,E,_){let{id:R,start:C,end:D,size:q}=o;if(o.next(),q>=0&&R<a){let A=_;if(q>4){let F=o.pos-(q-4);for(;o.pos>F;)_=y(x,E,_)}E[--_]=A,E[--_]=D-x,E[--_]=C-x,E[--_]=R}else q==-3?c=R:q==-4&&(h=R);return _}let b=[],w=[];for(;o.pos>0;)d(t.start||0,t.bufferStart||0,b,w,-1,0);let k=(e=t.length)!==null&&e!==void 0?e:b.length?w[0]+b[0].length:0;return new Ye(l[t.topID],b.reverse(),w.reverse(),k)}const lf=new WeakMap;function To(t,e){if(!t.isAnonymous||e instanceof Es||e.type!=t)return 1;let i=lf.get(e);if(i==null){i=1;for(let s of e.children){if(s.type!=t||!(s instanceof Ye)){i=1;break}i+=To(t,s)}lf.set(e,i)}return i}function Id(t,e,i,s,r,n,a,o,l){let c=0;for(let f=s;f<r;f++)c+=To(t,e[f]);let h=Math.ceil(c*1.5/8),d=[],u=[];function p(f,g,m,y,b){for(let w=m;w<y;){let k=w,x=g[w],E=To(t,f[w]);for(w++;w<y;w++){let _=To(t,f[w]);if(E+_>=h)break;E+=_}if(w==k+1){if(E>h){let _=f[k];p(_.children,_.positions,0,_.children.length,g[k]+b);continue}d.push(f[k])}else{let _=g[w-1]+f[w-1].length-x;d.push(Id(t,f,g,k,w,x,_,null,l))}u.push(x+b-n)}}return p(e,i,s,r,0),(o||l)(d,u,a)}class CO{constructor(){this.map=new WeakMap}setBuffer(e,i,s){let r=this.map.get(e);r||this.map.set(e,r=new Map),r.set(i,s)}getBuffer(e,i){let s=this.map.get(e);return s&&s.get(i)}set(e,i){e instanceof Ri?this.setBuffer(e.context.buffer,e.index,i):e instanceof At&&this.map.set(e.tree,i)}get(e){return e instanceof Ri?this.getBuffer(e.context.buffer,e.index):e instanceof At?this.map.get(e.tree):void 0}cursorSet(e,i){e.buffer?this.setBuffer(e.buffer.buffer,e.index,i):this.map.set(e.tree,i)}cursorGet(e){return e.buffer?this.getBuffer(e.buffer.buffer,e.index):this.map.get(e.tree)}}class er{constructor(e,i,s,r,n=!1,a=!1){this.from=e,this.to=i,this.tree=s,this.offset=r,this.open=(n?1:0)|(a?2:0)}get openStart(){return(this.open&1)>0}get openEnd(){return(this.open&2)>0}static addTree(e,i=[],s=!1){let r=[new er(0,e.length,e,0,!1,s)];for(let n of i)n.to>e.length&&r.push(n);return r}static applyChanges(e,i,s=128){if(!i.length)return e;let r=[],n=1,a=e.length?e[0]:null;for(let o=0,l=0,c=0;;o++){let h=o<i.length?i[o]:null,d=h?h.fromA:1e9;if(d-l>=s)for(;a&&a.from<d;){let u=a;if(l>=u.from||d<=u.to||c){let p=Math.max(u.from,l)-c,f=Math.min(u.to,d)-c;u=p>=f?null:new er(p,f,u.tree,u.offset+c,o>0,!!h)}if(u&&r.push(u),a.to>d)break;a=n<e.length?e[n++]:null}if(!h)break;l=h.toA,c=h.toA-h.toB}return r}}let _O=class{startParse(e,i,s){return typeof e=="string"&&(e=new TT(e)),s=s?s.length?s.map(r=>new vc(r.from,r.to)):[new vc(0,0)]:[new vc(0,e.length)],this.createParse(e,i||[],s)}parse(e,i,s){let r=this.startParse(e,i,s);for(;;){let n=r.advance();if(n)return n}}};class TT{constructor(e){this.string=e}get length(){return this.string.length}chunk(e){return this.string.slice(e)}get lineChunks(){return!1}read(e,i){return this.string.slice(e,i)}}new ve({perNode:!0});let ET=0;class Kt{constructor(e,i,s,r){this.name=e,this.set=i,this.base=s,this.modified=r,this.id=ET++}toString(){let{name:e}=this;for(let i of this.modified)i.name&&(e=`${i.name}(${e})`);return e}static define(e,i){let s=typeof e=="string"?e:"?";if(e instanceof Kt&&(i=e),i!=null&&i.base)throw new Error("Can not derive from a modified tag");let r=new Kt(s,[],null,[]);if(r.set.push(r),i)for(let n of i.set)r.set.push(n);return r}static defineModifier(e){let i=new Uo(e);return s=>s.modified.indexOf(i)>-1?s:Uo.get(s.base||s,s.modified.concat(i).sort((r,n)=>r.id-n.id))}}let PT=0;class Uo{constructor(e){this.name=e,this.instances=[],this.id=PT++}static get(e,i){if(!i.length)return e;let s=i[0].instances.find(o=>o.base==e&&CT(i,o.modified));if(s)return s;let r=[],n=new Kt(e.name,r,e,i);for(let o of i)o.instances.push(n);let a=_T(i);for(let o of e.set)if(!o.modified.length)for(let l of a)r.push(Uo.get(o,l));return n}}function CT(t,e){return t.length==e.length&&t.every((i,s)=>i==e[s])}function _T(t){let e=[[]];for(let i=0;i<t.length;i++)for(let s=0,r=e.length;s<r;s++)e.push(e[s].concat(t[i]));return e.sort((i,s)=>s.length-i.length)}function Ol(t){let e=Object.create(null);for(let i in t){let s=t[i];Array.isArray(s)||(s=[s]);for(let r of i.split(" "))if(r){let n=[],a=2,o=r;for(let d=0;;){if(o=="..."&&d>0&&d+3==r.length){a=1;break}let u=/^"(?:[^"\\]|\\.)*?"|[^\/!]+/.exec(o);if(!u)throw new RangeError("Invalid path: "+r);if(n.push(u[0]=="*"?"":u[0][0]=='"'?JSON.parse(u[0]):u[0]),d+=u[0].length,d==r.length)break;let p=r[d++];if(d==r.length&&p=="!"){a=0;break}if(p!="/")throw new RangeError("Invalid path: "+r);o=r.slice(d)}let l=n.length-1,c=n[l];if(!c)throw new RangeError("Invalid path: "+r);let h=new fa(s,a,l>0?n.slice(0,l):null);e[c]=h.sort(e[c])}}return RO.add(e)}const RO=new ve({combine(t,e){let i,s,r;for(;t||e;){if(!t||e&&t.depth>=e.depth?(r=e,e=e.next):(r=t,t=t.next),i&&i.mode==r.mode&&!r.context&&!i.context)continue;let n=new fa(r.tags,r.mode,r.context);i?i.next=n:s=n,i=n}return s}});class fa{constructor(e,i,s,r){this.tags=e,this.mode=i,this.context=s,this.next=r}get opaque(){return this.mode==0}get inherit(){return this.mode==1}sort(e){return!e||e.depth<this.depth?(this.next=e,this):(e.next=this.sort(e.next),e)}get depth(){return this.context?this.context.length:0}}fa.empty=new fa([],2,null);function $O(t,e){let i=Object.create(null);for(let n of t)if(!Array.isArray(n.tag))i[n.tag.id]=n.class;else for(let a of n.tag)i[a.id]=n.class;let{scope:s,all:r=null}=e||{};return{style:n=>{let a=r;for(let o of n)for(let l of o.set){let c=i[l.id];if(c){a=a?a+" "+c:c;break}}return a},scope:s}}function RT(t,e){let i=null;for(let s of t){let r=s.style(e);r&&(i=i?i+" "+r:r)}return i}function $T(t,e,i,s=0,r=t.length){let n=new IT(s,Array.isArray(e)?e:[e],i);n.highlightRange(t.cursor(),s,r,"",n.highlighters),n.flush(r)}class IT{constructor(e,i,s){this.at=e,this.highlighters=i,this.span=s,this.class=""}startSpan(e,i){i!=this.class&&(this.flush(e),e>this.at&&(this.at=e),this.class=i)}flush(e){e>this.at&&this.class&&this.span(this.at,e,this.class)}highlightRange(e,i,s,r,n){let{type:a,from:o,to:l}=e;if(o>=s||l<=i)return;a.isTop&&(n=this.highlighters.filter(p=>!p.scope||p.scope(a)));let c=r,h=QT(e)||fa.empty,d=RT(n,h.tags);if(d&&(c&&(c+=" "),c+=d,h.mode==1&&(r+=(r?" ":"")+d)),this.startSpan(Math.max(i,o),c),h.opaque)return;let u=e.tree&&e.tree.prop(ve.mounted);if(u&&u.overlay){let p=e.node.enter(u.overlay[0].from+o,1),f=this.highlighters.filter(m=>!m.scope||m.scope(u.tree.type)),g=e.firstChild();for(let m=0,y=o;;m++){let b=m<u.overlay.length?u.overlay[m]:null,w=b?b.from+o:l,k=Math.max(i,y),x=Math.min(s,w);if(k<x&&g)for(;e.from<x&&(this.highlightRange(e,k,x,r,n),this.startSpan(Math.min(x,e.to),c),!(e.to>=w||!e.nextSibling())););if(!b||w>s)break;y=b.to+o,y>i&&(this.highlightRange(p.cursor(),Math.max(i,b.from+o),Math.min(s,y),"",f),this.startSpan(Math.min(s,y),c))}g&&e.parent()}else if(e.firstChild()){u&&(r="");do if(!(e.to<=i)){if(e.from>=s)break;this.highlightRange(e,i,s,r,n),this.startSpan(Math.min(s,e.to),c)}while(e.nextSibling());e.parent()}}}function QT(t){let e=t.type.prop(RO);for(;e&&e.context&&!t.matchContext(e.context);)e=e.next;return e||null}const Z=Kt.define,lo=Z(),fs=Z(),cf=Z(fs),hf=Z(fs),gs=Z(),co=Z(gs),bc=Z(gs),xi=Z(),qs=Z(xi),bi=Z(),wi=Z(),Lh=Z(),Pn=Z(Lh),ho=Z(),$={comment:lo,lineComment:Z(lo),blockComment:Z(lo),docComment:Z(lo),name:fs,variableName:Z(fs),typeName:cf,tagName:Z(cf),propertyName:hf,attributeName:Z(hf),className:Z(fs),labelName:Z(fs),namespace:Z(fs),macroName:Z(fs),literal:gs,string:co,docString:Z(co),character:Z(co),attributeValue:Z(co),number:bc,integer:Z(bc),float:Z(bc),bool:Z(gs),regexp:Z(gs),escape:Z(gs),color:Z(gs),url:Z(gs),keyword:bi,self:Z(bi),null:Z(bi),atom:Z(bi),unit:Z(bi),modifier:Z(bi),operatorKeyword:Z(bi),controlKeyword:Z(bi),definitionKeyword:Z(bi),moduleKeyword:Z(bi),operator:wi,derefOperator:Z(wi),arithmeticOperator:Z(wi),logicOperator:Z(wi),bitwiseOperator:Z(wi),compareOperator:Z(wi),updateOperator:Z(wi),definitionOperator:Z(wi),typeOperator:Z(wi),controlOperator:Z(wi),punctuation:Lh,separator:Z(Lh),bracket:Pn,angleBracket:Z(Pn),squareBracket:Z(Pn),paren:Z(Pn),brace:Z(Pn),content:xi,heading:qs,heading1:Z(qs),heading2:Z(qs),heading3:Z(qs),heading4:Z(qs),heading5:Z(qs),heading6:Z(qs),contentSeparator:Z(xi),list:Z(xi),quote:Z(xi),emphasis:Z(xi),strong:Z(xi),link:Z(xi),monospace:Z(xi),strikethrough:Z(xi),inserted:Z(),deleted:Z(),changed:Z(),invalid:Z(),meta:ho,documentMeta:Z(ho),annotation:Z(ho),processingInstruction:Z(ho),definition:Kt.defineModifier("definition"),constant:Kt.defineModifier("constant"),function:Kt.defineModifier("function"),standard:Kt.defineModifier("standard"),local:Kt.defineModifier("local"),special:Kt.defineModifier("special")};for(let t in $){let e=$[t];e instanceof Kt&&(e.name=t)}$O([{tag:$.link,class:"tok-link"},{tag:$.heading,class:"tok-heading"},{tag:$.emphasis,class:"tok-emphasis"},{tag:$.strong,class:"tok-strong"},{tag:$.keyword,class:"tok-keyword"},{tag:$.atom,class:"tok-atom"},{tag:$.bool,class:"tok-bool"},{tag:$.url,class:"tok-url"},{tag:$.labelName,class:"tok-labelName"},{tag:$.inserted,class:"tok-inserted"},{tag:$.deleted,class:"tok-deleted"},{tag:$.literal,class:"tok-literal"},{tag:$.string,class:"tok-string"},{tag:$.number,class:"tok-number"},{tag:[$.regexp,$.escape,$.special($.string)],class:"tok-string2"},{tag:$.variableName,class:"tok-variableName"},{tag:$.local($.variableName),class:"tok-variableName tok-local"},{tag:$.definition($.variableName),class:"tok-variableName tok-definition"},{tag:$.special($.variableName),class:"tok-variableName2"},{tag:$.definition($.propertyName),class:"tok-propertyName tok-definition"},{tag:$.typeName,class:"tok-typeName"},{tag:$.namespace,class:"tok-namespace"},{tag:$.className,class:"tok-className"},{tag:$.macroName,class:"tok-macroName"},{tag:$.propertyName,class:"tok-propertyName"},{tag:$.operator,class:"tok-operator"},{tag:$.comment,class:"tok-comment"},{tag:$.meta,class:"tok-meta"},{tag:$.invalid,class:"tok-invalid"},{tag:$.punctuation,class:"tok-punctuation"}]);var wc;const qr=new ve;function IO(t){return se.define({combine:t?e=>e.concat(t):void 0})}const Qd=new ve;class pi{constructor(e,i,s=[],r=""){this.data=e,this.name=r,Pe.prototype.hasOwnProperty("tree")||Object.defineProperty(Pe.prototype,"tree",{get(){return vt(this)}}),this.parser=i,this.extension=[Ps.of(this),Pe.languageData.of((n,a,o)=>{let l=df(n,a,o),c=l.type.prop(qr);if(!c)return[];let h=n.facet(c),d=l.type.prop(Qd);if(d){let u=l.resolve(a-l.from,o);for(let p of d)if(p.test(u,n)){let f=n.facet(p.facet);return p.type=="replace"?f:f.concat(h)}}return h})].concat(s)}isActiveAt(e,i,s=-1){return df(e,i,s).type.prop(qr)==this.data}findRegions(e){let i=e.facet(Ps);if((i==null?void 0:i.data)==this.data)return[{from:0,to:e.doc.length}];if(!i||!i.allowsNesting)return[];let s=[],r=(n,a)=>{if(n.prop(qr)==this.data){s.push({from:a,to:a+n.length});return}let o=n.prop(ve.mounted);if(o){if(o.tree.prop(qr)==this.data){if(o.overlay)for(let l of o.overlay)s.push({from:l.from+a,to:l.to+a});else s.push({from:a,to:a+n.length});return}else if(o.overlay){let l=s.length;if(r(o.tree,o.overlay[0].from+a),s.length>l)return}}for(let l=0;l<n.children.length;l++){let c=n.children[l];c instanceof Ye&&r(c,n.positions[l]+a)}};return r(vt(e),0),s}get allowsNesting(){return!0}}pi.setState=Ie.define();function df(t,e,i){let s=t.facet(Ps),r=vt(t).topNode;if(!s||s.allowsNesting)for(let n=r;n;n=n.enter(e,i,je.ExcludeBuffers|je.EnterBracketed))n.type.isTop&&(r=n);return r}class Jr extends pi{constructor(e,i,s){super(e,i,[],s),this.parser=i}static define(e){let i=IO(e.languageData);return new Jr(i,e.parser.configure({props:[qr.add(s=>s.isTop?i:void 0)]}),e.name)}configure(e,i){return new Jr(this.data,this.parser.configure(e),i||this.name)}get allowsNesting(){return this.parser.hasWrappers()}}function vt(t){let e=t.field(pi.state,!1);return e?e.tree:Ye.empty}class AT{constructor(e){this.doc=e,this.cursorPos=0,this.string="",this.cursor=e.iter()}get length(){return this.doc.length}syncTo(e){return this.string=this.cursor.next(e-this.cursorPos).value,this.cursorPos=e+this.string.length,this.cursorPos-this.string.length}chunk(e){return this.syncTo(e),this.string}get lineChunks(){return!0}read(e,i){let s=this.cursorPos-this.string.length;return e<s||i>=this.cursorPos?this.doc.sliceString(e,i):this.string.slice(e-s,i-s)}}let Cn=null;class Vo{constructor(e,i,s=[],r,n,a,o,l){this.parser=e,this.state=i,this.fragments=s,this.tree=r,this.treeLen=n,this.viewport=a,this.skipped=o,this.scheduleOn=l,this.parse=null,this.tempSkipped=[]}static create(e,i,s){return new Vo(e,i,[],Ye.empty,0,s,[],null)}startParse(){return this.parser.startParse(new AT(this.state.doc),this.fragments)}work(e,i){return i!=null&&i>=this.state.doc.length&&(i=void 0),this.tree!=Ye.empty&&this.isDone(i??this.state.doc.length)?(this.takeTree(),!0):this.withContext(()=>{var s;if(typeof e=="number"){let r=Date.now()+e;e=()=>Date.now()>r}for(this.parse||(this.parse=this.startParse()),i!=null&&(this.parse.stoppedAt==null||this.parse.stoppedAt>i)&&i<this.state.doc.length&&this.parse.stopAt(i);;){let r=this.parse.advance();if(r)if(this.fragments=this.withoutTempSkipped(er.addTree(r,this.fragments,this.parse.stoppedAt!=null)),this.treeLen=(s=this.parse.stoppedAt)!==null&&s!==void 0?s:this.state.doc.length,this.tree=r,this.parse=null,this.treeLen<(i??this.state.doc.length))this.parse=this.startParse();else return!0;if(e())return!1}})}takeTree(){let e,i;this.parse&&(e=this.parse.parsedPos)>=this.treeLen&&((this.parse.stoppedAt==null||this.parse.stoppedAt>e)&&this.parse.stopAt(e),this.withContext(()=>{for(;!(i=this.parse.advance()););}),this.treeLen=e,this.tree=i,this.fragments=this.withoutTempSkipped(er.addTree(this.tree,this.fragments,!0)),this.parse=null)}withContext(e){let i=Cn;Cn=this;try{return e()}finally{Cn=i}}withoutTempSkipped(e){for(let i;i=this.tempSkipped.pop();)e=uf(e,i.from,i.to);return e}changes(e,i){let{fragments:s,tree:r,treeLen:n,viewport:a,skipped:o}=this;if(this.takeTree(),!e.empty){let l=[];if(e.iterChangedRanges((c,h,d,u)=>l.push({fromA:c,toA:h,fromB:d,toB:u})),s=er.applyChanges(s,l),r=Ye.empty,n=0,a={from:e.mapPos(a.from,-1),to:e.mapPos(a.to,1)},this.skipped.length){o=[];for(let c of this.skipped){let h=e.mapPos(c.from,1),d=e.mapPos(c.to,-1);h<d&&o.push({from:h,to:d})}}}return new Vo(this.parser,i,s,r,n,a,o,this.scheduleOn)}updateViewport(e){if(this.viewport.from==e.from&&this.viewport.to==e.to)return!1;this.viewport=e;let i=this.skipped.length;for(let s=0;s<this.skipped.length;s++){let{from:r,to:n}=this.skipped[s];r<e.to&&n>e.from&&(this.fragments=uf(this.fragments,r,n),this.skipped.splice(s--,1))}return this.skipped.length>=i?!1:(this.reset(),!0)}reset(){this.parse&&(this.takeTree(),this.parse=null)}skipUntilInView(e,i){this.skipped.push({from:e,to:i})}static getSkippingParser(e){return new class extends _O{createParse(i,s,r){let n=r[0].from,a=r[r.length-1].to;return{parsedPos:n,advance(){let l=Cn;if(l){for(let c of r)l.tempSkipped.push(c);e&&(l.scheduleOn=l.scheduleOn?Promise.all([l.scheduleOn,e]):e)}return this.parsedPos=a,new Ye(si.none,[],[],a-n)},stoppedAt:null,stopAt(){}}}}}isDone(e){e=Math.min(e,this.state.doc.length);let i=this.fragments;return this.treeLen>=e&&i.length&&i[0].from==0&&i[0].to>=e}static get(){return Cn}}function uf(t,e,i){return er.applyChanges(t,[{fromA:e,toA:i,fromB:e,toB:i}])}class en{constructor(e){this.context=e,this.tree=e.tree}apply(e){if(!e.docChanged&&this.tree==this.context.tree)return this;let i=this.context.changes(e.changes,e.state),s=this.context.treeLen==e.startState.doc.length?void 0:Math.max(e.changes.mapPos(this.context.treeLen),i.viewport.to);return i.work(20,s)||i.takeTree(),new en(i)}static init(e){let i=Math.min(3e3,e.doc.length),s=Vo.create(e.facet(Ps).parser,e,{from:0,to:i});return s.work(20,i)||s.takeTree(),new en(s)}}pi.state=Mt.define({create:en.init,update(t,e){for(let i of e.effects)if(i.is(pi.setState))return i.value;return e.startState.facet(Ps)!=e.state.facet(Ps)?en.init(e.state):t.apply(e)}});let QO=t=>{let e=setTimeout(()=>t(),500);return()=>clearTimeout(e)};typeof requestIdleCallback<"u"&&(QO=t=>{let e=-1,i=setTimeout(()=>{e=requestIdleCallback(t,{timeout:400})},100);return()=>e<0?clearTimeout(i):cancelIdleCallback(e)});const Sc=typeof navigator<"u"&&(!((wc=navigator.scheduling)===null||wc===void 0)&&wc.isInputPending)?()=>navigator.scheduling.isInputPending():null,LT=Lt.fromClass(class{constructor(e){this.view=e,this.working=null,this.workScheduled=0,this.chunkEnd=-1,this.chunkBudget=-1,this.work=this.work.bind(this),this.scheduleWork()}update(e){let i=this.view.state.field(pi.state).context;(i.updateViewport(e.view.viewport)||this.view.viewport.to>i.treeLen)&&this.scheduleWork(),(e.docChanged||e.selectionSet)&&(this.view.hasFocus&&(this.chunkBudget+=50),this.scheduleWork()),this.checkAsyncSchedule(i)}scheduleWork(){if(this.working)return;let{state:e}=this.view,i=e.field(pi.state);(i.tree!=i.context.tree||!i.context.isDone(e.doc.length))&&(this.working=QO(this.work))}work(e){this.working=null;let i=Date.now();if(this.chunkEnd<i&&(this.chunkEnd<0||this.view.hasFocus)&&(this.chunkEnd=i+3e4,this.chunkBudget=3e3),this.chunkBudget<=0)return;let{state:s,viewport:{to:r}}=this.view,n=s.field(pi.state);if(n.tree==n.context.tree&&n.context.isDone(r+1e5))return;let a=Date.now()+Math.min(this.chunkBudget,100,e&&!Sc?Math.max(25,e.timeRemaining()-5):1e9),o=n.context.treeLen<r&&s.doc.length>r+1e3,l=n.context.work(()=>Sc&&Sc()||Date.now()>a,r+(o?0:1e5));this.chunkBudget-=Date.now()-i,(l||this.chunkBudget<=0)&&(n.context.takeTree(),this.view.dispatch({effects:pi.setState.of(new en(n.context))})),this.chunkBudget>0&&!(l&&!o)&&this.scheduleWork(),this.checkAsyncSchedule(n.context)}checkAsyncSchedule(e){e.scheduleOn&&(this.workScheduled++,e.scheduleOn.then(()=>this.scheduleWork()).catch(i=>_i(this.view.state,i)).then(()=>this.workScheduled--),e.scheduleOn=null)}destroy(){this.working&&this.working()}isWorking(){return!!(this.working||this.workScheduled>0)}},{eventHandlers:{focus(){this.scheduleWork()}}}),Ps=se.define({combine(t){return t.length?t[0]:null},enables:t=>[pi.state,LT,te.contentAttributes.compute([t],e=>{let i=e.facet(t);return i&&i.name?{"data-language":i.name}:{}})]});class Ad{constructor(e,i=[]){this.language=e,this.support=i,this.extension=[e,i]}}const NT=se.define(),yl=se.define({combine:t=>{if(!t.length)return"  ";let e=t[0];if(!e||/\S/.test(e)||Array.from(e).some(i=>i!=e[0]))throw new Error("Invalid indent unit: "+JSON.stringify(t[0]));return e}});function zo(t){let e=t.facet(yl);return e.charCodeAt(0)==9?t.tabSize*e.length:e.length}function ga(t,e){let i="",s=t.tabSize,r=t.facet(yl)[0];if(r=="	"){for(;e>=s;)i+="	",e-=s;r=" "}for(let n=0;n<e;n++)i+=r;return i}function Ld(t,e){t instanceof Pe&&(t=new vl(t));for(let s of t.state.facet(NT)){let r=s(t,e);if(r!==void 0)return r}let i=vt(t.state);return i.length>=e?MT(t,i,e):null}class vl{constructor(e,i={}){this.state=e,this.options=i,this.unit=zo(e)}lineAt(e,i=1){let s=this.state.doc.lineAt(e),{simulateBreak:r,simulateDoubleBreak:n}=this.options;return r!=null&&r>=s.from&&r<=s.to?n&&r==e?{text:"",from:e}:(i<0?r<e:r<=e)?{text:s.text.slice(r-s.from),from:r}:{text:s.text.slice(0,r-s.from),from:s.from}:s}textAfterPos(e,i=1){if(this.options.simulateDoubleBreak&&e==this.options.simulateBreak)return"";let{text:s,from:r}=this.lineAt(e,i);return s.slice(e-r,Math.min(s.length,e+100-r))}column(e,i=1){let{text:s,from:r}=this.lineAt(e,i),n=this.countColumn(s,e-r),a=this.options.overrideIndentation?this.options.overrideIndentation(r):-1;return a>-1&&(n+=a-this.countColumn(s,s.search(/\S|$/))),n}countColumn(e,i=e.length){return ln(e,this.state.tabSize,i)}lineIndent(e,i=1){let{text:s,from:r}=this.lineAt(e,i),n=this.options.overrideIndentation;if(n){let a=n(r);if(a>-1)return a}return this.countColumn(s,s.search(/\S|$/))}get simulatedBreak(){return this.options.simulateBreak||null}}const bl=new ve;function MT(t,e,i){let s=e.resolveStack(i),r=e.resolveInner(i,-1).resolve(i,0).enterUnfinishedNodesBefore(i);if(r!=s.node){let n=[];for(let a=r;a&&!(a.from<s.node.from||a.to>s.node.to||a.from==s.node.from&&a.type==s.node.type);a=a.parent)n.push(a);for(let a=n.length-1;a>=0;a--)s={node:n[a],next:s}}return AO(s,t,i)}function AO(t,e,i){for(let s=t;s;s=s.next){let r=DT(s.node);if(r)return r(Nd.create(e,i,s))}return 0}function qT(t){return t.pos==t.options.simulateBreak&&t.options.simulateDoubleBreak}function DT(t){let e=t.type.prop(bl);if(e)return e;let i=t.firstChild,s;if(i&&(s=i.type.prop(ve.closedBy))){let r=t.lastChild,n=r&&s.indexOf(r.name)>-1;return a=>LO(a,!0,1,void 0,n&&!qT(a)?r.from:void 0)}return t.parent==null?BT:null}function BT(){return 0}class Nd extends vl{constructor(e,i,s){super(e.state,e.options),this.base=e,this.pos=i,this.context=s}get node(){return this.context.node}static create(e,i,s){return new Nd(e,i,s)}get textAfter(){return this.textAfterPos(this.pos)}get baseIndent(){return this.baseIndentFor(this.node)}baseIndentFor(e){let i=this.state.doc.lineAt(e.from);for(;;){let s=e.resolve(i.from);for(;s.parent&&s.parent.from==s.from;)s=s.parent;if(jT(s,e))break;i=this.state.doc.lineAt(s.from)}return this.lineIndent(i.from)}continue(){return AO(this.context.next,this.base,this.pos)}}function jT(t,e){for(let i=e;i;i=i.parent)if(t==i)return!0;return!1}function WT(t){let e=t.node,i=e.childAfter(e.from),s=e.lastChild;if(!i)return null;let r=t.options.simulateBreak,n=t.state.doc.lineAt(i.from),a=r==null||r<=n.from?n.to:Math.min(n.to,r);for(let o=i.to;;){let l=e.childAfter(o);if(!l||l==s)return null;if(!l.type.isSkipped){if(l.from>=a)return null;let c=/^ */.exec(n.text.slice(i.to-n.from))[0].length;return{from:i.from,to:i.to+c}}o=l.to}}function Hn({closing:t,align:e=!0,units:i=1}){return s=>LO(s,e,i,t)}function LO(t,e,i,s,r){let n=t.textAfter,a=n.match(/^\s*/)[0].length,o=s&&n.slice(a,a+s.length)==s||r==t.pos+a,l=e?WT(t):null;return l?o?t.column(l.from):t.column(l.to):t.baseIndent+(o?0:t.unit*i)}const NO=t=>t.baseIndent;function Vr({except:t,units:e=1}={}){return i=>{let s=t&&t.test(i.textAfter);return i.baseIndent+(s?0:e*i.unit)}}const FT=200;function UT(){return Pe.transactionFilter.of(t=>{if(!t.docChanged||!t.isUserEvent("input.type")&&!t.isUserEvent("input.complete"))return t;let e=t.startState.languageDataAt("indentOnInput",t.startState.selection.main.head);if(!e.length)return t;let i=t.newDoc,{head:s}=t.newSelection.main,r=i.lineAt(s);if(s>r.from+FT)return t;let n=i.sliceString(r.from,s);if(!e.some(c=>c.test(n)))return t;let{state:a}=t,o=-1,l=[];for(let{head:c}of a.selection.ranges){let h=a.doc.lineAt(c);if(h.from==o)continue;o=h.from;let d=Ld(a,h.from);if(d==null)continue;let u=/^\s*/.exec(h.text)[0],p=ga(a,d);u!=p&&l.push({from:h.from,to:h.from+u.length,insert:p})}return l.length?[t,{changes:l,sequential:!0}]:t})}const VT=se.define(),wl=new ve;function Md(t){let e=t.firstChild,i=t.lastChild;return e&&e.to<i.from?{from:e.to,to:i.type.isError?t.to:i.from}:null}function zT(t,e,i){let s=vt(t);if(s.length<i)return null;let r=s.resolveStack(i,1),n=null;for(let a=r;a;a=a.next){let o=a.node;if(o.to<=i||o.from>i)continue;if(n&&o.from<e)break;let l=o.type.prop(wl);if(l&&(o.to<s.length-50||s.length==t.doc.length||!XT(o))){let c=l(o,t);c&&c.from<=i&&c.from>=e&&c.to>i&&(n=c)}}return n}function XT(t){let e=t.lastChild;return e&&e.to==t.to&&e.type.isError}function Xo(t,e,i){for(let s of t.facet(VT)){let r=s(t,e,i);if(r)return r}return zT(t,e,i)}function MO(t,e){let i=e.mapPos(t.from,1),s=e.mapPos(t.to,-1);return i>=s?void 0:{from:i,to:s}}const Sl=Ie.define({map:MO}),Ea=Ie.define({map:MO});function qO(t){let e=[];for(let{head:i}of t.state.selection.ranges)e.some(s=>s.from<=i&&s.to>=i)||e.push(t.lineBlockAt(i));return e}const or=Mt.define({create(){return fe.none},update(t,e){e.isUserEvent("delete")&&e.changes.iterChangedRanges((i,s)=>t=pf(t,i,s)),t=t.map(e.changes);for(let i of e.effects)if(i.is(Sl)&&!GT(t,i.value.from,i.value.to)){let{preparePlaceholder:s}=e.state.facet(jO),r=s?fe.replace({widget:new tE(s(e.state,i.value))}):ff;t=t.update({add:[r.range(i.value.from,i.value.to)]})}else i.is(Ea)&&(t=t.update({filter:(s,r)=>i.value.from!=s||i.value.to!=r,filterFrom:i.value.from,filterTo:i.value.to}));return e.selection&&(t=pf(t,e.selection.main.head)),t},provide:t=>te.decorations.from(t),toJSON(t,e){let i=[];return t.between(0,e.doc.length,(s,r)=>{i.push(s,r)}),i},fromJSON(t){if(!Array.isArray(t)||t.length%2)throw new RangeError("Invalid JSON for fold state");let e=[];for(let i=0;i<t.length;){let s=t[i++],r=t[i++];if(typeof s!="number"||typeof r!="number")throw new RangeError("Invalid JSON for fold state");e.push(ff.range(s,r))}return fe.set(e,!0)}});function pf(t,e,i=e){let s=!1;return t.between(e,i,(r,n)=>{r<i&&n>e&&(s=!0)}),s?t.update({filterFrom:e,filterTo:i,filter:(r,n)=>r>=i||n<=e}):t}function Go(t,e,i){var s;let r=null;return(s=t.field(or,!1))===null||s===void 0||s.between(e,i,(n,a)=>{(!r||r.from>n)&&(r={from:n,to:a})}),r}function GT(t,e,i){let s=!1;return t.between(e,e,(r,n)=>{r==e&&n==i&&(s=!0)}),s}function DO(t,e){return t.field(or,!1)?e:e.concat(Ie.appendConfig.of(WO()))}const YT=t=>{for(let e of qO(t)){let i=Xo(t.state,e.from,e.to);if(i)return t.dispatch({effects:DO(t.state,[Sl.of(i),BO(t,i)])}),!0}return!1},ZT=t=>{if(!t.state.field(or,!1))return!1;let e=[];for(let i of qO(t)){let s=Go(t.state,i.from,i.to);s&&e.push(Ea.of(s),BO(t,s,!1))}return e.length&&t.dispatch({effects:e}),e.length>0};function BO(t,e,i=!0){let s=t.state.doc.lineAt(e.from).number,r=t.state.doc.lineAt(e.to).number;return te.announce.of(`${t.state.phrase(i?"Folded lines":"Unfolded lines")} ${s} ${t.state.phrase("to")} ${r}.`)}const HT=t=>{let{state:e}=t,i=[];for(let s=0;s<e.doc.length;){let r=t.lineBlockAt(s),n=Xo(e,r.from,r.to);n&&i.push(Sl.of(n)),s=(n?t.lineBlockAt(n.to):r).to+1}return i.length&&t.dispatch({effects:DO(t.state,i)}),!!i.length},KT=t=>{let e=t.state.field(or,!1);if(!e||!e.size)return!1;let i=[];return e.between(0,t.state.doc.length,(s,r)=>{i.push(Ea.of({from:s,to:r}))}),t.dispatch({effects:i}),!0},JT=[{key:"Ctrl-Shift-[",mac:"Cmd-Alt-[",run:YT},{key:"Ctrl-Shift-]",mac:"Cmd-Alt-]",run:ZT},{key:"Ctrl-Alt-[",run:HT},{key:"Ctrl-Alt-]",run:KT}],eE={placeholderDOM:null,preparePlaceholder:null,placeholderText:"â€¦"},jO=se.define({combine(t){return on(t,eE)}});function WO(t){return[or,rE]}function FO(t,e){let{state:i}=t,s=i.facet(jO),r=a=>{let o=t.lineBlockAt(t.posAtDOM(a.target)),l=Go(t.state,o.from,o.to);l&&t.dispatch({effects:Ea.of(l)}),a.preventDefault()};if(s.placeholderDOM)return s.placeholderDOM(t,r,e);let n=document.createElement("span");return n.textContent=s.placeholderText,n.setAttribute("aria-label",i.phrase("folded code")),n.title=i.phrase("unfold"),n.className="cm-foldPlaceholder",n.onclick=r,n}const ff=fe.replace({widget:new class extends gi{toDOM(t){return FO(t,null)}}});class tE extends gi{constructor(e){super(),this.value=e}eq(e){return this.value==e.value}toDOM(e){return FO(e,this.value)}}const iE={openText:"âŒ„",closedText:"â€º",markerDOM:null,domEventHandlers:{},foldingChanged:()=>!1};class xc extends ts{constructor(e,i){super(),this.config=e,this.open=i}eq(e){return this.config==e.config&&this.open==e.open}toDOM(e){if(this.config.markerDOM)return this.config.markerDOM(this.open);let i=document.createElement("span");return i.textContent=this.open?this.config.openText:this.config.closedText,i.title=e.state.phrase(this.open?"Fold line":"Unfold line"),i}}function sE(t={}){let e={...iE,...t},i=new xc(e,!0),s=new xc(e,!1),r=Lt.fromClass(class{constructor(a){this.from=a.viewport.from,this.markers=this.buildMarkers(a)}update(a){(a.docChanged||a.viewportChanged||a.startState.facet(Ps)!=a.state.facet(Ps)||a.startState.field(or,!1)!=a.state.field(or,!1)||vt(a.startState)!=vt(a.state)||e.foldingChanged(a))&&(this.markers=this.buildMarkers(a.view))}buildMarkers(a){let o=new sr;for(let l of a.viewportLineBlocks){let c=Go(a.state,l.from,l.to)?s:Xo(a.state,l.from,l.to)?i:null;c&&o.add(l.from,l.from,c)}return o.finish()}}),{domEventHandlers:n}=e;return[r,lT({class:"cm-foldGutter",markers(a){var o;return((o=a.plugin(r))===null||o===void 0?void 0:o.markers)||Se.empty},initialSpacer(){return new xc(e,!1)},domEventHandlers:{...n,click:(a,o,l)=>{if(n.click&&n.click(a,o,l))return!0;let c=Go(a.state,o.from,o.to);if(c)return a.dispatch({effects:Ea.of(c)}),!0;let h=Xo(a.state,o.from,o.to);return h?(a.dispatch({effects:Sl.of(h)}),!0):!1}}}),WO()]}const rE=te.baseTheme({".cm-foldPlaceholder":{backgroundColor:"#eee",border:"1px solid #ddd",color:"#888",borderRadius:".2em",margin:"0 1px",padding:"0 1px",cursor:"pointer"},".cm-foldGutter span":{padding:"0 1px",cursor:"pointer"}});class Pa{constructor(e,i){this.specs=e;let s;function r(o){let l=xs.newName();return(s||(s=Object.create(null)))["."+l]=o,l}const n=typeof i.all=="string"?i.all:i.all?r(i.all):void 0,a=i.scope;this.scope=a instanceof pi?o=>o.prop(qr)==a.data:a?o=>o==a:void 0,this.style=$O(e.map(o=>({tag:o.tag,class:o.class||r(Object.assign({},o,{tag:null}))})),{all:n}).style,this.module=s?new xs(s):null,this.themeType=i.themeType}static define(e,i){return new Pa(e,i||{})}}const Nh=se.define(),nE=se.define({combine(t){return t.length?[t[0]]:null}});function kc(t){let e=t.facet(Nh);return e.length?e:t.facet(nE)}function gf(t,e){let i=[oE],s;return t instanceof Pa&&(t.module&&i.push(te.styleModule.of(t.module)),s=t.themeType),s?i.push(Nh.computeN([te.darkTheme],r=>r.facet(te.darkTheme)==(s=="dark")?[t]:[])):i.push(Nh.of(t)),i}class aE{constructor(e){this.markCache=Object.create(null),this.tree=vt(e.state),this.decorations=this.buildDeco(e,kc(e.state)),this.decoratedTo=e.viewport.to}update(e){let i=vt(e.state),s=kc(e.state),r=s!=kc(e.startState),{viewport:n}=e.view,a=e.changes.mapPos(this.decoratedTo,1);i.length<n.to&&!r&&i.type==this.tree.type&&a>=n.to?(this.decorations=this.decorations.map(e.changes),this.decoratedTo=a):(i!=this.tree||e.viewportChanged||r)&&(this.tree=i,this.decorations=this.buildDeco(e.view,s),this.decoratedTo=n.to)}buildDeco(e,i){if(!i||!this.tree.length)return fe.none;let s=new sr;for(let{from:r,to:n}of e.visibleRanges)$T(this.tree,i,(a,o,l)=>{s.add(a,o,this.markCache[l]||(this.markCache[l]=fe.mark({class:l})))},r,n);return s.finish()}}const oE=wa.high(Lt.fromClass(aE,{decorations:t=>t.decorations})),lE=te.baseTheme({"&.cm-focused .cm-matchingBracket":{backgroundColor:"#328c8252"},"&.cm-focused .cm-nonmatchingBracket":{backgroundColor:"#bb555544"}}),UO=1e4,VO="()[]{}",zO=se.define({combine(t){return on(t,{afterCursor:!0,brackets:VO,maxScanDistance:UO,renderMatch:dE})}}),cE=fe.mark({class:"cm-matchingBracket"}),hE=fe.mark({class:"cm-nonmatchingBracket"});function dE(t){let e=[],i=t.matched?cE:hE;return e.push(i.range(t.start.from,t.start.to)),t.end&&e.push(i.range(t.end.from,t.end.to)),e}const uE=Mt.define({create(){return fe.none},update(t,e){if(!e.docChanged&&!e.selection)return t;let i=[],s=e.state.facet(zO);for(let r of e.state.selection.ranges){if(!r.empty)continue;let n=$i(e.state,r.head,-1,s)||r.head>0&&$i(e.state,r.head-1,1,s)||s.afterCursor&&($i(e.state,r.head,1,s)||r.head<e.state.doc.length&&$i(e.state,r.head+1,-1,s));n&&(i=i.concat(s.renderMatch(n,e.state)))}return fe.set(i,!0)},provide:t=>te.decorations.from(t)}),pE=[uE,lE];function fE(t={}){return[zO.of(t),pE]}const gE=new ve;function Mh(t,e,i){let s=t.prop(e<0?ve.openedBy:ve.closedBy);if(s)return s;if(t.name.length==1){let r=i.indexOf(t.name);if(r>-1&&r%2==(e<0?1:0))return[i[r+e]]}return null}function qh(t){let e=t.type.prop(gE);return e?e(t.node):t}function $i(t,e,i,s={}){let r=s.maxScanDistance||UO,n=s.brackets||VO,a=vt(t),o=a.resolveInner(e,i);for(let l=o;l;l=l.parent){let c=Mh(l.type,i,n);if(c&&l.from<l.to){let h=qh(l);if(h&&(i>0?e>=h.from&&e<h.to:e>h.from&&e<=h.to))return mE(t,e,i,l,h,c,n)}}return OE(t,e,i,a,o.type,r,n)}function mE(t,e,i,s,r,n,a){let o=s.parent,l={from:r.from,to:r.to},c=0,h=o==null?void 0:o.cursor();if(h&&(i<0?h.childBefore(s.from):h.childAfter(s.to)))do if(i<0?h.to<=s.from:h.from>=s.to){if(c==0&&n.indexOf(h.type.name)>-1&&h.from<h.to){let d=qh(h);return{start:l,end:d?{from:d.from,to:d.to}:void 0,matched:!0}}else if(Mh(h.type,i,a))c++;else if(Mh(h.type,-i,a)){if(c==0){let d=qh(h);return{start:l,end:d&&d.from<d.to?{from:d.from,to:d.to}:void 0,matched:!1}}c--}}while(i<0?h.prevSibling():h.nextSibling());return{start:l,matched:!1}}function OE(t,e,i,s,r,n,a){let o=i<0?t.sliceDoc(e-1,e):t.sliceDoc(e,e+1),l=a.indexOf(o);if(l<0||l%2==0!=i>0)return null;let c={from:i<0?e-1:e,to:i>0?e+1:e},h=t.doc.iterRange(e,i>0?t.doc.length:0),d=0;for(let u=0;!h.next().done&&u<=n;){let p=h.value;i<0&&(u+=p.length);let f=e+u*i;for(let g=i>0?0:p.length-1,m=i>0?p.length:-1;g!=m;g+=i){let y=a.indexOf(p[g]);if(!(y<0||s.resolveInner(f+g,1).type!=r))if(y%2==0==i>0)d++;else{if(d==1)return{start:c,end:{from:f+g,to:f+g+1},matched:y>>1==l>>1};d--}}i>0&&(u+=p.length)}return h.done?{start:c,matched:!1}:null}const yE=Object.create(null),mf=[si.none],Of=[],yf=Object.create(null),vE=Object.create(null);for(let[t,e]of[["variable","variableName"],["variable-2","variableName.special"],["string-2","string.special"],["def","variableName.definition"],["tag","tagName"],["attribute","attributeName"],["type","typeName"],["builtin","variableName.standard"],["qualifier","modifier"],["error","invalid"],["header","heading"],["property","propertyName"]])vE[t]=bE(yE,e);function Tc(t,e){Of.indexOf(t)>-1||(Of.push(t),console.warn(e))}function bE(t,e){let i=[];for(let o of e.split(" ")){let l=[];for(let c of o.split(".")){let h=t[c]||$[c];h?typeof h=="function"?l.length?l=l.map(h):Tc(c,`Modifier ${c} used at start of tag`):l.length?Tc(c,`Tag ${c} used as modifier`):l=Array.isArray(h)?h:[h]:Tc(c,`Unknown highlighting tag ${c}`)}for(let c of l)i.push(c)}if(!i.length)return 0;let s=e.replace(/ /g,"_"),r=s+" "+i.map(o=>o.id),n=yf[r];if(n)return n.id;let a=yf[r]=si.define({id:mf.length,name:s,props:[Ol({[s]:i})]});return mf.push(a),a.id}Fe.RTL,Fe.LTR;const wE=t=>{let{state:e}=t,i=e.doc.lineAt(e.selection.main.from),s=Dd(t.state,i.from);return s.line?SE(t):s.block?kE(t):!1};function qd(t,e){return({state:i,dispatch:s})=>{if(i.readOnly)return!1;let r=t(e,i);return r?(s(i.update(r)),!0):!1}}const SE=qd(PE,0),xE=qd(XO,0),kE=qd((t,e)=>XO(t,e,EE(e)),0);function Dd(t,e){let i=t.languageDataAt("commentTokens",e,1);return i.length?i[0]:{}}const _n=50;function TE(t,{open:e,close:i},s,r){let n=t.sliceDoc(s-_n,s),a=t.sliceDoc(r,r+_n),o=/\s*$/.exec(n)[0].length,l=/^\s*/.exec(a)[0].length,c=n.length-o;if(n.slice(c-e.length,c)==e&&a.slice(l,l+i.length)==i)return{open:{pos:s-o,margin:o&&1},close:{pos:r+l,margin:l&&1}};let h,d;r-s<=2*_n?h=d=t.sliceDoc(s,r):(h=t.sliceDoc(s,s+_n),d=t.sliceDoc(r-_n,r));let u=/^\s*/.exec(h)[0].length,p=/\s*$/.exec(d)[0].length,f=d.length-p-i.length;return h.slice(u,u+e.length)==e&&d.slice(f,f+i.length)==i?{open:{pos:s+u+e.length,margin:/\s/.test(h.charAt(u+e.length))?1:0},close:{pos:r-p-i.length,margin:/\s/.test(d.charAt(f-1))?1:0}}:null}function EE(t){let e=[];for(let i of t.selection.ranges){let s=t.doc.lineAt(i.from),r=i.to<=s.to?s:t.doc.lineAt(i.to);r.from>s.from&&r.from==i.to&&(r=i.to==s.to+1?s:t.doc.lineAt(i.to-1));let n=e.length-1;n>=0&&e[n].to>s.from?e[n].to=r.to:e.push({from:s.from+/^\s*/.exec(s.text)[0].length,to:r.to})}return e}function XO(t,e,i=e.selection.ranges){let s=i.map(n=>Dd(e,n.from).block);if(!s.every(n=>n))return null;let r=i.map((n,a)=>TE(e,s[a],n.from,n.to));if(t!=2&&!r.every(n=>n))return{changes:e.changes(i.map((n,a)=>r[a]?[]:[{from:n.from,insert:s[a].open+" "},{from:n.to,insert:" "+s[a].close}]))};if(t!=1&&r.some(n=>n)){let n=[];for(let a=0,o;a<r.length;a++)if(o=r[a]){let l=s[a],{open:c,close:h}=o;n.push({from:c.pos-l.open.length,to:c.pos+c.margin},{from:h.pos-h.margin,to:h.pos+l.close.length})}return{changes:n}}return null}function PE(t,e,i=e.selection.ranges){let s=[],r=-1;for(let{from:n,to:a}of i){let o=s.length,l=1e9,c=Dd(e,n).line;if(c){for(let h=n;h<=a;){let d=e.doc.lineAt(h);if(d.from>r&&(n==a||a>d.from)){r=d.from;let u=/^\s*/.exec(d.text)[0].length,p=u==d.length,f=d.text.slice(u,u+c.length)==c?u:-1;u<d.text.length&&u<l&&(l=u),s.push({line:d,comment:f,token:c,indent:u,empty:p,single:!1})}h=d.to+1}if(l<1e9)for(let h=o;h<s.length;h++)s[h].indent<s[h].line.text.length&&(s[h].indent=l);s.length==o+1&&(s[o].single=!0)}}if(t!=2&&s.some(n=>n.comment<0&&(!n.empty||n.single))){let n=[];for(let{line:o,token:l,indent:c,empty:h,single:d}of s)(d||!h)&&n.push({from:o.from+c,insert:l+" "});let a=e.changes(n);return{changes:a,selection:e.selection.map(a,1)}}else if(t!=1&&s.some(n=>n.comment>=0)){let n=[];for(let{line:a,comment:o,token:l}of s)if(o>=0){let c=a.from+o,h=c+l.length;a.text[h-a.from]==" "&&h++,n.push({from:c,to:h})}return{changes:n}}return null}const Dh=ns.define(),CE=ns.define(),_E=se.define(),GO=se.define({combine(t){return on(t,{minDepth:100,newGroupDelay:500,joinToEvent:(e,i)=>i},{minDepth:Math.max,newGroupDelay:Math.min,joinToEvent:(e,i)=>(s,r)=>e(s,r)||i(s,r)})}}),YO=Mt.define({create(){return Ii.empty},update(t,e){let i=e.state.facet(GO),s=e.annotation(Dh);if(s){let l=Qt.fromTransaction(e,s.selection),c=s.side,h=c==0?t.undone:t.done;return l?h=Yo(h,h.length,i.minDepth,l):h=KO(h,e.startState.selection),new Ii(c==0?s.rest:h,c==0?h:s.rest)}let r=e.annotation(CE);if((r=="full"||r=="before")&&(t=t.isolate()),e.annotation(et.addToHistory)===!1)return e.changes.empty?t:t.addMapping(e.changes.desc);let n=Qt.fromTransaction(e),a=e.annotation(et.time),o=e.annotation(et.userEvent);return n?t=t.addChanges(n,a,o,i,e):e.selection&&(t=t.addSelection(e.startState.selection,a,o,i.newGroupDelay)),(r=="full"||r=="after")&&(t=t.isolate()),t},toJSON(t){return{done:t.done.map(e=>e.toJSON()),undone:t.undone.map(e=>e.toJSON())}},fromJSON(t){return new Ii(t.done.map(Qt.fromJSON),t.undone.map(Qt.fromJSON))}});function RE(t={}){return[YO,GO.of(t),te.domEventHandlers({beforeinput(e,i){let s=e.inputType=="historyUndo"?ZO:e.inputType=="historyRedo"?Bh:null;return s?(e.preventDefault(),s(i)):!1}})]}function xl(t,e){return function({state:i,dispatch:s}){if(!e&&i.readOnly)return!1;let r=i.field(YO,!1);if(!r)return!1;let n=r.pop(t,i,e);return n?(s(n),!0):!1}}const ZO=xl(0,!1),Bh=xl(1,!1),$E=xl(0,!0),IE=xl(1,!0);class Qt{constructor(e,i,s,r,n){this.changes=e,this.effects=i,this.mapped=s,this.startSelection=r,this.selectionsAfter=n}setSelAfter(e){return new Qt(this.changes,this.effects,this.mapped,this.startSelection,e)}toJSON(){var e,i,s;return{changes:(e=this.changes)===null||e===void 0?void 0:e.toJSON(),mapped:(i=this.mapped)===null||i===void 0?void 0:i.toJSON(),startSelection:(s=this.startSelection)===null||s===void 0?void 0:s.toJSON(),selectionsAfter:this.selectionsAfter.map(r=>r.toJSON())}}static fromJSON(e){return new Qt(e.changes&&rt.fromJSON(e.changes),[],e.mapped&&Qi.fromJSON(e.mapped),e.startSelection&&X.fromJSON(e.startSelection),e.selectionsAfter.map(X.fromJSON))}static fromTransaction(e,i){let s=ti;for(let r of e.startState.facet(_E)){let n=r(e);n.length&&(s=s.concat(n))}return!s.length&&e.changes.empty?null:new Qt(e.changes.invert(e.startState.doc),s,void 0,i||e.startState.selection,ti)}static selection(e){return new Qt(void 0,ti,void 0,void 0,e)}}function Yo(t,e,i,s){let r=e+1>i+20?e-i-1:0,n=t.slice(r,e);return n.push(s),n}function QE(t,e){let i=[],s=!1;return t.iterChangedRanges((r,n)=>i.push(r,n)),e.iterChangedRanges((r,n,a,o)=>{for(let l=0;l<i.length;){let c=i[l++],h=i[l++];o>=c&&a<=h&&(s=!0)}}),s}function AE(t,e){return t.ranges.length==e.ranges.length&&t.ranges.filter((i,s)=>i.empty!=e.ranges[s].empty).length===0}function HO(t,e){return t.length?e.length?t.concat(e):t:e}const ti=[],LE=200;function KO(t,e){if(t.length){let i=t[t.length-1],s=i.selectionsAfter.slice(Math.max(0,i.selectionsAfter.length-LE));return s.length&&s[s.length-1].eq(e)?t:(s.push(e),Yo(t,t.length-1,1e9,i.setSelAfter(s)))}else return[Qt.selection([e])]}function NE(t){let e=t[t.length-1],i=t.slice();return i[t.length-1]=e.setSelAfter(e.selectionsAfter.slice(0,e.selectionsAfter.length-1)),i}function Ec(t,e){if(!t.length)return t;let i=t.length,s=ti;for(;i;){let r=ME(t[i-1],e,s);if(r.changes&&!r.changes.empty||r.effects.length){let n=t.slice(0,i);return n[i-1]=r,n}else e=r.mapped,i--,s=r.selectionsAfter}return s.length?[Qt.selection(s)]:ti}function ME(t,e,i){let s=HO(t.selectionsAfter.length?t.selectionsAfter.map(o=>o.map(e)):ti,i);if(!t.changes)return Qt.selection(s);let r=t.changes.map(e),n=e.mapDesc(t.changes,!0),a=t.mapped?t.mapped.composeDesc(n):n;return new Qt(r,Ie.mapEffects(t.effects,e),a,t.startSelection.map(n),s)}const qE=/^(input\.type|delete)($|\.)/;class Ii{constructor(e,i,s=0,r=void 0){this.done=e,this.undone=i,this.prevTime=s,this.prevUserEvent=r}isolate(){return this.prevTime?new Ii(this.done,this.undone):this}addChanges(e,i,s,r,n){let a=this.done,o=a[a.length-1];return o&&o.changes&&!o.changes.empty&&e.changes&&(!s||qE.test(s))&&(!o.selectionsAfter.length&&i-this.prevTime<r.newGroupDelay&&r.joinToEvent(n,QE(o.changes,e.changes))||s=="input.type.compose")?a=Yo(a,a.length-1,r.minDepth,new Qt(e.changes.compose(o.changes),HO(Ie.mapEffects(e.effects,o.changes),o.effects),o.mapped,o.startSelection,ti)):a=Yo(a,a.length,r.minDepth,e),new Ii(a,ti,i,s)}addSelection(e,i,s,r){let n=this.done.length?this.done[this.done.length-1].selectionsAfter:ti;return n.length>0&&i-this.prevTime<r&&s==this.prevUserEvent&&s&&/^select($|\.)/.test(s)&&AE(n[n.length-1],e)?this:new Ii(KO(this.done,e),this.undone,i,s)}addMapping(e){return new Ii(Ec(this.done,e),Ec(this.undone,e),this.prevTime,this.prevUserEvent)}pop(e,i,s){let r=e==0?this.done:this.undone;if(r.length==0)return null;let n=r[r.length-1],a=n.selectionsAfter[0]||i.selection;if(s&&n.selectionsAfter.length)return i.update({selection:n.selectionsAfter[n.selectionsAfter.length-1],annotations:Dh.of({side:e,rest:NE(r),selection:a}),userEvent:e==0?"select.undo":"select.redo",scrollIntoView:!0});if(n.changes){let o=r.length==1?ti:r.slice(0,r.length-1);return n.mapped&&(o=Ec(o,n.mapped)),i.update({changes:n.changes,selection:n.startSelection,effects:n.effects,annotations:Dh.of({side:e,rest:o,selection:a}),filter:!1,userEvent:e==0?"undo":"redo",scrollIntoView:!0})}else return null}}Ii.empty=new Ii(ti,ti);const DE=[{key:"Mod-z",run:ZO,preventDefault:!0},{key:"Mod-y",mac:"Mod-Shift-z",run:Bh,preventDefault:!0},{linux:"Ctrl-Shift-z",run:Bh,preventDefault:!0},{key:"Mod-u",run:$E,preventDefault:!0},{key:"Alt-u",mac:"Mod-Shift-u",run:IE,preventDefault:!0}];function cn(t,e){return X.create(t.ranges.map(e),t.mainIndex)}function mi(t,e){return t.update({selection:e,scrollIntoView:!0,userEvent:"select"})}function Oi({state:t,dispatch:e},i){let s=cn(t.selection,i);return s.eq(t.selection,!0)?!1:(e(mi(t,s)),!0)}function kl(t,e){return X.cursor(e?t.to:t.from)}function JO(t,e){return Oi(t,i=>i.empty?t.moveByChar(i,e):kl(i,e))}function Tt(t){return t.textDirectionAt(t.state.selection.main.head)==Fe.LTR}const ey=t=>JO(t,!Tt(t)),ty=t=>JO(t,Tt(t));function iy(t,e){return Oi(t,i=>i.empty?t.moveByGroup(i,e):kl(i,e))}const BE=t=>iy(t,!Tt(t)),jE=t=>iy(t,Tt(t));function WE(t,e,i){if(e.type.prop(i))return!0;let s=e.to-e.from;return s&&(s>2||/[^\s,.;:]/.test(t.sliceDoc(e.from,e.to)))||e.firstChild}function Tl(t,e,i){let s=vt(t).resolveInner(e.head),r=i?ve.closedBy:ve.openedBy;for(let l=e.head;;){let c=i?s.childAfter(l):s.childBefore(l);if(!c)break;WE(t,c,r)?s=c:l=i?c.to:c.from}let n=s.type.prop(r),a,o;return n&&(a=i?$i(t,s.from,1):$i(t,s.to,-1))&&a.matched?o=i?a.end.to:a.end.from:o=i?s.to:s.from,X.cursor(o,i?-1:1)}const FE=t=>Oi(t,e=>Tl(t.state,e,!Tt(t))),UE=t=>Oi(t,e=>Tl(t.state,e,Tt(t)));function sy(t,e){return Oi(t,i=>{if(!i.empty)return kl(i,e);let s=t.moveVertically(i,e);return s.head!=i.head?s:t.moveToLineBoundary(i,e)})}const ry=t=>sy(t,!1),ny=t=>sy(t,!0);function ay(t){let e=t.scrollDOM.clientHeight<t.scrollDOM.scrollHeight-2,i=0,s=0,r;if(e){for(let n of t.state.facet(te.scrollMargins)){let a=n(t);a!=null&&a.top&&(i=Math.max(a==null?void 0:a.top,i)),a!=null&&a.bottom&&(s=Math.max(a==null?void 0:a.bottom,s))}r=t.scrollDOM.clientHeight-i-s}else r=(t.dom.ownerDocument.defaultView||window).innerHeight;return{marginTop:i,marginBottom:s,selfScroll:e,height:Math.max(t.defaultLineHeight,r-5)}}function oy(t,e){let i=ay(t),{state:s}=t,r=cn(s.selection,a=>a.empty?t.moveVertically(a,e,i.height):kl(a,e));if(r.eq(s.selection))return!1;let n;if(i.selfScroll){let a=t.coordsAtPos(s.selection.main.head),o=t.scrollDOM.getBoundingClientRect(),l=o.top+i.marginTop,c=o.bottom-i.marginBottom;a&&a.top>l&&a.bottom<c&&(n=te.scrollIntoView(r.main.head,{y:"start",yMargin:a.top-l}))}return t.dispatch(mi(s,r),{effects:n}),!0}const vf=t=>oy(t,!1),jh=t=>oy(t,!0);function _s(t,e,i){let s=t.lineBlockAt(e.head),r=t.moveToLineBoundary(e,i);if(r.head==e.head&&r.head!=(i?s.to:s.from)&&(r=t.moveToLineBoundary(e,i,!1)),!i&&r.head==s.from&&s.length){let n=/^\s*/.exec(t.state.sliceDoc(s.from,Math.min(s.from+100,s.to)))[0].length;n&&e.head!=s.from+n&&(r=X.cursor(s.from+n))}return r}const VE=t=>Oi(t,e=>_s(t,e,!0)),zE=t=>Oi(t,e=>_s(t,e,!1)),XE=t=>Oi(t,e=>_s(t,e,!Tt(t))),GE=t=>Oi(t,e=>_s(t,e,Tt(t))),YE=t=>Oi(t,e=>X.cursor(t.lineBlockAt(e.head).from,1)),ZE=t=>Oi(t,e=>X.cursor(t.lineBlockAt(e.head).to,-1));function HE(t,e,i){let s=!1,r=cn(t.selection,n=>{let a=$i(t,n.head,-1)||$i(t,n.head,1)||n.head>0&&$i(t,n.head-1,1)||n.head<t.doc.length&&$i(t,n.head+1,-1);if(!a||!a.end)return n;s=!0;let o=a.start.from==n.head?a.end.to:a.end.from;return X.cursor(o)});return s?(e(mi(t,r)),!0):!1}const KE=({state:t,dispatch:e})=>HE(t,e);function ri(t,e){let i=cn(t.state.selection,s=>{let r=e(s);return X.range(s.anchor,r.head,r.goalColumn,r.bidiLevel||void 0)});return i.eq(t.state.selection)?!1:(t.dispatch(mi(t.state,i)),!0)}function ly(t,e){return ri(t,i=>t.moveByChar(i,e))}const cy=t=>ly(t,!Tt(t)),hy=t=>ly(t,Tt(t));function dy(t,e){return ri(t,i=>t.moveByGroup(i,e))}const JE=t=>dy(t,!Tt(t)),eP=t=>dy(t,Tt(t)),tP=t=>ri(t,e=>Tl(t.state,e,!Tt(t))),iP=t=>ri(t,e=>Tl(t.state,e,Tt(t)));function uy(t,e){return ri(t,i=>t.moveVertically(i,e))}const py=t=>uy(t,!1),fy=t=>uy(t,!0);function gy(t,e){return ri(t,i=>t.moveVertically(i,e,ay(t).height))}const bf=t=>gy(t,!1),wf=t=>gy(t,!0),sP=t=>ri(t,e=>_s(t,e,!0)),rP=t=>ri(t,e=>_s(t,e,!1)),nP=t=>ri(t,e=>_s(t,e,!Tt(t))),aP=t=>ri(t,e=>_s(t,e,Tt(t))),oP=t=>ri(t,e=>X.cursor(t.lineBlockAt(e.head).from)),lP=t=>ri(t,e=>X.cursor(t.lineBlockAt(e.head).to)),Sf=({state:t,dispatch:e})=>(e(mi(t,{anchor:0})),!0),xf=({state:t,dispatch:e})=>(e(mi(t,{anchor:t.doc.length})),!0),kf=({state:t,dispatch:e})=>(e(mi(t,{anchor:t.selection.main.anchor,head:0})),!0),Tf=({state:t,dispatch:e})=>(e(mi(t,{anchor:t.selection.main.anchor,head:t.doc.length})),!0),cP=({state:t,dispatch:e})=>(e(t.update({selection:{anchor:0,head:t.doc.length},userEvent:"select"})),!0),hP=({state:t,dispatch:e})=>{let i=El(t).map(({from:s,to:r})=>X.range(s,Math.min(r+1,t.doc.length)));return e(t.update({selection:X.create(i),userEvent:"select"})),!0},dP=({state:t,dispatch:e})=>{let i=cn(t.selection,s=>{let r=vt(t),n=r.resolveStack(s.from,1);if(s.empty){let a=r.resolveStack(s.from,-1);a.node.from>=n.node.from&&a.node.to<=n.node.to&&(n=a)}for(let a=n;a;a=a.next){let{node:o}=a;if((o.from<s.from&&o.to>=s.to||o.to>s.to&&o.from<=s.from)&&a.next)return X.range(o.to,o.from)}return s});return i.eq(t.selection)?!1:(e(mi(t,i)),!0)};function my(t,e){let{state:i}=t,s=i.selection,r=i.selection.ranges.slice();for(let n of i.selection.ranges){let a=i.doc.lineAt(n.head);if(e?a.to<t.state.doc.length:a.from>0)for(let o=n;;){let l=t.moveVertically(o,e);if(l.head<a.from||l.head>a.to){r.some(c=>c.head==l.head)||r.push(l);break}else{if(l.head==o.head)break;o=l}}}return r.length==s.ranges.length?!1:(t.dispatch(mi(i,X.create(r,r.length-1))),!0)}const uP=t=>my(t,!1),pP=t=>my(t,!0),fP=({state:t,dispatch:e})=>{let i=t.selection,s=null;return i.ranges.length>1?s=X.create([i.main]):i.main.empty||(s=X.create([X.cursor(i.main.head)])),s?(e(mi(t,s)),!0):!1};function Ca(t,e){if(t.state.readOnly)return!1;let i="delete.selection",{state:s}=t,r=s.changeByRange(n=>{let{from:a,to:o}=n;if(a==o){let l=e(n);l<a?(i="delete.backward",l=uo(t,l,!1)):l>a&&(i="delete.forward",l=uo(t,l,!0)),a=Math.min(a,l),o=Math.max(o,l)}else a=uo(t,a,!1),o=uo(t,o,!0);return a==o?{range:n}:{changes:{from:a,to:o},range:X.cursor(a,a<n.head?-1:1)}});return r.changes.empty?!1:(t.dispatch(s.update(r,{scrollIntoView:!0,userEvent:i,effects:i=="delete.selection"?te.announce.of(s.phrase("Selection deleted")):void 0})),!0)}function uo(t,e,i){if(t instanceof te)for(let s of t.state.facet(te.atomicRanges).map(r=>r(t)))s.between(e,e,(r,n)=>{r<e&&n>e&&(e=i?n:r)});return e}const Oy=(t,e,i)=>Ca(t,s=>{let r=s.from,{state:n}=t,a=n.doc.lineAt(r),o,l;if(i&&!e&&r>a.from&&r<a.from+200&&!/[^ \t]/.test(o=a.text.slice(0,r-a.from))){if(o[o.length-1]=="	")return r-1;let c=ln(o,n.tabSize),h=c%zo(n)||zo(n);for(let d=0;d<h&&o[o.length-1-d]==" ";d++)r--;l=r}else l=Ot(a.text,r-a.from,e,e)+a.from,l==r&&a.number!=(e?n.doc.lines:1)?l+=e?1:-1:!e&&/[\ufe00-\ufe0f]/.test(a.text.slice(l-a.from,r-a.from))&&(l=Ot(a.text,l-a.from,!1,!1)+a.from);return l}),Wh=t=>Oy(t,!1,!0),yy=t=>Oy(t,!0,!1),vy=(t,e)=>Ca(t,i=>{let s=i.head,{state:r}=t,n=r.doc.lineAt(s),a=r.charCategorizer(s);for(let o=null;;){if(s==(e?n.to:n.from)){s==i.head&&n.number!=(e?r.doc.lines:1)&&(s+=e?1:-1);break}let l=Ot(n.text,s-n.from,e)+n.from,c=n.text.slice(Math.min(s,l)-n.from,Math.max(s,l)-n.from),h=a(c);if(o!=null&&h!=o)break;(c!=" "||s!=i.head)&&(o=h),s=l}return s}),by=t=>vy(t,!1),gP=t=>vy(t,!0),mP=t=>Ca(t,e=>{let i=t.lineBlockAt(e.head).to;return e.head<i?i:Math.min(t.state.doc.length,e.head+1)}),OP=t=>Ca(t,e=>{let i=t.moveToLineBoundary(e,!1).head;return e.head>i?i:Math.max(0,e.head-1)}),yP=t=>Ca(t,e=>{let i=t.moveToLineBoundary(e,!0).head;return e.head<i?i:Math.min(t.state.doc.length,e.head+1)}),vP=({state:t,dispatch:e})=>{if(t.readOnly)return!1;let i=t.changeByRange(s=>({changes:{from:s.from,to:s.to,insert:$e.of(["",""])},range:X.cursor(s.from)}));return e(t.update(i,{scrollIntoView:!0,userEvent:"input"})),!0},bP=({state:t,dispatch:e})=>{if(t.readOnly)return!1;let i=t.changeByRange(s=>{if(!s.empty||s.from==0||s.from==t.doc.length)return{range:s};let r=s.from,n=t.doc.lineAt(r),a=r==n.from?r-1:Ot(n.text,r-n.from,!1)+n.from,o=r==n.to?r+1:Ot(n.text,r-n.from,!0)+n.from;return{changes:{from:a,to:o,insert:t.doc.slice(r,o).append(t.doc.slice(a,r))},range:X.cursor(o)}});return i.changes.empty?!1:(e(t.update(i,{scrollIntoView:!0,userEvent:"move.character"})),!0)};function El(t){let e=[],i=-1;for(let s of t.selection.ranges){let r=t.doc.lineAt(s.from),n=t.doc.lineAt(s.to);if(!s.empty&&s.to==n.from&&(n=t.doc.lineAt(s.to-1)),i>=r.number){let a=e[e.length-1];a.to=n.to,a.ranges.push(s)}else e.push({from:r.from,to:n.to,ranges:[s]});i=n.number+1}return e}function wy(t,e,i){if(t.readOnly)return!1;let s=[],r=[];for(let n of El(t)){if(i?n.to==t.doc.length:n.from==0)continue;let a=t.doc.lineAt(i?n.to+1:n.from-1),o=a.length+1;if(i){s.push({from:n.to,to:a.to},{from:n.from,insert:a.text+t.lineBreak});for(let l of n.ranges)r.push(X.range(Math.min(t.doc.length,l.anchor+o),Math.min(t.doc.length,l.head+o)))}else{s.push({from:a.from,to:n.from},{from:n.to,insert:t.lineBreak+a.text});for(let l of n.ranges)r.push(X.range(l.anchor-o,l.head-o))}}return s.length?(e(t.update({changes:s,scrollIntoView:!0,selection:X.create(r,t.selection.mainIndex),userEvent:"move.line"})),!0):!1}const wP=({state:t,dispatch:e})=>wy(t,e,!1),SP=({state:t,dispatch:e})=>wy(t,e,!0);function Sy(t,e,i){if(t.readOnly)return!1;let s=[];for(let n of El(t))i?s.push({from:n.from,insert:t.doc.slice(n.from,n.to)+t.lineBreak}):s.push({from:n.to,insert:t.lineBreak+t.doc.slice(n.from,n.to)});let r=t.changes(s);return e(t.update({changes:r,selection:t.selection.map(r,i?1:-1),scrollIntoView:!0,userEvent:"input.copyline"})),!0}const xP=({state:t,dispatch:e})=>Sy(t,e,!1),kP=({state:t,dispatch:e})=>Sy(t,e,!0),TP=t=>{if(t.state.readOnly)return!1;let{state:e}=t,i=e.changes(El(e).map(({from:r,to:n})=>(r>0?r--:n<e.doc.length&&n++,{from:r,to:n}))),s=cn(e.selection,r=>{let n;if(t.lineWrapping){let a=t.lineBlockAt(r.head),o=t.coordsAtPos(r.head,r.assoc||1);o&&(n=a.bottom+t.documentTop-o.bottom+t.defaultLineHeight/2)}return t.moveVertically(r,!0,n)}).map(i);return t.dispatch({changes:i,selection:s,scrollIntoView:!0,userEvent:"delete.line"}),!0};function EP(t,e){if(/\(\)|\[\]|\{\}/.test(t.sliceDoc(e-1,e+1)))return{from:e,to:e};let i=vt(t).resolveInner(e),s=i.childBefore(e),r=i.childAfter(e),n;return s&&r&&s.to<=e&&r.from>=e&&(n=s.type.prop(ve.closedBy))&&n.indexOf(r.name)>-1&&t.doc.lineAt(s.to).from==t.doc.lineAt(r.from).from&&!/\S/.test(t.sliceDoc(s.to,r.from))?{from:s.to,to:r.from}:null}const Ef=xy(!1),PP=xy(!0);function xy(t){return({state:e,dispatch:i})=>{if(e.readOnly)return!1;let s=e.changeByRange(r=>{let{from:n,to:a}=r,o=e.doc.lineAt(n),l=!t&&n==a&&EP(e,n);t&&(n=a=(a<=o.to?o:e.doc.lineAt(a)).to);let c=new vl(e,{simulateBreak:n,simulateDoubleBreak:!!l}),h=Ld(c,n);for(h==null&&(h=ln(/^\s*/.exec(e.doc.lineAt(n).text)[0],e.tabSize));a<o.to&&/\s/.test(o.text[a-o.from]);)a++;l?{from:n,to:a}=l:n>o.from&&n<o.from+100&&!/\S/.test(o.text.slice(0,n))&&(n=o.from);let d=["",ga(e,h)];return l&&d.push(ga(e,c.lineIndent(o.from,-1))),{changes:{from:n,to:a,insert:$e.of(d)},range:X.cursor(n+1+d[1].length)}});return i(e.update(s,{scrollIntoView:!0,userEvent:"input"})),!0}}function Bd(t,e){let i=-1;return t.changeByRange(s=>{let r=[];for(let a=s.from;a<=s.to;){let o=t.doc.lineAt(a);o.number>i&&(s.empty||s.to>o.from)&&(e(o,r,s),i=o.number),a=o.to+1}let n=t.changes(r);return{changes:r,range:X.range(n.mapPos(s.anchor,1),n.mapPos(s.head,1))}})}const CP=({state:t,dispatch:e})=>{if(t.readOnly)return!1;let i=Object.create(null),s=new vl(t,{overrideIndentation:n=>{let a=i[n];return a??-1}}),r=Bd(t,(n,a,o)=>{let l=Ld(s,n.from);if(l==null)return;/\S/.test(n.text)||(l=0);let c=/^\s*/.exec(n.text)[0],h=ga(t,l);(c!=h||o.from<n.from+c.length)&&(i[n.from]=l,a.push({from:n.from,to:n.from+c.length,insert:h}))});return r.changes.empty||e(t.update(r,{userEvent:"indent"})),!0},ky=({state:t,dispatch:e})=>t.readOnly?!1:(e(t.update(Bd(t,(i,s)=>{s.push({from:i.from,insert:t.facet(yl)})}),{userEvent:"input.indent"})),!0),Ty=({state:t,dispatch:e})=>t.readOnly?!1:(e(t.update(Bd(t,(i,s)=>{let r=/^\s*/.exec(i.text)[0];if(!r)return;let n=ln(r,t.tabSize),a=0,o=ga(t,Math.max(0,n-zo(t)));for(;a<r.length&&a<o.length&&r.charCodeAt(a)==o.charCodeAt(a);)a++;s.push({from:i.from+a,to:i.from+r.length,insert:o.slice(a)})}),{userEvent:"delete.dedent"})),!0),_P=t=>(t.setTabFocusMode(),!0),RP=[{key:"Ctrl-b",run:ey,shift:cy,preventDefault:!0},{key:"Ctrl-f",run:ty,shift:hy},{key:"Ctrl-p",run:ry,shift:py},{key:"Ctrl-n",run:ny,shift:fy},{key:"Ctrl-a",run:YE,shift:oP},{key:"Ctrl-e",run:ZE,shift:lP},{key:"Ctrl-d",run:yy},{key:"Ctrl-h",run:Wh},{key:"Ctrl-k",run:mP},{key:"Ctrl-Alt-h",run:by},{key:"Ctrl-o",run:vP},{key:"Ctrl-t",run:bP},{key:"Ctrl-v",run:jh}],$P=[{key:"ArrowLeft",run:ey,shift:cy,preventDefault:!0},{key:"Mod-ArrowLeft",mac:"Alt-ArrowLeft",run:BE,shift:JE,preventDefault:!0},{mac:"Cmd-ArrowLeft",run:XE,shift:nP,preventDefault:!0},{key:"ArrowRight",run:ty,shift:hy,preventDefault:!0},{key:"Mod-ArrowRight",mac:"Alt-ArrowRight",run:jE,shift:eP,preventDefault:!0},{mac:"Cmd-ArrowRight",run:GE,shift:aP,preventDefault:!0},{key:"ArrowUp",run:ry,shift:py,preventDefault:!0},{mac:"Cmd-ArrowUp",run:Sf,shift:kf},{mac:"Ctrl-ArrowUp",run:vf,shift:bf},{key:"ArrowDown",run:ny,shift:fy,preventDefault:!0},{mac:"Cmd-ArrowDown",run:xf,shift:Tf},{mac:"Ctrl-ArrowDown",run:jh,shift:wf},{key:"PageUp",run:vf,shift:bf},{key:"PageDown",run:jh,shift:wf},{key:"Home",run:zE,shift:rP,preventDefault:!0},{key:"Mod-Home",run:Sf,shift:kf},{key:"End",run:VE,shift:sP,preventDefault:!0},{key:"Mod-End",run:xf,shift:Tf},{key:"Enter",run:Ef,shift:Ef},{key:"Mod-a",run:cP},{key:"Backspace",run:Wh,shift:Wh,preventDefault:!0},{key:"Delete",run:yy,preventDefault:!0},{key:"Mod-Backspace",mac:"Alt-Backspace",run:by,preventDefault:!0},{key:"Mod-Delete",mac:"Alt-Delete",run:gP,preventDefault:!0},{mac:"Mod-Backspace",run:OP,preventDefault:!0},{mac:"Mod-Delete",run:yP,preventDefault:!0}].concat(RP.map(t=>({mac:t.key,run:t.run,shift:t.shift}))),IP=[{key:"Alt-ArrowLeft",mac:"Ctrl-ArrowLeft",run:FE,shift:tP},{key:"Alt-ArrowRight",mac:"Ctrl-ArrowRight",run:UE,shift:iP},{key:"Alt-ArrowUp",run:wP},{key:"Shift-Alt-ArrowUp",run:xP},{key:"Alt-ArrowDown",run:SP},{key:"Shift-Alt-ArrowDown",run:kP},{key:"Mod-Alt-ArrowUp",run:uP},{key:"Mod-Alt-ArrowDown",run:pP},{key:"Escape",run:fP},{key:"Mod-Enter",run:PP},{key:"Alt-l",mac:"Ctrl-l",run:hP},{key:"Mod-i",run:dP,preventDefault:!0},{key:"Mod-[",run:Ty},{key:"Mod-]",run:ky},{key:"Mod-Alt-\\",run:CP},{key:"Shift-Mod-k",run:TP},{key:"Shift-Mod-\\",run:KE},{key:"Mod-/",run:wE},{key:"Alt-A",run:xE},{key:"Ctrl-m",mac:"Shift-Alt-m",run:_P}].concat($P),QP={key:"Tab",run:ky,shift:Ty};var Pf={};class Zo{constructor(e,i,s,r,n,a,o,l,c,h=0,d){this.p=e,this.stack=i,this.state=s,this.reducePos=r,this.pos=n,this.score=a,this.buffer=o,this.bufferBase=l,this.curContext=c,this.lookAhead=h,this.parent=d}toString(){return`[${this.stack.filter((e,i)=>i%3==0).concat(this.state)}]@${this.pos}${this.score?"!"+this.score:""}`}static start(e,i,s=0){let r=e.parser.context;return new Zo(e,[],i,s,s,0,[],0,r?new Cf(r,r.start):null,0,null)}get context(){return this.curContext?this.curContext.context:null}pushState(e,i){this.stack.push(this.state,i,this.bufferBase+this.buffer.length),this.state=e}reduce(e){var i;let s=e>>19,r=e&65535,{parser:n}=this.p,a=this.reducePos<this.pos-25&&this.setLookAhead(this.pos),o=n.dynamicPrecedence(r);if(o&&(this.score+=o),s==0){this.pushState(n.getGoto(this.state,r,!0),this.reducePos),r<n.minRepeatTerm&&this.storeNode(r,this.reducePos,this.reducePos,a?8:4,!0),this.reduceContext(r,this.reducePos);return}let l=this.stack.length-(s-1)*3-(e&262144?6:0),c=l?this.stack[l-2]:this.p.ranges[0].from,h=this.reducePos-c;h>=2e3&&!(!((i=this.p.parser.nodeSet.types[r])===null||i===void 0)&&i.isAnonymous)&&(c==this.p.lastBigReductionStart?(this.p.bigReductionCount++,this.p.lastBigReductionSize=h):this.p.lastBigReductionSize<h&&(this.p.bigReductionCount=1,this.p.lastBigReductionStart=c,this.p.lastBigReductionSize=h));let d=l?this.stack[l-1]:0,u=this.bufferBase+this.buffer.length-d;if(r<n.minRepeatTerm||e&131072){let p=n.stateFlag(this.state,1)?this.pos:this.reducePos;this.storeNode(r,c,p,u+4,!0)}if(e&262144)this.state=this.stack[l];else{let p=this.stack[l-3];this.state=n.getGoto(p,r,!0)}for(;this.stack.length>l;)this.stack.pop();this.reduceContext(r,c)}storeNode(e,i,s,r=4,n=!1){if(e==0&&(!this.stack.length||this.stack[this.stack.length-1]<this.buffer.length+this.bufferBase)){let a=this,o=this.buffer.length;if(o==0&&a.parent&&(o=a.bufferBase-a.parent.bufferBase,a=a.parent),o>0&&a.buffer[o-4]==0&&a.buffer[o-1]>-1){if(i==s)return;if(a.buffer[o-2]>=i){a.buffer[o-2]=s;return}}}if(!n||this.pos==s)this.buffer.push(e,i,s,r);else{let a=this.buffer.length;if(a>0&&(this.buffer[a-4]!=0||this.buffer[a-1]<0)){let o=!1;for(let l=a;l>0&&this.buffer[l-2]>s;l-=4)if(this.buffer[l-1]>=0){o=!0;break}if(o)for(;a>0&&this.buffer[a-2]>s;)this.buffer[a]=this.buffer[a-4],this.buffer[a+1]=this.buffer[a-3],this.buffer[a+2]=this.buffer[a-2],this.buffer[a+3]=this.buffer[a-1],a-=4,r>4&&(r-=4)}this.buffer[a]=e,this.buffer[a+1]=i,this.buffer[a+2]=s,this.buffer[a+3]=r}}shift(e,i,s,r){if(e&131072)this.pushState(e&65535,this.pos);else if(e&262144)this.pos=r,this.shiftContext(i,s),i<=this.p.parser.maxNode&&this.buffer.push(i,s,r,4);else{let n=e,{parser:a}=this.p;this.pos=r,!a.stateFlag(n,1)&&(r>s||i<=a.maxNode)&&(this.reducePos=r),this.pushState(n,Math.min(s,this.reducePos)),this.shiftContext(i,s),i<=a.maxNode&&this.buffer.push(i,s,r,4)}}apply(e,i,s,r){e&65536?this.reduce(e):this.shift(e,i,s,r)}useNode(e,i){let s=this.p.reused.length-1;(s<0||this.p.reused[s]!=e)&&(this.p.reused.push(e),s++);let r=this.pos;this.reducePos=this.pos=r+e.length,this.pushState(i,r),this.buffer.push(s,r,this.reducePos,-1),this.curContext&&this.updateContext(this.curContext.tracker.reuse(this.curContext.context,e,this,this.p.stream.reset(this.pos-e.length)))}split(){let e=this,i=e.buffer.length;for(;i>0&&e.buffer[i-2]>e.reducePos;)i-=4;let s=e.buffer.slice(i),r=e.bufferBase+i;for(;e&&r==e.bufferBase;)e=e.parent;return new Zo(this.p,this.stack.slice(),this.state,this.reducePos,this.pos,this.score,s,r,this.curContext,this.lookAhead,e)}recoverByDelete(e,i){let s=e<=this.p.parser.maxNode;s&&this.storeNode(e,this.pos,i,4),this.storeNode(0,this.pos,i,s?8:4),this.pos=this.reducePos=i,this.score-=190}canShift(e){for(let i=new AP(this);;){let s=this.p.parser.stateSlot(i.state,4)||this.p.parser.hasAction(i.state,e);if(s==0)return!1;if(!(s&65536))return!0;i.reduce(s)}}recoverByInsert(e){if(this.stack.length>=300)return[];let i=this.p.parser.nextStates(this.state);if(i.length>8||this.stack.length>=120){let r=[];for(let n=0,a;n<i.length;n+=2)(a=i[n+1])!=this.state&&this.p.parser.hasAction(a,e)&&r.push(i[n],a);if(this.stack.length<120)for(let n=0;r.length<8&&n<i.length;n+=2){let a=i[n+1];r.some((o,l)=>l&1&&o==a)||r.push(i[n],a)}i=r}let s=[];for(let r=0;r<i.length&&s.length<4;r+=2){let n=i[r+1];if(n==this.state)continue;let a=this.split();a.pushState(n,this.pos),a.storeNode(0,a.pos,a.pos,4,!0),a.shiftContext(i[r],this.pos),a.reducePos=this.pos,a.score-=200,s.push(a)}return s}forceReduce(){let{parser:e}=this.p,i=e.stateSlot(this.state,5);if(!(i&65536))return!1;if(!e.validAction(this.state,i)){let s=i>>19,r=i&65535,n=this.stack.length-s*3;if(n<0||e.getGoto(this.stack[n],r,!1)<0){let a=this.findForcedReduction();if(a==null)return!1;i=a}this.storeNode(0,this.pos,this.pos,4,!0),this.score-=100}return this.reducePos=this.pos,this.reduce(i),!0}findForcedReduction(){let{parser:e}=this.p,i=[],s=(r,n)=>{if(!i.includes(r))return i.push(r),e.allActions(r,a=>{if(!(a&393216))if(a&65536){let o=(a>>19)-n;if(o>1){let l=a&65535,c=this.stack.length-o*3;if(c>=0&&e.getGoto(this.stack[c],l,!1)>=0)return o<<19|65536|l}}else{let o=s(a,n+1);if(o!=null)return o}})};return s(this.state,0)}forceAll(){for(;!this.p.parser.stateFlag(this.state,2);)if(!this.forceReduce()){this.storeNode(0,this.pos,this.pos,4,!0);break}return this}get deadEnd(){if(this.stack.length!=3)return!1;let{parser:e}=this.p;return e.data[e.stateSlot(this.state,1)]==65535&&!e.stateSlot(this.state,4)}restart(){this.storeNode(0,this.pos,this.pos,4,!0),this.state=this.stack[0],this.stack.length=0}sameState(e){if(this.state!=e.state||this.stack.length!=e.stack.length)return!1;for(let i=0;i<this.stack.length;i+=3)if(this.stack[i]!=e.stack[i])return!1;return!0}get parser(){return this.p.parser}dialectEnabled(e){return this.p.parser.dialect.flags[e]}shiftContext(e,i){this.curContext&&this.updateContext(this.curContext.tracker.shift(this.curContext.context,e,this,this.p.stream.reset(i)))}reduceContext(e,i){this.curContext&&this.updateContext(this.curContext.tracker.reduce(this.curContext.context,e,this,this.p.stream.reset(i)))}emitContext(){let e=this.buffer.length-1;(e<0||this.buffer[e]!=-3)&&this.buffer.push(this.curContext.hash,this.pos,this.pos,-3)}emitLookAhead(){let e=this.buffer.length-1;(e<0||this.buffer[e]!=-4)&&this.buffer.push(this.lookAhead,this.pos,this.pos,-4)}updateContext(e){if(e!=this.curContext.context){let i=new Cf(this.curContext.tracker,e);i.hash!=this.curContext.hash&&this.emitContext(),this.curContext=i}}setLookAhead(e){return e<=this.lookAhead?!1:(this.emitLookAhead(),this.lookAhead=e,!0)}close(){this.curContext&&this.curContext.tracker.strict&&this.emitContext(),this.lookAhead>0&&this.emitLookAhead()}}class Cf{constructor(e,i){this.tracker=e,this.context=i,this.hash=e.strict?e.hash(i):0}}class AP{constructor(e){this.start=e,this.state=e.state,this.stack=e.stack,this.base=this.stack.length}reduce(e){let i=e&65535,s=e>>19;s==0?(this.stack==this.start.stack&&(this.stack=this.stack.slice()),this.stack.push(this.state,0,0),this.base+=3):this.base-=(s-1)*3;let r=this.start.p.parser.getGoto(this.stack[this.base-3],i,!0);this.state=r}}class Ho{constructor(e,i,s){this.stack=e,this.pos=i,this.index=s,this.buffer=e.buffer,this.index==0&&this.maybeNext()}static create(e,i=e.bufferBase+e.buffer.length){return new Ho(e,i,i-e.bufferBase)}maybeNext(){let e=this.stack.parent;e!=null&&(this.index=this.stack.bufferBase-e.bufferBase,this.stack=e,this.buffer=e.buffer)}get id(){return this.buffer[this.index-4]}get start(){return this.buffer[this.index-3]}get end(){return this.buffer[this.index-2]}get size(){return this.buffer[this.index-1]}next(){this.index-=4,this.pos-=4,this.index==0&&this.maybeNext()}fork(){return new Ho(this.stack,this.pos,this.index)}}function Dn(t,e=Uint16Array){if(typeof t!="string")return t;let i=null;for(let s=0,r=0;s<t.length;){let n=0;for(;;){let a=t.charCodeAt(s++),o=!1;if(a==126){n=65535;break}a>=92&&a--,a>=34&&a--;let l=a-32;if(l>=46&&(l-=46,o=!0),n+=l,o)break;n*=46}i?i[r++]=n:i=new e(n)}return i}class Eo{constructor(){this.start=-1,this.value=-1,this.end=-1,this.extended=-1,this.lookAhead=0,this.mask=0,this.context=0}}const _f=new Eo;class LP{constructor(e,i){this.input=e,this.ranges=i,this.chunk="",this.chunkOff=0,this.chunk2="",this.chunk2Pos=0,this.next=-1,this.token=_f,this.rangeIndex=0,this.pos=this.chunkPos=i[0].from,this.range=i[0],this.end=i[i.length-1].to,this.readNext()}resolveOffset(e,i){let s=this.range,r=this.rangeIndex,n=this.pos+e;for(;n<s.from;){if(!r)return null;let a=this.ranges[--r];n-=s.from-a.to,s=a}for(;i<0?n>s.to:n>=s.to;){if(r==this.ranges.length-1)return null;let a=this.ranges[++r];n+=a.from-s.to,s=a}return n}clipPos(e){if(e>=this.range.from&&e<this.range.to)return e;for(let i of this.ranges)if(i.to>e)return Math.max(e,i.from);return this.end}peek(e){let i=this.chunkOff+e,s,r;if(i>=0&&i<this.chunk.length)s=this.pos+e,r=this.chunk.charCodeAt(i);else{let n=this.resolveOffset(e,1);if(n==null)return-1;if(s=n,s>=this.chunk2Pos&&s<this.chunk2Pos+this.chunk2.length)r=this.chunk2.charCodeAt(s-this.chunk2Pos);else{let a=this.rangeIndex,o=this.range;for(;o.to<=s;)o=this.ranges[++a];this.chunk2=this.input.chunk(this.chunk2Pos=s),s+this.chunk2.length>o.to&&(this.chunk2=this.chunk2.slice(0,o.to-s)),r=this.chunk2.charCodeAt(0)}}return s>=this.token.lookAhead&&(this.token.lookAhead=s+1),r}acceptToken(e,i=0){let s=i?this.resolveOffset(i,-1):this.pos;if(s==null||s<this.token.start)throw new RangeError("Token end out of bounds");this.token.value=e,this.token.end=s}acceptTokenTo(e,i){this.token.value=e,this.token.end=i}getChunk(){if(this.pos>=this.chunk2Pos&&this.pos<this.chunk2Pos+this.chunk2.length){let{chunk:e,chunkPos:i}=this;this.chunk=this.chunk2,this.chunkPos=this.chunk2Pos,this.chunk2=e,this.chunk2Pos=i,this.chunkOff=this.pos-this.chunkPos}else{this.chunk2=this.chunk,this.chunk2Pos=this.chunkPos;let e=this.input.chunk(this.pos),i=this.pos+e.length;this.chunk=i>this.range.to?e.slice(0,this.range.to-this.pos):e,this.chunkPos=this.pos,this.chunkOff=0}}readNext(){return this.chunkOff>=this.chunk.length&&(this.getChunk(),this.chunkOff==this.chunk.length)?this.next=-1:this.next=this.chunk.charCodeAt(this.chunkOff)}advance(e=1){for(this.chunkOff+=e;this.pos+e>=this.range.to;){if(this.rangeIndex==this.ranges.length-1)return this.setDone();e-=this.range.to-this.pos,this.range=this.ranges[++this.rangeIndex],this.pos=this.range.from}return this.pos+=e,this.pos>=this.token.lookAhead&&(this.token.lookAhead=this.pos+1),this.readNext()}setDone(){return this.pos=this.chunkPos=this.end,this.range=this.ranges[this.rangeIndex=this.ranges.length-1],this.chunk="",this.next=-1}reset(e,i){if(i?(this.token=i,i.start=e,i.lookAhead=e+1,i.value=i.extended=-1):this.token=_f,this.pos!=e){if(this.pos=e,e==this.end)return this.setDone(),this;for(;e<this.range.from;)this.range=this.ranges[--this.rangeIndex];for(;e>=this.range.to;)this.range=this.ranges[++this.rangeIndex];e>=this.chunkPos&&e<this.chunkPos+this.chunk.length?this.chunkOff=e-this.chunkPos:(this.chunk="",this.chunkOff=0),this.readNext()}return this}read(e,i){if(e>=this.chunkPos&&i<=this.chunkPos+this.chunk.length)return this.chunk.slice(e-this.chunkPos,i-this.chunkPos);if(e>=this.chunk2Pos&&i<=this.chunk2Pos+this.chunk2.length)return this.chunk2.slice(e-this.chunk2Pos,i-this.chunk2Pos);if(e>=this.range.from&&i<=this.range.to)return this.input.read(e,i);let s="";for(let r of this.ranges){if(r.from>=i)break;r.to>e&&(s+=this.input.read(Math.max(r.from,e),Math.min(r.to,i)))}return s}}class zr{constructor(e,i){this.data=e,this.id=i}token(e,i){let{parser:s}=i.p;Ey(this.data,e,i,this.id,s.data,s.tokenPrecTable)}}zr.prototype.contextual=zr.prototype.fallback=zr.prototype.extend=!1;class Fh{constructor(e,i,s){this.precTable=i,this.elseToken=s,this.data=typeof e=="string"?Dn(e):e}token(e,i){let s=e.pos,r=0;for(;;){let n=e.next<0,a=e.resolveOffset(1,1);if(Ey(this.data,e,i,0,this.data,this.precTable),e.token.value>-1)break;if(this.elseToken==null)return;if(n||r++,a==null)break;e.reset(a,e.token)}r&&(e.reset(s,e.token),e.acceptToken(this.elseToken,r))}}Fh.prototype.contextual=zr.prototype.fallback=zr.prototype.extend=!1;class as{constructor(e,i={}){this.token=e,this.contextual=!!i.contextual,this.fallback=!!i.fallback,this.extend=!!i.extend}}function Ey(t,e,i,s,r,n){let a=0,o=1<<s,{dialect:l}=i.p.parser;e:for(;o&t[a];){let c=t[a+1];for(let p=a+3;p<c;p+=2)if((t[p+1]&o)>0){let f=t[p];if(l.allows(f)&&(e.token.value==-1||e.token.value==f||NP(f,e.token.value,r,n))){e.acceptToken(f);break}}let h=e.next,d=0,u=t[a+2];if(e.next<0&&u>d&&t[c+u*3-3]==65535){a=t[c+u*3-1];continue e}for(;d<u;){let p=d+u>>1,f=c+p+(p<<1),g=t[f],m=t[f+1]||65536;if(h<g)u=p;else if(h>=m)d=p+1;else{a=t[f+2],e.advance();continue e}}break}}function Rf(t,e,i){for(let s=e,r;(r=t[s])!=65535;s++)if(r==i)return s-e;return-1}function NP(t,e,i,s){let r=Rf(i,s,e);return r<0||Rf(i,s,t)<r}const Bt=typeof process<"u"&&Pf&&/\bparse\b/.test(Pf.LOG);let Pc=null;function $f(t,e,i){let s=t.cursor(je.IncludeAnonymous);for(s.moveTo(e);;)if(!(i<0?s.childBefore(e):s.childAfter(e)))for(;;){if((i<0?s.to<e:s.from>e)&&!s.type.isError)return i<0?Math.max(0,Math.min(s.to-1,e-25)):Math.min(t.length,Math.max(s.from+1,e+25));if(i<0?s.prevSibling():s.nextSibling())break;if(!s.parent())return i<0?0:t.length}}class MP{constructor(e,i){this.fragments=e,this.nodeSet=i,this.i=0,this.fragment=null,this.safeFrom=-1,this.safeTo=-1,this.trees=[],this.start=[],this.index=[],this.nextFragment()}nextFragment(){let e=this.fragment=this.i==this.fragments.length?null:this.fragments[this.i++];if(e){for(this.safeFrom=e.openStart?$f(e.tree,e.from+e.offset,1)-e.offset:e.from,this.safeTo=e.openEnd?$f(e.tree,e.to+e.offset,-1)-e.offset:e.to;this.trees.length;)this.trees.pop(),this.start.pop(),this.index.pop();this.trees.push(e.tree),this.start.push(-e.offset),this.index.push(0),this.nextStart=this.safeFrom}else this.nextStart=1e9}nodeAt(e){if(e<this.nextStart)return null;for(;this.fragment&&this.safeTo<=e;)this.nextFragment();if(!this.fragment)return null;for(;;){let i=this.trees.length-1;if(i<0)return this.nextFragment(),null;let s=this.trees[i],r=this.index[i];if(r==s.children.length){this.trees.pop(),this.start.pop(),this.index.pop();continue}let n=s.children[r],a=this.start[i]+s.positions[r];if(a>e)return this.nextStart=a,null;if(n instanceof Ye){if(a==e){if(a<this.safeFrom)return null;let o=a+n.length;if(o<=this.safeTo){let l=n.prop(ve.lookAhead);if(!l||o+l<this.fragment.to)return n}}this.index[i]++,a+n.length>=Math.max(this.safeFrom,e)&&(this.trees.push(n),this.start.push(a),this.index.push(0))}else this.index[i]++,this.nextStart=a+n.length}}}class qP{constructor(e,i){this.stream=i,this.tokens=[],this.mainToken=null,this.actions=[],this.tokens=e.tokenizers.map(s=>new Eo)}getActions(e){let i=0,s=null,{parser:r}=e.p,{tokenizers:n}=r,a=r.stateSlot(e.state,3),o=e.curContext?e.curContext.hash:0,l=0;for(let c=0;c<n.length;c++){if(!(1<<c&a))continue;let h=n[c],d=this.tokens[c];if(!(s&&!h.fallback)&&((h.contextual||d.start!=e.pos||d.mask!=a||d.context!=o)&&(this.updateCachedToken(d,h,e),d.mask=a,d.context=o),d.lookAhead>d.end+25&&(l=Math.max(d.lookAhead,l)),d.value!=0)){let u=i;if(d.extended>-1&&(i=this.addActions(e,d.extended,d.end,i)),i=this.addActions(e,d.value,d.end,i),!h.extend&&(s=d,i>u))break}}for(;this.actions.length>i;)this.actions.pop();return l&&e.setLookAhead(l),!s&&e.pos==this.stream.end&&(s=new Eo,s.value=e.p.parser.eofTerm,s.start=s.end=e.pos,i=this.addActions(e,s.value,s.end,i)),this.mainToken=s,this.actions}getMainToken(e){if(this.mainToken)return this.mainToken;let i=new Eo,{pos:s,p:r}=e;return i.start=s,i.end=Math.min(s+1,r.stream.end),i.value=s==r.stream.end?r.parser.eofTerm:0,i}updateCachedToken(e,i,s){let r=this.stream.clipPos(s.pos);if(i.token(this.stream.reset(r,e),s),e.value>-1){let{parser:n}=s.p;for(let a=0;a<n.specialized.length;a++)if(n.specialized[a]==e.value){let o=n.specializers[a](this.stream.read(e.start,e.end),s);if(o>=0&&s.p.parser.dialect.allows(o>>1)){o&1?e.extended=o>>1:e.value=o>>1;break}}}else e.value=0,e.end=this.stream.clipPos(r+1)}putAction(e,i,s,r){for(let n=0;n<r;n+=3)if(this.actions[n]==e)return r;return this.actions[r++]=e,this.actions[r++]=i,this.actions[r++]=s,r}addActions(e,i,s,r){let{state:n}=e,{parser:a}=e.p,{data:o}=a;for(let l=0;l<2;l++)for(let c=a.stateSlot(n,l?2:1);;c+=3){if(o[c]==65535)if(o[c+1]==1)c=Yi(o,c+2);else{r==0&&o[c+1]==2&&(r=this.putAction(Yi(o,c+2),i,s,r));break}o[c]==i&&(r=this.putAction(Yi(o,c+1),i,s,r))}return r}}class DP{constructor(e,i,s,r){this.parser=e,this.input=i,this.ranges=r,this.recovering=0,this.nextStackID=9812,this.minStackPos=0,this.reused=[],this.stoppedAt=null,this.lastBigReductionStart=-1,this.lastBigReductionSize=0,this.bigReductionCount=0,this.stream=new LP(i,r),this.tokens=new qP(e,this.stream),this.topTerm=e.top[1];let{from:n}=r[0];this.stacks=[Zo.start(this,e.top[0],n)],this.fragments=s.length&&this.stream.end-n>e.bufferLength*4?new MP(s,e.nodeSet):null}get parsedPos(){return this.minStackPos}advance(){let e=this.stacks,i=this.minStackPos,s=this.stacks=[],r,n;if(this.bigReductionCount>300&&e.length==1){let[a]=e;for(;a.forceReduce()&&a.stack.length&&a.stack[a.stack.length-2]>=this.lastBigReductionStart;);this.bigReductionCount=this.lastBigReductionSize=0}for(let a=0;a<e.length;a++){let o=e[a];for(;;){if(this.tokens.mainToken=null,o.pos>i)s.push(o);else{if(this.advanceStack(o,s,e))continue;{r||(r=[],n=[]),r.push(o);let l=this.tokens.getMainToken(o);n.push(l.value,l.end)}}break}}if(!s.length){let a=r&&jP(r);if(a)return Bt&&console.log("Finish with "+this.stackID(a)),this.stackToTree(a);if(this.parser.strict)throw Bt&&r&&console.log("Stuck with token "+(this.tokens.mainToken?this.parser.getName(this.tokens.mainToken.value):"none")),new SyntaxError("No parse at "+i);this.recovering||(this.recovering=5)}if(this.recovering&&r){let a=this.stoppedAt!=null&&r[0].pos>this.stoppedAt?r[0]:this.runRecovery(r,n,s);if(a)return Bt&&console.log("Force-finish "+this.stackID(a)),this.stackToTree(a.forceAll())}if(this.recovering){let a=this.recovering==1?1:this.recovering*3;if(s.length>a)for(s.sort((o,l)=>l.score-o.score);s.length>a;)s.pop();s.some(o=>o.reducePos>i)&&this.recovering--}else if(s.length>1){e:for(let a=0;a<s.length-1;a++){let o=s[a];for(let l=a+1;l<s.length;l++){let c=s[l];if(o.sameState(c)||o.buffer.length>500&&c.buffer.length>500)if((o.score-c.score||o.buffer.length-c.buffer.length)>0)s.splice(l--,1);else{s.splice(a--,1);continue e}}}s.length>12&&(s.sort((a,o)=>o.score-a.score),s.splice(12,s.length-12))}this.minStackPos=s[0].pos;for(let a=1;a<s.length;a++)s[a].pos<this.minStackPos&&(this.minStackPos=s[a].pos);return null}stopAt(e){if(this.stoppedAt!=null&&this.stoppedAt<e)throw new RangeError("Can't move stoppedAt forward");this.stoppedAt=e}advanceStack(e,i,s){let r=e.pos,{parser:n}=this,a=Bt?this.stackID(e)+" -> ":"";if(this.stoppedAt!=null&&r>this.stoppedAt)return e.forceReduce()?e:null;if(this.fragments){let c=e.curContext&&e.curContext.tracker.strict,h=c?e.curContext.hash:0;for(let d=this.fragments.nodeAt(r);d;){let u=this.parser.nodeSet.types[d.type.id]==d.type?n.getGoto(e.state,d.type.id):-1;if(u>-1&&d.length&&(!c||(d.prop(ve.contextHash)||0)==h))return e.useNode(d,u),Bt&&console.log(a+this.stackID(e)+` (via reuse of ${n.getName(d.type.id)})`),!0;if(!(d instanceof Ye)||d.children.length==0||d.positions[0]>0)break;let p=d.children[0];if(p instanceof Ye&&d.positions[0]==0)d=p;else break}}let o=n.stateSlot(e.state,4);if(o>0)return e.reduce(o),Bt&&console.log(a+this.stackID(e)+` (via always-reduce ${n.getName(o&65535)})`),!0;if(e.stack.length>=8400)for(;e.stack.length>6e3&&e.forceReduce(););let l=this.tokens.getActions(e);for(let c=0;c<l.length;){let h=l[c++],d=l[c++],u=l[c++],p=c==l.length||!s,f=p?e:e.split(),g=this.tokens.mainToken;if(f.apply(h,d,g?g.start:f.pos,u),Bt&&console.log(a+this.stackID(f)+` (via ${h&65536?`reduce of ${n.getName(h&65535)}`:"shift"} for ${n.getName(d)} @ ${r}${f==e?"":", split"})`),p)return!0;f.pos>r?i.push(f):s.push(f)}return!1}advanceFully(e,i){let s=e.pos;for(;;){if(!this.advanceStack(e,null,null))return!1;if(e.pos>s)return If(e,i),!0}}runRecovery(e,i,s){let r=null,n=!1;for(let a=0;a<e.length;a++){let o=e[a],l=i[a<<1],c=i[(a<<1)+1],h=Bt?this.stackID(o)+" -> ":"";if(o.deadEnd&&(n||(n=!0,o.restart(),Bt&&console.log(h+this.stackID(o)+" (restarted)"),this.advanceFully(o,s))))continue;let d=o.split(),u=h;for(let p=0;p<10&&d.forceReduce()&&(Bt&&console.log(u+this.stackID(d)+" (via force-reduce)"),!this.advanceFully(d,s));p++)Bt&&(u=this.stackID(d)+" -> ");for(let p of o.recoverByInsert(l))Bt&&console.log(h+this.stackID(p)+" (via recover-insert)"),this.advanceFully(p,s);this.stream.end>o.pos?(c==o.pos&&(c++,l=0),o.recoverByDelete(l,c),Bt&&console.log(h+this.stackID(o)+` (via recover-delete ${this.parser.getName(l)})`),If(o,s)):(!r||r.score<d.score)&&(r=d)}return r}stackToTree(e){return e.close(),Ye.build({buffer:Ho.create(e),nodeSet:this.parser.nodeSet,topID:this.topTerm,maxBufferLength:this.parser.bufferLength,reused:this.reused,start:this.ranges[0].from,length:e.pos-this.ranges[0].from,minRepeatType:this.parser.minRepeatTerm})}stackID(e){let i=(Pc||(Pc=new WeakMap)).get(e);return i||Pc.set(e,i=String.fromCodePoint(this.nextStackID++)),i+e}}function If(t,e){for(let i=0;i<e.length;i++){let s=e[i];if(s.pos==t.pos&&s.sameState(t)){e[i].score<t.score&&(e[i]=t);return}}e.push(t)}class BP{constructor(e,i,s){this.source=e,this.flags=i,this.disabled=s}allows(e){return!this.disabled||this.disabled[e]==0}}const Cc=t=>t;class Py{constructor(e){this.start=e.start,this.shift=e.shift||Cc,this.reduce=e.reduce||Cc,this.reuse=e.reuse||Cc,this.hash=e.hash||(()=>0),this.strict=e.strict!==!1}}class tn extends _O{constructor(e){if(super(),this.wrappers=[],e.version!=14)throw new RangeError(`Parser version (${e.version}) doesn't match runtime version (14)`);let i=e.nodeNames.split(" ");this.minRepeatTerm=i.length;for(let o=0;o<e.repeatNodeCount;o++)i.push("");let s=Object.keys(e.topRules).map(o=>e.topRules[o][1]),r=[];for(let o=0;o<i.length;o++)r.push([]);function n(o,l,c){r[o].push([l,l.deserialize(String(c))])}if(e.nodeProps)for(let o of e.nodeProps){let l=o[0];typeof l=="string"&&(l=ve[l]);for(let c=1;c<o.length;){let h=o[c++];if(h>=0)n(h,l,o[c++]);else{let d=o[c+-h];for(let u=-h;u>0;u--)n(o[c++],l,d);c++}}}this.nodeSet=new _d(i.map((o,l)=>si.define({name:l>=this.minRepeatTerm?void 0:o,id:l,props:r[l],top:s.indexOf(l)>-1,error:l==0,skipped:e.skippedNodes&&e.skippedNodes.indexOf(l)>-1}))),e.propSources&&(this.nodeSet=this.nodeSet.extend(...e.propSources)),this.strict=!1,this.bufferLength=xO;let a=Dn(e.tokenData);this.context=e.context,this.specializerSpecs=e.specialized||[],this.specialized=new Uint16Array(this.specializerSpecs.length);for(let o=0;o<this.specializerSpecs.length;o++)this.specialized[o]=this.specializerSpecs[o].term;this.specializers=this.specializerSpecs.map(Qf),this.states=Dn(e.states,Uint32Array),this.data=Dn(e.stateData),this.goto=Dn(e.goto),this.maxTerm=e.maxTerm,this.tokenizers=e.tokenizers.map(o=>typeof o=="number"?new zr(a,o):o),this.topRules=e.topRules,this.dialects=e.dialects||{},this.dynamicPrecedences=e.dynamicPrecedences||null,this.tokenPrecTable=e.tokenPrec,this.termNames=e.termNames||null,this.maxNode=this.nodeSet.types.length-1,this.dialect=this.parseDialect(),this.top=this.topRules[Object.keys(this.topRules)[0]]}createParse(e,i,s){let r=new DP(this,e,i,s);for(let n of this.wrappers)r=n(r,e,i,s);return r}getGoto(e,i,s=!1){let r=this.goto;if(i>=r[0])return-1;for(let n=r[i+1];;){let a=r[n++],o=a&1,l=r[n++];if(o&&s)return l;for(let c=n+(a>>1);n<c;n++)if(r[n]==e)return l;if(o)return-1}}hasAction(e,i){let s=this.data;for(let r=0;r<2;r++)for(let n=this.stateSlot(e,r?2:1),a;;n+=3){if((a=s[n])==65535)if(s[n+1]==1)a=s[n=Yi(s,n+2)];else{if(s[n+1]==2)return Yi(s,n+2);break}if(a==i||a==0)return Yi(s,n+1)}return 0}stateSlot(e,i){return this.states[e*6+i]}stateFlag(e,i){return(this.stateSlot(e,0)&i)>0}validAction(e,i){return!!this.allActions(e,s=>s==i?!0:null)}allActions(e,i){let s=this.stateSlot(e,4),r=s?i(s):void 0;for(let n=this.stateSlot(e,1);r==null;n+=3){if(this.data[n]==65535)if(this.data[n+1]==1)n=Yi(this.data,n+2);else break;r=i(Yi(this.data,n+1))}return r}nextStates(e){let i=[];for(let s=this.stateSlot(e,1);;s+=3){if(this.data[s]==65535)if(this.data[s+1]==1)s=Yi(this.data,s+2);else break;if(!(this.data[s+2]&1)){let r=this.data[s+1];i.some((n,a)=>a&1&&n==r)||i.push(this.data[s],r)}}return i}configure(e){let i=Object.assign(Object.create(tn.prototype),this);if(e.props&&(i.nodeSet=this.nodeSet.extend(...e.props)),e.top){let s=this.topRules[e.top];if(!s)throw new RangeError(`Invalid top rule name ${e.top}`);i.top=s}return e.tokenizers&&(i.tokenizers=this.tokenizers.map(s=>{let r=e.tokenizers.find(n=>n.from==s);return r?r.to:s})),e.specializers&&(i.specializers=this.specializers.slice(),i.specializerSpecs=this.specializerSpecs.map((s,r)=>{let n=e.specializers.find(o=>o.from==s.external);if(!n)return s;let a=Object.assign(Object.assign({},s),{external:n.to});return i.specializers[r]=Qf(a),a})),e.contextTracker&&(i.context=e.contextTracker),e.dialect&&(i.dialect=this.parseDialect(e.dialect)),e.strict!=null&&(i.strict=e.strict),e.wrap&&(i.wrappers=i.wrappers.concat(e.wrap)),e.bufferLength!=null&&(i.bufferLength=e.bufferLength),i}hasWrappers(){return this.wrappers.length>0}getName(e){return this.termNames?this.termNames[e]:String(e<=this.maxNode&&this.nodeSet.types[e].name||e)}get eofTerm(){return this.maxNode+1}get topNode(){return this.nodeSet.types[this.top[1]]}dynamicPrecedence(e){let i=this.dynamicPrecedences;return i==null?0:i[e]||0}parseDialect(e){let i=Object.keys(this.dialects),s=i.map(()=>!1);if(e)for(let n of e.split(" ")){let a=i.indexOf(n);a>=0&&(s[a]=!0)}let r=null;for(let n=0;n<i.length;n++)if(!s[n])for(let a=this.dialects[i[n]],o;(o=this.data[a++])!=65535;)(r||(r=new Uint8Array(this.maxTerm+1)))[o]=1;return new BP(e,s,r)}static deserialize(e){return new tn(e)}}function Yi(t,e){return t[e]|t[e+1]<<16}function jP(t){let e=null;for(let i of t){let s=i.p.stoppedAt;(i.pos==i.p.stream.end||s!=null&&i.pos>s)&&i.p.parser.stateFlag(i.state,2)&&(!e||e.score<i.score)&&(e=i)}return e}function Qf(t){if(t.external){let e=t.extend?1:0;return(i,s)=>t.external(i,s)<<1|e}return t.get}const WP=316,FP=317,Af=1,UP=2,VP=3,zP=4,XP=318,GP=320,YP=321,ZP=5,HP=6,KP=0,Uh=[9,10,11,12,13,32,133,160,5760,8192,8193,8194,8195,8196,8197,8198,8199,8200,8201,8202,8232,8233,8239,8287,12288],Cy=125,JP=59,Vh=47,eC=42,tC=43,iC=45,sC=60,rC=44,nC=63,aC=46,oC=91,lC=new Py({start:!1,shift(t,e){return e==ZP||e==HP||e==GP?t:e==YP},strict:!1}),cC=new as((t,e)=>{let{next:i}=t;(i==Cy||i==-1||e.context)&&t.acceptToken(XP)},{contextual:!0,fallback:!0}),hC=new as((t,e)=>{let{next:i}=t,s;Uh.indexOf(i)>-1||i==Vh&&((s=t.peek(1))==Vh||s==eC)||i!=Cy&&i!=JP&&i!=-1&&!e.context&&t.acceptToken(WP)},{contextual:!0}),dC=new as((t,e)=>{t.next==oC&&!e.context&&t.acceptToken(FP)},{contextual:!0}),uC=new as((t,e)=>{let{next:i}=t;if(i==tC||i==iC){if(t.advance(),i==t.next){t.advance();let s=!e.context&&e.canShift(Af);t.acceptToken(s?Af:UP)}}else i==nC&&t.peek(1)==aC&&(t.advance(),t.advance(),(t.next<48||t.next>57)&&t.acceptToken(VP))},{contextual:!0});function _c(t,e){return t>=65&&t<=90||t>=97&&t<=122||t==95||t>=192||!e&&t>=48&&t<=57}const pC=new as((t,e)=>{if(t.next!=sC||!e.dialectEnabled(KP)||(t.advance(),t.next==Vh))return;let i=0;for(;Uh.indexOf(t.next)>-1;)t.advance(),i++;if(_c(t.next,!0)){for(t.advance(),i++;_c(t.next,!1);)t.advance(),i++;for(;Uh.indexOf(t.next)>-1;)t.advance(),i++;if(t.next==rC)return;for(let s=0;;s++){if(s==7){if(!_c(t.next,!0))return;break}if(t.next!="extends".charCodeAt(s))break;t.advance(),i++}}t.acceptToken(zP,-i)}),fC=Ol({"get set async static":$.modifier,"for while do if else switch try catch finally return throw break continue default case defer":$.controlKeyword,"in of await yield void typeof delete instanceof as satisfies":$.operatorKeyword,"let var const using function class extends":$.definitionKeyword,"import export from":$.moduleKeyword,"with debugger new":$.keyword,TemplateString:$.special($.string),super:$.atom,BooleanLiteral:$.bool,this:$.self,null:$.null,Star:$.modifier,VariableName:$.variableName,"CallExpression/VariableName TaggedTemplateExpression/VariableName":$.function($.variableName),VariableDefinition:$.definition($.variableName),Label:$.labelName,PropertyName:$.propertyName,PrivatePropertyName:$.special($.propertyName),"CallExpression/MemberExpression/PropertyName":$.function($.propertyName),"FunctionDeclaration/VariableDefinition":$.function($.definition($.variableName)),"ClassDeclaration/VariableDefinition":$.definition($.className),"NewExpression/VariableName":$.className,PropertyDefinition:$.definition($.propertyName),PrivatePropertyDefinition:$.definition($.special($.propertyName)),UpdateOp:$.updateOperator,"LineComment Hashbang":$.lineComment,BlockComment:$.blockComment,Number:$.number,String:$.string,Escape:$.escape,ArithOp:$.arithmeticOperator,LogicOp:$.logicOperator,BitOp:$.bitwiseOperator,CompareOp:$.compareOperator,RegExp:$.regexp,Equals:$.definitionOperator,Arrow:$.function($.punctuation),": Spread":$.punctuation,"( )":$.paren,"[ ]":$.squareBracket,"{ }":$.brace,"InterpolationStart InterpolationEnd":$.special($.brace),".":$.derefOperator,", ;":$.separator,"@":$.meta,TypeName:$.typeName,TypeDefinition:$.definition($.typeName),"type enum interface implements namespace module declare":$.definitionKeyword,"abstract global Privacy readonly override":$.modifier,"is keyof unique infer asserts":$.operatorKeyword,JSXAttributeValue:$.attributeValue,JSXText:$.content,"JSXStartTag JSXStartCloseTag JSXSelfCloseEndTag JSXEndTag":$.angleBracket,"JSXIdentifier JSXNameSpacedName":$.tagName,"JSXAttribute/JSXIdentifier JSXAttribute/JSXNameSpacedName":$.attributeName,"JSXBuiltin/JSXIdentifier":$.standard($.tagName)}),gC={__proto__:null,export:20,as:25,from:33,default:36,async:41,function:42,in:52,out:55,const:56,extends:60,this:64,true:72,false:72,null:84,void:88,typeof:92,super:108,new:142,delete:154,yield:163,await:167,class:172,public:235,private:235,protected:235,readonly:237,instanceof:256,satisfies:259,import:292,keyof:349,unique:353,infer:359,asserts:395,is:397,abstract:417,implements:419,type:421,let:424,var:426,using:429,interface:435,enum:439,namespace:445,module:447,declare:451,global:455,defer:471,for:476,of:485,while:488,with:492,do:496,if:500,else:502,switch:506,case:512,try:518,catch:522,finally:526,return:530,throw:534,break:538,continue:542,debugger:546},mC={__proto__:null,async:129,get:131,set:133,declare:195,public:197,private:197,protected:197,static:199,abstract:201,override:203,readonly:209,accessor:211,new:401},OC={__proto__:null,"<":193},yC=tn.deserialize({version:14,states:"$F|Q%TQlOOO%[QlOOO'_QpOOP(lO`OOO*zQ!0MxO'#CiO+RO#tO'#CjO+aO&jO'#CjO+oO#@ItO'#DaO.QQlO'#DgO.bQlO'#DrO%[QlO'#DzO0fQlO'#ESOOQ!0Lf'#E['#E[O1PQ`O'#EXOOQO'#Ep'#EpOOQO'#Il'#IlO1XQ`O'#GsO1dQ`O'#EoO1iQ`O'#EoO3hQ!0MxO'#JrO6[Q!0MxO'#JsO6uQ`O'#F]O6zQ,UO'#FtOOQ!0Lf'#Ff'#FfO7VO7dO'#FfO9XQMhO'#F|O9`Q`O'#F{OOQ!0Lf'#Js'#JsOOQ!0Lb'#Jr'#JrO9eQ`O'#GwOOQ['#K_'#K_O9pQ`O'#IYO9uQ!0LrO'#IZOOQ['#J`'#J`OOQ['#I_'#I_Q`QlOOQ`QlOOO9}Q!L^O'#DvO:UQlO'#EOO:]QlO'#EQO9kQ`O'#GsO:dQMhO'#CoO:rQ`O'#EnO:}Q`O'#EyO;hQMhO'#FeO;xQ`O'#GsOOQO'#K`'#K`O;}Q`O'#K`O<]Q`O'#G{O<]Q`O'#G|O<]Q`O'#HOO9kQ`O'#HRO=SQ`O'#HUO>kQ`O'#CeO>{Q`O'#HcO?TQ`O'#HiO?TQ`O'#HkO`QlO'#HmO?TQ`O'#HoO?TQ`O'#HrO?YQ`O'#HxO?_Q!0LsO'#IOO%[QlO'#IQO?jQ!0LsO'#ISO?uQ!0LsO'#IUO9uQ!0LrO'#IWO@QQ!0MxO'#CiOASQpO'#DlQOQ`OOO%[QlO'#EQOAjQ`O'#ETO:dQMhO'#EnOAuQ`O'#EnOBQQ!bO'#FeOOQ['#Cg'#CgOOQ!0Lb'#Dq'#DqOOQ!0Lb'#Jv'#JvO%[QlO'#JvOOQO'#Jy'#JyOOQO'#Ih'#IhOCQQpO'#EgOOQ!0Lb'#Ef'#EfOOQ!0Lb'#J}'#J}OC|Q!0MSO'#EgODWQpO'#EWOOQO'#Jx'#JxODlQpO'#JyOEyQpO'#EWODWQpO'#EgPFWO&2DjO'#CbPOOO)CD})CD}OOOO'#I`'#I`OFcO#tO,59UOOQ!0Lh,59U,59UOOOO'#Ia'#IaOFqO&jO,59UOGPQ!L^O'#DcOOOO'#Ic'#IcOGWO#@ItO,59{OOQ!0Lf,59{,59{OGfQlO'#IdOGyQ`O'#JtOIxQ!fO'#JtO+}QlO'#JtOJPQ`O,5:ROJgQ`O'#EpOJtQ`O'#KTOKPQ`O'#KSOKPQ`O'#KSOKXQ`O,5;^OK^Q`O'#KROOQ!0Ln,5:^,5:^OKeQlO,5:^OMcQ!0MxO,5:fONSQ`O,5:nONmQ!0LrO'#KQONtQ`O'#KPO9eQ`O'#KPO! YQ`O'#KPO! bQ`O,5;]O! gQ`O'#KPO!#lQ!fO'#JsOOQ!0Lh'#Ci'#CiO%[QlO'#ESO!$[Q!fO,5:sOOQS'#Jz'#JzOOQO-E<j-E<jO9kQ`O,5=_O!$rQ`O,5=_O!$wQlO,5;ZO!&zQMhO'#EkO!(eQ`O,5;ZO!(jQlO'#DyO!(tQpO,5;dO!(|QpO,5;dO%[QlO,5;dOOQ['#FT'#FTOOQ['#FV'#FVO%[QlO,5;eO%[QlO,5;eO%[QlO,5;eO%[QlO,5;eO%[QlO,5;eO%[QlO,5;eO%[QlO,5;eO%[QlO,5;eO%[QlO,5;eO%[QlO,5;eOOQ['#FZ'#FZO!)[QlO,5;tOOQ!0Lf,5;y,5;yOOQ!0Lf,5;z,5;zOOQ!0Lf,5;|,5;|O%[QlO'#IpO!+_Q!0LrO,5<iO%[QlO,5;eO!&zQMhO,5;eO!+|QMhO,5;eO!-nQMhO'#E^O%[QlO,5;wOOQ!0Lf,5;{,5;{O!-uQ,UO'#FjO!.rQ,UO'#KXO!.^Q,UO'#KXO!.yQ,UO'#KXOOQO'#KX'#KXO!/_Q,UO,5<SOOOW,5<`,5<`O!/pQlO'#FvOOOW'#Io'#IoO7VO7dO,5<QO!/wQ,UO'#FxOOQ!0Lf,5<Q,5<QO!0hQ$IUO'#CyOOQ!0Lh'#C}'#C}O!0{O#@ItO'#DRO!1iQMjO,5<eO!1pQ`O,5<hO!3YQ(CWO'#GXO!3jQ`O'#GYO!3oQ`O'#GYO!5_Q(CWO'#G^O!6dQpO'#GbOOQO'#Gn'#GnO!,TQMhO'#GmOOQO'#Gp'#GpO!,TQMhO'#GoO!7VQ$IUO'#JlOOQ!0Lh'#Jl'#JlO!7aQ`O'#JkO!7oQ`O'#JjO!7wQ`O'#CuOOQ!0Lh'#C{'#C{O!8YQ`O'#C}OOQ!0Lh'#DV'#DVOOQ!0Lh'#DX'#DXO!8_Q`O,5<eO1SQ`O'#DZO!,TQMhO'#GPO!,TQMhO'#GRO!8gQ`O'#GTO!8lQ`O'#GUO!3oQ`O'#G[O!,TQMhO'#GaO<]Q`O'#JkO!8qQ`O'#EqO!9`Q`O,5<gOOQ!0Lb'#Cr'#CrO!9hQ`O'#ErO!:bQpO'#EsOOQ!0Lb'#KR'#KRO!:iQ!0LrO'#KaO9uQ!0LrO,5=cO`QlO,5>tOOQ['#Jh'#JhOOQ[,5>u,5>uOOQ[-E<]-E<]O!<hQ!0MxO,5:bO!:]QpO,5:`O!?RQ!0MxO,5:jO%[QlO,5:jO!AiQ!0MxO,5:lOOQO,5@z,5@zO!BYQMhO,5=_O!BhQ!0LrO'#JiO9`Q`O'#JiO!ByQ!0LrO,59ZO!CUQpO,59ZO!C^QMhO,59ZO:dQMhO,59ZO!CiQ`O,5;ZO!CqQ`O'#HbO!DVQ`O'#KdO%[QlO,5;}O!:]QpO,5<PO!D_Q`O,5=zO!DdQ`O,5=zO!DiQ`O,5=zO!DwQ`O,5=zO9uQ!0LrO,5=zO<]Q`O,5=jOOQO'#Cy'#CyO!EOQpO,5=gO!EWQMhO,5=hO!EcQ`O,5=jO!EhQ!bO,5=mO!EpQ`O'#K`O?YQ`O'#HWO9kQ`O'#HYO!EuQ`O'#HYO:dQMhO'#H[O!EzQ`O'#H[OOQ[,5=p,5=pO!FPQ`O'#H]O!FbQ`O'#CoO!FgQ`O,59PO!FqQ`O,59PO!HvQlO,59POOQ[,59P,59PO!IWQ!0LrO,59PO%[QlO,59PO!KcQlO'#HeOOQ['#Hf'#HfOOQ['#Hg'#HgO`QlO,5=}O!KyQ`O,5=}O`QlO,5>TO`QlO,5>VO!LOQ`O,5>XO`QlO,5>ZO!LTQ`O,5>^O!LYQlO,5>dOOQ[,5>j,5>jO%[QlO,5>jO9uQ!0LrO,5>lOOQ[,5>n,5>nO#!dQ`O,5>nOOQ[,5>p,5>pO#!dQ`O,5>pOOQ[,5>r,5>rO##QQpO'#D_O%[QlO'#JvO##sQpO'#JvO##}QpO'#DmO#$`QpO'#DmO#&qQlO'#DmO#&xQ`O'#JuO#'QQ`O,5:WO#'VQ`O'#EtO#'eQ`O'#KUO#'mQ`O,5;_O#'rQpO'#DmO#(PQpO'#EVOOQ!0Lf,5:o,5:oO%[QlO,5:oO#(WQ`O,5:oO?YQ`O,5;YO!CUQpO,5;YO!C^QMhO,5;YO:dQMhO,5;YO#(`Q`O,5@bO#(eQ07dO,5:sOOQO-E<f-E<fO#)kQ!0MSO,5;RODWQpO,5:rO#)uQpO,5:rODWQpO,5;RO!ByQ!0LrO,5:rOOQ!0Lb'#Ej'#EjOOQO,5;R,5;RO%[QlO,5;RO#*SQ!0LrO,5;RO#*_Q!0LrO,5;RO!CUQpO,5:rOOQO,5;X,5;XO#*mQ!0LrO,5;RPOOO'#I^'#I^P#+RO&2DjO,58|POOO,58|,58|OOOO-E<^-E<^OOQ!0Lh1G.p1G.pOOOO-E<_-E<_OOOO,59},59}O#+^Q!bO,59}OOOO-E<a-E<aOOQ!0Lf1G/g1G/gO#+cQ!fO,5?OO+}QlO,5?OOOQO,5?U,5?UO#+mQlO'#IdOOQO-E<b-E<bO#+zQ`O,5@`O#,SQ!fO,5@`O#,ZQ`O,5@nOOQ!0Lf1G/m1G/mO%[QlO,5@oO#,cQ`O'#IjOOQO-E<h-E<hO#,ZQ`O,5@nOOQ!0Lb1G0x1G0xOOQ!0Ln1G/x1G/xOOQ!0Ln1G0Y1G0YO%[QlO,5@lO#,wQ!0LrO,5@lO#-YQ!0LrO,5@lO#-aQ`O,5@kO9eQ`O,5@kO#-iQ`O,5@kO#-wQ`O'#ImO#-aQ`O,5@kOOQ!0Lb1G0w1G0wO!(tQpO,5:uO!)PQpO,5:uOOQS,5:w,5:wO#.iQdO,5:wO#.qQMhO1G2yO9kQ`O1G2yOOQ!0Lf1G0u1G0uO#/PQ!0MxO1G0uO#0UQ!0MvO,5;VOOQ!0Lh'#GW'#GWO#0rQ!0MzO'#JlO!$wQlO1G0uO#2}Q!fO'#JwO%[QlO'#JwO#3XQ`O,5:eOOQ!0Lh'#D_'#D_OOQ!0Lf1G1O1G1OO%[QlO1G1OOOQ!0Lf1G1f1G1fO#3^Q`O1G1OO#5rQ!0MxO1G1PO#5yQ!0MxO1G1PO#8aQ!0MxO1G1PO#8hQ!0MxO1G1PO#;OQ!0MxO1G1PO#=fQ!0MxO1G1PO#=mQ!0MxO1G1PO#=tQ!0MxO1G1PO#@[Q!0MxO1G1PO#@cQ!0MxO1G1PO#BpQ?MtO'#CiO#DkQ?MtO1G1`O#DrQ?MtO'#JsO#EVQ!0MxO,5?[OOQ!0Lb-E<n-E<nO#GdQ!0MxO1G1PO#HaQ!0MzO1G1POOQ!0Lf1G1P1G1PO#IdQMjO'#J|O#InQ`O,5:xO#IsQ!0MxO1G1cO#JgQ,UO,5<WO#JoQ,UO,5<XO#JwQ,UO'#FoO#K`Q`O'#FnOOQO'#KY'#KYOOQO'#In'#InO#KeQ,UO1G1nOOQ!0Lf1G1n1G1nOOOW1G1y1G1yO#KvQ?MtO'#JrO#LQQ`O,5<bO!)[QlO,5<bOOOW-E<m-E<mOOQ!0Lf1G1l1G1lO#LVQpO'#KXOOQ!0Lf,5<d,5<dO#L_QpO,5<dO#LdQMhO'#DTOOOO'#Ib'#IbO#LkO#@ItO,59mOOQ!0Lh,59m,59mO%[QlO1G2PO!8lQ`O'#IrO#LvQ`O,5<zOOQ!0Lh,5<w,5<wO!,TQMhO'#IuO#MdQMjO,5=XO!,TQMhO'#IwO#NVQMjO,5=ZO!&zQMhO,5=]OOQO1G2S1G2SO#NaQ!dO'#CrO#NtQ(CWO'#ErO$ |QpO'#GbO$!dQ!dO,5<sO$!kQ`O'#K[O9eQ`O'#K[O$!yQ`O,5<uO$#aQ!dO'#C{O!,TQMhO,5<tO$#kQ`O'#GZO$$PQ`O,5<tO$$UQ!dO'#GWO$$cQ!dO'#K]O$$mQ`O'#K]O!&zQMhO'#K]O$$rQ`O,5<xO$$wQlO'#JvO$%RQpO'#GcO#$`QpO'#GcO$%dQ`O'#GgO!3oQ`O'#GkO$%iQ!0LrO'#ItO$%tQpO,5<|OOQ!0Lp,5<|,5<|O$%{QpO'#GcO$&YQpO'#GdO$&kQpO'#GdO$&pQMjO,5=XO$'QQMjO,5=ZOOQ!0Lh,5=^,5=^O!,TQMhO,5@VO!,TQMhO,5@VO$'bQ`O'#IyO$'vQ`O,5@UO$(OQ`O,59aOOQ!0Lh,59i,59iO$(TQ`O,5@VO$)TQ$IYO,59uOOQ!0Lh'#Jp'#JpO$)vQMjO,5<kO$*iQMjO,5<mO@zQ`O,5<oOOQ!0Lh,5<p,5<pO$*sQ`O,5<vO$*xQMjO,5<{O$+YQ`O'#KPO!$wQlO1G2RO$+_Q`O1G2RO9eQ`O'#KSO9eQ`O'#EtO%[QlO'#EtO9eQ`O'#I{O$+dQ!0LrO,5@{OOQ[1G2}1G2}OOQ[1G4`1G4`OOQ!0Lf1G/|1G/|OOQ!0Lf1G/z1G/zO$-fQ!0MxO1G0UOOQ[1G2y1G2yO!&zQMhO1G2yO%[QlO1G2yO#.tQ`O1G2yO$/jQMhO'#EkOOQ!0Lb,5@T,5@TO$/wQ!0LrO,5@TOOQ[1G.u1G.uO!ByQ!0LrO1G.uO!CUQpO1G.uO!C^QMhO1G.uO$0YQ`O1G0uO$0_Q`O'#CiO$0jQ`O'#KeO$0rQ`O,5=|O$0wQ`O'#KeO$0|Q`O'#KeO$1[Q`O'#JRO$1jQ`O,5AOO$1rQ!fO1G1iOOQ!0Lf1G1k1G1kO9kQ`O1G3fO@zQ`O1G3fO$1yQ`O1G3fO$2OQ`O1G3fO!DiQ`O1G3fO9uQ!0LrO1G3fOOQ[1G3f1G3fO!EcQ`O1G3UO!&zQMhO1G3RO$2TQ`O1G3ROOQ[1G3S1G3SO!&zQMhO1G3SO$2YQ`O1G3SO$2bQpO'#HQOOQ[1G3U1G3UO!6_QpO'#I}O!EhQ!bO1G3XOOQ[1G3X1G3XOOQ[,5=r,5=rO$2jQMhO,5=tO9kQ`O,5=tO$%dQ`O,5=vO9`Q`O,5=vO!CUQpO,5=vO!C^QMhO,5=vO:dQMhO,5=vO$2xQ`O'#KcO$3TQ`O,5=wOOQ[1G.k1G.kO$3YQ!0LrO1G.kO@zQ`O1G.kO$3eQ`O1G.kO9uQ!0LrO1G.kO$5mQ!fO,5AQO$5zQ`O,5AQO9eQ`O,5AQO$6VQlO,5>PO$6^Q`O,5>POOQ[1G3i1G3iO`QlO1G3iOOQ[1G3o1G3oOOQ[1G3q1G3qO?TQ`O1G3sO$6cQlO1G3uO$:gQlO'#HtOOQ[1G3x1G3xO$:tQ`O'#HzO?YQ`O'#H|OOQ[1G4O1G4OO$:|QlO1G4OO9uQ!0LrO1G4UOOQ[1G4W1G4WOOQ!0Lb'#G_'#G_O9uQ!0LrO1G4YO9uQ!0LrO1G4[O$?TQ`O,5@bO!)[QlO,5;`O9eQ`O,5;`O?YQ`O,5:XO!)[QlO,5:XO!CUQpO,5:XO$?YQ?MtO,5:XOOQO,5;`,5;`O$?dQpO'#IeO$?zQ`O,5@aOOQ!0Lf1G/r1G/rO$@SQpO'#IkO$@^Q`O,5@pOOQ!0Lb1G0y1G0yO#$`QpO,5:XOOQO'#Ig'#IgO$@fQpO,5:qOOQ!0Ln,5:q,5:qO#(ZQ`O1G0ZOOQ!0Lf1G0Z1G0ZO%[QlO1G0ZOOQ!0Lf1G0t1G0tO?YQ`O1G0tO!CUQpO1G0tO!C^QMhO1G0tOOQ!0Lb1G5|1G5|O!ByQ!0LrO1G0^OOQO1G0m1G0mO%[QlO1G0mO$@mQ!0LrO1G0mO$@xQ!0LrO1G0mO!CUQpO1G0^ODWQpO1G0^O$AWQ!0LrO1G0mOOQO1G0^1G0^O$AlQ!0MxO1G0mPOOO-E<[-E<[POOO1G.h1G.hOOOO1G/i1G/iO$AvQ!bO,5<iO$BOQ!fO1G4jOOQO1G4p1G4pO%[QlO,5?OO$BYQ`O1G5zO$BbQ`O1G6YO$BjQ!fO1G6ZO9eQ`O,5?UO$BtQ!0MxO1G6WO%[QlO1G6WO$CUQ!0LrO1G6WO$CgQ`O1G6VO$CgQ`O1G6VO9eQ`O1G6VO$CoQ`O,5?XO9eQ`O,5?XOOQO,5?X,5?XO$DTQ`O,5?XO$+YQ`O,5?XOOQO-E<k-E<kOOQS1G0a1G0aOOQS1G0c1G0cO#.lQ`O1G0cOOQ[7+(e7+(eO!&zQMhO7+(eO%[QlO7+(eO$DcQ`O7+(eO$DnQMhO7+(eO$D|Q!0MzO,5=XO$GXQ!0MzO,5=ZO$IdQ!0MzO,5=XO$KuQ!0MzO,5=ZO$NWQ!0MzO,59uO%!]Q!0MzO,5<kO%$hQ!0MzO,5<mO%&sQ!0MzO,5<{OOQ!0Lf7+&a7+&aO%)UQ!0MxO7+&aO%)xQlO'#IfO%*VQ`O,5@cO%*_Q!fO,5@cOOQ!0Lf1G0P1G0PO%*iQ`O7+&jOOQ!0Lf7+&j7+&jO%*nQ?MtO,5:fO%[QlO7+&zO%*xQ?MtO,5:bO%+VQ?MtO,5:jO%+aQ?MtO,5:lO%+kQMhO'#IiO%+uQ`O,5@hOOQ!0Lh1G0d1G0dOOQO1G1r1G1rOOQO1G1s1G1sO%+}Q!jO,5<ZO!)[QlO,5<YOOQO-E<l-E<lOOQ!0Lf7+'Y7+'YOOOW7+'e7+'eOOOW1G1|1G1|O%,YQ`O1G1|OOQ!0Lf1G2O1G2OOOOO,59o,59oO%,_Q!dO,59oOOOO-E<`-E<`OOQ!0Lh1G/X1G/XO%,fQ!0MxO7+'kOOQ!0Lh,5?^,5?^O%-YQMhO1G2fP%-aQ`O'#IrPOQ!0Lh-E<p-E<pO%-}QMjO,5?aOOQ!0Lh-E<s-E<sO%.pQMjO,5?cOOQ!0Lh-E<u-E<uO%.zQ!dO1G2wO%/RQ!dO'#CrO%/iQMhO'#KSO$$wQlO'#JvOOQ!0Lh1G2_1G2_O%/sQ`O'#IqO%0[Q`O,5@vO%0[Q`O,5@vO%0dQ`O,5@vO%0oQ`O,5@vOOQO1G2a1G2aO%0}QMjO1G2`O$+YQ`O'#K[O!,TQMhO1G2`O%1_Q(CWO'#IsO%1lQ`O,5@wO!&zQMhO,5@wO%1tQ!dO,5@wOOQ!0Lh1G2d1G2dO%4UQ!fO'#CiO%4`Q`O,5=POOQ!0Lb,5<},5<}O%4hQpO,5<}OOQ!0Lb,5=O,5=OOCwQ`O,5<}O%4sQpO,5<}OOQ!0Lb,5=R,5=RO$+YQ`O,5=VOOQO,5?`,5?`OOQO-E<r-E<rOOQ!0Lp1G2h1G2hO#$`QpO,5<}O$$wQlO,5=PO%5RQ`O,5=OO%5^QpO,5=OO!,TQMhO'#IuO%6WQMjO1G2sO!,TQMhO'#IwO%6yQMjO1G2uO%7TQMjO1G5qO%7_QMjO1G5qOOQO,5?e,5?eOOQO-E<w-E<wOOQO1G.{1G.{O!,TQMhO1G5qO!,TQMhO1G5qO!:]QpO,59wO%[QlO,59wOOQ!0Lh,5<j,5<jO%7lQ`O1G2ZO!,TQMhO1G2bO%7qQ!0MxO7+'mOOQ!0Lf7+'m7+'mO!$wQlO7+'mO%8eQ`O,5;`OOQ!0Lb,5?g,5?gOOQ!0Lb-E<y-E<yO%8jQ!dO'#K^O#(ZQ`O7+(eO4UQ!fO7+(eO$DfQ`O7+(eO%8tQ!0MvO'#CiO%9XQ!0MvO,5=SO%9lQ`O,5=SO%9tQ`O,5=SOOQ!0Lb1G5o1G5oOOQ[7+$a7+$aO!ByQ!0LrO7+$aO!CUQpO7+$aO!$wQlO7+&aO%9yQ`O'#JQO%:bQ`O,5APOOQO1G3h1G3hO9kQ`O,5APO%:bQ`O,5APO%:jQ`O,5APOOQO,5?m,5?mOOQO-E=P-E=POOQ!0Lf7+'T7+'TO%:oQ`O7+)QO9uQ!0LrO7+)QO9kQ`O7+)QO@zQ`O7+)QO%:tQ`O7+)QOOQ[7+)Q7+)QOOQ[7+(p7+(pO%:yQ!0MvO7+(mO!&zQMhO7+(mO!E^Q`O7+(nOOQ[7+(n7+(nO!&zQMhO7+(nO%;TQ`O'#KbO%;`Q`O,5=lOOQO,5?i,5?iOOQO-E<{-E<{OOQ[7+(s7+(sO%<rQpO'#HZOOQ[1G3`1G3`O!&zQMhO1G3`O%[QlO1G3`O%<yQ`O1G3`O%=UQMhO1G3`O9uQ!0LrO1G3bO$%dQ`O1G3bO9`Q`O1G3bO!CUQpO1G3bO!C^QMhO1G3bO%=dQ`O'#JPO%=xQ`O,5@}O%>QQpO,5@}OOQ!0Lb1G3c1G3cOOQ[7+$V7+$VO@zQ`O7+$VO9uQ!0LrO7+$VO%>]Q`O7+$VO%[QlO1G6lO%[QlO1G6mO%>bQ!0LrO1G6lO%>lQlO1G3kO%>sQ`O1G3kO%>xQlO1G3kOOQ[7+)T7+)TO9uQ!0LrO7+)_O`QlO7+)aOOQ['#Kh'#KhOOQ['#JS'#JSO%?PQlO,5>`OOQ[,5>`,5>`O%[QlO'#HuO%?^Q`O'#HwOOQ[,5>f,5>fO9eQ`O,5>fOOQ[,5>h,5>hOOQ[7+)j7+)jOOQ[7+)p7+)pOOQ[7+)t7+)tOOQ[7+)v7+)vO%?cQpO1G5|O%?}Q?MtO1G0zO%@XQ`O1G0zOOQO1G/s1G/sO%@dQ?MtO1G/sO?YQ`O1G/sO!)[QlO'#DmOOQO,5?P,5?POOQO-E<c-E<cOOQO,5?V,5?VOOQO-E<i-E<iO!CUQpO1G/sOOQO-E<e-E<eOOQ!0Ln1G0]1G0]OOQ!0Lf7+%u7+%uO#(ZQ`O7+%uOOQ!0Lf7+&`7+&`O?YQ`O7+&`O!CUQpO7+&`OOQO7+%x7+%xO$AlQ!0MxO7+&XOOQO7+&X7+&XO%[QlO7+&XO%@nQ!0LrO7+&XO!ByQ!0LrO7+%xO!CUQpO7+%xO%@yQ!0LrO7+&XO%AXQ!0MxO7++rO%[QlO7++rO%AiQ`O7++qO%AiQ`O7++qOOQO1G4s1G4sO9eQ`O1G4sO%AqQ`O1G4sOOQS7+%}7+%}O#(ZQ`O<<LPO4UQ!fO<<LPO%BPQ`O<<LPOOQ[<<LP<<LPO!&zQMhO<<LPO%[QlO<<LPO%BXQ`O<<LPO%BdQ!0MzO,5?aO%DoQ!0MzO,5?cO%FzQ!0MzO1G2`O%I]Q!0MzO1G2sO%KhQ!0MzO1G2uO%MsQ!fO,5?QO%[QlO,5?QOOQO-E<d-E<dO%M}Q`O1G5}OOQ!0Lf<<JU<<JUO%NVQ?MtO1G0uO&!^Q?MtO1G1PO&!eQ?MtO1G1PO&$fQ?MtO1G1PO&$mQ?MtO1G1PO&&nQ?MtO1G1PO&(oQ?MtO1G1PO&(vQ?MtO1G1PO&(}Q?MtO1G1PO&+OQ?MtO1G1PO&+VQ?MtO1G1PO&+^Q!0MxO<<JfO&-UQ?MtO1G1PO&.RQ?MvO1G1PO&/UQ?MvO'#JlO&1[Q?MtO1G1cO&1iQ?MtO1G0UO&1sQMjO,5?TOOQO-E<g-E<gO!)[QlO'#FqOOQO'#KZ'#KZOOQO1G1u1G1uO&1}Q`O1G1tO&2SQ?MtO,5?[OOOW7+'h7+'hOOOO1G/Z1G/ZO&2^Q!dO1G4xOOQ!0Lh7+(Q7+(QP!&zQMhO,5?^O!,TQMhO7+(cO&2eQ`O,5?]O9eQ`O,5?]O$+YQ`O,5?]OOQO-E<o-E<oO&2sQ`O1G6bO&2sQ`O1G6bO&2{Q`O1G6bO&3WQMjO7+'zO&3hQ!dO,5?_O&3rQ`O,5?_O!&zQMhO,5?_OOQO-E<q-E<qO&3wQ!dO1G6cO&4RQ`O1G6cO&4ZQ`O1G2kO!&zQMhO1G2kOOQ!0Lb1G2i1G2iOOQ!0Lb1G2j1G2jO%4hQpO1G2iO!CUQpO1G2iOCwQ`O1G2iOOQ!0Lb1G2q1G2qO&4`QpO1G2iO&4nQ`O1G2kO$+YQ`O1G2jOCwQ`O1G2jO$$wQlO1G2kO&4vQ`O1G2jO&5jQMjO,5?aOOQ!0Lh-E<t-E<tO&6]QMjO,5?cOOQ!0Lh-E<v-E<vO!,TQMhO7++]O&6gQMjO7++]O&6qQMjO7++]OOQ!0Lh1G/c1G/cO&7OQ`O1G/cOOQ!0Lh7+'u7+'uO&7TQMjO7+'|O&7eQ!0MxO<<KXOOQ!0Lf<<KX<<KXO&8XQ`O1G0zO!&zQMhO'#IzO&8^Q`O,5@xO&:`Q!fO<<LPO!&zQMhO1G2nO&:gQ!0LrO1G2nOOQ[<<G{<<G{O!ByQ!0LrO<<G{O&:xQ!0MxO<<I{OOQ!0Lf<<I{<<I{OOQO,5?l,5?lO&;lQ`O,5?lO&;qQ`O,5?lOOQO-E=O-E=OO&<PQ`O1G6kO&<PQ`O1G6kO9kQ`O1G6kO@zQ`O<<LlOOQ[<<Ll<<LlO&<XQ`O<<LlO9uQ!0LrO<<LlO9kQ`O<<LlOOQ[<<LX<<LXO%:yQ!0MvO<<LXOOQ[<<LY<<LYO!E^Q`O<<LYO&<^QpO'#I|O&<iQ`O,5@|O!)[QlO,5@|OOQ[1G3W1G3WOOQO'#JO'#JOO9uQ!0LrO'#JOO&<qQpO,5=uOOQ[,5=u,5=uO&<xQpO'#EgO&=PQpO'#GeO&=UQ`O7+(zO&=ZQ`O7+(zOOQ[7+(z7+(zO!&zQMhO7+(zO%[QlO7+(zO&=cQ`O7+(zOOQ[7+(|7+(|O9uQ!0LrO7+(|O$%dQ`O7+(|O9`Q`O7+(|O!CUQpO7+(|O&=nQ`O,5?kOOQO-E<}-E<}OOQO'#H^'#H^O&=yQ`O1G6iO9uQ!0LrO<<GqOOQ[<<Gq<<GqO@zQ`O<<GqO&>RQ`O7+,WO&>WQ`O7+,XO%[QlO7+,WO%[QlO7+,XOOQ[7+)V7+)VO&>]Q`O7+)VO&>bQlO7+)VO&>iQ`O7+)VOOQ[<<Ly<<LyOOQ[<<L{<<L{OOQ[-E=Q-E=QOOQ[1G3z1G3zO&>nQ`O,5>aOOQ[,5>c,5>cO&>sQ`O1G4QO9eQ`O7+&fO!)[QlO7+&fOOQO7+%_7+%_O&>xQ?MtO1G6ZO?YQ`O7+%_OOQ!0Lf<<Ia<<IaOOQ!0Lf<<Iz<<IzO?YQ`O<<IzOOQO<<Is<<IsO$AlQ!0MxO<<IsO%[QlO<<IsOOQO<<Id<<IdO!ByQ!0LrO<<IdO&?SQ!0LrO<<IsO&?_Q!0MxO<= ^O&?oQ`O<= ]OOQO7+*_7+*_O9eQ`O7+*_OOQ[ANAkANAkO&?wQ!fOANAkO!&zQMhOANAkO#(ZQ`OANAkO4UQ!fOANAkO&@OQ`OANAkO%[QlOANAkO&@WQ!0MzO7+'zO&BiQ!0MzO,5?aO&DtQ!0MzO,5?cO&GPQ!0MzO7+'|O&IbQ!fO1G4lO&IlQ?MtO7+&aO&KpQ?MvO,5=XO&MwQ?MvO,5=ZO&NXQ?MvO,5=XO&NiQ?MvO,5=ZO&NyQ?MvO,59uO'#PQ?MvO,5<kO'%SQ?MvO,5<mO''hQ?MvO,5<{O')^Q?MtO7+'kO')kQ?MtO7+'mO')xQ`O,5<]OOQO7+'`7+'`OOQ!0Lh7+*d7+*dO')}QMjO<<K}OOQO1G4w1G4wO'*UQ`O1G4wO'*aQ`O1G4wO'*oQ`O7++|O'*oQ`O7++|O!&zQMhO1G4yO'*wQ!dO1G4yO'+RQ`O7++}O'+ZQ`O7+(VO'+fQ!dO7+(VOOQ!0Lb7+(T7+(TOOQ!0Lb7+(U7+(UO!CUQpO7+(TOCwQ`O7+(TO'+pQ`O7+(VO!&zQMhO7+(VO$+YQ`O7+(UO'+uQ`O7+(VOCwQ`O7+(UO'+}QMjO<<NwO!,TQMhO<<NwOOQ!0Lh7+$}7+$}O',XQ!dO,5?fOOQO-E<x-E<xO',cQ!0MvO7+(YO!&zQMhO7+(YOOQ[AN=gAN=gO9kQ`O1G5WOOQO1G5W1G5WO',sQ`O1G5WO',xQ`O7+,VO',xQ`O7+,VO9uQ!0LrOANBWO@zQ`OANBWOOQ[ANBWANBWO'-QQ`OANBWOOQ[ANAsANAsOOQ[ANAtANAtO'-VQ`O,5?hOOQO-E<z-E<zO'-bQ?MtO1G6hOOQO,5?j,5?jOOQO-E<|-E<|OOQ[1G3a1G3aO'-lQ`O,5=POOQ[<<Lf<<LfO!&zQMhO<<LfO&=UQ`O<<LfO'-qQ`O<<LfO%[QlO<<LfOOQ[<<Lh<<LhO9uQ!0LrO<<LhO$%dQ`O<<LhO9`Q`O<<LhO'-yQpO1G5VO'.UQ`O7+,TOOQ[AN=]AN=]O9uQ!0LrOAN=]OOQ[<= r<= rOOQ[<= s<= sO'.^Q`O<= rO'.cQ`O<= sOOQ[<<Lq<<LqO'.hQ`O<<LqO'.mQlO<<LqOOQ[1G3{1G3{O?YQ`O7+)lO'.tQ`O<<JQO'/PQ?MtO<<JQOOQO<<Hy<<HyOOQ!0LfAN?fAN?fOOQOAN?_AN?_O$AlQ!0MxOAN?_OOQOAN?OAN?OO%[QlOAN?_OOQO<<My<<MyOOQ[G27VG27VO!&zQMhOG27VO#(ZQ`OG27VO'/ZQ!fOG27VO4UQ!fOG27VO'/bQ`OG27VO'/jQ?MtO<<JfO'/wQ?MvO1G2`O'1mQ?MvO,5?aO'3pQ?MvO,5?cO'5sQ?MvO1G2sO'7vQ?MvO1G2uO'9yQ?MtO<<KXO':WQ?MtO<<I{OOQO1G1w1G1wO!,TQMhOANAiOOQO7+*c7+*cO':eQ`O7+*cO':pQ`O<= hO':xQ!dO7+*eOOQ!0Lb<<Kq<<KqO$+YQ`O<<KqOCwQ`O<<KqO';SQ`O<<KqO!&zQMhO<<KqOOQ!0Lb<<Ko<<KoO!CUQpO<<KoO';_Q!dO<<KqOOQ!0Lb<<Kp<<KpO';iQ`O<<KqO!&zQMhO<<KqO$+YQ`O<<KpO';nQMjOANDcO';xQ!0MvO<<KtOOQO7+*r7+*rO9kQ`O7+*rO'<YQ`O<= qOOQ[G27rG27rO9uQ!0LrOG27rO@zQ`OG27rO!)[QlO1G5SO'<bQ`O7+,SO'<jQ`O1G2kO&=UQ`OANBQOOQ[ANBQANBQO!&zQMhOANBQO'<oQ`OANBQOOQ[ANBSANBSO9uQ!0LrOANBSO$%dQ`OANBSOOQO'#H_'#H_OOQO7+*q7+*qOOQ[G22wG22wOOQ[ANE^ANE^OOQ[ANE_ANE_OOQ[ANB]ANB]O'<wQ`OANB]OOQ[<<MW<<MWO!)[QlOAN?lOOQOG24yG24yO$AlQ!0MxOG24yO#(ZQ`OLD,qOOQ[LD,qLD,qO!&zQMhOLD,qO'<|Q!fOLD,qO'=TQ?MvO7+'zO'>yQ?MvO,5?aO'@|Q?MvO,5?cO'CPQ?MvO7+'|O'DuQMjOG27TOOQO<<M}<<M}OOQ!0LbANA]ANA]O$+YQ`OANA]OCwQ`OANA]O'EVQ!dOANA]OOQ!0LbANAZANAZO'E^Q`OANA]O!&zQMhOANA]O'EiQ!dOANA]OOQ!0LbANA[ANA[OOQO<<N^<<N^OOQ[LD-^LD-^O9uQ!0LrOLD-^O'EsQ?MtO7+*nOOQO'#Gf'#GfOOQ[G27lG27lO&=UQ`OG27lO!&zQMhOG27lOOQ[G27nG27nO9uQ!0LrOG27nOOQ[G27wG27wO'E}Q?MtOG25WOOQOLD*eLD*eOOQ[!$(!]!$(!]O#(ZQ`O!$(!]O!&zQMhO!$(!]O'FXQ!0MzOG27TOOQ!0LbG26wG26wO$+YQ`OG26wO'HjQ`OG26wOCwQ`OG26wO'HuQ!dOG26wO!&zQMhOG26wOOQ[!$(!x!$(!xOOQ[LD-WLD-WO&=UQ`OLD-WOOQ[LD-YLD-YOOQ[!)9Ew!)9EwO#(ZQ`O!)9EwOOQ!0LbLD,cLD,cO$+YQ`OLD,cOCwQ`OLD,cO'H|Q`OLD,cO'IXQ!dOLD,cOOQ[!$(!r!$(!rOOQ[!.K;c!.K;cO'I`Q?MvOG27TOOQ!0Lb!$( }!$( }O$+YQ`O!$( }OCwQ`O!$( }O'KUQ`O!$( }OOQ!0Lb!)9Ei!)9EiO$+YQ`O!)9EiOCwQ`O!)9EiOOQ!0Lb!.K;T!.K;TO$+YQ`O!.K;TOOQ!0Lb!4/0o!4/0oO!)[QlO'#DzO1PQ`O'#EXO'KaQ!fO'#JrO'KhQ!L^O'#DvO'KoQlO'#EOO'KvQ!fO'#CiO'N^Q!fO'#CiO!)[QlO'#EQO'NnQlO,5;ZO!)[QlO,5;eO!)[QlO,5;eO!)[QlO,5;eO!)[QlO,5;eO!)[QlO,5;eO!)[QlO,5;eO!)[QlO,5;eO!)[QlO,5;eO!)[QlO,5;eO!)[QlO,5;eO!)[QlO'#IpO(!qQ`O,5<iO!)[QlO,5;eO(!yQMhO,5;eO($dQMhO,5;eO!)[QlO,5;wO!&zQMhO'#GmO(!yQMhO'#GmO!&zQMhO'#GoO(!yQMhO'#GoO1SQ`O'#DZO1SQ`O'#DZO!&zQMhO'#GPO(!yQMhO'#GPO!&zQMhO'#GRO(!yQMhO'#GRO!&zQMhO'#GaO(!yQMhO'#GaO!)[QlO,5:jO($kQpO'#D_O($uQpO'#JvO!)[QlO,5@oO'NnQlO1G0uO(%PQ?MtO'#CiO!)[QlO1G2PO!&zQMhO'#IuO(!yQMhO'#IuO!&zQMhO'#IwO(!yQMhO'#IwO(%ZQ!dO'#CrO!&zQMhO,5<tO(!yQMhO,5<tO'NnQlO1G2RO!)[QlO7+&zO!&zQMhO1G2`O(!yQMhO1G2`O!&zQMhO'#IuO(!yQMhO'#IuO!&zQMhO'#IwO(!yQMhO'#IwO!&zQMhO1G2bO(!yQMhO1G2bO'NnQlO7+'mO'NnQlO7+&aO!&zQMhOANAiO(!yQMhOANAiO(%nQ`O'#EoO(%sQ`O'#EoO(%{Q`O'#F]O(&QQ`O'#EyO(&VQ`O'#KTO(&bQ`O'#KRO(&mQ`O,5;ZO(&rQMjO,5<eO(&yQ`O'#GYO('OQ`O'#GYO('TQ`O,5<eO(']Q`O,5<gO('eQ`O,5;ZO('mQ?MtO1G1`O('tQ`O,5<tO('yQ`O,5<tO((OQ`O,5<vO((TQ`O,5<vO((YQ`O1G2RO((_Q`O1G0uO((dQMjO<<K}O((kQMjO<<K}O((rQMhO'#F|O9`Q`O'#F{OAuQ`O'#EnO!)[QlO,5;tO!3oQ`O'#GYO!3oQ`O'#GYO!3oQ`O'#G[O!3oQ`O'#G[O!,TQMhO7+(cO!,TQMhO7+(cO%.zQ!dO1G2wO%.zQ!dO1G2wO!&zQMhO,5=]O!&zQMhO,5=]",stateData:"()x~O'|OS'}OSTOS(ORQ~OPYOQYOSfOY!VOaqOdzOeyOl!POpkOrYOskOtkOzkO|YO!OYO!SWO!WkO!XkO!_XO!iuO!lZO!oYO!pYO!qYO!svO!uwO!xxO!|]O$W|O$niO%h}O%j!QO%l!OO%m!OO%n!OO%q!RO%s!SO%v!TO%w!TO%y!UO&W!WO&^!XO&`!YO&b!ZO&d![O&g!]O&m!^O&s!_O&u!`O&w!aO&y!bO&{!cO(TSO(VTO(YUO(aVO(o[O~OWtO~P`OPYOQYOSfOd!jOe!iOpkOrYOskOtkOzkO|YO!OYO!SWO!WkO!XkO!_!eO!iuO!lZO!oYO!pYO!qYO!svO!u!gO!x!hO$W!kO$niO(T!dO(VTO(YUO(aVO(o[O~Oa!wOs!nO!S!oO!b!yO!c!vO!d!vO!|<VO#T!pO#U!pO#V!xO#W!pO#X!pO#[!zO#]!zO(U!lO(VTO(YUO(e!mO(o!sO~O(O!{O~OP]XR]X[]Xa]Xj]Xr]X!Q]X!S]X!]]X!l]X!p]X#R]X#S]X#`]X#kfX#n]X#o]X#p]X#q]X#r]X#s]X#t]X#u]X#v]X#x]X#z]X#{]X$Q]X'z]X(a]X(r]X(y]X(z]X~O!g%RX~P(qO_!}O(V#PO(W!}O(X#PO~O_#QO(X#PO(Y#PO(Z#QO~Ox#SO!U#TO(b#TO(c#VO~OPYOQYOSfOd!jOe!iOpkOrYOskOtkOzkO|YO!OYO!SWO!WkO!XkO!_!eO!iuO!lZO!oYO!pYO!qYO!svO!u!gO!x!hO$W!kO$niO(T<ZO(VTO(YUO(aVO(o[O~O![#ZO!]#WO!Y(hP!Y(vP~P+}O!^#cO~P`OPYOQYOSfOd!jOe!iOrYOskOtkOzkO|YO!OYO!SWO!WkO!XkO!_!eO!iuO!lZO!oYO!pYO!qYO!svO!u!gO!x!hO$W!kO$niO(VTO(YUO(aVO(o[O~Op#mO![#iO!|]O#i#lO#j#iO(T<[O!k(sP~P.iO!l#oO(T#nO~O!x#sO!|]O%h#tO~O#k#uO~O!g#vO#k#uO~OP$[OR#zO[$cOj$ROr$aO!Q#yO!S#{O!]$_O!l#xO!p$[O#R$RO#n$OO#o$PO#p$PO#q$PO#r$QO#s$RO#t$RO#u$bO#v$SO#x$UO#z$WO#{$XO(aVO(r$YO(y#|O(z#}O~Oa(fX'z(fX'w(fX!k(fX!Y(fX!_(fX%i(fX!g(fX~P1qO#S$dO#`$eO$Q$eOP(gXR(gX[(gXj(gXr(gX!Q(gX!S(gX!](gX!l(gX!p(gX#R(gX#n(gX#o(gX#p(gX#q(gX#r(gX#s(gX#t(gX#u(gX#v(gX#x(gX#z(gX#{(gX(a(gX(r(gX(y(gX(z(gX!_(gX%i(gX~Oa(gX'z(gX'w(gX!Y(gX!k(gXv(gX!g(gX~P4UO#`$eO~O$]$hO$_$gO$f$mO~OSfO!_$nO$i$oO$k$qO~Oh%VOj%dOk%dOp%WOr%XOs$tOt$tOz%YO|%ZO!O%]O!S${O!_$|O!i%bO!l$xO#j%cO$W%`O$t%^O$v%_O$y%aO(T$sO(VTO(YUO(a$uO(y$}O(z%POg(^P~Ol%[O~P7eO!l%eO~O!S%hO!_%iO(T%gO~O!g%mO~Oa%nO'z%nO~O!Q%rO~P%[O(U!lO~P%[O%n%vO~P%[Oh%VO!l%eO(T%gO(U!lO~Oe%}O!l%eO(T%gO~Oj$RO~O!_&PO(T%gO(U!lO(VTO(YUO`)WP~O!Q&SO!l&RO%j&VO&T&WO~P;SO!x#sO~O%s&YO!S)SX!_)SX(T)SX~O(T&ZO~Ol!PO!u&`O%j!QO%l!OO%m!OO%n!OO%q!RO%s!SO%v!TO%w!TO~Od&eOe&dO!x&bO%h&cO%{&aO~P<bOd&hOeyOl!PO!_&gO!u&`O!xxO!|]O%h}O%l!OO%m!OO%n!OO%q!RO%s!SO%v!TO%w!TO%y!UO~Ob&kO#`&nO%j&iO(U!lO~P=gO!l&oO!u&sO~O!l#oO~O!_XO~Oa%nO'x&{O'z%nO~Oa%nO'x'OO'z%nO~Oa%nO'x'QO'z%nO~O'w]X!Y]Xv]X!k]X&[]X!_]X%i]X!g]X~P(qO!b'_O!c'WO!d'WO(U!lO(VTO(YUO~Os'UO!S'TO!['XO(e'SO!^(iP!^(xP~P@nOn'bO!_'`O(T%gO~Oe'gO!l%eO(T%gO~O!Q&SO!l&RO~Os!nO!S!oO!|<VO#T!pO#U!pO#W!pO#X!pO(U!lO(VTO(YUO(e!mO(o!sO~O!b'mO!c'lO!d'lO#V!pO#['nO#]'nO~PBYOa%nOh%VO!g#vO!l%eO'z%nO(r'pO~O!p'tO#`'rO~PChOs!nO!S!oO(VTO(YUO(e!mO(o!sO~O!_XOs(mX!S(mX!b(mX!c(mX!d(mX!|(mX#T(mX#U(mX#V(mX#W(mX#X(mX#[(mX#](mX(U(mX(V(mX(Y(mX(e(mX(o(mX~O!c'lO!d'lO(U!lO~PDWO(P'xO(Q'xO(R'zO~O_!}O(V'|O(W!}O(X'|O~O_#QO(X'|O(Y'|O(Z#QO~Ov(OO~P%[Ox#SO!U#TO(b#TO(c(RO~O![(TO!Y'WX!Y'^X!]'WX!]'^X~P+}O!](VO!Y(hX~OP$[OR#zO[$cOj$ROr$aO!Q#yO!S#{O!](VO!l#xO!p$[O#R$RO#n$OO#o$PO#p$PO#q$PO#r$QO#s$RO#t$RO#u$bO#v$SO#x$UO#z$WO#{$XO(aVO(r$YO(y#|O(z#}O~O!Y(hX~PHRO!Y([O~O!Y(uX!](uX!g(uX!k(uX(r(uX~O#`(uX#k#dX!^(uX~PJUO#`(]O!Y(wX!](wX~O!](^O!Y(vX~O!Y(aO~O#`$eO~PJUO!^(bO~P`OR#zO!Q#yO!S#{O!l#xO(aVOP!na[!naj!nar!na!]!na!p!na#R!na#n!na#o!na#p!na#q!na#r!na#s!na#t!na#u!na#v!na#x!na#z!na#{!na(r!na(y!na(z!na~Oa!na'z!na'w!na!Y!na!k!nav!na!_!na%i!na!g!na~PKlO!k(cO~O!g#vO#`(dO(r'pO!](tXa(tX'z(tX~O!k(tX~PNXO!S%hO!_%iO!|]O#i(iO#j(hO(T%gO~O!](jO!k(sX~O!k(lO~O!S%hO!_%iO#j(hO(T%gO~OP(gXR(gX[(gXj(gXr(gX!Q(gX!S(gX!](gX!l(gX!p(gX#R(gX#n(gX#o(gX#p(gX#q(gX#r(gX#s(gX#t(gX#u(gX#v(gX#x(gX#z(gX#{(gX(a(gX(r(gX(y(gX(z(gX~O!g#vO!k(gX~P! uOR(nO!Q(mO!l#xO#S$dO!|!{a!S!{a~O!x!{a%h!{a!_!{a#i!{a#j!{a(T!{a~P!#vO!x(rO~OPYOQYOSfOd!jOe!iOpkOrYOskOtkOzkO|YO!OYO!SWO!WkO!XkO!_XO!iuO!lZO!oYO!pYO!qYO!svO!u!gO!x!hO$W!kO$niO(T!dO(VTO(YUO(aVO(o[O~Oh%VOp%WOr%XOs$tOt$tOz%YO|%ZO!O<sO!S${O!_$|O!i>VO!l$xO#j<yO$W%`O$t<uO$v<wO$y%aO(T(vO(VTO(YUO(a$uO(y$}O(z%PO~O#k(xO~O![(zO!k(kP~P%[O(e(|O(o[O~O!S)OO!l#xO(e(|O(o[O~OP<UOQ<UOSfOd>ROe!iOpkOr<UOskOtkOzkO|<UO!O<UO!SWO!WkO!XkO!_!eO!i<XO!lZO!o<UO!p<UO!q<UO!s<YO!u<]O!x!hO$W!kO$n>PO(T)]O(VTO(YUO(aVO(o[O~O!]$_Oa$qa'z$qa'w$qa!k$qa!Y$qa!_$qa%i$qa!g$qa~Ol)dO~P!&zOh%VOp%WOr%XOs$tOt$tOz%YO|%ZO!O%]O!S${O!_$|O!i%bO!l$xO#j%cO$W%`O$t%^O$v%_O$y%aO(T(vO(VTO(YUO(a$uO(y$}O(z%PO~Og(pP~P!,TO!Q)iO!g)hO!_$^X$Z$^X$]$^X$_$^X$f$^X~O!g)hO!_({X$Z({X$]({X$_({X$f({X~O!Q)iO~P!.^O!Q)iO!_({X$Z({X$]({X$_({X$f({X~O!_)kO$Z)oO$])jO$_)jO$f)pO~O![)sO~P!)[O$]$hO$_$gO$f)wO~On$zX!Q$zX#S$zX'y$zX(y$zX(z$zX~OgmXg$zXnmX!]mX#`mX~P!0SOx)yO(b)zO(c)|O~On*VO!Q*OO'y*PO(y$}O(z%PO~Og)}O~P!1WOg*WO~Oh%VOr%XOs$tOt$tOz%YO|%ZO!O<sO!S*YO!_*ZO!i>VO!l$xO#j<yO$W%`O$t<uO$v<wO$y%aO(VTO(YUO(a$uO(y$}O(z%PO~Op*`O![*^O(T*XO!k)OP~P!1uO#k*aO~O!l*bO~Oh%VOp%WOr%XOs$tOt$tOz%YO|%ZO!O<sO!S${O!_$|O!i>VO!l$xO#j<yO$W%`O$t<uO$v<wO$y%aO(T*dO(VTO(YUO(a$uO(y$}O(z%PO~O![*gO!Y)PP~P!3tOr*sOs!nO!S*iO!b*qO!c*kO!d*kO!l*bO#[*rO%`*mO(U!lO(VTO(YUO(e!mO~O!^*pO~P!5iO#S$dOn(`X!Q(`X'y(`X(y(`X(z(`X!](`X#`(`X~Og(`X$O(`X~P!6kOn*xO#`*wOg(_X!](_X~O!]*yOg(^X~Oj%dOk%dOl%dO(T&ZOg(^P~Os*|O~Og)}O(T&ZO~O!l+SO~O(T(vO~Op+WO!S%hO![#iO!_%iO!|]O#i#lO#j#iO(T%gO!k(sP~O!g#vO#k+XO~O!S%hO![+ZO!](^O!_%iO(T%gO!Y(vP~Os'[O!S+]O![+[O(VTO(YUO(e(|O~O!^(xP~P!9|O!]+^Oa)TX'z)TX~OP$[OR#zO[$cOj$ROr$aO!Q#yO!S#{O!l#xO!p$[O#R$RO#n$OO#o$PO#p$PO#q$PO#r$QO#s$RO#t$RO#u$bO#v$SO#x$UO#z$WO#{$XO(aVO(r$YO(y#|O(z#}O~Oa!ja!]!ja'z!ja'w!ja!Y!ja!k!jav!ja!_!ja%i!ja!g!ja~P!:tOR#zO!Q#yO!S#{O!l#xO(aVOP!ra[!raj!rar!ra!]!ra!p!ra#R!ra#n!ra#o!ra#p!ra#q!ra#r!ra#s!ra#t!ra#u!ra#v!ra#x!ra#z!ra#{!ra(r!ra(y!ra(z!ra~Oa!ra'z!ra'w!ra!Y!ra!k!rav!ra!_!ra%i!ra!g!ra~P!=[OR#zO!Q#yO!S#{O!l#xO(aVOP!ta[!taj!tar!ta!]!ta!p!ta#R!ta#n!ta#o!ta#p!ta#q!ta#r!ta#s!ta#t!ta#u!ta#v!ta#x!ta#z!ta#{!ta(r!ta(y!ta(z!ta~Oa!ta'z!ta'w!ta!Y!ta!k!tav!ta!_!ta%i!ta!g!ta~P!?rOh%VOn+gO!_'`O%i+fO~O!g+iOa(]X!_(]X'z(]X!](]X~Oa%nO!_XO'z%nO~Oh%VO!l%eO~Oh%VO!l%eO(T%gO~O!g#vO#k(xO~Ob+tO%j+uO(T+qO(VTO(YUO!^)XP~O!]+vO`)WX~O[+zO~O`+{O~O!_&PO(T%gO(U!lO`)WP~O%j,OO~P;SOh%VO#`,SO~Oh%VOn,VO!_$|O~O!_,XO~O!Q,ZO!_XO~O%n%vO~O!x,`O~Oe,eO~Ob,fO(T#nO(VTO(YUO!^)VP~Oe%}O~O%j!QO(T&ZO~P=gO[,kO`,jO~OPYOQYOSfOdzOeyOpkOrYOskOtkOzkO|YO!OYO!SWO!WkO!XkO!iuO!lZO!oYO!pYO!qYO!svO!xxO!|]O$niO%h}O(VTO(YUO(aVO(o[O~O!_!eO!u!gO$W!kO(T!dO~P!FyO`,jOa%nO'z%nO~OPYOQYOSfOd!jOe!iOpkOrYOskOtkOzkO|YO!OYO!SWO!WkO!XkO!_!eO!iuO!lZO!oYO!pYO!qYO!svO!x!hO$W!kO$niO(T!dO(VTO(YUO(aVO(o[O~Oa,pOl!OO!uwO%l!OO%m!OO%n!OO~P!IcO!l&oO~O&^,vO~O!_,xO~O&o,zO&q,{OP&laQ&laS&laY&laa&lad&lae&lal&lap&lar&las&lat&laz&la|&la!O&la!S&la!W&la!X&la!_&la!i&la!l&la!o&la!p&la!q&la!s&la!u&la!x&la!|&la$W&la$n&la%h&la%j&la%l&la%m&la%n&la%q&la%s&la%v&la%w&la%y&la&W&la&^&la&`&la&b&la&d&la&g&la&m&la&s&la&u&la&w&la&y&la&{&la'w&la(T&la(V&la(Y&la(a&la(o&la!^&la&e&lab&la&j&la~O(T-QO~Oh!eX!]!RX!^!RX!g!RX!g!eX!l!eX#`!RX~O!]!eX!^!eX~P#!iO!g-VO#`-UOh(jX!]#hX!^#hX!g(jX!l(jX~O!](jX!^(jX~P##[Oh%VO!g-XO!l%eO!]!aX!^!aX~Os!nO!S!oO(VTO(YUO(e!mO~OP<UOQ<UOSfOd>ROe!iOpkOr<UOskOtkOzkO|<UO!O<UO!SWO!WkO!XkO!_!eO!i<XO!lZO!o<UO!p<UO!q<UO!s<YO!u<]O!x!hO$W!kO$n>PO(VTO(YUO(aVO(o[O~O(T=QO~P#$qO!]-]O!^(iX~O!^-_O~O!g-VO#`-UO!]#hX!^#hX~O!]-`O!^(xX~O!^-bO~O!c-cO!d-cO(U!lO~P#$`O!^-fO~P'_On-iO!_'`O~O!Y-nO~Os!{a!b!{a!c!{a!d!{a#T!{a#U!{a#V!{a#W!{a#X!{a#[!{a#]!{a(U!{a(V!{a(Y!{a(e!{a(o!{a~P!#vO!p-sO#`-qO~PChO!c-uO!d-uO(U!lO~PDWOa%nO#`-qO'z%nO~Oa%nO!g#vO#`-qO'z%nO~Oa%nO!g#vO!p-sO#`-qO'z%nO(r'pO~O(P'xO(Q'xO(R-zO~Ov-{O~O!Y'Wa!]'Wa~P!:tO![.PO!Y'WX!]'WX~P%[O!](VO!Y(ha~O!Y(ha~PHRO!](^O!Y(va~O!S%hO![.TO!_%iO(T%gO!Y'^X!]'^X~O#`.VO!](ta!k(taa(ta'z(ta~O!g#vO~P#,wO!](jO!k(sa~O!S%hO!_%iO#j.ZO(T%gO~Op.`O!S%hO![.]O!_%iO!|]O#i._O#j.]O(T%gO!]'aX!k'aX~OR.dO!l#xO~Oh%VOn.gO!_'`O%i.fO~Oa#ci!]#ci'z#ci'w#ci!Y#ci!k#civ#ci!_#ci%i#ci!g#ci~P!:tOn>]O!Q*OO'y*PO(y$}O(z%PO~O#k#_aa#_a#`#_a'z#_a!]#_a!k#_a!_#_a!Y#_a~P#/sO#k(`XP(`XR(`X[(`Xa(`Xj(`Xr(`X!S(`X!l(`X!p(`X#R(`X#n(`X#o(`X#p(`X#q(`X#r(`X#s(`X#t(`X#u(`X#v(`X#x(`X#z(`X#{(`X'z(`X(a(`X(r(`X!k(`X!Y(`X'w(`Xv(`X!_(`X%i(`X!g(`X~P!6kO!].tO!k(kX~P!:tO!k.wO~O!Y.yO~OP$[OR#zO!Q#yO!S#{O!l#xO!p$[O(aVO[#mia#mij#mir#mi!]#mi#R#mi#o#mi#p#mi#q#mi#r#mi#s#mi#t#mi#u#mi#v#mi#x#mi#z#mi#{#mi'z#mi(r#mi(y#mi(z#mi'w#mi!Y#mi!k#miv#mi!_#mi%i#mi!g#mi~O#n#mi~P#3cO#n$OO~P#3cOP$[OR#zOr$aO!Q#yO!S#{O!l#xO!p$[O#n$OO#o$PO#p$PO#q$PO(aVO[#mia#mij#mi!]#mi#R#mi#s#mi#t#mi#u#mi#v#mi#x#mi#z#mi#{#mi'z#mi(r#mi(y#mi(z#mi'w#mi!Y#mi!k#miv#mi!_#mi%i#mi!g#mi~O#r#mi~P#6QO#r$QO~P#6QOP$[OR#zO[$cOj$ROr$aO!Q#yO!S#{O!l#xO!p$[O#R$RO#n$OO#o$PO#p$PO#q$PO#r$QO#s$RO#t$RO#u$bO(aVOa#mi!]#mi#x#mi#z#mi#{#mi'z#mi(r#mi(y#mi(z#mi'w#mi!Y#mi!k#miv#mi!_#mi%i#mi!g#mi~O#v#mi~P#8oOP$[OR#zO[$cOj$ROr$aO!Q#yO!S#{O!l#xO!p$[O#R$RO#n$OO#o$PO#p$PO#q$PO#r$QO#s$RO#t$RO#u$bO#v$SO(aVO(z#}Oa#mi!]#mi#z#mi#{#mi'z#mi(r#mi(y#mi'w#mi!Y#mi!k#miv#mi!_#mi%i#mi!g#mi~O#x$UO~P#;VO#x#mi~P#;VO#v$SO~P#8oOP$[OR#zO[$cOj$ROr$aO!Q#yO!S#{O!l#xO!p$[O#R$RO#n$OO#o$PO#p$PO#q$PO#r$QO#s$RO#t$RO#u$bO#v$SO#x$UO(aVO(y#|O(z#}Oa#mi!]#mi#{#mi'z#mi(r#mi'w#mi!Y#mi!k#miv#mi!_#mi%i#mi!g#mi~O#z#mi~P#={O#z$WO~P#={OP]XR]X[]Xj]Xr]X!Q]X!S]X!l]X!p]X#R]X#S]X#`]X#kfX#n]X#o]X#p]X#q]X#r]X#s]X#t]X#u]X#v]X#x]X#z]X#{]X$Q]X(a]X(r]X(y]X(z]X!]]X!^]X~O$O]X~P#@jOP$[OR#zO[<mOj<bOr<kO!Q#yO!S#{O!l#xO!p$[O#R<bO#n<_O#o<`O#p<`O#q<`O#r<aO#s<bO#t<bO#u<lO#v<cO#x<eO#z<gO#{<hO(aVO(r$YO(y#|O(z#}O~O$O.{O~P#BwO#S$dO#`<nO$Q<nO$O(gX!^(gX~P! uOa'da!]'da'z'da'w'da!k'da!Y'dav'da!_'da%i'da!g'da~P!:tO[#mia#mij#mir#mi!]#mi#R#mi#r#mi#s#mi#t#mi#u#mi#v#mi#x#mi#z#mi#{#mi'z#mi(r#mi'w#mi!Y#mi!k#miv#mi!_#mi%i#mi!g#mi~OP$[OR#zO!Q#yO!S#{O!l#xO!p$[O#n$OO#o$PO#p$PO#q$PO(aVO(y#mi(z#mi~P#EyOn>]O!Q*OO'y*PO(y$}O(z%POP#miR#mi!S#mi!l#mi!p#mi#n#mi#o#mi#p#mi#q#mi(a#mi~P#EyO!]/POg(pX~P!1WOg/RO~Oa$Pi!]$Pi'z$Pi'w$Pi!Y$Pi!k$Piv$Pi!_$Pi%i$Pi!g$Pi~P!:tO$]/SO$_/SO~O$]/TO$_/TO~O!g)hO#`/UO!_$cX$Z$cX$]$cX$_$cX$f$cX~O![/VO~O!_)kO$Z/XO$])jO$_)jO$f/YO~O!]<iO!^(fX~P#BwO!^/ZO~O!g)hO$f({X~O$f/]O~Ov/^O~P!&zOx)yO(b)zO(c/aO~O!S/dO~O(y$}On%aa!Q%aa'y%aa(z%aa!]%aa#`%aa~Og%aa$O%aa~P#L{O(z%POn%ca!Q%ca'y%ca(y%ca!]%ca#`%ca~Og%ca$O%ca~P#MnO!]fX!gfX!kfX!k$zX(rfX~P!0SOp%WO![/mO!](^O(T/lO!Y(vP!Y)PP~P!1uOr*sO!b*qO!c*kO!d*kO!l*bO#[*rO%`*mO(U!lO(VTO(YUO~Os<}O!S/nO![+[O!^*pO(e<|O!^(xP~P$ [O!k/oO~P#/sO!]/pO!g#vO(r'pO!k)OX~O!k/uO~OnoX!QoX'yoX(yoX(zoX~O!g#vO!koX~P$#OOp/wO!S%hO![*^O!_%iO(T%gO!k)OP~O#k/xO~O!Y$zX!]$zX!g%RX~P!0SO!]/yO!Y)PX~P#/sO!g/{O~O!Y/}O~OpkO(T0OO~P.iOh%VOr0TO!g#vO!l%eO(r'pO~O!g+iO~Oa%nO!]0XO'z%nO~O!^0ZO~P!5iO!c0[O!d0[O(U!lO~P#$`Os!nO!S0]O(VTO(YUO(e!mO~O#[0_O~Og%aa!]%aa#`%aa$O%aa~P!1WOg%ca!]%ca#`%ca$O%ca~P!1WOj%dOk%dOl%dO(T&ZOg'mX!]'mX~O!]*yOg(^a~Og0hO~On0jO#`0iOg(_a!](_a~OR0kO!Q0kO!S0lO#S$dOn}a'y}a(y}a(z}a!]}a#`}a~Og}a$O}a~P$(cO!Q*OO'y*POn$sa(y$sa(z$sa!]$sa#`$sa~Og$sa$O$sa~P$)_O!Q*OO'y*POn$ua(y$ua(z$ua!]$ua#`$ua~Og$ua$O$ua~P$*QO#k0oO~Og%Ta!]%Ta#`%Ta$O%Ta~P!1WO!g#vO~O#k0rO~O!]+^Oa)Ta'z)Ta~OR#zO!Q#yO!S#{O!l#xO(aVOP!ri[!rij!rir!ri!]!ri!p!ri#R!ri#n!ri#o!ri#p!ri#q!ri#r!ri#s!ri#t!ri#u!ri#v!ri#x!ri#z!ri#{!ri(r!ri(y!ri(z!ri~Oa!ri'z!ri'w!ri!Y!ri!k!riv!ri!_!ri%i!ri!g!ri~P$+oOh%VOr%XOs$tOt$tOz%YO|%ZO!O<sO!S${O!_$|O!i>VO!l$xO#j<yO$W%`O$t<uO$v<wO$y%aO(VTO(YUO(a$uO(y$}O(z%PO~Op0{O%]0|O(T0zO~P$.VO!g+iOa(]a!_(]a'z(]a!](]a~O#k1SO~O[]X!]fX!^fX~O!]1TO!^)XX~O!^1VO~O[1WO~Ob1YO(T+qO(VTO(YUO~O!_&PO(T%gO`'uX!]'uX~O!]+vO`)Wa~O!k1]O~P!:tO[1`O~O`1aO~O#`1fO~On1iO!_$|O~O(e(|O!^)UP~Oh%VOn1rO!_1oO%i1qO~O[1|O!]1zO!^)VX~O!^1}O~O`2POa%nO'z%nO~O(T#nO(VTO(YUO~O#S$dO#`$eO$Q$eOP(gXR(gX[(gXr(gX!Q(gX!S(gX!](gX!l(gX!p(gX#R(gX#n(gX#o(gX#p(gX#q(gX#r(gX#s(gX#t(gX#u(gX#v(gX#x(gX#z(gX#{(gX(a(gX(r(gX(y(gX(z(gX~Oj2SO&[2TOa(gX~P$3pOj2SO#`$eO&[2TO~Oa2VO~P%[Oa2XO~O&e2[OP&ciQ&ciS&ciY&cia&cid&cie&cil&cip&cir&cis&cit&ciz&ci|&ci!O&ci!S&ci!W&ci!X&ci!_&ci!i&ci!l&ci!o&ci!p&ci!q&ci!s&ci!u&ci!x&ci!|&ci$W&ci$n&ci%h&ci%j&ci%l&ci%m&ci%n&ci%q&ci%s&ci%v&ci%w&ci%y&ci&W&ci&^&ci&`&ci&b&ci&d&ci&g&ci&m&ci&s&ci&u&ci&w&ci&y&ci&{&ci'w&ci(T&ci(V&ci(Y&ci(a&ci(o&ci!^&cib&ci&j&ci~Ob2bO!^2`O&j2aO~P`O!_XO!l2dO~O&q,{OP&liQ&liS&liY&lia&lid&lie&lil&lip&lir&lis&lit&liz&li|&li!O&li!S&li!W&li!X&li!_&li!i&li!l&li!o&li!p&li!q&li!s&li!u&li!x&li!|&li$W&li$n&li%h&li%j&li%l&li%m&li%n&li%q&li%s&li%v&li%w&li%y&li&W&li&^&li&`&li&b&li&d&li&g&li&m&li&s&li&u&li&w&li&y&li&{&li'w&li(T&li(V&li(Y&li(a&li(o&li!^&li&e&lib&li&j&li~O!Y2jO~O!]!aa!^!aa~P#BwOs!nO!S!oO![2pO(e!mO!]'XX!^'XX~P@nO!]-]O!^(ia~O!]'_X!^'_X~P!9|O!]-`O!^(xa~O!^2wO~P'_Oa%nO#`3QO'z%nO~Oa%nO!g#vO#`3QO'z%nO~Oa%nO!g#vO!p3UO#`3QO'z%nO(r'pO~Oa%nO'z%nO~P!:tO!]$_Ov$qa~O!Y'Wi!]'Wi~P!:tO!](VO!Y(hi~O!](^O!Y(vi~O!Y(wi!](wi~P!:tO!](ti!k(tia(ti'z(ti~P!:tO#`3WO!](ti!k(tia(ti'z(ti~O!](jO!k(si~O!S%hO!_%iO!|]O#i3]O#j3[O(T%gO~O!S%hO!_%iO#j3[O(T%gO~On3dO!_'`O%i3cO~Oh%VOn3dO!_'`O%i3cO~O#k%aaP%aaR%aa[%aaa%aaj%aar%aa!S%aa!l%aa!p%aa#R%aa#n%aa#o%aa#p%aa#q%aa#r%aa#s%aa#t%aa#u%aa#v%aa#x%aa#z%aa#{%aa'z%aa(a%aa(r%aa!k%aa!Y%aa'w%aav%aa!_%aa%i%aa!g%aa~P#L{O#k%caP%caR%ca[%caa%caj%car%ca!S%ca!l%ca!p%ca#R%ca#n%ca#o%ca#p%ca#q%ca#r%ca#s%ca#t%ca#u%ca#v%ca#x%ca#z%ca#{%ca'z%ca(a%ca(r%ca!k%ca!Y%ca'w%cav%ca!_%ca%i%ca!g%ca~P#MnO#k%aaP%aaR%aa[%aaa%aaj%aar%aa!S%aa!]%aa!l%aa!p%aa#R%aa#n%aa#o%aa#p%aa#q%aa#r%aa#s%aa#t%aa#u%aa#v%aa#x%aa#z%aa#{%aa'z%aa(a%aa(r%aa!k%aa!Y%aa'w%aa#`%aav%aa!_%aa%i%aa!g%aa~P#/sO#k%caP%caR%ca[%caa%caj%car%ca!S%ca!]%ca!l%ca!p%ca#R%ca#n%ca#o%ca#p%ca#q%ca#r%ca#s%ca#t%ca#u%ca#v%ca#x%ca#z%ca#{%ca'z%ca(a%ca(r%ca!k%ca!Y%ca'w%ca#`%cav%ca!_%ca%i%ca!g%ca~P#/sO#k}aP}a[}aa}aj}ar}a!l}a!p}a#R}a#n}a#o}a#p}a#q}a#r}a#s}a#t}a#u}a#v}a#x}a#z}a#{}a'z}a(a}a(r}a!k}a!Y}a'w}av}a!_}a%i}a!g}a~P$(cO#k$saP$saR$sa[$saa$saj$sar$sa!S$sa!l$sa!p$sa#R$sa#n$sa#o$sa#p$sa#q$sa#r$sa#s$sa#t$sa#u$sa#v$sa#x$sa#z$sa#{$sa'z$sa(a$sa(r$sa!k$sa!Y$sa'w$sav$sa!_$sa%i$sa!g$sa~P$)_O#k$uaP$uaR$ua[$uaa$uaj$uar$ua!S$ua!l$ua!p$ua#R$ua#n$ua#o$ua#p$ua#q$ua#r$ua#s$ua#t$ua#u$ua#v$ua#x$ua#z$ua#{$ua'z$ua(a$ua(r$ua!k$ua!Y$ua'w$uav$ua!_$ua%i$ua!g$ua~P$*QO#k%TaP%TaR%Ta[%Taa%Taj%Tar%Ta!S%Ta!]%Ta!l%Ta!p%Ta#R%Ta#n%Ta#o%Ta#p%Ta#q%Ta#r%Ta#s%Ta#t%Ta#u%Ta#v%Ta#x%Ta#z%Ta#{%Ta'z%Ta(a%Ta(r%Ta!k%Ta!Y%Ta'w%Ta#`%Tav%Ta!_%Ta%i%Ta!g%Ta~P#/sOa#cq!]#cq'z#cq'w#cq!Y#cq!k#cqv#cq!_#cq%i#cq!g#cq~P!:tO![3lO!]'YX!k'YX~P%[O!].tO!k(ka~O!].tO!k(ka~P!:tO!Y3oO~O$O!na!^!na~PKlO$O!ja!]!ja!^!ja~P#BwO$O!ra!^!ra~P!=[O$O!ta!^!ta~P!?rOg']X!]']X~P!,TO!]/POg(pa~OSfO!_4TO$d4UO~O!^4YO~Ov4ZO~P#/sOa$mq!]$mq'z$mq'w$mq!Y$mq!k$mqv$mq!_$mq%i$mq!g$mq~P!:tO!Y4]O~P!&zO!S4^O~O!Q*OO'y*PO(z%POn'ia(y'ia!]'ia#`'ia~Og'ia$O'ia~P%-fO!Q*OO'y*POn'ka(y'ka(z'ka!]'ka#`'ka~Og'ka$O'ka~P%.XO(r$YO~P#/sO!YfX!Y$zX!]fX!]$zX!g%RX#`fX~P!0SOp%WO(T=WO~P!1uOp4bO!S%hO![4aO!_%iO(T%gO!]'eX!k'eX~O!]/pO!k)Oa~O!]/pO!g#vO!k)Oa~O!]/pO!g#vO(r'pO!k)Oa~Og$|i!]$|i#`$|i$O$|i~P!1WO![4jO!Y'gX!]'gX~P!3tO!]/yO!Y)Pa~O!]/yO!Y)Pa~P#/sOP]XR]X[]Xj]Xr]X!Q]X!S]X!Y]X!]]X!l]X!p]X#R]X#S]X#`]X#kfX#n]X#o]X#p]X#q]X#r]X#s]X#t]X#u]X#v]X#x]X#z]X#{]X$Q]X(a]X(r]X(y]X(z]X~Oj%YX!g%YX~P%2OOj4oO!g#vO~Oh%VO!g#vO!l%eO~Oh%VOr4tO!l%eO(r'pO~Or4yO!g#vO(r'pO~Os!nO!S4zO(VTO(YUO(e!mO~O(y$}On%ai!Q%ai'y%ai(z%ai!]%ai#`%ai~Og%ai$O%ai~P%5oO(z%POn%ci!Q%ci'y%ci(y%ci!]%ci#`%ci~Og%ci$O%ci~P%6bOg(_i!](_i~P!1WO#`5QOg(_i!](_i~P!1WO!k5VO~Oa$oq!]$oq'z$oq'w$oq!Y$oq!k$oqv$oq!_$oq%i$oq!g$oq~P!:tO!Y5ZO~O!]5[O!_)QX~P#/sOa$zX!_$zX%^]X'z$zX!]$zX~P!0SO%^5_OaoX!_oX'zoX!]oX~P$#OOp5`O(T#nO~O%^5_O~Ob5fO%j5gO(T+qO(VTO(YUO!]'tX!^'tX~O!]1TO!^)Xa~O[5kO~O`5lO~O[5pO~Oa%nO'z%nO~P#/sO!]5uO#`5wO!^)UX~O!^5xO~Or6OOs!nO!S*iO!b!yO!c!vO!d!vO!|<VO#T!pO#U!pO#V!pO#W!pO#X!pO#[5}O#]!zO(U!lO(VTO(YUO(e!mO(o!sO~O!^5|O~P%;eOn6TO!_1oO%i6SO~Oh%VOn6TO!_1oO%i6SO~Ob6[O(T#nO(VTO(YUO!]'sX!^'sX~O!]1zO!^)Va~O(VTO(YUO(e6^O~O`6bO~Oj6eO&[6fO~PNXO!k6gO~P%[Oa6iO~Oa6iO~P%[Ob2bO!^6nO&j2aO~P`O!g6pO~O!g6rOh(ji!](ji!^(ji!g(ji!l(jir(ji(r(ji~O!]#hi!^#hi~P#BwO#`6sO!]#hi!^#hi~O!]!ai!^!ai~P#BwOa%nO#`6|O'z%nO~Oa%nO!g#vO#`6|O'z%nO~O!](tq!k(tqa(tq'z(tq~P!:tO!](jO!k(sq~O!S%hO!_%iO#j7TO(T%gO~O!_'`O%i7WO~On7[O!_'`O%i7WO~O#k'iaP'iaR'ia['iaa'iaj'iar'ia!S'ia!l'ia!p'ia#R'ia#n'ia#o'ia#p'ia#q'ia#r'ia#s'ia#t'ia#u'ia#v'ia#x'ia#z'ia#{'ia'z'ia(a'ia(r'ia!k'ia!Y'ia'w'iav'ia!_'ia%i'ia!g'ia~P%-fO#k'kaP'kaR'ka['kaa'kaj'kar'ka!S'ka!l'ka!p'ka#R'ka#n'ka#o'ka#p'ka#q'ka#r'ka#s'ka#t'ka#u'ka#v'ka#x'ka#z'ka#{'ka'z'ka(a'ka(r'ka!k'ka!Y'ka'w'kav'ka!_'ka%i'ka!g'ka~P%.XO#k$|iP$|iR$|i[$|ia$|ij$|ir$|i!S$|i!]$|i!l$|i!p$|i#R$|i#n$|i#o$|i#p$|i#q$|i#r$|i#s$|i#t$|i#u$|i#v$|i#x$|i#z$|i#{$|i'z$|i(a$|i(r$|i!k$|i!Y$|i'w$|i#`$|iv$|i!_$|i%i$|i!g$|i~P#/sO#k%aiP%aiR%ai[%aia%aij%air%ai!S%ai!l%ai!p%ai#R%ai#n%ai#o%ai#p%ai#q%ai#r%ai#s%ai#t%ai#u%ai#v%ai#x%ai#z%ai#{%ai'z%ai(a%ai(r%ai!k%ai!Y%ai'w%aiv%ai!_%ai%i%ai!g%ai~P%5oO#k%ciP%ciR%ci[%cia%cij%cir%ci!S%ci!l%ci!p%ci#R%ci#n%ci#o%ci#p%ci#q%ci#r%ci#s%ci#t%ci#u%ci#v%ci#x%ci#z%ci#{%ci'z%ci(a%ci(r%ci!k%ci!Y%ci'w%civ%ci!_%ci%i%ci!g%ci~P%6bO!]'Ya!k'Ya~P!:tO!].tO!k(ki~O$O#ci!]#ci!^#ci~P#BwOP$[OR#zO!Q#yO!S#{O!l#xO!p$[O(aVO[#mij#mir#mi#R#mi#o#mi#p#mi#q#mi#r#mi#s#mi#t#mi#u#mi#v#mi#x#mi#z#mi#{#mi$O#mi(r#mi(y#mi(z#mi!]#mi!^#mi~O#n#mi~P%NdO#n<_O~P%NdOP$[OR#zOr<kO!Q#yO!S#{O!l#xO!p$[O#n<_O#o<`O#p<`O#q<`O(aVO[#mij#mi#R#mi#s#mi#t#mi#u#mi#v#mi#x#mi#z#mi#{#mi$O#mi(r#mi(y#mi(z#mi!]#mi!^#mi~O#r#mi~P&!lO#r<aO~P&!lOP$[OR#zO[<mOj<bOr<kO!Q#yO!S#{O!l#xO!p$[O#R<bO#n<_O#o<`O#p<`O#q<`O#r<aO#s<bO#t<bO#u<lO(aVO#x#mi#z#mi#{#mi$O#mi(r#mi(y#mi(z#mi!]#mi!^#mi~O#v#mi~P&$tOP$[OR#zO[<mOj<bOr<kO!Q#yO!S#{O!l#xO!p$[O#R<bO#n<_O#o<`O#p<`O#q<`O#r<aO#s<bO#t<bO#u<lO#v<cO(aVO(z#}O#z#mi#{#mi$O#mi(r#mi(y#mi!]#mi!^#mi~O#x<eO~P&&uO#x#mi~P&&uO#v<cO~P&$tOP$[OR#zO[<mOj<bOr<kO!Q#yO!S#{O!l#xO!p$[O#R<bO#n<_O#o<`O#p<`O#q<`O#r<aO#s<bO#t<bO#u<lO#v<cO#x<eO(aVO(y#|O(z#}O#{#mi$O#mi(r#mi!]#mi!^#mi~O#z#mi~P&)UO#z<gO~P&)UOa#|y!]#|y'z#|y'w#|y!Y#|y!k#|yv#|y!_#|y%i#|y!g#|y~P!:tO[#mij#mir#mi#R#mi#r#mi#s#mi#t#mi#u#mi#v#mi#x#mi#z#mi#{#mi$O#mi(r#mi!]#mi!^#mi~OP$[OR#zO!Q#yO!S#{O!l#xO!p$[O#n<_O#o<`O#p<`O#q<`O(aVO(y#mi(z#mi~P&,QOn>^O!Q*OO'y*PO(y$}O(z%POP#miR#mi!S#mi!l#mi!p#mi#n#mi#o#mi#p#mi#q#mi(a#mi~P&,QO#S$dOP(`XR(`X[(`Xj(`Xn(`Xr(`X!Q(`X!S(`X!l(`X!p(`X#R(`X#n(`X#o(`X#p(`X#q(`X#r(`X#s(`X#t(`X#u(`X#v(`X#x(`X#z(`X#{(`X$O(`X'y(`X(a(`X(r(`X(y(`X(z(`X!](`X!^(`X~O$O$Pi!]$Pi!^$Pi~P#BwO$O!ri!^!ri~P$+oOg']a!]']a~P!1WO!^7nO~O!]'da!^'da~P#BwO!Y7oO~P#/sO!g#vO(r'pO!]'ea!k'ea~O!]/pO!k)Oi~O!]/pO!g#vO!k)Oi~Og$|q!]$|q#`$|q$O$|q~P!1WO!Y'ga!]'ga~P#/sO!g7vO~O!]/yO!Y)Pi~P#/sO!]/yO!Y)Pi~O!Y7yO~Oh%VOr8OO!l%eO(r'pO~Oj8QO!g#vO~Or8TO!g#vO(r'pO~O!Q*OO'y*PO(z%POn'ja(y'ja!]'ja#`'ja~Og'ja$O'ja~P&5RO!Q*OO'y*POn'la(y'la(z'la!]'la#`'la~Og'la$O'la~P&5tOg(_q!](_q~P!1WO#`8VOg(_q!](_q~P!1WO!Y8WO~Og%Oq!]%Oq#`%Oq$O%Oq~P!1WOa$oy!]$oy'z$oy'w$oy!Y$oy!k$oyv$oy!_$oy%i$oy!g$oy~P!:tO!g6rO~O!]5[O!_)Qa~O!_'`OP$TaR$Ta[$Taj$Tar$Ta!Q$Ta!S$Ta!]$Ta!l$Ta!p$Ta#R$Ta#n$Ta#o$Ta#p$Ta#q$Ta#r$Ta#s$Ta#t$Ta#u$Ta#v$Ta#x$Ta#z$Ta#{$Ta(a$Ta(r$Ta(y$Ta(z$Ta~O%i7WO~P&8fO%^8[Oa%[i!_%[i'z%[i!]%[i~Oa#cy!]#cy'z#cy'w#cy!Y#cy!k#cyv#cy!_#cy%i#cy!g#cy~P!:tO[8^O~Ob8`O(T+qO(VTO(YUO~O!]1TO!^)Xi~O`8dO~O(e(|O!]'pX!^'pX~O!]5uO!^)Ua~O!^8nO~P%;eO(o!sO~P$&YO#[8oO~O!_1oO~O!_1oO%i8qO~On8tO!_1oO%i8qO~O[8yO!]'sa!^'sa~O!]1zO!^)Vi~O!k8}O~O!k9OO~O!k9RO~O!k9RO~P%[Oa9TO~O!g9UO~O!k9VO~O!](wi!^(wi~P#BwOa%nO#`9_O'z%nO~O!](ty!k(tya(ty'z(ty~P!:tO!](jO!k(sy~O%i9bO~P&8fO!_'`O%i9bO~O#k$|qP$|qR$|q[$|qa$|qj$|qr$|q!S$|q!]$|q!l$|q!p$|q#R$|q#n$|q#o$|q#p$|q#q$|q#r$|q#s$|q#t$|q#u$|q#v$|q#x$|q#z$|q#{$|q'z$|q(a$|q(r$|q!k$|q!Y$|q'w$|q#`$|qv$|q!_$|q%i$|q!g$|q~P#/sO#k'jaP'jaR'ja['jaa'jaj'jar'ja!S'ja!l'ja!p'ja#R'ja#n'ja#o'ja#p'ja#q'ja#r'ja#s'ja#t'ja#u'ja#v'ja#x'ja#z'ja#{'ja'z'ja(a'ja(r'ja!k'ja!Y'ja'w'jav'ja!_'ja%i'ja!g'ja~P&5RO#k'laP'laR'la['laa'laj'lar'la!S'la!l'la!p'la#R'la#n'la#o'la#p'la#q'la#r'la#s'la#t'la#u'la#v'la#x'la#z'la#{'la'z'la(a'la(r'la!k'la!Y'la'w'lav'la!_'la%i'la!g'la~P&5tO#k%OqP%OqR%Oq[%Oqa%Oqj%Oqr%Oq!S%Oq!]%Oq!l%Oq!p%Oq#R%Oq#n%Oq#o%Oq#p%Oq#q%Oq#r%Oq#s%Oq#t%Oq#u%Oq#v%Oq#x%Oq#z%Oq#{%Oq'z%Oq(a%Oq(r%Oq!k%Oq!Y%Oq'w%Oq#`%Oqv%Oq!_%Oq%i%Oq!g%Oq~P#/sO!]'Yi!k'Yi~P!:tO$O#cq!]#cq!^#cq~P#BwO(y$}OP%aaR%aa[%aaj%aar%aa!S%aa!l%aa!p%aa#R%aa#n%aa#o%aa#p%aa#q%aa#r%aa#s%aa#t%aa#u%aa#v%aa#x%aa#z%aa#{%aa$O%aa(a%aa(r%aa!]%aa!^%aa~On%aa!Q%aa'y%aa(z%aa~P&IyO(z%POP%caR%ca[%caj%car%ca!S%ca!l%ca!p%ca#R%ca#n%ca#o%ca#p%ca#q%ca#r%ca#s%ca#t%ca#u%ca#v%ca#x%ca#z%ca#{%ca$O%ca(a%ca(r%ca!]%ca!^%ca~On%ca!Q%ca'y%ca(y%ca~P&LQOn>^O!Q*OO'y*PO(z%PO~P&IyOn>^O!Q*OO'y*PO(y$}O~P&LQOR0kO!Q0kO!S0lO#S$dOP}a[}aj}an}ar}a!l}a!p}a#R}a#n}a#o}a#p}a#q}a#r}a#s}a#t}a#u}a#v}a#x}a#z}a#{}a$O}a'y}a(a}a(r}a(y}a(z}a!]}a!^}a~O!Q*OO'y*POP$saR$sa[$saj$san$sar$sa!S$sa!l$sa!p$sa#R$sa#n$sa#o$sa#p$sa#q$sa#r$sa#s$sa#t$sa#u$sa#v$sa#x$sa#z$sa#{$sa$O$sa(a$sa(r$sa(y$sa(z$sa!]$sa!^$sa~O!Q*OO'y*POP$uaR$ua[$uaj$uan$uar$ua!S$ua!l$ua!p$ua#R$ua#n$ua#o$ua#p$ua#q$ua#r$ua#s$ua#t$ua#u$ua#v$ua#x$ua#z$ua#{$ua$O$ua(a$ua(r$ua(y$ua(z$ua!]$ua!^$ua~On>^O!Q*OO'y*PO(y$}O(z%PO~OP%TaR%Ta[%Taj%Tar%Ta!S%Ta!l%Ta!p%Ta#R%Ta#n%Ta#o%Ta#p%Ta#q%Ta#r%Ta#s%Ta#t%Ta#u%Ta#v%Ta#x%Ta#z%Ta#{%Ta$O%Ta(a%Ta(r%Ta!]%Ta!^%Ta~P''VO$O$mq!]$mq!^$mq~P#BwO$O$oq!]$oq!^$oq~P#BwO!^9oO~O$O9pO~P!1WO!g#vO!]'ei!k'ei~O!g#vO(r'pO!]'ei!k'ei~O!]/pO!k)Oq~O!Y'gi!]'gi~P#/sO!]/yO!Y)Pq~Or9wO!g#vO(r'pO~O[9yO!Y9xO~P#/sO!Y9xO~Oj:PO!g#vO~Og(_y!](_y~P!1WO!]'na!_'na~P#/sOa%[q!_%[q'z%[q!]%[q~P#/sO[:UO~O!]1TO!^)Xq~O`:YO~O#`:ZO!]'pa!^'pa~O!]5uO!^)Ui~P#BwO!S:]O~O!_1oO%i:`O~O(VTO(YUO(e:eO~O!]1zO!^)Vq~O!k:hO~O!k:iO~O!k:jO~O!k:jO~P%[O#`:mO!]#hy!^#hy~O!]#hy!^#hy~P#BwO%i:rO~P&8fO!_'`O%i:rO~O$O#|y!]#|y!^#|y~P#BwOP$|iR$|i[$|ij$|ir$|i!S$|i!l$|i!p$|i#R$|i#n$|i#o$|i#p$|i#q$|i#r$|i#s$|i#t$|i#u$|i#v$|i#x$|i#z$|i#{$|i$O$|i(a$|i(r$|i!]$|i!^$|i~P''VO!Q*OO'y*PO(z%POP'iaR'ia['iaj'ian'iar'ia!S'ia!l'ia!p'ia#R'ia#n'ia#o'ia#p'ia#q'ia#r'ia#s'ia#t'ia#u'ia#v'ia#x'ia#z'ia#{'ia$O'ia(a'ia(r'ia(y'ia!]'ia!^'ia~O!Q*OO'y*POP'kaR'ka['kaj'kan'kar'ka!S'ka!l'ka!p'ka#R'ka#n'ka#o'ka#p'ka#q'ka#r'ka#s'ka#t'ka#u'ka#v'ka#x'ka#z'ka#{'ka$O'ka(a'ka(r'ka(y'ka(z'ka!]'ka!^'ka~O(y$}OP%aiR%ai[%aij%ain%air%ai!Q%ai!S%ai!l%ai!p%ai#R%ai#n%ai#o%ai#p%ai#q%ai#r%ai#s%ai#t%ai#u%ai#v%ai#x%ai#z%ai#{%ai$O%ai'y%ai(a%ai(r%ai(z%ai!]%ai!^%ai~O(z%POP%ciR%ci[%cij%cin%cir%ci!Q%ci!S%ci!l%ci!p%ci#R%ci#n%ci#o%ci#p%ci#q%ci#r%ci#s%ci#t%ci#u%ci#v%ci#x%ci#z%ci#{%ci$O%ci'y%ci(a%ci(r%ci(y%ci!]%ci!^%ci~O$O$oy!]$oy!^$oy~P#BwO$O#cy!]#cy!^#cy~P#BwO!g#vO!]'eq!k'eq~O!]/pO!k)Oy~O!Y'gq!]'gq~P#/sOr:|O!g#vO(r'pO~O[;QO!Y;PO~P#/sO!Y;PO~Og(_!R!](_!R~P!1WOa%[y!_%[y'z%[y!]%[y~P#/sO!]1TO!^)Xy~O!]5uO!^)Uq~O(T;XO~O!_1oO%i;[O~O!k;_O~O%i;dO~P&8fOP$|qR$|q[$|qj$|qr$|q!S$|q!l$|q!p$|q#R$|q#n$|q#o$|q#p$|q#q$|q#r$|q#s$|q#t$|q#u$|q#v$|q#x$|q#z$|q#{$|q$O$|q(a$|q(r$|q!]$|q!^$|q~P''VO!Q*OO'y*PO(z%POP'jaR'ja['jaj'jan'jar'ja!S'ja!l'ja!p'ja#R'ja#n'ja#o'ja#p'ja#q'ja#r'ja#s'ja#t'ja#u'ja#v'ja#x'ja#z'ja#{'ja$O'ja(a'ja(r'ja(y'ja!]'ja!^'ja~O!Q*OO'y*POP'laR'la['laj'lan'lar'la!S'la!l'la!p'la#R'la#n'la#o'la#p'la#q'la#r'la#s'la#t'la#u'la#v'la#x'la#z'la#{'la$O'la(a'la(r'la(y'la(z'la!]'la!^'la~OP%OqR%Oq[%Oqj%Oqr%Oq!S%Oq!l%Oq!p%Oq#R%Oq#n%Oq#o%Oq#p%Oq#q%Oq#r%Oq#s%Oq#t%Oq#u%Oq#v%Oq#x%Oq#z%Oq#{%Oq$O%Oq(a%Oq(r%Oq!]%Oq!^%Oq~P''VOg%e!Z!]%e!Z#`%e!Z$O%e!Z~P!1WO!Y;hO~P#/sOr;iO!g#vO(r'pO~O[;kO!Y;hO~P#/sO!]'pq!^'pq~P#BwO!]#h!Z!^#h!Z~P#BwO#k%e!ZP%e!ZR%e!Z[%e!Za%e!Zj%e!Zr%e!Z!S%e!Z!]%e!Z!l%e!Z!p%e!Z#R%e!Z#n%e!Z#o%e!Z#p%e!Z#q%e!Z#r%e!Z#s%e!Z#t%e!Z#u%e!Z#v%e!Z#x%e!Z#z%e!Z#{%e!Z'z%e!Z(a%e!Z(r%e!Z!k%e!Z!Y%e!Z'w%e!Z#`%e!Zv%e!Z!_%e!Z%i%e!Z!g%e!Z~P#/sOr;tO!g#vO(r'pO~O!Y;uO~P#/sOr;|O!g#vO(r'pO~O!Y;}O~P#/sOP%e!ZR%e!Z[%e!Zj%e!Zr%e!Z!S%e!Z!l%e!Z!p%e!Z#R%e!Z#n%e!Z#o%e!Z#p%e!Z#q%e!Z#r%e!Z#s%e!Z#t%e!Z#u%e!Z#v%e!Z#x%e!Z#z%e!Z#{%e!Z$O%e!Z(a%e!Z(r%e!Z!]%e!Z!^%e!Z~P''VOr<QO!g#vO(r'pO~Ov(fX~P1qO!Q%rO~P!)[O(U!lO~P!)[O!YfX!]fX#`fX~P%2OOP]XR]X[]Xj]Xr]X!Q]X!S]X!]]X!]fX!l]X!p]X#R]X#S]X#`]X#`fX#kfX#n]X#o]X#p]X#q]X#r]X#s]X#t]X#u]X#v]X#x]X#z]X#{]X$Q]X(a]X(r]X(y]X(z]X~O!gfX!k]X!kfX(rfX~P'LTOP<UOQ<UOSfOd>ROe!iOpkOr<UOskOtkOzkO|<UO!O<UO!SWO!WkO!XkO!_XO!i<XO!lZO!o<UO!p<UO!q<UO!s<YO!u<]O!x!hO$W!kO$n>PO(T)]O(VTO(YUO(aVO(o[O~O!]<iO!^$qa~Oh%VOp%WOr%XOs$tOt$tOz%YO|%ZO!O<tO!S${O!_$|O!i>WO!l$xO#j<zO$W%`O$t<vO$v<xO$y%aO(T(vO(VTO(YUO(a$uO(y$}O(z%PO~Ol)dO~P(!yOr!eX(r!eX~P#!iOr(jX(r(jX~P##[O!^]X!^fX~P'LTO!YfX!Y$zX!]fX!]$zX#`fX~P!0SO#k<^O~O!g#vO#k<^O~O#`<nO~Oj<bO~O#`=OO!](wX!^(wX~O#`<nO!](uX!^(uX~O#k=PO~Og=RO~P!1WO#k=XO~O#k=YO~Og=RO(T&ZO~O!g#vO#k=ZO~O!g#vO#k=PO~O$O=[O~P#BwO#k=]O~O#k=^O~O#k=cO~O#k=dO~O#k=eO~O#k=fO~O$O=gO~P!1WO$O=hO~P!1WOl=sO~P7eOk#S#T#U#W#X#[#i#j#u$n$t$v$y%]%^%h%i%j%q%s%v%w%y%{~(OT#o!X'|(U#ps#n#qr!Q'}$]'}(T$_(e~",goto:"$9Y)]PPPPPP)^PP)aP)rP+W/]PPPP6mPP7TPP=QPPP@tPA^PA^PPPA^PCfPA^PA^PA^PCjPCoPD^PIWPPPI[PPPPI[L_PPPLeMVPI[PI[PP! eI[PPPI[PI[P!#lI[P!'S!(X!(bP!)U!)Y!)U!,gPPPPPPP!-W!(XPP!-h!/YP!2iI[I[!2n!5z!:h!:h!>gPPP!>oI[PPPPPPPPP!BOP!C]PPI[!DnPI[PI[I[I[I[I[PI[!FQP!I[P!LbP!Lf!Lp!Lt!LtP!IXP!Lx!LxP#!OP#!SI[PI[#!Y#%_CjA^PA^PA^A^P#&lA^A^#)OA^#+vA^#.SA^A^#.r#1W#1W#1]#1f#1W#1qPP#1WPA^#2ZA^#6YA^A^6mPPP#:_PPP#:x#:xP#:xP#;`#:xPP#;fP#;]P#;]#;y#;]#<e#<k#<n)aP#<q)aP#<z#<z#<zP)aP)aP)aP)aPP)aP#=Q#=TP#=T)aP#=XP#=[P)aP)aP)aP)aP)aP)a)aPP#=b#=h#=s#=y#>P#>V#>]#>k#>q#>{#?R#?]#?c#?s#?y#@k#@}#AT#AZ#Ai#BO#Cs#DR#DY#Et#FS#Gt#HS#HY#H`#Hf#Hp#Hv#H|#IW#Ij#IpPPPPPPPPPPP#IvPPPPPPP#Jk#Mx$ b$ i$ qPPP$']P$'f$*_$0x$0{$1O$1}$2Q$2X$2aP$2g$2jP$3W$3[$4S$5b$5g$5}PP$6S$6Y$6^$6a$6e$6i$7e$7|$8e$8i$8l$8o$8y$8|$9Q$9UR!|RoqOXst!Z#d%m&r&t&u&w,s,x2[2_Y!vQ'`-e1o5{Q%tvQ%|yQ&T|Q&j!VS'W!e-]Q'f!iS'l!r!yU*k$|*Z*oQ+o%}S+|&V&WQ,d&dQ-c'_Q-m'gQ-u'mQ0[*qQ1b,OQ1y,eR<{<Y%SdOPWXYZstuvw!Z!`!g!o#S#W#Z#d#o#u#x#{$O$P$Q$R$S$T$U$V$W$X$_$a$e%m%t&R&k&n&r&t&u&w&{'T'b'r(T(V(](d(x(z)O)}*i+X+],p,s,x-i-q.P.V.t.{/n0]0l0r1S1r2S2T2V2X2[2_2a3Q3W3l4z6T6e6f6i6|8t9T9_S#q]<V!r)_$Z$n'X)s-U-X/V2p4T5w6s:Z:m<U<X<Y<]<^<_<`<a<b<c<d<e<f<g<h<i<k<n<{=O=P=R=Z=[=e=f>SU+P%]<s<tQ+t&PQ,f&gQ,m&oQ0x+gQ0}+iQ1Y+uQ2R,kQ3`.gQ5`0|Q5f1TQ6[1zQ7Y3dQ8`5gR9e7['QkOPWXYZstuvw!Z!`!g!o#S#W#Z#d#o#u#x#{$O$P$Q$R$S$T$U$V$W$X$Z$_$a$e$n%m%t&R&k&n&o&r&t&u&w&{'T'X'b'r(T(V(](d(x(z)O)s)}*i+X+]+g,p,s,x-U-X-i-q.P.V.g.t.{/V/n0]0l0r1S1r2S2T2V2X2[2_2a2p3Q3W3d3l4T4z5w6T6e6f6i6s6|7[8t9T9_:Z:m<U<X<Y<]<^<_<`<a<b<c<d<e<f<g<h<i<k<n<{=O=P=R=Z=[=e=f>S!S!nQ!r!v!y!z$|'W'_'`'l'm'n*k*o*q*r-]-c-e-u0[0_1o5{5}%[$ti#v$b$c$d$x${%O%Q%^%_%c)y*R*T*V*Y*a*g*w*x+f+i,S,V.f/P/d/m/x/y/{0`0b0i0j0o1f1i1q3c4^4_4j4o5Q5[5_6S7W7v8Q8V8[8q9b9p9y:P:`:r;Q;[;d;k<l<m<o<p<q<r<u<v<w<x<y<z=S=T=U=V=X=Y=]=^=_=`=a=b=c=d=g=h>P>X>Y>]>^Q&X|Q'U!eS'[%i-`Q+t&PQ,P&WQ,f&gQ0n+SQ1Y+uQ1_+{Q2Q,jQ2R,kQ5f1TQ5o1aQ6[1zQ6_1|Q6`2PQ8`5gQ8c5lQ8|6bQ:X8dQ:f8yQ;V:YR<}*ZrnOXst!V!Z#d%m&i&r&t&u&w,s,x2[2_R,h&k&z^OPXYstuvwz!Z!`!g!j!o#S#d#o#u#x#{$O$P$Q$R$S$T$U$V$W$X$Z$_$a$e$n%m%t&R&k&n&o&r&t&u&w&{'T'b'r(V(](d(x(z)O)s)}*i+X+]+g,p,s,x-U-X-i-q.P.V.g.t.{/V/n0]0l0r1S1r2S2T2V2X2[2_2a2p3Q3W3d3l4T4z5w6T6e6f6i6s6|7[8t9T9_:Z:m<U<X<Y<]<^<_<`<a<b<c<d<e<f<g<h<i<k<n<{=O=P=R=Z=[=e=f>R>S[#]WZ#W#Z'X(T!b%jm#h#i#l$x%e%h(^(h(i(j*Y*^*b+Z+[+^,o-V.T.Z.[.]._/m/p2d3[3]4a6r7TQ%wxQ%{yW&Q|&V&W,OQ&_!TQ'c!hQ'e!iQ(q#sS+n%|%}Q+r&PQ,_&bQ,c&dS-l'f'gQ.i(rQ1R+oQ1X+uQ1Z+vQ1^+zQ1t,`S1x,d,eQ2|-mQ5e1TQ5i1WQ5n1`Q6Z1yQ8_5gQ8b5kQ8f5pQ:T8^R;T:U!U$zi$d%O%Q%^%_%c*R*T*a*w*x/P/x0`0b0i0j0o4_5Q8V9p>P>X>Y!^%yy!i!u%{%|%}'V'e'f'g'k'u*j+n+o-Y-l-m-t0R0U1R2u2|3T4r4s4v7}9{Q+h%wQ,T&[Q,W&]Q,b&dQ.h(qQ1s,_U1w,c,d,eQ3e.iQ6U1tS6Y1x1yQ8x6Z#f>T#v$b$c$x${)y*V*Y*g+f+i,S,V.f/d/m/y/{1f1i1q3c4^4j4o5[5_6S7W7v8Q8[8q9b9y:P:`:r;Q;[;d;k<o<q<u<w<y=S=U=X=]=_=a=c=g>]>^o>U<l<m<p<r<v<x<z=T=V=Y=^=`=b=d=hW%Ti%V*y>PS&[!Q&iQ&]!RQ&^!SU*}%[%d=sR,R&Y%]%Si#v$b$c$d$x${%O%Q%^%_%c)y*R*T*V*Y*a*g*w*x+f+i,S,V.f/P/d/m/x/y/{0`0b0i0j0o1f1i1q3c4^4_4j4o5Q5[5_6S7W7v8Q8V8[8q9b9p9y:P:`:r;Q;[;d;k<l<m<o<p<q<r<u<v<w<x<y<z=S=T=U=V=X=Y=]=^=_=`=a=b=c=d=g=h>P>X>Y>]>^T)z$u){V+P%]<s<tW'[!e%i*Z-`S(}#y#zQ+c%rQ+y&SS.b(m(nQ1j,XQ5T0kR8i5u'QkOPWXYZstuvw!Z!`!g!o#S#W#Z#d#o#u#x#{$O$P$Q$R$S$T$U$V$W$X$Z$_$a$e$n%m%t&R&k&n&o&r&t&u&w&{'T'X'b'r(T(V(](d(x(z)O)s)}*i+X+]+g,p,s,x-U-X-i-q.P.V.g.t.{/V/n0]0l0r1S1r2S2T2V2X2[2_2a2p3Q3W3d3l4T4z5w6T6e6f6i6s6|7[8t9T9_:Z:m<U<X<Y<]<^<_<`<a<b<c<d<e<f<g<h<i<k<n<{=O=P=R=Z=[=e=f>S$i$^c#Y#e%q%s%u(S(Y(t(y)R)S)T)U)V)W)X)Y)Z)[)^)`)b)g)q+d+x-Z-x-}.S.U.s.v.z.|.}/O/b0p2k2n3O3V3k3p3q3r3s3t3u3v3w3x3y3z3{3|4P4Q4X5X5c6u6{7Q7a7b7k7l8k9X9]9g9m9n:o;W;`<W=vT#TV#U'RkOPWXYZstuvw!Z!`!g!o#S#W#Z#d#o#u#x#{$O$P$Q$R$S$T$U$V$W$X$Z$_$a$e$n%m%t&R&k&n&o&r&t&u&w&{'T'X'b'r(T(V(](d(x(z)O)s)}*i+X+]+g,p,s,x-U-X-i-q.P.V.g.t.{/V/n0]0l0r1S1r2S2T2V2X2[2_2a2p3Q3W3d3l4T4z5w6T6e6f6i6s6|7[8t9T9_:Z:m<U<X<Y<]<^<_<`<a<b<c<d<e<f<g<h<i<k<n<{=O=P=R=Z=[=e=f>SQ'Y!eR2q-]!W!nQ!e!r!v!y!z$|'W'_'`'l'm'n*Z*k*o*q*r-]-c-e-u0[0_1o5{5}R1l,ZnqOXst!Z#d%m&r&t&u&w,s,x2[2_Q&y!^Q'v!xS(s#u<^Q+l%zQ,]&_Q,^&aQ-j'dQ-w'oS.r(x=PS0q+X=ZQ1P+mQ1n,[Q2c,zQ2e,{Q2m-WQ2z-kQ2}-oS5Y0r=eQ5a1QS5d1S=fQ6t2oQ6x2{Q6}3SQ8]5bQ9Y6vQ9Z6yQ9^7OR:l9V$d$]c#Y#e%s%u(S(Y(t(y)R)S)T)U)V)W)X)Y)Z)[)^)`)b)g)q+d+x-Z-x-}.S.U.s.v.z.}/O/b0p2k2n3O3V3k3p3q3r3s3t3u3v3w3x3y3z3{3|4P4Q4X5X5c6u6{7Q7a7b7k7l8k9X9]9g9m9n:o;W;`<W=vS(o#p'iQ)P#zS+b%q.|S.c(n(pR3^.d'QkOPWXYZstuvw!Z!`!g!o#S#W#Z#d#o#u#x#{$O$P$Q$R$S$T$U$V$W$X$Z$_$a$e$n%m%t&R&k&n&o&r&t&u&w&{'T'X'b'r(T(V(](d(x(z)O)s)}*i+X+]+g,p,s,x-U-X-i-q.P.V.g.t.{/V/n0]0l0r1S1r2S2T2V2X2[2_2a2p3Q3W3d3l4T4z5w6T6e6f6i6s6|7[8t9T9_:Z:m<U<X<Y<]<^<_<`<a<b<c<d<e<f<g<h<i<k<n<{=O=P=R=Z=[=e=f>SS#q]<VQ&t!XQ&u!YQ&w![Q&x!]R2Z,vQ'a!hQ+e%wQ-h'cS.e(q+hQ2x-gW3b.h.i0w0yQ6w2yW7U3_3a3e5^U9a7V7X7ZU:q9c9d9fS;b:p:sQ;p;cR;x;qU!wQ'`-eT5y1o5{!Q_OXZ`st!V!Z#d#h%e%m&i&k&r&t&u&w(j,s,x.[2[2_]!pQ!r'`-e1o5{T#q]<V%^{OPWXYZstuvw!Z!`!g!o#S#W#Z#d#o#u#x#{$O$P$Q$R$S$T$U$V$W$X$_$a$e%m%t&R&k&n&o&r&t&u&w&{'T'b'r(T(V(](d(x(z)O)}*i+X+]+g,p,s,x-i-q.P.V.g.t.{/n0]0l0r1S1r2S2T2V2X2[2_2a3Q3W3d3l4z6T6e6f6i6|7[8t9T9_S(}#y#zS.b(m(n!s=l$Z$n'X)s-U-X/V2p4T5w6s:Z:m<U<X<Y<]<^<_<`<a<b<c<d<e<f<g<h<i<k<n<{=O=P=R=Z=[=e=f>SU$fd)_,mS(p#p'iU*v%R(w4OU0m+O.n7gQ5^0xQ7V3`Q9d7YR:s9em!tQ!r!v!y!z'`'l'm'n-e-u1o5{5}Q't!uS(f#g2US-s'k'wQ/s*]Q0R*jQ3U-vQ4f/tQ4r0TQ4s0UQ4x0^Q7r4`S7}4t4vS8R4y4{Q9r7sQ9v7yQ9{8OQ:Q8TS:{9w9xS;g:|;PS;s;h;iS;{;t;uS<P;|;}R<S<QQ#wbQ's!uS(e#g2US(g#m+WQ+Y%fQ+j%xQ+p&OU-r'k't'wQ.W(fU/r*]*`/wQ0S*jQ0V*lQ1O+kQ1u,aS3R-s-vQ3Z.`S4e/s/tQ4n0PS4q0R0^Q4u0WQ6W1vQ7P3US7q4`4bQ7u4fU7|4r4x4{Q8P4wQ8v6XS9q7r7sQ9u7yQ9}8RQ:O8SQ:c8wQ:y9rS:z9v9xQ;S:QQ;^:dS;f:{;PS;r;g;hS;z;s;uS<O;{;}Q<R<PQ<T<SQ=o=jQ={=tR=|=uV!wQ'`-e%^aOPWXYZstuvw!Z!`!g!o#S#W#Z#d#o#u#x#{$O$P$Q$R$S$T$U$V$W$X$_$a$e%m%t&R&k&n&o&r&t&u&w&{'T'b'r(T(V(](d(x(z)O)}*i+X+]+g,p,s,x-i-q.P.V.g.t.{/n0]0l0r1S1r2S2T2V2X2[2_2a3Q3W3d3l4z6T6e6f6i6|7[8t9T9_S#wz!j!r=i$Z$n'X)s-U-X/V2p4T5w6s:Z:m<U<X<Y<]<^<_<`<a<b<c<d<e<f<g<h<i<k<n<{=O=P=R=Z=[=e=f>SR=o>R%^bOPWXYZstuvw!Z!`!g!o#S#W#Z#d#o#u#x#{$O$P$Q$R$S$T$U$V$W$X$_$a$e%m%t&R&k&n&o&r&t&u&w&{'T'b'r(T(V(](d(x(z)O)}*i+X+]+g,p,s,x-i-q.P.V.g.t.{/n0]0l0r1S1r2S2T2V2X2[2_2a3Q3W3d3l4z6T6e6f6i6|7[8t9T9_Q%fj!^%xy!i!u%{%|%}'V'e'f'g'k'u*j+n+o-Y-l-m-t0R0U1R2u2|3T4r4s4v7}9{S&Oz!jQ+k%yQ,a&dW1v,b,c,d,eU6X1w1x1yS8w6Y6ZQ:d8x!r=j$Z$n'X)s-U-X/V2p4T5w6s:Z:m<U<X<Y<]<^<_<`<a<b<c<d<e<f<g<h<i<k<n<{=O=P=R=Z=[=e=f>SQ=t>QR=u>R%QeOPXYstuvw!Z!`!g!o#S#d#o#u#x#{$O$P$Q$R$S$T$U$V$W$X$_$a$e%m%t&R&k&n&r&t&u&w&{'T'b'r(V(](d(x(z)O)}*i+X+]+g,p,s,x-i-q.P.V.g.t.{/n0]0l0r1S1r2S2T2V2X2[2_2a3Q3W3d3l4z6T6e6f6i6|7[8t9T9_Y#bWZ#W#Z(T!b%jm#h#i#l$x%e%h(^(h(i(j*Y*^*b+Z+[+^,o-V.T.Z.[.]._/m/p2d3[3]4a6r7TQ,n&o!p=k$Z$n)s-U-X/V2p4T5w6s:Z:m<U<X<Y<]<^<_<`<a<b<c<d<e<f<g<h<i<k<n<{=O=P=R=Z=[=e=f>SR=n'XU']!e%i*ZR2s-`%SdOPWXYZstuvw!Z!`!g!o#S#W#Z#d#o#u#x#{$O$P$Q$R$S$T$U$V$W$X$_$a$e%m%t&R&k&n&r&t&u&w&{'T'b'r(T(V(](d(x(z)O)}*i+X+],p,s,x-i-q.P.V.t.{/n0]0l0r1S1r2S2T2V2X2[2_2a3Q3W3l4z6T6e6f6i6|8t9T9_!r)_$Z$n'X)s-U-X/V2p4T5w6s:Z:m<U<X<Y<]<^<_<`<a<b<c<d<e<f<g<h<i<k<n<{=O=P=R=Z=[=e=f>SQ,m&oQ0x+gQ3`.gQ7Y3dR9e7[!b$Tc#Y%q(S(Y(t(y)Z)[)`)g+x-x-}.S.U.s.v/b0p3O3V3k3{5X5c6{7Q7a9]:o<W!P<d)^)q-Z.|2k2n3p3y3z4P4X6u7b7k7l8k9X9g9m9n;W;`=v!f$Vc#Y%q(S(Y(t(y)W)X)Z)[)`)g+x-x-}.S.U.s.v/b0p3O3V3k3{5X5c6{7Q7a9]:o<W!T<f)^)q-Z.|2k2n3p3v3w3y3z4P4X6u7b7k7l8k9X9g9m9n;W;`=v!^$Zc#Y%q(S(Y(t(y)`)g+x-x-}.S.U.s.v/b0p3O3V3k3{5X5c6{7Q7a9]:o<WQ4_/kz>S)^)q-Z.|2k2n3p4P4X6u7b7k7l8k9X9g9m9n;W;`=vQ>X>ZR>Y>['QkOPWXYZstuvw!Z!`!g!o#S#W#Z#d#o#u#x#{$O$P$Q$R$S$T$U$V$W$X$Z$_$a$e$n%m%t&R&k&n&o&r&t&u&w&{'T'X'b'r(T(V(](d(x(z)O)s)}*i+X+]+g,p,s,x-U-X-i-q.P.V.g.t.{/V/n0]0l0r1S1r2S2T2V2X2[2_2a2p3Q3W3d3l4T4z5w6T6e6f6i6s6|7[8t9T9_:Z:m<U<X<Y<]<^<_<`<a<b<c<d<e<f<g<h<i<k<n<{=O=P=R=Z=[=e=f>SS$oh$pR4U/U'XgOPWXYZhstuvw!Z!`!g!o#S#W#Z#d#o#u#x#{$O$P$Q$R$S$T$U$V$W$X$Z$_$a$e$n$p%m%t&R&k&n&o&r&t&u&w&{'T'X'b'r(T(V(](d(x(z)O)s)}*i+X+]+g,p,s,x-U-X-i-q.P.V.g.t.{/U/V/n0]0l0r1S1r2S2T2V2X2[2_2a2p3Q3W3d3l4T4z5w6T6e6f6i6s6|7[8t9T9_:Z:m<U<X<Y<]<^<_<`<a<b<c<d<e<f<g<h<i<k<n<{=O=P=R=Z=[=e=f>ST$kf$qQ$ifS)j$l)nR)v$qT$jf$qT)l$l)n'XhOPWXYZhstuvw!Z!`!g!o#S#W#Z#d#o#u#x#{$O$P$Q$R$S$T$U$V$W$X$Z$_$a$e$n$p%m%t&R&k&n&o&r&t&u&w&{'T'X'b'r(T(V(](d(x(z)O)s)}*i+X+]+g,p,s,x-U-X-i-q.P.V.g.t.{/U/V/n0]0l0r1S1r2S2T2V2X2[2_2a2p3Q3W3d3l4T4z5w6T6e6f6i6s6|7[8t9T9_:Z:m<U<X<Y<]<^<_<`<a<b<c<d<e<f<g<h<i<k<n<{=O=P=R=Z=[=e=f>ST$oh$pQ$rhR)u$p%^jOPWXYZstuvw!Z!`!g!o#S#W#Z#d#o#u#x#{$O$P$Q$R$S$T$U$V$W$X$_$a$e%m%t&R&k&n&o&r&t&u&w&{'T'b'r(T(V(](d(x(z)O)}*i+X+]+g,p,s,x-i-q.P.V.g.t.{/n0]0l0r1S1r2S2T2V2X2[2_2a3Q3W3d3l4z6T6e6f6i6|7[8t9T9_!s>Q$Z$n'X)s-U-X/V2p4T5w6s:Z:m<U<X<Y<]<^<_<`<a<b<c<d<e<f<g<h<i<k<n<{=O=P=R=Z=[=e=f>S#glOPXZst!Z!`!o#S#d#o#{$n%m&k&n&o&r&t&u&w&{'T'b)O)s*i+]+g,p,s,x-i.g/V/n0]0l1r2S2T2V2X2[2_2a3d4T4z6T6e6f6i7[8t9T!U%Ri$d%O%Q%^%_%c*R*T*a*w*x/P/x0`0b0i0j0o4_5Q8V9p>P>X>Y#f(w#v$b$c$x${)y*V*Y*g+f+i,S,V.f/d/m/y/{1f1i1q3c4^4j4o5[5_6S7W7v8Q8[8q9b9y:P:`:r;Q;[;d;k<o<q<u<w<y=S=U=X=]=_=a=c=g>]>^Q+T%aQ/c*Oo4O<l<m<p<r<v<x<z=T=V=Y=^=`=b=d=h!U$yi$d%O%Q%^%_%c*R*T*a*w*x/P/x0`0b0i0j0o4_5Q8V9p>P>X>YQ*c$zU*l$|*Z*oQ+U%bQ0W*m#f=q#v$b$c$x${)y*V*Y*g+f+i,S,V.f/d/m/y/{1f1i1q3c4^4j4o5[5_6S7W7v8Q8[8q9b9y:P:`:r;Q;[;d;k<o<q<u<w<y=S=U=X=]=_=a=c=g>]>^n=r<l<m<p<r<v<x<z=T=V=Y=^=`=b=d=hQ=w>TQ=x>UQ=y>VR=z>W!U%Ri$d%O%Q%^%_%c*R*T*a*w*x/P/x0`0b0i0j0o4_5Q8V9p>P>X>Y#f(w#v$b$c$x${)y*V*Y*g+f+i,S,V.f/d/m/y/{1f1i1q3c4^4j4o5[5_6S7W7v8Q8[8q9b9y:P:`:r;Q;[;d;k<o<q<u<w<y=S=U=X=]=_=a=c=g>]>^o4O<l<m<p<r<v<x<z=T=V=Y=^=`=b=d=hnoOXst!Z#d%m&r&t&u&w,s,x2[2_S*f${*YQ-R'OQ-S'QR4i/y%[%Si#v$b$c$d$x${%O%Q%^%_%c)y*R*T*V*Y*a*g*w*x+f+i,S,V.f/P/d/m/x/y/{0`0b0i0j0o1f1i1q3c4^4_4j4o5Q5[5_6S7W7v8Q8V8[8q9b9p9y:P:`:r;Q;[;d;k<l<m<o<p<q<r<u<v<w<x<y<z=S=T=U=V=X=Y=]=^=_=`=a=b=c=d=g=h>P>X>Y>]>^Q,U&]Q1h,WQ5s1gR8h5tV*n$|*Z*oU*n$|*Z*oT5z1o5{S0P*i/nQ4w0]T8S4z:]Q+j%xQ0V*lQ1O+kQ1u,aQ6W1vQ8v6XQ:c8wR;^:d!U%Oi$d%O%Q%^%_%c*R*T*a*w*x/P/x0`0b0i0j0o4_5Q8V9p>P>X>Yx*R$v)e*S*u+V/v0d0e4R4g5R5S5W7p8U:R:x=p=}>OS0`*t0a#f<o#v$b$c$x${)y*V*Y*g+f+i,S,V.f/d/m/y/{1f1i1q3c4^4j4o5[5_6S7W7v8Q8[8q9b9y:P:`:r;Q;[;d;k<o<q<u<w<y=S=U=X=]=_=a=c=g>]>^n<p<l<m<p<r<v<x<z=T=V=Y=^=`=b=d=h!d=S(u)c*[*e.j.m.q/_/k/|0v1e3h4[4h4l5r7]7`7w7z8X8Z9t9|:S:};R;e;j;v>Z>[`=T3}7c7f7j9h:t:w;yS=_.l3iT=`7e9k!U%Qi$d%O%Q%^%_%c*R*T*a*w*x/P/x0`0b0i0j0o4_5Q8V9p>P>X>Y|*T$v)e*U*t+V/g/v0d0e4R4g4|5R5S5W7p8U:R:x=p=}>OS0b*u0c#f<q#v$b$c$x${)y*V*Y*g+f+i,S,V.f/d/m/y/{1f1i1q3c4^4j4o5[5_6S7W7v8Q8[8q9b9y:P:`:r;Q;[;d;k<o<q<u<w<y=S=U=X=]=_=a=c=g>]>^n<r<l<m<p<r<v<x<z=T=V=Y=^=`=b=d=h!h=U(u)c*[*e.k.l.q/_/k/|0v1e3f3h4[4h4l5r7]7^7`7w7z8X8Z9t9|:S:};R;e;j;v>Z>[d=V3}7d7e7j9h9i:t:u:w;yS=a.m3jT=b7f9lrnOXst!V!Z#d%m&i&r&t&u&w,s,x2[2_Q&f!UR,p&ornOXst!V!Z#d%m&i&r&t&u&w,s,x2[2_R&f!UQ,Y&^R1d,RsnOXst!V!Z#d%m&i&r&t&u&w,s,x2[2_Q1p,_S6R1s1tU8p6P6Q6US:_8r8sS;Y:^:aQ;m;ZR;w;nQ&m!VR,i&iR6_1|R:f8yW&Q|&V&W,OR1Z+vQ&r!WR,s&sR,y&xT2],x2_R,}&yQ,|&yR2f,}Q'y!{R-y'ySsOtQ#dXT%ps#dQ#OTR'{#OQ#RUR'}#RQ){$uR/`){Q#UVR(Q#UQ#XWU(W#X(X.QQ(X#YR.Q(YQ-^'YR2r-^Q.u(yS3m.u3nR3n.vQ-e'`R2v-eY!rQ'`-e1o5{R'j!rQ/Q)eR4S/QU#_W%h*YU(_#_(`.RQ(`#`R.R(ZQ-a']R2t-at`OXst!V!Z#d%m&i&k&r&t&u&w,s,x2[2_S#hZ%eU#r`#h.[R.[(jQ(k#jQ.X(gW.a(k.X3X7RQ3X.YR7R3YQ)n$lR/W)nQ$phR)t$pQ$`cU)a$`-|<jQ-|<WR<j)qQ/q*]W4c/q4d7t9sU4d/r/s/tS7t4e4fR9s7u$e*Q$v(u)c)e*[*e*t*u+Q+R+V.l.m.o.p.q/_/g/i/k/v/|0d0e0v1e3f3g3h3}4R4[4g4h4l4|5O5R5S5W5r7]7^7_7`7e7f7h7i7j7p7w7z8U8X8Z9h9i9j9t9|:R:S:t:u:v:w:x:};R;e;j;v;y=p=}>O>Z>[Q/z*eU4k/z4m7xQ4m/|R7x4lS*o$|*ZR0Y*ox*S$v)e*t*u+V/v0d0e4R4g5R5S5W7p8U:R:x=p=}>O!d.j(u)c*[*e.l.m.q/_/k/|0v1e3h4[4h4l5r7]7`7w7z8X8Z9t9|:S:};R;e;j;v>Z>[U/h*S.j7ca7c3}7e7f7j9h:t:w;yQ0a*tQ3i.lU4}0a3i9kR9k7e|*U$v)e*t*u+V/g/v0d0e4R4g4|5R5S5W7p8U:R:x=p=}>O!h.k(u)c*[*e.l.m.q/_/k/|0v1e3f3h4[4h4l5r7]7^7`7w7z8X8Z9t9|:S:};R;e;j;v>Z>[U/j*U.k7de7d3}7e7f7j9h9i:t:u:w;yQ0c*uQ3j.mU5P0c3j9lR9l7fQ*z%UR0g*zQ5]0vR8Y5]Q+_%kR0u+_Q5v1jS8j5v:[R:[8kQ,[&_R1m,[Q5{1oR8m5{Q1{,fS6]1{8zR8z6_Q1U+rW5h1U5j8a:VQ5j1XQ8a5iR:V8bQ+w&QR1[+wQ2_,xR6m2_YrOXst#dQ&v!ZQ+a%mQ,r&rQ,t&tQ,u&uQ,w&wQ2Y,sS2],x2_R6l2[Q%opQ&z!_Q&}!aQ'P!bQ'R!cQ'q!uQ+`%lQ+l%zQ,Q&XQ,h&mQ-P&|W-p'k's't'wQ-w'oQ0X*nQ1P+mQ1c,PS2O,i,lQ2g-OQ2h-RQ2i-SQ2}-oW3P-r-s-v-xQ5a1QQ5m1_Q5q1eQ6V1uQ6a2QQ6k2ZU6z3O3R3UQ6}3SQ8]5bQ8e5oQ8g5rQ8l5zQ8u6WQ8{6`S9[6{7PQ9^7OQ:W8cQ:b8vQ:g8|Q:n9]Q;U:XQ;]:cQ;a:oQ;l;VR;o;^Q%zyQ'd!iQ'o!uU+m%{%|%}Q-W'VU-k'e'f'gS-o'k'uQ0Q*jS1Q+n+oQ2o-YS2{-l-mQ3S-tS4p0R0UQ5b1RQ6v2uQ6y2|Q7O3TU7{4r4s4vQ9z7}R;O9{S$wi>PR*{%VU%Ui%V>PR0f*yQ$viS(u#v+iS)c$b$cQ)e$dQ*[$xS*e${*YQ*t%OQ*u%QQ+Q%^Q+R%_Q+V%cQ.l<oQ.m<qQ.o<uQ.p<wQ.q<yQ/_)yQ/g*RQ/i*TQ/k*VQ/v*aS/|*g/mQ0d*wQ0e*xl0v+f,V.f1i1q3c6S7W8q9b:`:r;[;dQ1e,SQ3f=SQ3g=UQ3h=XS3}<l<mQ4R/PS4[/d4^Q4g/xQ4h/yQ4l/{Q4|0`Q5O0bQ5R0iQ5S0jQ5W0oQ5r1fQ7]=]Q7^=_Q7_=aQ7`=cQ7e<pQ7f<rQ7h<vQ7i<xQ7j<zQ7p4_Q7w4jQ7z4oQ8U5QQ8X5[Q8Z5_Q9h=YQ9i=TQ9j=VQ9t7vQ9|8QQ:R8VQ:S8[Q:t=^Q:u=`Q:v=bQ:w=dQ:x9pQ:}9yQ;R:PQ;e=gQ;j;QQ;v;kQ;y=hQ=p>PQ=}>XQ>O>YQ>Z>]R>[>^Q+O%]Q.n<sR7g<tnpOXst!Z#d%m&r&t&u&w,s,x2[2_Q!fPS#fZ#oQ&|!`W'h!o*i0]4zQ(P#SQ)Q#{Q)r$nS,l&k&nQ,q&oQ-O&{S-T'T/nQ-g'bQ.x)OQ/[)sQ0s+]Q0y+gQ2W,pQ2y-iQ3a.gQ4W/VQ5U0lQ6Q1rQ6c2SQ6d2TQ6h2VQ6j2XQ6o2aQ7Z3dQ7m4TQ8s6TQ9P6eQ9Q6fQ9S6iQ9f7[Q:a8tR:k9T#[cOPXZst!Z!`!o#d#o#{%m&k&n&o&r&t&u&w&{'T'b)O*i+]+g,p,s,x-i.g/n0]0l1r2S2T2V2X2[2_2a3d4z6T6e6f6i7[8t9TQ#YWQ#eYQ%quQ%svS%uw!gS(S#W(VQ(Y#ZQ(t#uQ(y#xQ)R$OQ)S$PQ)T$QQ)U$RQ)V$SQ)W$TQ)X$UQ)Y$VQ)Z$WQ)[$XQ)^$ZQ)`$_Q)b$aQ)g$eW)q$n)s/V4TQ+d%tQ+x&RS-Z'X2pQ-x'rS-}(T.PQ.S(]Q.U(dQ.s(xQ.v(zQ.z<UQ.|<XQ.}<YQ/O<]Q/b)}Q0p+XQ2k-UQ2n-XQ3O-qQ3V.VQ3k.tQ3p<^Q3q<_Q3r<`Q3s<aQ3t<bQ3u<cQ3v<dQ3w<eQ3x<fQ3y<gQ3z<hQ3{.{Q3|<kQ4P<nQ4Q<{Q4X<iQ5X0rQ5c1SQ6u=OQ6{3QQ7Q3WQ7a3lQ7b=PQ7k=RQ7l=ZQ8k5wQ9X6sQ9]6|Q9g=[Q9m=eQ9n=fQ:o9_Q;W:ZQ;`:mQ<W#SR=v>SR#[WR'Z!el!tQ!r!v!y!z'`'l'm'n-e-u1o5{5}S'V!e-]U*j$|*Z*oS-Y'W'_S0U*k*qQ0^*rQ2u-cQ4v0[R4{0_R({#xQ!fQT-d'`-e]!qQ!r'`-e1o5{Q#p]R'i<VR)f$dY!uQ'`-e1o5{Q'k!rS'u!v!yS'w!z5}S-t'l'mQ-v'nR3T-uT#kZ%eS#jZ%eS%km,oU(g#h#i#lS.Y(h(iQ.^(jQ0t+^Q3Y.ZU3Z.[.]._S7S3[3]R9`7Td#^W#W#Z%h(T(^*Y+Z.T/mr#gZm#h#i#l%e(h(i(j+^.Z.[.]._3[3]7TS*]$x*bQ/t*^Q2U,oQ2l-VQ4`/pQ6q2dQ7s4aQ9W6rT=m'X+[V#aW%h*YU#`W%h*YS(U#W(^U(Z#Z+Z/mS-['X+[T.O(T.TV'^!e%i*ZQ$lfR)x$qT)m$l)nR4V/UT*_$x*bT*h${*YQ0w+fQ1g,VQ3_.fQ5t1iQ6P1qQ7X3cQ8r6SQ9c7WQ:^8qQ:p9bQ;Z:`Q;c:rQ;n;[R;q;dnqOXst!Z#d%m&r&t&u&w,s,x2[2_Q&l!VR,h&itmOXst!U!V!Z#d%m&i&r&t&u&w,s,x2[2_R,o&oT%lm,oR1k,XR,g&gQ&U|S+}&V&WR1^,OR+s&PT&p!W&sT&q!W&sT2^,x2_",nodeNames:"âš  ArithOp ArithOp ?. JSXStartTag LineComment BlockComment Script Hashbang ExportDeclaration export Star as VariableName String Escape from ; default FunctionDeclaration async function VariableDefinition > < TypeParamList in out const TypeDefinition extends ThisType this LiteralType ArithOp Number BooleanLiteral TemplateType InterpolationEnd Interpolation InterpolationStart NullType null VoidType void TypeofType typeof MemberExpression . PropertyName [ TemplateString Escape Interpolation super RegExp ] ArrayExpression Spread , } { ObjectExpression Property async get set PropertyDefinition Block : NewTarget new NewExpression ) ( ArgList UnaryExpression delete LogicOp BitOp YieldExpression yield AwaitExpression await ParenthesizedExpression ClassExpression class ClassBody MethodDeclaration Decorator @ MemberExpression PrivatePropertyName CallExpression TypeArgList CompareOp < declare Privacy static abstract override PrivatePropertyDefinition PropertyDeclaration readonly accessor Optional TypeAnnotation Equals StaticBlock FunctionExpression ArrowFunction ParamList ParamList ArrayPattern ObjectPattern PatternProperty Privacy readonly Arrow MemberExpression BinaryExpression ArithOp ArithOp ArithOp ArithOp BitOp CompareOp instanceof satisfies CompareOp BitOp BitOp BitOp LogicOp LogicOp ConditionalExpression LogicOp LogicOp AssignmentExpression UpdateOp PostfixExpression CallExpression InstantiationExpression TaggedTemplateExpression DynamicImport import ImportMeta JSXElement JSXSelfCloseEndTag JSXSelfClosingTag JSXIdentifier JSXBuiltin JSXIdentifier JSXNamespacedName JSXMemberExpression JSXSpreadAttribute JSXAttribute JSXAttributeValue JSXEscape JSXEndTag JSXOpenTag JSXFragmentTag JSXText JSXEscape JSXStartCloseTag JSXCloseTag PrefixCast < ArrowFunction TypeParamList SequenceExpression InstantiationExpression KeyofType keyof UniqueType unique ImportType InferredType infer TypeName ParenthesizedType FunctionSignature ParamList NewSignature IndexedType TupleType Label ArrayType ReadonlyType ObjectType MethodType PropertyType IndexSignature PropertyDefinition CallSignature TypePredicate asserts is NewSignature new UnionType LogicOp IntersectionType LogicOp ConditionalType ParameterizedType ClassDeclaration abstract implements type VariableDeclaration let var using TypeAliasDeclaration InterfaceDeclaration interface EnumDeclaration enum EnumBody NamespaceDeclaration namespace module AmbientDeclaration declare GlobalDeclaration global ClassDeclaration ClassBody AmbientFunctionDeclaration ExportGroup VariableName VariableName ImportDeclaration defer ImportGroup ForStatement for ForSpec ForInSpec ForOfSpec of WhileStatement while WithStatement with DoStatement do IfStatement if else SwitchStatement switch SwitchBody CaseLabel case DefaultLabel TryStatement try CatchClause catch FinallyClause finally ReturnStatement return ThrowStatement throw BreakStatement break ContinueStatement continue DebuggerStatement debugger LabeledStatement ExpressionStatement SingleExpression SingleClassItem",maxTerm:380,context:lC,nodeProps:[["isolate",-8,5,6,14,37,39,51,53,55,""],["group",-26,9,17,19,68,207,211,215,216,218,221,224,234,237,243,245,247,249,252,258,264,266,268,270,272,274,275,"Statement",-34,13,14,32,35,36,42,51,54,55,57,62,70,72,76,80,82,84,85,110,111,120,121,136,139,141,142,143,144,145,147,148,167,169,171,"Expression",-23,31,33,37,41,43,45,173,175,177,178,180,181,182,184,185,186,188,189,190,201,203,205,206,"Type",-3,88,103,109,"ClassItem"],["openedBy",23,"<",38,"InterpolationStart",56,"[",60,"{",73,"(",160,"JSXStartCloseTag"],["closedBy",-2,24,168,">",40,"InterpolationEnd",50,"]",61,"}",74,")",165,"JSXEndTag"]],propSources:[fC],skippedNodes:[0,5,6,278],repeatNodeCount:37,tokenData:"$Fq07[R!bOX%ZXY+gYZ-yZ[+g[]%Z]^.c^p%Zpq+gqr/mrs3cst:_tuEruvJSvwLkwx! Yxy!'iyz!(sz{!)}{|!,q|}!.O}!O!,q!O!P!/Y!P!Q!9j!Q!R#:O!R![#<_![!]#I_!]!^#Jk!^!_#Ku!_!`$![!`!a$$v!a!b$*T!b!c$,r!c!}Er!}#O$-|#O#P$/W#P#Q$4o#Q#R$5y#R#SEr#S#T$7W#T#o$8b#o#p$<r#p#q$=h#q#r$>x#r#s$@U#s$f%Z$f$g+g$g#BYEr#BY#BZ$A`#BZ$ISEr$IS$I_$A`$I_$I|Er$I|$I}$Dk$I}$JO$Dk$JO$JTEr$JT$JU$A`$JU$KVEr$KV$KW$A`$KW&FUEr&FU&FV$A`&FV;'SEr;'S;=`I|<%l?HTEr?HT?HU$A`?HUOEr(n%d_$i&j(Wp(Z!bOY%ZYZ&cZr%Zrs&}sw%Zwx(rx!^%Z!^!_*g!_#O%Z#O#P&c#P#o%Z#o#p*g#p;'S%Z;'S;=`+a<%lO%Z&j&hT$i&jO!^&c!_#o&c#p;'S&c;'S;=`&w<%lO&c&j&zP;=`<%l&c'|'U]$i&j(Z!bOY&}YZ&cZw&}wx&cx!^&}!^!_'}!_#O&}#O#P&c#P#o&}#o#p'}#p;'S&};'S;=`(l<%lO&}!b(SU(Z!bOY'}Zw'}x#O'}#P;'S'};'S;=`(f<%lO'}!b(iP;=`<%l'}'|(oP;=`<%l&}'[(y]$i&j(WpOY(rYZ&cZr(rrs&cs!^(r!^!_)r!_#O(r#O#P&c#P#o(r#o#p)r#p;'S(r;'S;=`*a<%lO(rp)wU(WpOY)rZr)rs#O)r#P;'S)r;'S;=`*Z<%lO)rp*^P;=`<%l)r'[*dP;=`<%l(r#S*nX(Wp(Z!bOY*gZr*grs'}sw*gwx)rx#O*g#P;'S*g;'S;=`+Z<%lO*g#S+^P;=`<%l*g(n+dP;=`<%l%Z07[+rq$i&j(Wp(Z!b'|0/lOX%ZXY+gYZ&cZ[+g[p%Zpq+gqr%Zrs&}sw%Zwx(rx!^%Z!^!_*g!_#O%Z#O#P&c#P#o%Z#o#p*g#p$f%Z$f$g+g$g#BY%Z#BY#BZ+g#BZ$IS%Z$IS$I_+g$I_$JT%Z$JT$JU+g$JU$KV%Z$KV$KW+g$KW&FU%Z&FU&FV+g&FV;'S%Z;'S;=`+a<%l?HT%Z?HT?HU+g?HUO%Z07[.ST(X#S$i&j'}0/lO!^&c!_#o&c#p;'S&c;'S;=`&w<%lO&c07[.n_$i&j(Wp(Z!b'}0/lOY%ZYZ&cZr%Zrs&}sw%Zwx(rx!^%Z!^!_*g!_#O%Z#O#P&c#P#o%Z#o#p*g#p;'S%Z;'S;=`+a<%lO%Z)3p/x`$i&j!p),Q(Wp(Z!bOY%ZYZ&cZr%Zrs&}sw%Zwx(rx!^%Z!^!_*g!_!`0z!`#O%Z#O#P&c#P#o%Z#o#p*g#p;'S%Z;'S;=`+a<%lO%Z(KW1V`#v(Ch$i&j(Wp(Z!bOY%ZYZ&cZr%Zrs&}sw%Zwx(rx!^%Z!^!_*g!_!`2X!`#O%Z#O#P&c#P#o%Z#o#p*g#p;'S%Z;'S;=`+a<%lO%Z(KW2d_#v(Ch$i&j(Wp(Z!bOY%ZYZ&cZr%Zrs&}sw%Zwx(rx!^%Z!^!_*g!_#O%Z#O#P&c#P#o%Z#o#p*g#p;'S%Z;'S;=`+a<%lO%Z'At3l_(V':f$i&j(Z!bOY4kYZ5qZr4krs7nsw4kwx5qx!^4k!^!_8p!_#O4k#O#P5q#P#o4k#o#p8p#p;'S4k;'S;=`:X<%lO4k(^4r_$i&j(Z!bOY4kYZ5qZr4krs7nsw4kwx5qx!^4k!^!_8p!_#O4k#O#P5q#P#o4k#o#p8p#p;'S4k;'S;=`:X<%lO4k&z5vX$i&jOr5qrs6cs!^5q!^!_6y!_#o5q#o#p6y#p;'S5q;'S;=`7h<%lO5q&z6jT$d`$i&jO!^&c!_#o&c#p;'S&c;'S;=`&w<%lO&c`6|TOr6yrs7]s;'S6y;'S;=`7b<%lO6y`7bO$d``7eP;=`<%l6y&z7kP;=`<%l5q(^7w]$d`$i&j(Z!bOY&}YZ&cZw&}wx&cx!^&}!^!_'}!_#O&}#O#P&c#P#o&}#o#p'}#p;'S&};'S;=`(l<%lO&}!r8uZ(Z!bOY8pYZ6yZr8prs9hsw8pwx6yx#O8p#O#P6y#P;'S8p;'S;=`:R<%lO8p!r9oU$d`(Z!bOY'}Zw'}x#O'}#P;'S'};'S;=`(f<%lO'}!r:UP;=`<%l8p(^:[P;=`<%l4k%9[:hh$i&j(Wp(Z!bOY%ZYZ&cZq%Zqr<Srs&}st%ZtuCruw%Zwx(rx!^%Z!^!_*g!_!c%Z!c!}Cr!}#O%Z#O#P&c#P#R%Z#R#SCr#S#T%Z#T#oCr#o#p*g#p$g%Z$g;'SCr;'S;=`El<%lOCr(r<__WS$i&j(Wp(Z!bOY<SYZ&cZr<Srs=^sw<Swx@nx!^<S!^!_Bm!_#O<S#O#P>`#P#o<S#o#pBm#p;'S<S;'S;=`Cl<%lO<S(Q=g]WS$i&j(Z!bOY=^YZ&cZw=^wx>`x!^=^!^!_?q!_#O=^#O#P>`#P#o=^#o#p?q#p;'S=^;'S;=`@h<%lO=^&n>gXWS$i&jOY>`YZ&cZ!^>`!^!_?S!_#o>`#o#p?S#p;'S>`;'S;=`?k<%lO>`S?XSWSOY?SZ;'S?S;'S;=`?e<%lO?SS?hP;=`<%l?S&n?nP;=`<%l>`!f?xWWS(Z!bOY?qZw?qwx?Sx#O?q#O#P?S#P;'S?q;'S;=`@b<%lO?q!f@eP;=`<%l?q(Q@kP;=`<%l=^'`@w]WS$i&j(WpOY@nYZ&cZr@nrs>`s!^@n!^!_Ap!_#O@n#O#P>`#P#o@n#o#pAp#p;'S@n;'S;=`Bg<%lO@ntAwWWS(WpOYApZrAprs?Ss#OAp#O#P?S#P;'SAp;'S;=`Ba<%lOAptBdP;=`<%lAp'`BjP;=`<%l@n#WBvYWS(Wp(Z!bOYBmZrBmrs?qswBmwxApx#OBm#O#P?S#P;'SBm;'S;=`Cf<%lOBm#WCiP;=`<%lBm(rCoP;=`<%l<S%9[C}i$i&j(o%1l(Wp(Z!bOY%ZYZ&cZr%Zrs&}st%ZtuCruw%Zwx(rx!Q%Z!Q![Cr![!^%Z!^!_*g!_!c%Z!c!}Cr!}#O%Z#O#P&c#P#R%Z#R#SCr#S#T%Z#T#oCr#o#p*g#p$g%Z$g;'SCr;'S;=`El<%lOCr%9[EoP;=`<%lCr07[FRk$i&j(Wp(Z!b$]#t(T,2j(e$I[OY%ZYZ&cZr%Zrs&}st%ZtuEruw%Zwx(rx}%Z}!OGv!O!Q%Z!Q![Er![!^%Z!^!_*g!_!c%Z!c!}Er!}#O%Z#O#P&c#P#R%Z#R#SEr#S#T%Z#T#oEr#o#p*g#p$g%Z$g;'SEr;'S;=`I|<%lOEr+dHRk$i&j(Wp(Z!b$]#tOY%ZYZ&cZr%Zrs&}st%ZtuGvuw%Zwx(rx}%Z}!OGv!O!Q%Z!Q![Gv![!^%Z!^!_*g!_!c%Z!c!}Gv!}#O%Z#O#P&c#P#R%Z#R#SGv#S#T%Z#T#oGv#o#p*g#p$g%Z$g;'SGv;'S;=`Iv<%lOGv+dIyP;=`<%lGv07[JPP;=`<%lEr(KWJ_`$i&j(Wp(Z!b#p(ChOY%ZYZ&cZr%Zrs&}sw%Zwx(rx!^%Z!^!_*g!_!`Ka!`#O%Z#O#P&c#P#o%Z#o#p*g#p;'S%Z;'S;=`+a<%lO%Z(KWKl_$i&j$Q(Ch(Wp(Z!bOY%ZYZ&cZr%Zrs&}sw%Zwx(rx!^%Z!^!_*g!_#O%Z#O#P&c#P#o%Z#o#p*g#p;'S%Z;'S;=`+a<%lO%Z,#xLva(z+JY$i&j(Wp(Z!bOY%ZYZ&cZr%Zrs&}sv%ZvwM{wx(rx!^%Z!^!_*g!_!`Ka!`#O%Z#O#P&c#P#o%Z#o#p*g#p;'S%Z;'S;=`+a<%lO%Z(KWNW`$i&j#z(Ch(Wp(Z!bOY%ZYZ&cZr%Zrs&}sw%Zwx(rx!^%Z!^!_*g!_!`Ka!`#O%Z#O#P&c#P#o%Z#o#p*g#p;'S%Z;'S;=`+a<%lO%Z'At! c_(Y';W$i&j(WpOY!!bYZ!#hZr!!brs!#hsw!!bwx!$xx!^!!b!^!_!%z!_#O!!b#O#P!#h#P#o!!b#o#p!%z#p;'S!!b;'S;=`!'c<%lO!!b'l!!i_$i&j(WpOY!!bYZ!#hZr!!brs!#hsw!!bwx!$xx!^!!b!^!_!%z!_#O!!b#O#P!#h#P#o!!b#o#p!%z#p;'S!!b;'S;=`!'c<%lO!!b&z!#mX$i&jOw!#hwx6cx!^!#h!^!_!$Y!_#o!#h#o#p!$Y#p;'S!#h;'S;=`!$r<%lO!#h`!$]TOw!$Ywx7]x;'S!$Y;'S;=`!$l<%lO!$Y`!$oP;=`<%l!$Y&z!$uP;=`<%l!#h'l!%R]$d`$i&j(WpOY(rYZ&cZr(rrs&cs!^(r!^!_)r!_#O(r#O#P&c#P#o(r#o#p)r#p;'S(r;'S;=`*a<%lO(r!Q!&PZ(WpOY!%zYZ!$YZr!%zrs!$Ysw!%zwx!&rx#O!%z#O#P!$Y#P;'S!%z;'S;=`!']<%lO!%z!Q!&yU$d`(WpOY)rZr)rs#O)r#P;'S)r;'S;=`*Z<%lO)r!Q!'`P;=`<%l!%z'l!'fP;=`<%l!!b/5|!'t_!l/.^$i&j(Wp(Z!bOY%ZYZ&cZr%Zrs&}sw%Zwx(rx!^%Z!^!_*g!_#O%Z#O#P&c#P#o%Z#o#p*g#p;'S%Z;'S;=`+a<%lO%Z#&U!)O_!k!Lf$i&j(Wp(Z!bOY%ZYZ&cZr%Zrs&}sw%Zwx(rx!^%Z!^!_*g!_#O%Z#O#P&c#P#o%Z#o#p*g#p;'S%Z;'S;=`+a<%lO%Z-!n!*[b$i&j(Wp(Z!b(U%&f#q(ChOY%ZYZ&cZr%Zrs&}sw%Zwx(rxz%Zz{!+d{!^%Z!^!_*g!_!`Ka!`#O%Z#O#P&c#P#o%Z#o#p*g#p;'S%Z;'S;=`+a<%lO%Z(KW!+o`$i&j(Wp(Z!b#n(ChOY%ZYZ&cZr%Zrs&}sw%Zwx(rx!^%Z!^!_*g!_!`Ka!`#O%Z#O#P&c#P#o%Z#o#p*g#p;'S%Z;'S;=`+a<%lO%Z+;x!,|`$i&j(Wp(Z!br+4YOY%ZYZ&cZr%Zrs&}sw%Zwx(rx!^%Z!^!_*g!_!`Ka!`#O%Z#O#P&c#P#o%Z#o#p*g#p;'S%Z;'S;=`+a<%lO%Z,$U!.Z_!]+Jf$i&j(Wp(Z!bOY%ZYZ&cZr%Zrs&}sw%Zwx(rx!^%Z!^!_*g!_#O%Z#O#P&c#P#o%Z#o#p*g#p;'S%Z;'S;=`+a<%lO%Z07[!/ec$i&j(Wp(Z!b!Q.2^OY%ZYZ&cZr%Zrs&}sw%Zwx(rx!O%Z!O!P!0p!P!Q%Z!Q![!3Y![!^%Z!^!_*g!_#O%Z#O#P&c#P#o%Z#o#p*g#p;'S%Z;'S;=`+a<%lO%Z#%|!0ya$i&j(Wp(Z!bOY%ZYZ&cZr%Zrs&}sw%Zwx(rx!O%Z!O!P!2O!P!^%Z!^!_*g!_#O%Z#O#P&c#P#o%Z#o#p*g#p;'S%Z;'S;=`+a<%lO%Z#%|!2Z_![!L^$i&j(Wp(Z!bOY%ZYZ&cZr%Zrs&}sw%Zwx(rx!^%Z!^!_*g!_#O%Z#O#P&c#P#o%Z#o#p*g#p;'S%Z;'S;=`+a<%lO%Z'Ad!3eg$i&j(Wp(Z!bs'9tOY%ZYZ&cZr%Zrs&}sw%Zwx(rx!Q%Z!Q![!3Y![!^%Z!^!_*g!_!g%Z!g!h!4|!h#O%Z#O#P&c#P#R%Z#R#S!3Y#S#X%Z#X#Y!4|#Y#o%Z#o#p*g#p;'S%Z;'S;=`+a<%lO%Z'Ad!5Vg$i&j(Wp(Z!bOY%ZYZ&cZr%Zrs&}sw%Zwx(rx{%Z{|!6n|}%Z}!O!6n!O!Q%Z!Q![!8S![!^%Z!^!_*g!_#O%Z#O#P&c#P#R%Z#R#S!8S#S#o%Z#o#p*g#p;'S%Z;'S;=`+a<%lO%Z'Ad!6wc$i&j(Wp(Z!bOY%ZYZ&cZr%Zrs&}sw%Zwx(rx!Q%Z!Q![!8S![!^%Z!^!_*g!_#O%Z#O#P&c#P#R%Z#R#S!8S#S#o%Z#o#p*g#p;'S%Z;'S;=`+a<%lO%Z'Ad!8_c$i&j(Wp(Z!bs'9tOY%ZYZ&cZr%Zrs&}sw%Zwx(rx!Q%Z!Q![!8S![!^%Z!^!_*g!_#O%Z#O#P&c#P#R%Z#R#S!8S#S#o%Z#o#p*g#p;'S%Z;'S;=`+a<%lO%Z07[!9uf$i&j(Wp(Z!b#o(ChOY!;ZYZ&cZr!;Zrs!<nsw!;Zwx!Lcxz!;Zz{#-}{!P!;Z!P!Q#/d!Q!^!;Z!^!_#(i!_!`#7S!`!a#8i!a!}!;Z!}#O#,f#O#P!Dy#P#o!;Z#o#p#(i#p;'S!;Z;'S;=`#-w<%lO!;Z?O!;fb$i&j(Wp(Z!b!X7`OY!;ZYZ&cZr!;Zrs!<nsw!;Zwx!Lcx!P!;Z!P!Q#&`!Q!^!;Z!^!_#(i!_!}!;Z!}#O#,f#O#P!Dy#P#o!;Z#o#p#(i#p;'S!;Z;'S;=`#-w<%lO!;Z>^!<w`$i&j(Z!b!X7`OY!<nYZ&cZw!<nwx!=yx!P!<n!P!Q!Eq!Q!^!<n!^!_!Gr!_!}!<n!}#O!KS#O#P!Dy#P#o!<n#o#p!Gr#p;'S!<n;'S;=`!L]<%lO!<n<z!>Q^$i&j!X7`OY!=yYZ&cZ!P!=y!P!Q!>|!Q!^!=y!^!_!@c!_!}!=y!}#O!CW#O#P!Dy#P#o!=y#o#p!@c#p;'S!=y;'S;=`!Ek<%lO!=y<z!?Td$i&j!X7`O!^&c!_#W&c#W#X!>|#X#Z&c#Z#[!>|#[#]&c#]#^!>|#^#a&c#a#b!>|#b#g&c#g#h!>|#h#i&c#i#j!>|#j#k!>|#k#m&c#m#n!>|#n#o&c#p;'S&c;'S;=`&w<%lO&c7`!@hX!X7`OY!@cZ!P!@c!P!Q!AT!Q!}!@c!}#O!Ar#O#P!Bq#P;'S!@c;'S;=`!CQ<%lO!@c7`!AYW!X7`#W#X!AT#Z#[!AT#]#^!AT#a#b!AT#g#h!AT#i#j!AT#j#k!AT#m#n!AT7`!AuVOY!ArZ#O!Ar#O#P!B[#P#Q!@c#Q;'S!Ar;'S;=`!Bk<%lO!Ar7`!B_SOY!ArZ;'S!Ar;'S;=`!Bk<%lO!Ar7`!BnP;=`<%l!Ar7`!BtSOY!@cZ;'S!@c;'S;=`!CQ<%lO!@c7`!CTP;=`<%l!@c<z!C][$i&jOY!CWYZ&cZ!^!CW!^!_!Ar!_#O!CW#O#P!DR#P#Q!=y#Q#o!CW#o#p!Ar#p;'S!CW;'S;=`!Ds<%lO!CW<z!DWX$i&jOY!CWYZ&cZ!^!CW!^!_!Ar!_#o!CW#o#p!Ar#p;'S!CW;'S;=`!Ds<%lO!CW<z!DvP;=`<%l!CW<z!EOX$i&jOY!=yYZ&cZ!^!=y!^!_!@c!_#o!=y#o#p!@c#p;'S!=y;'S;=`!Ek<%lO!=y<z!EnP;=`<%l!=y>^!Ezl$i&j(Z!b!X7`OY&}YZ&cZw&}wx&cx!^&}!^!_'}!_#O&}#O#P&c#P#W&}#W#X!Eq#X#Z&}#Z#[!Eq#[#]&}#]#^!Eq#^#a&}#a#b!Eq#b#g&}#g#h!Eq#h#i&}#i#j!Eq#j#k!Eq#k#m&}#m#n!Eq#n#o&}#o#p'}#p;'S&};'S;=`(l<%lO&}8r!GyZ(Z!b!X7`OY!GrZw!Grwx!@cx!P!Gr!P!Q!Hl!Q!}!Gr!}#O!JU#O#P!Bq#P;'S!Gr;'S;=`!J|<%lO!Gr8r!Hse(Z!b!X7`OY'}Zw'}x#O'}#P#W'}#W#X!Hl#X#Z'}#Z#[!Hl#[#]'}#]#^!Hl#^#a'}#a#b!Hl#b#g'}#g#h!Hl#h#i'}#i#j!Hl#j#k!Hl#k#m'}#m#n!Hl#n;'S'};'S;=`(f<%lO'}8r!JZX(Z!bOY!JUZw!JUwx!Arx#O!JU#O#P!B[#P#Q!Gr#Q;'S!JU;'S;=`!Jv<%lO!JU8r!JyP;=`<%l!JU8r!KPP;=`<%l!Gr>^!KZ^$i&j(Z!bOY!KSYZ&cZw!KSwx!CWx!^!KS!^!_!JU!_#O!KS#O#P!DR#P#Q!<n#Q#o!KS#o#p!JU#p;'S!KS;'S;=`!LV<%lO!KS>^!LYP;=`<%l!KS>^!L`P;=`<%l!<n=l!Ll`$i&j(Wp!X7`OY!LcYZ&cZr!Lcrs!=ys!P!Lc!P!Q!Mn!Q!^!Lc!^!_# o!_!}!Lc!}#O#%P#O#P!Dy#P#o!Lc#o#p# o#p;'S!Lc;'S;=`#&Y<%lO!Lc=l!Mwl$i&j(Wp!X7`OY(rYZ&cZr(rrs&cs!^(r!^!_)r!_#O(r#O#P&c#P#W(r#W#X!Mn#X#Z(r#Z#[!Mn#[#](r#]#^!Mn#^#a(r#a#b!Mn#b#g(r#g#h!Mn#h#i(r#i#j!Mn#j#k!Mn#k#m(r#m#n!Mn#n#o(r#o#p)r#p;'S(r;'S;=`*a<%lO(r8Q# vZ(Wp!X7`OY# oZr# ors!@cs!P# o!P!Q#!i!Q!}# o!}#O#$R#O#P!Bq#P;'S# o;'S;=`#$y<%lO# o8Q#!pe(Wp!X7`OY)rZr)rs#O)r#P#W)r#W#X#!i#X#Z)r#Z#[#!i#[#])r#]#^#!i#^#a)r#a#b#!i#b#g)r#g#h#!i#h#i)r#i#j#!i#j#k#!i#k#m)r#m#n#!i#n;'S)r;'S;=`*Z<%lO)r8Q#$WX(WpOY#$RZr#$Rrs!Ars#O#$R#O#P!B[#P#Q# o#Q;'S#$R;'S;=`#$s<%lO#$R8Q#$vP;=`<%l#$R8Q#$|P;=`<%l# o=l#%W^$i&j(WpOY#%PYZ&cZr#%Prs!CWs!^#%P!^!_#$R!_#O#%P#O#P!DR#P#Q!Lc#Q#o#%P#o#p#$R#p;'S#%P;'S;=`#&S<%lO#%P=l#&VP;=`<%l#%P=l#&]P;=`<%l!Lc?O#&kn$i&j(Wp(Z!b!X7`OY%ZYZ&cZr%Zrs&}sw%Zwx(rx!^%Z!^!_*g!_#O%Z#O#P&c#P#W%Z#W#X#&`#X#Z%Z#Z#[#&`#[#]%Z#]#^#&`#^#a%Z#a#b#&`#b#g%Z#g#h#&`#h#i%Z#i#j#&`#j#k#&`#k#m%Z#m#n#&`#n#o%Z#o#p*g#p;'S%Z;'S;=`+a<%lO%Z9d#(r](Wp(Z!b!X7`OY#(iZr#(irs!Grsw#(iwx# ox!P#(i!P!Q#)k!Q!}#(i!}#O#+`#O#P!Bq#P;'S#(i;'S;=`#,`<%lO#(i9d#)th(Wp(Z!b!X7`OY*gZr*grs'}sw*gwx)rx#O*g#P#W*g#W#X#)k#X#Z*g#Z#[#)k#[#]*g#]#^#)k#^#a*g#a#b#)k#b#g*g#g#h#)k#h#i*g#i#j#)k#j#k#)k#k#m*g#m#n#)k#n;'S*g;'S;=`+Z<%lO*g9d#+gZ(Wp(Z!bOY#+`Zr#+`rs!JUsw#+`wx#$Rx#O#+`#O#P!B[#P#Q#(i#Q;'S#+`;'S;=`#,Y<%lO#+`9d#,]P;=`<%l#+`9d#,cP;=`<%l#(i?O#,o`$i&j(Wp(Z!bOY#,fYZ&cZr#,frs!KSsw#,fwx#%Px!^#,f!^!_#+`!_#O#,f#O#P!DR#P#Q!;Z#Q#o#,f#o#p#+`#p;'S#,f;'S;=`#-q<%lO#,f?O#-tP;=`<%l#,f?O#-zP;=`<%l!;Z07[#.[b$i&j(Wp(Z!b(O0/l!X7`OY!;ZYZ&cZr!;Zrs!<nsw!;Zwx!Lcx!P!;Z!P!Q#&`!Q!^!;Z!^!_#(i!_!}!;Z!}#O#,f#O#P!Dy#P#o!;Z#o#p#(i#p;'S!;Z;'S;=`#-w<%lO!;Z07[#/o_$i&j(Wp(Z!bT0/lOY#/dYZ&cZr#/drs#0nsw#/dwx#4Ox!^#/d!^!_#5}!_#O#/d#O#P#1p#P#o#/d#o#p#5}#p;'S#/d;'S;=`#6|<%lO#/d06j#0w]$i&j(Z!bT0/lOY#0nYZ&cZw#0nwx#1px!^#0n!^!_#3R!_#O#0n#O#P#1p#P#o#0n#o#p#3R#p;'S#0n;'S;=`#3x<%lO#0n05W#1wX$i&jT0/lOY#1pYZ&cZ!^#1p!^!_#2d!_#o#1p#o#p#2d#p;'S#1p;'S;=`#2{<%lO#1p0/l#2iST0/lOY#2dZ;'S#2d;'S;=`#2u<%lO#2d0/l#2xP;=`<%l#2d05W#3OP;=`<%l#1p01O#3YW(Z!bT0/lOY#3RZw#3Rwx#2dx#O#3R#O#P#2d#P;'S#3R;'S;=`#3r<%lO#3R01O#3uP;=`<%l#3R06j#3{P;=`<%l#0n05x#4X]$i&j(WpT0/lOY#4OYZ&cZr#4Ors#1ps!^#4O!^!_#5Q!_#O#4O#O#P#1p#P#o#4O#o#p#5Q#p;'S#4O;'S;=`#5w<%lO#4O00^#5XW(WpT0/lOY#5QZr#5Qrs#2ds#O#5Q#O#P#2d#P;'S#5Q;'S;=`#5q<%lO#5Q00^#5tP;=`<%l#5Q05x#5zP;=`<%l#4O01p#6WY(Wp(Z!bT0/lOY#5}Zr#5}rs#3Rsw#5}wx#5Qx#O#5}#O#P#2d#P;'S#5};'S;=`#6v<%lO#5}01p#6yP;=`<%l#5}07[#7PP;=`<%l#/d)3h#7ab$i&j$Q(Ch(Wp(Z!b!X7`OY!;ZYZ&cZr!;Zrs!<nsw!;Zwx!Lcx!P!;Z!P!Q#&`!Q!^!;Z!^!_#(i!_!}!;Z!}#O#,f#O#P!Dy#P#o!;Z#o#p#(i#p;'S!;Z;'S;=`#-w<%lO!;ZAt#8vb$Z#t$i&j(Wp(Z!b!X7`OY!;ZYZ&cZr!;Zrs!<nsw!;Zwx!Lcx!P!;Z!P!Q#&`!Q!^!;Z!^!_#(i!_!}!;Z!}#O#,f#O#P!Dy#P#o!;Z#o#p#(i#p;'S!;Z;'S;=`#-w<%lO!;Z'Ad#:Zp$i&j(Wp(Z!bs'9tOY%ZYZ&cZr%Zrs&}sw%Zwx(rx!O%Z!O!P!3Y!P!Q%Z!Q![#<_![!^%Z!^!_*g!_!g%Z!g!h!4|!h#O%Z#O#P&c#P#R%Z#R#S#<_#S#U%Z#U#V#?i#V#X%Z#X#Y!4|#Y#b%Z#b#c#>_#c#d#Bq#d#l%Z#l#m#Es#m#o%Z#o#p*g#p;'S%Z;'S;=`+a<%lO%Z'Ad#<jk$i&j(Wp(Z!bs'9tOY%ZYZ&cZr%Zrs&}sw%Zwx(rx!O%Z!O!P!3Y!P!Q%Z!Q![#<_![!^%Z!^!_*g!_!g%Z!g!h!4|!h#O%Z#O#P&c#P#R%Z#R#S#<_#S#X%Z#X#Y!4|#Y#b%Z#b#c#>_#c#o%Z#o#p*g#p;'S%Z;'S;=`+a<%lO%Z'Ad#>j_$i&j(Wp(Z!bs'9tOY%ZYZ&cZr%Zrs&}sw%Zwx(rx!^%Z!^!_*g!_#O%Z#O#P&c#P#o%Z#o#p*g#p;'S%Z;'S;=`+a<%lO%Z'Ad#?rd$i&j(Wp(Z!bOY%ZYZ&cZr%Zrs&}sw%Zwx(rx!Q%Z!Q!R#AQ!R!S#AQ!S!^%Z!^!_*g!_#O%Z#O#P&c#P#R%Z#R#S#AQ#S#o%Z#o#p*g#p;'S%Z;'S;=`+a<%lO%Z'Ad#A]f$i&j(Wp(Z!bs'9tOY%ZYZ&cZr%Zrs&}sw%Zwx(rx!Q%Z!Q!R#AQ!R!S#AQ!S!^%Z!^!_*g!_#O%Z#O#P&c#P#R%Z#R#S#AQ#S#b%Z#b#c#>_#c#o%Z#o#p*g#p;'S%Z;'S;=`+a<%lO%Z'Ad#Bzc$i&j(Wp(Z!bOY%ZYZ&cZr%Zrs&}sw%Zwx(rx!Q%Z!Q!Y#DV!Y!^%Z!^!_*g!_#O%Z#O#P&c#P#R%Z#R#S#DV#S#o%Z#o#p*g#p;'S%Z;'S;=`+a<%lO%Z'Ad#Dbe$i&j(Wp(Z!bs'9tOY%ZYZ&cZr%Zrs&}sw%Zwx(rx!Q%Z!Q!Y#DV!Y!^%Z!^!_*g!_#O%Z#O#P&c#P#R%Z#R#S#DV#S#b%Z#b#c#>_#c#o%Z#o#p*g#p;'S%Z;'S;=`+a<%lO%Z'Ad#E|g$i&j(Wp(Z!bOY%ZYZ&cZr%Zrs&}sw%Zwx(rx!Q%Z!Q![#Ge![!^%Z!^!_*g!_!c%Z!c!i#Ge!i#O%Z#O#P&c#P#R%Z#R#S#Ge#S#T%Z#T#Z#Ge#Z#o%Z#o#p*g#p;'S%Z;'S;=`+a<%lO%Z'Ad#Gpi$i&j(Wp(Z!bs'9tOY%ZYZ&cZr%Zrs&}sw%Zwx(rx!Q%Z!Q![#Ge![!^%Z!^!_*g!_!c%Z!c!i#Ge!i#O%Z#O#P&c#P#R%Z#R#S#Ge#S#T%Z#T#Z#Ge#Z#b%Z#b#c#>_#c#o%Z#o#p*g#p;'S%Z;'S;=`+a<%lO%Z*)x#Il_!g$b$i&j$O)Lv(Wp(Z!bOY%ZYZ&cZr%Zrs&}sw%Zwx(rx!^%Z!^!_*g!_#O%Z#O#P&c#P#o%Z#o#p*g#p;'S%Z;'S;=`+a<%lO%Z)[#Jv_al$i&j(Wp(Z!bOY%ZYZ&cZr%Zrs&}sw%Zwx(rx!^%Z!^!_*g!_#O%Z#O#P&c#P#o%Z#o#p*g#p;'S%Z;'S;=`+a<%lO%Z04f#LS^h#)`#R-<U(Wp(Z!b$n7`OY*gZr*grs'}sw*gwx)rx!P*g!P!Q#MO!Q!^*g!^!_#Mt!_!`$ f!`#O*g#P;'S*g;'S;=`+Z<%lO*g(n#MXX$k&j(Wp(Z!bOY*gZr*grs'}sw*gwx)rx#O*g#P;'S*g;'S;=`+Z<%lO*g(El#M}Z#r(Ch(Wp(Z!bOY*gZr*grs'}sw*gwx)rx!_*g!_!`#Np!`#O*g#P;'S*g;'S;=`+Z<%lO*g(El#NyX$Q(Ch(Wp(Z!bOY*gZr*grs'}sw*gwx)rx#O*g#P;'S*g;'S;=`+Z<%lO*g(El$ oX#s(Ch(Wp(Z!bOY*gZr*grs'}sw*gwx)rx#O*g#P;'S*g;'S;=`+Z<%lO*g*)x$!ga#`*!Y$i&j(Wp(Z!bOY%ZYZ&cZr%Zrs&}sw%Zwx(rx!^%Z!^!_*g!_!`0z!`!a$#l!a#O%Z#O#P&c#P#o%Z#o#p*g#p;'S%Z;'S;=`+a<%lO%Z(K[$#w_#k(Cl$i&j(Wp(Z!bOY%ZYZ&cZr%Zrs&}sw%Zwx(rx!^%Z!^!_*g!_#O%Z#O#P&c#P#o%Z#o#p*g#p;'S%Z;'S;=`+a<%lO%Z*)x$%Vag!*r#s(Ch$f#|$i&j(Wp(Z!bOY%ZYZ&cZr%Zrs&}sw%Zwx(rx!^%Z!^!_*g!_!`$&[!`!a$'f!a#O%Z#O#P&c#P#o%Z#o#p*g#p;'S%Z;'S;=`+a<%lO%Z(KW$&g_#s(Ch$i&j(Wp(Z!bOY%ZYZ&cZr%Zrs&}sw%Zwx(rx!^%Z!^!_*g!_#O%Z#O#P&c#P#o%Z#o#p*g#p;'S%Z;'S;=`+a<%lO%Z(KW$'qa#r(Ch$i&j(Wp(Z!bOY%ZYZ&cZr%Zrs&}sw%Zwx(rx!^%Z!^!_*g!_!`Ka!`!a$(v!a#O%Z#O#P&c#P#o%Z#o#p*g#p;'S%Z;'S;=`+a<%lO%Z(KW$)R`#r(Ch$i&j(Wp(Z!bOY%ZYZ&cZr%Zrs&}sw%Zwx(rx!^%Z!^!_*g!_!`Ka!`#O%Z#O#P&c#P#o%Z#o#p*g#p;'S%Z;'S;=`+a<%lO%Z(Kd$*`a(r(Ct$i&j(Wp(Z!bOY%ZYZ&cZr%Zrs&}sw%Zwx(rx!^%Z!^!_*g!_!a%Z!a!b$+e!b#O%Z#O#P&c#P#o%Z#o#p*g#p;'S%Z;'S;=`+a<%lO%Z(KW$+p`$i&j#{(Ch(Wp(Z!bOY%ZYZ&cZr%Zrs&}sw%Zwx(rx!^%Z!^!_*g!_!`Ka!`#O%Z#O#P&c#P#o%Z#o#p*g#p;'S%Z;'S;=`+a<%lO%Z%#`$,}_!|$Ip$i&j(Wp(Z!bOY%ZYZ&cZr%Zrs&}sw%Zwx(rx!^%Z!^!_*g!_#O%Z#O#P&c#P#o%Z#o#p*g#p;'S%Z;'S;=`+a<%lO%Z04f$.X_!S0,v$i&j(Wp(Z!bOY%ZYZ&cZr%Zrs&}sw%Zwx(rx!^%Z!^!_*g!_#O%Z#O#P&c#P#o%Z#o#p*g#p;'S%Z;'S;=`+a<%lO%Z(n$/]Z$i&jO!^$0O!^!_$0f!_#i$0O#i#j$0k#j#l$0O#l#m$2^#m#o$0O#o#p$0f#p;'S$0O;'S;=`$4i<%lO$0O(n$0VT_#S$i&jO!^&c!_#o&c#p;'S&c;'S;=`&w<%lO&c#S$0kO_#S(n$0p[$i&jO!Q&c!Q![$1f![!^&c!_!c&c!c!i$1f!i#T&c#T#Z$1f#Z#o&c#o#p$3|#p;'S&c;'S;=`&w<%lO&c(n$1kZ$i&jO!Q&c!Q![$2^![!^&c!_!c&c!c!i$2^!i#T&c#T#Z$2^#Z#o&c#p;'S&c;'S;=`&w<%lO&c(n$2cZ$i&jO!Q&c!Q![$3U![!^&c!_!c&c!c!i$3U!i#T&c#T#Z$3U#Z#o&c#p;'S&c;'S;=`&w<%lO&c(n$3ZZ$i&jO!Q&c!Q![$0O![!^&c!_!c&c!c!i$0O!i#T&c#T#Z$0O#Z#o&c#p;'S&c;'S;=`&w<%lO&c#S$4PR!Q![$4Y!c!i$4Y#T#Z$4Y#S$4]S!Q![$4Y!c!i$4Y#T#Z$4Y#q#r$0f(n$4lP;=`<%l$0O#1[$4z_!Y#)l$i&j(Wp(Z!bOY%ZYZ&cZr%Zrs&}sw%Zwx(rx!^%Z!^!_*g!_#O%Z#O#P&c#P#o%Z#o#p*g#p;'S%Z;'S;=`+a<%lO%Z(KW$6U`#x(Ch$i&j(Wp(Z!bOY%ZYZ&cZr%Zrs&}sw%Zwx(rx!^%Z!^!_*g!_!`Ka!`#O%Z#O#P&c#P#o%Z#o#p*g#p;'S%Z;'S;=`+a<%lO%Z+;p$7c_$i&j(Wp(Z!b(a+4QOY%ZYZ&cZr%Zrs&}sw%Zwx(rx!^%Z!^!_*g!_#O%Z#O#P&c#P#o%Z#o#p*g#p;'S%Z;'S;=`+a<%lO%Z07[$8qk$i&j(Wp(Z!b(T,2j$_#t(e$I[OY%ZYZ&cZr%Zrs&}st%Ztu$8buw%Zwx(rx}%Z}!O$:f!O!Q%Z!Q![$8b![!^%Z!^!_*g!_!c%Z!c!}$8b!}#O%Z#O#P&c#P#R%Z#R#S$8b#S#T%Z#T#o$8b#o#p*g#p$g%Z$g;'S$8b;'S;=`$<l<%lO$8b+d$:qk$i&j(Wp(Z!b$_#tOY%ZYZ&cZr%Zrs&}st%Ztu$:fuw%Zwx(rx}%Z}!O$:f!O!Q%Z!Q![$:f![!^%Z!^!_*g!_!c%Z!c!}$:f!}#O%Z#O#P&c#P#R%Z#R#S$:f#S#T%Z#T#o$:f#o#p*g#p$g%Z$g;'S$:f;'S;=`$<f<%lO$:f+d$<iP;=`<%l$:f07[$<oP;=`<%l$8b#Jf$<{X!_#Hb(Wp(Z!bOY*gZr*grs'}sw*gwx)rx#O*g#P;'S*g;'S;=`+Z<%lO*g,#x$=sa(y+JY$i&j(Wp(Z!bOY%ZYZ&cZr%Zrs&}sw%Zwx(rx!^%Z!^!_*g!_!`Ka!`#O%Z#O#P&c#P#o%Z#o#p*g#p#q$+e#q;'S%Z;'S;=`+a<%lO%Z)>v$?V_!^(CdvBr$i&j(Wp(Z!bOY%ZYZ&cZr%Zrs&}sw%Zwx(rx!^%Z!^!_*g!_#O%Z#O#P&c#P#o%Z#o#p*g#p;'S%Z;'S;=`+a<%lO%Z?O$@a_!q7`$i&j(Wp(Z!bOY%ZYZ&cZr%Zrs&}sw%Zwx(rx!^%Z!^!_*g!_#O%Z#O#P&c#P#o%Z#o#p*g#p;'S%Z;'S;=`+a<%lO%Z07[$Aq|$i&j(Wp(Z!b'|0/l$]#t(T,2j(e$I[OX%ZXY+gYZ&cZ[+g[p%Zpq+gqr%Zrs&}st%ZtuEruw%Zwx(rx}%Z}!OGv!O!Q%Z!Q![Er![!^%Z!^!_*g!_!c%Z!c!}Er!}#O%Z#O#P&c#P#R%Z#R#SEr#S#T%Z#T#oEr#o#p*g#p$f%Z$f$g+g$g#BYEr#BY#BZ$A`#BZ$ISEr$IS$I_$A`$I_$JTEr$JT$JU$A`$JU$KVEr$KV$KW$A`$KW&FUEr&FU&FV$A`&FV;'SEr;'S;=`I|<%l?HTEr?HT?HU$A`?HUOEr07[$D|k$i&j(Wp(Z!b'}0/l$]#t(T,2j(e$I[OY%ZYZ&cZr%Zrs&}st%ZtuEruw%Zwx(rx}%Z}!OGv!O!Q%Z!Q![Er![!^%Z!^!_*g!_!c%Z!c!}Er!}#O%Z#O#P&c#P#R%Z#R#SEr#S#T%Z#T#oEr#o#p*g#p$g%Z$g;'SEr;'S;=`I|<%lOEr",tokenizers:[hC,dC,uC,pC,2,3,4,5,6,7,8,9,10,11,12,13,14,cC,new Fh("$S~RRtu[#O#Pg#S#T#|~_P#o#pb~gOx~~jVO#i!P#i#j!U#j#l!P#l#m!q#m;'S!P;'S;=`#v<%lO!P~!UO!U~~!XS!Q![!e!c!i!e#T#Z!e#o#p#Z~!hR!Q![!q!c!i!q#T#Z!q~!tR!Q![!}!c!i!}#T#Z!}~#QR!Q![!P!c!i!P#T#Z!P~#^R!Q![#g!c!i#g#T#Z#g~#jS!Q![#g!c!i#g#T#Z#g#q#r!P~#yP;=`<%l!P~$RO(c~~",141,340),new Fh("j~RQYZXz{^~^O(Q~~aP!P!Qd~iO(R~~",25,323)],topRules:{Script:[0,7],SingleExpression:[1,276],SingleClassItem:[2,277]},dialects:{jsx:0,ts:15175},dynamicPrecedences:{80:1,82:1,94:1,169:1,199:1},specialized:[{term:327,get:t=>gC[t]||-1},{term:343,get:t=>mC[t]||-1},{term:95,get:t=>OC[t]||-1}],tokenPrec:15201});function Lf(t){let e=Object.keys(t).join(""),i=/\w/.test(e);return i&&(e=e.replace(/\w/g,"")),`[${i?"\\w":""}${e.replace(/[^\w\s]/g,"\\$&")}]`}function vC(t){let e=Object.create(null),i=Object.create(null);for(let{label:r}of t){e[r[0]]=!0;for(let n=1;n<r.length;n++)i[r[n]]=!0}let s=Lf(e)+Lf(i)+"*$";return[new RegExp("^"+s),new RegExp(s)]}function _y(t){let e=t.map(r=>typeof r=="string"?{label:r}:r),[i,s]=e.every(r=>/^\w+$/.test(r.label))?[/\w*$/,/\w+$/]:vC(e);return r=>{let n=r.matchBefore(s);return n||r.explicit?{from:n?n.from:r.pos,options:e,validFor:i}:null}}function Ry(t,e){return i=>{for(let s=vt(i.state).resolveInner(i.pos,-1);s;s=s.parent){if(t.indexOf(s.name)>-1)return null;if(s.type.isTop)break}return e(i)}}const bC=ns.define(),wC=te.baseTheme({".cm-tooltip.cm-tooltip-autocomplete":{"& > ul":{fontFamily:"monospace",whiteSpace:"nowrap",overflow:"hidden auto",maxWidth_fallback:"700px",maxWidth:"min(700px, 95vw)",minWidth:"250px",maxHeight:"10em",height:"100%",listStyle:"none",margin:0,padding:0,"& > li, & > completion-section":{padding:"1px 3px",lineHeight:1.2},"& > li":{overflowX:"hidden",textOverflow:"ellipsis",cursor:"pointer"},"& > completion-section":{display:"list-item",borderBottom:"1px solid silver",paddingLeft:"0.5em",opacity:.7}}},"&light .cm-tooltip-autocomplete ul li[aria-selected]":{background:"#17c",color:"white"},"&light .cm-tooltip-autocomplete-disabled ul li[aria-selected]":{background:"#777"},"&dark .cm-tooltip-autocomplete ul li[aria-selected]":{background:"#347",color:"white"},"&dark .cm-tooltip-autocomplete-disabled ul li[aria-selected]":{background:"#444"},".cm-completionListIncompleteTop:before, .cm-completionListIncompleteBottom:after":{content:'"Â·Â·Â·"',opacity:.5,display:"block",textAlign:"center"},".cm-tooltip.cm-completionInfo":{position:"absolute",padding:"3px 9px",width:"max-content",maxWidth:"400px",boxSizing:"border-box",whiteSpace:"pre-line"},".cm-completionInfo.cm-completionInfo-left":{right:"100%"},".cm-completionInfo.cm-completionInfo-right":{left:"100%"},".cm-completionInfo.cm-completionInfo-left-narrow":{right:"30px"},".cm-completionInfo.cm-completionInfo-right-narrow":{left:"30px"},"&light .cm-snippetField":{backgroundColor:"#00000022"},"&dark .cm-snippetField":{backgroundColor:"#ffffff22"},".cm-snippetFieldPosition":{verticalAlign:"text-top",width:0,height:"1.15em",display:"inline-block",margin:"0 -0.7px -.7em",borderLeft:"1.4px dotted #888"},".cm-completionMatchedText":{textDecoration:"underline"},".cm-completionDetail":{marginLeft:"0.5em",fontStyle:"italic"},".cm-completionIcon":{fontSize:"90%",width:".8em",display:"inline-block",textAlign:"center",paddingRight:".6em",opacity:"0.6",boxSizing:"content-box"},".cm-completionIcon-function, .cm-completionIcon-method":{"&:after":{content:"'Æ’'"}},".cm-completionIcon-class":{"&:after":{content:"'â—‹'"}},".cm-completionIcon-interface":{"&:after":{content:"'â—Œ'"}},".cm-completionIcon-variable":{"&:after":{content:"'ð‘¥'"}},".cm-completionIcon-constant":{"&:after":{content:"'ð¶'"}},".cm-completionIcon-type":{"&:after":{content:"'ð‘¡'"}},".cm-completionIcon-enum":{"&:after":{content:"'âˆª'"}},".cm-completionIcon-property":{"&:after":{content:"'â–¡'"}},".cm-completionIcon-keyword":{"&:after":{content:"'ðŸ”‘ï¸Ž'"}},".cm-completionIcon-namespace":{"&:after":{content:"'â–¢'"}},".cm-completionIcon-text":{"&:after":{content:"'abc'",fontSize:"50%",verticalAlign:"middle"}}});class SC{constructor(e,i,s,r){this.field=e,this.line=i,this.from=s,this.to=r}}class jd{constructor(e,i,s){this.field=e,this.from=i,this.to=s}map(e){let i=e.mapPos(this.from,-1,Ct.TrackDel),s=e.mapPos(this.to,1,Ct.TrackDel);return i==null||s==null?null:new jd(this.field,i,s)}}class Wd{constructor(e,i){this.lines=e,this.fieldPositions=i}instantiate(e,i){let s=[],r=[i],n=e.doc.lineAt(i),a=/^\s*/.exec(n.text)[0];for(let l of this.lines){if(s.length){let c=a,h=/^\t*/.exec(l)[0].length;for(let d=0;d<h;d++)c+=e.facet(yl);r.push(i+c.length-h),l=c+l.slice(h)}s.push(l),i+=l.length+1}let o=this.fieldPositions.map(l=>new jd(l.field,r[l.line]+l.from,r[l.line]+l.to));return{text:s,ranges:o}}static parse(e){let i=[],s=[],r=[],n;for(let a of e.split(/\r\n?|\n/)){for(;n=/[#$]\{(?:(\d+)(?::([^{}]*))?|((?:\\[{}]|[^{}])*))\}/.exec(a);){let o=n[1]?+n[1]:null,l=n[2]||n[3]||"",c=-1,h=l.replace(/\\[{}]/g,d=>d[1]);for(let d=0;d<i.length;d++)(o!=null?i[d].seq==o:h&&i[d].name==h)&&(c=d);if(c<0){let d=0;for(;d<i.length&&(o==null||i[d].seq!=null&&i[d].seq<o);)d++;i.splice(d,0,{seq:o,name:h}),c=d;for(let u of r)u.field>=c&&u.field++}for(let d of r)if(d.line==s.length&&d.from>n.index){let u=n[2]?3+(n[1]||"").length:2;d.from-=u,d.to-=u}r.push(new SC(c,s.length,n.index,n.index+h.length)),a=a.slice(0,n.index)+l+a.slice(n.index+n[0].length)}a=a.replace(/\\([{}])/g,(o,l,c)=>{for(let h of r)h.line==s.length&&h.from>c&&(h.from--,h.to--);return l}),s.push(a)}return new Wd(s,r)}}let xC=fe.widget({widget:new class extends gi{toDOM(){let t=document.createElement("span");return t.className="cm-snippetFieldPosition",t}ignoreEvent(){return!1}}}),kC=fe.mark({class:"cm-snippetField"});class hn{constructor(e,i){this.ranges=e,this.active=i,this.deco=fe.set(e.map(s=>(s.from==s.to?xC:kC).range(s.from,s.to)),!0)}map(e){let i=[];for(let s of this.ranges){let r=s.map(e);if(!r)return null;i.push(r)}return new hn(i,this.active)}selectionInsideField(e){return e.ranges.every(i=>this.ranges.some(s=>s.field==this.active&&s.from<=i.from&&s.to>=i.to))}}const _a=Ie.define({map(t,e){return t&&t.map(e)}}),TC=Ie.define(),ma=Mt.define({create(){return null},update(t,e){for(let i of e.effects){if(i.is(_a))return i.value;if(i.is(TC)&&t)return new hn(t.ranges,i.value)}return t&&e.docChanged&&(t=t.map(e.changes)),t&&e.selection&&!t.selectionInsideField(e.selection)&&(t=null),t},provide:t=>te.decorations.from(t,e=>e?e.deco:fe.none)});function Fd(t,e){return X.create(t.filter(i=>i.field==e).map(i=>X.range(i.from,i.to)))}function EC(t){let e=Wd.parse(t);return(i,s,r,n)=>{let{text:a,ranges:o}=e.instantiate(i.state,r),{main:l}=i.state.selection,c={changes:{from:r,to:n==l.from?l.to:n,insert:$e.of(a)},scrollIntoView:!0,annotations:s?[bC.of(s),et.userEvent.of("input.complete")]:void 0};if(o.length&&(c.selection=Fd(o,0)),o.some(h=>h.field>0)){let h=new hn(o,0),d=c.effects=[_a.of(h)];i.state.field(ma,!1)===void 0&&d.push(Ie.appendConfig.of([ma,$C,IC,wC]))}i.dispatch(i.state.update(c))}}function $y(t){return({state:e,dispatch:i})=>{let s=e.field(ma,!1);if(!s||t<0&&s.active==0)return!1;let r=s.active+t,n=t>0&&!s.ranges.some(a=>a.field==r+t);return i(e.update({selection:Fd(s.ranges,r),effects:_a.of(n?null:new hn(s.ranges,r)),scrollIntoView:!0})),!0}}const PC=({state:t,dispatch:e})=>t.field(ma,!1)?(e(t.update({effects:_a.of(null)})),!0):!1,CC=$y(1),_C=$y(-1),RC=[{key:"Tab",run:CC,shift:_C},{key:"Escape",run:PC}],Nf=se.define({combine(t){return t.length?t[0]:RC}}),$C=wa.highest(Cd.compute([Nf],t=>t.facet(Nf)));function Ve(t,e){return{...e,apply:EC(t)}}const IC=te.domEventHandlers({mousedown(t,e){let i=e.state.field(ma,!1),s;if(!i||(s=e.posAtCoords({x:t.clientX,y:t.clientY}))==null)return!1;let r=i.ranges.find(n=>n.from<=s&&n.to>=s);return!r||r.field==i.active?!1:(e.dispatch({selection:Fd(i.ranges,r.field),effects:_a.of(i.ranges.some(n=>n.field>r.field)?new hn(i.ranges,r.field):null),scrollIntoView:!0}),!0)}}),Iy=new class extends Ss{};Iy.startSide=1;Iy.endSide=-1;const Qy=[Ve("function ${name}(${params}) {\n	${}\n}",{label:"function",detail:"definition",type:"keyword"}),Ve("for (let ${index} = 0; ${index} < ${bound}; ${index}++) {\n	${}\n}",{label:"for",detail:"loop",type:"keyword"}),Ve("for (let ${name} of ${collection}) {\n	${}\n}",{label:"for",detail:"of loop",type:"keyword"}),Ve("do {\n	${}\n} while (${})",{label:"do",detail:"loop",type:"keyword"}),Ve("while (${}) {\n	${}\n}",{label:"while",detail:"loop",type:"keyword"}),Ve(`try {
	\${}
} catch (\${error}) {
	\${}
}`,{label:"try",detail:"/ catch block",type:"keyword"}),Ve("if (${}) {\n	${}\n}",{label:"if",detail:"block",type:"keyword"}),Ve(`if (\${}) {
	\${}
} else {
	\${}
}`,{label:"if",detail:"/ else block",type:"keyword"}),Ve(`class \${name} {
	constructor(\${params}) {
		\${}
	}
}`,{label:"class",detail:"definition",type:"keyword"}),Ve('import {${names}} from "${module}"\n${}',{label:"import",detail:"named",type:"keyword"}),Ve('import ${name} from "${module}"\n${}',{label:"import",detail:"default",type:"keyword"})],QC=Qy.concat([Ve("interface ${name} {\n	${}\n}",{label:"interface",detail:"definition",type:"keyword"}),Ve("type ${name} = ${type}",{label:"type",detail:"definition",type:"keyword"}),Ve("enum ${name} {\n	${}\n}",{label:"enum",detail:"definition",type:"keyword"})]),Mf=new CO,Ay=new Set(["Script","Block","FunctionExpression","FunctionDeclaration","ArrowFunction","MethodDeclaration","ForStatement"]);function Rn(t){return(e,i)=>{let s=e.node.getChild("VariableDefinition");return s&&i(s,t),!0}}const AC=["FunctionDeclaration"],LC={FunctionDeclaration:Rn("function"),ClassDeclaration:Rn("class"),ClassExpression:()=>!0,EnumDeclaration:Rn("constant"),TypeAliasDeclaration:Rn("type"),NamespaceDeclaration:Rn("namespace"),VariableDefinition(t,e){t.matchContext(AC)||e(t,"variable")},TypeDefinition(t,e){e(t,"type")},__proto__:null};function Ly(t,e){let i=Mf.get(e);if(i)return i;let s=[],r=!0;function n(a,o){let l=t.sliceString(a.from,a.to);s.push({label:l,type:o})}return e.cursor(je.IncludeAnonymous).iterate(a=>{if(r)r=!1;else if(a.name){let o=LC[a.name];if(o&&o(a,n)||Ay.has(a.name))return!1}else if(a.to-a.from>8192){for(let o of Ly(t,a.node))s.push(o);return!1}}),Mf.set(e,s),s}const qf=/^[\w$\xa1-\uffff][\w$\d\xa1-\uffff]*$/,Ny=["TemplateString","String","RegExp","LineComment","BlockComment","VariableDefinition","TypeDefinition","Label","PropertyDefinition","PropertyName","PrivatePropertyDefinition","PrivatePropertyName","JSXText","JSXAttributeValue","JSXOpenTag","JSXCloseTag","JSXSelfClosingTag",".","?."];function NC(t){let e=vt(t.state).resolveInner(t.pos,-1);if(Ny.indexOf(e.name)>-1)return null;let i=e.name=="VariableName"||e.to-e.from<20&&qf.test(t.state.sliceDoc(e.from,e.to));if(!i&&!t.explicit)return null;let s=[];for(let r=e;r;r=r.parent)Ay.has(r.name)&&(s=s.concat(Ly(t.state.doc,r)));return{options:s,from:i?e.from:t.pos,validFor:qf}}const tr=Jr.define({name:"javascript",parser:yC.configure({props:[bl.add({IfStatement:Vr({except:/^\s*({|else\b)/}),TryStatement:Vr({except:/^\s*({|catch\b|finally\b)/}),LabeledStatement:NO,SwitchBody:t=>{let e=t.textAfter,i=/^\s*\}/.test(e),s=/^\s*(case|default)\b/.test(e);return t.baseIndent+(i?0:s?1:2)*t.unit},Block:Hn({closing:"}"}),ArrowFunction:t=>t.baseIndent+t.unit,"TemplateString BlockComment":()=>null,"Statement Property":Vr({except:/^\s*{/}),JSXElement(t){let e=/^\s*<\//.test(t.textAfter);return t.lineIndent(t.node.from)+(e?0:t.unit)},JSXEscape(t){let e=/\s*\}/.test(t.textAfter);return t.lineIndent(t.node.from)+(e?0:t.unit)},"JSXOpenTag JSXSelfClosingTag"(t){return t.column(t.node.from)+t.unit}}),wl.add({"Block ClassBody SwitchBody EnumBody ObjectExpression ArrayExpression ObjectType":Md,BlockComment(t){return{from:t.from+2,to:t.to-2}}})]}),languageData:{closeBrackets:{brackets:["(","[","{","'",'"',"`"]},commentTokens:{line:"//",block:{open:"/*",close:"*/"}},indentOnInput:/^\s*(?:case |default:|\{|\}|<\/)$/,wordChars:"$"}}),My={test:t=>/^JSX/.test(t.name),facet:IO({commentTokens:{block:{open:"{/*",close:"*/}"}}})},MC=tr.configure({dialect:"ts"},"typescript"),qC=tr.configure({dialect:"jsx",props:[Qd.add(t=>t.isTop?[My]:void 0)]}),DC=tr.configure({dialect:"jsx ts",props:[Qd.add(t=>t.isTop?[My]:void 0)]},"typescript");let qy=t=>({label:t,type:"keyword"});const Dy="break case const continue default delete export extends false finally in instanceof let new return static super switch this throw true typeof var yield".split(" ").map(qy),BC=Dy.concat(["declare","implements","private","protected","public"].map(qy));function Df(t={}){let e=t.jsx?t.typescript?DC:qC:t.typescript?MC:tr,i=t.typescript?QC.concat(BC):Qy.concat(Dy);return new Ad(e,[tr.data.of({autocomplete:Ry(Ny,_y(i))}),tr.data.of({autocomplete:NC}),t.jsx?FC:[]])}function jC(t){for(;;){if(t.name=="JSXOpenTag"||t.name=="JSXSelfClosingTag"||t.name=="JSXFragmentTag")return t;if(t.name=="JSXEscape"||!t.parent)return null;t=t.parent}}function Bf(t,e,i=t.length){for(let s=e==null?void 0:e.firstChild;s;s=s.nextSibling)if(s.name=="JSXIdentifier"||s.name=="JSXBuiltin"||s.name=="JSXNamespacedName"||s.name=="JSXMemberExpression")return t.sliceString(s.from,Math.min(s.to,i));return""}const WC=typeof navigator=="object"&&/Android\b/.test(navigator.userAgent),FC=te.inputHandler.of((t,e,i,s,r)=>{if((WC?t.composing:t.compositionStarted)||t.state.readOnly||e!=i||s!=">"&&s!="/"||!tr.isActiveAt(t.state,e,-1))return!1;let n=r(),{state:a}=n,o=a.changeByRange(l=>{var c;let{head:h}=l,d=vt(a).resolveInner(h-1,-1),u;if(d.name=="JSXStartTag"&&(d=d.parent),!(a.doc.sliceString(h-1,h)!=s||d.name=="JSXAttributeValue"&&d.to>h)){if(s==">"&&d.name=="JSXFragmentTag")return{range:l,changes:{from:h,insert:"</>"}};if(s=="/"&&d.name=="JSXStartCloseTag"){let p=d.parent,f=p.parent;if(f&&p.from==h-2&&((u=Bf(a.doc,f.firstChild,h))||((c=f.firstChild)===null||c===void 0?void 0:c.name)=="JSXFragmentTag")){let g=`${u}>`;return{range:X.cursor(h+g.length,-1),changes:{from:h,insert:g}}}}else if(s==">"){let p=jC(d);if(p&&p.name=="JSXOpenTag"&&!/^\/?>|^<\//.test(a.doc.sliceString(h,h+2))&&(u=Bf(a.doc,p,h)))return{range:l,changes:{from:h,insert:`</${u}>`}}}}return{range:l}});return o.changes.empty?!1:(t.dispatch([n,a.update(o,{userEvent:"input.complete",scrollIntoView:!0})]),!0)}),UC=1,By=194,jy=195,VC=196,jf=197,zC=198,XC=199,GC=200,YC=2,Wy=3,Wf=201,ZC=24,HC=25,KC=49,JC=50,e_=55,t_=56,i_=57,s_=59,r_=60,n_=61,a_=62,o_=63,l_=65,c_=238,h_=71,d_=241,u_=242,p_=243,f_=244,g_=245,m_=246,O_=247,y_=248,Fy=72,v_=249,b_=250,w_=251,S_=252,x_=253,k_=254,T_=255,E_=256,P_=73,C_=77,__=263,R_=112,$_=130,I_=151,Q_=152,A_=155,lr=10,Oa=13,Ud=32,Pl=9,Vd=35,L_=40,N_=46,zh=123,Ff=125,Uy=39,Vy=34,Uf=92,M_=111,q_=120,D_=78,B_=117,j_=85,W_=new Set([HC,KC,JC,__,l_,$_,t_,i_,c_,a_,o_,Fy,P_,C_,r_,n_,I_,Q_,A_,R_]);function Rc(t){return t==lr||t==Oa}function $c(t){return t>=48&&t<=57||t>=65&&t<=70||t>=97&&t<=102}const F_=new as((t,e)=>{let i;if(t.next<0)t.acceptToken(XC);else if(e.context.flags&Po)Rc(t.next)&&t.acceptToken(zC,1);else if(((i=t.peek(-1))<0||Rc(i))&&e.canShift(jf)){let s=0;for(;t.next==Ud||t.next==Pl;)t.advance(),s++;(t.next==lr||t.next==Oa||t.next==Vd)&&t.acceptToken(jf,-s)}else Rc(t.next)&&t.acceptToken(VC,1)},{contextual:!0}),U_=new as((t,e)=>{let i=e.context;if(i.flags)return;let s=t.peek(-1);if(s==lr||s==Oa){let r=0,n=0;for(;;){if(t.next==Ud)r++;else if(t.next==Pl)r+=8-r%8;else break;t.advance(),n++}r!=i.indent&&t.next!=lr&&t.next!=Oa&&t.next!=Vd&&(r<i.indent?t.acceptToken(jy,-n):t.acceptToken(By))}}),Po=1,zy=2,Ui=4,Vi=8,zi=16,Xi=32;function Co(t,e,i){this.parent=t,this.indent=e,this.flags=i,this.hash=(t?t.hash+t.hash<<8:0)+e+(e<<4)+i+(i<<6)}const V_=new Co(null,0,0);function z_(t){let e=0;for(let i=0;i<t.length;i++)e+=t.charCodeAt(i)==Pl?8-e%8:1;return e}const Vf=new Map([[d_,0],[u_,Ui],[p_,Vi],[f_,Vi|Ui],[g_,zi],[m_,zi|Ui],[O_,zi|Vi],[y_,zi|Vi|Ui],[v_,Xi],[b_,Xi|Ui],[w_,Xi|Vi],[S_,Xi|Vi|Ui],[x_,Xi|zi],[k_,Xi|zi|Ui],[T_,Xi|zi|Vi],[E_,Xi|zi|Vi|Ui]].map(([t,e])=>[t,e|zy])),X_=new Py({start:V_,reduce(t,e,i,s){return t.flags&Po&&W_.has(e)||(e==h_||e==Fy)&&t.flags&zy?t.parent:t},shift(t,e,i,s){return e==By?new Co(t,z_(s.read(s.pos,i.pos)),0):e==jy?t.parent:e==ZC||e==e_||e==s_||e==Wy?new Co(t,0,Po):Vf.has(e)?new Co(t,0,Vf.get(e)|t.flags&Po):t},hash(t){return t.hash}}),G_=new as(t=>{for(let e=0;e<5;e++){if(t.next!="print".charCodeAt(e))return;t.advance()}if(!/\w/.test(String.fromCharCode(t.next)))for(let e=0;;e++){let i=t.peek(e);if(!(i==Ud||i==Pl)){i!=L_&&i!=N_&&i!=lr&&i!=Oa&&i!=Vd&&t.acceptToken(UC);return}}}),Y_=new as((t,e)=>{let{flags:i}=e.context,s=i&Ui?Vy:Uy,r=(i&Vi)>0,n=!(i&zi),a=(i&Xi)>0,o=t.pos;for(;!(t.next<0);)if(a&&t.next==zh)if(t.peek(1)==zh)t.advance(2);else{if(t.pos==o){t.acceptToken(Wy,1);return}break}else if(n&&t.next==Uf){if(t.pos==o){t.advance();let l=t.next;l>=0&&(t.advance(),Z_(t,l)),t.acceptToken(YC);return}break}else if(t.next==Uf&&!n&&t.peek(1)>-1)t.advance(2);else if(t.next==s&&(!r||t.peek(1)==s&&t.peek(2)==s)){if(t.pos==o){t.acceptToken(Wf,r?3:1);return}break}else if(t.next==lr){if(r)t.advance();else if(t.pos==o){t.acceptToken(Wf);return}break}else t.advance();t.pos>o&&t.acceptToken(GC)});function Z_(t,e){if(e==M_)for(let i=0;i<2&&t.next>=48&&t.next<=55;i++)t.advance();else if(e==q_)for(let i=0;i<2&&$c(t.next);i++)t.advance();else if(e==B_)for(let i=0;i<4&&$c(t.next);i++)t.advance();else if(e==j_)for(let i=0;i<8&&$c(t.next);i++)t.advance();else if(e==D_&&t.next==zh){for(t.advance();t.next>=0&&t.next!=Ff&&t.next!=Uy&&t.next!=Vy&&t.next!=lr;)t.advance();t.next==Ff&&t.advance()}}const H_=Ol({'async "*" "**" FormatConversion FormatSpec':$.modifier,"for while if elif else try except finally return raise break continue with pass assert await yield match case":$.controlKeyword,"in not and or is del":$.operatorKeyword,"from def class global nonlocal lambda":$.definitionKeyword,import:$.moduleKeyword,"with as print":$.keyword,Boolean:$.bool,None:$.null,VariableName:$.variableName,"CallExpression/VariableName":$.function($.variableName),"FunctionDefinition/VariableName":$.function($.definition($.variableName)),"ClassDefinition/VariableName":$.definition($.className),PropertyName:$.propertyName,"CallExpression/MemberExpression/PropertyName":$.function($.propertyName),Comment:$.lineComment,Number:$.number,String:$.string,FormatString:$.special($.string),Escape:$.escape,UpdateOp:$.updateOperator,"ArithOp!":$.arithmeticOperator,BitOp:$.bitwiseOperator,CompareOp:$.compareOperator,AssignOp:$.definitionOperator,Ellipsis:$.punctuation,At:$.meta,"( )":$.paren,"[ ]":$.squareBracket,"{ }":$.brace,".":$.derefOperator,", ;":$.separator}),K_={__proto__:null,await:44,or:54,and:56,in:60,not:62,is:64,if:70,else:72,lambda:76,yield:94,from:96,async:102,for:104,None:162,True:164,False:164,del:178,pass:182,break:186,continue:190,return:194,raise:202,import:206,as:208,global:212,nonlocal:214,assert:218,type:223,elif:236,while:240,try:246,except:248,finally:250,with:254,def:258,class:268,match:279,case:285},J_=tn.deserialize({version:14,states:"##jO`QeOOP$}OSOOO&WQtO'#HUOOQS'#Co'#CoOOQS'#Cp'#CpO'vQdO'#CnO*UQtO'#HTOOQS'#HU'#HUOOQS'#DU'#DUOOQS'#HT'#HTO*rQdO'#D_O+VQdO'#DfO+gQdO'#DjO+zOWO'#DuO,VOWO'#DvO.[QtO'#GuOOQS'#Gu'#GuO'vQdO'#GtO0ZQtO'#GtOOQS'#Eb'#EbO0rQdO'#EcOOQS'#Gs'#GsO0|QdO'#GrOOQV'#Gr'#GrO1XQdO'#FYOOQS'#G^'#G^O1^QdO'#FXOOQV'#IS'#ISOOQV'#Gq'#GqOOQV'#Fq'#FqQ`QeOOO'vQdO'#CqO1lQdO'#C}O1sQdO'#DRO2RQdO'#HYO2cQtO'#EVO'vQdO'#EWOOQS'#EY'#EYOOQS'#E['#E[OOQS'#E^'#E^O2wQdO'#E`O3_QdO'#EdO3rQdO'#EfO3zQtO'#EfO1XQdO'#EiO0rQdO'#ElO1XQdO'#EnO0rQdO'#EtO0rQdO'#EwO4VQdO'#EyO4^QdO'#FOO4iQdO'#EzO0rQdO'#FOO1XQdO'#FQO1XQdO'#FVO4nQdO'#F[P4uOdO'#GpPOOO)CBd)CBdOOQS'#Ce'#CeOOQS'#Cf'#CfOOQS'#Cg'#CgOOQS'#Ch'#ChOOQS'#Ci'#CiOOQS'#Cj'#CjOOQS'#Cl'#ClO'vQdO,59OO'vQdO,59OO'vQdO,59OO'vQdO,59OO'vQdO,59OO'vQdO,59OO5TQdO'#DoOOQS,5:Y,5:YO5hQdO'#HdOOQS,5:],5:]O5uQ!fO,5:]O5zQtO,59YO1lQdO,59bO1lQdO,59bO1lQdO,59bO8jQdO,59bO8oQdO,59bO8vQdO,59jO8}QdO'#HTO:TQdO'#HSOOQS'#HS'#HSOOQS'#D['#D[O:lQdO,59aO'vQdO,59aO:zQdO,59aOOQS,59y,59yO;PQdO,5:RO'vQdO,5:ROOQS,5:Q,5:QO;_QdO,5:QO;dQdO,5:XO'vQdO,5:XO'vQdO,5:VOOQS,5:U,5:UO;uQdO,5:UO;zQdO,5:WOOOW'#Fy'#FyO<POWO,5:aOOQS,5:a,5:aO<[QdO'#HwOOOW'#Dw'#DwOOOW'#Fz'#FzO<lOWO,5:bOOQS,5:b,5:bOOQS'#F}'#F}O<zQtO,5:iO?lQtO,5=`O@VQ#xO,5=`O@vQtO,5=`OOQS,5:},5:}OA_QeO'#GWOBqQdO,5;^OOQV,5=^,5=^OB|QtO'#IPOCkQdO,5;tOOQS-E:[-E:[OOQV,5;s,5;sO4dQdO'#FQOOQV-E9o-E9oOCsQtO,59]OEzQtO,59iOFeQdO'#HVOFpQdO'#HVO1XQdO'#HVOF{QdO'#DTOGTQdO,59mOGYQdO'#HZO'vQdO'#HZO0rQdO,5=tOOQS,5=t,5=tO0rQdO'#EROOQS'#ES'#ESOGwQdO'#GPOHXQdO,58|OHXQdO,58|O*xQdO,5:oOHgQtO'#H]OOQS,5:r,5:rOOQS,5:z,5:zOHzQdO,5;OOI]QdO'#IOO1XQdO'#H}OOQS,5;Q,5;QOOQS'#GT'#GTOIqQtO,5;QOJPQdO,5;QOJUQdO'#IQOOQS,5;T,5;TOJdQdO'#H|OOQS,5;W,5;WOJuQdO,5;YO4iQdO,5;`O4iQdO,5;cOJ}QtO'#ITO'vQdO'#ITOKXQdO,5;eO4VQdO,5;eO0rQdO,5;jO1XQdO,5;lOK^QeO'#EuOLjQgO,5;fO!!kQdO'#IUO4iQdO,5;jO!!vQdO,5;lO!#OQdO,5;qO!#ZQtO,5;vO'vQdO,5;vPOOO,5=[,5=[P!#bOSO,5=[P!#jOdO,5=[O!&bQtO1G.jO!&iQtO1G.jO!)YQtO1G.jO!)dQtO1G.jO!+}QtO1G.jO!,bQtO1G.jO!,uQdO'#HcO!-TQtO'#GuO0rQdO'#HcO!-_QdO'#HbOOQS,5:Z,5:ZO!-gQdO,5:ZO!-lQdO'#HeO!-wQdO'#HeO!.[QdO,5>OOOQS'#Ds'#DsOOQS1G/w1G/wOOQS1G.|1G.|O!/[QtO1G.|O!/cQtO1G.|O1lQdO1G.|O!0OQdO1G/UOOQS'#DZ'#DZO0rQdO,59tOOQS1G.{1G.{O!0VQdO1G/eO!0gQdO1G/eO!0oQdO1G/fO'vQdO'#H[O!0tQdO'#H[O!0yQtO1G.{O!1ZQdO,59iO!2aQdO,5=zO!2qQdO,5=zO!2yQdO1G/mO!3OQtO1G/mOOQS1G/l1G/lO!3`QdO,5=uO!4VQdO,5=uO0rQdO1G/qO!4tQdO1G/sO!4yQtO1G/sO!5ZQtO1G/qOOQS1G/p1G/pOOQS1G/r1G/rOOOW-E9w-E9wOOQS1G/{1G/{O!5kQdO'#HxO0rQdO'#HxO!5|QdO,5>cOOOW-E9x-E9xOOQS1G/|1G/|OOQS-E9{-E9{O!6[Q#xO1G2zO!6{QtO1G2zO'vQdO,5<jOOQS,5<j,5<jOOQS-E9|-E9|OOQS,5<r,5<rOOQS-E:U-E:UOOQV1G0x1G0xO1XQdO'#GRO!7dQtO,5>kOOQS1G1`1G1`O!8RQdO1G1`OOQS'#DV'#DVO0rQdO,5=qOOQS,5=q,5=qO!8WQdO'#FrO!8cQdO,59oO!8kQdO1G/XO!8uQtO,5=uOOQS1G3`1G3`OOQS,5:m,5:mO!9fQdO'#GtOOQS,5<k,5<kOOQS-E9}-E9}O!9wQdO1G.hOOQS1G0Z1G0ZO!:VQdO,5=wO!:gQdO,5=wO0rQdO1G0jO0rQdO1G0jO!:xQdO,5>jO!;ZQdO,5>jO1XQdO,5>jO!;lQdO,5>iOOQS-E:R-E:RO!;qQdO1G0lO!;|QdO1G0lO!<RQdO,5>lO!<aQdO,5>lO!<oQdO,5>hO!=VQdO,5>hO!=hQdO'#EpO0rQdO1G0tO!=sQdO1G0tO!=xQgO1G0zO!AvQgO1G0}O!EqQdO,5>oO!E{QdO,5>oO!FTQtO,5>oO0rQdO1G1PO!F_QdO1G1PO4iQdO1G1UO!!vQdO1G1WOOQV,5;a,5;aO!FdQfO,5;aO!FiQgO1G1QO!JjQdO'#GZO4iQdO1G1QO4iQdO1G1QO!JzQdO,5>pO!KXQdO,5>pO1XQdO,5>pOOQV1G1U1G1UO!KaQdO'#FSO!KrQ!fO1G1WO!KzQdO1G1WOOQV1G1]1G1]O4iQdO1G1]O!LPQdO1G1]O!LXQdO'#F^OOQV1G1b1G1bO!#ZQtO1G1bPOOO1G2v1G2vP!L^OSO1G2vOOQS,5=},5=}OOQS'#Dp'#DpO0rQdO,5=}O!LfQdO,5=|O!LyQdO,5=|OOQS1G/u1G/uO!MRQdO,5>PO!McQdO,5>PO!MkQdO,5>PO!NOQdO,5>PO!N`QdO,5>POOQS1G3j1G3jOOQS7+$h7+$hO!8kQdO7+$pO#!RQdO1G.|O#!YQdO1G.|OOQS1G/`1G/`OOQS,5<`,5<`O'vQdO,5<`OOQS7+%P7+%PO#!aQdO7+%POOQS-E9r-E9rOOQS7+%Q7+%QO#!qQdO,5=vO'vQdO,5=vOOQS7+$g7+$gO#!vQdO7+%PO##OQdO7+%QO##TQdO1G3fOOQS7+%X7+%XO##eQdO1G3fO##mQdO7+%XOOQS,5<_,5<_O'vQdO,5<_O##rQdO1G3aOOQS-E9q-E9qO#$iQdO7+%]OOQS7+%_7+%_O#$wQdO1G3aO#%fQdO7+%_O#%kQdO1G3gO#%{QdO1G3gO#&TQdO7+%]O#&YQdO,5>dO#&sQdO,5>dO#&sQdO,5>dOOQS'#Dx'#DxO#'UO&jO'#DzO#'aO`O'#HyOOOW1G3}1G3}O#'fQdO1G3}O#'nQdO1G3}O#'yQ#xO7+(fO#(jQtO1G2UP#)TQdO'#GOOOQS,5<m,5<mOOQS-E:P-E:POOQS7+&z7+&zOOQS1G3]1G3]OOQS,5<^,5<^OOQS-E9p-E9pOOQS7+$s7+$sO#)bQdO,5=`O#){QdO,5=`O#*^QtO,5<aO#*qQdO1G3cOOQS-E9s-E9sOOQS7+&U7+&UO#+RQdO7+&UO#+aQdO,5<nO#+uQdO1G4UOOQS-E:Q-E:QO#,WQdO1G4UOOQS1G4T1G4TOOQS7+&W7+&WO#,iQdO7+&WOOQS,5<p,5<pO#,tQdO1G4WOOQS-E:S-E:SOOQS,5<l,5<lO#-SQdO1G4SOOQS-E:O-E:OO1XQdO'#EqO#-jQdO'#EqO#-uQdO'#IRO#-}QdO,5;[OOQS7+&`7+&`O0rQdO7+&`O#.SQgO7+&fO!JmQdO'#GXO4iQdO7+&fO4iQdO7+&iO#2QQtO,5<tO'vQdO,5<tO#2[QdO1G4ZOOQS-E:W-E:WO#2fQdO1G4ZO4iQdO7+&kO0rQdO7+&kOOQV7+&p7+&pO!KrQ!fO7+&rO!KzQdO7+&rO`QeO1G0{OOQV-E:X-E:XO4iQdO7+&lO4iQdO7+&lOOQV,5<u,5<uO#2nQdO,5<uO!JmQdO,5<uOOQV7+&l7+&lO#2yQgO7+&lO#6tQdO,5<vO#7PQdO1G4[OOQS-E:Y-E:YO#7^QdO1G4[O#7fQdO'#IWO#7tQdO'#IWO1XQdO'#IWOOQS'#IW'#IWO#8PQdO'#IVOOQS,5;n,5;nO#8XQdO,5;nO0rQdO'#FUOOQV7+&r7+&rO4iQdO7+&rOOQV7+&w7+&wO4iQdO7+&wO#8^QfO,5;xOOQV7+&|7+&|POOO7+(b7+(bO#8cQdO1G3iOOQS,5<c,5<cO#8qQdO1G3hOOQS-E9u-E9uO#9UQdO,5<dO#9aQdO,5<dO#9tQdO1G3kOOQS-E9v-E9vO#:UQdO1G3kO#:^QdO1G3kO#:nQdO1G3kO#:UQdO1G3kOOQS<<H[<<H[O#:yQtO1G1zOOQS<<Hk<<HkP#;WQdO'#FtO8vQdO1G3bO#;eQdO1G3bO#;jQdO<<HkOOQS<<Hl<<HlO#;zQdO7+)QOOQS<<Hs<<HsO#<[QtO1G1yP#<{QdO'#FsO#=YQdO7+)RO#=jQdO7+)RO#=rQdO<<HwO#=wQdO7+({OOQS<<Hy<<HyO#>nQdO,5<bO'vQdO,5<bOOQS-E9t-E9tOOQS<<Hw<<HwOOQS,5<g,5<gO0rQdO,5<gO#>sQdO1G4OOOQS-E9y-E9yO#?^QdO1G4OO<[QdO'#H{OOOO'#D{'#D{OOOO'#F|'#F|O#?oO&jO,5:fOOOW,5>e,5>eOOOW7+)i7+)iO#?zQdO7+)iO#@SQdO1G2zO#@mQdO1G2zP'vQdO'#FuO0rQdO<<IpO1XQdO1G2YP1XQdO'#GSO#AOQdO7+)pO#AaQdO7+)pOOQS<<Ir<<IrP1XQdO'#GUP0rQdO'#GQOOQS,5;],5;]O#ArQdO,5>mO#BQQdO,5>mOOQS1G0v1G0vOOQS<<Iz<<IzOOQV-E:V-E:VO4iQdO<<JQOOQV,5<s,5<sO4iQdO,5<sOOQV<<JQ<<JQOOQV<<JT<<JTO#BYQtO1G2`P#BdQdO'#GYO#BkQdO7+)uO#BuQgO<<JVO4iQdO<<JVOOQV<<J^<<J^O4iQdO<<J^O!KrQ!fO<<J^O#FpQgO7+&gOOQV<<JW<<JWO#FzQgO<<JWOOQV1G2a1G2aO1XQdO1G2aO#JuQdO1G2aO4iQdO<<JWO1XQdO1G2bP0rQdO'#G[O#KQQdO7+)vO#K_QdO7+)vOOQS'#FT'#FTO0rQdO,5>rO#KgQdO,5>rO#KrQdO,5>rO#K}QdO,5>qO#L`QdO,5>qOOQS1G1Y1G1YOOQS,5;p,5;pOOQV<<Jc<<JcO#LhQdO1G1dOOQS7+)T7+)TP#LmQdO'#FwO#L}QdO1G2OO#MbQdO1G2OO#MrQdO1G2OP#M}QdO'#FxO#N[QdO7+)VO#NlQdO7+)VO#NlQdO7+)VO#NtQdO7+)VO$ UQdO7+(|O8vQdO7+(|OOQSAN>VAN>VO$ oQdO<<LmOOQSAN>cAN>cO0rQdO1G1|O$!PQtO1G1|P$!ZQdO'#FvOOQS1G2R1G2RP$!hQdO'#F{O$!uQdO7+)jO$#`QdO,5>gOOOO-E9z-E9zOOOW<<MT<<MTO$#nQdO7+(fOOQSAN?[AN?[OOQS7+'t7+'tO$$XQdO<<M[OOQS,5<q,5<qO$$jQdO1G4XOOQS-E:T-E:TOOQVAN?lAN?lOOQV1G2_1G2_O4iQdOAN?qO$$xQgOAN?qOOQVAN?xAN?xO4iQdOAN?xOOQV<<JR<<JRO4iQdOAN?rO4iQdO7+'{OOQV7+'{7+'{O1XQdO7+'{OOQVAN?rAN?rOOQS7+'|7+'|O$(sQdO<<MbOOQS1G4^1G4^O0rQdO1G4^OOQS,5<w,5<wO$)QQdO1G4]OOQS-E:Z-E:ZOOQU'#G_'#G_O$)cQfO7+'OO$)nQdO'#F_O$*uQdO7+'jO$+VQdO7+'jOOQS7+'j7+'jO$+bQdO<<LqO$+rQdO<<LqO$+rQdO<<LqO$+zQdO'#H^OOQS<<Lh<<LhO$,UQdO<<LhOOQS7+'h7+'hOOQS'#D|'#D|OOOO1G4R1G4RO$,oQdO1G4RO$,wQdO1G4RP!=hQdO'#GVOOQVG25]G25]O4iQdOG25]OOQVG25dG25dOOQVG25^G25^OOQV<<Kg<<KgO4iQdO<<KgOOQS7+)x7+)xP$-SQdO'#G]OOQU-E:]-E:]OOQV<<Jj<<JjO$-vQtO'#FaOOQS'#Fc'#FcO$.WQdO'#FbO$.xQdO'#FbOOQS'#Fb'#FbO$.}QdO'#IYO$)nQdO'#FiO$)nQdO'#FiO$/fQdO'#FjO$)nQdO'#FkO$/mQdO'#IZOOQS'#IZ'#IZO$0[QdO,5;yOOQS<<KU<<KUO$0dQdO<<KUO$0tQdOANB]O$1UQdOANB]O$1^QdO'#H_OOQS'#H_'#H_O1sQdO'#DcO$1wQdO,5=xOOQSANBSANBSOOOO7+)m7+)mO$2`QdO7+)mOOQVLD*wLD*wOOQVANARANARO5uQ!fO'#GaO$2hQtO,5<SO$)nQdO'#FmOOQS,5<W,5<WOOQS'#Fd'#FdO$3YQdO,5;|O$3_QdO,5;|OOQS'#Fg'#FgO$)nQdO'#G`O$4PQdO,5<QO$4kQdO,5>tO$4{QdO,5>tO1XQdO,5<PO$5^QdO,5<TO$5cQdO,5<TO$)nQdO'#I[O$5hQdO'#I[O$5mQdO,5<UOOQS,5<V,5<VO0rQdO'#FpOOQU1G1e1G1eO4iQdO1G1eOOQSAN@pAN@pO$5rQdOG27wO$6SQdO,59}OOQS1G3d1G3dOOOO<<MX<<MXOOQS,5<{,5<{OOQS-E:_-E:_O$6XQtO'#FaO$6`QdO'#I]O$6nQdO'#I]O$6vQdO,5<XOOQS1G1h1G1hO$6{QdO1G1hO$7QQdO,5<zOOQS-E:^-E:^O$7lQdO,5=OO$8TQdO1G4`OOQS-E:b-E:bOOQS1G1k1G1kOOQS1G1o1G1oO$8eQdO,5>vO$)nQdO,5>vOOQS1G1p1G1pOOQS,5<[,5<[OOQU7+'P7+'PO$+zQdO1G/iO$)nQdO,5<YO$8sQdO,5>wO$8zQdO,5>wOOQS1G1s1G1sOOQS7+'S7+'SP$)nQdO'#GdO$9SQdO1G4bO$9^QdO1G4bO$9fQdO1G4bOOQS7+%T7+%TO$9tQdO1G1tO$:SQtO'#FaO$:ZQdO,5<}OOQS,5<},5<}O$:iQdO1G4cOOQS-E:a-E:aO$)nQdO,5<|O$:pQdO,5<|O$:uQdO7+)|OOQS-E:`-E:`O$;PQdO7+)|O$)nQdO,5<ZP$)nQdO'#GcO$;XQdO1G2hO$)nQdO1G2hP$;gQdO'#GbO$;nQdO<<MhO$;xQdO1G1uO$<WQdO7+(SO8vQdO'#C}O8vQdO,59bO8vQdO,59bO8vQdO,59bO$<fQtO,5=`O8vQdO1G.|O0rQdO1G/XO0rQdO7+$pP$<yQdO'#GOO'vQdO'#GtO$=WQdO,59bO$=]QdO,59bO$=dQdO,59mO$=iQdO1G/UO1sQdO'#DRO8vQdO,59j",stateData:"$>S~O%cOS%^OSSOS%]PQ~OPdOVaOfoOhYOopOs!POvqO!PrO!Q{O!T!SO!U!RO!XZO!][O!h`O!r`O!s`O!t`O!{tO!}uO#PvO#RwO#TxO#XyO#ZzO#^|O#_|O#a}O#c!OO#l!QO#o!TO#s!UO#u!VO#z!WO#}hO$P!XO%oRO%pRO%tSO%uWO&Z]O&[]O&]]O&^]O&_]O&`]O&a]O&b]O&c^O&d^O&e^O&f^O&g^O&h^O&i^O&j^O~O%]!YO~OV!aO_!aOa!bOh!iO!X!kO!f!mO%j![O%k!]O%l!^O%m!_O%n!_O%o!`O%p!`O%q!aO%r!aO%s!aO~Ok%xXl%xXm%xXn%xXo%xXp%xXs%xXz%xX{%xX!x%xX#g%xX%[%xX%_%xX%z%xXg%xX!T%xX!U%xX%{%xX!W%xX![%xX!Q%xX#[%xXt%xX!m%xX~P%SOfoOhYO!XZO!][O!h`O!r`O!s`O!t`O%oRO%pRO%tSO%uWO&Z]O&[]O&]]O&^]O&_]O&`]O&a]O&b]O&c^O&d^O&e^O&f^O&g^O&h^O&i^O&j^O~Oz%wX{%wX#g%wX%[%wX%_%wX%z%wX~Ok!pOl!qOm!oOn!oOo!rOp!sOs!tO!x%wX~P)pOV!zOg!|Oo0cOv0qO!PrO~P'vOV#OOo0cOv0qO!W#PO~P'vOV#SOa#TOo0cOv0qO![#UO~P'vOQ#XO%`#XO%a#ZO~OQ#^OR#[O%`#^O%a#`O~OV%iX_%iXa%iXh%iXk%iXl%iXm%iXn%iXo%iXp%iXs%iXz%iX!X%iX!f%iX%j%iX%k%iX%l%iX%m%iX%n%iX%o%iX%p%iX%q%iX%r%iX%s%iXg%iX!T%iX!U%iX~O&Z]O&[]O&]]O&^]O&_]O&`]O&a]O&b]O&c^O&d^O&e^O&f^O&g^O&h^O&i^O&j^O{%iX!x%iX#g%iX%[%iX%_%iX%z%iX%{%iX!W%iX![%iX!Q%iX#[%iXt%iX!m%iX~P,eOz#dO{%hX!x%hX#g%hX%[%hX%_%hX%z%hX~Oo0cOv0qO~P'vO#g#gO%[#iO%_#iO~O%uWO~O!T#nO#u!VO#z!WO#}hO~OopO~P'vOV#sOa#tO%uWO{wP~OV#xOo0cOv0qO!Q#yO~P'vO{#{O!x$QO%z#|O#g!yX%[!yX%_!yX~OV#xOo0cOv0qO#g#SX%[#SX%_#SX~P'vOo0cOv0qO#g#WX%[#WX%_#WX~P'vOh$WO%uWO~O!f$YO!r$YO%uWO~OV$eO~P'vO!U$gO#s$hO#u$iO~O{$jO~OV$qO~P'vOS$sO%[$rO%_$rO%c$tO~OV$}Oa$}Og%POo0cOv0qO~P'vOo0cOv0qO{%SO~P'vO&Y%UO~Oa!bOh!iO!X!kO!f!mOVba_bakbalbambanbaobapbasbazba{ba!xba#gba%[ba%_ba%jba%kba%lba%mba%nba%oba%pba%qba%rba%sba%zbagba!Tba!Uba%{ba!Wba![ba!Qba#[batba!mba~On%ZO~Oo%ZO~P'vOo0cO~P'vOk0eOl0fOm0dOn0dOo0mOp0nOs0rOg%wX!T%wX!U%wX%{%wX!W%wX![%wX!Q%wX#[%wX!m%wX~P)pO%{%]Og%vXz%vX!T%vX!U%vX!W%vX{%vX~Og%_Oz%`O!T%dO!U%cO~Og%_O~Oz%gO!T%dO!U%cO!W&SX~O!W%kO~Oz%lO{%nO!T%dO!U%cO![%}X~O![%rO~O![%sO~OQ#XO%`#XO%a%uO~OV%wOo0cOv0qO!PrO~P'vOQ#^OR#[O%`#^O%a%zO~OV!qa_!qaa!qah!qak!qal!qam!qan!qao!qap!qas!qaz!qa{!qa!X!qa!f!qa!x!qa#g!qa%[!qa%_!qa%j!qa%k!qa%l!qa%m!qa%n!qa%o!qa%p!qa%q!qa%r!qa%s!qa%z!qag!qa!T!qa!U!qa%{!qa!W!qa![!qa!Q!qa#[!qat!qa!m!qa~P#yOz%|O{%ha!x%ha#g%ha%[%ha%_%ha%z%ha~P%SOV&OOopOvqO{%ha!x%ha#g%ha%[%ha%_%ha%z%ha~P'vOz%|O{%ha!x%ha#g%ha%[%ha%_%ha%z%ha~OPdOVaOopOvqO!PrO!Q{O!{tO!}uO#PvO#RwO#TxO#XyO#ZzO#^|O#_|O#a}O#c!OO#g$zX%[$zX%_$zX~P'vO#g#gO%[&TO%_&TO~O!f&UOh&sX%[&sXz&sX#[&sX#g&sX%_&sX#Z&sXg&sX~Oh!iO%[&WO~Okealeameaneaoeapeaseazea{ea!xea#gea%[ea%_ea%zeagea!Tea!Uea%{ea!Wea![ea!Qea#[eatea!mea~P%SOsqazqa{qa#gqa%[qa%_qa%zqa~Ok!pOl!qOm!oOn!oOo!rOp!sO!xqa~PEcO%z&YOz%yX{%yX~O%uWOz%yX{%yX~Oz&]O{wX~O{&_O~Oz%lO#g%}X%[%}X%_%}Xg%}X{%}X![%}X!m%}X%z%}X~OV0lOo0cOv0qO!PrO~P'vO%z#|O#gUa%[Ua%_Ua~Oz&hO#g&PX%[&PX%_&PXn&PX~P%SOz&kO!Q&jO#g#Wa%[#Wa%_#Wa~Oz&lO#[&nO#g&rX%[&rX%_&rXg&rX~O!f$YO!r$YO#Z&qO%uWO~O#Z&qO~Oz&sO#g&tX%[&tX%_&tX~Oz&uO#g&pX%[&pX%_&pX{&pX~O!X&wO%z&xO~Oz&|On&wX~P%SOn'PO~OPdOVaOopOvqO!PrO!Q{O!{tO!}uO#PvO#RwO#TxO#XyO#ZzO#^|O#_|O#a}O#c!OO%['UO~P'vOt'YO#p'WO#q'XOP#naV#naf#nah#nao#nas#nav#na!P#na!Q#na!T#na!U#na!X#na!]#na!h#na!r#na!s#na!t#na!{#na!}#na#P#na#R#na#T#na#X#na#Z#na#^#na#_#na#a#na#c#na#l#na#o#na#s#na#u#na#z#na#}#na$P#na%X#na%o#na%p#na%t#na%u#na&Z#na&[#na&]#na&^#na&_#na&`#na&a#na&b#na&c#na&d#na&e#na&f#na&g#na&h#na&i#na&j#na%Z#na%_#na~Oz'ZO#[']O{&xX~Oh'_O!X&wO~Oh!iO{$jO!X&wO~O{'eO~P%SO%['hO%_'hO~OS'iO%['hO%_'hO~OV!aO_!aOa!bOh!iO!X!kO!f!mO%l!^O%m!_O%n!_O%o!`O%p!`O%q!aO%r!aO%s!aOkWilWimWinWioWipWisWizWi{Wi!xWi#gWi%[Wi%_Wi%jWi%zWigWi!TWi!UWi%{Wi!WWi![Wi!QWi#[WitWi!mWi~O%k!]O~P!#uO%kWi~P!#uOV!aO_!aOa!bOh!iO!X!kO!f!mO%o!`O%p!`O%q!aO%r!aO%s!aOkWilWimWinWioWipWisWizWi{Wi!xWi#gWi%[Wi%_Wi%jWi%kWi%lWi%zWigWi!TWi!UWi%{Wi!WWi![Wi!QWi#[WitWi!mWi~O%m!_O%n!_O~P!&pO%mWi%nWi~P!&pOa!bOh!iO!X!kO!f!mOkWilWimWinWioWipWisWizWi{Wi!xWi#gWi%[Wi%_Wi%jWi%kWi%lWi%mWi%nWi%oWi%pWi%zWigWi!TWi!UWi%{Wi!WWi![Wi!QWi#[WitWi!mWi~OV!aO_!aO%q!aO%r!aO%s!aO~P!)nOVWi_Wi%qWi%rWi%sWi~P!)nO!T%dO!U%cOg&VXz&VX~O%z'kO%{'kO~P,eOz'mOg&UX~Og'oO~Oz'pO{'rO!W&XX~Oo0cOv0qOz'pO{'sO!W&XX~P'vO!W'uO~Om!oOn!oOo!rOp!sOkjisjizji{ji!xji#gji%[ji%_ji%zji~Ol!qO~P!.aOlji~P!.aOk0eOl0fOm0dOn0dOo0mOp0nO~Ot'wO~P!/jOV'|Og'}Oo0cOv0qO~P'vOg'}Oz(OO~Og(QO~O!U(SO~Og(TOz(OO!T%dO!U%cO~P%SOk0eOl0fOm0dOn0dOo0mOp0nOgqa!Tqa!Uqa%{qa!Wqa![qa!Qqa#[qatqa!mqa~PEcOV'|Oo0cOv0qO!W&Sa~P'vOz(WO!W&Sa~O!W(XO~Oz(WO!T%dO!U%cO!W&Sa~P%SOV(]Oo0cOv0qO![%}a#g%}a%[%}a%_%}ag%}a{%}a!m%}a%z%}a~P'vOz(^O![%}a#g%}a%[%}a%_%}ag%}a{%}a!m%}a%z%}a~O![(aO~Oz(^O!T%dO!U%cO![%}a~P%SOz(dO!T%dO!U%cO![&Ta~P%SOz(gO{&lX![&lX!m&lX%z&lX~O{(kO![(mO!m(nO%z(jO~OV&OOopOvqO{%hi!x%hi#g%hi%[%hi%_%hi%z%hi~P'vOz(pO{%hi!x%hi#g%hi%[%hi%_%hi%z%hi~O!f&UOh&sa%[&saz&sa#[&sa#g&sa%_&sa#Z&sag&sa~O%[(uO~OV#sOa#tO%uWO~Oz&]O{wa~OopOvqO~P'vOz(^O#g%}a%[%}a%_%}ag%}a{%}a![%}a!m%}a%z%}a~P%SOz(zO#g%hX%[%hX%_%hX%z%hX~O%z#|O#gUi%[Ui%_Ui~O#g&Pa%[&Pa%_&Pan&Pa~P'vOz(}O#g&Pa%[&Pa%_&Pan&Pa~O%uWO#g&ra%[&ra%_&rag&ra~Oz)SO#g&ra%[&ra%_&rag&ra~Og)VO~OV)WOh$WO%uWO~O#Z)XO~O%uWO#g&ta%[&ta%_&ta~Oz)ZO#g&ta%[&ta%_&ta~Oo0cOv0qO#g&pa%[&pa%_&pa{&pa~P'vOz)^O#g&pa%[&pa%_&pa{&pa~OV)`Oa)`O%uWO~O%z)eO~Ot)hO#j)gOP#hiV#hif#hih#hio#his#hiv#hi!P#hi!Q#hi!T#hi!U#hi!X#hi!]#hi!h#hi!r#hi!s#hi!t#hi!{#hi!}#hi#P#hi#R#hi#T#hi#X#hi#Z#hi#^#hi#_#hi#a#hi#c#hi#l#hi#o#hi#s#hi#u#hi#z#hi#}#hi$P#hi%X#hi%o#hi%p#hi%t#hi%u#hi&Z#hi&[#hi&]#hi&^#hi&_#hi&`#hi&a#hi&b#hi&c#hi&d#hi&e#hi&f#hi&g#hi&h#hi&i#hi&j#hi%Z#hi%_#hi~Ot)iOP#kiV#kif#kih#kio#kis#kiv#ki!P#ki!Q#ki!T#ki!U#ki!X#ki!]#ki!h#ki!r#ki!s#ki!t#ki!{#ki!}#ki#P#ki#R#ki#T#ki#X#ki#Z#ki#^#ki#_#ki#a#ki#c#ki#l#ki#o#ki#s#ki#u#ki#z#ki#}#ki$P#ki%X#ki%o#ki%p#ki%t#ki%u#ki&Z#ki&[#ki&]#ki&^#ki&_#ki&`#ki&a#ki&b#ki&c#ki&d#ki&e#ki&f#ki&g#ki&h#ki&i#ki&j#ki%Z#ki%_#ki~OV)kOn&wa~P'vOz)lOn&wa~Oz)lOn&wa~P%SOn)pO~O%Y)tO~Ot)wO#p'WO#q)vOP#niV#nif#nih#nio#nis#niv#ni!P#ni!Q#ni!T#ni!U#ni!X#ni!]#ni!h#ni!r#ni!s#ni!t#ni!{#ni!}#ni#P#ni#R#ni#T#ni#X#ni#Z#ni#^#ni#_#ni#a#ni#c#ni#l#ni#o#ni#s#ni#u#ni#z#ni#}#ni$P#ni%X#ni%o#ni%p#ni%t#ni%u#ni&Z#ni&[#ni&]#ni&^#ni&_#ni&`#ni&a#ni&b#ni&c#ni&d#ni&e#ni&f#ni&g#ni&h#ni&i#ni&j#ni%Z#ni%_#ni~OV)zOo0cOv0qO{$jO~P'vOo0cOv0qO{&xa~P'vOz*OO{&xa~OV*SOa*TOg*WO%q*UO%uWO~O{$jO&{*YO~Oh'_O~Oh!iO{$jO~O%[*_O~O%[*aO%_*aO~OV$}Oa$}Oo0cOv0qOg&Ua~P'vOz*dOg&Ua~Oo0cOv0qO{*gO!W&Xa~P'vOz*hO!W&Xa~Oo0cOv0qOz*hO{*kO!W&Xa~P'vOo0cOv0qOz*hO!W&Xa~P'vOz*hO{*kO!W&Xa~Om0dOn0dOo0mOp0nOgjikjisjizji!Tji!Uji%{ji!Wji{ji![ji#gji%[ji%_ji!Qji#[jitji!mji%zji~Ol0fO~P!NkOlji~P!NkOV'|Og*pOo0cOv0qO~P'vOn*rO~Og*pOz*tO~Og*uO~OV'|Oo0cOv0qO!W&Si~P'vOz*vO!W&Si~O!W*wO~OV(]Oo0cOv0qO![%}i#g%}i%[%}i%_%}ig%}i{%}i!m%}i%z%}i~P'vOz*zO!T%dO!U%cO![&Ti~Oz*}O![%}i#g%}i%[%}i%_%}ig%}i{%}i!m%}i%z%}i~O![+OO~Oa+QOo0cOv0qO![&Ti~P'vOz*zO![&Ti~O![+SO~OV+UOo0cOv0qO{&la![&la!m&la%z&la~P'vOz+VO{&la![&la!m&la%z&la~O!]+YO&n+[O![!nX~O![+^O~O{(kO![+_O~O{(kO![+_O!m+`O~OV&OOopOvqO{%hq!x%hq#g%hq%[%hq%_%hq%z%hq~P'vOz$ri{$ri!x$ri#g$ri%[$ri%_$ri%z$ri~P%SOV&OOopOvqO~P'vOV&OOo0cOv0qO#g%ha%[%ha%_%ha%z%ha~P'vOz+aO#g%ha%[%ha%_%ha%z%ha~Oz$ia#g$ia%[$ia%_$ian$ia~P%SO#g&Pi%[&Pi%_&Pin&Pi~P'vOz+dO#g#Wq%[#Wq%_#Wq~O#[+eOz$va#g$va%[$va%_$vag$va~O%uWO#g&ri%[&ri%_&rig&ri~Oz+gO#g&ri%[&ri%_&rig&ri~OV+iOh$WO%uWO~O%uWO#g&ti%[&ti%_&ti~Oo0cOv0qO#g&pi%[&pi%_&pi{&pi~P'vO{#{Oz#eX!W#eX~Oz+mO!W&uX~O!W+oO~Ot+rO#j)gOP#hqV#hqf#hqh#hqo#hqs#hqv#hq!P#hq!Q#hq!T#hq!U#hq!X#hq!]#hq!h#hq!r#hq!s#hq!t#hq!{#hq!}#hq#P#hq#R#hq#T#hq#X#hq#Z#hq#^#hq#_#hq#a#hq#c#hq#l#hq#o#hq#s#hq#u#hq#z#hq#}#hq$P#hq%X#hq%o#hq%p#hq%t#hq%u#hq&Z#hq&[#hq&]#hq&^#hq&_#hq&`#hq&a#hq&b#hq&c#hq&d#hq&e#hq&f#hq&g#hq&h#hq&i#hq&j#hq%Z#hq%_#hq~On$|az$|a~P%SOV)kOn&wi~P'vOz+yOn&wi~Oz,TO{$jO#[,TO~O#q,VOP#nqV#nqf#nqh#nqo#nqs#nqv#nq!P#nq!Q#nq!T#nq!U#nq!X#nq!]#nq!h#nq!r#nq!s#nq!t#nq!{#nq!}#nq#P#nq#R#nq#T#nq#X#nq#Z#nq#^#nq#_#nq#a#nq#c#nq#l#nq#o#nq#s#nq#u#nq#z#nq#}#nq$P#nq%X#nq%o#nq%p#nq%t#nq%u#nq&Z#nq&[#nq&]#nq&^#nq&_#nq&`#nq&a#nq&b#nq&c#nq&d#nq&e#nq&f#nq&g#nq&h#nq&i#nq&j#nq%Z#nq%_#nq~O#[,WOz%Oa{%Oa~Oo0cOv0qO{&xi~P'vOz,YO{&xi~O{#{O%z,[Og&zXz&zX~O%uWOg&zXz&zX~Oz,`Og&yX~Og,bO~O%Y,eO~O!T%dO!U%cOg&Viz&Vi~OV$}Oa$}Oo0cOv0qOg&Ui~P'vO{,hOz$la!W$la~Oo0cOv0qO{,iOz$la!W$la~P'vOo0cOv0qO{*gO!W&Xi~P'vOz,lO!W&Xi~Oo0cOv0qOz,lO!W&Xi~P'vOz,lO{,oO!W&Xi~Og$hiz$hi!W$hi~P%SOV'|Oo0cOv0qO~P'vOn,qO~OV'|Og,rOo0cOv0qO~P'vOV'|Oo0cOv0qO!W&Sq~P'vOz$gi![$gi#g$gi%[$gi%_$gig$gi{$gi!m$gi%z$gi~P%SOV(]Oo0cOv0qO~P'vOa+QOo0cOv0qO![&Tq~P'vOz,sO![&Tq~O![,tO~OV(]Oo0cOv0qO![%}q#g%}q%[%}q%_%}qg%}q{%}q!m%}q%z%}q~P'vO{,uO~OV+UOo0cOv0qO{&li![&li!m&li%z&li~P'vOz,zO{&li![&li!m&li%z&li~O!]+YO&n+[O![!na~O{(kO![,}O~OV&OOo0cOv0qO#g%hi%[%hi%_%hi%z%hi~P'vOz-OO#g%hi%[%hi%_%hi%z%hi~O%uWO#g&rq%[&rq%_&rqg&rq~Oz-RO#g&rq%[&rq%_&rqg&rq~OV)`Oa)`O%uWO!W&ua~Oz-TO!W&ua~On$|iz$|i~P%SOV)kO~P'vOV)kOn&wq~P'vOt-XOP#myV#myf#myh#myo#mys#myv#my!P#my!Q#my!T#my!U#my!X#my!]#my!h#my!r#my!s#my!t#my!{#my!}#my#P#my#R#my#T#my#X#my#Z#my#^#my#_#my#a#my#c#my#l#my#o#my#s#my#u#my#z#my#}#my$P#my%X#my%o#my%p#my%t#my%u#my&Z#my&[#my&]#my&^#my&_#my&`#my&a#my&b#my&c#my&d#my&e#my&f#my&g#my&h#my&i#my&j#my%Z#my%_#my~O%Z-]O%_-]O~P`O#q-^OP#nyV#nyf#nyh#nyo#nys#nyv#ny!P#ny!Q#ny!T#ny!U#ny!X#ny!]#ny!h#ny!r#ny!s#ny!t#ny!{#ny!}#ny#P#ny#R#ny#T#ny#X#ny#Z#ny#^#ny#_#ny#a#ny#c#ny#l#ny#o#ny#s#ny#u#ny#z#ny#}#ny$P#ny%X#ny%o#ny%p#ny%t#ny%u#ny&Z#ny&[#ny&]#ny&^#ny&_#ny&`#ny&a#ny&b#ny&c#ny&d#ny&e#ny&f#ny&g#ny&h#ny&i#ny&j#ny%Z#ny%_#ny~Oz-aO{$jO#[-aO~Oo0cOv0qO{&xq~P'vOz-dO{&xq~O%z,[Og&zaz&za~O{#{Og&zaz&za~OV*SOa*TO%q*UO%uWOg&ya~Oz-hOg&ya~O$S-lO~OV$}Oa$}Oo0cOv0qO~P'vOo0cOv0qO{-mOz$li!W$li~P'vOo0cOv0qOz$li!W$li~P'vO{-mOz$li!W$li~Oo0cOv0qO{*gO~P'vOo0cOv0qO{*gO!W&Xq~P'vOz-pO!W&Xq~Oo0cOv0qOz-pO!W&Xq~P'vOs-sO!T%dO!U%cOg&Oq!W&Oq![&Oqz&Oq~P!/jOa+QOo0cOv0qO![&Ty~P'vOz$ji![$ji~P%SOa+QOo0cOv0qO~P'vOV+UOo0cOv0qO~P'vOV+UOo0cOv0qO{&lq![&lq!m&lq%z&lq~P'vO{(kO![-xO!m-yO%z-wO~OV&OOo0cOv0qO#g%hq%[%hq%_%hq%z%hq~P'vO%uWO#g&ry%[&ry%_&ryg&ry~OV)`Oa)`O%uWO!W&ui~Ot-}OP#m!RV#m!Rf#m!Rh#m!Ro#m!Rs#m!Rv#m!R!P#m!R!Q#m!R!T#m!R!U#m!R!X#m!R!]#m!R!h#m!R!r#m!R!s#m!R!t#m!R!{#m!R!}#m!R#P#m!R#R#m!R#T#m!R#X#m!R#Z#m!R#^#m!R#_#m!R#a#m!R#c#m!R#l#m!R#o#m!R#s#m!R#u#m!R#z#m!R#}#m!R$P#m!R%X#m!R%o#m!R%p#m!R%t#m!R%u#m!R&Z#m!R&[#m!R&]#m!R&^#m!R&_#m!R&`#m!R&a#m!R&b#m!R&c#m!R&d#m!R&e#m!R&f#m!R&g#m!R&h#m!R&i#m!R&j#m!R%Z#m!R%_#m!R~Oo0cOv0qO{&xy~P'vOV*SOa*TO%q*UO%uWOg&yi~O$S-lO%Z.VO%_.VO~OV.aOh._O!X.^O!].`O!h.YO!s.[O!t.[O%p.XO%uWO&Z]O&[]O&]]O&^]O&_]O&`]O&a]O&b]O~Oo0cOv0qOz$lq!W$lq~P'vO{.fOz$lq!W$lq~Oo0cOv0qO{*gO!W&Xy~P'vOz.gO!W&Xy~Oo0cOv.kO~P'vOs-sO!T%dO!U%cOg&Oy!W&Oy![&Oyz&Oy~P!/jO{(kO![.nO~O{(kO![.nO!m.oO~OV*SOa*TO%q*UO%uWO~Oh.tO!f.rOz$TX#[$TX%j$TXg$TX~Os$TX{$TX!W$TX![$TX~P$-bO%o.vO%p.vOs$UXz$UX{$UX#[$UX%j$UX!W$UXg$UX![$UX~O!h.xO~Oz.|O#[/OO%j.yOs&|X{&|X!W&|Xg&|X~Oa/RO~P$)zOh.tOs&}Xz&}X{&}X#[&}X%j&}X!W&}Xg&}X![&}X~Os/VO{$jO~Oo0cOv0qOz$ly!W$ly~P'vOo0cOv0qO{*gO!W&X!R~P'vOz/ZO!W&X!R~Og&RXs&RX!T&RX!U&RX!W&RX![&RXz&RX~P!/jOs-sO!T%dO!U%cOg&Qa!W&Qa![&Qaz&Qa~O{(kO![/^O~O!f.rOh$[as$[az$[a{$[a#[$[a%j$[a!W$[ag$[a![$[a~O!h/eO~O%o.vO%p.vOs$Uaz$Ua{$Ua#[$Ua%j$Ua!W$Uag$Ua![$Ua~O%j.yOs$Yaz$Ya{$Ya#[$Ya!W$Yag$Ya![$Ya~Os&|a{&|a!W&|ag&|a~P$)nOz/jOs&|a{&|a!W&|ag&|a~O!W/mO~Og/mO~O{/oO~O![/pO~Oo0cOv0qO{*gO!W&X!Z~P'vO{/sO~O%z/tO~P$-bOz/uO#[/OO%j.yOg'PX~Oz/uOg'PX~Og/wO~O!h/xO~O#[/OOs%Saz%Sa{%Sa%j%Sa!W%Sag%Sa![%Sa~O#[/OO%j.yOs%Waz%Wa{%Wa!W%Wag%Wa~Os&|i{&|i!W&|ig&|i~P$)nOz/zO#[/OO%j.yO!['Oa~Og'Pa~P$)nOz0SOg'Pa~Oa0UO!['Oi~P$)zOz0WO!['Oi~Oz0WO#[/OO%j.yO!['Oi~O#[/OO%j.yOg$biz$bi~O%z0ZO~P$-bO#[/OO%j.yOg%Vaz%Va~Og'Pi~P$)nO{0^O~Oa0UO!['Oq~P$)zOz0`O!['Oq~O#[/OO%j.yOz%Ui![%Ui~Oa0UO~P$)zOa0UO!['Oy~P$)zO#[/OO%j.yOg$ciz$ci~O#[/OO%j.yOz%Uq![%Uq~Oz+aO#g%ha%[%ha%_%ha%z%ha~P%SOV&OOo0cOv0qO~P'vOn0hO~Oo0hO~P'vO{0iO~Ot0jO~P!/jO&]&Z&j&h&i&g&f&d&e&c&b&`&a&_&^&[%u~",goto:"!=j'QPPPPPP'RP'Z*s+[+t,_,y-fP.SP'Z.r.r'ZPPP'Z2[PPPPPP2[5PPP5PP7b7k=sPP=v>h>kPP'Z'ZPP>zPP'Z'ZPP'Z'Z'Z'Z'Z?O?w'ZP?zP@QDXGuGyPG|HWH['ZPPPH_Hk'RP'R'RP'RP'RP'RP'RP'R'R'RP'RPP'RPP'RP'RPHqH}IVPI^IdPI^PI^I^PPPI^PKrPK{LVL]KrPI^LfPI^PLmLsPLwM]MzNeLwLwNkNxLwLwLwLw! ^! d! g! l! o! y!!P!!]!!o!!u!#P!#V!#s!#y!$P!$Z!$a!$g!$y!%T!%Z!%a!%k!%q!%w!%}!&T!&Z!&e!&k!&u!&{!'U!'[!'k!'s!'}!(UPPPPPPPPPPP!([!(_!(e!(n!(x!)TPPPPPPPPPPPP!-u!/Z!3^!6oPP!6w!7W!7a!8Y!8P!8c!8i!8l!8o!8r!8z!9jPPPPPPPPPPPPPPPPP!9m!9q!9wP!:]!:a!:m!:v!;S!;j!;m!;p!;v!;|!<S!<VP!<_!<h!=d!=g]eOn#g$j)t,P'}`OTYZ[adnoprtxy}!P!Q!R!U!X!c!d!e!f!g!h!i!k!o!p!q!s!t!z#O#S#T#[#d#g#x#y#{#}$Q$e$g$h$j$q$}%S%Z%^%`%c%g%l%n%w%|&O&Z&_&h&j&k&u&x&|'P'W'Z'l'm'p'r's'w'|(O(S(W(](^(d(g(p(r(z(})^)e)g)k)l)p)t)z*O*Y*d*g*h*k*q*r*t*v*y*z*}+Q+U+V+Y+a+c+d+k+x+y,P,X,Y,],g,h,i,k,l,o,q,s,u,w,y,z-O-d-f-m-p-s.f.g/V/Z/s0c0d0e0f0h0i0j0k0l0n0r{!cQ#c#p$R$d$p%e%j%p%q&`'O'g(q(|)j*o*x+w,v0g}!dQ#c#p$R$d$p$u%e%j%p%q&`'O'g(q(|)j*o*x+w,v0g!P!eQ#c#p$R$d$p$u$v%e%j%p%q&`'O'g(q(|)j*o*x+w,v0g!R!fQ#c#p$R$d$p$u$v$w%e%j%p%q&`'O'g(q(|)j*o*x+w,v0g!T!gQ#c#p$R$d$p$u$v$w$x%e%j%p%q&`'O'g(q(|)j*o*x+w,v0g!V!hQ#c#p$R$d$p$u$v$w$x$y%e%j%p%q&`'O'g(q(|)j*o*x+w,v0g!Z!hQ!n#c#p$R$d$p$u$v$w$x$y$z%e%j%p%q&`'O'g(q(|)j*o*x+w,v0g'}TOTYZ[adnoprtxy}!P!Q!R!U!X!c!d!e!f!g!h!i!k!o!p!q!s!t!z#O#S#T#[#d#g#x#y#{#}$Q$e$g$h$j$q$}%S%Z%^%`%c%g%l%n%w%|&O&Z&_&h&j&k&u&x&|'P'W'Z'l'm'p'r's'w'|(O(S(W(](^(d(g(p(r(z(})^)e)g)k)l)p)t)z*O*Y*d*g*h*k*q*r*t*v*y*z*}+Q+U+V+Y+a+c+d+k+x+y,P,X,Y,],g,h,i,k,l,o,q,s,u,w,y,z-O-d-f-m-p-s.f.g/V/Z/s0c0d0e0f0h0i0j0k0l0n0r&eVOYZ[dnprxy}!P!Q!U!i!k!o!p!q!s!t#[#d#g#y#{#}$Q$h$j$}%S%Z%^%`%g%l%n%w%|&Z&_&j&k&u&x'P'W'Z'l'm'p'r's'w(O(W(^(d(g(p(r(z)^)e)g)p)t)z*O*Y*d*g*h*k*q*r*t*v*y*z*}+U+V+Y+a+d+k,P,X,Y,],g,h,i,k,l,o,q,s,u,w,y,z-O-d-f-m-p-s.f.g/V/Z/s0c0d0e0f0h0i0j0k0n0r%oXOYZ[dnrxy}!P!Q!U!i!k#[#d#g#y#{#}$Q$h$j$}%S%^%`%g%l%n%w%|&Z&_&j&k&u&x'P'W'Z'l'm'p'r's'w(O(W(^(d(g(p(r(z)^)e)g)p)t)z*O*Y*d*g*h*k*q*t*v*y*z*}+U+V+Y+a+d+k,P,X,Y,],g,h,i,k,l,o,s,u,w,y,z-O-d-f-m-p.f.g/V/Z0i0j0kQ#vqQ/[.kR0o0q't`OTYZ[adnoprtxy}!P!Q!R!U!X!c!d!e!f!g!h!k!o!p!q!s!t!z#O#S#T#[#d#g#x#y#{#}$Q$e$g$h$j$q$}%S%Z%^%`%c%g%l%n%w%|&O&Z&_&h&j&k&u&x&|'P'W'Z'l'p'r's'w'|(O(S(W(](^(d(g(p(r(z(})^)e)g)k)l)p)t)z*O*Y*g*h*k*q*r*t*v*y*z*}+Q+U+V+Y+a+c+d+k+x+y,P,X,Y,],h,i,k,l,o,q,s,u,w,y,z-O-d-f-m-p-s.f.g/V/Z/s0c0d0e0f0h0i0j0k0l0n0rh#jhz{$W$Z&l&q)S)X+f+g-RW#rq&].k0qQ$]|Q$a!OQ$n!VQ$o!WW$|!i'm*d,gS&[#s#tQ'S$iQ(s&UQ)U&nU)Y&s)Z+jW)a&w+m-T-{Q*Q']W*R'_,`-h.TQ+l)`S,_*S*TQ-Q+eQ-_,TQ-c,WQ.R-al.W-l.^._.a.z.|/R/j/o/t/y0U0Z0^Q/S.`Q/a.tQ/l/OU0P/u0S0[X0V/z0W0_0`R&Z#r!_!wYZ!P!Q!k%S%`%g'p'r's(O(W)g*g*h*k*q*t*v,h,i,k,l,o-m-p.f.g/ZR%^!vQ!{YQ%x#[Q&d#}Q&g$QR,{+YT.j-s/s!Y!jQ!n#c#p$R$d$p$u$v$w$x$y$z%e%j%p%q&`'O'g(q(|)j*o*x+w,v0gQ&X#kQ'c$oR*^'dR'l$|Q%V!mR/_.r'|_OTYZ[adnoprtxy}!P!Q!R!U!X!c!d!e!f!g!h!i!k!o!p!q!s!t!z#O#S#T#[#d#g#x#y#{#}$Q$e$g$h$j$q$}%S%Z%^%`%c%g%l%n%w%|&O&Z&_&h&j&k&u&x&|'P'W'Z'l'm'p'r's'w'|(O(S(W(](^(d(g(p(r(z(})^)e)g)k)l)p)t)z*O*Y*d*g*h*k*q*r*t*v*y*z*}+Q+U+V+Y+a+c+d+k+x+y,P,X,Y,],g,h,i,k,l,o,q,s,u,w,y,z-O-d-f-m-p-s.f.g/V/Z/s0c0d0e0f0h0i0j0k0l0n0rS#a_#b!P.[-l.^._.`.a.t.z.|/R/j/o/t/u/y/z0S0U0W0Z0[0^0_0`'|_OTYZ[adnoprtxy}!P!Q!R!U!X!c!d!e!f!g!h!i!k!o!p!q!s!t!z#O#S#T#[#d#g#x#y#{#}$Q$e$g$h$j$q$}%S%Z%^%`%c%g%l%n%w%|&O&Z&_&h&j&k&u&x&|'P'W'Z'l'm'p'r's'w'|(O(S(W(](^(d(g(p(r(z(})^)e)g)k)l)p)t)z*O*Y*d*g*h*k*q*r*t*v*y*z*}+Q+U+V+Y+a+c+d+k+x+y,P,X,Y,],g,h,i,k,l,o,q,s,u,w,y,z-O-d-f-m-p-s.f.g/V/Z/s0c0d0e0f0h0i0j0k0l0n0rT#a_#bT#^^#_R(o%xa(l%x(n(o+`,{-y-z.oT+[(k+]R-z,{Q$PsQ+l)aQ,^*RR-e,_X#}s$O$P&fQ&y$aQ'a$nQ'd$oR)s'SQ)b&wV-S+m-T-{ZgOn$j)t,PXkOn)t,PQ$k!TQ&z$bQ&{$cQ'^$mQ'b$oQ)q'RQ)x'WQ){'XQ)|'YQ*Z'`S*]'c'dQ+s)gQ+u)hQ+v)iQ+z)oS+|)r*[Q,Q)vQ,R)wS,S)y)zQ,d*^Q-V+rQ-W+tQ-Y+{S-Z+},OQ-`,UQ-b,VQ-|-XQ.O-[Q.P-^Q.Q-_Q.p-}Q.q.RQ/W.dR/r/XWkOn)t,PR#mjQ'`$nS)r'S'aR,O)sQ,]*RR-f,^Q*['`Q+})rR-[,OZiOjn)t,PQ'f$pR*`'gT-j,e-ku.c-l.^._.a.t.z.|/R/j/o/t/u/y0S0U0Z0[0^t.c-l.^._.a.t.z.|/R/j/o/t/u/y0S0U0Z0[0^Q/S.`X0V/z0W0_0`!P.Z-l.^._.`.a.t.z.|/R/j/o/t/u/y/z0S0U0W0Z0[0^0_0`Q.w.YR/f.xg.z.].{/b/i/n/|0O0Q0]0a0bu.b-l.^._.a.t.z.|/R/j/o/t/u/y0S0U0Z0[0^X.u.W.b/a0PR/c.tV0R/u0S0[R/X.dQnOS#on,PR,P)tQ&^#uR(x&^S%m#R#wS(_%m(bT(b%p&`Q%a!yQ%h!}W(P%a%h(U(YQ(U%eR(Y%jQ&i$RR)O&iQ(e%qQ*{(`T+R(e*{Q'n%OR*e'nS'q%R%SY*i'q*j,m-q.hU*j'r's'tU,m*k*l*mS-q,n,oR.h-rQ#Y]R%t#YQ#_^R%y#_Q(h%vS+W(h+XR+X(iQ+](kR,|+]Q#b_R%{#bQ#ebQ%}#cW&Q#e%}({+bQ({&cR+b0gQ$OsS&e$O&fR&f$PQ&v$_R)_&vQ&V#jR(t&VQ&m$VS)T&m+hR+h)UQ$Z{R&p$ZQ&t$]R)[&tQ+n)bR-U+nQ#hfR&S#hQ)f&zR+q)fQ&}$dS)m&})nR)n'OQ'V$kR)u'VQ'[$lS*P'[,ZR,Z*QQ,a*VR-i,aWjOn)t,PR#ljQ-k,eR.U-kd.{.]/b/i/n/|0O0Q0]0a0bR/h.{U.s.W/a0PR/`.sQ/{/nS0X/{0YR0Y/|S/v/b/cR0T/vQ.}.]R/k.}R!ZPXmOn)t,PWlOn)t,PR'T$jYfOn$j)t,PR&R#g[sOn#g$j)t,PR&d#}&dQOYZ[dnprxy}!P!Q!U!i!k!o!p!q!s!t#[#d#g#y#{#}$Q$h$j$}%S%Z%^%`%g%l%n%w%|&Z&_&j&k&u&x'P'W'Z'l'm'p'r's'w(O(W(^(d(g(p(r(z)^)e)g)p)t)z*O*Y*d*g*h*k*q*r*t*v*y*z*}+U+V+Y+a+d+k,P,X,Y,],g,h,i,k,l,o,q,s,u,w,y,z-O-d-f-m-p-s.f.g/V/Z/s0c0d0e0f0h0i0j0k0n0rQ!nTQ#caQ#poU$Rt%c(SS$d!R$gQ$p!XQ$u!cQ$v!dQ$w!eQ$x!fQ$y!gQ$z!hQ%e!zQ%j#OQ%p#SQ%q#TQ&`#xQ'O$eQ'g$qQ(q&OU(|&h(}+cW)j&|)l+x+yQ*o'|Q*x(]Q+w)kQ,v+QR0g0lQ!yYQ!}ZQ$b!PQ$c!QQ%R!kQ't%S^'{%`%g(O(W*q*t*v^*f'p*h,k,l-p.g/ZQ*l'rQ*m'sQ+t)gQ,j*gQ,n*kQ-n,hQ-o,iQ-r,oQ.e-mR/Y.f[bOn#g$j)t,P!^!vYZ!P!Q!k%S%`%g'p'r's(O(W)g*g*h*k*q*t*v,h,i,k,l,o-m-p.f.g/ZQ#R[Q#fdS#wrxQ$UyW$_}$Q'P)pS$l!U$hW${!i'm*d,gS%v#[+Y`&P#d%|(p(r(z+a-O0kQ&a#yQ&b#{Q&c#}Q'j$}Q'z%^W([%l(^*y*}Q(`%nQ(i%wQ(v&ZS(y&_0iQ)P&jQ)Q&kU)]&u)^+kQ)d&xQ)y'WY)}'Z*O,X,Y-dQ*b'lS*n'w0jW+P(d*z,s,wW+T(g+V,y,zQ+p)eQ,U)zQ,c*YQ,x+UQ-P+dQ-e,]Q-v,uQ.S-fR/q/VhUOn#d#g$j%|&_'w(p(r)t,P%U!uYZ[drxy}!P!Q!U!i!k#[#y#{#}$Q$h$}%S%^%`%g%l%n%w&Z&j&k&u&x'P'W'Z'l'm'p'r's(O(W(^(d(g(z)^)e)g)p)z*O*Y*d*g*h*k*q*t*v*y*z*}+U+V+Y+a+d+k,X,Y,],g,h,i,k,l,o,s,u,w,y,z-O-d-f-m-p.f.g/V/Z0i0j0kQ#qpW%W!o!s0d0nQ%X!pQ%Y!qQ%[!tQ%f0cS'v%Z0hQ'x0eQ'y0fQ,p*rQ-u,qS.i-s/sR0p0rU#uq.k0qR(w&][cOn#g$j)t,PZ!xY#[#}$Q+YQ#W[Q#zrR$TxQ%b!yQ%i!}Q%o#RQ'j${Q(V%eQ(Z%jQ(c%pQ(f%qQ*|(`Q,f*bQ-t,pQ.m-uR/].lQ$StQ(R%cR*s(SQ.l-sR/}/sR#QZR#V[R%Q!iQ%O!iV*c'm*d,g!Z!lQ!n#c#p$R$d$p$u$v$w$x$y$z%e%j%p%q&`'O'g(q(|)j*o*x+w,v0gR%T!kT#]^#_Q%x#[R,{+YQ(m%xS+_(n(oQ,}+`Q-x,{S.n-y-zR/^.oT+Z(k+]Q$`}Q&g$QQ)o'PR+{)pQ$XzQ)W&qR+i)XQ$XzQ&o$WQ)W&qR+i)XQ#khW$Vz$W&q)XQ$[{Q&r$ZZ)R&l)S+f+g-RR$^|R)c&wXlOn)t,PQ$f!RR'Q$gQ$m!UR'R$hR*X'_Q*V'_V-g,`-h.TQ.d-lQ/P.^R/Q._U.]-l.^._Q/U.aQ/b.tQ/g.zU/i.|/j/yQ/n/RQ/|/oQ0O/tU0Q/u0S0[Q0]0UQ0a0ZR0b0^R/T.`R/d.t",nodeNames:"âš  print Escape { Comment Script AssignStatement * BinaryExpression BitOp BitOp BitOp BitOp ArithOp ArithOp @ ArithOp ** UnaryExpression ArithOp BitOp AwaitExpression await ) ( ParenthesizedExpression BinaryExpression or and CompareOp in not is UnaryExpression ConditionalExpression if else LambdaExpression lambda ParamList VariableName AssignOp , : NamedExpression AssignOp YieldExpression yield from TupleExpression ComprehensionExpression async for LambdaExpression ] [ ArrayExpression ArrayComprehensionExpression } { DictionaryExpression DictionaryComprehensionExpression SetExpression SetComprehensionExpression CallExpression ArgList AssignOp MemberExpression . PropertyName Number String FormatString FormatReplacement FormatSelfDoc FormatConversion FormatSpec FormatReplacement FormatSelfDoc ContinuedString Ellipsis None Boolean TypeDef AssignOp UpdateStatement UpdateOp ExpressionStatement DeleteStatement del PassStatement pass BreakStatement break ContinueStatement continue ReturnStatement return YieldStatement PrintStatement RaiseStatement raise ImportStatement import as ScopeStatement global nonlocal AssertStatement assert TypeDefinition type TypeParamList TypeParam StatementGroup ; IfStatement Body elif WhileStatement while ForStatement TryStatement try except finally WithStatement with FunctionDefinition def ParamList AssignOp TypeDef ClassDefinition class DecoratedStatement Decorator At MatchStatement match MatchBody MatchClause case CapturePattern LiteralPattern ArithOp ArithOp AsPattern OrPattern LogicOp AttributePattern SequencePattern MappingPattern StarPattern ClassPattern PatternArgList KeywordPattern KeywordPattern Guard",maxTerm:277,context:X_,nodeProps:[["isolate",-5,4,71,72,73,77,""],["group",-15,6,85,87,88,90,92,94,96,98,99,100,102,105,108,110,"Statement Statement",-22,8,18,21,25,40,49,50,56,57,60,61,62,63,64,67,70,71,72,79,80,81,82,"Expression",-10,114,116,119,121,122,126,128,133,135,138,"Statement",-9,143,144,147,148,150,151,152,153,154,"Pattern"],["openedBy",23,"(",54,"[",58,"{"],["closedBy",24,")",55,"]",59,"}"]],propSources:[H_],skippedNodes:[0,4],repeatNodeCount:34,tokenData:"!2|~R!`OX%TXY%oY[%T[]%o]p%Tpq%oqr'ars)Yst*xtu%Tuv,dvw-hwx.Uxy/tyz0[z{0r{|2S|}2p}!O3W!O!P4_!P!Q:Z!Q!R;k!R![>_![!]Do!]!^Es!^!_FZ!_!`Gk!`!aHX!a!b%T!b!cIf!c!dJU!d!eK^!e!hJU!h!i!#f!i!tJU!t!u!,|!u!wJU!w!x!.t!x!}JU!}#O!0S#O#P&o#P#Q!0j#Q#R!1Q#R#SJU#S#T%T#T#UJU#U#VK^#V#YJU#Y#Z!#f#Z#fJU#f#g!,|#g#iJU#i#j!.t#j#oJU#o#p!1n#p#q!1s#q#r!2a#r#s!2f#s$g%T$g;'SJU;'S;=`KW<%lOJU`%YT&n`O#o%T#p#q%T#r;'S%T;'S;=`%i<%lO%T`%lP;=`<%l%To%v]&n`%c_OX%TXY%oY[%T[]%o]p%Tpq%oq#O%T#O#P&o#P#o%T#p#q%T#r;'S%T;'S;=`%i<%lO%To&tX&n`OY%TYZ%oZ]%T]^%o^#o%T#p#q%T#r;'S%T;'S;=`%i<%lO%Tc'f[&n`O!_%T!_!`([!`#T%T#T#U(r#U#f%T#f#g(r#g#h(r#h#o%T#p#q%T#r;'S%T;'S;=`%i<%lO%Tc(cTmR&n`O#o%T#p#q%T#r;'S%T;'S;=`%i<%lO%Tc(yT!mR&n`O#o%T#p#q%T#r;'S%T;'S;=`%i<%lO%Tk)aV&n`&[ZOr%Trs)vs#o%T#p#q%T#r;'S%T;'S;=`%i<%lO%Tk){V&n`Or%Trs*bs#o%T#p#q%T#r;'S%T;'S;=`%i<%lO%Tk*iT&n`&^ZO#o%T#p#q%T#r;'S%T;'S;=`%i<%lO%To+PZS_&n`OY*xYZ%TZ]*x]^%T^#o*x#o#p+r#p#q*x#q#r+r#r;'S*x;'S;=`,^<%lO*x_+wTS_OY+rZ]+r^;'S+r;'S;=`,W<%lO+r_,ZP;=`<%l+ro,aP;=`<%l*xj,kV%rQ&n`O!_%T!_!`-Q!`#o%T#p#q%T#r;'S%T;'S;=`%i<%lO%Tj-XT!xY&n`O#o%T#p#q%T#r;'S%T;'S;=`%i<%lO%Tj-oV%lQ&n`O!_%T!_!`-Q!`#o%T#p#q%T#r;'S%T;'S;=`%i<%lO%Tk.]V&n`&ZZOw%Twx.rx#o%T#p#q%T#r;'S%T;'S;=`%i<%lO%Tk.wV&n`Ow%Twx/^x#o%T#p#q%T#r;'S%T;'S;=`%i<%lO%Tk/eT&n`&]ZO#o%T#p#q%T#r;'S%T;'S;=`%i<%lO%Tk/{ThZ&n`O#o%T#p#q%T#r;'S%T;'S;=`%i<%lO%Tc0cTgR&n`O#o%T#p#q%T#r;'S%T;'S;=`%i<%lO%Tk0yXVZ&n`Oz%Tz{1f{!_%T!_!`-Q!`#o%T#p#q%T#r;'S%T;'S;=`%i<%lO%Tk1mVaR&n`O!_%T!_!`-Q!`#o%T#p#q%T#r;'S%T;'S;=`%i<%lO%Tk2ZV%oZ&n`O!_%T!_!`-Q!`#o%T#p#q%T#r;'S%T;'S;=`%i<%lO%Tc2wTzR&n`O#o%T#p#q%T#r;'S%T;'S;=`%i<%lO%To3_W%pZ&n`O!_%T!_!`-Q!`!a3w!a#o%T#p#q%T#r;'S%T;'S;=`%i<%lO%Td4OT&{S&n`O#o%T#p#q%T#r;'S%T;'S;=`%i<%lO%Tk4fX!fQ&n`O!O%T!O!P5R!P!Q%T!Q![6T![#o%T#p#q%T#r;'S%T;'S;=`%i<%lO%Tk5WV&n`O!O%T!O!P5m!P#o%T#p#q%T#r;'S%T;'S;=`%i<%lO%Tk5tT!rZ&n`O#o%T#p#q%T#r;'S%T;'S;=`%i<%lO%Ti6[a!hX&n`O!Q%T!Q![6T![!g%T!g!h7a!h!l%T!l!m9s!m#R%T#R#S6T#S#X%T#X#Y7a#Y#^%T#^#_9s#_#o%T#p#q%T#r;'S%T;'S;=`%i<%lO%Ti7fZ&n`O{%T{|8X|}%T}!O8X!O!Q%T!Q![8s![#o%T#p#q%T#r;'S%T;'S;=`%i<%lO%Ti8^V&n`O!Q%T!Q![8s![#o%T#p#q%T#r;'S%T;'S;=`%i<%lO%Ti8z]!hX&n`O!Q%T!Q![8s![!l%T!l!m9s!m#R%T#R#S8s#S#^%T#^#_9s#_#o%T#p#q%T#r;'S%T;'S;=`%i<%lO%Ti9zT!hX&n`O#o%T#p#q%T#r;'S%T;'S;=`%i<%lO%Tk:bX%qR&n`O!P%T!P!Q:}!Q!_%T!_!`-Q!`#o%T#p#q%T#r;'S%T;'S;=`%i<%lO%Tj;UV%sQ&n`O!_%T!_!`-Q!`#o%T#p#q%T#r;'S%T;'S;=`%i<%lO%Ti;ro!hX&n`O!O%T!O!P=s!P!Q%T!Q![>_![!d%T!d!e?q!e!g%T!g!h7a!h!l%T!l!m9s!m!q%T!q!rA]!r!z%T!z!{Bq!{#R%T#R#S>_#S#U%T#U#V?q#V#X%T#X#Y7a#Y#^%T#^#_9s#_#c%T#c#dA]#d#l%T#l#mBq#m#o%T#p#q%T#r;'S%T;'S;=`%i<%lO%Ti=xV&n`O!Q%T!Q![6T![#o%T#p#q%T#r;'S%T;'S;=`%i<%lO%Ti>fc!hX&n`O!O%T!O!P=s!P!Q%T!Q![>_![!g%T!g!h7a!h!l%T!l!m9s!m#R%T#R#S>_#S#X%T#X#Y7a#Y#^%T#^#_9s#_#o%T#p#q%T#r;'S%T;'S;=`%i<%lO%Ti?vY&n`O!Q%T!Q!R@f!R!S@f!S#R%T#R#S@f#S#o%T#p#q%T#r;'S%T;'S;=`%i<%lO%Ti@mY!hX&n`O!Q%T!Q!R@f!R!S@f!S#R%T#R#S@f#S#o%T#p#q%T#r;'S%T;'S;=`%i<%lO%TiAbX&n`O!Q%T!Q!YA}!Y#R%T#R#SA}#S#o%T#p#q%T#r;'S%T;'S;=`%i<%lO%TiBUX!hX&n`O!Q%T!Q!YA}!Y#R%T#R#SA}#S#o%T#p#q%T#r;'S%T;'S;=`%i<%lO%TiBv]&n`O!Q%T!Q![Co![!c%T!c!iCo!i#R%T#R#SCo#S#T%T#T#ZCo#Z#o%T#p#q%T#r;'S%T;'S;=`%i<%lO%TiCv]!hX&n`O!Q%T!Q![Co![!c%T!c!iCo!i#R%T#R#SCo#S#T%T#T#ZCo#Z#o%T#p#q%T#r;'S%T;'S;=`%i<%lO%ToDvV{_&n`O!_%T!_!`E]!`#o%T#p#q%T#r;'S%T;'S;=`%i<%lO%TcEdT%{R&n`O#o%T#p#q%T#r;'S%T;'S;=`%i<%lO%TkEzT#gZ&n`O#o%T#p#q%T#r;'S%T;'S;=`%i<%lO%TkFbXmR&n`O!^%T!^!_F}!_!`([!`!a([!a#o%T#p#q%T#r;'S%T;'S;=`%i<%lO%TjGUV%mQ&n`O!_%T!_!`-Q!`#o%T#p#q%T#r;'S%T;'S;=`%i<%lO%TkGrV%zZ&n`O!_%T!_!`([!`#o%T#p#q%T#r;'S%T;'S;=`%i<%lO%TkH`WmR&n`O!_%T!_!`([!`!aHx!a#o%T#p#q%T#r;'S%T;'S;=`%i<%lO%TjIPV%nQ&n`O!_%T!_!`-Q!`#o%T#p#q%T#r;'S%T;'S;=`%i<%lO%TkIoV_Q#}P&n`O!_%T!_!`-Q!`#o%T#p#q%T#r;'S%T;'S;=`%i<%lO%ToJ_]&n`&YS%uZO!Q%T!Q![JU![!c%T!c!}JU!}#R%T#R#SJU#S#T%T#T#oJU#p#q%T#r$g%T$g;'SJU;'S;=`KW<%lOJUoKZP;=`<%lJUoKge&n`&YS%uZOr%Trs)Ysw%Twx.Ux!Q%T!Q![JU![!c%T!c!tJU!t!uLx!u!}JU!}#R%T#R#SJU#S#T%T#T#fJU#f#gLx#g#oJU#p#q%T#r$g%T$g;'SJU;'S;=`KW<%lOJUoMRa&n`&YS%uZOr%TrsNWsw%Twx! vx!Q%T!Q![JU![!c%T!c!}JU!}#R%T#R#SJU#S#T%T#T#oJU#p#q%T#r$g%T$g;'SJU;'S;=`KW<%lOJUkN_V&n`&`ZOr%TrsNts#o%T#p#q%T#r;'S%T;'S;=`%i<%lO%TkNyV&n`Or%Trs! `s#o%T#p#q%T#r;'S%T;'S;=`%i<%lO%Tk! gT&n`&bZO#o%T#p#q%T#r;'S%T;'S;=`%i<%lO%Tk! }V&n`&_ZOw%Twx!!dx#o%T#p#q%T#r;'S%T;'S;=`%i<%lO%Tk!!iV&n`Ow%Twx!#Ox#o%T#p#q%T#r;'S%T;'S;=`%i<%lO%Tk!#VT&n`&aZO#o%T#p#q%T#r;'S%T;'S;=`%i<%lO%To!#oe&n`&YS%uZOr%Trs!%Qsw%Twx!&px!Q%T!Q![JU![!c%T!c!tJU!t!u!(`!u!}JU!}#R%T#R#SJU#S#T%T#T#fJU#f#g!(`#g#oJU#p#q%T#r$g%T$g;'SJU;'S;=`KW<%lOJUk!%XV&n`&dZOr%Trs!%ns#o%T#p#q%T#r;'S%T;'S;=`%i<%lO%Tk!%sV&n`Or%Trs!&Ys#o%T#p#q%T#r;'S%T;'S;=`%i<%lO%Tk!&aT&n`&fZO#o%T#p#q%T#r;'S%T;'S;=`%i<%lO%Tk!&wV&n`&cZOw%Twx!'^x#o%T#p#q%T#r;'S%T;'S;=`%i<%lO%Tk!'cV&n`Ow%Twx!'xx#o%T#p#q%T#r;'S%T;'S;=`%i<%lO%Tk!(PT&n`&eZO#o%T#p#q%T#r;'S%T;'S;=`%i<%lO%To!(ia&n`&YS%uZOr%Trs!)nsw%Twx!+^x!Q%T!Q![JU![!c%T!c!}JU!}#R%T#R#SJU#S#T%T#T#oJU#p#q%T#r$g%T$g;'SJU;'S;=`KW<%lOJUk!)uV&n`&hZOr%Trs!*[s#o%T#p#q%T#r;'S%T;'S;=`%i<%lO%Tk!*aV&n`Or%Trs!*vs#o%T#p#q%T#r;'S%T;'S;=`%i<%lO%Tk!*}T&n`&jZO#o%T#p#q%T#r;'S%T;'S;=`%i<%lO%Tk!+eV&n`&gZOw%Twx!+zx#o%T#p#q%T#r;'S%T;'S;=`%i<%lO%Tk!,PV&n`Ow%Twx!,fx#o%T#p#q%T#r;'S%T;'S;=`%i<%lO%Tk!,mT&n`&iZO#o%T#p#q%T#r;'S%T;'S;=`%i<%lO%To!-Vi&n`&YS%uZOr%TrsNWsw%Twx! vx!Q%T!Q![JU![!c%T!c!dJU!d!eLx!e!hJU!h!i!(`!i!}JU!}#R%T#R#SJU#S#T%T#T#UJU#U#VLx#V#YJU#Y#Z!(`#Z#oJU#p#q%T#r$g%T$g;'SJU;'S;=`KW<%lOJUo!.}a&n`&YS%uZOr%Trs)Ysw%Twx.Ux!Q%T!Q![JU![!c%T!c!}JU!}#R%T#R#SJU#S#T%T#T#oJU#p#q%T#r$g%T$g;'SJU;'S;=`KW<%lOJUk!0ZT!XZ&n`O#o%T#p#q%T#r;'S%T;'S;=`%i<%lO%Tc!0qT!WR&n`O#o%T#p#q%T#r;'S%T;'S;=`%i<%lO%Tj!1XV%kQ&n`O!_%T!_!`-Q!`#o%T#p#q%T#r;'S%T;'S;=`%i<%lO%T~!1sO!]~k!1zV%jR&n`O!_%T!_!`-Q!`#o%T#p#q%T#r;'S%T;'S;=`%i<%lO%T~!2fO![~i!2mT%tX&n`O#o%T#p#q%T#r;'S%T;'S;=`%i<%lO%T",tokenizers:[G_,U_,F_,Y_,0,1,2,3,4],topRules:{Script:[0,5]},specialized:[{term:221,get:t=>K_[t]||-1}],tokenPrec:7668}),zf=new CO,Xy=new Set(["Script","Body","FunctionDefinition","ClassDefinition","LambdaExpression","ForStatement","MatchClause"]);function po(t){return(e,i,s)=>{if(s)return!1;let r=e.node.getChild("VariableName");return r&&i(r,t),!0}}const eR={FunctionDefinition:po("function"),ClassDefinition:po("class"),ForStatement(t,e,i){if(i){for(let s=t.node.firstChild;s;s=s.nextSibling)if(s.name=="VariableName")e(s,"variable");else if(s.name=="in")break}},ImportStatement(t,e){var i,s;let{node:r}=t,n=((i=r.firstChild)===null||i===void 0?void 0:i.name)=="from";for(let a=r.getChild("import");a;a=a.nextSibling)a.name=="VariableName"&&((s=a.nextSibling)===null||s===void 0?void 0:s.name)!="as"&&e(a,n?"variable":"namespace")},AssignStatement(t,e){for(let i=t.node.firstChild;i;i=i.nextSibling)if(i.name=="VariableName")e(i,"variable");else if(i.name==":"||i.name=="AssignOp")break},ParamList(t,e){for(let i=null,s=t.node.firstChild;s;s=s.nextSibling)s.name=="VariableName"&&(!i||!/\*|AssignOp/.test(i.name))&&e(s,"variable"),i=s},CapturePattern:po("variable"),AsPattern:po("variable"),__proto__:null};function Gy(t,e){let i=zf.get(e);if(i)return i;let s=[],r=!0;function n(a,o){let l=t.sliceString(a.from,a.to);s.push({label:l,type:o})}return e.cursor(je.IncludeAnonymous).iterate(a=>{if(a.name){let o=eR[a.name];if(o&&o(a,n,r)||!r&&Xy.has(a.name))return!1;r=!1}else if(a.to-a.from>8192){for(let o of Gy(t,a.node))s.push(o);return!1}}),zf.set(e,s),s}const Xf=/^[\w\xa1-\uffff][\w\d\xa1-\uffff]*$/,Yy=["String","FormatString","Comment","PropertyName"];function tR(t){let e=vt(t.state).resolveInner(t.pos,-1);if(Yy.indexOf(e.name)>-1)return null;let i=e.name=="VariableName"||e.to-e.from<20&&Xf.test(t.state.sliceDoc(e.from,e.to));if(!i&&!t.explicit)return null;let s=[];for(let r=e;r;r=r.parent)Xy.has(r.name)&&(s=s.concat(Gy(t.state.doc,r)));return{options:s,from:i?e.from:t.pos,validFor:Xf}}const iR=["__annotations__","__builtins__","__debug__","__doc__","__import__","__name__","__loader__","__package__","__spec__","False","None","True"].map(t=>({label:t,type:"constant"})).concat(["ArithmeticError","AssertionError","AttributeError","BaseException","BlockingIOError","BrokenPipeError","BufferError","BytesWarning","ChildProcessError","ConnectionAbortedError","ConnectionError","ConnectionRefusedError","ConnectionResetError","DeprecationWarning","EOFError","Ellipsis","EncodingWarning","EnvironmentError","Exception","FileExistsError","FileNotFoundError","FloatingPointError","FutureWarning","GeneratorExit","IOError","ImportError","ImportWarning","IndentationError","IndexError","InterruptedError","IsADirectoryError","KeyError","KeyboardInterrupt","LookupError","MemoryError","ModuleNotFoundError","NameError","NotADirectoryError","NotImplemented","NotImplementedError","OSError","OverflowError","PendingDeprecationWarning","PermissionError","ProcessLookupError","RecursionError","ReferenceError","ResourceWarning","RuntimeError","RuntimeWarning","StopAsyncIteration","StopIteration","SyntaxError","SyntaxWarning","SystemError","SystemExit","TabError","TimeoutError","TypeError","UnboundLocalError","UnicodeDecodeError","UnicodeEncodeError","UnicodeError","UnicodeTranslateError","UnicodeWarning","UserWarning","ValueError","Warning","ZeroDivisionError"].map(t=>({label:t,type:"type"}))).concat(["bool","bytearray","bytes","classmethod","complex","float","frozenset","int","list","map","memoryview","object","range","set","staticmethod","str","super","tuple","type"].map(t=>({label:t,type:"class"}))).concat(["abs","aiter","all","anext","any","ascii","bin","breakpoint","callable","chr","compile","delattr","dict","dir","divmod","enumerate","eval","exec","exit","filter","format","getattr","globals","hasattr","hash","help","hex","id","input","isinstance","issubclass","iter","len","license","locals","max","min","next","oct","open","ord","pow","print","property","quit","repr","reversed","round","setattr","slice","sorted","sum","vars","zip"].map(t=>({label:t,type:"function"}))),sR=[Ve("def ${name}(${params}):\n	${}",{label:"def",detail:"function",type:"keyword"}),Ve("for ${name} in ${collection}:\n	${}",{label:"for",detail:"loop",type:"keyword"}),Ve("while ${}:\n	${}",{label:"while",detail:"loop",type:"keyword"}),Ve("try:\n	${}\nexcept ${error}:\n	${}",{label:"try",detail:"/ except block",type:"keyword"}),Ve(`if \${}:
	
`,{label:"if",detail:"block",type:"keyword"}),Ve("if ${}:\n	${}\nelse:\n	${}",{label:"if",detail:"/ else block",type:"keyword"}),Ve("class ${name}:\n	def __init__(self, ${params}):\n			${}",{label:"class",detail:"definition",type:"keyword"}),Ve("import ${module}",{label:"import",detail:"statement",type:"keyword"}),Ve("from ${module} import ${names}",{label:"from",detail:"import",type:"keyword"})],rR=Ry(Yy,_y(iR.concat(sR)));function Ic(t){let{node:e,pos:i}=t,s=t.lineIndent(i,-1),r=null;for(;;){let n=e.childBefore(i);if(n)if(n.name=="Comment")i=n.from;else if(n.name=="Body"||n.name=="MatchBody")t.baseIndentFor(n)+t.unit<=s&&(r=n),e=n;else if(n.name=="MatchClause")e=n;else if(n.type.is("Statement"))e=n;else break;else break}return r}function Qc(t,e){let i=t.baseIndentFor(e),s=t.lineAt(t.pos,-1),r=s.from+s.text.length;return/^\s*($|#)/.test(s.text)&&t.node.to<r+100&&!/\S/.test(t.state.sliceDoc(r,t.node.to))&&t.lineIndent(t.pos,-1)<=i||/^\s*(else:|elif |except |finally:|case\s+[^=:]+:)/.test(t.textAfter)&&t.lineIndent(t.pos,-1)>i?null:i+t.unit}const Ac=Jr.define({name:"python",parser:J_.configure({props:[bl.add({Body:t=>{var e;let i=/^\s*(#|$)/.test(t.textAfter)&&Ic(t)||t.node;return(e=Qc(t,i))!==null&&e!==void 0?e:t.continue()},MatchBody:t=>{var e;let i=Ic(t);return(e=Qc(t,i||t.node))!==null&&e!==void 0?e:t.continue()},IfStatement:t=>/^\s*(else:|elif )/.test(t.textAfter)?t.baseIndent:t.continue(),"ForStatement WhileStatement":t=>/^\s*else:/.test(t.textAfter)?t.baseIndent:t.continue(),TryStatement:t=>/^\s*(except[ :]|finally:|else:)/.test(t.textAfter)?t.baseIndent:t.continue(),MatchStatement:t=>/^\s*case /.test(t.textAfter)?t.baseIndent+t.unit:t.continue(),"TupleExpression ComprehensionExpression ParamList ArgList ParenthesizedExpression":Hn({closing:")"}),"DictionaryExpression DictionaryComprehensionExpression SetExpression SetComprehensionExpression":Hn({closing:"}"}),"ArrayExpression ArrayComprehensionExpression":Hn({closing:"]"}),MemberExpression:t=>t.baseIndent+t.unit,"String FormatString":()=>null,Script:t=>{var e;let i=Ic(t);return(e=i&&Qc(t,i))!==null&&e!==void 0?e:t.continue()}}),wl.add({"ArrayExpression DictionaryExpression SetExpression TupleExpression":Md,Body:(t,e)=>({from:t.from+1,to:t.to-(t.to==e.doc.length?0:1)}),"String FormatString":(t,e)=>({from:e.doc.lineAt(t.from).to,to:t.to})})]}),languageData:{closeBrackets:{brackets:["(","[","{","'",'"',"'''",'"""'],stringPrefixes:["f","fr","rf","r","u","b","br","rb","F","FR","RF","R","U","B","BR","RB"]},commentTokens:{line:"#"},indentOnInput:/^\s*([\}\]\)]|else:|elif |except |finally:|case\s+[^:]*:?)$/}});function nR(){return new Ad(Ac,[Ac.data.of({autocomplete:tR}),Ac.data.of({autocomplete:rR})])}const aR=Ol({null:$.null,instanceof:$.operatorKeyword,this:$.self,"new super assert open to with void":$.keyword,"class interface extends implements enum var":$.definitionKeyword,"module package import":$.moduleKeyword,"switch while for if else case default do break continue return try catch finally throw":$.controlKeyword,"requires exports opens uses provides public private protected static transitive abstract final strictfp synchronized native transient volatile throws":$.modifier,IntegerLiteral:$.integer,FloatingPointLiteral:$.float,"StringLiteral TextBlock":$.string,CharacterLiteral:$.character,LineComment:$.lineComment,BlockComment:$.blockComment,BooleanLiteral:$.bool,PrimitiveType:$.standard($.typeName),TypeName:$.typeName,Identifier:$.variableName,"MethodName/Identifier":$.function($.variableName),Definition:$.definition($.variableName),ArithOp:$.arithmeticOperator,LogicOp:$.logicOperator,BitOp:$.bitwiseOperator,CompareOp:$.compareOperator,AssignOp:$.definitionOperator,UpdateOp:$.updateOperator,Asterisk:$.punctuation,Label:$.labelName,"( )":$.paren,"[ ]":$.squareBracket,"{ }":$.brace,".":$.derefOperator,", ;":$.separator}),oR={__proto__:null,true:34,false:34,null:42,void:46,byte:48,short:48,int:48,long:48,char:48,float:48,double:48,boolean:48,extends:62,super:64,class:76,this:78,new:84,public:100,protected:102,private:104,abstract:106,static:108,final:110,strictfp:112,default:114,synchronized:116,native:118,transient:120,volatile:122,throws:150,implements:160,interface:166,enum:176,instanceof:238,open:267,module:269,requires:274,transitive:276,exports:278,to:280,opens:282,uses:284,provides:286,with:288,package:292,import:296,if:308,else:310,while:314,for:318,var:325,assert:332,switch:336,case:342,do:346,break:350,continue:354,return:358,throw:364,try:368,catch:372,finally:380},lR=tn.deserialize({version:14,states:"##jQ]QPOOQ$wQPOOO(bQQO'#H^O*iQQO'#CbOOQO'#Cb'#CbO*pQPO'#CaO*xOSO'#CpOOQO'#Hc'#HcOOQO'#Cu'#CuO,eQPO'#D_O-OQQO'#HmOOQO'#Hm'#HmO/gQQO'#HhO/nQQO'#HhOOQO'#Hh'#HhOOQO'#Hg'#HgO1rQPO'#DUO2PQPO'#GnO4wQPO'#D_O5OQPO'#DzO*pQPO'#E[O5qQPO'#E[OOQO'#DV'#DVO7SQQO'#HaO9^QQO'#EeO9eQPO'#EdO9jQPO'#EfOOQO'#Hb'#HbO7jQQO'#HbO:pQQO'#FhO:wQPO'#ExO:|QPO'#E}O:|QPO'#FPOOQO'#Ha'#HaOOQO'#HY'#HYOOQO'#Gh'#GhOOQO'#HX'#HXO<^QPO'#FiOOQO'#HW'#HWOOQO'#Gg'#GgQ]QPOOOOQO'#Hs'#HsO<cQPO'#HsO<hQPO'#D{O<hQPO'#EVO<hQPO'#EQO<pQPO'#HpO=RQQO'#EfO*pQPO'#C`O=ZQPO'#C`O*pQPO'#FcO=`QPO'#FeO=kQPO'#FkO=kQPO'#FnO<hQPO'#FsO=pQPO'#FpO:|QPO'#FwO=kQPO'#FyO]QPO'#GOO=uQPO'#GQO>QQPO'#GSO>]QPO'#GUO=kQPO'#GWO:|QPO'#GXO>dQPO'#GZO?QQQO'#HiO?mQQO'#CuO?tQPO'#HxO@SQPO'#D_O@rQPO'#DpO?wQPO'#DqO@|QPO'#HxOA_QPO'#DpOAgQPO'#IROAlQPO'#E`OOQO'#Hr'#HrOOQO'#Gm'#GmQ$wQPOOOAtQPO'#HsOOQO'#H^'#H^OCsQQO,58{OOQO'#H['#H[OOOO'#Gi'#GiOEfOSO,59[OOQO,59[,59[OOQO'#Hi'#HiOFVQPO,59eOGXQPO,59yOOQO-E:f-E:fO*pQPO,58zOG{QPO,58zO*pQPO,5;}OHQQPO'#DQOHVQPO'#DQOOQO'#Gk'#GkOIVQQO,59jOOQO'#Dm'#DmOJqQPO'#HuOJ{QPO'#DlOKZQPO'#HtOKcQPO,5<_OKhQPO,59^OLRQPO'#CxOOQO,59c,59cOLYQPO,59bOLeQQO'#H^ONgQQO'#CbO!!iQPO'#D_O!#nQQO'#HmO!$OQQO,59pO!$VQPO'#DvO!$eQPO'#H|O!$mQPO,5:`O!$rQPO,5:`O!%YQPO,5;nO!%eQPO'#ITO!%pQPO,5;eO!%uQPO,5=YOOQO-E:l-E:lOOQO,5:f,5:fO!']QPO,5:fO!'dQPO,5:vO?tQPO,5<_O*pQPO,5:vO<hQPO,5:gO<hQPO,5:qO<hQPO,5:lO<hQPO,5<_O!'zQPO,59qO:|QPO,5:}O!(RQPO,5;QO:|QPO,59TO!(aQPO'#DXOOQO,5;O,5;OOOQO'#El'#ElOOQO'#Eo'#EoO:|QPO,5;UO:|QPO,5;UO:|QPO,5;UO:|QPO,5;UO:|QPO,5;UO:|QPO,5;UO:|QPO,5;UO:|QPO,5;UO:|QPO,5;UO:|QPO,5;fOOQO,5;i,5;iOOQO,5<S,5<SO!(hQPO,5;bO!(yQPO,5;dO!(hQPO'#CyO!)QQQO'#HmO!)`QQO,5;kO]QPO,5<TOOQO-E:e-E:eOOQO,5>_,5>_O!*sQPO,5:gO!+RQPO,5:qO!+ZQPO,5:lO!+fQPO,5>[O!$VQPO,5>[O!'iQPO,59UO!+qQQO,58zO!+yQQO,5;}O!,RQQO,5<PO*pQPO,5<PO:|QPO'#DUO]QPO,5<VO]QPO,5<YO!,ZQPO'#FrO]QPO,5<[O]QPO,5<aO!,kQQO,5<cO!,uQPO,5<eO!,zQPO,5<jOOQO'#Fj'#FjOOQO,5<l,5<lO!-PQPO,5<lOOQO,5<n,5<nO!-UQPO,5<nO!-ZQQO,5<pOOQO,5<p,5<pO>gQPO,5<rO!-bQQO,5<sO!-iQPO'#GdO!.oQPO,5<uO>gQPO,5<}O!2mQPO,59jO!2zQPO'#HuO!3RQPO,59xO!3WQPO,5>dO?tQPO,59xO!3cQPO,5:[OAlQPO,5:zO!3kQPO'#DrO?wQPO'#DrO!3vQPO'#HyO!4OQPO,5:]O?tQPO,5>dO!(hQPO,5>dOAgQPO,5>mOOQO,5:[,5:[O!$rQPO'#DtOOQO,5>m,5>mO!4TQPO'#EaOOQO,5:z,5:zO!7UQPO,5:zO!(hQPO'#DxOOQO-E:k-E:kOOQO,5:y,5:yO*pQPO,58}O!7ZQPO'#ChOOQO1G.k1G.kOOOO-E:g-E:gOOQO1G.v1G.vO!+qQQO1G.fO*pQPO1G.fO!7eQQO1G1iOOQO,59l,59lO!7mQPO,59lOOQO-E:i-E:iO!7rQPO,5>aO!8ZQPO,5:WO<hQPO'#GpO!8bQPO,5>`OOQO1G1y1G1yOOQO1G.x1G.xO!8{QPO'#CyO!9kQPO'#HmO!9uQPO'#CzO!:TQPO'#HlO!:]QPO,59dOOQO1G.|1G.|OLYQPO1G.|O!:sQPO,59eO!;QQQO'#H^O!;cQQO'#CbOOQO,5:b,5:bO<hQPO,5:cOOQO,5:a,5:aO!;tQQO,5:aOOQO1G/[1G/[O!;yQPO,5:bO!<[QPO'#GsO!<oQPO,5>hOOQO1G/z1G/zO!<wQPO'#DvO!=YQPO1G/zO!(hQPO'#GqO!=_QPO1G1YO:|QPO1G1YO<hQPO'#GyO!=gQPO,5>oOOQO1G1P1G1POOQO1G0Q1G0QO!=oQPO'#E]OOQO1G0b1G0bO!>`QPO1G1yO!'dQPO1G0bO!*sQPO1G0RO!+RQPO1G0]O!+ZQPO1G0WOOQO1G/]1G/]O!>eQQO1G.pO9eQPO1G0jO*pQPO1G0jO<pQPO'#HpO!@[QQO1G.pOOQO1G.p1G.pO!@aQQO1G0iOOQO1G0l1G0lO!@hQPO1G0lO!@sQQO1G.oO!AZQQO'#HqO!AhQPO,59sO!BzQQO1G0pO!DfQQO1G0pO!DmQQO1G0pO!FUQQO1G0pO!F]QQO1G0pO!GbQQO1G0pO!I]QQO1G0pO!IdQQO1G0pO!IkQQO1G0pO!IuQQO1G1QO!I|QQO'#HmOOQO1G0|1G0|O!KSQQO1G1OOOQO1G1O1G1OOOQO1G1o1G1oO!KjQPO'#D[O!(hQPO'#D|O!(hQPO'#D}OOQO1G0R1G0RO!KqQPO1G0RO!KvQPO1G0RO!LOQPO1G0RO!LZQPO'#EXOOQO1G0]1G0]O!LnQPO1G0]O!LsQPO'#ETO!(hQPO'#ESOOQO1G0W1G0WO!MmQPO1G0WO!MrQPO1G0WO!MzQPO'#EhO!NRQPO'#EhOOQO'#Gx'#GxO!NZQQO1G0mO# }QQO1G3vO9eQPO1G3vO#$PQPO'#FXOOQO1G.f1G.fOOQO1G1i1G1iO#$WQPO1G1kOOQO1G1k1G1kO#$cQQO1G1kO#$kQPO1G1qOOQO1G1t1G1tO+QQPO'#D_O-OQQO,5<bO#(cQPO,5<bO#(tQPO,5<^O#({QPO,5<^OOQO1G1v1G1vOOQO1G1{1G1{OOQO1G1}1G1}O:|QPO1G1}O#,oQPO'#F{OOQO1G2P1G2PO=kQPO1G2UOOQO1G2W1G2WOOQO1G2Y1G2YOOQO1G2[1G2[OOQO1G2^1G2^OOQO1G2_1G2_O#,vQQO'#H^O#-aQQO'#CbO-OQQO'#HmO#-zQQOOO#.hQQO'#EeO#.VQQO'#HbO!$VQPO'#GeO#.oQPO,5=OOOQO'#HQ'#HQO#.wQPO1G2aO#2uQPO'#G]O>gQPO'#GaOOQO1G2a1G2aO#2zQPO1G2iO#6xQPO,5>gOOQO1G/d1G/dOOQO1G4O1G4OO#7ZQPO1G/dOOQO1G/v1G/vOOQO1G0f1G0fO!7UQPO1G0fOOQO,5:^,5:^O!(hQPO'#DsO#7`QPO,5:^O?wQPO'#GrO#7kQPO,5>eOOQO1G/w1G/wOAgQPO'#H{O#7sQPO1G4OO?tQPO1G4OOOQO1G4X1G4XO!#YQPO'#DvO!!iQPO'#D_OOQO,5:{,5:{O#8OQPO,5:{O#8OQPO,5:{O#8VQQO'#HaO#9hQQO'#HbO#9rQQO'#EbO#9}QPO'#EbO#:VQPO'#IOOOQO,5:d,5:dOOQO1G.i1G.iO#:bQQO'#EeO#:rQQO'#H`O#;SQPO'#FTOOQO'#H`'#H`O#;^QPO'#H`O#;{QPO'#IWO#<TQPO,59SOOQO7+$Q7+$QO!+qQQO7+$QOOQO7+'T7+'TOOQO1G/W1G/WO#<YQPO'#DoO#<dQQO'#HvOOQO'#Hv'#HvOOQO1G/r1G/rOOQO,5=[,5=[OOQO-E:n-E:nO#<tQWO,58{O#<{QPO,59fOOQO,59f,59fO!(hQPO'#HoOKmQPO'#GjO#=ZQPO,5>WOOQO1G/O1G/OOOQO7+$h7+$hOOQO1G/{1G/{O#=cQQO1G/{OOQO1G/}1G/}O#=hQPO1G/{OOQO1G/|1G/|O<hQPO1G/}OOQO,5=_,5=_OOQO-E:q-E:qOOQO7+%f7+%fOOQO,5=],5=]OOQO-E:o-E:oO:|QPO7+&tOOQO7+&t7+&tOOQO,5=e,5=eOOQO-E:w-E:wO#=mQPO'#EUO#={QPO'#EUOOQO'#Gw'#GwO#>dQPO,5:wOOQO,5:w,5:wOOQO7+'e7+'eOOQO7+%|7+%|OOQO7+%m7+%mO!KqQPO7+%mO!KvQPO7+%mO!LOQPO7+%mOOQO7+%w7+%wO!LnQPO7+%wOOQO7+%r7+%rO!MmQPO7+%rO!MrQPO7+%rOOQO7+&U7+&UOOQO'#Ee'#EeO9eQPO7+&UO9eQPO,5>[O#?TQPO7+$[OOQO7+&T7+&TOOQO7+&W7+&WO:|QPO'#GlO#?cQPO,5>]OOQO1G/_1G/_O:|QPO7+&lO#?nQQO,59eO#@tQPO,59vOOQO,59v,59vOOQO,5:h,5:hOOQO'#EP'#EPOOQO,5:i,5:iO#@{QPO'#EYO<hQPO'#EYO#A^QPO'#IPO#AiQPO,5:sO?tQPO'#HxO!(hQPO'#HxO#AqQPO'#DpOOQO'#Gu'#GuO#AxQPO,5:oOOQO,5:o,5:oOOQO,5:n,5:nOOQO,5;S,5;SO#BrQQO,5;SO#ByQPO,5;SOOQO-E:v-E:vOOQO7+&X7+&XOOQO7+)b7+)bO#CQQQO7+)bOOQO'#G|'#G|O#DqQPO,5;sOOQO,5;s,5;sO#DxQPO'#FYO*pQPO'#FYO*pQPO'#FYO*pQPO'#FYO#EWQPO7+'VO#E]QPO7+'VOOQO7+'V7+'VO]QPO7+']O#EhQPO1G1|O?tQPO1G1|O#EvQQO1G1xO!(aQPO1G1xO#E}QPO1G1xO#FUQQO7+'iOOQO'#HP'#HPO#F]QPO,5<gOOQO,5<g,5<gO#FdQPO'#HsO:|QPO'#F|O#FlQPO7+'pO#FqQPO,5=PO?tQPO,5=PO#FvQPO1G2jO#HPQPO1G2jOOQO1G2j1G2jOOQO-E;O-E;OOOQO7+'{7+'{O!<[QPO'#G_O>gQPO,5<wOOQO,5<{,5<{O#HXQPO7+(TOOQO7+(T7+(TO#LVQPO1G4ROOQO7+%O7+%OOOQO7+&Q7+&QO#LhQPO,5:_OOQO1G/x1G/xOOQO,5=^,5=^OOQO-E:p-E:pOOQO7+)j7+)jO#LsQPO7+)jO!:bQPO,5:aOOQO1G0g1G0gO#MOQPO1G0gO#MVQPO,59qO#MkQPO,5:|O9eQPO,5:|O!(hQPO'#GtO#MpQPO,5>jO#M{QPO,59TO#NSQPO'#IVO#N[QPO,5;oO*pQPO'#G{O#NaQPO,5>rOOQO1G.n1G.nOOQO<<Gl<<GlO#NiQPO'#HwO#NqQPO,5:ZOOQO1G/Q1G/QOOQO,5>Z,5>ZOOQO,5=U,5=UOOQO-E:h-E:hO#NvQPO7+%gOOQO7+%g7+%gOOQO7+%i7+%iOOQO<<J`<<J`O$ ^QPO'#H^O$ eQPO'#CbO$ lQPO,5:pO$ qQPO,5:xO#=mQPO,5:pOOQO-E:u-E:uOOQO1G0c1G0cOOQO<<IX<<IXO!KqQPO<<IXO!KvQPO<<IXOOQO<<Ic<<IcOOQO<<I^<<I^O!MmQPO<<I^OOQO<<Ip<<IpO$ vQQO<<GvO9eQPO<<IpO*pQPO<<IpOOQO<<Gv<<GvO$#mQQO,5=WOOQO-E:j-E:jO$#zQQO<<JWOOQO1G/b1G/bOOQO,5:t,5:tO$$bQPO,5:tO$$pQPO,5:tO$%RQPO'#GvO$%iQPO,5>kO$%tQPO'#EZOOQO1G0_1G0_O$%{QPO1G0_O?tQPO,5:pOOQO-E:s-E:sOOQO1G0Z1G0ZOOQO1G0n1G0nO$&QQQO1G0nOOQO<<L|<<L|OOQO-E:z-E:zOOQO1G1_1G1_O$&XQQO,5;tOOQO'#G}'#G}O#DxQPO,5;tOOQO'#IX'#IXO$&aQQO,5;tO$&rQQO,5;tOOQO<<Jq<<JqO$&zQPO<<JqOOQO<<Jw<<JwO:|QPO7+'hO$'PQPO7+'hO!(aQPO7+'dO$'_QPO7+'dO$'dQQO7+'dOOQO<<KT<<KTOOQO-E:}-E:}OOQO1G2R1G2ROOQO,5<h,5<hO$'kQQO,5<hOOQO<<K[<<K[O:|QPO1G2kO$'rQPO1G2kOOQO,5=n,5=nOOQO7+(U7+(UO$'wQPO7+(UOOQO-E;Q-E;QO$)fQWO'#HhO$)QQWO'#HhO$)mQPO'#G`O<hQPO,5<yO!$VQPO,5<yOOQO1G2c1G2cOOQO<<Ko<<KoO$*OQPO1G/yOOQO<<MU<<MUOOQO7+&R7+&RO$*ZQPO1G0jO$*fQQO1G0hOOQO1G0h1G0hO$*nQPO1G0hOOQO,5=`,5=`OOQO-E:r-E:rO$*sQQO1G.oOOQO1G1[1G1[O$*}QPO'#GzO$+[QPO,5>qOOQO1G1Z1G1ZO$+dQPO'#FUOOQO,5=g,5=gOOQO-E:y-E:yO$+iQPO'#GoO$+vQPO,5>cOOQO1G/u1G/uOOQO<<IR<<IROOQO1G0[1G0[O$,OQPO1G0dO$,TQPO1G0[O$,YQPO1G0dOOQOAN>sAN>sO!KqQPOAN>sOOQOAN>xAN>xOOQOAN?[AN?[O9eQPOAN?[OOQO1G0`1G0`O$,_QPO1G0`OOQO,5=b,5=bOOQO-E:t-E:tO$,mQPO,5:uOOQO7+%y7+%yOOQO7+&Y7+&YOOQO1G1`1G1`O$,tQQO1G1`OOQO-E:{-E:{O$,|QQO'#IYO$,wQPO1G1`O$&gQPO1G1`O*pQPO1G1`OOQOAN@]AN@]O$-XQQO<<KSO:|QPO<<KSO$-`QPO<<KOOOQO<<KO<<KOO!(aQPO<<KOOOQO1G2S1G2SO$-eQQO7+(VO:|QPO7+(VOOQO<<Kp<<KpP!-iQPO'#HSO!$VQPO'#HRO$-oQPO,5<zO$-zQPO1G2eO<hQPO1G2eO9eQPO7+&SO$.PQPO7+&SOOQO7+&S7+&SOOQO,5=f,5=fOOQO-E:x-E:xO#M{QPO,5;pOOQO,5=Z,5=ZOOQO-E:m-E:mO$.UQPO7+&OOOQO7+%v7+%vO$.dQPO7+&OOOQOG24_G24_OOQOG24vG24vOOQO7+%z7+%zOOQO7+&z7+&zO*pQPO'#HOO$.iQPO,5>tO$.qQPO7+&zO$.vQQO'#IZOOQOAN@nAN@nO$/RQQOAN@nOOQOAN@jAN@jO$/YQPOAN@jO$/_QQO<<KqO$/iQPO,5=mOOQO-E;P-E;POOQO7+(P7+(PO$/zQPO7+(PO$0PQPO<<InOOQO<<In<<InO$0UQPO<<IjOOQO<<Ij<<IjO#M{QPO<<IjO$0UQPO<<IjO$0dQQO,5=jOOQO-E:|-E:|OOQO<<Jf<<JfO$0oQPO,5>uOOQOG26YG26YOOQOG26UG26UOOQO<<Kk<<KkOOQOAN?YAN?YOOQOAN?UAN?UO#M{QPOAN?UO$0wQPOAN?UO$0|QPOAN?UO$1[QPOG24pOOQOG24pG24pO#M{QPOG24pOOQOLD*[LD*[O$1aQPOLD*[OOQO!$'Mv!$'MvO*pQPO'#CaO$1fQQO'#H^O$1yQQO'#CbO!(hQPO'#Cy",stateData:"$2i~OPOSQOS%yOS~OZ`O_VO`VOaVObVOcVOeVOg^Oh^Op!POv{OwkOz!OO}cO!PvO!SyO!TyO!UyO!VyO!WyO!XyO!YyO!ZzO![!`O!]yO!^yO!_yO!u}O!z|O#fpO#roO#tpO#upO#y!RO#z!QO$W!SO$Y!TO$`!UO$c!VO$e!XO$h!WO$l!YO$n!ZO$s![O$u!]O$w!^O$y!_O$|!aO%O!bO%}TO&PRO&RQO&XUO&tdO~Og^Oh^Ov{O}cO!P!mO!SyO!TyO!UyO!VyO!W!pO!XyO!YyO!ZzO!]yO!^yO!_yO!u}O!z|O%}TO&P!cO&R!dO&_!hO&tdO~OWiXW&QXZ&QXuiXu&QX!P&QX!b&QX#]&QX#_&QX#a&QX#b&QX#d&QX#e&QX#f&QX#g&QX#h&QX#i&QX#k&QX#o&QX#r&QX%}iX&PiX&RiX&^&QX&_iX&_&QX&n&QX&viX&v&QX&x!aX~O#p$^X~P&bOWUXW&]XZUXuUXu&]X!PUX!bUX#]UX#_UX#aUX#bUX#dUX#eUX#fUX#gUX#hUX#iUX#kUX#oUX#rUX%}&]X&P&]X&R&]X&^UX&_UX&_&]X&nUX&vUX&v&]X&x!aX~O#p$^X~P(iO&PSO&R!qO~O&W!vO&Y!tO~Og^Oh^O!SyO!TyO!UyO!VyO!WyO!XyO!YyO!ZzO!]yO!^yO!_yO%}TO&P!wO&RWOg!RXh!RX$h!RX&P!RX&R!RX~O#y!|O#z!{O$W!}Ov!RX!u!RX!z!RX&t!RX~P+QOW#XOu#OO%}TO&P#SO&R#SO&v&aX~OW#[Ou&[X%}&[X&P&[X&R&[X&v&[XY&[Xw&[X&n&[X&q&[XZ&[Xq&[X&^&[X!P&[X#_&[X#a&[X#b&[X#d&[X#e&[X#f&[X#g&[X#h&[X#i&[X#k&[X#o&[X#r&[X}&[X!r&[X#p&[Xs&[X|&[X~O&_#YO~P-dO&_&[X~P-dOZ`O_VO`VOaVObVOcVOeVOg^Oh^Op!POwkOz!OO!SyO!TyO!UyO!VyO!WyO!XyO!YyO!ZzO!]yO!^yO!_yO#fpO#roO#tpO#upO%}TO&XUO~O&P#^O&R#]OY&pP~P/uO%}TOg%bXh%bXv%bX!S%bX!T%bX!U%bX!V%bX!W%bX!X%bX!Y%bX!Z%bX!]%bX!^%bX!_%bX!u%bX!z%bX$h%bX&P%bX&R%bX&t%bX&_%bX~O!SyO!TyO!UyO!VyO!WyO!XyO!YyO!ZzO!]yO!^yO!_yOg!RXh!RXv!RX!u!RX!z!RX&P!RX&R!RX&t!RX&_!RX~O$h!RX~P3gO|#kO~P]Og^Oh^Ov#pO!u#rO!z#qO&P!wO&RWO&t#oO~O$h#sO~P5VOu#uO&v#vO!P&TX#_&TX#a&TX#b&TX#d&TX#e&TX#f&TX#g&TX#h&TX#i&TX#k&TX#o&TX#r&TX&^&TX&_&TX&n&TX~OW#tOY&TX#p&TXs&TXq&TX|&TX~P5xO!b#wO#]#wOW&UXu&UX!P&UX#_&UX#a&UX#b&UX#d&UX#e&UX#f&UX#g&UX#h&UX#i&UX#k&UX#o&UX#r&UX&^&UX&_&UX&n&UX&v&UXY&UX#p&UXs&UXq&UX|&UX~OZ#XX~P7jOZ#xO~O&v#vO~O#_#|O#a#}O#b$OO#d$QO#e$RO#f$SO#g$TO#h$UO#i$UO#k$YO#o$VO#r$WO&^#zO&_#zO&n#{O~O!P$XO~P9oO&x$ZO~OZ`O_VO`VOaVObVOcVOeVOg^Oh^Op!POwkOz!OO#fpO#roO#tpO#upO%}TO&P0qO&R0pO&XUO~O#p$_O~O![$aO~O&P#SO&R#SO~Og^Oh^O&P!wO&RWO&_#YO~OW$gO&v#vO~O#z!{O~O!W$kO&PSO&R!qO~OZ$lO~OZ$oO~O!P$vO&P$uO&R$uO~O!P$xO&P$uO&R$uO~O!P${O~P:|OZ%OO}cO~OW&]Xu&]X%}&]X&P&]X&R&]X&_&]X~OZ!aX~P>lOWiXuiX%}iX&PiX&RiX&_iX~OZ!aX~P?XOu#OO%}TO&P#SO&R#SO~O%}TO~P3gOg^Oh^Ov#pO!u#rO!z#qO&_!hO&t#oO~O&P!cO&R!dO~P@ZOg^Oh^O%}TO&P!cO&R!dO~O}cO!P%aO~OZ%bO~O}%dO!m%gO~O}cOg&gXh&gXv&gX!S&gX!T&gX!U&gX!V&gX!W&gX!X&gX!Y&gX!Z&gX!]&gX!^&gX!_&gX!u&gX!z&gX%}&gX&P&gX&R&gX&_&gX&t&gX~OW%jOZ%kOgTahTa%}Ta&PTa&RTa~OvTa!STa!TTa!UTa!VTa!WTa!XTa!YTa!ZTa!]Ta!^Ta!_Ta!uTa!zTa#yTa#zTa$WTa$hTa&tTa&_TauTaYTaqTa|Ta!PTa~PC[O&W%nO&Y!tO~Ou#OO%}TOqma&^maYma&nma!Pma~O&vma}ma!rma~PEnO!SyO!TyO!UyO!VyO!WyO!XyO!YyO!ZzO!]yO!^yO!_yO~Og!Rah!Rav!Ra!u!Ra!z!Ra$h!Ra&P!Ra&R!Ra&t!Ra&_!Ra~PFdO#z%pO~Os%rO~Ou%sO%}TO~Ou#OO%}ra&Pra&Rra&vraYrawra&nra&qra!Pra&^raqra~OWra#_ra#ara#bra#dra#era#fra#gra#hra#ira#kra#ora#rra&_ra#prasra|ra~PH_Ou#OO%}TOq&iX!P&iX!b&iX~OY&iX#p&iX~PJ`O!b%vOq!`X!P!`XY!`X~Oq%wO!P&hX~O!P%yO~Ov%zO~Og^Oh^O%}0oO&P!wO&RWO&b%}O~O&^&`P~PKmO%}TO&P!wO&RWO~OW&QXYiXY!aXY&QXZ&QXq!aXu&QXwiX!b&QX#]&QX#_&QX#a&QX#b&QX#d&QX#e&QX#f&QX#g&QX#h&QX#i&QX#k&QX#o&QX#r&QX&^&QX&_&QX&niX&n&QX&qiX&viX&v&QX&x!aX~P?XOWUXYUXY!aXY&]XZUXq!aXuUXw&]X!bUX#]UX#_UX#aUX#bUX#dUX#eUX#fUX#gUX#hUX#iUX#kUX#oUX#rUX&^UX&_UX&nUX&n&]X&q&]X&vUX&v&]X&x!aX~P>lOg^Oh^O%}TO&P!wO&RWOg!RXh!RX&P!RX&R!RX~PFdOu#OOw&XO%}TO&P&UO&R&TO&q&WO~OW#XOY&aX&n&aX&v&aX~P!#YOY&ZO~P9oOg^Oh^O&P!wO&RWO~Oq&]OY&pX~OY&_O~Og^Oh^O%}TO&P!wO&RWOY&pP~PFdOY&dO&n&bO&v#vO~Oq&eO&x$ZOY&wX~OY&gO~O%}TOg%bah%bav%ba!S%ba!T%ba!U%ba!V%ba!W%ba!X%ba!Y%ba!Z%ba!]%ba!^%ba!_%ba!u%ba!z%ba$h%ba&P%ba&R%ba&t%ba&_%ba~O|&hO~P]O}&iO~Op&uOw&vO&PSO&R!qO&_#YO~Oz&tO~P!'iOz&xO&PSO&R!qO&_#YO~OY&eP~P:|Og^Oh^O%}TO&P!wO&RWO~O}cO~P:|OW#XOu#OO%}TO&v&aX~O#r$WO!P#sa#_#sa#a#sa#b#sa#d#sa#e#sa#f#sa#g#sa#h#sa#i#sa#k#sa#o#sa&^#sa&_#sa&n#saY#sa#p#sas#saq#sa|#sa~Oo'_O}'^O!r'`O&_!hO~O}'eO!r'`O~Oo'iO}'hO&_!hO~OZ#xOu'mO%}TO~OW%jO}'sO~OW%jO!P'uO~OW'vO!P'wO~O$h!WO&P0qO&R0pO!P&eP~P/uO!P(SO#p(TO~P9oO}(UO~O$c(WO~O!P(XO~O!P(YO~O!P(ZO~P9oO!P(]O~P9oOZ$lO_VO`VOaVObVOcVOeVOg^Oh^Op!POwkOz!OO%}TO&P(_O&R(^O&XUO~PFdO%Q(hO%U(iOZ$}a_$}a`$}aa$}ab$}ac$}ae$}ag$}ah$}ap$}av$}aw$}az$}a}$}a!P$}a!S$}a!T$}a!U$}a!V$}a!W$}a!X$}a!Y$}a!Z$}a![$}a!]$}a!^$}a!_$}a!u$}a!z$}a#f$}a#r$}a#t$}a#u$}a#y$}a#z$}a$W$}a$Y$}a$`$}a$c$}a$e$}a$h$}a$l$}a$n$}a$s$}a$u$}a$w$}a$y$}a$|$}a%O$}a%w$}a%}$}a&P$}a&R$}a&X$}a&t$}a|$}a$a$}a$q$}a~O}ra!rra'Ora~PH_OZ%bO~PJ`O!P(mO~O!m%gO}&la!P&la~O}cO!P(pO~Oo(tOq!fX&^!fX~Oq(vO&^&mX~O&^(xO~OZ`O_VO`VOaVObVOcVOeVOg^Oh^Op)UOv{Ow)TOz!OO|)PO}cO!PvO![!`O!u}O!z|O#fpO#roO#tpO#upO#y!RO#z!QO$W!SO$Y!TO$`!UO$c!VO$e!XO$h!WO$l!YO$n!ZO$s![O$u!]O$w!^O$y!_O$|!aO%O!bO%}TO&PRO&RQO&XUO&_#YO&tdO~PFdO}%dO~O})]OY&zP~P:|OW%jO!P)dO~Os)eO~Ou#OO%}TOq&ia!P&ia!b&iaY&ia#p&ia~O})fO~P:|Oq%wO!P&ha~Og^Oh^O%}0oO&P!wO&RWO~O&b)mO~P!8jOu#OO%}TOq&aX&^&aXY&aX&n&aX!P&aX~O}&aX!r&aX~P!9SOo)oOp)oOqnX&^nX~Oq)pO&^&`X~O&^)rO~Ou#OOw)tO%}TO&PSO&R!qO~OYma&nma&vma~P!:bOW&QXY!aXq!aXu!aX%}!aX~OWUXY!aXq!aXu!aX%}!aX~OW)wO~Ou#OO%}TO&P#SO&R#SO&q)yO~Og^Oh^O%}TO&P!wO&RWO~PFdOq&]OY&pa~Ou#OO%}TO&P#SO&R#SO&q&WO~OY)|O~OY*PO&n&bO~Oq&eOY&wa~Og^Oh^Ov{O|*XO!u}O%}TO&P!wO&RWO&tdO~PFdO!P*YO~OW^iZ#XXu^i!P^i!b^i#]^i#_^i#a^i#b^i#d^i#e^i#f^i#g^i#h^i#i^i#k^i#o^i#r^i&^^i&_^i&n^i&v^iY^i#p^is^iq^i|^i~OW*iO~Os*jO~P9oOz*kO&PSO&R!qO~O!P]iY]i#p]is]iq]i|]i~P9oOq*lOY&eX!P&eX~P9oOY*nO~O#f$SO#g$TO#k$YO#r$WO!P#^i#_#^i#a#^i#b#^i#d#^i#e#^i#o#^i&^#^i&_#^i&n#^iY#^i#p#^is#^iq#^i|#^i~O#h$UO#i$UO~P!AmO#_#|O#d$QO#e$RO#f$SO#g$TO#h$UO#i$UO#k$YO#r$WO&^#zO&_#zO&n#{O!P#^i#b#^i#o#^iY#^i#p#^is#^iq#^i|#^i~O#a#^i~P!CUO#a#}O~P!CUO#_#|O#f$SO#g$TO#h$UO#i$UO#k$YO#r$WO&^#zO&_#zO!P#^i#a#^i#b#^i#d#^i#e#^i#o#^iY#^i#p#^is#^iq#^i|#^i~O&n#^i~P!DtO&n#{O~P!DtO#f$SO#g$TO#k$YO#r$WO!P#^i#a#^i#b#^i#e#^i#o#^iY#^i#p#^is#^iq#^i|#^i~O#_#|O#d$QO#h$UO#i$UO&^#zO&_#zO&n#{O~P!FdO#k$YO#r$WO!P#^i#_#^i#a#^i#b#^i#d#^i#e#^i#f#^i#h#^i#i#^i#o#^i&^#^i&_#^i&n#^iY#^i#p#^is#^iq#^i|#^i~O#g$TO~P!G{O#g#^i~P!G{O#h#^i#i#^i~P!AmO#p*oO~P9oO#_&aX#a&aX#b&aX#d&aX#e&aX#f&aX#g&aX#h&aX#i&aX#k&aX#o&aX#r&aX&_&aX#p&aXs&aX|&aX~P!9SO!P#liY#li#p#lis#liq#li|#li~P9oO|*rO~P$wO}'^O~O}'^O!r'`O~Oo'_O}'^O!r'`O~O%}TO&P#SO&R#SO|&sP!P&sP~PFdO}'eO~Og^Oh^Ov{O|+PO!P*}O!u}O!z|O%}TO&P!wO&RWO&_!hO&tdO~PFdO}'hO~Oo'iO}'hO~Os+RO~P:|Ou+TO%}TO~Ou'mO})fO%}TOW#Zi!P#Zi#_#Zi#a#Zi#b#Zi#d#Zi#e#Zi#f#Zi#g#Zi#h#Zi#i#Zi#k#Zi#o#Zi#r#Zi&^#Zi&_#Zi&n#Zi&v#ZiY#Zi#p#Zis#Ziq#Zi|#Zi~O}'^OW&diu&di!P&di#_&di#a&di#b&di#d&di#e&di#f&di#g&di#h&di#i&di#k&di#o&di#r&di&^&di&_&di&n&di&v&diY&di#p&dis&diq&di|&di~O#}+]O$P+^O$R+^O$S+_O$T+`O~O|+[O~P##nO$Z+aO&PSO&R!qO~OW+bO!P+cO~O$a+dOZ$_i_$_i`$_ia$_ib$_ic$_ie$_ig$_ih$_ip$_iv$_iw$_iz$_i}$_i!P$_i!S$_i!T$_i!U$_i!V$_i!W$_i!X$_i!Y$_i!Z$_i![$_i!]$_i!^$_i!_$_i!u$_i!z$_i#f$_i#r$_i#t$_i#u$_i#y$_i#z$_i$W$_i$Y$_i$`$_i$c$_i$e$_i$h$_i$l$_i$n$_i$s$_i$u$_i$w$_i$y$_i$|$_i%O$_i%w$_i%}$_i&P$_i&R$_i&X$_i&t$_i|$_i$q$_i~Og^Oh^O$h#sO&P!wO&RWO~O!P+hO~P:|O!P+iO~OZ`O_VO`VOaVObVOcVOeVOg^Oh^Op!POv{OwkOz!OO}cO!PvO!SyO!TyO!UyO!VyO!WyO!XyO!YyO!Z+nO![!`O!]yO!^yO!_yO!u}O!z|O#fpO#roO#tpO#upO#y!RO#z!QO$W!SO$Y!TO$`!UO$c!VO$e!XO$h!WO$l!YO$n!ZO$q+oO$s![O$u!]O$w!^O$y!_O$|!aO%O!bO%}TO&PRO&RQO&XUO&tdO~O|+mO~P#)QOW&QXY&QXZ&QXu&QX!P&QX&viX&v&QX~P?XOWUXYUXZUXuUX!PUX&vUX&v&]X~P>lOW#tOu#uO&v#vO~OW&UXY%XXu&UX!P%XX&v&UX~OZ#XX~P#.VOY+uO!P+sO~O%Q(hO%U(iOZ$}i_$}i`$}ia$}ib$}ic$}ie$}ig$}ih$}ip$}iv$}iw$}iz$}i}$}i!P$}i!S$}i!T$}i!U$}i!V$}i!W$}i!X$}i!Y$}i!Z$}i![$}i!]$}i!^$}i!_$}i!u$}i!z$}i#f$}i#r$}i#t$}i#u$}i#y$}i#z$}i$W$}i$Y$}i$`$}i$c$}i$e$}i$h$}i$l$}i$n$}i$s$}i$u$}i$w$}i$y$}i$|$}i%O$}i%w$}i%}$}i&P$}i&R$}i&X$}i&t$}i|$}i$a$}i$q$}i~OZ+xO~O%Q(hO%U(iOZ%Vi_%Vi`%Via%Vib%Vic%Vie%Vig%Vih%Vip%Viv%Viw%Viz%Vi}%Vi!P%Vi!S%Vi!T%Vi!U%Vi!V%Vi!W%Vi!X%Vi!Y%Vi!Z%Vi![%Vi!]%Vi!^%Vi!_%Vi!u%Vi!z%Vi#f%Vi#r%Vi#t%Vi#u%Vi#y%Vi#z%Vi$W%Vi$Y%Vi$`%Vi$c%Vi$e%Vi$h%Vi$l%Vi$n%Vi$s%Vi$u%Vi$w%Vi$y%Vi$|%Vi%O%Vi%w%Vi%}%Vi&P%Vi&R%Vi&X%Vi&t%Vi|%Vi$a%Vi$q%Vi~Ou#OO%}TO}&oa!P&oa!m&oa~O!P,OO~Oo(tOq!fa&^!fa~Oq(vO&^&ma~O!m%gO}&li!P&li~O|,XO~P]OW,ZO~P5xOW&UXu&UX#_&UX#a&UX#b&UX#d&UX#e&UX#f&UX#g&UX#h&UX#i&UX#k&UX#o&UX#r&UX&^&UX&_&UX&n&UX&v&UX~OZ#xO!P&UX~P#8^OW$gOZ#xO&v#vO~Op,]Ow,]O~Oq,^O}&rX!P&rX~O!b,`O#]#wOY&UXZ#XX~P#8^OY&SXq&SX|&SX!P&SX~P9oO})]O|&yP~P:|OY&SXg%[Xh%[X%}%[X&P%[X&R%[Xq&SX|&SX!P&SX~Oq,cOY&zX~OY,eO~O})fO|&kP~P:|Oq&jX!P&jX|&jXY&jX~P9oO&bTa~PC[Oo)oOp)oOqna&^na~Oq)pO&^&`a~OW,mO~Ow,nO~Ou#OO%}TO&P,rO&R,qO~Og^Oh^Ov#pO!u#rO&P!wO&RWO&t#oO~Og^Oh^Ov{O|,wO!u}O%}TO&P!wO&RWO&tdO~PFdOw-SO&PSO&R!qO&_#YO~Oq*lOY&ea!P&ea~O#_ma#ama#bma#dma#ema#fma#gma#hma#ima#kma#oma#rma&_ma#pmasma|ma~PEnO|-WO~P$wOZ#xO}'^Oq!|X|!|X!P!|X~Oq-[O|&sX!P&sX~O|-_O!P-^O~O&_!hO~P5VOg^Oh^Ov{O|-cO!P*}O!u}O!z|O%}TO&P!wO&RWO&_!hO&tdO~PFdOs-dO~P9oOs-dO~P:|O}'^OW&dqu&dq!P&dq#_&dq#a&dq#b&dq#d&dq#e&dq#f&dq#g&dq#h&dq#i&dq#k&dq#o&dq#r&dq&^&dq&_&dq&n&dq&v&dqY&dq#p&dqs&dqq&dq|&dq~O|-hO~P##nO!W-lO$O-lO&PSO&R!qO~O!P-oO~O$Z-pO&PSO&R!qO~O!b%vO#p-rOq!`X!P!`X~O!P-tO~P9oO!P-tO~P:|O!P-wO~P9oO|-yO~P#)QO![$aO#p-zO~O!P-|O~O!b-}O~OY.QOZ$lO_VO`VOaVObVOcVOeVOg^Oh^Op!POwkOz!OO%}TO&P(_O&R(^O&XUO~PFdOY.QO!P.RO~O%Q(hO%U(iOZ%Vq_%Vq`%Vqa%Vqb%Vqc%Vqe%Vqg%Vqh%Vqp%Vqv%Vqw%Vqz%Vq}%Vq!P%Vq!S%Vq!T%Vq!U%Vq!V%Vq!W%Vq!X%Vq!Y%Vq!Z%Vq![%Vq!]%Vq!^%Vq!_%Vq!u%Vq!z%Vq#f%Vq#r%Vq#t%Vq#u%Vq#y%Vq#z%Vq$W%Vq$Y%Vq$`%Vq$c%Vq$e%Vq$h%Vq$l%Vq$n%Vq$s%Vq$u%Vq$w%Vq$y%Vq$|%Vq%O%Vq%w%Vq%}%Vq&P%Vq&R%Vq&X%Vq&t%Vq|%Vq$a%Vq$q%Vq~Ou#OO%}TO}&oi!P&oi!m&oi~O&n&bOq!ga&^!ga~O!m%gO}&lq!P&lq~O|.^O~P]Op.`Ow&vOz&tO&PSO&R!qO&_#YO~O!P.aO~Oq,^O}&ra!P&ra~O})]O~P:|Oq.gO|&yX~O|.iO~Oq,cOY&za~Oq.mO|&kX~O|.oO~Ow.pO~Oq!aXu!aX!P!aX!b!aX%}!aX~OZ&QX~P#N{OZUX~P#N{O!P.qO~OZ.rO~OW^yZ#XXu^y!P^y!b^y#]^y#_^y#a^y#b^y#d^y#e^y#f^y#g^y#h^y#i^y#k^y#o^y#r^y&^^y&_^y&n^y&v^yY^y#p^ys^yq^y|^y~OY%`aq%`a!P%`a~P9oO!P#nyY#ny#p#nys#nyq#ny|#ny~P9oO}'^Oq!|a|!|a!P!|a~OZ#xO}'^Oq!|a|!|a!P!|a~O%}TO&P#SO&R#SOq%jX|%jX!P%jX~PFdOq-[O|&sa!P&sa~O|!}X~P$wO|/PO~Os/QO~P9oOW%jO!P/RO~OW%jO$Q/WO&PSO&R!qO!P&|P~OW%jO$U/XO~O!P/YO~O!b%vO#p/[Oq!`X!P!`X~OY/^O~O!P/_O~P9oO#p/`O~P9oO!b/bO~OY/cOZ$lO_VO`VOaVObVOcVOeVOg^Oh^Op!POwkOz!OO%}TO&P(_O&R(^O&XUO~PFdOW#[Ou&[X%}&[X&P&[X&R&[X'O&[X~O&_#YO~P$)QOu#OO%}TO'O/eO&P%SX&R%SX~O&n&bOq!gi&^!gi~Op/iO&PSO&R!qO~OW*iOZ#xO~O!P/kO~OY&SXq&SX~P9oO})]Oq%nX|%nX~P:|Oq.gO|&ya~O!b/nO~O})fOq%cX|%cX~P:|Oq.mO|&ka~OY/qO~O!P/rO~OZ/sO~O}'^Oq!|i|!|i!P!|i~O|!}a~P$wOW%jO!P/wO~OW%jOq/xO!P&|X~OY/|O~P9oOY0OO~OY%Xq!P%Xq~P9oO'O/eO&P%Sa&R%Sa~OY0TO~O!P0WO~Ou#OO!P0YO!Z0ZO%}TO~OY0[O~Oq/xO!P&|a~O!P0_O~OW%jOq/xO!P&}X~OY0aO~P9oOY0bO~OY%Xy!P%Xy~P9oOu#OO%}TO&P%ua&R%ua'O%ua~OY0cO~O!P0dO~Ou#OO!P0eO!Z0fO%}TO~OW%jOq%ra!P%ra~Oq/xO!P&}a~O!P0jO~Ou#OO!P0jO!Z0kO%}TO~O!P0lO~O!P0nO~O#p&QXY&QXs&QXq&QX|&QX~P&bO#pUXYUXsUXqUX|UX~P(iO`Q_P#g%y&P&Xc&X~",goto:"#+S'OPPPP'P'd*x.OP'dPP.d.h0PPPPPP1nP3ZPP4v7l:[<z=d?[PPP?bPA{PPPBu3ZPDqPPElPFcFkPPPPPPPPPPPPGvH_PKjKrLOLjLpLvNiNmNmNuP! U!!^!#R!#]P!#r!!^P!#x!$S!!y!$cP!%S!%^!%d!!^!%g!%mFcFc!%q!%{!&O3Z!'m3Z3Z!)iP.hP!)mPP!*_PPPPPP.hP.h!+O.hPP.hP.hPP.h!,g!,qPP!,w!-QPPPPPPPP'PP'PPP!-U!-U!-i!-UPP!-UP!-UP!.S!.VP!-U!.m!-UP!-UP!.p!.sP!-UP!-UP!-UP!-UP!-U!-UP!-UP!.wP!.}!/Q!/WP!-U!/d!/gP!/o!0R!4T!4Z!4a!5g!5m!5{!7R!7X!7_!7i!7o!7u!7{!8R!8X!8_!8e!8k!8q!8w!8}!9T!9_!9e!9o!9uPPP!9{!-U!:pP!>WP!?[P!Ap!BW!E]3ZPPP!F|!Jm!MaPP#!P#!SP#$`#$f#&V#&f#&n#'p#(Y#)T#)^#)a#)oP#)r#*OP#*V#*^P#*aP#*lP#*o#*r#*u#*y#+PstOcx![#l$_$m$n$p$q%d(U)Q)R+d+l,Y'urOPXY`acopx!Y![!_!a!e!f!h!i!o!x#P#T#Y#[#_#`#e#i#l#n#u#w#x#|#}$O$P$Q$R$S$T$U$V$Y$Z$[$]$_$e$l$m$n$o$p$q%O%S%V%Z%^%_%b%d%g%k%u%v%{%|&R&S&[&]&`&b&d&i'X'^'_'`'e'h'i'm'n'p'{'|(O(T(U(`(l(t(v({(})O)Q)R)])f)o)p*P*T*W*l*o*p*q*z*{+O+T+d+f+h+i+l+o+r+s+x+},W,Y,^,`,u-[-^-a-r-t-}.R.V.g.m/O/[/_/b/d/n/q0R0X0Z0[0f0h0k0r#xhO`copx!Y![!_!a#l#u#w#x#|#}$O$P$Q$R$S$T$U$V$Z$_$l$m$n$o$p$q%d%v&d'm(O(T(U)Q)R)])f*P*l*o+T+d+h+i+l+o,Y,`-r-t-}.g.m/[/_/b/n0Z0f0kt!sT!Q!S!T!{!}$k%p+]+^+_+`-k-m/W/X/x0oQ#mdS&Y#`(}Q&l#oU&q#t$g,ZQ&x#vW(b%O+s.R/dU)Y%j'v+bQ)Z%kS)u&S,WU*f&s-R._Q*k&yQ,t*TQ-P*iQ.j,cR.t,uu!sT!Q!S!T!{!}$k%p+]+^+_+`-k-m/W/X/x0oT%l!r)l#{qO`copx!Y![!_!a#l#u#w#x#|#}$O$P$Q$R$S$T$U$V$Z$_$l$m$n$o$p$q%d%k%v&d'm(O(T(U)Q)R)])f*P*l*o+T+d+h+i+l+o,Y,`-r-t-}.g.m/[/_/b/n0Z0f0k#zlO`copx!Y![!_!a#l#u#w#x#|#}$O$P$Q$R$S$T$U$V$Z$_$l$m$n$o$p$q%d%k%v&d'm(O(T(U)Q)R)])f*P*l*o+T+d+h+i+l+o,Y,`-r-t-}.g.m/[/_/b/n0Z0f0kX(c%O+s.R/d$TVO`copx!Y![!_!a#l#u#w#x#|#}$O$P$Q$R$S$T$U$V$Z$_$l$m$n$o$p$q%O%d%k%v&d'm(O(T(U)Q)R)])f*P*l*o+T+d+h+i+l+o+s,Y,`-r-t-}.R.g.m/[/_/b/d/n0Z0f0k$TkO`copx!Y![!_!a#l#u#w#x#|#}$O$P$Q$R$S$T$U$V$Z$_$l$m$n$o$p$q%O%d%k%v&d'm(O(T(U)Q)R)])f*P*l*o+T+d+h+i+l+o+s,Y,`-r-t-}.R.g.m/[/_/b/d/n0Z0f0k&O[OPX`ceopx!O!Y![!_!a!g!i!o#Y#_#b#e#l#u#w#x#|#}$O$P$Q$R$S$T$U$V$Y$Z$[$_$f$l$m$n$o$p$q%O%_%b%d%g%k%v%{&]&b&d&i&t'^'_'`'h'i'm'{'}(O(T(U(d(t)O)Q)R)])f)o)p*P*U*W*l*o*q*{*|+O+T+d+h+i+l+o+s,Y,^,`-^-r-t-}.R.g.m/O/[/_/b/d/n0Z0f0k0rQ&Q#[Q)s&RV.T+x.X/e&O[OPX`ceopx!O!Y![!_!a!g!i!o#Y#_#b#e#l#u#w#x#|#}$O$P$Q$R$S$T$U$V$Y$Z$[$_$f$l$m$n$o$p$q%O%_%b%d%g%k%v%{&]&b&d&i&t'^'_'`'h'i'm'{'}(O(T(U(d(t)O)Q)R)])f)o)p*P*U*W*l*o*q*{*|+O+T+d+h+i+l+o+s,Y,^,`-^-r-t-}.R.g.m/O/[/_/b/d/n0Z0f0k0rV.T+x.X/e&O]OPX`ceopx!O!Y![!_!a!g!i!o#Y#_#b#e#l#u#w#x#|#}$O$P$Q$R$S$T$U$V$Y$Z$[$_$f$l$m$n$o$p$q%O%_%b%d%g%k%v%{&]&b&d&i&t'^'_'`'h'i'm'{'}(O(T(U(d(t)O)Q)R)])f)o)p*P*U*W*l*o*q*{*|+O+T+d+h+i+l+o+s,Y,^,`-^-r-t-}.R.g.m/O/[/_/b/d/n0Z0f0k0rV.U+x.X/eS#Z[.TS$f!O&tS&s#t$gQ&y#vQ)V%dQ-R*iR._,Z$kZO`copx!Y![!_!a#Y#l#u#w#x#|#}$O$P$Q$R$S$T$U$V$Y$Z$_$l$m$n$o$p$q%O%d%g%k%v&b&d'_'`'i'm(O(T(U(t)Q)R)])f)o)p*P*l*o+T+d+h+i+l+o+s,Y,^,`-r-t-}.R.g.m/[/_/b/d/n0Z0f0kQ&O#YR,k)p&P_OPX`ceopx!Y![!_!a!g!i!o#Y#_#b#e#l#u#w#x#|#}$O$P$Q$R$S$T$U$V$Y$Z$[$_$l$m$n$o$p$q%O%_%b%d%g%k%v%{&]&b&d&i'^'_'`'h'i'm'{'}(O(T(U(d(t)O)Q)R)])f)o)p*P*U*W*l*o*q*{*|+O+T+d+h+i+l+o+s+x,Y,^,`-^-r-t-}.R.X.g.m/O/[/_/b/d/e/n0Z0f0k0r!o#QY!e!x#R#T#`#n$]%R%S%V%^%u%|&S&[&`'X'|(`(l({(}*T*p*z+f+r+},W,u-a.V/q0R0X0[0h$SkO`copx!Y![!_!a#l#u#w#x#|#}$O$P$Q$R$S$T$U$V$Z$_$l$m$n$o$p$q%O%d%k%v&d'm(O(T(U)Q)R)])f*P*l*o+T+d+h+i+l+o+s,Y,`-r-t-}.R.g.m/[/_/b/d/n0Z0f0kQ$m!UQ$n!VQ$s!ZQ$|!`R+p(WQ#yiS'q$e*hQ*e&rQ+X'rS,[)T)UQ-O*gQ-Y*vQ.b,]Q.x-QQ.{-ZQ/j.`Q/u.yR0V/iQ'a$bW*[&m'b'c'dQ+W'qU,x*]*^*_Q-X*vQ-f+XS.u,y,zS.z-Y-ZQ/t.vR/v.{]!mP!o'^*q-^/OreOcx![#l$_$m$n$p$q%d(U)Q)R+d+l,Y[!gP!o'^*q-^/OW#b`#e%b&]Q'}$oW(d%O+s.R/dS*U&i*WS*w'e-[S*|'h+OR.X+xh#VY!W!e#n#s%V'|*T*z+f,u-aQ)j%wQ)v&WR,o)y#xnOcopx!Y![!_!a#l#u#w#x#|#}$O$P$Q$R$S$T$U$V$Z$_$l$m$n$o$p$q%d%k%v&d'm(O(T(U)Q)R)])f*P*l*o+T+d+h+i+l+o,Y,`-r-t-}.g.m/[/_/b/n0Z0f0k^!kP!g!o'^*q-^/Ov#TY!W#`#n#s%w&W&[&`'|(`(})y*T+f+r,u.W/hQ#g`Q$b{Q$c|Q$d}W%S!e%V*z-aS%Y!h(vQ%`!iQ&m#pQ&n#qQ&o#rQ(u%ZS(y%^({Q*R&eS*v'e-[R-Z*wU)h%v)f.mR+V'p[!mP!o'^*q-^/OT*}'h+O^!iP!g!o'^*q-^/OQ'd$bQ'l$dQ*_&mQ*d&oV*{'h*|+OQ%[!hR,S(vQ(s%YR,R(u#znO`copx!Y![!_!a#l#u#w#x#|#}$O$P$Q$R$S$T$U$V$Z$_$l$m$n$o$p$q%d%k%v&d'm(O(T(U)Q)R)])f*P*l*o+T+d+h+i+l+o,Y,`-r-t-}.g.m/[/_/b/n0Z0f0kQ%c!kS(l%S(yR(|%`T#e`%bU#c`#e%bR)z&]Q%f!lQ(n%UQ(r%XQ,U(zR.],VrvOcx![#l$_$m$n$p$q%d(U)Q)R+d+l,Y[!mP!o'^*q-^/OQ%P!bQ%a!jQ%i!pQ'[$ZQ([$|Q(k%QQ(p%WQ+z(iR.Y+yrtOcx![#l$_$m$n$p$q%d(U)Q)R+d+l,Y[!mP!o'^*q-^/OS*V&i*WT*}'h+OQ'c$bS*^&m'dR,z*_Q'b$bQ'g$cU*]&m'c'dQ*a&nS,y*^*_R.v,zQ*u'`R+Q'iQ'k$dS*c&o'lR,}*dQ'j$dU*b&o'k'lS,|*c*dR.w,}rtOcx![#l$_$m$n$p$q%d(U)Q)R+d+l,Y[!mP!o'^*q-^/OT*}'h+OQ'f$cS*`&n'gR,{*aQ*x'eR.|-[R-`*yQ&j#mR*Z&lT*V&i*WQ%e!lS(q%X%fR,P(rR)R%dWk%O+s.R/d#{lO`copx!Y![!_!a#l#u#w#x#|#}$O$P$Q$R$S$T$U$V$Z$_$l$m$n$o$p$q%d%k%v&d'm(O(T(U)Q)R)])f*P*l*o+T+d+h+i+l+o,Y,`-r-t-}.g.m/[/_/b/n0Z0f0k$SiO`copx!Y![!_!a#l#u#w#x#|#}$O$P$Q$R$S$T$U$V$Z$_$l$m$n$o$p$q%O%d%k%v&d'm(O(T(U)Q)R)])f*P*l*o+T+d+h+i+l+o+s,Y,`-r-t-}.R.g.m/[/_/b/d/n0Z0f0kU&r#t$g,ZS*g&s._Q-Q*iR.y-RT'o$e'p!_#|m#a$r$z$}&w&z&{'O'P'Q'R'S'W'Z)[)g+S+g+j-T-V-e-v-{.e/Z/a/}0Q!]$Pm#a$r$z$}&w&z&{'O'P'R'S'W'Z)[)g+S+g+j-T-V-e-v-{.e/Z/a/}0Q#{nO`copx!Y![!_!a#l#u#w#x#|#}$O$P$Q$R$S$T$U$V$Z$_$l$m$n$o$p$q%d%k%v&d'm(O(T(U)Q)R)])f*P*l*o+T+d+h+i+l+o,Y,`-r-t-}.g.m/[/_/b/n0Z0f0ka)^%k)],`.g/n0Z0f0kQ)`%kR.k,cQ't$hQ)b%oR,f)cT+Y's+ZsvOcx![#l$_$m$n$p$q%d(U)Q)R+d+l,YruOcx![#l$_$m$n$p$q%d(U)Q)R+d+l,YQ$w!]R$y!^R$p!XrvOcx![#l$_$m$n$p$q%d(U)Q)R+d+l,YR(O$oR$q!XR(V$sT+k(U+lX(f%P(g(k+{R+y(hQ.W+xR/h.XQ(j%PQ+w(gQ+|(kR.Z+{R%Q!bQ(e%OV.P+s.R/dQxOQ#lcW$`x#l)Q,YQ)Q%dR,Y)RrXOcx![#l$_$m$n$p$q%d(U)Q)R+d+l,Yn!fP!o#e&]&i'^'e'h*W*q+O+x-[-^/Ol!zX!f#P#_#i$[%Z%_%{&R'n'{)O0r!j#PY!e!x#T#`#n$]%S%V%^%u%|&S&[&`'X'|(`(l({(}*T*p*z+f+r+},W,u-a.V/q0R0X0[0hQ#_`Q#ia#d$[op!Y!_!a#u#w#x#|#}$O$P$Q$R$S$T$U$V$Z$l%g%k%v&b&d'_'`'i'm(O(T(t)])f)o*P*l*o+T+h+i+o,^,`-r-t-}.g.m/[/_/b/n0Z0f0kS%Z!h(vS%_!i*{S%{#Y)pQ&R#[S'n$e'pY'{$o%O+s.R/dQ)O%bR0r$YQ!uUR%m!uQ)q&OR,l)q^#RY#`$]'X'|(`*px%R!e!x#n%V%^%|&S&[&`({(}*T*z+f+r,W,u-a.V0R[%t#R%R%u+}0X0hS%u#T%SQ+}(lQ0X/qR0h0[Q*m&{R-U*mQ!oPU%h!o*q/OQ*q'^R/O-^!pbOP`cx![!o#e#l$_$m$n$o$p$q%O%b%d&]&i'^'e'h(U)Q)R*W*q+O+d+l+s+x,Y-[-^.R/O/dY!yX!f#_'{)OT#jb!yQ.n,gR/p.nQ%x#VR)k%xQ&c#fS*O&c.[R.[,QQ(w%[R,T(wQ&^#cR){&^Q,_)WR.d,_Q+O'hR-b+OQ-]*xR.}-]Q*W&iR,v*WQ'p$eR+U'pQ&f#gR*S&fQ.h,aR/m.hQ,d)`R.l,dQ+Z'sR-g+ZQ-k+]R/T-kQ/y/US0^/y0`R0`/{Q+l(UR-x+lQ(g%PS+v(g+{R+{(kQ/f.VR0S/fQ+t(eR.S+t`wOcx#l%d)Q)R,YQ$t![Q']$_Q'y$mQ'z$nQ(Q$pQ(R$qS+k(U+lR-q+d'dsOPXY`acopx!Y![!_!a!e!f!h!i!o!x#P#T#Y#[#_#`#e#i#l#n#u#w#x#|#}$O$P$Q$R$S$T$U$V$Y$Z$[$]$_$e$l$m$n$o$p$q%O%S%V%Z%^%_%b%d%g%u%v%{%|&R&S&[&]&`&b&d&i'X'^'_'`'e'h'i'm'n'p'{'|(O(T(U(`(l(t(v({(})O)Q)R)f)o)p*P*T*W*l*o*p*q*z*{+O+T+d+f+h+i+l+o+r+s+x+},W,Y,^,u-[-^-a-r-t-}.R.V.m/O/[/_/b/d/q0R0X0[0h0ra)_%k)],`.g/n0Z0f0kQ!rTQ$h!QQ$i!SQ$j!TQ%o!{Q%q!}Q'x$kQ)c%pQ)l0oS-i+]+_Q-m+^Q-n+`Q/S-kS/U-m/WQ/{/XR0]/x%uSOT`cdopx!Q!S!T!Y![!_!a!{!}#`#l#o#t#u#v#w#x#|#}$O$P$Q$R$S$T$U$V$Z$_$g$k$l$m$n$o$p$q%O%d%j%k%p%v&S&d&s&y'm'v(O(T(U(})Q)R)])f*P*T*i*l*o+T+]+^+_+`+b+d+h+i+l+o+s,W,Y,Z,`,c,u-R-k-m-r-t-}.R._.g.m/W/X/[/_/b/d/n/x0Z0f0k0oQ)a%kQ,a)]S.f,`/nQ/l.gQ0g0ZQ0i0fR0m0krmOcx![#l$_$m$n$p$q%d(U)Q)R+d+l,YS#a`$lQ$WoQ$^pQ$r!YQ$z!_Q$}!aQ&w#uQ&z#wY&{#x$o+h-t/_Q&}#|Q'O#}Q'P$OQ'Q$PQ'R$QQ'S$RQ'T$SQ'U$TQ'V$UQ'W$VQ'Z$Z^)[%k)].g/n0Z0f0kU)g%v)f.mQ*Q&dQ+S'mQ+g(OQ+j(TQ,p*PQ-T*lQ-V*oQ-e+TQ-v+iQ-{+oQ.e,`Q/Z-rQ/a-}Q/}/[R0Q/b#xgO`copx!Y![!_!a#l#u#w#x#|#}$O$P$Q$R$S$T$U$V$Z$_$l$m$n$o$p$q%k%v&d'm(O(T(U)Q)R)])f*P*l*o+T+d+h+i+l+o,Y,`-r-t-}.g.m/[/_/b/n0Z0f0kW(a%O+s.R/dR)S%drYOcx![#l$_$m$n$p$q%d(U)Q)R+d+l,Y[!eP!o'^*q-^/OW!xX$[%{'{Q#``Q#ne#S$]op!Y!_!a#u#w#x#|#}$O$P$Q$R$S$T$U$V$Z$l%k%v&d'm(O(T)])f*P*l*o+T+h+i+o,`-r-t-}.g.m/[/_/b/n0Z0f0kQ%V!gS%^!i*{d%|#Y%g&b'_'`'i(t)o)p,^Q&S#_Q&[#bS&`#e&]Q'X$YQ'|$oW(`%O+s.R/dQ({%_Q(}%bS*T&i*WQ*p0rS*z'h+OQ+f'}Q+r(dQ,W)OQ,u*UQ-a*|S.V+x.XR0R/e&O_OPX`ceopx!Y![!_!a!g!i!o#Y#_#b#e#l#u#w#x#|#}$O$P$Q$R$S$T$U$V$Y$Z$[$_$l$m$n$o$p$q%O%_%b%d%g%k%v%{&]&b&d&i'^'_'`'h'i'm'{'}(O(T(U(d(t)O)Q)R)])f)o)p*P*U*W*l*o*q*{*|+O+T+d+h+i+l+o+s+x,Y,^,`-^-r-t-}.R.X.g.m/O/[/_/b/d/e/n0Z0f0k0rQ$e!OQ'r$fR*h&t&ZWOPX`ceopx!O!Y![!_!a!g!i!o#Y#[#_#b#e#l#u#w#x#|#}$O$P$Q$R$S$T$U$V$Y$Z$[$_$f$l$m$n$o$p$q%O%_%b%d%g%k%v%{&R&]&b&d&i&t'^'_'`'h'i'm'{'}(O(T(U(d(t)O)Q)R)])f)o)p*P*U*W*l*o*q*{*|+O+T+d+h+i+l+o+s+x,Y,^,`-^-r-t-}.R.X.g.m/O/[/_/b/d/e/n0Z0f0k0rR&P#Y$QjOcopx!Y![!_!a#l#u#w#x#|#}$O$P$Q$R$S$T$U$V$Z$_$l$m$n$o$p$q%O%d%k%v&d'm(O(T(U)Q)R)])f*P*l*o+T+d+h+i+l+o+s,Y,`-r-t-}.R.g.m/[/_/b/d/n0Z0f0kQ#f`Q&O#YQ'Y$YU)W%g'`'iQ)}&bQ*s'_Q,Q(tQ,j)oQ,k)pR.c,^Q)n%}R,i)m$SfO`copx!Y![!_!a#l#u#w#x#|#}$O$P$Q$R$S$T$U$V$Z$_$l$m$n$o$p$q%O%d%k%v&d'm(O(T(U)Q)R)])f*P*l*o+T+d+h+i+l+o+s,Y,`-r-t-}.R.g.m/[/_/b/d/n0Z0f0kT&p#t,ZQ&|#xQ(P$oQ-u+hQ/]-tR0P/_]!nP!o'^*q-^/O#PaOPX`bcx![!f!o!y#_#e#l$_$m$n$o$p$q%O%b%d&]&i'^'e'h'{(U)O)Q)R*W*q+O+d+l+s+x,Y-[-^.R/O/dU#WY!W'|Q%T!eU&k#n#s+fQ(o%VS,s*T*zT.s,u-aj#UY!W!e#n#s%V%w&W)y*T*z,u-aU&V#`&`(}Q)x&[Q+e'|Q+q(`Q-s+fQ.O+rQ/g.WR0U/hQ)i%vQ,g)fR/o.mR,h)f`!jP!o'^'h*q+O-^/OT%W!g*|R%]!hW%U!e%V*z-aQ(z%^R,V({S#d`%bR&a#eQ)X%gT*t'`'iR*y'e[!lP!o'^*q-^/OR%X!gR#h`R,b)]R)a%kT-j+]-kQ/V-mR/z/WR/z/X",nodeNames:"âš  LineComment BlockComment Program ModuleDeclaration MarkerAnnotation Identifier ScopedIdentifier . Annotation ) ( AnnotationArgumentList AssignmentExpression FieldAccess IntegerLiteral FloatingPointLiteral BooleanLiteral CharacterLiteral StringLiteral TextBlock null ClassLiteral void PrimitiveType TypeName ScopedTypeName GenericType TypeArguments AnnotatedType Wildcard extends super , ArrayType ] Dimension [ class this ParenthesizedExpression ObjectCreationExpression new ArgumentList } { ClassBody ; FieldDeclaration Modifiers public protected private abstract static final strictfp default synchronized native transient volatile VariableDeclarator Definition AssignOp ArrayInitializer MethodDeclaration TypeParameters TypeParameter TypeBound FormalParameters ReceiverParameter FormalParameter SpreadParameter Throws throws Block ClassDeclaration Superclass SuperInterfaces implements InterfaceTypeList InterfaceDeclaration interface ExtendsInterfaces InterfaceBody ConstantDeclaration EnumDeclaration enum EnumBody EnumConstant EnumBodyDeclarations AnnotationTypeDeclaration AnnotationTypeBody AnnotationTypeElementDeclaration StaticInitializer ConstructorDeclaration ConstructorBody ExplicitConstructorInvocation ArrayAccess MethodInvocation MethodName MethodReference ArrayCreationExpression Dimension AssignOp BinaryExpression CompareOp CompareOp LogicOp LogicOp BitOp BitOp BitOp ArithOp ArithOp ArithOp BitOp InstanceofExpression instanceof LambdaExpression InferredParameters TernaryExpression LogicOp : UpdateExpression UpdateOp UnaryExpression LogicOp BitOp CastExpression ElementValueArrayInitializer ElementValuePair open module ModuleBody ModuleDirective requires transitive exports to opens uses provides with PackageDeclaration package ImportDeclaration import Asterisk ExpressionStatement LabeledStatement Label IfStatement if else WhileStatement while ForStatement for ForSpec LocalVariableDeclaration var EnhancedForStatement ForSpec AssertStatement assert SwitchStatement switch SwitchBlock SwitchLabel case DoStatement do BreakStatement break ContinueStatement continue ReturnStatement return SynchronizedStatement ThrowStatement throw TryStatement try CatchClause catch CatchFormalParameter CatchType FinallyClause finally TryWithResourcesStatement ResourceSpecification Resource ClassContent",maxTerm:276,nodeProps:[["isolate",-4,1,2,18,19,""],["group",-26,4,47,76,77,82,87,92,145,147,150,151,153,156,158,161,163,165,167,172,174,176,178,180,181,183,191,"Statement",-25,6,13,14,15,16,17,18,19,20,21,22,39,40,41,99,100,102,103,106,118,120,122,125,127,130,"Expression",-7,23,24,25,26,27,29,34,"Type"],["openedBy",10,"(",44,"{"],["closedBy",11,")",45,"}"]],propSources:[aR],skippedNodes:[0,1,2],repeatNodeCount:28,tokenData:"#'f_R!_OX%QXY'fYZ)bZ^'f^p%Qpq'fqr*|rs,^st%Qtu4euv5zvw7[wx8rxyAZyzAwz{Be{|CZ|}Dq}!OE_!O!PFx!P!Q! r!Q!R!,h!R![!0`![!]!>p!]!^!@Q!^!_!@n!_!`!BX!`!a!B{!a!b!Di!b!c!EX!c!}!LT!}#O!Mj#O#P%Q#P#Q!NW#Q#R!Nt#R#S4e#S#T%Q#T#o4e#o#p# h#p#q#!U#q#r##n#r#s#$[#s#y%Q#y#z'f#z$f%Q$f$g'f$g#BY4e#BY#BZ#$x#BZ$IS4e$IS$I_#$x$I_$I|4e$I|$JO#$x$JO$JT4e$JT$JU#$x$JU$KV4e$KV$KW#$x$KW&FU4e&FU&FV#$x&FV;'S4e;'S;=`5t<%lO4eS%VV&YSOY%QYZ%lZr%Qrs%qs;'S%Q;'S;=`&s<%lO%QS%qO&YSS%tVOY&ZYZ%lZr&Zrs&ys;'S&Z;'S;=`'`<%lO&ZS&^VOY%QYZ%lZr%Qrs%qs;'S%Q;'S;=`&s<%lO%QS&vP;=`<%l%QS&|UOY&ZYZ%lZr&Zs;'S&Z;'S;=`'`<%lO&ZS'cP;=`<%l&Z_'mk&YS%yZOX%QXY'fYZ)bZ^'f^p%Qpq'fqr%Qrs%qs#y%Q#y#z'f#z$f%Q$f$g'f$g#BY%Q#BY#BZ'f#BZ$IS%Q$IS$I_'f$I_$I|%Q$I|$JO'f$JO$JT%Q$JT$JU'f$JU$KV%Q$KV$KW'f$KW&FU%Q&FU&FV'f&FV;'S%Q;'S;=`&s<%lO%Q_)iY&YS%yZX^*Xpq*X#y#z*X$f$g*X#BY#BZ*X$IS$I_*X$I|$JO*X$JT$JU*X$KV$KW*X&FU&FV*XZ*^Y%yZX^*Xpq*X#y#z*X$f$g*X#BY#BZ*X$IS$I_*X$I|$JO*X$JT$JU*X$KV$KW*X&FU&FV*XV+TX#tP&YSOY%QYZ%lZr%Qrs%qs!_%Q!_!`+p!`;'S%Q;'S;=`&s<%lO%QU+wV#_Q&YSOY%QYZ%lZr%Qrs%qs;'S%Q;'S;=`&s<%lO%QT,aXOY,|YZ%lZr,|rs3Ys#O,|#O#P2d#P;'S,|;'S;=`3S<%lO,|T-PXOY-lYZ%lZr-lrs.^s#O-l#O#P.x#P;'S-l;'S;=`2|<%lO-lT-qX&YSOY-lYZ%lZr-lrs.^s#O-l#O#P.x#P;'S-l;'S;=`2|<%lO-lT.cVcPOY&ZYZ%lZr&Zrs&ys;'S&Z;'S;=`'`<%lO&ZT.}V&YSOY-lYZ/dZr-lrs1]s;'S-l;'S;=`2|<%lO-lT/iW&YSOY0RZr0Rrs0ns#O0R#O#P0s#P;'S0R;'S;=`1V<%lO0RP0UWOY0RZr0Rrs0ns#O0R#O#P0s#P;'S0R;'S;=`1V<%lO0RP0sOcPP0vTOY0RYZ0RZ;'S0R;'S;=`1V<%lO0RP1YP;=`<%l0RT1`XOY,|YZ%lZr,|rs1{s#O,|#O#P2d#P;'S,|;'S;=`3S<%lO,|T2QUcPOY&ZYZ%lZr&Zs;'S&Z;'S;=`'`<%lO&ZT2gVOY-lYZ/dZr-lrs1]s;'S-l;'S;=`2|<%lO-lT3PP;=`<%l-lT3VP;=`<%l,|T3_VcPOY&ZYZ%lZr&Zrs3ts;'S&Z;'S;=`'`<%lO&ZT3yR&WSXY4SYZ4`pq4SP4VRXY4SYZ4`pq4SP4eO&XP_4lb&YS&PZOY%QYZ%lZr%Qrs%qst%Qtu4eu!Q%Q!Q![4e![!c%Q!c!}4e!}#R%Q#R#S4e#S#T%Q#T#o4e#o$g%Q$g;'S4e;'S;=`5t<%lO4e_5wP;=`<%l4eU6RX#hQ&YSOY%QYZ%lZr%Qrs%qs!_%Q!_!`6n!`;'S%Q;'S;=`&s<%lO%QU6uV#]Q&YSOY%QYZ%lZr%Qrs%qs;'S%Q;'S;=`&s<%lO%QV7cZ&nR&YSOY%QYZ%lZr%Qrs%qsv%Qvw8Uw!_%Q!_!`6n!`;'S%Q;'S;=`&s<%lO%QU8]V#aQ&YSOY%QYZ%lZr%Qrs%qs;'S%Q;'S;=`&s<%lO%QT8wZ&YSOY9jYZ%lZr9jrs:xsw9jwx%Qx#O9j#O#P<S#P;'S9j;'S;=`AT<%lO9jT9oX&YSOY%QYZ%lZr%Qrs%qsw%Qwx:[x;'S%Q;'S;=`&s<%lO%QT:cVbP&YSOY%QYZ%lZr%Qrs%qs;'S%Q;'S;=`&s<%lO%QT:{XOY&ZYZ%lZr&Zrs&ysw&Zwx;hx;'S&Z;'S;=`'`<%lO&ZT;mVbPOY%QYZ%lZr%Qrs%qs;'S%Q;'S;=`&s<%lO%QT<XZ&YSOY<zYZ%lZr<zrs=rsw<zwx9jx#O<z#O#P9j#P;'S<z;'S;=`?^<%lO<zT=PZ&YSOY<zYZ%lZr<zrs=rsw<zwx:[x#O<z#O#P%Q#P;'S<z;'S;=`?^<%lO<zT=uZOY>hYZ%lZr>hrs?dsw>hwx;hx#O>h#O#P&Z#P;'S>h;'S;=`@}<%lO>hT>kZOY<zYZ%lZr<zrs=rsw<zwx:[x#O<z#O#P%Q#P;'S<z;'S;=`?^<%lO<zT?aP;=`<%l<zT?gZOY>hYZ%lZr>hrs@Ysw>hwx;hx#O>h#O#P&Z#P;'S>h;'S;=`@}<%lO>hP@]VOY@YZw@Ywx@rx#O@Y#P;'S@Y;'S;=`@w<%lO@YP@wObPP@zP;=`<%l@YTAQP;=`<%l>hTAWP;=`<%l9j_AbVZZ&YSOY%QYZ%lZr%Qrs%qs;'S%Q;'S;=`&s<%lO%QVBOVYR&YSOY%QYZ%lZr%Qrs%qs;'S%Q;'S;=`&s<%lO%QVBnX$ZP&YS#gQOY%QYZ%lZr%Qrs%qs!_%Q!_!`6n!`;'S%Q;'S;=`&s<%lO%QVCbZ#fR&YSOY%QYZ%lZr%Qrs%qs{%Q{|DT|!_%Q!_!`6n!`;'S%Q;'S;=`&s<%lO%QVD[V#rR&YSOY%QYZ%lZr%Qrs%qs;'S%Q;'S;=`&s<%lO%QVDxVqR&YSOY%QYZ%lZr%Qrs%qs;'S%Q;'S;=`&s<%lO%QVEf[#fR&YSOY%QYZ%lZr%Qrs%qs}%Q}!ODT!O!_%Q!_!`6n!`!aF[!a;'S%Q;'S;=`&s<%lO%QVFcV&xR&YSOY%QYZ%lZr%Qrs%qs;'S%Q;'S;=`&s<%lO%Q_GPZWY&YSOY%QYZ%lZr%Qrs%qs!O%Q!O!PGr!P!Q%Q!Q![IQ![;'S%Q;'S;=`&s<%lO%QVGwX&YSOY%QYZ%lZr%Qrs%qs!O%Q!O!PHd!P;'S%Q;'S;=`&s<%lO%QVHkV&qR&YSOY%QYZ%lZr%Qrs%qs;'S%Q;'S;=`&s<%lO%QTIXc&YS`POY%QYZ%lZr%Qrs%qs!Q%Q!Q![IQ![!f%Q!f!gJd!g!hKQ!h!iJd!i#R%Q#R#SNz#S#W%Q#W#XJd#X#YKQ#Y#ZJd#Z;'S%Q;'S;=`&s<%lO%QTJkV&YS`POY%QYZ%lZr%Qrs%qs;'S%Q;'S;=`&s<%lO%QTKV]&YSOY%QYZ%lZr%Qrs%qs{%Q{|LO|}%Q}!OLO!O!Q%Q!Q![Lp![;'S%Q;'S;=`&s<%lO%QTLTX&YSOY%QYZ%lZr%Qrs%qs!Q%Q!Q![Lp![;'S%Q;'S;=`&s<%lO%QTLwc&YS`POY%QYZ%lZr%Qrs%qs!Q%Q!Q![Lp![!f%Q!f!gJd!g!h%Q!h!iJd!i#R%Q#R#SNS#S#W%Q#W#XJd#X#Y%Q#Y#ZJd#Z;'S%Q;'S;=`&s<%lO%QTNXZ&YSOY%QYZ%lZr%Qrs%qs!Q%Q!Q![Lp![#R%Q#R#SNS#S;'S%Q;'S;=`&s<%lO%QT! PZ&YSOY%QYZ%lZr%Qrs%qs!Q%Q!Q![IQ![#R%Q#R#SNz#S;'S%Q;'S;=`&s<%lO%Q_! y]&YS#gQOY%QYZ%lZr%Qrs%qsz%Qz{!!r{!P%Q!P!Q!)e!Q!_%Q!_!`6n!`;'S%Q;'S;=`&s<%lO%Q_!!wX&YSOY!!rYZ!#dZr!!rrs!%Psz!!rz{!&_{;'S!!r;'S;=`!'s<%lO!!r_!#iT&YSOz!#xz{!$[{;'S!#x;'S;=`!$y<%lO!#xZ!#{TOz!#xz{!$[{;'S!#x;'S;=`!$y<%lO!#xZ!$_VOz!#xz{!$[{!P!#x!P!Q!$t!Q;'S!#x;'S;=`!$y<%lO!#xZ!$yOQZZ!$|P;=`<%l!#x_!%SXOY!%oYZ!#dZr!%ors!'ysz!%oz{!(i{;'S!%o;'S;=`!)_<%lO!%o_!%rXOY!!rYZ!#dZr!!rrs!%Psz!!rz{!&_{;'S!!r;'S;=`!'s<%lO!!r_!&dZ&YSOY!!rYZ!#dZr!!rrs!%Psz!!rz{!&_{!P!!r!P!Q!'V!Q;'S!!r;'S;=`!'s<%lO!!r_!'^V&YSQZOY%QYZ%lZr%Qrs%qs;'S%Q;'S;=`&s<%lO%Q_!'vP;=`<%l!!r_!'|XOY!%oYZ!#dZr!%ors!#xsz!%oz{!(i{;'S!%o;'S;=`!)_<%lO!%o_!(lZOY!!rYZ!#dZr!!rrs!%Psz!!rz{!&_{!P!!r!P!Q!'V!Q;'S!!r;'S;=`!'s<%lO!!r_!)bP;=`<%l!%o_!)lV&YSPZOY!)eYZ%lZr!)ers!*Rs;'S!)e;'S;=`!+X<%lO!)e_!*WVPZOY!*mYZ%lZr!*mrs!+_s;'S!*m;'S;=`!,b<%lO!*m_!*rVPZOY!)eYZ%lZr!)ers!*Rs;'S!)e;'S;=`!+X<%lO!)e_!+[P;=`<%l!)e_!+dVPZOY!*mYZ%lZr!*mrs!+ys;'S!*m;'S;=`!,b<%lO!*mZ!,OSPZOY!+yZ;'S!+y;'S;=`!,[<%lO!+yZ!,_P;=`<%l!+y_!,eP;=`<%l!*mT!,ou&YS_POY%QYZ%lZr%Qrs%qs!O%Q!O!P!/S!P!Q%Q!Q![!0`![!d%Q!d!e!3j!e!f%Q!f!gJd!g!hKQ!h!iJd!i!n%Q!n!o!2U!o!q%Q!q!r!5h!r!z%Q!z!{!7`!{#R%Q#R#S!2r#S#U%Q#U#V!3j#V#W%Q#W#XJd#X#YKQ#Y#ZJd#Z#`%Q#`#a!2U#a#c%Q#c#d!5h#d#l%Q#l#m!7`#m;'S%Q;'S;=`&s<%lO%QT!/Za&YS`POY%QYZ%lZr%Qrs%qs!Q%Q!Q![IQ![!f%Q!f!gJd!g!hKQ!h!iJd!i#W%Q#W#XJd#X#YKQ#Y#ZJd#Z;'S%Q;'S;=`&s<%lO%QT!0gi&YS_POY%QYZ%lZr%Qrs%qs!O%Q!O!P!/S!P!Q%Q!Q![!0`![!f%Q!f!gJd!g!hKQ!h!iJd!i!n%Q!n!o!2U!o#R%Q#R#S!2r#S#W%Q#W#XJd#X#YKQ#Y#ZJd#Z#`%Q#`#a!2U#a;'S%Q;'S;=`&s<%lO%QT!2]V&YS_POY%QYZ%lZr%Qrs%qs;'S%Q;'S;=`&s<%lO%QT!2wZ&YSOY%QYZ%lZr%Qrs%qs!Q%Q!Q![!0`![#R%Q#R#S!2r#S;'S%Q;'S;=`&s<%lO%QT!3oY&YSOY%QYZ%lZr%Qrs%qs!Q%Q!Q!R!4_!R!S!4_!S;'S%Q;'S;=`&s<%lO%QT!4f`&YS_POY%QYZ%lZr%Qrs%qs!Q%Q!Q!R!4_!R!S!4_!S!n%Q!n!o!2U!o#R%Q#R#S!3j#S#`%Q#`#a!2U#a;'S%Q;'S;=`&s<%lO%QT!5mX&YSOY%QYZ%lZr%Qrs%qs!Q%Q!Q!Y!6Y!Y;'S%Q;'S;=`&s<%lO%QT!6a_&YS_POY%QYZ%lZr%Qrs%qs!Q%Q!Q!Y!6Y!Y!n%Q!n!o!2U!o#R%Q#R#S!5h#S#`%Q#`#a!2U#a;'S%Q;'S;=`&s<%lO%QT!7e_&YSOY%QYZ%lZr%Qrs%qs!O%Q!O!P!8d!P!Q%Q!Q![!:r![!c%Q!c!i!:r!i#T%Q#T#Z!:r#Z;'S%Q;'S;=`&s<%lO%QT!8i]&YSOY%QYZ%lZr%Qrs%qs!Q%Q!Q![!9b![!c%Q!c!i!9b!i#T%Q#T#Z!9b#Z;'S%Q;'S;=`&s<%lO%QT!9gc&YSOY%QYZ%lZr%Qrs%qs!Q%Q!Q![!9b![!c%Q!c!i!9b!i!r%Q!r!sKQ!s#R%Q#R#S!8d#S#T%Q#T#Z!9b#Z#d%Q#d#eKQ#e;'S%Q;'S;=`&s<%lO%QT!:yi&YS_POY%QYZ%lZr%Qrs%qs!O%Q!O!P!<h!P!Q%Q!Q![!:r![!c%Q!c!i!:r!i!n%Q!n!o!2U!o!r%Q!r!sKQ!s#R%Q#R#S!=r#S#T%Q#T#Z!:r#Z#`%Q#`#a!2U#a#d%Q#d#eKQ#e;'S%Q;'S;=`&s<%lO%QT!<ma&YSOY%QYZ%lZr%Qrs%qs!Q%Q!Q![!9b![!c%Q!c!i!9b!i!r%Q!r!sKQ!s#T%Q#T#Z!9b#Z#d%Q#d#eKQ#e;'S%Q;'S;=`&s<%lO%QT!=w]&YSOY%QYZ%lZr%Qrs%qs!Q%Q!Q![!:r![!c%Q!c!i!:r!i#T%Q#T#Z!:r#Z;'S%Q;'S;=`&s<%lO%QV!>wX#pR&YSOY%QYZ%lZr%Qrs%qs![%Q![!]!?d!];'S%Q;'S;=`&s<%lO%QV!?kV&vR&YSOY%QYZ%lZr%Qrs%qs;'S%Q;'S;=`&s<%lO%QV!@XV!PR&YSOY%QYZ%lZr%Qrs%qs;'S%Q;'S;=`&s<%lO%Q_!@uY&_Z&YSOY%QYZ%lZr%Qrs%qs!^%Q!^!_!Ae!_!`+p!`;'S%Q;'S;=`&s<%lO%QU!AlX#iQ&YSOY%QYZ%lZr%Qrs%qs!_%Q!_!`6n!`;'S%Q;'S;=`&s<%lO%QV!B`X!bR&YSOY%QYZ%lZr%Qrs%qs!_%Q!_!`+p!`;'S%Q;'S;=`&s<%lO%QV!CSY&^R&YSOY%QYZ%lZr%Qrs%qs!_%Q!_!`+p!`!a!Cr!a;'S%Q;'S;=`&s<%lO%QU!CyY#iQ&YSOY%QYZ%lZr%Qrs%qs!_%Q!_!`6n!`!a!Ae!a;'S%Q;'S;=`&s<%lO%Q_!DrV&bX#oQ&YSOY%QYZ%lZr%Qrs%qs;'S%Q;'S;=`&s<%lO%Q_!E`X%}Z&YSOY%QYZ%lZr%Qrs%qs#]%Q#]#^!E{#^;'S%Q;'S;=`&s<%lO%QV!FQX&YSOY%QYZ%lZr%Qrs%qs#b%Q#b#c!Fm#c;'S%Q;'S;=`&s<%lO%QV!FrX&YSOY%QYZ%lZr%Qrs%qs#h%Q#h#i!G_#i;'S%Q;'S;=`&s<%lO%QV!GdX&YSOY%QYZ%lZr%Qrs%qs#X%Q#X#Y!HP#Y;'S%Q;'S;=`&s<%lO%QV!HUX&YSOY%QYZ%lZr%Qrs%qs#f%Q#f#g!Hq#g;'S%Q;'S;=`&s<%lO%QV!HvX&YSOY%QYZ%lZr%Qrs%qs#Y%Q#Y#Z!Ic#Z;'S%Q;'S;=`&s<%lO%QV!IhX&YSOY%QYZ%lZr%Qrs%qs#T%Q#T#U!JT#U;'S%Q;'S;=`&s<%lO%QV!JYX&YSOY%QYZ%lZr%Qrs%qs#V%Q#V#W!Ju#W;'S%Q;'S;=`&s<%lO%QV!JzX&YSOY%QYZ%lZr%Qrs%qs#X%Q#X#Y!Kg#Y;'S%Q;'S;=`&s<%lO%QV!KnV&tR&YSOY%QYZ%lZr%Qrs%qs;'S%Q;'S;=`&s<%lO%Q_!L[b&RZ&YSOY%QYZ%lZr%Qrs%qst%Qtu!LTu!Q%Q!Q![!LT![!c%Q!c!}!LT!}#R%Q#R#S!LT#S#T%Q#T#o!LT#o$g%Q$g;'S!LT;'S;=`!Md<%lO!LT_!MgP;=`<%l!LT_!MqVuZ&YSOY%QYZ%lZr%Qrs%qs;'S%Q;'S;=`&s<%lO%QV!N_VsR&YSOY%QYZ%lZr%Qrs%qs;'S%Q;'S;=`&s<%lO%QU!N{X#eQ&YSOY%QYZ%lZr%Qrs%qs!_%Q!_!`6n!`;'S%Q;'S;=`&s<%lO%QV# oV}R&YSOY%QYZ%lZr%Qrs%qs;'S%Q;'S;=`&s<%lO%Q_#!_Z'OX#dQ&YSOY%QYZ%lZr%Qrs%qs!_%Q!_!`6n!`#p%Q#p#q##Q#q;'S%Q;'S;=`&s<%lO%QU##XV#bQ&YSOY%QYZ%lZr%Qrs%qs;'S%Q;'S;=`&s<%lO%QV##uV|R&YSOY%QYZ%lZr%Qrs%qs;'S%Q;'S;=`&s<%lO%QT#$cV#uP&YSOY%QYZ%lZr%Qrs%qs;'S%Q;'S;=`&s<%lO%Q_#%Ru&YS%yZ&PZOX%QXY'fYZ)bZ^'f^p%Qpq'fqr%Qrs%qst%Qtu4eu!Q%Q!Q![4e![!c%Q!c!}4e!}#R%Q#R#S4e#S#T%Q#T#o4e#o#y%Q#y#z'f#z$f%Q$f$g'f$g#BY4e#BY#BZ#$x#BZ$IS4e$IS$I_#$x$I_$I|4e$I|$JO#$x$JO$JT4e$JT$JU#$x$JU$KV4e$KV$KW#$x$KW&FU4e&FU&FV#$x&FV;'S4e;'S;=`5t<%lO4e",tokenizers:[0,1,2,3],topRules:{Program:[0,3],ClassContent:[1,194]},dynamicPrecedences:{27:1,232:-1,243:-1},specialized:[{term:231,get:t=>oR[t]||-1}],tokenPrec:7144}),cR=Jr.define({name:"java",parser:lR.configure({props:[bl.add({IfStatement:Vr({except:/^\s*({|else\b)/}),TryStatement:Vr({except:/^\s*({|catch|finally)\b/}),LabeledStatement:NO,SwitchBlock:t=>{let e=t.textAfter,i=/^\s*\}/.test(e),s=/^\s*(case|default)\b/.test(e);return t.baseIndent+(i?0:s?1:2)*t.unit},Block:Hn({closing:"}"}),BlockComment:()=>null,Statement:Vr({except:/^{/})}),wl.add({"Block SwitchBlock ClassBody ElementValueArrayInitializer ModuleBody EnumBody ConstructorBody InterfaceBody ArrayInitializer":Md,BlockComment(t){return{from:t.from+2,to:t.to-2}}})]}),languageData:{commentTokens:{line:"//",block:{open:"/*",close:"*/"}},indentOnInput:/^\s*(?:case |default:|\{|\})$/}});function hR(){return new Ad(cR)}const Gf=new an,Yf=new an,Zy=Ie.define(),Xh=Ie.define(),dR=Mt.define({create(){return fe.none},update(t,e){for(const i of e.effects){if(i.is(Xh))return fe.none;if(i.is(Zy)){const s=e.state.doc.line(i.value),r=fe.line({class:"cm-errorLine"}).range(s.from);return fe.set([r])}}return t.map(e.changes)},provide:t=>te.decorations.from(t)}),uR=te.baseTheme({".cm-errorLine":{backgroundColor:"rgba(239, 68, 68, 0.2) !important",borderLeft:"3px solid #ef4444"}});class pR extends gi{constructor(e,i={}){super(),this.annotation=e,this.variables=i}toDOM(){const e=document.createElement("span");if(e.className="cm-variable-annotation",this.variables&&Object.keys(this.variables).length>0){let i=!0;Object.entries(this.variables).forEach(([s,r])=>{if(s==="__swap__"||s==="__branch__"){if(!i){const c=document.createElement("span");c.className="cm-var-sep",c.textContent=" ",e.appendChild(c)}const l=document.createElement("span");l.className=s==="__swap__"?"cm-swap-indicator":"cm-branch-indicator",l.textContent=String(r),e.appendChild(l),i=!1;return}if(!i){const l=document.createElement("span");l.className="cm-var-sep",l.textContent=", ",e.appendChild(l)}const n=document.createElement("span");n.className="cm-var-name",n.textContent=s;const a=document.createElement("span");a.className="cm-var-equals",a.textContent="=";const o=document.createElement("span");o.className="cm-var-value",o.textContent=String(r),e.appendChild(n),e.appendChild(a),e.appendChild(o),i=!1})}else e.textContent=this.annotation;return e}eq(e){return this.annotation===e.annotation}}class fR extends gi{constructor(e,i,s,r="compare",n=">"){super(),this.left=e,this.right=i,this.result=s,this.mode=r,this.operator=n}toDOM(){const e=document.createElement("span");e.className="cm-comparison-wrapper";const i=document.createElement("span");if(this.mode==="swap")i.className="cm-comparison-badge cm-swap-badge",i.innerHTML=`<span class="cm-comparison-icon">â†”</span> ${this.left} âŸ· ${this.right}`;else if(this.mode==="shift")i.className="cm-comparison-badge cm-shift-badge",i.innerHTML=`<span class="cm-comparison-icon">â†’</span> ${this.left} â†’ (key: ${this.right})`;else if(this.mode==="divide")i.className="cm-comparison-badge cm-divide-badge",i.innerHTML=`<span class="cm-comparison-icon">â†˜â†™</span> DIVIDE [${this.left}..${this.right}]`;else if(this.mode==="conquer")i.className="cm-comparison-badge cm-conquer-badge",i.innerHTML=`<span class="cm-comparison-icon">â¬†</span> CONQUER [${this.left}..${this.right}]`;else if(this.mode==="partition")i.className="cm-comparison-badge cm-partition-badge",i.innerHTML=`<span class="cm-comparison-icon">âš¡</span> PARTITION [${this.left}..${this.right}]`;else if(this.mode==="base")i.className="cm-comparison-badge cm-base-badge",i.innerHTML=`<span class="cm-comparison-icon">âœ“</span> BASE CASE [${this.left}..${this.right}]`;else{i.className=`cm-comparison-badge ${this.result?"cm-comparison-true":"cm-comparison-false"}`;const s=this.result?"âœ“":"âœ—";i.innerHTML=`<span class="cm-comparison-icon">${s}</span> ${this.left} ${this.operator} ${this.right}`}return e.appendChild(i),e}eq(e){return this.left===e.left&&this.right===e.right&&this.result===e.result&&this.mode===e.mode&&this.operator===e.operator}}const Hy=Ie.define(),Gh=Ie.define(),gR=Mt.define({create(){return fe.none},update(t,e){for(const i of e.effects){if(i.is(Gh))return fe.none;if(i.is(Hy)){const{lineNumber:s,variables:r,comparison:n,badgeMode:a}=i.value,o=[];if(s<1||s>e.state.doc.lines)return t;const l=e.state.doc.line(s);if(n&&o.push(fe.widget({widget:new fR(n.left,n.right,n.result,a||"compare",n.operator||">"),side:0}).range(l.to)),r&&Object.keys(r).length>0){const c={};Object.entries(r).forEach(([h,d])=>{const u=h==="__swap__"||h==="__branch__";d!=null&&h!=="type"&&h!=="description"&&(!h.startsWith("__")||u)&&(c[h]=d)}),Object.keys(c).length>0&&o.push(fe.widget({widget:new pR("",c),side:1}).range(l.to))}return fe.set(o,!0)}}return t.map(e.changes)},provide:t=>te.decorations.from(t)}),Zf=te.baseTheme({".cm-variable-annotation":{position:"absolute",right:"8px",top:"50%",transform:"translateY(-50%)",display:"inline-flex",alignItems:"center",gap:"0.5rem",padding:"3px 12px",borderRadius:"20px",maxWidth:"50%",overflow:"hidden",textOverflow:"ellipsis",background:"linear-gradient(135deg, rgba(139, 92, 246, 0.15), rgba(59, 130, 246, 0.1))",backdropFilter:"blur(8px)",border:"1px solid rgba(139, 92, 246, 0.3)",color:"#c4b5fd",fontFamily:"'JetBrains Mono', 'Fira Code', monospace",fontSize:"0.78em",fontWeight:"500",letterSpacing:"0.03em",boxShadow:"0 2px 8px rgba(139, 92, 246, 0.15), inset 0 1px 0 rgba(255,255,255,0.05)",pointerEvents:"none",whiteSpace:"nowrap",zIndex:"10"},".cm-comparison-wrapper":{display:"inline-flex",alignItems:"center",position:"relative",marginLeft:"1rem",marginRight:"0.5rem",verticalAlign:"middle",zIndex:"20"},".cm-comparison-badge":{display:"inline-flex",alignItems:"center",gap:"0.35rem",padding:"4px 12px",borderRadius:"6px",fontSize:"0.85em",fontWeight:"600",fontFamily:"'JetBrains Mono', monospace",letterSpacing:"0.02em",boxShadow:"0 4px 12px rgba(0,0,0,0.25), 0 1px 3px rgba(0,0,0,0.15)",transition:"all 0.2s cubic-bezier(0.4, 0, 0.2, 1)"},".cm-comparison-true":{background:"linear-gradient(135deg, #059669 0%, #047857 100%)",color:"#ffffff",border:"1px solid #34d399",boxShadow:"0 4px 12px rgba(16, 185, 129, 0.35), 0 0 20px rgba(16, 185, 129, 0.15)"},".cm-comparison-false":{background:"linear-gradient(135deg, #dc2626 0%, #b91c1c 100%)",color:"#ffffff",border:"1px solid #f87171",boxShadow:"0 4px 12px rgba(239, 68, 68, 0.35), 0 0 20px rgba(239, 68, 68, 0.15)"},".cm-comparison-icon":{fontSize:"1em",fontWeight:"800",textShadow:"0 1px 2px rgba(0,0,0,0.3)"},".cm-swap-badge":{background:"linear-gradient(135deg, #7c3aed 0%, #6366f1 100%)",color:"#ffffff",border:"1px solid #a78bfa",boxShadow:"0 4px 12px rgba(124, 58, 237, 0.35), 0 0 20px rgba(124, 58, 237, 0.15)"},".cm-shift-badge":{background:"linear-gradient(135deg, #f59e0b 0%, #d97706 100%)",color:"#ffffff",border:"1px solid #fbbf24",boxShadow:"0 4px 12px rgba(245, 158, 11, 0.35), 0 0 20px rgba(245, 158, 11, 0.15)"},".cm-divide-badge":{background:"linear-gradient(135deg, #f59e0b 0%, #ea580c 100%)",color:"#ffffff",border:"1px solid #fb923c",boxShadow:"0 4px 15px rgba(245, 158, 11, 0.45), 0 0 25px rgba(234, 88, 12, 0.2)",fontWeight:"700",letterSpacing:"0.05em"},".cm-conquer-badge":{background:"linear-gradient(135deg, #14b8a6 0%, #0891b2 100%)",color:"#ffffff",border:"1px solid #5eead4",boxShadow:"0 4px 15px rgba(20, 184, 166, 0.45), 0 0 25px rgba(8, 145, 178, 0.2)",fontWeight:"700",letterSpacing:"0.05em"},".cm-partition-badge":{background:"linear-gradient(135deg, #a855f7 0%, #7c3aed 100%)",color:"#ffffff",border:"1px solid #c4b5fd",boxShadow:"0 4px 15px rgba(168, 85, 247, 0.45), 0 0 25px rgba(124, 58, 237, 0.2)",fontWeight:"700",letterSpacing:"0.05em"},".cm-base-badge":{background:"linear-gradient(135deg, #22c55e 0%, #16a34a 100%)",color:"#ffffff",border:"1px solid #86efac",boxShadow:"0 4px 15px rgba(34, 197, 94, 0.45), 0 0 25px rgba(22, 163, 74, 0.2)",fontWeight:"700",letterSpacing:"0.05em"},".cm-var-name":{color:"#67e8f9",fontWeight:"600"},".cm-var-equals":{color:"rgba(255, 255, 255, 0.5)",margin:"0 1px"},".cm-var-value":{color:"#fbbf24",fontWeight:"700"},".cm-var-sep":{color:"rgba(255, 255, 255, 0.4)"},".cm-swap-indicator":{background:"linear-gradient(135deg, rgba(99, 102, 241, 0.3), rgba(168, 85, 247, 0.3))",color:"#c4b5fd",padding:"2px 8px",borderRadius:"10px",marginLeft:"8px",fontWeight:"600",fontSize:"0.9em",border:"1px solid rgba(168, 85, 247, 0.4)"},".cm-branch-indicator":{color:"#94a3b8",fontStyle:"italic",marginLeft:"8px"},".cm-line":{position:"relative"}}),mR=te.theme({".cm-variable-annotation":{position:"absolute",right:"8px",top:"50%",transform:"translateY(-50%)",display:"inline-flex",alignItems:"center",gap:"0.5rem",padding:"3px 12px",borderRadius:"20px",maxWidth:"50%",overflow:"hidden",textOverflow:"ellipsis",background:"rgba(255, 255, 255, 0.7)",backdropFilter:"blur(8px)",border:"1px solid #cbd5e1",color:"#475569",fontFamily:"'JetBrains Mono', 'Fira Code', monospace",fontSize:"0.78em",fontWeight:"600",letterSpacing:"0.03em",boxShadow:"0 2px 8px rgba(0,0,0,0.05)",pointerEvents:"none",whiteSpace:"nowrap",zIndex:"10"},".cm-comparison-wrapper":{display:"inline-flex",alignItems:"center",position:"relative",marginLeft:"1rem",marginRight:"0.5rem",verticalAlign:"middle",zIndex:"20"},".cm-comparison-badge":{display:"inline-flex",alignItems:"center",gap:"0.35rem",padding:"4px 12px",borderRadius:"6px",fontSize:"0.85em",fontWeight:"700",fontFamily:"'JetBrains Mono', monospace",letterSpacing:"0.02em",boxShadow:"0 2px 6px rgba(0,0,0,0.1)",transition:"all 0.2s ease"},".cm-comparison-true":{background:"#ecfdf5",color:"#059669",border:"1px solid #6ee7b7"},".cm-comparison-false":{background:"#fef2f2",color:"#dc2626",border:"1px solid #fca5a5"},".cm-comparison-icon":{fontSize:"1em",fontWeight:"800"},".cm-swap-badge":{background:"#f5f3ff",color:"#7c3aed",border:"1px solid #c4b5fd"},".cm-shift-badge":{background:"#fffbeb",color:"#d97706",border:"1px solid #fcd34d"},".cm-divide-badge":{background:"#fff7ed",color:"#ea580c",border:"1px solid #fb923c"},".cm-conquer-badge":{background:"#f0f9ff",color:"#0284c7",border:"1px solid #7dd3fc"},".cm-partition-badge":{background:"#faf5ff",color:"#9333ea",border:"1px solid #d8b4fe"},".cm-base-badge":{background:"#f0fdf4",color:"#16a34a",border:"1px solid #86efac"},".cm-var-name":{color:"#0369a1",fontWeight:"700"},".cm-var-equals":{color:"#94a3b8",margin:"0 1px"},".cm-var-value":{color:"#b45309",fontWeight:"700"},".cm-var-sep":{color:"#cbd5e1"},".cm-swap-indicator":{background:"#f3e8ff",color:"#7e22ce",padding:"2px 8px",borderRadius:"10px",marginLeft:"8px",fontWeight:"600",fontSize:"0.9em",border:"1px solid #d8b4fe"},".cm-branch-indicator":{color:"#64748b",fontStyle:"italic",marginLeft:"8px"},".cm-line":{position:"relative"}}),fo={js:Df(),javascript:Df(),python:nR(),java:hR()},Hf=Pa.define([{tag:$.keyword,color:"#c792ea"},{tag:$.operator,color:"#89ddff"},{tag:$.variableName,color:"#f07178"},{tag:$.function($.variableName),color:"#82aaff"},{tag:$.string,color:"#c3e88d"},{tag:$.number,color:"#f78c6c"},{tag:$.comment,color:"#676e95",fontStyle:"italic"},{tag:$.className,color:"#ffcb6b"},{tag:$.definition($.variableName),color:"#82aaff"},{tag:$.propertyName,color:"#f07178"}]),OR=Pa.define([{tag:$.keyword,color:"#6d28d9",fontWeight:"bold"},{tag:$.operator,color:"#0f172a"},{tag:$.variableName,color:"#1e293b"},{tag:$.function($.variableName),color:"#0369a1"},{tag:$.string,color:"#047857"},{tag:$.number,color:"#b45309"},{tag:$.comment,color:"#64748b",fontStyle:"italic"},{tag:$.className,color:"#be185d"},{tag:$.definition($.variableName),color:"#0369a1"},{tag:$.propertyName,color:"#1e293b"}]),Kf=te.theme({"&":{backgroundColor:"#1a1a2e",color:"#e4e4e4",fontSize:"12px",fontFamily:"'JetBrains Mono', 'Fira Code', 'Consolas', monospace",height:"100%"},"&.cm-editor":{height:"100%"},".cm-content":{caretColor:"#10b981",padding:"12px 0"},".cm-cursor":{borderLeftColor:"#10b981",borderLeftWidth:"2px"},".cm-activeLine":{backgroundColor:"rgba(16, 185, 129, 0.1)"},".cm-activeLineGutter":{backgroundColor:"rgba(16, 185, 129, 0.15)",color:"#10b981"},".cm-gutters":{backgroundColor:"#16162a",color:"#4a5568",border:"none",borderRight:"1px solid rgba(255, 255, 255, 0.1)"},".cm-lineNumbers .cm-gutterElement":{padding:"0 12px",minWidth:"40px"},".cm-selectionBackground":{backgroundColor:"rgba(16, 185, 129, 0.3) !important"},"&.cm-focused .cm-selectionBackground":{backgroundColor:"rgba(16, 185, 129, 0.3) !important"},".cm-matchingBracket":{backgroundColor:"rgba(16, 185, 129, 0.4)",outline:"1px solid #10b981"},".cm-foldGutter":{width:"12px"},".cm-scroller":{overflow:"auto",height:"100%"}},{dark:!0}),yR=te.theme({"&":{backgroundColor:"#ffffff",color:"#334155",fontSize:"12px",fontFamily:"'JetBrains Mono', 'Fira Code', 'Consolas', monospace",height:"100%"},"&.cm-editor":{height:"100%"},".cm-content":{caretColor:"#2563eb",padding:"12px 0"},".cm-cursor":{borderLeftColor:"#2563eb",borderLeftWidth:"2px"},".cm-activeLine":{backgroundColor:"rgba(37, 99, 235, 0.05)"},".cm-activeLineGutter":{backgroundColor:"#f1f5f9",color:"#2563eb",fontWeight:"bold"},".cm-gutters":{backgroundColor:"#ffffff",color:"#94a3b8",border:"none",borderRight:"1px solid #f1f5f9"},".cm-lineNumbers .cm-gutterElement":{padding:"0 12px",minWidth:"40px"},".cm-selectionBackground":{backgroundColor:"rgba(37, 99, 235, 0.15) !important"},"&.cm-focused .cm-selectionBackground":{backgroundColor:"rgba(37, 99, 235, 0.15) !important"},".cm-matchingBracket":{backgroundColor:"rgba(37, 99, 235, 0.2)",outline:"1px solid #2563eb",color:"#1e3a8a"},".cm-foldGutter":{width:"12px"},".cm-scroller":{overflow:"auto",height:"100%"}},{dark:!1});function vR(t,e={}){const{language:i="js",initialCode:s="",onChange:r=null,onCursorChange:n=null,readOnly:a=!1}=e,o=[gT(),yT(),Uk(),RE(),sE(),Qk(),qk(),Pe.allowMultipleSelections.of(!0),UT(),fE(),iT(),nT(),Zk(),Cd.of([...IP,...DE,...JT,QP]),Gf.of(fo[i]||fo.js),Yf.of([Kf,gf(Hf),Zf]),dR,uR,gR,Pe.tabSize.of(2)];a&&o.push(Pe.readOnly.of(!0)),r&&o.push(te.updateListener.of(h=>{h.docChanged&&r(h.state.doc.toString())})),n&&o.push(te.updateListener.of(h=>{if(h.selectionSet){const d=h.state.selection.main.head,u=h.state.doc.lineAt(d);n({line:u.number,column:d-u.from,position:d})}}));const l=Pe.create({doc:s,extensions:o}),c=new te({state:l,parent:t});return{view:c,getCode(){return c.state.doc.toString()},setCode(h){c.dispatch({changes:{from:0,to:c.state.doc.length,insert:h}})},setLanguage(h){const d=fo[h]||fo.js;c.dispatch({effects:Gf.reconfigure(d)})},setTheme(h){const d=h==="dark";c.dispatch({effects:Yf.reconfigure([d?Kf:yR,gf(d?Hf:OR),d?Zf:mR])})},highlightLine(h){const d=c.state.doc.lines;if(h<1||h>d){console.debug(`[Editor] Line ${h} out of bounds (doc has ${d} lines)`);return}const u=c.state.doc.line(h);c.dispatch({selection:{anchor:u.from},scrollIntoView:!0})},getCurrentLine(){const h=c.state.selection.main.head;return c.state.doc.lineAt(h).number},focus(){c.focus()},destroy(){c.destroy()},showError(h){c.dispatch({effects:Xh.of(null)});const d=c.state.doc.lines;if(h<1||h>d){console.debug(`[Editor] Error line ${h} out of bounds (doc has ${d} lines)`);return}c.dispatch({effects:Zy.of(h),scrollIntoView:!0}),console.log(`[Editor] Showing error on line ${h}`)},clearError(){c.dispatch({effects:Xh.of(null)})},setAnnotation(h,d,u=null,p="compare"){console.log("%c[Editor.setAnnotation] CALLED!","background: #22c55e; color: white; font-size: 14px; font-weight: bold;"),console.log("[Editor.setAnnotation] lineNumber:",h,"variables:",d,"comparison:",u),c.dispatch({effects:Gh.of(null)});const f=c.state.doc.lines;if(h<1||h>f){console.debug(`[Editor] Annotation line ${h} out of bounds (doc has ${f} lines)`);return}c.dispatch({effects:Hy.of({lineNumber:h,variables:d,comparison:u,badgeMode:p})});const g=c.state.doc.line(h);c.dispatch({selection:{anchor:g.from},scrollIntoView:!0})},clearAnnotation(){c.dispatch({effects:Gh.of(null)})}}}var bR=[509,0,227,0,150,4,294,9,1368,2,2,1,6,3,41,2,5,0,166,1,574,3,9,9,7,9,32,4,318,1,80,3,71,10,50,3,123,2,54,14,32,10,3,1,11,3,46,10,8,0,46,9,7,2,37,13,2,9,6,1,45,0,13,2,49,13,9,3,2,11,83,11,7,0,3,0,158,11,6,9,7,3,56,1,2,6,3,1,3,2,10,0,11,1,3,6,4,4,68,8,2,0,3,0,2,3,2,4,2,0,15,1,83,17,10,9,5,0,82,19,13,9,214,6,3,8,28,1,83,16,16,9,82,12,9,9,7,19,58,14,5,9,243,14,166,9,71,5,2,1,3,3,2,0,2,1,13,9,120,6,3,6,4,0,29,9,41,6,2,3,9,0,10,10,47,15,343,9,54,7,2,7,17,9,57,21,2,13,123,5,4,0,2,1,2,6,2,0,9,9,49,4,2,1,2,4,9,9,330,3,10,1,2,0,49,6,4,4,14,10,5350,0,7,14,11465,27,2343,9,87,9,39,4,60,6,26,9,535,9,470,0,2,54,8,3,82,0,12,1,19628,1,4178,9,519,45,3,22,543,4,4,5,9,7,3,6,31,3,149,2,1418,49,513,54,5,49,9,0,15,0,23,4,2,14,1361,6,2,16,3,6,2,1,2,4,101,0,161,6,10,9,357,0,62,13,499,13,245,1,2,9,726,6,110,6,6,9,4759,9,787719,239],Ky=[0,11,2,25,2,18,2,1,2,14,3,13,35,122,70,52,268,28,4,48,48,31,14,29,6,37,11,29,3,35,5,7,2,4,43,157,19,35,5,35,5,39,9,51,13,10,2,14,2,6,2,1,2,10,2,14,2,6,2,1,4,51,13,310,10,21,11,7,25,5,2,41,2,8,70,5,3,0,2,43,2,1,4,0,3,22,11,22,10,30,66,18,2,1,11,21,11,25,71,55,7,1,65,0,16,3,2,2,2,28,43,28,4,28,36,7,2,27,28,53,11,21,11,18,14,17,111,72,56,50,14,50,14,35,39,27,10,22,251,41,7,1,17,2,60,28,11,0,9,21,43,17,47,20,28,22,13,52,58,1,3,0,14,44,33,24,27,35,30,0,3,0,9,34,4,0,13,47,15,3,22,0,2,0,36,17,2,24,20,1,64,6,2,0,2,3,2,14,2,9,8,46,39,7,3,1,3,21,2,6,2,1,2,4,4,0,19,0,13,4,31,9,2,0,3,0,2,37,2,0,26,0,2,0,45,52,19,3,21,2,31,47,21,1,2,0,185,46,42,3,37,47,21,0,60,42,14,0,72,26,38,6,186,43,117,63,32,7,3,0,3,7,2,1,2,23,16,0,2,0,95,7,3,38,17,0,2,0,29,0,11,39,8,0,22,0,12,45,20,0,19,72,200,32,32,8,2,36,18,0,50,29,113,6,2,1,2,37,22,0,26,5,2,1,2,31,15,0,328,18,16,0,2,12,2,33,125,0,80,921,103,110,18,195,2637,96,16,1071,18,5,26,3994,6,582,6842,29,1763,568,8,30,18,78,18,29,19,47,17,3,32,20,6,18,433,44,212,63,129,74,6,0,67,12,65,1,2,0,29,6135,9,1237,42,9,8936,3,2,6,2,1,2,290,16,0,30,2,3,0,15,3,9,395,2309,106,6,12,4,8,8,9,5991,84,2,70,2,1,3,0,3,1,3,3,2,11,2,0,2,6,2,64,2,3,3,7,2,6,2,27,2,3,2,4,2,0,4,6,2,339,3,24,2,24,2,30,2,24,2,30,2,24,2,30,2,24,2,30,2,24,2,7,1845,30,7,5,262,61,147,44,11,6,17,0,322,29,19,43,485,27,229,29,3,0,496,6,2,3,2,1,2,14,2,196,60,67,8,0,1205,3,2,26,2,1,2,0,3,0,2,9,2,3,2,0,2,0,7,0,5,0,2,0,2,0,2,2,2,1,2,0,3,0,2,0,2,0,2,0,2,0,2,1,2,0,3,3,2,6,2,3,2,3,2,0,2,9,2,16,6,2,2,4,2,16,4421,42719,33,4153,7,221,3,5761,15,7472,16,621,2467,541,1507,4938,6,4191],wR="â€Œâ€Â·Ì€-Í¯Î‡Òƒ-Ò‡Ö‘-Ö½Ö¿××‚×„×…×‡Ø-ØšÙ‹-Ù©Ù°Û–-ÛœÛŸ-Û¤Û§Û¨Ûª-Û­Û°-Û¹Ü‘Ü°-ÝŠÞ¦-Þ°ß€-ß‰ß«-ß³ß½à –-à ™à ›-à £à ¥-à §à ©-à ­à¡™-à¡›à¢—-à¢Ÿà£Š-à£¡à££-à¤ƒà¤º-à¤¼à¤¾-à¥à¥‘-à¥—à¥¢à¥£à¥¦-à¥¯à¦-à¦ƒà¦¼à¦¾-à§„à§‡à§ˆà§‹-à§à§—à§¢à§£à§¦-à§¯à§¾à¨-à¨ƒà¨¼à¨¾-à©‚à©‡à©ˆà©‹-à©à©‘à©¦-à©±à©µàª-àªƒàª¼àª¾-à«…à«‡-à«‰à«‹-à«à«¢à«£à«¦-à«¯à«º-à«¿à¬-à¬ƒà¬¼à¬¾-à­„à­‡à­ˆà­‹-à­à­•-à­—à­¢à­£à­¦-à­¯à®‚à®¾-à¯‚à¯†-à¯ˆà¯Š-à¯à¯—à¯¦-à¯¯à°€-à°„à°¼à°¾-à±„à±†-à±ˆà±Š-à±à±•à±–à±¢à±£à±¦-à±¯à²-à²ƒà²¼à²¾-à³„à³†-à³ˆà³Š-à³à³•à³–à³¢à³£à³¦-à³¯à³³à´€-à´ƒà´»à´¼à´¾-àµ„àµ†-àµˆàµŠ-àµàµ—àµ¢àµ£àµ¦-àµ¯à¶-à¶ƒà·Šà·-à·”à·–à·˜-à·Ÿà·¦-à·¯à·²à·³à¸±à¸´-à¸ºà¹‡-à¹Žà¹-à¹™àº±àº´-àº¼à»ˆ-à»Žà»-à»™à¼˜à¼™à¼ -à¼©à¼µà¼·à¼¹à¼¾à¼¿à½±-à¾„à¾†à¾‡à¾-à¾—à¾™-à¾¼à¿†á€«-á€¾á€-á‰á–-á™áž-á á¢-á¤á§-á­á±-á´á‚‚-á‚á‚-á‚á-áŸá©-á±áœ’-áœ•áœ²-áœ´á’á“á²á³áž´-áŸ“áŸáŸ -áŸ©á ‹-á á -á ™á¢©á¤ -á¤«á¤°-á¤»á¥†-á¥á§-á§šá¨—-á¨›á©•-á©žá© -á©¼á©¿-áª‰áª-áª™áª°-áª½áª¿-á«Žá¬€-á¬„á¬´-á­„á­-á­™á­«-á­³á®€-á®‚á®¡-á®­á®°-á®¹á¯¦-á¯³á°¤-á°·á±€-á±‰á±-á±™á³-á³’á³”-á³¨á³­á³´á³·-á³¹á·€-á·¿â€Œâ€â€¿â€â”âƒ-âƒœâƒ¡âƒ¥-âƒ°â³¯-â³±âµ¿â· -â·¿ã€ª-ã€¯ã‚™ã‚šãƒ»ê˜ -ê˜©ê™¯ê™´-ê™½êšžêšŸê›°ê›±ê ‚ê †ê ‹ê £-ê §ê ¬ê¢€ê¢ê¢´-ê£…ê£-ê£™ê£ -ê£±ê£¿-ê¤‰ê¤¦-ê¤­ê¥‡-ê¥“ê¦€-ê¦ƒê¦³-ê§€ê§-ê§™ê§¥ê§°-ê§¹ê¨©-ê¨¶ê©ƒê©Œê©ê©-ê©™ê©»-ê©½êª°êª²-êª´êª·êª¸êª¾êª¿ê«ê««-ê«¯ê«µê«¶ê¯£-ê¯ªê¯¬ê¯­ê¯°-ê¯¹ï¬žï¸€-ï¸ï¸ -ï¸¯ï¸³ï¸´ï¹-ï¹ï¼-ï¼™ï¼¿ï½¥",Jy="ÂªÂµÂºÃ€-Ã–Ã˜-Ã¶Ã¸-ËË†-Ë‘Ë -Ë¤Ë¬Ë®Í°-Í´Í¶Í·Íº-Í½Í¿Î†Îˆ-ÎŠÎŒÎŽ-Î¡Î£-ÏµÏ·-ÒÒŠ-Ô¯Ô±-Õ–Õ™Õ -Öˆ×-×ª×¯-×²Ø -ÙŠÙ®Ù¯Ù±-Û“Û•Û¥Û¦Û®Û¯Ûº-Û¼Û¿ÜÜ’-Ü¯Ý-Þ¥Þ±ßŠ-ßªß´ßµßºà €-à •à šà ¤à ¨à¡€-à¡˜à¡ -à¡ªà¡°-à¢‡à¢‰-à¢Žà¢ -à£‰à¤„-à¤¹à¤½à¥à¥˜-à¥¡à¥±-à¦€à¦…-à¦Œà¦à¦à¦“-à¦¨à¦ª-à¦°à¦²à¦¶-à¦¹à¦½à§Žà§œà§à§Ÿ-à§¡à§°à§±à§¼à¨…-à¨Šà¨à¨à¨“-à¨¨à¨ª-à¨°à¨²à¨³à¨µà¨¶à¨¸à¨¹à©™-à©œà©žà©²-à©´àª…-àªàª-àª‘àª“-àª¨àªª-àª°àª²àª³àªµ-àª¹àª½à«à« à«¡à«¹à¬…-à¬Œà¬à¬à¬“-à¬¨à¬ª-à¬°à¬²à¬³à¬µ-à¬¹à¬½à­œà­à­Ÿ-à­¡à­±à®ƒà®…-à®Šà®Ž-à®à®’-à®•à®™à®šà®œà®žà®Ÿà®£à®¤à®¨-à®ªà®®-à®¹à¯à°…-à°Œà°Ž-à°à°’-à°¨à°ª-à°¹à°½à±˜-à±šà±à± à±¡à²€à²…-à²Œà²Ž-à²à²’-à²¨à²ª-à²³à²µ-à²¹à²½à³à³žà³ à³¡à³±à³²à´„-à´Œà´Ž-à´à´’-à´ºà´½àµŽàµ”-àµ–àµŸ-àµ¡àµº-àµ¿à¶…-à¶–à¶š-à¶±à¶³-à¶»à¶½à·€-à·†à¸-à¸°à¸²à¸³à¹€-à¹†àºàº‚àº„àº†-àºŠàºŒ-àº£àº¥àº§-àº°àº²àº³àº½à»€-à»„à»†à»œ-à»Ÿà¼€à½€-à½‡à½‰-à½¬à¾ˆ-à¾Œá€€-á€ªá€¿á-á•áš-áá¡á¥á¦á®-á°áµ-á‚á‚Žá‚ -áƒ…áƒ‡áƒáƒ-áƒºáƒ¼-á‰ˆá‰Š-á‰á‰-á‰–á‰˜á‰š-á‰á‰ -áŠˆáŠŠ-áŠáŠ-áŠ°áŠ²-áŠµáŠ¸-áŠ¾á‹€á‹‚-á‹…á‹ˆ-á‹–á‹˜-áŒáŒ’-áŒ•áŒ˜-ášáŽ€-áŽáŽ -áµá¸-á½á-á™¬á™¯-á™¿áš-áššáš -á›ªá›®-á›¸áœ€-áœ‘áœŸ-áœ±á€-á‘á -á¬á®-á°áž€-áž³áŸ—áŸœá  -á¡¸á¢€-á¢¨á¢ªá¢°-á£µá¤€-á¤žá¥-á¥­á¥°-á¥´á¦€-á¦«á¦°-á§‰á¨€-á¨–á¨ -á©”áª§á¬…-á¬³á­…-á­Œá®ƒ-á® á®®á®¯á®º-á¯¥á°€-á°£á±-á±á±š-á±½á²€-á²Šá²-á²ºá²½-á²¿á³©-á³¬á³®-á³³á³µá³¶á³ºá´€-á¶¿á¸€-á¼•á¼˜-á¼á¼ -á½…á½ˆ-á½á½-á½—á½™á½›á½á½Ÿ-á½½á¾€-á¾´á¾¶-á¾¼á¾¾á¿‚-á¿„á¿†-á¿Œá¿-á¿“á¿–-á¿›á¿ -á¿¬á¿²-á¿´á¿¶-á¿¼â±â¿â‚-â‚œâ„‚â„‡â„Š-â„“â„•â„˜-â„â„¤â„¦â„¨â„ª-â„¹â„¼-â„¿â……-â…‰â…Žâ… -â†ˆâ°€-â³¤â³«-â³®â³²â³³â´€-â´¥â´§â´­â´°-âµ§âµ¯â¶€-â¶–â¶ -â¶¦â¶¨-â¶®â¶°-â¶¶â¶¸-â¶¾â·€-â·†â·ˆ-â·Žâ·-â·–â·˜-â·žã€…-ã€‡ã€¡-ã€©ã€±-ã€µã€¸-ã€¼ã-ã‚–ã‚›-ã‚Ÿã‚¡-ãƒºãƒ¼-ãƒ¿ã„…-ã„¯ã„±-ã†Žã† -ã†¿ã‡°-ã‡¿ã€-ä¶¿ä¸€-ê’Œê“-ê“½ê”€-ê˜Œê˜-ê˜Ÿê˜ªê˜«ê™€-ê™®ê™¿-êšêš -ê›¯êœ—-êœŸêœ¢-êžˆêž‹-êŸêŸêŸ‘êŸ“êŸ•-êŸœêŸ²-ê ê ƒ-ê …ê ‡-ê Šê Œ-ê ¢ê¡€-ê¡³ê¢‚-ê¢³ê£²-ê£·ê£»ê£½ê£¾ê¤Š-ê¤¥ê¤°-ê¥†ê¥ -ê¥¼ê¦„-ê¦²ê§ê§ -ê§¤ê§¦-ê§¯ê§º-ê§¾ê¨€-ê¨¨ê©€-ê©‚ê©„-ê©‹ê© -ê©¶ê©ºê©¾-êª¯êª±êªµêª¶êª¹-êª½ê«€ê«‚ê«›-ê«ê« -ê«ªê«²-ê«´ê¬-ê¬†ê¬‰-ê¬Žê¬‘-ê¬–ê¬ -ê¬¦ê¬¨-ê¬®ê¬°-ê­šê­œ-ê­©ê­°-ê¯¢ê°€-íž£íž°-íŸ†íŸ‹-íŸ»ï¤€-ï©­ï©°-ï«™ï¬€-ï¬†ï¬“-ï¬—ï¬ï¬Ÿ-ï¬¨ï¬ª-ï¬¶ï¬¸-ï¬¼ï¬¾ï­€ï­ï­ƒï­„ï­†-ï®±ï¯“-ï´½ïµ-ï¶ï¶’-ï·‡ï·°-ï·»ï¹°-ï¹´ï¹¶-ï»¼ï¼¡-ï¼ºï½-ï½šï½¦-ï¾¾ï¿‚-ï¿‡ï¿Š-ï¿ï¿’-ï¿—ï¿š-ï¿œ",Lc={3:"abstract boolean byte char class double enum export extends final float goto implements import int interface long native package private protected public short static super synchronized throws transient volatile",5:"class enum extends super const export import",6:"enum",strict:"implements interface let package private protected public static yield",strictBind:"eval arguments"},Nc="break case catch continue debugger default do else finally for function if return switch throw try var while with null true false instanceof typeof void delete new in this",SR={5:Nc,"5module":Nc+" export import",6:Nc+" const class extends export import super"},xR=/^in(stanceof)?$/,kR=new RegExp("["+Jy+"]"),TR=new RegExp("["+Jy+wR+"]");function Yh(t,e){for(var i=65536,s=0;s<e.length;s+=2){if(i+=e[s],i>t)return!1;if(i+=e[s+1],i>=t)return!0}return!1}function Ai(t,e){return t<65?t===36:t<91?!0:t<97?t===95:t<123?!0:t<=65535?t>=170&&kR.test(String.fromCharCode(t)):e===!1?!1:Yh(t,Ky)}function Cs(t,e){return t<48?t===36:t<58?!0:t<65?!1:t<91?!0:t<97?t===95:t<123?!0:t<=65535?t>=170&&TR.test(String.fromCharCode(t)):e===!1?!1:Yh(t,Ky)||Yh(t,bR)}var Re=function(e,i){i===void 0&&(i={}),this.label=e,this.keyword=i.keyword,this.beforeExpr=!!i.beforeExpr,this.startsExpr=!!i.startsExpr,this.isLoop=!!i.isLoop,this.isAssign=!!i.isAssign,this.prefix=!!i.prefix,this.postfix=!!i.postfix,this.binop=i.binop||null,this.updateContext=null};function Gt(t,e){return new Re(t,{beforeExpr:!0,binop:e})}var Yt={beforeExpr:!0},$t={startsExpr:!0},zd={};function Te(t,e){return e===void 0&&(e={}),e.keyword=t,zd[t]=new Re(t,e)}var S={num:new Re("num",$t),regexp:new Re("regexp",$t),string:new Re("string",$t),name:new Re("name",$t),privateId:new Re("privateId",$t),eof:new Re("eof"),bracketL:new Re("[",{beforeExpr:!0,startsExpr:!0}),bracketR:new Re("]"),braceL:new Re("{",{beforeExpr:!0,startsExpr:!0}),braceR:new Re("}"),parenL:new Re("(",{beforeExpr:!0,startsExpr:!0}),parenR:new Re(")"),comma:new Re(",",Yt),semi:new Re(";",Yt),colon:new Re(":",Yt),dot:new Re("."),question:new Re("?",Yt),questionDot:new Re("?."),arrow:new Re("=>",Yt),template:new Re("template"),invalidTemplate:new Re("invalidTemplate"),ellipsis:new Re("...",Yt),backQuote:new Re("`",$t),dollarBraceL:new Re("${",{beforeExpr:!0,startsExpr:!0}),eq:new Re("=",{beforeExpr:!0,isAssign:!0}),assign:new Re("_=",{beforeExpr:!0,isAssign:!0}),incDec:new Re("++/--",{prefix:!0,postfix:!0,startsExpr:!0}),prefix:new Re("!/~",{beforeExpr:!0,prefix:!0,startsExpr:!0}),logicalOR:Gt("||",1),logicalAND:Gt("&&",2),bitwiseOR:Gt("|",3),bitwiseXOR:Gt("^",4),bitwiseAND:Gt("&",5),equality:Gt("==/!=/===/!==",6),relational:Gt("</>/<=/>=",7),bitShift:Gt("<</>>/>>>",8),plusMin:new Re("+/-",{beforeExpr:!0,binop:9,prefix:!0,startsExpr:!0}),modulo:Gt("%",10),star:Gt("*",10),slash:Gt("/",10),starstar:new Re("**",{beforeExpr:!0}),coalesce:Gt("??",1),_break:Te("break"),_case:Te("case",Yt),_catch:Te("catch"),_continue:Te("continue"),_debugger:Te("debugger"),_default:Te("default",Yt),_do:Te("do",{isLoop:!0,beforeExpr:!0}),_else:Te("else",Yt),_finally:Te("finally"),_for:Te("for",{isLoop:!0}),_function:Te("function",$t),_if:Te("if"),_return:Te("return",Yt),_switch:Te("switch"),_throw:Te("throw",Yt),_try:Te("try"),_var:Te("var"),_const:Te("const"),_while:Te("while",{isLoop:!0}),_with:Te("with"),_new:Te("new",{beforeExpr:!0,startsExpr:!0}),_this:Te("this",$t),_super:Te("super",$t),_class:Te("class",$t),_extends:Te("extends",Yt),_export:Te("export"),_import:Te("import",$t),_null:Te("null",$t),_true:Te("true",$t),_false:Te("false",$t),_in:Te("in",{beforeExpr:!0,binop:7}),_instanceof:Te("instanceof",{beforeExpr:!0,binop:7}),_typeof:Te("typeof",{beforeExpr:!0,prefix:!0,startsExpr:!0}),_void:Te("void",{beforeExpr:!0,prefix:!0,startsExpr:!0}),_delete:Te("delete",{beforeExpr:!0,prefix:!0,startsExpr:!0})},Nt=/\r\n?|\n|\u2028|\u2029/,ER=new RegExp(Nt.source,"g");function dn(t){return t===10||t===13||t===8232||t===8233}function e0(t,e,i){i===void 0&&(i=t.length);for(var s=e;s<i;s++){var r=t.charCodeAt(s);if(dn(r))return s<i-1&&r===13&&t.charCodeAt(s+1)===10?s+2:s+1}return-1}var t0=/[\u1680\u2000-\u200a\u202f\u205f\u3000\ufeff]/,kt=/(?:\s|\/\/.*|\/\*[^]*?\*\/)*/g,i0=Object.prototype,PR=i0.hasOwnProperty,CR=i0.toString,un=Object.hasOwn||function(t,e){return PR.call(t,e)},Jf=Array.isArray||function(t){return CR.call(t)==="[object Array]"},eg=Object.create(null);function vs(t){return eg[t]||(eg[t]=new RegExp("^(?:"+t.replace(/ /g,"|")+")$"))}function is(t){return t<=65535?String.fromCharCode(t):(t-=65536,String.fromCharCode((t>>10)+55296,(t&1023)+56320))}var _R=/(?:[\uD800-\uDBFF](?![\uDC00-\uDFFF])|(?:[^\uD800-\uDBFF]|^)[\uDC00-\uDFFF])/,ya=function(e,i){this.line=e,this.column=i};ya.prototype.offset=function(e){return new ya(this.line,this.column+e)};var Cl=function(e,i,s){this.start=i,this.end=s,e.sourceFile!==null&&(this.source=e.sourceFile)};function s0(t,e){for(var i=1,s=0;;){var r=e0(t,s,e);if(r<0)return new ya(i,e-s);++i,s=r}}var Zh={ecmaVersion:null,sourceType:"script",onInsertedSemicolon:null,onTrailingComma:null,allowReserved:null,allowReturnOutsideFunction:!1,allowImportExportEverywhere:!1,allowAwaitOutsideFunction:null,allowSuperOutsideMethod:null,allowHashBang:!1,checkPrivateFields:!0,locations:!1,onToken:null,onComment:null,ranges:!1,program:null,sourceFile:null,directSourceFile:null,preserveParens:!1},tg=!1;function RR(t){var e={};for(var i in Zh)e[i]=t&&un(t,i)?t[i]:Zh[i];if(e.ecmaVersion==="latest"?e.ecmaVersion=1e8:e.ecmaVersion==null?(!tg&&typeof console=="object"&&console.warn&&(tg=!0,console.warn(`Since Acorn 8.0.0, options.ecmaVersion is required.
Defaulting to 2020, but this will stop working in the future.`)),e.ecmaVersion=11):e.ecmaVersion>=2015&&(e.ecmaVersion-=2009),e.allowReserved==null&&(e.allowReserved=e.ecmaVersion<5),(!t||t.allowHashBang==null)&&(e.allowHashBang=e.ecmaVersion>=14),Jf(e.onToken)){var s=e.onToken;e.onToken=function(r){return s.push(r)}}return Jf(e.onComment)&&(e.onComment=$R(e,e.onComment)),e}function $R(t,e){return function(i,s,r,n,a,o){var l={type:i?"Block":"Line",value:s,start:r,end:n};t.locations&&(l.loc=new Cl(this,a,o)),t.ranges&&(l.range=[r,n]),e.push(l)}}var va=1,pn=2,Xd=4,r0=8,Gd=16,n0=32,_l=64,a0=128,dr=256,Ra=512,Rl=va|pn|dr;function Yd(t,e){return pn|(t?Xd:0)|(e?r0:0)}var Ko=0,Zd=1,os=2,o0=3,l0=4,c0=5,at=function(e,i,s){this.options=e=RR(e),this.sourceFile=e.sourceFile,this.keywords=vs(SR[e.ecmaVersion>=6?6:e.sourceType==="module"?"5module":5]);var r="";e.allowReserved!==!0&&(r=Lc[e.ecmaVersion>=6?6:e.ecmaVersion===5?5:3],e.sourceType==="module"&&(r+=" await")),this.reservedWords=vs(r);var n=(r?r+" ":"")+Lc.strict;this.reservedWordsStrict=vs(n),this.reservedWordsStrictBind=vs(n+" "+Lc.strictBind),this.input=String(i),this.containsEsc=!1,s?(this.pos=s,this.lineStart=this.input.lastIndexOf(`
`,s-1)+1,this.curLine=this.input.slice(0,this.lineStart).split(Nt).length):(this.pos=this.lineStart=0,this.curLine=1),this.type=S.eof,this.value=null,this.start=this.end=this.pos,this.startLoc=this.endLoc=this.curPosition(),this.lastTokEndLoc=this.lastTokStartLoc=null,this.lastTokStart=this.lastTokEnd=this.pos,this.context=this.initialContext(),this.exprAllowed=!0,this.inModule=e.sourceType==="module",this.strict=this.inModule||this.strictDirective(this.pos),this.potentialArrowAt=-1,this.potentialArrowInForAwait=!1,this.yieldPos=this.awaitPos=this.awaitIdentPos=0,this.labels=[],this.undefinedExports=Object.create(null),this.pos===0&&e.allowHashBang&&this.input.slice(0,2)==="#!"&&this.skipLineComment(2),this.scopeStack=[],this.enterScope(va),this.regexpState=null,this.privateNameStack=[]},Ni={inFunction:{configurable:!0},inGenerator:{configurable:!0},inAsync:{configurable:!0},canAwait:{configurable:!0},allowSuper:{configurable:!0},allowDirectSuper:{configurable:!0},treatFunctionsAsVar:{configurable:!0},allowNewDotTarget:{configurable:!0},inClassStaticBlock:{configurable:!0}};at.prototype.parse=function(){var e=this.options.program||this.startNode();return this.nextToken(),this.parseTopLevel(e)};Ni.inFunction.get=function(){return(this.currentVarScope().flags&pn)>0};Ni.inGenerator.get=function(){return(this.currentVarScope().flags&r0)>0};Ni.inAsync.get=function(){return(this.currentVarScope().flags&Xd)>0};Ni.canAwait.get=function(){for(var t=this.scopeStack.length-1;t>=0;t--){var e=this.scopeStack[t],i=e.flags;if(i&(dr|Ra))return!1;if(i&pn)return(i&Xd)>0}return this.inModule&&this.options.ecmaVersion>=13||this.options.allowAwaitOutsideFunction};Ni.allowSuper.get=function(){var t=this.currentThisScope(),e=t.flags;return(e&_l)>0||this.options.allowSuperOutsideMethod};Ni.allowDirectSuper.get=function(){return(this.currentThisScope().flags&a0)>0};Ni.treatFunctionsAsVar.get=function(){return this.treatFunctionsAsVarInScope(this.currentScope())};Ni.allowNewDotTarget.get=function(){for(var t=this.scopeStack.length-1;t>=0;t--){var e=this.scopeStack[t],i=e.flags;if(i&(dr|Ra)||i&pn&&!(i&Gd))return!0}return!1};Ni.inClassStaticBlock.get=function(){return(this.currentVarScope().flags&dr)>0};at.extend=function(){for(var e=[],i=arguments.length;i--;)e[i]=arguments[i];for(var s=this,r=0;r<e.length;r++)s=e[r](s);return s};at.parse=function(e,i){return new this(i,e).parse()};at.parseExpressionAt=function(e,i,s){var r=new this(s,e,i);return r.nextToken(),r.parseExpression()};at.tokenizer=function(e,i){return new this(i,e)};Object.defineProperties(at.prototype,Ni);var Rt=at.prototype,IR=/^(?:'((?:\\[^]|[^'\\])*?)'|"((?:\\[^]|[^"\\])*?)")/;Rt.strictDirective=function(t){if(this.options.ecmaVersion<5)return!1;for(;;){kt.lastIndex=t,t+=kt.exec(this.input)[0].length;var e=IR.exec(this.input.slice(t));if(!e)return!1;if((e[1]||e[2])==="use strict"){kt.lastIndex=t+e[0].length;var i=kt.exec(this.input),s=i.index+i[0].length,r=this.input.charAt(s);return r===";"||r==="}"||Nt.test(i[0])&&!(/[(`.[+\-/*%<>=,?^&]/.test(r)||r==="!"&&this.input.charAt(s+1)==="=")}t+=e[0].length,kt.lastIndex=t,t+=kt.exec(this.input)[0].length,this.input[t]===";"&&t++}};Rt.eat=function(t){return this.type===t?(this.next(),!0):!1};Rt.isContextual=function(t){return this.type===S.name&&this.value===t&&!this.containsEsc};Rt.eatContextual=function(t){return this.isContextual(t)?(this.next(),!0):!1};Rt.expectContextual=function(t){this.eatContextual(t)||this.unexpected()};Rt.canInsertSemicolon=function(){return this.type===S.eof||this.type===S.braceR||Nt.test(this.input.slice(this.lastTokEnd,this.start))};Rt.insertSemicolon=function(){if(this.canInsertSemicolon())return this.options.onInsertedSemicolon&&this.options.onInsertedSemicolon(this.lastTokEnd,this.lastTokEndLoc),!0};Rt.semicolon=function(){!this.eat(S.semi)&&!this.insertSemicolon()&&this.unexpected()};Rt.afterTrailingComma=function(t,e){if(this.type===t)return this.options.onTrailingComma&&this.options.onTrailingComma(this.lastTokStart,this.lastTokStartLoc),e||this.next(),!0};Rt.expect=function(t){this.eat(t)||this.unexpected()};Rt.unexpected=function(t){this.raise(t??this.start,"Unexpected token")};var $l=function(){this.shorthandAssign=this.trailingComma=this.parenthesizedAssign=this.parenthesizedBind=this.doubleProto=-1};Rt.checkPatternErrors=function(t,e){if(t){t.trailingComma>-1&&this.raiseRecoverable(t.trailingComma,"Comma is not permitted after the rest element");var i=e?t.parenthesizedAssign:t.parenthesizedBind;i>-1&&this.raiseRecoverable(i,e?"Assigning to rvalue":"Parenthesized pattern")}};Rt.checkExpressionErrors=function(t,e){if(!t)return!1;var i=t.shorthandAssign,s=t.doubleProto;if(!e)return i>=0||s>=0;i>=0&&this.raise(i,"Shorthand property assignments are valid only in destructuring patterns"),s>=0&&this.raiseRecoverable(s,"Redefinition of __proto__ property")};Rt.checkYieldAwaitInDefaultParams=function(){this.yieldPos&&(!this.awaitPos||this.yieldPos<this.awaitPos)&&this.raise(this.yieldPos,"Yield expression cannot be a default value"),this.awaitPos&&this.raise(this.awaitPos,"Await expression cannot be a default value")};Rt.isSimpleAssignTarget=function(t){return t.type==="ParenthesizedExpression"?this.isSimpleAssignTarget(t.expression):t.type==="Identifier"||t.type==="MemberExpression"};var ie=at.prototype;ie.parseTopLevel=function(t){var e=Object.create(null);for(t.body||(t.body=[]);this.type!==S.eof;){var i=this.parseStatement(null,!0,e);t.body.push(i)}if(this.inModule)for(var s=0,r=Object.keys(this.undefinedExports);s<r.length;s+=1){var n=r[s];this.raiseRecoverable(this.undefinedExports[n].start,"Export '"+n+"' is not defined")}return this.adaptDirectivePrologue(t.body),this.next(),t.sourceType=this.options.sourceType,this.finishNode(t,"Program")};var Hd={kind:"loop"},QR={kind:"switch"};ie.isLet=function(t){if(this.options.ecmaVersion<6||!this.isContextual("let"))return!1;kt.lastIndex=this.pos;var e=kt.exec(this.input),i=this.pos+e[0].length,s=this.input.charCodeAt(i);if(s===91||s===92)return!0;if(t)return!1;if(s===123||s>55295&&s<56320)return!0;if(Ai(s,!0)){for(var r=i+1;Cs(s=this.input.charCodeAt(r),!0);)++r;if(s===92||s>55295&&s<56320)return!0;var n=this.input.slice(i,r);if(!xR.test(n))return!0}return!1};ie.isAsyncFunction=function(){if(this.options.ecmaVersion<8||!this.isContextual("async"))return!1;kt.lastIndex=this.pos;var t=kt.exec(this.input),e=this.pos+t[0].length,i;return!Nt.test(this.input.slice(this.pos,e))&&this.input.slice(e,e+8)==="function"&&(e+8===this.input.length||!(Cs(i=this.input.charCodeAt(e+8))||i>55295&&i<56320))};ie.isUsingKeyword=function(t,e){if(this.options.ecmaVersion<17||!this.isContextual(t?"await":"using"))return!1;kt.lastIndex=this.pos;var i=kt.exec(this.input),s=this.pos+i[0].length;if(Nt.test(this.input.slice(this.pos,s)))return!1;if(t){var r=s+5,n;if(this.input.slice(s,r)!=="using"||r===this.input.length||Cs(n=this.input.charCodeAt(r))||n>55295&&n<56320)return!1;kt.lastIndex=r;var a=kt.exec(this.input);if(a&&Nt.test(this.input.slice(r,r+a[0].length)))return!1}if(e){var o=s+2,l;if(this.input.slice(s,o)==="of"&&(o===this.input.length||!Cs(l=this.input.charCodeAt(o))&&!(l>55295&&l<56320)))return!1}var c=this.input.charCodeAt(s);return Ai(c,!0)||c===92};ie.isAwaitUsing=function(t){return this.isUsingKeyword(!0,t)};ie.isUsing=function(t){return this.isUsingKeyword(!1,t)};ie.parseStatement=function(t,e,i){var s=this.type,r=this.startNode(),n;switch(this.isLet(t)&&(s=S._var,n="let"),s){case S._break:case S._continue:return this.parseBreakContinueStatement(r,s.keyword);case S._debugger:return this.parseDebuggerStatement(r);case S._do:return this.parseDoStatement(r);case S._for:return this.parseForStatement(r);case S._function:return t&&(this.strict||t!=="if"&&t!=="label")&&this.options.ecmaVersion>=6&&this.unexpected(),this.parseFunctionStatement(r,!1,!t);case S._class:return t&&this.unexpected(),this.parseClass(r,!0);case S._if:return this.parseIfStatement(r);case S._return:return this.parseReturnStatement(r);case S._switch:return this.parseSwitchStatement(r);case S._throw:return this.parseThrowStatement(r);case S._try:return this.parseTryStatement(r);case S._const:case S._var:return n=n||this.value,t&&n!=="var"&&this.unexpected(),this.parseVarStatement(r,n);case S._while:return this.parseWhileStatement(r);case S._with:return this.parseWithStatement(r);case S.braceL:return this.parseBlock(!0,r);case S.semi:return this.parseEmptyStatement(r);case S._export:case S._import:if(this.options.ecmaVersion>10&&s===S._import){kt.lastIndex=this.pos;var a=kt.exec(this.input),o=this.pos+a[0].length,l=this.input.charCodeAt(o);if(l===40||l===46)return this.parseExpressionStatement(r,this.parseExpression())}return this.options.allowImportExportEverywhere||(e||this.raise(this.start,"'import' and 'export' may only appear at the top level"),this.inModule||this.raise(this.start,"'import' and 'export' may appear only with 'sourceType: module'")),s===S._import?this.parseImport(r):this.parseExport(r,i);default:if(this.isAsyncFunction())return t&&this.unexpected(),this.next(),this.parseFunctionStatement(r,!0,!t);var c=this.isAwaitUsing(!1)?"await using":this.isUsing(!1)?"using":null;if(c)return e&&this.options.sourceType==="script"&&this.raise(this.start,"Using declaration cannot appear in the top level when source type is `script`"),c==="await using"&&(this.canAwait||this.raise(this.start,"Await using cannot appear outside of async function"),this.next()),this.next(),this.parseVar(r,!1,c),this.semicolon(),this.finishNode(r,"VariableDeclaration");var h=this.value,d=this.parseExpression();return s===S.name&&d.type==="Identifier"&&this.eat(S.colon)?this.parseLabeledStatement(r,h,d,t):this.parseExpressionStatement(r,d)}};ie.parseBreakContinueStatement=function(t,e){var i=e==="break";this.next(),this.eat(S.semi)||this.insertSemicolon()?t.label=null:this.type!==S.name?this.unexpected():(t.label=this.parseIdent(),this.semicolon());for(var s=0;s<this.labels.length;++s){var r=this.labels[s];if((t.label==null||r.name===t.label.name)&&(r.kind!=null&&(i||r.kind==="loop")||t.label&&i))break}return s===this.labels.length&&this.raise(t.start,"Unsyntactic "+e),this.finishNode(t,i?"BreakStatement":"ContinueStatement")};ie.parseDebuggerStatement=function(t){return this.next(),this.semicolon(),this.finishNode(t,"DebuggerStatement")};ie.parseDoStatement=function(t){return this.next(),this.labels.push(Hd),t.body=this.parseStatement("do"),this.labels.pop(),this.expect(S._while),t.test=this.parseParenExpression(),this.options.ecmaVersion>=6?this.eat(S.semi):this.semicolon(),this.finishNode(t,"DoWhileStatement")};ie.parseForStatement=function(t){this.next();var e=this.options.ecmaVersion>=9&&this.canAwait&&this.eatContextual("await")?this.lastTokStart:-1;if(this.labels.push(Hd),this.enterScope(0),this.expect(S.parenL),this.type===S.semi)return e>-1&&this.unexpected(e),this.parseFor(t,null);var i=this.isLet();if(this.type===S._var||this.type===S._const||i){var s=this.startNode(),r=i?"let":this.value;return this.next(),this.parseVar(s,!0,r),this.finishNode(s,"VariableDeclaration"),this.parseForAfterInit(t,s,e)}var n=this.isContextual("let"),a=!1,o=this.isUsing(!0)?"using":this.isAwaitUsing(!0)?"await using":null;if(o){var l=this.startNode();return this.next(),o==="await using"&&this.next(),this.parseVar(l,!0,o),this.finishNode(l,"VariableDeclaration"),this.parseForAfterInit(t,l,e)}var c=this.containsEsc,h=new $l,d=this.start,u=e>-1?this.parseExprSubscripts(h,"await"):this.parseExpression(!0,h);return this.type===S._in||(a=this.options.ecmaVersion>=6&&this.isContextual("of"))?(e>-1?(this.type===S._in&&this.unexpected(e),t.await=!0):a&&this.options.ecmaVersion>=8&&(u.start===d&&!c&&u.type==="Identifier"&&u.name==="async"?this.unexpected():this.options.ecmaVersion>=9&&(t.await=!1)),n&&a&&this.raise(u.start,"The left-hand side of a for-of loop may not start with 'let'."),this.toAssignable(u,!1,h),this.checkLValPattern(u),this.parseForIn(t,u)):(this.checkExpressionErrors(h,!0),e>-1&&this.unexpected(e),this.parseFor(t,u))};ie.parseForAfterInit=function(t,e,i){return(this.type===S._in||this.options.ecmaVersion>=6&&this.isContextual("of"))&&e.declarations.length===1?(this.options.ecmaVersion>=9&&(this.type===S._in?i>-1&&this.unexpected(i):t.await=i>-1),this.parseForIn(t,e)):(i>-1&&this.unexpected(i),this.parseFor(t,e))};ie.parseFunctionStatement=function(t,e,i){return this.next(),this.parseFunction(t,Kn|(i?0:Hh),!1,e)};ie.parseIfStatement=function(t){return this.next(),t.test=this.parseParenExpression(),t.consequent=this.parseStatement("if"),t.alternate=this.eat(S._else)?this.parseStatement("if"):null,this.finishNode(t,"IfStatement")};ie.parseReturnStatement=function(t){return!this.inFunction&&!this.options.allowReturnOutsideFunction&&this.raise(this.start,"'return' outside of function"),this.next(),this.eat(S.semi)||this.insertSemicolon()?t.argument=null:(t.argument=this.parseExpression(),this.semicolon()),this.finishNode(t,"ReturnStatement")};ie.parseSwitchStatement=function(t){this.next(),t.discriminant=this.parseParenExpression(),t.cases=[],this.expect(S.braceL),this.labels.push(QR),this.enterScope(0);for(var e,i=!1;this.type!==S.braceR;)if(this.type===S._case||this.type===S._default){var s=this.type===S._case;e&&this.finishNode(e,"SwitchCase"),t.cases.push(e=this.startNode()),e.consequent=[],this.next(),s?e.test=this.parseExpression():(i&&this.raiseRecoverable(this.lastTokStart,"Multiple default clauses"),i=!0,e.test=null),this.expect(S.colon)}else e||this.unexpected(),e.consequent.push(this.parseStatement(null));return this.exitScope(),e&&this.finishNode(e,"SwitchCase"),this.next(),this.labels.pop(),this.finishNode(t,"SwitchStatement")};ie.parseThrowStatement=function(t){return this.next(),Nt.test(this.input.slice(this.lastTokEnd,this.start))&&this.raise(this.lastTokEnd,"Illegal newline after throw"),t.argument=this.parseExpression(),this.semicolon(),this.finishNode(t,"ThrowStatement")};var AR=[];ie.parseCatchClauseParam=function(){var t=this.parseBindingAtom(),e=t.type==="Identifier";return this.enterScope(e?n0:0),this.checkLValPattern(t,e?l0:os),this.expect(S.parenR),t};ie.parseTryStatement=function(t){if(this.next(),t.block=this.parseBlock(),t.handler=null,this.type===S._catch){var e=this.startNode();this.next(),this.eat(S.parenL)?e.param=this.parseCatchClauseParam():(this.options.ecmaVersion<10&&this.unexpected(),e.param=null,this.enterScope(0)),e.body=this.parseBlock(!1),this.exitScope(),t.handler=this.finishNode(e,"CatchClause")}return t.finalizer=this.eat(S._finally)?this.parseBlock():null,!t.handler&&!t.finalizer&&this.raise(t.start,"Missing catch or finally clause"),this.finishNode(t,"TryStatement")};ie.parseVarStatement=function(t,e,i){return this.next(),this.parseVar(t,!1,e,i),this.semicolon(),this.finishNode(t,"VariableDeclaration")};ie.parseWhileStatement=function(t){return this.next(),t.test=this.parseParenExpression(),this.labels.push(Hd),t.body=this.parseStatement("while"),this.labels.pop(),this.finishNode(t,"WhileStatement")};ie.parseWithStatement=function(t){return this.strict&&this.raise(this.start,"'with' in strict mode"),this.next(),t.object=this.parseParenExpression(),t.body=this.parseStatement("with"),this.finishNode(t,"WithStatement")};ie.parseEmptyStatement=function(t){return this.next(),this.finishNode(t,"EmptyStatement")};ie.parseLabeledStatement=function(t,e,i,s){for(var r=0,n=this.labels;r<n.length;r+=1){var a=n[r];a.name===e&&this.raise(i.start,"Label '"+e+"' is already declared")}for(var o=this.type.isLoop?"loop":this.type===S._switch?"switch":null,l=this.labels.length-1;l>=0;l--){var c=this.labels[l];if(c.statementStart===t.start)c.statementStart=this.start,c.kind=o;else break}return this.labels.push({name:e,kind:o,statementStart:this.start}),t.body=this.parseStatement(s?s.indexOf("label")===-1?s+"label":s:"label"),this.labels.pop(),t.label=i,this.finishNode(t,"LabeledStatement")};ie.parseExpressionStatement=function(t,e){return t.expression=e,this.semicolon(),this.finishNode(t,"ExpressionStatement")};ie.parseBlock=function(t,e,i){for(t===void 0&&(t=!0),e===void 0&&(e=this.startNode()),e.body=[],this.expect(S.braceL),t&&this.enterScope(0);this.type!==S.braceR;){var s=this.parseStatement(null);e.body.push(s)}return i&&(this.strict=!1),this.next(),t&&this.exitScope(),this.finishNode(e,"BlockStatement")};ie.parseFor=function(t,e){return t.init=e,this.expect(S.semi),t.test=this.type===S.semi?null:this.parseExpression(),this.expect(S.semi),t.update=this.type===S.parenR?null:this.parseExpression(),this.expect(S.parenR),t.body=this.parseStatement("for"),this.exitScope(),this.labels.pop(),this.finishNode(t,"ForStatement")};ie.parseForIn=function(t,e){var i=this.type===S._in;return this.next(),e.type==="VariableDeclaration"&&e.declarations[0].init!=null&&(!i||this.options.ecmaVersion<8||this.strict||e.kind!=="var"||e.declarations[0].id.type!=="Identifier")&&this.raise(e.start,(i?"for-in":"for-of")+" loop variable declaration may not have an initializer"),t.left=e,t.right=i?this.parseExpression():this.parseMaybeAssign(),this.expect(S.parenR),t.body=this.parseStatement("for"),this.exitScope(),this.labels.pop(),this.finishNode(t,i?"ForInStatement":"ForOfStatement")};ie.parseVar=function(t,e,i,s){for(t.declarations=[],t.kind=i;;){var r=this.startNode();if(this.parseVarId(r,i),this.eat(S.eq)?r.init=this.parseMaybeAssign(e):!s&&i==="const"&&!(this.type===S._in||this.options.ecmaVersion>=6&&this.isContextual("of"))?this.unexpected():!s&&(i==="using"||i==="await using")&&this.options.ecmaVersion>=17&&this.type!==S._in&&!this.isContextual("of")?this.raise(this.lastTokEnd,"Missing initializer in "+i+" declaration"):!s&&r.id.type!=="Identifier"&&!(e&&(this.type===S._in||this.isContextual("of")))?this.raise(this.lastTokEnd,"Complex binding patterns require an initialization value"):r.init=null,t.declarations.push(this.finishNode(r,"VariableDeclarator")),!this.eat(S.comma))break}return t};ie.parseVarId=function(t,e){t.id=e==="using"||e==="await using"?this.parseIdent():this.parseBindingAtom(),this.checkLValPattern(t.id,e==="var"?Zd:os,!1)};var Kn=1,Hh=2,h0=4;ie.parseFunction=function(t,e,i,s,r){this.initFunction(t),(this.options.ecmaVersion>=9||this.options.ecmaVersion>=6&&!s)&&(this.type===S.star&&e&Hh&&this.unexpected(),t.generator=this.eat(S.star)),this.options.ecmaVersion>=8&&(t.async=!!s),e&Kn&&(t.id=e&h0&&this.type!==S.name?null:this.parseIdent(),t.id&&!(e&Hh)&&this.checkLValSimple(t.id,this.strict||t.generator||t.async?this.treatFunctionsAsVar?Zd:os:o0));var n=this.yieldPos,a=this.awaitPos,o=this.awaitIdentPos;return this.yieldPos=0,this.awaitPos=0,this.awaitIdentPos=0,this.enterScope(Yd(t.async,t.generator)),e&Kn||(t.id=this.type===S.name?this.parseIdent():null),this.parseFunctionParams(t),this.parseFunctionBody(t,i,!1,r),this.yieldPos=n,this.awaitPos=a,this.awaitIdentPos=o,this.finishNode(t,e&Kn?"FunctionDeclaration":"FunctionExpression")};ie.parseFunctionParams=function(t){this.expect(S.parenL),t.params=this.parseBindingList(S.parenR,!1,this.options.ecmaVersion>=8),this.checkYieldAwaitInDefaultParams()};ie.parseClass=function(t,e){this.next();var i=this.strict;this.strict=!0,this.parseClassId(t,e),this.parseClassSuper(t);var s=this.enterClassBody(),r=this.startNode(),n=!1;for(r.body=[],this.expect(S.braceL);this.type!==S.braceR;){var a=this.parseClassElement(t.superClass!==null);a&&(r.body.push(a),a.type==="MethodDefinition"&&a.kind==="constructor"?(n&&this.raiseRecoverable(a.start,"Duplicate constructor in the same class"),n=!0):a.key&&a.key.type==="PrivateIdentifier"&&LR(s,a)&&this.raiseRecoverable(a.key.start,"Identifier '#"+a.key.name+"' has already been declared"))}return this.strict=i,this.next(),t.body=this.finishNode(r,"ClassBody"),this.exitClassBody(),this.finishNode(t,e?"ClassDeclaration":"ClassExpression")};ie.parseClassElement=function(t){if(this.eat(S.semi))return null;var e=this.options.ecmaVersion,i=this.startNode(),s="",r=!1,n=!1,a="method",o=!1;if(this.eatContextual("static")){if(e>=13&&this.eat(S.braceL))return this.parseClassStaticBlock(i),i;this.isClassElementNameStart()||this.type===S.star?o=!0:s="static"}if(i.static=o,!s&&e>=8&&this.eatContextual("async")&&((this.isClassElementNameStart()||this.type===S.star)&&!this.canInsertSemicolon()?n=!0:s="async"),!s&&(e>=9||!n)&&this.eat(S.star)&&(r=!0),!s&&!n&&!r){var l=this.value;(this.eatContextual("get")||this.eatContextual("set"))&&(this.isClassElementNameStart()?a=l:s=l)}if(s?(i.computed=!1,i.key=this.startNodeAt(this.lastTokStart,this.lastTokStartLoc),i.key.name=s,this.finishNode(i.key,"Identifier")):this.parseClassElementName(i),e<13||this.type===S.parenL||a!=="method"||r||n){var c=!i.static&&Jo(i,"constructor"),h=c&&t;c&&a!=="method"&&this.raise(i.key.start,"Constructor can't have get/set modifier"),i.kind=c?"constructor":a,this.parseClassMethod(i,r,n,h)}else this.parseClassField(i);return i};ie.isClassElementNameStart=function(){return this.type===S.name||this.type===S.privateId||this.type===S.num||this.type===S.string||this.type===S.bracketL||this.type.keyword};ie.parseClassElementName=function(t){this.type===S.privateId?(this.value==="constructor"&&this.raise(this.start,"Classes can't have an element named '#constructor'"),t.computed=!1,t.key=this.parsePrivateIdent()):this.parsePropertyName(t)};ie.parseClassMethod=function(t,e,i,s){var r=t.key;t.kind==="constructor"?(e&&this.raise(r.start,"Constructor can't be a generator"),i&&this.raise(r.start,"Constructor can't be an async method")):t.static&&Jo(t,"prototype")&&this.raise(r.start,"Classes may not have a static property named prototype");var n=t.value=this.parseMethod(e,i,s);return t.kind==="get"&&n.params.length!==0&&this.raiseRecoverable(n.start,"getter should have no params"),t.kind==="set"&&n.params.length!==1&&this.raiseRecoverable(n.start,"setter should have exactly one param"),t.kind==="set"&&n.params[0].type==="RestElement"&&this.raiseRecoverable(n.params[0].start,"Setter cannot use rest params"),this.finishNode(t,"MethodDefinition")};ie.parseClassField=function(t){return Jo(t,"constructor")?this.raise(t.key.start,"Classes can't have a field named 'constructor'"):t.static&&Jo(t,"prototype")&&this.raise(t.key.start,"Classes can't have a static field named 'prototype'"),this.eat(S.eq)?(this.enterScope(Ra|_l),t.value=this.parseMaybeAssign(),this.exitScope()):t.value=null,this.semicolon(),this.finishNode(t,"PropertyDefinition")};ie.parseClassStaticBlock=function(t){t.body=[];var e=this.labels;for(this.labels=[],this.enterScope(dr|_l);this.type!==S.braceR;){var i=this.parseStatement(null);t.body.push(i)}return this.next(),this.exitScope(),this.labels=e,this.finishNode(t,"StaticBlock")};ie.parseClassId=function(t,e){this.type===S.name?(t.id=this.parseIdent(),e&&this.checkLValSimple(t.id,os,!1)):(e===!0&&this.unexpected(),t.id=null)};ie.parseClassSuper=function(t){t.superClass=this.eat(S._extends)?this.parseExprSubscripts(null,!1):null};ie.enterClassBody=function(){var t={declared:Object.create(null),used:[]};return this.privateNameStack.push(t),t.declared};ie.exitClassBody=function(){var t=this.privateNameStack.pop(),e=t.declared,i=t.used;if(this.options.checkPrivateFields)for(var s=this.privateNameStack.length,r=s===0?null:this.privateNameStack[s-1],n=0;n<i.length;++n){var a=i[n];un(e,a.name)||(r?r.used.push(a):this.raiseRecoverable(a.start,"Private field '#"+a.name+"' must be declared in an enclosing class"))}};function LR(t,e){var i=e.key.name,s=t[i],r="true";return e.type==="MethodDefinition"&&(e.kind==="get"||e.kind==="set")&&(r=(e.static?"s":"i")+e.kind),s==="iget"&&r==="iset"||s==="iset"&&r==="iget"||s==="sget"&&r==="sset"||s==="sset"&&r==="sget"?(t[i]="true",!1):s?!0:(t[i]=r,!1)}function Jo(t,e){var i=t.computed,s=t.key;return!i&&(s.type==="Identifier"&&s.name===e||s.type==="Literal"&&s.value===e)}ie.parseExportAllDeclaration=function(t,e){return this.options.ecmaVersion>=11&&(this.eatContextual("as")?(t.exported=this.parseModuleExportName(),this.checkExport(e,t.exported,this.lastTokStart)):t.exported=null),this.expectContextual("from"),this.type!==S.string&&this.unexpected(),t.source=this.parseExprAtom(),this.options.ecmaVersion>=16&&(t.attributes=this.parseWithClause()),this.semicolon(),this.finishNode(t,"ExportAllDeclaration")};ie.parseExport=function(t,e){if(this.next(),this.eat(S.star))return this.parseExportAllDeclaration(t,e);if(this.eat(S._default))return this.checkExport(e,"default",this.lastTokStart),t.declaration=this.parseExportDefaultDeclaration(),this.finishNode(t,"ExportDefaultDeclaration");if(this.shouldParseExportStatement())t.declaration=this.parseExportDeclaration(t),t.declaration.type==="VariableDeclaration"?this.checkVariableExport(e,t.declaration.declarations):this.checkExport(e,t.declaration.id,t.declaration.id.start),t.specifiers=[],t.source=null,this.options.ecmaVersion>=16&&(t.attributes=[]);else{if(t.declaration=null,t.specifiers=this.parseExportSpecifiers(e),this.eatContextual("from"))this.type!==S.string&&this.unexpected(),t.source=this.parseExprAtom(),this.options.ecmaVersion>=16&&(t.attributes=this.parseWithClause());else{for(var i=0,s=t.specifiers;i<s.length;i+=1){var r=s[i];this.checkUnreserved(r.local),this.checkLocalExport(r.local),r.local.type==="Literal"&&this.raise(r.local.start,"A string literal cannot be used as an exported binding without `from`.")}t.source=null,this.options.ecmaVersion>=16&&(t.attributes=[])}this.semicolon()}return this.finishNode(t,"ExportNamedDeclaration")};ie.parseExportDeclaration=function(t){return this.parseStatement(null)};ie.parseExportDefaultDeclaration=function(){var t;if(this.type===S._function||(t=this.isAsyncFunction())){var e=this.startNode();return this.next(),t&&this.next(),this.parseFunction(e,Kn|h0,!1,t)}else if(this.type===S._class){var i=this.startNode();return this.parseClass(i,"nullableID")}else{var s=this.parseMaybeAssign();return this.semicolon(),s}};ie.checkExport=function(t,e,i){t&&(typeof e!="string"&&(e=e.type==="Identifier"?e.name:e.value),un(t,e)&&this.raiseRecoverable(i,"Duplicate export '"+e+"'"),t[e]=!0)};ie.checkPatternExport=function(t,e){var i=e.type;if(i==="Identifier")this.checkExport(t,e,e.start);else if(i==="ObjectPattern")for(var s=0,r=e.properties;s<r.length;s+=1){var n=r[s];this.checkPatternExport(t,n)}else if(i==="ArrayPattern")for(var a=0,o=e.elements;a<o.length;a+=1){var l=o[a];l&&this.checkPatternExport(t,l)}else i==="Property"?this.checkPatternExport(t,e.value):i==="AssignmentPattern"?this.checkPatternExport(t,e.left):i==="RestElement"&&this.checkPatternExport(t,e.argument)};ie.checkVariableExport=function(t,e){if(t)for(var i=0,s=e;i<s.length;i+=1){var r=s[i];this.checkPatternExport(t,r.id)}};ie.shouldParseExportStatement=function(){return this.type.keyword==="var"||this.type.keyword==="const"||this.type.keyword==="class"||this.type.keyword==="function"||this.isLet()||this.isAsyncFunction()};ie.parseExportSpecifier=function(t){var e=this.startNode();return e.local=this.parseModuleExportName(),e.exported=this.eatContextual("as")?this.parseModuleExportName():e.local,this.checkExport(t,e.exported,e.exported.start),this.finishNode(e,"ExportSpecifier")};ie.parseExportSpecifiers=function(t){var e=[],i=!0;for(this.expect(S.braceL);!this.eat(S.braceR);){if(i)i=!1;else if(this.expect(S.comma),this.afterTrailingComma(S.braceR))break;e.push(this.parseExportSpecifier(t))}return e};ie.parseImport=function(t){return this.next(),this.type===S.string?(t.specifiers=AR,t.source=this.parseExprAtom()):(t.specifiers=this.parseImportSpecifiers(),this.expectContextual("from"),t.source=this.type===S.string?this.parseExprAtom():this.unexpected()),this.options.ecmaVersion>=16&&(t.attributes=this.parseWithClause()),this.semicolon(),this.finishNode(t,"ImportDeclaration")};ie.parseImportSpecifier=function(){var t=this.startNode();return t.imported=this.parseModuleExportName(),this.eatContextual("as")?t.local=this.parseIdent():(this.checkUnreserved(t.imported),t.local=t.imported),this.checkLValSimple(t.local,os),this.finishNode(t,"ImportSpecifier")};ie.parseImportDefaultSpecifier=function(){var t=this.startNode();return t.local=this.parseIdent(),this.checkLValSimple(t.local,os),this.finishNode(t,"ImportDefaultSpecifier")};ie.parseImportNamespaceSpecifier=function(){var t=this.startNode();return this.next(),this.expectContextual("as"),t.local=this.parseIdent(),this.checkLValSimple(t.local,os),this.finishNode(t,"ImportNamespaceSpecifier")};ie.parseImportSpecifiers=function(){var t=[],e=!0;if(this.type===S.name&&(t.push(this.parseImportDefaultSpecifier()),!this.eat(S.comma)))return t;if(this.type===S.star)return t.push(this.parseImportNamespaceSpecifier()),t;for(this.expect(S.braceL);!this.eat(S.braceR);){if(e)e=!1;else if(this.expect(S.comma),this.afterTrailingComma(S.braceR))break;t.push(this.parseImportSpecifier())}return t};ie.parseWithClause=function(){var t=[];if(!this.eat(S._with))return t;this.expect(S.braceL);for(var e={},i=!0;!this.eat(S.braceR);){if(i)i=!1;else if(this.expect(S.comma),this.afterTrailingComma(S.braceR))break;var s=this.parseImportAttribute(),r=s.key.type==="Identifier"?s.key.name:s.key.value;un(e,r)&&this.raiseRecoverable(s.key.start,"Duplicate attribute key '"+r+"'"),e[r]=!0,t.push(s)}return t};ie.parseImportAttribute=function(){var t=this.startNode();return t.key=this.type===S.string?this.parseExprAtom():this.parseIdent(this.options.allowReserved!=="never"),this.expect(S.colon),this.type!==S.string&&this.unexpected(),t.value=this.parseExprAtom(),this.finishNode(t,"ImportAttribute")};ie.parseModuleExportName=function(){if(this.options.ecmaVersion>=13&&this.type===S.string){var t=this.parseLiteral(this.value);return _R.test(t.value)&&this.raise(t.start,"An export name cannot include a lone surrogate."),t}return this.parseIdent(!0)};ie.adaptDirectivePrologue=function(t){for(var e=0;e<t.length&&this.isDirectiveCandidate(t[e]);++e)t[e].directive=t[e].expression.raw.slice(1,-1)};ie.isDirectiveCandidate=function(t){return this.options.ecmaVersion>=5&&t.type==="ExpressionStatement"&&t.expression.type==="Literal"&&typeof t.expression.value=="string"&&(this.input[t.start]==='"'||this.input[t.start]==="'")};var ni=at.prototype;ni.toAssignable=function(t,e,i){if(this.options.ecmaVersion>=6&&t)switch(t.type){case"Identifier":this.inAsync&&t.name==="await"&&this.raise(t.start,"Cannot use 'await' as identifier inside an async function");break;case"ObjectPattern":case"ArrayPattern":case"AssignmentPattern":case"RestElement":break;case"ObjectExpression":t.type="ObjectPattern",i&&this.checkPatternErrors(i,!0);for(var s=0,r=t.properties;s<r.length;s+=1){var n=r[s];this.toAssignable(n,e),n.type==="RestElement"&&(n.argument.type==="ArrayPattern"||n.argument.type==="ObjectPattern")&&this.raise(n.argument.start,"Unexpected token")}break;case"Property":t.kind!=="init"&&this.raise(t.key.start,"Object pattern can't contain getter or setter"),this.toAssignable(t.value,e);break;case"ArrayExpression":t.type="ArrayPattern",i&&this.checkPatternErrors(i,!0),this.toAssignableList(t.elements,e);break;case"SpreadElement":t.type="RestElement",this.toAssignable(t.argument,e),t.argument.type==="AssignmentPattern"&&this.raise(t.argument.start,"Rest elements cannot have a default value");break;case"AssignmentExpression":t.operator!=="="&&this.raise(t.left.end,"Only '=' operator can be used for specifying default value."),t.type="AssignmentPattern",delete t.operator,this.toAssignable(t.left,e);break;case"ParenthesizedExpression":this.toAssignable(t.expression,e,i);break;case"ChainExpression":this.raiseRecoverable(t.start,"Optional chaining cannot appear in left-hand side");break;case"MemberExpression":if(!e)break;default:this.raise(t.start,"Assigning to rvalue")}else i&&this.checkPatternErrors(i,!0);return t};ni.toAssignableList=function(t,e){for(var i=t.length,s=0;s<i;s++){var r=t[s];r&&this.toAssignable(r,e)}if(i){var n=t[i-1];this.options.ecmaVersion===6&&e&&n&&n.type==="RestElement"&&n.argument.type!=="Identifier"&&this.unexpected(n.argument.start)}return t};ni.parseSpread=function(t){var e=this.startNode();return this.next(),e.argument=this.parseMaybeAssign(!1,t),this.finishNode(e,"SpreadElement")};ni.parseRestBinding=function(){var t=this.startNode();return this.next(),this.options.ecmaVersion===6&&this.type!==S.name&&this.unexpected(),t.argument=this.parseBindingAtom(),this.finishNode(t,"RestElement")};ni.parseBindingAtom=function(){if(this.options.ecmaVersion>=6)switch(this.type){case S.bracketL:var t=this.startNode();return this.next(),t.elements=this.parseBindingList(S.bracketR,!0,!0),this.finishNode(t,"ArrayPattern");case S.braceL:return this.parseObj(!0)}return this.parseIdent()};ni.parseBindingList=function(t,e,i,s){for(var r=[],n=!0;!this.eat(t);)if(n?n=!1:this.expect(S.comma),e&&this.type===S.comma)r.push(null);else{if(i&&this.afterTrailingComma(t))break;if(this.type===S.ellipsis){var a=this.parseRestBinding();this.parseBindingListItem(a),r.push(a),this.type===S.comma&&this.raiseRecoverable(this.start,"Comma is not permitted after the rest element"),this.expect(t);break}else r.push(this.parseAssignableListItem(s))}return r};ni.parseAssignableListItem=function(t){var e=this.parseMaybeDefault(this.start,this.startLoc);return this.parseBindingListItem(e),e};ni.parseBindingListItem=function(t){return t};ni.parseMaybeDefault=function(t,e,i){if(i=i||this.parseBindingAtom(),this.options.ecmaVersion<6||!this.eat(S.eq))return i;var s=this.startNodeAt(t,e);return s.left=i,s.right=this.parseMaybeAssign(),this.finishNode(s,"AssignmentPattern")};ni.checkLValSimple=function(t,e,i){e===void 0&&(e=Ko);var s=e!==Ko;switch(t.type){case"Identifier":this.strict&&this.reservedWordsStrictBind.test(t.name)&&this.raiseRecoverable(t.start,(s?"Binding ":"Assigning to ")+t.name+" in strict mode"),s&&(e===os&&t.name==="let"&&this.raiseRecoverable(t.start,"let is disallowed as a lexically bound name"),i&&(un(i,t.name)&&this.raiseRecoverable(t.start,"Argument name clash"),i[t.name]=!0),e!==c0&&this.declareName(t.name,e,t.start));break;case"ChainExpression":this.raiseRecoverable(t.start,"Optional chaining cannot appear in left-hand side");break;case"MemberExpression":s&&this.raiseRecoverable(t.start,"Binding member expression");break;case"ParenthesizedExpression":return s&&this.raiseRecoverable(t.start,"Binding parenthesized expression"),this.checkLValSimple(t.expression,e,i);default:this.raise(t.start,(s?"Binding":"Assigning to")+" rvalue")}};ni.checkLValPattern=function(t,e,i){switch(e===void 0&&(e=Ko),t.type){case"ObjectPattern":for(var s=0,r=t.properties;s<r.length;s+=1){var n=r[s];this.checkLValInnerPattern(n,e,i)}break;case"ArrayPattern":for(var a=0,o=t.elements;a<o.length;a+=1){var l=o[a];l&&this.checkLValInnerPattern(l,e,i)}break;default:this.checkLValSimple(t,e,i)}};ni.checkLValInnerPattern=function(t,e,i){switch(e===void 0&&(e=Ko),t.type){case"Property":this.checkLValInnerPattern(t.value,e,i);break;case"AssignmentPattern":this.checkLValPattern(t.left,e,i);break;case"RestElement":this.checkLValPattern(t.argument,e,i);break;default:this.checkLValPattern(t,e,i)}};var li=function(e,i,s,r,n){this.token=e,this.isExpr=!!i,this.preserveSpace=!!s,this.override=r,this.generator=!!n},We={b_stat:new li("{",!1),b_expr:new li("{",!0),b_tmpl:new li("${",!1),p_stat:new li("(",!1),p_expr:new li("(",!0),q_tmpl:new li("`",!0,!0,function(t){return t.tryReadTemplateToken()}),f_stat:new li("function",!1),f_expr:new li("function",!0),f_expr_gen:new li("function",!0,!1,null,!0),f_gen:new li("function",!1,!1,null,!0)},fn=at.prototype;fn.initialContext=function(){return[We.b_stat]};fn.curContext=function(){return this.context[this.context.length-1]};fn.braceIsBlock=function(t){var e=this.curContext();return e===We.f_expr||e===We.f_stat?!0:t===S.colon&&(e===We.b_stat||e===We.b_expr)?!e.isExpr:t===S._return||t===S.name&&this.exprAllowed?Nt.test(this.input.slice(this.lastTokEnd,this.start)):t===S._else||t===S.semi||t===S.eof||t===S.parenR||t===S.arrow?!0:t===S.braceL?e===We.b_stat:t===S._var||t===S._const||t===S.name?!1:!this.exprAllowed};fn.inGeneratorContext=function(){for(var t=this.context.length-1;t>=1;t--){var e=this.context[t];if(e.token==="function")return e.generator}return!1};fn.updateContext=function(t){var e,i=this.type;i.keyword&&t===S.dot?this.exprAllowed=!1:(e=i.updateContext)?e.call(this,t):this.exprAllowed=i.beforeExpr};fn.overrideContext=function(t){this.curContext()!==t&&(this.context[this.context.length-1]=t)};S.parenR.updateContext=S.braceR.updateContext=function(){if(this.context.length===1){this.exprAllowed=!0;return}var t=this.context.pop();t===We.b_stat&&this.curContext().token==="function"&&(t=this.context.pop()),this.exprAllowed=!t.isExpr};S.braceL.updateContext=function(t){this.context.push(this.braceIsBlock(t)?We.b_stat:We.b_expr),this.exprAllowed=!0};S.dollarBraceL.updateContext=function(){this.context.push(We.b_tmpl),this.exprAllowed=!0};S.parenL.updateContext=function(t){var e=t===S._if||t===S._for||t===S._with||t===S._while;this.context.push(e?We.p_stat:We.p_expr),this.exprAllowed=!0};S.incDec.updateContext=function(){};S._function.updateContext=S._class.updateContext=function(t){t.beforeExpr&&t!==S._else&&!(t===S.semi&&this.curContext()!==We.p_stat)&&!(t===S._return&&Nt.test(this.input.slice(this.lastTokEnd,this.start)))&&!((t===S.colon||t===S.braceL)&&this.curContext()===We.b_stat)?this.context.push(We.f_expr):this.context.push(We.f_stat),this.exprAllowed=!1};S.colon.updateContext=function(){this.curContext().token==="function"&&this.context.pop(),this.exprAllowed=!0};S.backQuote.updateContext=function(){this.curContext()===We.q_tmpl?this.context.pop():this.context.push(We.q_tmpl),this.exprAllowed=!1};S.star.updateContext=function(t){if(t===S._function){var e=this.context.length-1;this.context[e]===We.f_expr?this.context[e]=We.f_expr_gen:this.context[e]=We.f_gen}this.exprAllowed=!0};S.name.updateContext=function(t){var e=!1;this.options.ecmaVersion>=6&&t!==S.dot&&(this.value==="of"&&!this.exprAllowed||this.value==="yield"&&this.inGeneratorContext())&&(e=!0),this.exprAllowed=e};var ue=at.prototype;ue.checkPropClash=function(t,e,i){if(!(this.options.ecmaVersion>=9&&t.type==="SpreadElement")&&!(this.options.ecmaVersion>=6&&(t.computed||t.method||t.shorthand))){var s=t.key,r;switch(s.type){case"Identifier":r=s.name;break;case"Literal":r=String(s.value);break;default:return}var n=t.kind;if(this.options.ecmaVersion>=6){r==="__proto__"&&n==="init"&&(e.proto&&(i?i.doubleProto<0&&(i.doubleProto=s.start):this.raiseRecoverable(s.start,"Redefinition of __proto__ property")),e.proto=!0);return}r="$"+r;var a=e[r];if(a){var o;n==="init"?o=this.strict&&a.init||a.get||a.set:o=a.init||a[n],o&&this.raiseRecoverable(s.start,"Redefinition of property")}else a=e[r]={init:!1,get:!1,set:!1};a[n]=!0}};ue.parseExpression=function(t,e){var i=this.start,s=this.startLoc,r=this.parseMaybeAssign(t,e);if(this.type===S.comma){var n=this.startNodeAt(i,s);for(n.expressions=[r];this.eat(S.comma);)n.expressions.push(this.parseMaybeAssign(t,e));return this.finishNode(n,"SequenceExpression")}return r};ue.parseMaybeAssign=function(t,e,i){if(this.isContextual("yield")){if(this.inGenerator)return this.parseYield(t);this.exprAllowed=!1}var s=!1,r=-1,n=-1,a=-1;e?(r=e.parenthesizedAssign,n=e.trailingComma,a=e.doubleProto,e.parenthesizedAssign=e.trailingComma=-1):(e=new $l,s=!0);var o=this.start,l=this.startLoc;(this.type===S.parenL||this.type===S.name)&&(this.potentialArrowAt=this.start,this.potentialArrowInForAwait=t==="await");var c=this.parseMaybeConditional(t,e);if(i&&(c=i.call(this,c,o,l)),this.type.isAssign){var h=this.startNodeAt(o,l);return h.operator=this.value,this.type===S.eq&&(c=this.toAssignable(c,!1,e)),s||(e.parenthesizedAssign=e.trailingComma=e.doubleProto=-1),e.shorthandAssign>=c.start&&(e.shorthandAssign=-1),this.type===S.eq?this.checkLValPattern(c):this.checkLValSimple(c),h.left=c,this.next(),h.right=this.parseMaybeAssign(t),a>-1&&(e.doubleProto=a),this.finishNode(h,"AssignmentExpression")}else s&&this.checkExpressionErrors(e,!0);return r>-1&&(e.parenthesizedAssign=r),n>-1&&(e.trailingComma=n),c};ue.parseMaybeConditional=function(t,e){var i=this.start,s=this.startLoc,r=this.parseExprOps(t,e);if(this.checkExpressionErrors(e))return r;if(this.eat(S.question)){var n=this.startNodeAt(i,s);return n.test=r,n.consequent=this.parseMaybeAssign(),this.expect(S.colon),n.alternate=this.parseMaybeAssign(t),this.finishNode(n,"ConditionalExpression")}return r};ue.parseExprOps=function(t,e){var i=this.start,s=this.startLoc,r=this.parseMaybeUnary(e,!1,!1,t);return this.checkExpressionErrors(e)||r.start===i&&r.type==="ArrowFunctionExpression"?r:this.parseExprOp(r,i,s,-1,t)};ue.parseExprOp=function(t,e,i,s,r){var n=this.type.binop;if(n!=null&&(!r||this.type!==S._in)&&n>s){var a=this.type===S.logicalOR||this.type===S.logicalAND,o=this.type===S.coalesce;o&&(n=S.logicalAND.binop);var l=this.value;this.next();var c=this.start,h=this.startLoc,d=this.parseExprOp(this.parseMaybeUnary(null,!1,!1,r),c,h,n,r),u=this.buildBinary(e,i,t,d,l,a||o);return(a&&this.type===S.coalesce||o&&(this.type===S.logicalOR||this.type===S.logicalAND))&&this.raiseRecoverable(this.start,"Logical expressions and coalesce expressions cannot be mixed. Wrap either by parentheses"),this.parseExprOp(u,e,i,s,r)}return t};ue.buildBinary=function(t,e,i,s,r,n){s.type==="PrivateIdentifier"&&this.raise(s.start,"Private identifier can only be left side of binary expression");var a=this.startNodeAt(t,e);return a.left=i,a.operator=r,a.right=s,this.finishNode(a,n?"LogicalExpression":"BinaryExpression")};ue.parseMaybeUnary=function(t,e,i,s){var r=this.start,n=this.startLoc,a;if(this.isContextual("await")&&this.canAwait)a=this.parseAwait(s),e=!0;else if(this.type.prefix){var o=this.startNode(),l=this.type===S.incDec;o.operator=this.value,o.prefix=!0,this.next(),o.argument=this.parseMaybeUnary(null,!0,l,s),this.checkExpressionErrors(t,!0),l?this.checkLValSimple(o.argument):this.strict&&o.operator==="delete"&&d0(o.argument)?this.raiseRecoverable(o.start,"Deleting local variable in strict mode"):o.operator==="delete"&&Kh(o.argument)?this.raiseRecoverable(o.start,"Private fields can not be deleted"):e=!0,a=this.finishNode(o,l?"UpdateExpression":"UnaryExpression")}else if(!e&&this.type===S.privateId)(s||this.privateNameStack.length===0)&&this.options.checkPrivateFields&&this.unexpected(),a=this.parsePrivateIdent(),this.type!==S._in&&this.unexpected();else{if(a=this.parseExprSubscripts(t,s),this.checkExpressionErrors(t))return a;for(;this.type.postfix&&!this.canInsertSemicolon();){var c=this.startNodeAt(r,n);c.operator=this.value,c.prefix=!1,c.argument=a,this.checkLValSimple(a),this.next(),a=this.finishNode(c,"UpdateExpression")}}if(!i&&this.eat(S.starstar))if(e)this.unexpected(this.lastTokStart);else return this.buildBinary(r,n,a,this.parseMaybeUnary(null,!1,!1,s),"**",!1);else return a};function d0(t){return t.type==="Identifier"||t.type==="ParenthesizedExpression"&&d0(t.expression)}function Kh(t){return t.type==="MemberExpression"&&t.property.type==="PrivateIdentifier"||t.type==="ChainExpression"&&Kh(t.expression)||t.type==="ParenthesizedExpression"&&Kh(t.expression)}ue.parseExprSubscripts=function(t,e){var i=this.start,s=this.startLoc,r=this.parseExprAtom(t,e);if(r.type==="ArrowFunctionExpression"&&this.input.slice(this.lastTokStart,this.lastTokEnd)!==")")return r;var n=this.parseSubscripts(r,i,s,!1,e);return t&&n.type==="MemberExpression"&&(t.parenthesizedAssign>=n.start&&(t.parenthesizedAssign=-1),t.parenthesizedBind>=n.start&&(t.parenthesizedBind=-1),t.trailingComma>=n.start&&(t.trailingComma=-1)),n};ue.parseSubscripts=function(t,e,i,s,r){for(var n=this.options.ecmaVersion>=8&&t.type==="Identifier"&&t.name==="async"&&this.lastTokEnd===t.end&&!this.canInsertSemicolon()&&t.end-t.start===5&&this.potentialArrowAt===t.start,a=!1;;){var o=this.parseSubscript(t,e,i,s,n,a,r);if(o.optional&&(a=!0),o===t||o.type==="ArrowFunctionExpression"){if(a){var l=this.startNodeAt(e,i);l.expression=o,o=this.finishNode(l,"ChainExpression")}return o}t=o}};ue.shouldParseAsyncArrow=function(){return!this.canInsertSemicolon()&&this.eat(S.arrow)};ue.parseSubscriptAsyncArrow=function(t,e,i,s){return this.parseArrowExpression(this.startNodeAt(t,e),i,!0,s)};ue.parseSubscript=function(t,e,i,s,r,n,a){var o=this.options.ecmaVersion>=11,l=o&&this.eat(S.questionDot);s&&l&&this.raise(this.lastTokStart,"Optional chaining cannot appear in the callee of new expressions");var c=this.eat(S.bracketL);if(c||l&&this.type!==S.parenL&&this.type!==S.backQuote||this.eat(S.dot)){var h=this.startNodeAt(e,i);h.object=t,c?(h.property=this.parseExpression(),this.expect(S.bracketR)):this.type===S.privateId&&t.type!=="Super"?h.property=this.parsePrivateIdent():h.property=this.parseIdent(this.options.allowReserved!=="never"),h.computed=!!c,o&&(h.optional=l),t=this.finishNode(h,"MemberExpression")}else if(!s&&this.eat(S.parenL)){var d=new $l,u=this.yieldPos,p=this.awaitPos,f=this.awaitIdentPos;this.yieldPos=0,this.awaitPos=0,this.awaitIdentPos=0;var g=this.parseExprList(S.parenR,this.options.ecmaVersion>=8,!1,d);if(r&&!l&&this.shouldParseAsyncArrow())return this.checkPatternErrors(d,!1),this.checkYieldAwaitInDefaultParams(),this.awaitIdentPos>0&&this.raise(this.awaitIdentPos,"Cannot use 'await' as identifier inside an async function"),this.yieldPos=u,this.awaitPos=p,this.awaitIdentPos=f,this.parseSubscriptAsyncArrow(e,i,g,a);this.checkExpressionErrors(d,!0),this.yieldPos=u||this.yieldPos,this.awaitPos=p||this.awaitPos,this.awaitIdentPos=f||this.awaitIdentPos;var m=this.startNodeAt(e,i);m.callee=t,m.arguments=g,o&&(m.optional=l),t=this.finishNode(m,"CallExpression")}else if(this.type===S.backQuote){(l||n)&&this.raise(this.start,"Optional chaining cannot appear in the tag of tagged template expressions");var y=this.startNodeAt(e,i);y.tag=t,y.quasi=this.parseTemplate({isTagged:!0}),t=this.finishNode(y,"TaggedTemplateExpression")}return t};ue.parseExprAtom=function(t,e,i){this.type===S.slash&&this.readRegexp();var s,r=this.potentialArrowAt===this.start;switch(this.type){case S._super:return this.allowSuper||this.raise(this.start,"'super' keyword outside a method"),s=this.startNode(),this.next(),this.type===S.parenL&&!this.allowDirectSuper&&this.raise(s.start,"super() call outside constructor of a subclass"),this.type!==S.dot&&this.type!==S.bracketL&&this.type!==S.parenL&&this.unexpected(),this.finishNode(s,"Super");case S._this:return s=this.startNode(),this.next(),this.finishNode(s,"ThisExpression");case S.name:var n=this.start,a=this.startLoc,o=this.containsEsc,l=this.parseIdent(!1);if(this.options.ecmaVersion>=8&&!o&&l.name==="async"&&!this.canInsertSemicolon()&&this.eat(S._function))return this.overrideContext(We.f_expr),this.parseFunction(this.startNodeAt(n,a),0,!1,!0,e);if(r&&!this.canInsertSemicolon()){if(this.eat(S.arrow))return this.parseArrowExpression(this.startNodeAt(n,a),[l],!1,e);if(this.options.ecmaVersion>=8&&l.name==="async"&&this.type===S.name&&!o&&(!this.potentialArrowInForAwait||this.value!=="of"||this.containsEsc))return l=this.parseIdent(!1),(this.canInsertSemicolon()||!this.eat(S.arrow))&&this.unexpected(),this.parseArrowExpression(this.startNodeAt(n,a),[l],!0,e)}return l;case S.regexp:var c=this.value;return s=this.parseLiteral(c.value),s.regex={pattern:c.pattern,flags:c.flags},s;case S.num:case S.string:return this.parseLiteral(this.value);case S._null:case S._true:case S._false:return s=this.startNode(),s.value=this.type===S._null?null:this.type===S._true,s.raw=this.type.keyword,this.next(),this.finishNode(s,"Literal");case S.parenL:var h=this.start,d=this.parseParenAndDistinguishExpression(r,e);return t&&(t.parenthesizedAssign<0&&!this.isSimpleAssignTarget(d)&&(t.parenthesizedAssign=h),t.parenthesizedBind<0&&(t.parenthesizedBind=h)),d;case S.bracketL:return s=this.startNode(),this.next(),s.elements=this.parseExprList(S.bracketR,!0,!0,t),this.finishNode(s,"ArrayExpression");case S.braceL:return this.overrideContext(We.b_expr),this.parseObj(!1,t);case S._function:return s=this.startNode(),this.next(),this.parseFunction(s,0);case S._class:return this.parseClass(this.startNode(),!1);case S._new:return this.parseNew();case S.backQuote:return this.parseTemplate();case S._import:return this.options.ecmaVersion>=11?this.parseExprImport(i):this.unexpected();default:return this.parseExprAtomDefault()}};ue.parseExprAtomDefault=function(){this.unexpected()};ue.parseExprImport=function(t){var e=this.startNode();if(this.containsEsc&&this.raiseRecoverable(this.start,"Escape sequence in keyword import"),this.next(),this.type===S.parenL&&!t)return this.parseDynamicImport(e);if(this.type===S.dot){var i=this.startNodeAt(e.start,e.loc&&e.loc.start);return i.name="import",e.meta=this.finishNode(i,"Identifier"),this.parseImportMeta(e)}else this.unexpected()};ue.parseDynamicImport=function(t){if(this.next(),t.source=this.parseMaybeAssign(),this.options.ecmaVersion>=16)this.eat(S.parenR)?t.options=null:(this.expect(S.comma),this.afterTrailingComma(S.parenR)?t.options=null:(t.options=this.parseMaybeAssign(),this.eat(S.parenR)||(this.expect(S.comma),this.afterTrailingComma(S.parenR)||this.unexpected())));else if(!this.eat(S.parenR)){var e=this.start;this.eat(S.comma)&&this.eat(S.parenR)?this.raiseRecoverable(e,"Trailing comma is not allowed in import()"):this.unexpected(e)}return this.finishNode(t,"ImportExpression")};ue.parseImportMeta=function(t){this.next();var e=this.containsEsc;return t.property=this.parseIdent(!0),t.property.name!=="meta"&&this.raiseRecoverable(t.property.start,"The only valid meta property for import is 'import.meta'"),e&&this.raiseRecoverable(t.start,"'import.meta' must not contain escaped characters"),this.options.sourceType!=="module"&&!this.options.allowImportExportEverywhere&&this.raiseRecoverable(t.start,"Cannot use 'import.meta' outside a module"),this.finishNode(t,"MetaProperty")};ue.parseLiteral=function(t){var e=this.startNode();return e.value=t,e.raw=this.input.slice(this.start,this.end),e.raw.charCodeAt(e.raw.length-1)===110&&(e.bigint=e.value!=null?e.value.toString():e.raw.slice(0,-1).replace(/_/g,"")),this.next(),this.finishNode(e,"Literal")};ue.parseParenExpression=function(){this.expect(S.parenL);var t=this.parseExpression();return this.expect(S.parenR),t};ue.shouldParseArrow=function(t){return!this.canInsertSemicolon()};ue.parseParenAndDistinguishExpression=function(t,e){var i=this.start,s=this.startLoc,r,n=this.options.ecmaVersion>=8;if(this.options.ecmaVersion>=6){this.next();var a=this.start,o=this.startLoc,l=[],c=!0,h=!1,d=new $l,u=this.yieldPos,p=this.awaitPos,f;for(this.yieldPos=0,this.awaitPos=0;this.type!==S.parenR;)if(c?c=!1:this.expect(S.comma),n&&this.afterTrailingComma(S.parenR,!0)){h=!0;break}else if(this.type===S.ellipsis){f=this.start,l.push(this.parseParenItem(this.parseRestBinding())),this.type===S.comma&&this.raiseRecoverable(this.start,"Comma is not permitted after the rest element");break}else l.push(this.parseMaybeAssign(!1,d,this.parseParenItem));var g=this.lastTokEnd,m=this.lastTokEndLoc;if(this.expect(S.parenR),t&&this.shouldParseArrow(l)&&this.eat(S.arrow))return this.checkPatternErrors(d,!1),this.checkYieldAwaitInDefaultParams(),this.yieldPos=u,this.awaitPos=p,this.parseParenArrowList(i,s,l,e);(!l.length||h)&&this.unexpected(this.lastTokStart),f&&this.unexpected(f),this.checkExpressionErrors(d,!0),this.yieldPos=u||this.yieldPos,this.awaitPos=p||this.awaitPos,l.length>1?(r=this.startNodeAt(a,o),r.expressions=l,this.finishNodeAt(r,"SequenceExpression",g,m)):r=l[0]}else r=this.parseParenExpression();if(this.options.preserveParens){var y=this.startNodeAt(i,s);return y.expression=r,this.finishNode(y,"ParenthesizedExpression")}else return r};ue.parseParenItem=function(t){return t};ue.parseParenArrowList=function(t,e,i,s){return this.parseArrowExpression(this.startNodeAt(t,e),i,!1,s)};var NR=[];ue.parseNew=function(){this.containsEsc&&this.raiseRecoverable(this.start,"Escape sequence in keyword new");var t=this.startNode();if(this.next(),this.options.ecmaVersion>=6&&this.type===S.dot){var e=this.startNodeAt(t.start,t.loc&&t.loc.start);e.name="new",t.meta=this.finishNode(e,"Identifier"),this.next();var i=this.containsEsc;return t.property=this.parseIdent(!0),t.property.name!=="target"&&this.raiseRecoverable(t.property.start,"The only valid meta property for new is 'new.target'"),i&&this.raiseRecoverable(t.start,"'new.target' must not contain escaped characters"),this.allowNewDotTarget||this.raiseRecoverable(t.start,"'new.target' can only be used in functions and class static block"),this.finishNode(t,"MetaProperty")}var s=this.start,r=this.startLoc;return t.callee=this.parseSubscripts(this.parseExprAtom(null,!1,!0),s,r,!0,!1),this.eat(S.parenL)?t.arguments=this.parseExprList(S.parenR,this.options.ecmaVersion>=8,!1):t.arguments=NR,this.finishNode(t,"NewExpression")};ue.parseTemplateElement=function(t){var e=t.isTagged,i=this.startNode();return this.type===S.invalidTemplate?(e||this.raiseRecoverable(this.start,"Bad escape sequence in untagged template literal"),i.value={raw:this.value.replace(/\r\n?/g,`
`),cooked:null}):i.value={raw:this.input.slice(this.start,this.end).replace(/\r\n?/g,`
`),cooked:this.value},this.next(),i.tail=this.type===S.backQuote,this.finishNode(i,"TemplateElement")};ue.parseTemplate=function(t){t===void 0&&(t={});var e=t.isTagged;e===void 0&&(e=!1);var i=this.startNode();this.next(),i.expressions=[];var s=this.parseTemplateElement({isTagged:e});for(i.quasis=[s];!s.tail;)this.type===S.eof&&this.raise(this.pos,"Unterminated template literal"),this.expect(S.dollarBraceL),i.expressions.push(this.parseExpression()),this.expect(S.braceR),i.quasis.push(s=this.parseTemplateElement({isTagged:e}));return this.next(),this.finishNode(i,"TemplateLiteral")};ue.isAsyncProp=function(t){return!t.computed&&t.key.type==="Identifier"&&t.key.name==="async"&&(this.type===S.name||this.type===S.num||this.type===S.string||this.type===S.bracketL||this.type.keyword||this.options.ecmaVersion>=9&&this.type===S.star)&&!Nt.test(this.input.slice(this.lastTokEnd,this.start))};ue.parseObj=function(t,e){var i=this.startNode(),s=!0,r={};for(i.properties=[],this.next();!this.eat(S.braceR);){if(s)s=!1;else if(this.expect(S.comma),this.options.ecmaVersion>=5&&this.afterTrailingComma(S.braceR))break;var n=this.parseProperty(t,e);t||this.checkPropClash(n,r,e),i.properties.push(n)}return this.finishNode(i,t?"ObjectPattern":"ObjectExpression")};ue.parseProperty=function(t,e){var i=this.startNode(),s,r,n,a;if(this.options.ecmaVersion>=9&&this.eat(S.ellipsis))return t?(i.argument=this.parseIdent(!1),this.type===S.comma&&this.raiseRecoverable(this.start,"Comma is not permitted after the rest element"),this.finishNode(i,"RestElement")):(i.argument=this.parseMaybeAssign(!1,e),this.type===S.comma&&e&&e.trailingComma<0&&(e.trailingComma=this.start),this.finishNode(i,"SpreadElement"));this.options.ecmaVersion>=6&&(i.method=!1,i.shorthand=!1,(t||e)&&(n=this.start,a=this.startLoc),t||(s=this.eat(S.star)));var o=this.containsEsc;return this.parsePropertyName(i),!t&&!o&&this.options.ecmaVersion>=8&&!s&&this.isAsyncProp(i)?(r=!0,s=this.options.ecmaVersion>=9&&this.eat(S.star),this.parsePropertyName(i)):r=!1,this.parsePropertyValue(i,t,s,r,n,a,e,o),this.finishNode(i,"Property")};ue.parseGetterSetter=function(t){var e=t.key.name;this.parsePropertyName(t),t.value=this.parseMethod(!1),t.kind=e;var i=t.kind==="get"?0:1;if(t.value.params.length!==i){var s=t.value.start;t.kind==="get"?this.raiseRecoverable(s,"getter should have no params"):this.raiseRecoverable(s,"setter should have exactly one param")}else t.kind==="set"&&t.value.params[0].type==="RestElement"&&this.raiseRecoverable(t.value.params[0].start,"Setter cannot use rest params")};ue.parsePropertyValue=function(t,e,i,s,r,n,a,o){(i||s)&&this.type===S.colon&&this.unexpected(),this.eat(S.colon)?(t.value=e?this.parseMaybeDefault(this.start,this.startLoc):this.parseMaybeAssign(!1,a),t.kind="init"):this.options.ecmaVersion>=6&&this.type===S.parenL?(e&&this.unexpected(),t.method=!0,t.value=this.parseMethod(i,s),t.kind="init"):!e&&!o&&this.options.ecmaVersion>=5&&!t.computed&&t.key.type==="Identifier"&&(t.key.name==="get"||t.key.name==="set")&&this.type!==S.comma&&this.type!==S.braceR&&this.type!==S.eq?((i||s)&&this.unexpected(),this.parseGetterSetter(t)):this.options.ecmaVersion>=6&&!t.computed&&t.key.type==="Identifier"?((i||s)&&this.unexpected(),this.checkUnreserved(t.key),t.key.name==="await"&&!this.awaitIdentPos&&(this.awaitIdentPos=r),e?t.value=this.parseMaybeDefault(r,n,this.copyNode(t.key)):this.type===S.eq&&a?(a.shorthandAssign<0&&(a.shorthandAssign=this.start),t.value=this.parseMaybeDefault(r,n,this.copyNode(t.key))):t.value=this.copyNode(t.key),t.kind="init",t.shorthand=!0):this.unexpected()};ue.parsePropertyName=function(t){if(this.options.ecmaVersion>=6){if(this.eat(S.bracketL))return t.computed=!0,t.key=this.parseMaybeAssign(),this.expect(S.bracketR),t.key;t.computed=!1}return t.key=this.type===S.num||this.type===S.string?this.parseExprAtom():this.parseIdent(this.options.allowReserved!=="never")};ue.initFunction=function(t){t.id=null,this.options.ecmaVersion>=6&&(t.generator=t.expression=!1),this.options.ecmaVersion>=8&&(t.async=!1)};ue.parseMethod=function(t,e,i){var s=this.startNode(),r=this.yieldPos,n=this.awaitPos,a=this.awaitIdentPos;return this.initFunction(s),this.options.ecmaVersion>=6&&(s.generator=t),this.options.ecmaVersion>=8&&(s.async=!!e),this.yieldPos=0,this.awaitPos=0,this.awaitIdentPos=0,this.enterScope(Yd(e,s.generator)|_l|(i?a0:0)),this.expect(S.parenL),s.params=this.parseBindingList(S.parenR,!1,this.options.ecmaVersion>=8),this.checkYieldAwaitInDefaultParams(),this.parseFunctionBody(s,!1,!0,!1),this.yieldPos=r,this.awaitPos=n,this.awaitIdentPos=a,this.finishNode(s,"FunctionExpression")};ue.parseArrowExpression=function(t,e,i,s){var r=this.yieldPos,n=this.awaitPos,a=this.awaitIdentPos;return this.enterScope(Yd(i,!1)|Gd),this.initFunction(t),this.options.ecmaVersion>=8&&(t.async=!!i),this.yieldPos=0,this.awaitPos=0,this.awaitIdentPos=0,t.params=this.toAssignableList(e,!0),this.parseFunctionBody(t,!0,!1,s),this.yieldPos=r,this.awaitPos=n,this.awaitIdentPos=a,this.finishNode(t,"ArrowFunctionExpression")};ue.parseFunctionBody=function(t,e,i,s){var r=e&&this.type!==S.braceL,n=this.strict,a=!1;if(r)t.body=this.parseMaybeAssign(s),t.expression=!0,this.checkParams(t,!1);else{var o=this.options.ecmaVersion>=7&&!this.isSimpleParamList(t.params);(!n||o)&&(a=this.strictDirective(this.end),a&&o&&this.raiseRecoverable(t.start,"Illegal 'use strict' directive in function with non-simple parameter list"));var l=this.labels;this.labels=[],a&&(this.strict=!0),this.checkParams(t,!n&&!a&&!e&&!i&&this.isSimpleParamList(t.params)),this.strict&&t.id&&this.checkLValSimple(t.id,c0),t.body=this.parseBlock(!1,void 0,a&&!n),t.expression=!1,this.adaptDirectivePrologue(t.body.body),this.labels=l}this.exitScope()};ue.isSimpleParamList=function(t){for(var e=0,i=t;e<i.length;e+=1){var s=i[e];if(s.type!=="Identifier")return!1}return!0};ue.checkParams=function(t,e){for(var i=Object.create(null),s=0,r=t.params;s<r.length;s+=1){var n=r[s];this.checkLValInnerPattern(n,Zd,e?null:i)}};ue.parseExprList=function(t,e,i,s){for(var r=[],n=!0;!this.eat(t);){if(n)n=!1;else if(this.expect(S.comma),e&&this.afterTrailingComma(t))break;var a=void 0;i&&this.type===S.comma?a=null:this.type===S.ellipsis?(a=this.parseSpread(s),s&&this.type===S.comma&&s.trailingComma<0&&(s.trailingComma=this.start)):a=this.parseMaybeAssign(!1,s),r.push(a)}return r};ue.checkUnreserved=function(t){var e=t.start,i=t.end,s=t.name;if(this.inGenerator&&s==="yield"&&this.raiseRecoverable(e,"Cannot use 'yield' as identifier inside a generator"),this.inAsync&&s==="await"&&this.raiseRecoverable(e,"Cannot use 'await' as identifier inside an async function"),!(this.currentThisScope().flags&Rl)&&s==="arguments"&&this.raiseRecoverable(e,"Cannot use 'arguments' in class field initializer"),this.inClassStaticBlock&&(s==="arguments"||s==="await")&&this.raise(e,"Cannot use "+s+" in class static initialization block"),this.keywords.test(s)&&this.raise(e,"Unexpected keyword '"+s+"'"),!(this.options.ecmaVersion<6&&this.input.slice(e,i).indexOf("\\")!==-1)){var r=this.strict?this.reservedWordsStrict:this.reservedWords;r.test(s)&&(!this.inAsync&&s==="await"&&this.raiseRecoverable(e,"Cannot use keyword 'await' outside an async function"),this.raiseRecoverable(e,"The keyword '"+s+"' is reserved"))}};ue.parseIdent=function(t){var e=this.parseIdentNode();return this.next(!!t),this.finishNode(e,"Identifier"),t||(this.checkUnreserved(e),e.name==="await"&&!this.awaitIdentPos&&(this.awaitIdentPos=e.start)),e};ue.parseIdentNode=function(){var t=this.startNode();return this.type===S.name?t.name=this.value:this.type.keyword?(t.name=this.type.keyword,(t.name==="class"||t.name==="function")&&(this.lastTokEnd!==this.lastTokStart+1||this.input.charCodeAt(this.lastTokStart)!==46)&&this.context.pop(),this.type=S.name):this.unexpected(),t};ue.parsePrivateIdent=function(){var t=this.startNode();return this.type===S.privateId?t.name=this.value:this.unexpected(),this.next(),this.finishNode(t,"PrivateIdentifier"),this.options.checkPrivateFields&&(this.privateNameStack.length===0?this.raise(t.start,"Private field '#"+t.name+"' must be declared in an enclosing class"):this.privateNameStack[this.privateNameStack.length-1].used.push(t)),t};ue.parseYield=function(t){this.yieldPos||(this.yieldPos=this.start);var e=this.startNode();return this.next(),this.type===S.semi||this.canInsertSemicolon()||this.type!==S.star&&!this.type.startsExpr?(e.delegate=!1,e.argument=null):(e.delegate=this.eat(S.star),e.argument=this.parseMaybeAssign(t)),this.finishNode(e,"YieldExpression")};ue.parseAwait=function(t){this.awaitPos||(this.awaitPos=this.start);var e=this.startNode();return this.next(),e.argument=this.parseMaybeUnary(null,!0,!1,t),this.finishNode(e,"AwaitExpression")};var el=at.prototype;el.raise=function(t,e){var i=s0(this.input,t);e+=" ("+i.line+":"+i.column+")",this.sourceFile&&(e+=" in "+this.sourceFile);var s=new SyntaxError(e);throw s.pos=t,s.loc=i,s.raisedAt=this.pos,s};el.raiseRecoverable=el.raise;el.curPosition=function(){if(this.options.locations)return new ya(this.curLine,this.pos-this.lineStart)};var Rs=at.prototype,MR=function(e){this.flags=e,this.var=[],this.lexical=[],this.functions=[]};Rs.enterScope=function(t){this.scopeStack.push(new MR(t))};Rs.exitScope=function(){this.scopeStack.pop()};Rs.treatFunctionsAsVarInScope=function(t){return t.flags&pn||!this.inModule&&t.flags&va};Rs.declareName=function(t,e,i){var s=!1;if(e===os){var r=this.currentScope();s=r.lexical.indexOf(t)>-1||r.functions.indexOf(t)>-1||r.var.indexOf(t)>-1,r.lexical.push(t),this.inModule&&r.flags&va&&delete this.undefinedExports[t]}else if(e===l0){var n=this.currentScope();n.lexical.push(t)}else if(e===o0){var a=this.currentScope();this.treatFunctionsAsVar?s=a.lexical.indexOf(t)>-1:s=a.lexical.indexOf(t)>-1||a.var.indexOf(t)>-1,a.functions.push(t)}else for(var o=this.scopeStack.length-1;o>=0;--o){var l=this.scopeStack[o];if(l.lexical.indexOf(t)>-1&&!(l.flags&n0&&l.lexical[0]===t)||!this.treatFunctionsAsVarInScope(l)&&l.functions.indexOf(t)>-1){s=!0;break}if(l.var.push(t),this.inModule&&l.flags&va&&delete this.undefinedExports[t],l.flags&Rl)break}s&&this.raiseRecoverable(i,"Identifier '"+t+"' has already been declared")};Rs.checkLocalExport=function(t){this.scopeStack[0].lexical.indexOf(t.name)===-1&&this.scopeStack[0].var.indexOf(t.name)===-1&&(this.undefinedExports[t.name]=t)};Rs.currentScope=function(){return this.scopeStack[this.scopeStack.length-1]};Rs.currentVarScope=function(){for(var t=this.scopeStack.length-1;;t--){var e=this.scopeStack[t];if(e.flags&(Rl|Ra|dr))return e}};Rs.currentThisScope=function(){for(var t=this.scopeStack.length-1;;t--){var e=this.scopeStack[t];if(e.flags&(Rl|Ra|dr)&&!(e.flags&Gd))return e}};var Il=function(e,i,s){this.type="",this.start=i,this.end=0,e.options.locations&&(this.loc=new Cl(e,s)),e.options.directSourceFile&&(this.sourceFile=e.options.directSourceFile),e.options.ranges&&(this.range=[i,0])},$a=at.prototype;$a.startNode=function(){return new Il(this,this.start,this.startLoc)};$a.startNodeAt=function(t,e){return new Il(this,t,e)};function u0(t,e,i,s){return t.type=e,t.end=i,this.options.locations&&(t.loc.end=s),this.options.ranges&&(t.range[1]=i),t}$a.finishNode=function(t,e){return u0.call(this,t,e,this.lastTokEnd,this.lastTokEndLoc)};$a.finishNodeAt=function(t,e,i,s){return u0.call(this,t,e,i,s)};$a.copyNode=function(t){var e=new Il(this,t.start,this.startLoc);for(var i in t)e[i]=t[i];return e};var qR="Gara Garay Gukh Gurung_Khema Hrkt Katakana_Or_Hiragana Kawi Kirat_Rai Krai Nag_Mundari Nagm Ol_Onal Onao Sunu Sunuwar Todhri Todr Tulu_Tigalari Tutg Unknown Zzzz",p0="ASCII ASCII_Hex_Digit AHex Alphabetic Alpha Any Assigned Bidi_Control Bidi_C Bidi_Mirrored Bidi_M Case_Ignorable CI Cased Changes_When_Casefolded CWCF Changes_When_Casemapped CWCM Changes_When_Lowercased CWL Changes_When_NFKC_Casefolded CWKCF Changes_When_Titlecased CWT Changes_When_Uppercased CWU Dash Default_Ignorable_Code_Point DI Deprecated Dep Diacritic Dia Emoji Emoji_Component Emoji_Modifier Emoji_Modifier_Base Emoji_Presentation Extender Ext Grapheme_Base Gr_Base Grapheme_Extend Gr_Ext Hex_Digit Hex IDS_Binary_Operator IDSB IDS_Trinary_Operator IDST ID_Continue IDC ID_Start IDS Ideographic Ideo Join_Control Join_C Logical_Order_Exception LOE Lowercase Lower Math Noncharacter_Code_Point NChar Pattern_Syntax Pat_Syn Pattern_White_Space Pat_WS Quotation_Mark QMark Radical Regional_Indicator RI Sentence_Terminal STerm Soft_Dotted SD Terminal_Punctuation Term Unified_Ideograph UIdeo Uppercase Upper Variation_Selector VS White_Space space XID_Continue XIDC XID_Start XIDS",f0=p0+" Extended_Pictographic",g0=f0,m0=g0+" EBase EComp EMod EPres ExtPict",O0=m0,DR=O0,BR={9:p0,10:f0,11:g0,12:m0,13:O0,14:DR},jR="Basic_Emoji Emoji_Keycap_Sequence RGI_Emoji_Modifier_Sequence RGI_Emoji_Flag_Sequence RGI_Emoji_Tag_Sequence RGI_Emoji_ZWJ_Sequence RGI_Emoji",WR={9:"",10:"",11:"",12:"",13:"",14:jR},ig="Cased_Letter LC Close_Punctuation Pe Connector_Punctuation Pc Control Cc cntrl Currency_Symbol Sc Dash_Punctuation Pd Decimal_Number Nd digit Enclosing_Mark Me Final_Punctuation Pf Format Cf Initial_Punctuation Pi Letter L Letter_Number Nl Line_Separator Zl Lowercase_Letter Ll Mark M Combining_Mark Math_Symbol Sm Modifier_Letter Lm Modifier_Symbol Sk Nonspacing_Mark Mn Number N Open_Punctuation Ps Other C Other_Letter Lo Other_Number No Other_Punctuation Po Other_Symbol So Paragraph_Separator Zp Private_Use Co Punctuation P punct Separator Z Space_Separator Zs Spacing_Mark Mc Surrogate Cs Symbol S Titlecase_Letter Lt Unassigned Cn Uppercase_Letter Lu",y0="Adlam Adlm Ahom Anatolian_Hieroglyphs Hluw Arabic Arab Armenian Armn Avestan Avst Balinese Bali Bamum Bamu Bassa_Vah Bass Batak Batk Bengali Beng Bhaiksuki Bhks Bopomofo Bopo Brahmi Brah Braille Brai Buginese Bugi Buhid Buhd Canadian_Aboriginal Cans Carian Cari Caucasian_Albanian Aghb Chakma Cakm Cham Cham Cherokee Cher Common Zyyy Coptic Copt Qaac Cuneiform Xsux Cypriot Cprt Cyrillic Cyrl Deseret Dsrt Devanagari Deva Duployan Dupl Egyptian_Hieroglyphs Egyp Elbasan Elba Ethiopic Ethi Georgian Geor Glagolitic Glag Gothic Goth Grantha Gran Greek Grek Gujarati Gujr Gurmukhi Guru Han Hani Hangul Hang Hanunoo Hano Hatran Hatr Hebrew Hebr Hiragana Hira Imperial_Aramaic Armi Inherited Zinh Qaai Inscriptional_Pahlavi Phli Inscriptional_Parthian Prti Javanese Java Kaithi Kthi Kannada Knda Katakana Kana Kayah_Li Kali Kharoshthi Khar Khmer Khmr Khojki Khoj Khudawadi Sind Lao Laoo Latin Latn Lepcha Lepc Limbu Limb Linear_A Lina Linear_B Linb Lisu Lisu Lycian Lyci Lydian Lydi Mahajani Mahj Malayalam Mlym Mandaic Mand Manichaean Mani Marchen Marc Masaram_Gondi Gonm Meetei_Mayek Mtei Mende_Kikakui Mend Meroitic_Cursive Merc Meroitic_Hieroglyphs Mero Miao Plrd Modi Mongolian Mong Mro Mroo Multani Mult Myanmar Mymr Nabataean Nbat New_Tai_Lue Talu Newa Newa Nko Nkoo Nushu Nshu Ogham Ogam Ol_Chiki Olck Old_Hungarian Hung Old_Italic Ital Old_North_Arabian Narb Old_Permic Perm Old_Persian Xpeo Old_South_Arabian Sarb Old_Turkic Orkh Oriya Orya Osage Osge Osmanya Osma Pahawh_Hmong Hmng Palmyrene Palm Pau_Cin_Hau Pauc Phags_Pa Phag Phoenician Phnx Psalter_Pahlavi Phlp Rejang Rjng Runic Runr Samaritan Samr Saurashtra Saur Sharada Shrd Shavian Shaw Siddham Sidd SignWriting Sgnw Sinhala Sinh Sora_Sompeng Sora Soyombo Soyo Sundanese Sund Syloti_Nagri Sylo Syriac Syrc Tagalog Tglg Tagbanwa Tagb Tai_Le Tale Tai_Tham Lana Tai_Viet Tavt Takri Takr Tamil Taml Tangut Tang Telugu Telu Thaana Thaa Thai Thai Tibetan Tibt Tifinagh Tfng Tirhuta Tirh Ugaritic Ugar Vai Vaii Warang_Citi Wara Yi Yiii Zanabazar_Square Zanb",v0=y0+" Dogra Dogr Gunjala_Gondi Gong Hanifi_Rohingya Rohg Makasar Maka Medefaidrin Medf Old_Sogdian Sogo Sogdian Sogd",b0=v0+" Elymaic Elym Nandinagari Nand Nyiakeng_Puachue_Hmong Hmnp Wancho Wcho",w0=b0+" Chorasmian Chrs Diak Dives_Akuru Khitan_Small_Script Kits Yezi Yezidi",S0=w0+" Cypro_Minoan Cpmn Old_Uyghur Ougr Tangsa Tnsa Toto Vithkuqi Vith",FR=S0+" "+qR,UR={9:y0,10:v0,11:b0,12:w0,13:S0,14:FR},x0={};function VR(t){var e=x0[t]={binary:vs(BR[t]+" "+ig),binaryOfStrings:vs(WR[t]),nonBinary:{General_Category:vs(ig),Script:vs(UR[t])}};e.nonBinary.Script_Extensions=e.nonBinary.Script,e.nonBinary.gc=e.nonBinary.General_Category,e.nonBinary.sc=e.nonBinary.Script,e.nonBinary.scx=e.nonBinary.Script_Extensions}for(var Mc=0,sg=[9,10,11,12,13,14];Mc<sg.length;Mc+=1){var zR=sg[Mc];VR(zR)}var ee=at.prototype,tl=function(e,i){this.parent=e,this.base=i||this};tl.prototype.separatedFrom=function(e){for(var i=this;i;i=i.parent)for(var s=e;s;s=s.parent)if(i.base===s.base&&i!==s)return!0;return!1};tl.prototype.sibling=function(){return new tl(this.parent,this.base)};var Mi=function(e){this.parser=e,this.validFlags="gim"+(e.options.ecmaVersion>=6?"uy":"")+(e.options.ecmaVersion>=9?"s":"")+(e.options.ecmaVersion>=13?"d":"")+(e.options.ecmaVersion>=15?"v":""),this.unicodeProperties=x0[e.options.ecmaVersion>=14?14:e.options.ecmaVersion],this.source="",this.flags="",this.start=0,this.switchU=!1,this.switchV=!1,this.switchN=!1,this.pos=0,this.lastIntValue=0,this.lastStringValue="",this.lastAssertionIsQuantifiable=!1,this.numCapturingParens=0,this.maxBackReference=0,this.groupNames=Object.create(null),this.backReferenceNames=[],this.branchID=null};Mi.prototype.reset=function(e,i,s){var r=s.indexOf("v")!==-1,n=s.indexOf("u")!==-1;this.start=e|0,this.source=i+"",this.flags=s,r&&this.parser.options.ecmaVersion>=15?(this.switchU=!0,this.switchV=!0,this.switchN=!0):(this.switchU=n&&this.parser.options.ecmaVersion>=6,this.switchV=!1,this.switchN=n&&this.parser.options.ecmaVersion>=9)};Mi.prototype.raise=function(e){this.parser.raiseRecoverable(this.start,"Invalid regular expression: /"+this.source+"/: "+e)};Mi.prototype.at=function(e,i){i===void 0&&(i=!1);var s=this.source,r=s.length;if(e>=r)return-1;var n=s.charCodeAt(e);if(!(i||this.switchU)||n<=55295||n>=57344||e+1>=r)return n;var a=s.charCodeAt(e+1);return a>=56320&&a<=57343?(n<<10)+a-56613888:n};Mi.prototype.nextIndex=function(e,i){i===void 0&&(i=!1);var s=this.source,r=s.length;if(e>=r)return r;var n=s.charCodeAt(e),a;return!(i||this.switchU)||n<=55295||n>=57344||e+1>=r||(a=s.charCodeAt(e+1))<56320||a>57343?e+1:e+2};Mi.prototype.current=function(e){return e===void 0&&(e=!1),this.at(this.pos,e)};Mi.prototype.lookahead=function(e){return e===void 0&&(e=!1),this.at(this.nextIndex(this.pos,e),e)};Mi.prototype.advance=function(e){e===void 0&&(e=!1),this.pos=this.nextIndex(this.pos,e)};Mi.prototype.eat=function(e,i){return i===void 0&&(i=!1),this.current(i)===e?(this.advance(i),!0):!1};Mi.prototype.eatChars=function(e,i){i===void 0&&(i=!1);for(var s=this.pos,r=0,n=e;r<n.length;r+=1){var a=n[r],o=this.at(s,i);if(o===-1||o!==a)return!1;s=this.nextIndex(s,i)}return this.pos=s,!0};ee.validateRegExpFlags=function(t){for(var e=t.validFlags,i=t.flags,s=!1,r=!1,n=0;n<i.length;n++){var a=i.charAt(n);e.indexOf(a)===-1&&this.raise(t.start,"Invalid regular expression flag"),i.indexOf(a,n+1)>-1&&this.raise(t.start,"Duplicate regular expression flag"),a==="u"&&(s=!0),a==="v"&&(r=!0)}this.options.ecmaVersion>=15&&s&&r&&this.raise(t.start,"Invalid regular expression flag")};function XR(t){for(var e in t)return!0;return!1}ee.validateRegExpPattern=function(t){this.regexp_pattern(t),!t.switchN&&this.options.ecmaVersion>=9&&XR(t.groupNames)&&(t.switchN=!0,this.regexp_pattern(t))};ee.regexp_pattern=function(t){t.pos=0,t.lastIntValue=0,t.lastStringValue="",t.lastAssertionIsQuantifiable=!1,t.numCapturingParens=0,t.maxBackReference=0,t.groupNames=Object.create(null),t.backReferenceNames.length=0,t.branchID=null,this.regexp_disjunction(t),t.pos!==t.source.length&&(t.eat(41)&&t.raise("Unmatched ')'"),(t.eat(93)||t.eat(125))&&t.raise("Lone quantifier brackets")),t.maxBackReference>t.numCapturingParens&&t.raise("Invalid escape");for(var e=0,i=t.backReferenceNames;e<i.length;e+=1){var s=i[e];t.groupNames[s]||t.raise("Invalid named capture referenced")}};ee.regexp_disjunction=function(t){var e=this.options.ecmaVersion>=16;for(e&&(t.branchID=new tl(t.branchID,null)),this.regexp_alternative(t);t.eat(124);)e&&(t.branchID=t.branchID.sibling()),this.regexp_alternative(t);e&&(t.branchID=t.branchID.parent),this.regexp_eatQuantifier(t,!0)&&t.raise("Nothing to repeat"),t.eat(123)&&t.raise("Lone quantifier brackets")};ee.regexp_alternative=function(t){for(;t.pos<t.source.length&&this.regexp_eatTerm(t););};ee.regexp_eatTerm=function(t){return this.regexp_eatAssertion(t)?(t.lastAssertionIsQuantifiable&&this.regexp_eatQuantifier(t)&&t.switchU&&t.raise("Invalid quantifier"),!0):(t.switchU?this.regexp_eatAtom(t):this.regexp_eatExtendedAtom(t))?(this.regexp_eatQuantifier(t),!0):!1};ee.regexp_eatAssertion=function(t){var e=t.pos;if(t.lastAssertionIsQuantifiable=!1,t.eat(94)||t.eat(36))return!0;if(t.eat(92)){if(t.eat(66)||t.eat(98))return!0;t.pos=e}if(t.eat(40)&&t.eat(63)){var i=!1;if(this.options.ecmaVersion>=9&&(i=t.eat(60)),t.eat(61)||t.eat(33))return this.regexp_disjunction(t),t.eat(41)||t.raise("Unterminated group"),t.lastAssertionIsQuantifiable=!i,!0}return t.pos=e,!1};ee.regexp_eatQuantifier=function(t,e){return e===void 0&&(e=!1),this.regexp_eatQuantifierPrefix(t,e)?(t.eat(63),!0):!1};ee.regexp_eatQuantifierPrefix=function(t,e){return t.eat(42)||t.eat(43)||t.eat(63)||this.regexp_eatBracedQuantifier(t,e)};ee.regexp_eatBracedQuantifier=function(t,e){var i=t.pos;if(t.eat(123)){var s=0,r=-1;if(this.regexp_eatDecimalDigits(t)&&(s=t.lastIntValue,t.eat(44)&&this.regexp_eatDecimalDigits(t)&&(r=t.lastIntValue),t.eat(125)))return r!==-1&&r<s&&!e&&t.raise("numbers out of order in {} quantifier"),!0;t.switchU&&!e&&t.raise("Incomplete quantifier"),t.pos=i}return!1};ee.regexp_eatAtom=function(t){return this.regexp_eatPatternCharacters(t)||t.eat(46)||this.regexp_eatReverseSolidusAtomEscape(t)||this.regexp_eatCharacterClass(t)||this.regexp_eatUncapturingGroup(t)||this.regexp_eatCapturingGroup(t)};ee.regexp_eatReverseSolidusAtomEscape=function(t){var e=t.pos;if(t.eat(92)){if(this.regexp_eatAtomEscape(t))return!0;t.pos=e}return!1};ee.regexp_eatUncapturingGroup=function(t){var e=t.pos;if(t.eat(40)){if(t.eat(63)){if(this.options.ecmaVersion>=16){var i=this.regexp_eatModifiers(t),s=t.eat(45);if(i||s){for(var r=0;r<i.length;r++){var n=i.charAt(r);i.indexOf(n,r+1)>-1&&t.raise("Duplicate regular expression modifiers")}if(s){var a=this.regexp_eatModifiers(t);!i&&!a&&t.current()===58&&t.raise("Invalid regular expression modifiers");for(var o=0;o<a.length;o++){var l=a.charAt(o);(a.indexOf(l,o+1)>-1||i.indexOf(l)>-1)&&t.raise("Duplicate regular expression modifiers")}}}}if(t.eat(58)){if(this.regexp_disjunction(t),t.eat(41))return!0;t.raise("Unterminated group")}}t.pos=e}return!1};ee.regexp_eatCapturingGroup=function(t){if(t.eat(40)){if(this.options.ecmaVersion>=9?this.regexp_groupSpecifier(t):t.current()===63&&t.raise("Invalid group"),this.regexp_disjunction(t),t.eat(41))return t.numCapturingParens+=1,!0;t.raise("Unterminated group")}return!1};ee.regexp_eatModifiers=function(t){for(var e="",i=0;(i=t.current())!==-1&&GR(i);)e+=is(i),t.advance();return e};function GR(t){return t===105||t===109||t===115}ee.regexp_eatExtendedAtom=function(t){return t.eat(46)||this.regexp_eatReverseSolidusAtomEscape(t)||this.regexp_eatCharacterClass(t)||this.regexp_eatUncapturingGroup(t)||this.regexp_eatCapturingGroup(t)||this.regexp_eatInvalidBracedQuantifier(t)||this.regexp_eatExtendedPatternCharacter(t)};ee.regexp_eatInvalidBracedQuantifier=function(t){return this.regexp_eatBracedQuantifier(t,!0)&&t.raise("Nothing to repeat"),!1};ee.regexp_eatSyntaxCharacter=function(t){var e=t.current();return k0(e)?(t.lastIntValue=e,t.advance(),!0):!1};function k0(t){return t===36||t>=40&&t<=43||t===46||t===63||t>=91&&t<=94||t>=123&&t<=125}ee.regexp_eatPatternCharacters=function(t){for(var e=t.pos,i=0;(i=t.current())!==-1&&!k0(i);)t.advance();return t.pos!==e};ee.regexp_eatExtendedPatternCharacter=function(t){var e=t.current();return e!==-1&&e!==36&&!(e>=40&&e<=43)&&e!==46&&e!==63&&e!==91&&e!==94&&e!==124?(t.advance(),!0):!1};ee.regexp_groupSpecifier=function(t){if(t.eat(63)){this.regexp_eatGroupName(t)||t.raise("Invalid group");var e=this.options.ecmaVersion>=16,i=t.groupNames[t.lastStringValue];if(i)if(e)for(var s=0,r=i;s<r.length;s+=1){var n=r[s];n.separatedFrom(t.branchID)||t.raise("Duplicate capture group name")}else t.raise("Duplicate capture group name");e?(i||(t.groupNames[t.lastStringValue]=[])).push(t.branchID):t.groupNames[t.lastStringValue]=!0}};ee.regexp_eatGroupName=function(t){if(t.lastStringValue="",t.eat(60)){if(this.regexp_eatRegExpIdentifierName(t)&&t.eat(62))return!0;t.raise("Invalid capture group name")}return!1};ee.regexp_eatRegExpIdentifierName=function(t){if(t.lastStringValue="",this.regexp_eatRegExpIdentifierStart(t)){for(t.lastStringValue+=is(t.lastIntValue);this.regexp_eatRegExpIdentifierPart(t);)t.lastStringValue+=is(t.lastIntValue);return!0}return!1};ee.regexp_eatRegExpIdentifierStart=function(t){var e=t.pos,i=this.options.ecmaVersion>=11,s=t.current(i);return t.advance(i),s===92&&this.regexp_eatRegExpUnicodeEscapeSequence(t,i)&&(s=t.lastIntValue),YR(s)?(t.lastIntValue=s,!0):(t.pos=e,!1)};function YR(t){return Ai(t,!0)||t===36||t===95}ee.regexp_eatRegExpIdentifierPart=function(t){var e=t.pos,i=this.options.ecmaVersion>=11,s=t.current(i);return t.advance(i),s===92&&this.regexp_eatRegExpUnicodeEscapeSequence(t,i)&&(s=t.lastIntValue),ZR(s)?(t.lastIntValue=s,!0):(t.pos=e,!1)};function ZR(t){return Cs(t,!0)||t===36||t===95||t===8204||t===8205}ee.regexp_eatAtomEscape=function(t){return this.regexp_eatBackReference(t)||this.regexp_eatCharacterClassEscape(t)||this.regexp_eatCharacterEscape(t)||t.switchN&&this.regexp_eatKGroupName(t)?!0:(t.switchU&&(t.current()===99&&t.raise("Invalid unicode escape"),t.raise("Invalid escape")),!1)};ee.regexp_eatBackReference=function(t){var e=t.pos;if(this.regexp_eatDecimalEscape(t)){var i=t.lastIntValue;if(t.switchU)return i>t.maxBackReference&&(t.maxBackReference=i),!0;if(i<=t.numCapturingParens)return!0;t.pos=e}return!1};ee.regexp_eatKGroupName=function(t){if(t.eat(107)){if(this.regexp_eatGroupName(t))return t.backReferenceNames.push(t.lastStringValue),!0;t.raise("Invalid named reference")}return!1};ee.regexp_eatCharacterEscape=function(t){return this.regexp_eatControlEscape(t)||this.regexp_eatCControlLetter(t)||this.regexp_eatZero(t)||this.regexp_eatHexEscapeSequence(t)||this.regexp_eatRegExpUnicodeEscapeSequence(t,!1)||!t.switchU&&this.regexp_eatLegacyOctalEscapeSequence(t)||this.regexp_eatIdentityEscape(t)};ee.regexp_eatCControlLetter=function(t){var e=t.pos;if(t.eat(99)){if(this.regexp_eatControlLetter(t))return!0;t.pos=e}return!1};ee.regexp_eatZero=function(t){return t.current()===48&&!Ql(t.lookahead())?(t.lastIntValue=0,t.advance(),!0):!1};ee.regexp_eatControlEscape=function(t){var e=t.current();return e===116?(t.lastIntValue=9,t.advance(),!0):e===110?(t.lastIntValue=10,t.advance(),!0):e===118?(t.lastIntValue=11,t.advance(),!0):e===102?(t.lastIntValue=12,t.advance(),!0):e===114?(t.lastIntValue=13,t.advance(),!0):!1};ee.regexp_eatControlLetter=function(t){var e=t.current();return T0(e)?(t.lastIntValue=e%32,t.advance(),!0):!1};function T0(t){return t>=65&&t<=90||t>=97&&t<=122}ee.regexp_eatRegExpUnicodeEscapeSequence=function(t,e){e===void 0&&(e=!1);var i=t.pos,s=e||t.switchU;if(t.eat(117)){if(this.regexp_eatFixedHexDigits(t,4)){var r=t.lastIntValue;if(s&&r>=55296&&r<=56319){var n=t.pos;if(t.eat(92)&&t.eat(117)&&this.regexp_eatFixedHexDigits(t,4)){var a=t.lastIntValue;if(a>=56320&&a<=57343)return t.lastIntValue=(r-55296)*1024+(a-56320)+65536,!0}t.pos=n,t.lastIntValue=r}return!0}if(s&&t.eat(123)&&this.regexp_eatHexDigits(t)&&t.eat(125)&&HR(t.lastIntValue))return!0;s&&t.raise("Invalid unicode escape"),t.pos=i}return!1};function HR(t){return t>=0&&t<=1114111}ee.regexp_eatIdentityEscape=function(t){if(t.switchU)return this.regexp_eatSyntaxCharacter(t)?!0:t.eat(47)?(t.lastIntValue=47,!0):!1;var e=t.current();return e!==99&&(!t.switchN||e!==107)?(t.lastIntValue=e,t.advance(),!0):!1};ee.regexp_eatDecimalEscape=function(t){t.lastIntValue=0;var e=t.current();if(e>=49&&e<=57){do t.lastIntValue=10*t.lastIntValue+(e-48),t.advance();while((e=t.current())>=48&&e<=57);return!0}return!1};var E0=0,ss=1,Jt=2;ee.regexp_eatCharacterClassEscape=function(t){var e=t.current();if(KR(e))return t.lastIntValue=-1,t.advance(),ss;var i=!1;if(t.switchU&&this.options.ecmaVersion>=9&&((i=e===80)||e===112)){t.lastIntValue=-1,t.advance();var s;if(t.eat(123)&&(s=this.regexp_eatUnicodePropertyValueExpression(t))&&t.eat(125))return i&&s===Jt&&t.raise("Invalid property name"),s;t.raise("Invalid property name")}return E0};function KR(t){return t===100||t===68||t===115||t===83||t===119||t===87}ee.regexp_eatUnicodePropertyValueExpression=function(t){var e=t.pos;if(this.regexp_eatUnicodePropertyName(t)&&t.eat(61)){var i=t.lastStringValue;if(this.regexp_eatUnicodePropertyValue(t)){var s=t.lastStringValue;return this.regexp_validateUnicodePropertyNameAndValue(t,i,s),ss}}if(t.pos=e,this.regexp_eatLoneUnicodePropertyNameOrValue(t)){var r=t.lastStringValue;return this.regexp_validateUnicodePropertyNameOrValue(t,r)}return E0};ee.regexp_validateUnicodePropertyNameAndValue=function(t,e,i){un(t.unicodeProperties.nonBinary,e)||t.raise("Invalid property name"),t.unicodeProperties.nonBinary[e].test(i)||t.raise("Invalid property value")};ee.regexp_validateUnicodePropertyNameOrValue=function(t,e){if(t.unicodeProperties.binary.test(e))return ss;if(t.switchV&&t.unicodeProperties.binaryOfStrings.test(e))return Jt;t.raise("Invalid property name")};ee.regexp_eatUnicodePropertyName=function(t){var e=0;for(t.lastStringValue="";P0(e=t.current());)t.lastStringValue+=is(e),t.advance();return t.lastStringValue!==""};function P0(t){return T0(t)||t===95}ee.regexp_eatUnicodePropertyValue=function(t){var e=0;for(t.lastStringValue="";JR(e=t.current());)t.lastStringValue+=is(e),t.advance();return t.lastStringValue!==""};function JR(t){return P0(t)||Ql(t)}ee.regexp_eatLoneUnicodePropertyNameOrValue=function(t){return this.regexp_eatUnicodePropertyValue(t)};ee.regexp_eatCharacterClass=function(t){if(t.eat(91)){var e=t.eat(94),i=this.regexp_classContents(t);return t.eat(93)||t.raise("Unterminated character class"),e&&i===Jt&&t.raise("Negated character class may contain strings"),!0}return!1};ee.regexp_classContents=function(t){return t.current()===93?ss:t.switchV?this.regexp_classSetExpression(t):(this.regexp_nonEmptyClassRanges(t),ss)};ee.regexp_nonEmptyClassRanges=function(t){for(;this.regexp_eatClassAtom(t);){var e=t.lastIntValue;if(t.eat(45)&&this.regexp_eatClassAtom(t)){var i=t.lastIntValue;t.switchU&&(e===-1||i===-1)&&t.raise("Invalid character class"),e!==-1&&i!==-1&&e>i&&t.raise("Range out of order in character class")}}};ee.regexp_eatClassAtom=function(t){var e=t.pos;if(t.eat(92)){if(this.regexp_eatClassEscape(t))return!0;if(t.switchU){var i=t.current();(i===99||R0(i))&&t.raise("Invalid class escape"),t.raise("Invalid escape")}t.pos=e}var s=t.current();return s!==93?(t.lastIntValue=s,t.advance(),!0):!1};ee.regexp_eatClassEscape=function(t){var e=t.pos;if(t.eat(98))return t.lastIntValue=8,!0;if(t.switchU&&t.eat(45))return t.lastIntValue=45,!0;if(!t.switchU&&t.eat(99)){if(this.regexp_eatClassControlLetter(t))return!0;t.pos=e}return this.regexp_eatCharacterClassEscape(t)||this.regexp_eatCharacterEscape(t)};ee.regexp_classSetExpression=function(t){var e=ss,i;if(!this.regexp_eatClassSetRange(t))if(i=this.regexp_eatClassSetOperand(t)){i===Jt&&(e=Jt);for(var s=t.pos;t.eatChars([38,38]);){if(t.current()!==38&&(i=this.regexp_eatClassSetOperand(t))){i!==Jt&&(e=ss);continue}t.raise("Invalid character in character class")}if(s!==t.pos)return e;for(;t.eatChars([45,45]);)this.regexp_eatClassSetOperand(t)||t.raise("Invalid character in character class");if(s!==t.pos)return e}else t.raise("Invalid character in character class");for(;;)if(!this.regexp_eatClassSetRange(t)){if(i=this.regexp_eatClassSetOperand(t),!i)return e;i===Jt&&(e=Jt)}};ee.regexp_eatClassSetRange=function(t){var e=t.pos;if(this.regexp_eatClassSetCharacter(t)){var i=t.lastIntValue;if(t.eat(45)&&this.regexp_eatClassSetCharacter(t)){var s=t.lastIntValue;return i!==-1&&s!==-1&&i>s&&t.raise("Range out of order in character class"),!0}t.pos=e}return!1};ee.regexp_eatClassSetOperand=function(t){return this.regexp_eatClassSetCharacter(t)?ss:this.regexp_eatClassStringDisjunction(t)||this.regexp_eatNestedClass(t)};ee.regexp_eatNestedClass=function(t){var e=t.pos;if(t.eat(91)){var i=t.eat(94),s=this.regexp_classContents(t);if(t.eat(93))return i&&s===Jt&&t.raise("Negated character class may contain strings"),s;t.pos=e}if(t.eat(92)){var r=this.regexp_eatCharacterClassEscape(t);if(r)return r;t.pos=e}return null};ee.regexp_eatClassStringDisjunction=function(t){var e=t.pos;if(t.eatChars([92,113])){if(t.eat(123)){var i=this.regexp_classStringDisjunctionContents(t);if(t.eat(125))return i}else t.raise("Invalid escape");t.pos=e}return null};ee.regexp_classStringDisjunctionContents=function(t){for(var e=this.regexp_classString(t);t.eat(124);)this.regexp_classString(t)===Jt&&(e=Jt);return e};ee.regexp_classString=function(t){for(var e=0;this.regexp_eatClassSetCharacter(t);)e++;return e===1?ss:Jt};ee.regexp_eatClassSetCharacter=function(t){var e=t.pos;if(t.eat(92))return this.regexp_eatCharacterEscape(t)||this.regexp_eatClassSetReservedPunctuator(t)?!0:t.eat(98)?(t.lastIntValue=8,!0):(t.pos=e,!1);var i=t.current();return i<0||i===t.lookahead()&&e2(i)||t2(i)?!1:(t.advance(),t.lastIntValue=i,!0)};function e2(t){return t===33||t>=35&&t<=38||t>=42&&t<=44||t===46||t>=58&&t<=64||t===94||t===96||t===126}function t2(t){return t===40||t===41||t===45||t===47||t>=91&&t<=93||t>=123&&t<=125}ee.regexp_eatClassSetReservedPunctuator=function(t){var e=t.current();return i2(e)?(t.lastIntValue=e,t.advance(),!0):!1};function i2(t){return t===33||t===35||t===37||t===38||t===44||t===45||t>=58&&t<=62||t===64||t===96||t===126}ee.regexp_eatClassControlLetter=function(t){var e=t.current();return Ql(e)||e===95?(t.lastIntValue=e%32,t.advance(),!0):!1};ee.regexp_eatHexEscapeSequence=function(t){var e=t.pos;if(t.eat(120)){if(this.regexp_eatFixedHexDigits(t,2))return!0;t.switchU&&t.raise("Invalid escape"),t.pos=e}return!1};ee.regexp_eatDecimalDigits=function(t){var e=t.pos,i=0;for(t.lastIntValue=0;Ql(i=t.current());)t.lastIntValue=10*t.lastIntValue+(i-48),t.advance();return t.pos!==e};function Ql(t){return t>=48&&t<=57}ee.regexp_eatHexDigits=function(t){var e=t.pos,i=0;for(t.lastIntValue=0;C0(i=t.current());)t.lastIntValue=16*t.lastIntValue+_0(i),t.advance();return t.pos!==e};function C0(t){return t>=48&&t<=57||t>=65&&t<=70||t>=97&&t<=102}function _0(t){return t>=65&&t<=70?10+(t-65):t>=97&&t<=102?10+(t-97):t-48}ee.regexp_eatLegacyOctalEscapeSequence=function(t){if(this.regexp_eatOctalDigit(t)){var e=t.lastIntValue;if(this.regexp_eatOctalDigit(t)){var i=t.lastIntValue;e<=3&&this.regexp_eatOctalDigit(t)?t.lastIntValue=e*64+i*8+t.lastIntValue:t.lastIntValue=e*8+i}else t.lastIntValue=e;return!0}return!1};ee.regexp_eatOctalDigit=function(t){var e=t.current();return R0(e)?(t.lastIntValue=e-48,t.advance(),!0):(t.lastIntValue=0,!1)};function R0(t){return t>=48&&t<=55}ee.regexp_eatFixedHexDigits=function(t,e){var i=t.pos;t.lastIntValue=0;for(var s=0;s<e;++s){var r=t.current();if(!C0(r))return t.pos=i,!1;t.lastIntValue=16*t.lastIntValue+_0(r),t.advance()}return!0};var Kd=function(e){this.type=e.type,this.value=e.value,this.start=e.start,this.end=e.end,e.options.locations&&(this.loc=new Cl(e,e.startLoc,e.endLoc)),e.options.ranges&&(this.range=[e.start,e.end])},xe=at.prototype;xe.next=function(t){!t&&this.type.keyword&&this.containsEsc&&this.raiseRecoverable(this.start,"Escape sequence in keyword "+this.type.keyword),this.options.onToken&&this.options.onToken(new Kd(this)),this.lastTokEnd=this.end,this.lastTokStart=this.start,this.lastTokEndLoc=this.endLoc,this.lastTokStartLoc=this.startLoc,this.nextToken()};xe.getToken=function(){return this.next(),new Kd(this)};typeof Symbol<"u"&&(xe[Symbol.iterator]=function(){var t=this;return{next:function(){var e=t.getToken();return{done:e.type===S.eof,value:e}}}});xe.nextToken=function(){var t=this.curContext();if((!t||!t.preserveSpace)&&this.skipSpace(),this.start=this.pos,this.options.locations&&(this.startLoc=this.curPosition()),this.pos>=this.input.length)return this.finishToken(S.eof);if(t.override)return t.override(this);this.readToken(this.fullCharCodeAtPos())};xe.readToken=function(t){return Ai(t,this.options.ecmaVersion>=6)||t===92?this.readWord():this.getTokenFromCode(t)};xe.fullCharCodeAtPos=function(){var t=this.input.charCodeAt(this.pos);if(t<=55295||t>=56320)return t;var e=this.input.charCodeAt(this.pos+1);return e<=56319||e>=57344?t:(t<<10)+e-56613888};xe.skipBlockComment=function(){var t=this.options.onComment&&this.curPosition(),e=this.pos,i=this.input.indexOf("*/",this.pos+=2);if(i===-1&&this.raise(this.pos-2,"Unterminated comment"),this.pos=i+2,this.options.locations)for(var s=void 0,r=e;(s=e0(this.input,r,this.pos))>-1;)++this.curLine,r=this.lineStart=s;this.options.onComment&&this.options.onComment(!0,this.input.slice(e+2,i),e,this.pos,t,this.curPosition())};xe.skipLineComment=function(t){for(var e=this.pos,i=this.options.onComment&&this.curPosition(),s=this.input.charCodeAt(this.pos+=t);this.pos<this.input.length&&!dn(s);)s=this.input.charCodeAt(++this.pos);this.options.onComment&&this.options.onComment(!1,this.input.slice(e+t,this.pos),e,this.pos,i,this.curPosition())};xe.skipSpace=function(){e:for(;this.pos<this.input.length;){var t=this.input.charCodeAt(this.pos);switch(t){case 32:case 160:++this.pos;break;case 13:this.input.charCodeAt(this.pos+1)===10&&++this.pos;case 10:case 8232:case 8233:++this.pos,this.options.locations&&(++this.curLine,this.lineStart=this.pos);break;case 47:switch(this.input.charCodeAt(this.pos+1)){case 42:this.skipBlockComment();break;case 47:this.skipLineComment(2);break;default:break e}break;default:if(t>8&&t<14||t>=5760&&t0.test(String.fromCharCode(t)))++this.pos;else break e}}};xe.finishToken=function(t,e){this.end=this.pos,this.options.locations&&(this.endLoc=this.curPosition());var i=this.type;this.type=t,this.value=e,this.updateContext(i)};xe.readToken_dot=function(){var t=this.input.charCodeAt(this.pos+1);if(t>=48&&t<=57)return this.readNumber(!0);var e=this.input.charCodeAt(this.pos+2);return this.options.ecmaVersion>=6&&t===46&&e===46?(this.pos+=3,this.finishToken(S.ellipsis)):(++this.pos,this.finishToken(S.dot))};xe.readToken_slash=function(){var t=this.input.charCodeAt(this.pos+1);return this.exprAllowed?(++this.pos,this.readRegexp()):t===61?this.finishOp(S.assign,2):this.finishOp(S.slash,1)};xe.readToken_mult_modulo_exp=function(t){var e=this.input.charCodeAt(this.pos+1),i=1,s=t===42?S.star:S.modulo;return this.options.ecmaVersion>=7&&t===42&&e===42&&(++i,s=S.starstar,e=this.input.charCodeAt(this.pos+2)),e===61?this.finishOp(S.assign,i+1):this.finishOp(s,i)};xe.readToken_pipe_amp=function(t){var e=this.input.charCodeAt(this.pos+1);if(e===t){if(this.options.ecmaVersion>=12){var i=this.input.charCodeAt(this.pos+2);if(i===61)return this.finishOp(S.assign,3)}return this.finishOp(t===124?S.logicalOR:S.logicalAND,2)}return e===61?this.finishOp(S.assign,2):this.finishOp(t===124?S.bitwiseOR:S.bitwiseAND,1)};xe.readToken_caret=function(){var t=this.input.charCodeAt(this.pos+1);return t===61?this.finishOp(S.assign,2):this.finishOp(S.bitwiseXOR,1)};xe.readToken_plus_min=function(t){var e=this.input.charCodeAt(this.pos+1);return e===t?e===45&&!this.inModule&&this.input.charCodeAt(this.pos+2)===62&&(this.lastTokEnd===0||Nt.test(this.input.slice(this.lastTokEnd,this.pos)))?(this.skipLineComment(3),this.skipSpace(),this.nextToken()):this.finishOp(S.incDec,2):e===61?this.finishOp(S.assign,2):this.finishOp(S.plusMin,1)};xe.readToken_lt_gt=function(t){var e=this.input.charCodeAt(this.pos+1),i=1;return e===t?(i=t===62&&this.input.charCodeAt(this.pos+2)===62?3:2,this.input.charCodeAt(this.pos+i)===61?this.finishOp(S.assign,i+1):this.finishOp(S.bitShift,i)):e===33&&t===60&&!this.inModule&&this.input.charCodeAt(this.pos+2)===45&&this.input.charCodeAt(this.pos+3)===45?(this.skipLineComment(4),this.skipSpace(),this.nextToken()):(e===61&&(i=2),this.finishOp(S.relational,i))};xe.readToken_eq_excl=function(t){var e=this.input.charCodeAt(this.pos+1);return e===61?this.finishOp(S.equality,this.input.charCodeAt(this.pos+2)===61?3:2):t===61&&e===62&&this.options.ecmaVersion>=6?(this.pos+=2,this.finishToken(S.arrow)):this.finishOp(t===61?S.eq:S.prefix,1)};xe.readToken_question=function(){var t=this.options.ecmaVersion;if(t>=11){var e=this.input.charCodeAt(this.pos+1);if(e===46){var i=this.input.charCodeAt(this.pos+2);if(i<48||i>57)return this.finishOp(S.questionDot,2)}if(e===63){if(t>=12){var s=this.input.charCodeAt(this.pos+2);if(s===61)return this.finishOp(S.assign,3)}return this.finishOp(S.coalesce,2)}}return this.finishOp(S.question,1)};xe.readToken_numberSign=function(){var t=this.options.ecmaVersion,e=35;if(t>=13&&(++this.pos,e=this.fullCharCodeAtPos(),Ai(e,!0)||e===92))return this.finishToken(S.privateId,this.readWord1());this.raise(this.pos,"Unexpected character '"+is(e)+"'")};xe.getTokenFromCode=function(t){switch(t){case 46:return this.readToken_dot();case 40:return++this.pos,this.finishToken(S.parenL);case 41:return++this.pos,this.finishToken(S.parenR);case 59:return++this.pos,this.finishToken(S.semi);case 44:return++this.pos,this.finishToken(S.comma);case 91:return++this.pos,this.finishToken(S.bracketL);case 93:return++this.pos,this.finishToken(S.bracketR);case 123:return++this.pos,this.finishToken(S.braceL);case 125:return++this.pos,this.finishToken(S.braceR);case 58:return++this.pos,this.finishToken(S.colon);case 96:if(this.options.ecmaVersion<6)break;return++this.pos,this.finishToken(S.backQuote);case 48:var e=this.input.charCodeAt(this.pos+1);if(e===120||e===88)return this.readRadixNumber(16);if(this.options.ecmaVersion>=6){if(e===111||e===79)return this.readRadixNumber(8);if(e===98||e===66)return this.readRadixNumber(2)}case 49:case 50:case 51:case 52:case 53:case 54:case 55:case 56:case 57:return this.readNumber(!1);case 34:case 39:return this.readString(t);case 47:return this.readToken_slash();case 37:case 42:return this.readToken_mult_modulo_exp(t);case 124:case 38:return this.readToken_pipe_amp(t);case 94:return this.readToken_caret();case 43:case 45:return this.readToken_plus_min(t);case 60:case 62:return this.readToken_lt_gt(t);case 61:case 33:return this.readToken_eq_excl(t);case 63:return this.readToken_question();case 126:return this.finishOp(S.prefix,1);case 35:return this.readToken_numberSign()}this.raise(this.pos,"Unexpected character '"+is(t)+"'")};xe.finishOp=function(t,e){var i=this.input.slice(this.pos,this.pos+e);return this.pos+=e,this.finishToken(t,i)};xe.readRegexp=function(){for(var t,e,i=this.pos;;){this.pos>=this.input.length&&this.raise(i,"Unterminated regular expression");var s=this.input.charAt(this.pos);if(Nt.test(s)&&this.raise(i,"Unterminated regular expression"),t)t=!1;else{if(s==="[")e=!0;else if(s==="]"&&e)e=!1;else if(s==="/"&&!e)break;t=s==="\\"}++this.pos}var r=this.input.slice(i,this.pos);++this.pos;var n=this.pos,a=this.readWord1();this.containsEsc&&this.unexpected(n);var o=this.regexpState||(this.regexpState=new Mi(this));o.reset(i,r,a),this.validateRegExpFlags(o),this.validateRegExpPattern(o);var l=null;try{l=new RegExp(r,a)}catch{}return this.finishToken(S.regexp,{pattern:r,flags:a,value:l})};xe.readInt=function(t,e,i){for(var s=this.options.ecmaVersion>=12&&e===void 0,r=i&&this.input.charCodeAt(this.pos)===48,n=this.pos,a=0,o=0,l=0,c=e??1/0;l<c;++l,++this.pos){var h=this.input.charCodeAt(this.pos),d=void 0;if(s&&h===95){r&&this.raiseRecoverable(this.pos,"Numeric separator is not allowed in legacy octal numeric literals"),o===95&&this.raiseRecoverable(this.pos,"Numeric separator must be exactly one underscore"),l===0&&this.raiseRecoverable(this.pos,"Numeric separator is not allowed at the first of digits"),o=h;continue}if(h>=97?d=h-97+10:h>=65?d=h-65+10:h>=48&&h<=57?d=h-48:d=1/0,d>=t)break;o=h,a=a*t+d}return s&&o===95&&this.raiseRecoverable(this.pos-1,"Numeric separator is not allowed at the last of digits"),this.pos===n||e!=null&&this.pos-n!==e?null:a};function s2(t,e){return e?parseInt(t,8):parseFloat(t.replace(/_/g,""))}function $0(t){return typeof BigInt!="function"?null:BigInt(t.replace(/_/g,""))}xe.readRadixNumber=function(t){var e=this.pos;this.pos+=2;var i=this.readInt(t);return i==null&&this.raise(this.start+2,"Expected number in radix "+t),this.options.ecmaVersion>=11&&this.input.charCodeAt(this.pos)===110?(i=$0(this.input.slice(e,this.pos)),++this.pos):Ai(this.fullCharCodeAtPos())&&this.raise(this.pos,"Identifier directly after number"),this.finishToken(S.num,i)};xe.readNumber=function(t){var e=this.pos;!t&&this.readInt(10,void 0,!0)===null&&this.raise(e,"Invalid number");var i=this.pos-e>=2&&this.input.charCodeAt(e)===48;i&&this.strict&&this.raise(e,"Invalid number");var s=this.input.charCodeAt(this.pos);if(!i&&!t&&this.options.ecmaVersion>=11&&s===110){var r=$0(this.input.slice(e,this.pos));return++this.pos,Ai(this.fullCharCodeAtPos())&&this.raise(this.pos,"Identifier directly after number"),this.finishToken(S.num,r)}i&&/[89]/.test(this.input.slice(e,this.pos))&&(i=!1),s===46&&!i&&(++this.pos,this.readInt(10),s=this.input.charCodeAt(this.pos)),(s===69||s===101)&&!i&&(s=this.input.charCodeAt(++this.pos),(s===43||s===45)&&++this.pos,this.readInt(10)===null&&this.raise(e,"Invalid number")),Ai(this.fullCharCodeAtPos())&&this.raise(this.pos,"Identifier directly after number");var n=s2(this.input.slice(e,this.pos),i);return this.finishToken(S.num,n)};xe.readCodePoint=function(){var t=this.input.charCodeAt(this.pos),e;if(t===123){this.options.ecmaVersion<6&&this.unexpected();var i=++this.pos;e=this.readHexChar(this.input.indexOf("}",this.pos)-this.pos),++this.pos,e>1114111&&this.invalidStringToken(i,"Code point out of bounds")}else e=this.readHexChar(4);return e};xe.readString=function(t){for(var e="",i=++this.pos;;){this.pos>=this.input.length&&this.raise(this.start,"Unterminated string constant");var s=this.input.charCodeAt(this.pos);if(s===t)break;s===92?(e+=this.input.slice(i,this.pos),e+=this.readEscapedChar(!1),i=this.pos):s===8232||s===8233?(this.options.ecmaVersion<10&&this.raise(this.start,"Unterminated string constant"),++this.pos,this.options.locations&&(this.curLine++,this.lineStart=this.pos)):(dn(s)&&this.raise(this.start,"Unterminated string constant"),++this.pos)}return e+=this.input.slice(i,this.pos++),this.finishToken(S.string,e)};var I0={};xe.tryReadTemplateToken=function(){this.inTemplateElement=!0;try{this.readTmplToken()}catch(t){if(t===I0)this.readInvalidTemplateToken();else throw t}this.inTemplateElement=!1};xe.invalidStringToken=function(t,e){if(this.inTemplateElement&&this.options.ecmaVersion>=9)throw I0;this.raise(t,e)};xe.readTmplToken=function(){for(var t="",e=this.pos;;){this.pos>=this.input.length&&this.raise(this.start,"Unterminated template");var i=this.input.charCodeAt(this.pos);if(i===96||i===36&&this.input.charCodeAt(this.pos+1)===123)return this.pos===this.start&&(this.type===S.template||this.type===S.invalidTemplate)?i===36?(this.pos+=2,this.finishToken(S.dollarBraceL)):(++this.pos,this.finishToken(S.backQuote)):(t+=this.input.slice(e,this.pos),this.finishToken(S.template,t));if(i===92)t+=this.input.slice(e,this.pos),t+=this.readEscapedChar(!0),e=this.pos;else if(dn(i)){switch(t+=this.input.slice(e,this.pos),++this.pos,i){case 13:this.input.charCodeAt(this.pos)===10&&++this.pos;case 10:t+=`
`;break;default:t+=String.fromCharCode(i);break}this.options.locations&&(++this.curLine,this.lineStart=this.pos),e=this.pos}else++this.pos}};xe.readInvalidTemplateToken=function(){for(;this.pos<this.input.length;this.pos++)switch(this.input[this.pos]){case"\\":++this.pos;break;case"$":if(this.input[this.pos+1]!=="{")break;case"`":return this.finishToken(S.invalidTemplate,this.input.slice(this.start,this.pos));case"\r":this.input[this.pos+1]===`
`&&++this.pos;case`
`:case"\u2028":case"\u2029":++this.curLine,this.lineStart=this.pos+1;break}this.raise(this.start,"Unterminated template")};xe.readEscapedChar=function(t){var e=this.input.charCodeAt(++this.pos);switch(++this.pos,e){case 110:return`
`;case 114:return"\r";case 120:return String.fromCharCode(this.readHexChar(2));case 117:return is(this.readCodePoint());case 116:return"	";case 98:return"\b";case 118:return"\v";case 102:return"\f";case 13:this.input.charCodeAt(this.pos)===10&&++this.pos;case 10:return this.options.locations&&(this.lineStart=this.pos,++this.curLine),"";case 56:case 57:if(this.strict&&this.invalidStringToken(this.pos-1,"Invalid escape sequence"),t){var i=this.pos-1;this.invalidStringToken(i,"Invalid escape sequence in template string")}default:if(e>=48&&e<=55){var s=this.input.substr(this.pos-1,3).match(/^[0-7]+/)[0],r=parseInt(s,8);return r>255&&(s=s.slice(0,-1),r=parseInt(s,8)),this.pos+=s.length-1,e=this.input.charCodeAt(this.pos),(s!=="0"||e===56||e===57)&&(this.strict||t)&&this.invalidStringToken(this.pos-1-s.length,t?"Octal literal in template string":"Octal literal in strict mode"),String.fromCharCode(r)}return dn(e)?(this.options.locations&&(this.lineStart=this.pos,++this.curLine),""):String.fromCharCode(e)}};xe.readHexChar=function(t){var e=this.pos,i=this.readInt(16,t);return i===null&&this.invalidStringToken(e,"Bad character escape sequence"),i};xe.readWord1=function(){this.containsEsc=!1;for(var t="",e=!0,i=this.pos,s=this.options.ecmaVersion>=6;this.pos<this.input.length;){var r=this.fullCharCodeAtPos();if(Cs(r,s))this.pos+=r<=65535?1:2;else if(r===92){this.containsEsc=!0,t+=this.input.slice(i,this.pos);var n=this.pos;this.input.charCodeAt(++this.pos)!==117&&this.invalidStringToken(this.pos,"Expecting Unicode escape sequence \\uXXXX"),++this.pos;var a=this.readCodePoint();(e?Ai:Cs)(a,s)||this.invalidStringToken(n,"Invalid Unicode escape"),t+=is(a),i=this.pos}else break;e=!1}return t+this.input.slice(i,this.pos)};xe.readWord=function(){var t=this.readWord1(),e=S.name;return this.keywords.test(t)&&(e=zd[t]),this.finishToken(e,t)};var r2="8.15.0";at.acorn={Parser:at,version:r2,defaultOptions:Zh,Position:ya,SourceLocation:Cl,getLineInfo:s0,Node:Il,TokenType:Re,tokTypes:S,keywordTypes:zd,TokContext:li,tokContexts:We,isIdentifierChar:Cs,isIdentifierStart:Ai,Token:Kd,isNewLine:dn,lineBreak:Nt,lineBreakG:ER,nonASCIIwhitespace:t0};function Q0(t,e){return at.parse(t,e)}function n2(t,e,i,s,r){i||(i=Y),function n(a,o,l){var c=l||a.type;i[c](a,o,n),e[c]&&e[c](a,o)}(t,s,r)}function a2(t,e,i,s,r){var n=[];i||(i=Y),function a(o,l,c){var h=c||o.type,d=o!==n[n.length-1];d&&n.push(o),i[h](o,l,a),e[h]&&e[h](o,l||n,n),d&&n.pop()}(t,s,r)}function Jd(t,e,i){i(t,e)}function ur(t,e,i){}var Y={};Y.Program=Y.BlockStatement=Y.StaticBlock=function(t,e,i){for(var s=0,r=t.body;s<r.length;s+=1){var n=r[s];i(n,e,"Statement")}};Y.Statement=Jd;Y.EmptyStatement=ur;Y.ExpressionStatement=Y.ParenthesizedExpression=Y.ChainExpression=function(t,e,i){return i(t.expression,e,"Expression")};Y.IfStatement=function(t,e,i){i(t.test,e,"Expression"),i(t.consequent,e,"Statement"),t.alternate&&i(t.alternate,e,"Statement")};Y.LabeledStatement=function(t,e,i){return i(t.body,e,"Statement")};Y.BreakStatement=Y.ContinueStatement=ur;Y.WithStatement=function(t,e,i){i(t.object,e,"Expression"),i(t.body,e,"Statement")};Y.SwitchStatement=function(t,e,i){i(t.discriminant,e,"Expression");for(var s=0,r=t.cases;s<r.length;s+=1){var n=r[s];i(n,e)}};Y.SwitchCase=function(t,e,i){t.test&&i(t.test,e,"Expression");for(var s=0,r=t.consequent;s<r.length;s+=1){var n=r[s];i(n,e,"Statement")}};Y.ReturnStatement=Y.YieldExpression=Y.AwaitExpression=function(t,e,i){t.argument&&i(t.argument,e,"Expression")};Y.ThrowStatement=Y.SpreadElement=function(t,e,i){return i(t.argument,e,"Expression")};Y.TryStatement=function(t,e,i){i(t.block,e,"Statement"),t.handler&&i(t.handler,e),t.finalizer&&i(t.finalizer,e,"Statement")};Y.CatchClause=function(t,e,i){t.param&&i(t.param,e,"Pattern"),i(t.body,e,"Statement")};Y.WhileStatement=Y.DoWhileStatement=function(t,e,i){i(t.test,e,"Expression"),i(t.body,e,"Statement")};Y.ForStatement=function(t,e,i){t.init&&i(t.init,e,"ForInit"),t.test&&i(t.test,e,"Expression"),t.update&&i(t.update,e,"Expression"),i(t.body,e,"Statement")};Y.ForInStatement=Y.ForOfStatement=function(t,e,i){i(t.left,e,"ForInit"),i(t.right,e,"Expression"),i(t.body,e,"Statement")};Y.ForInit=function(t,e,i){t.type==="VariableDeclaration"?i(t,e):i(t,e,"Expression")};Y.DebuggerStatement=ur;Y.FunctionDeclaration=function(t,e,i){return i(t,e,"Function")};Y.VariableDeclaration=function(t,e,i){for(var s=0,r=t.declarations;s<r.length;s+=1){var n=r[s];i(n,e)}};Y.VariableDeclarator=function(t,e,i){i(t.id,e,"Pattern"),t.init&&i(t.init,e,"Expression")};Y.Function=function(t,e,i){t.id&&i(t.id,e,"Pattern");for(var s=0,r=t.params;s<r.length;s+=1){var n=r[s];i(n,e,"Pattern")}i(t.body,e,t.expression?"Expression":"Statement")};Y.Pattern=function(t,e,i){t.type==="Identifier"?i(t,e,"VariablePattern"):t.type==="MemberExpression"?i(t,e,"MemberPattern"):i(t,e)};Y.VariablePattern=ur;Y.MemberPattern=Jd;Y.RestElement=function(t,e,i){return i(t.argument,e,"Pattern")};Y.ArrayPattern=function(t,e,i){for(var s=0,r=t.elements;s<r.length;s+=1){var n=r[s];n&&i(n,e,"Pattern")}};Y.ObjectPattern=function(t,e,i){for(var s=0,r=t.properties;s<r.length;s+=1){var n=r[s];n.type==="Property"?(n.computed&&i(n.key,e,"Expression"),i(n.value,e,"Pattern")):n.type==="RestElement"&&i(n.argument,e,"Pattern")}};Y.Expression=Jd;Y.ThisExpression=Y.Super=Y.MetaProperty=ur;Y.ArrayExpression=function(t,e,i){for(var s=0,r=t.elements;s<r.length;s+=1){var n=r[s];n&&i(n,e,"Expression")}};Y.ObjectExpression=function(t,e,i){for(var s=0,r=t.properties;s<r.length;s+=1){var n=r[s];i(n,e)}};Y.FunctionExpression=Y.ArrowFunctionExpression=Y.FunctionDeclaration;Y.SequenceExpression=function(t,e,i){for(var s=0,r=t.expressions;s<r.length;s+=1){var n=r[s];i(n,e,"Expression")}};Y.TemplateLiteral=function(t,e,i){for(var s=0,r=t.quasis;s<r.length;s+=1){var n=r[s];i(n,e)}for(var a=0,o=t.expressions;a<o.length;a+=1){var l=o[a];i(l,e,"Expression")}};Y.TemplateElement=ur;Y.UnaryExpression=Y.UpdateExpression=function(t,e,i){i(t.argument,e,"Expression")};Y.BinaryExpression=Y.LogicalExpression=function(t,e,i){i(t.left,e,"Expression"),i(t.right,e,"Expression")};Y.AssignmentExpression=Y.AssignmentPattern=function(t,e,i){i(t.left,e,"Pattern"),i(t.right,e,"Expression")};Y.ConditionalExpression=function(t,e,i){i(t.test,e,"Expression"),i(t.consequent,e,"Expression"),i(t.alternate,e,"Expression")};Y.NewExpression=Y.CallExpression=function(t,e,i){if(i(t.callee,e,"Expression"),t.arguments)for(var s=0,r=t.arguments;s<r.length;s+=1){var n=r[s];i(n,e,"Expression")}};Y.MemberExpression=function(t,e,i){i(t.object,e,"Expression"),t.computed&&i(t.property,e,"Expression")};Y.ExportNamedDeclaration=Y.ExportDefaultDeclaration=function(t,e,i){t.declaration&&i(t.declaration,e,t.type==="ExportNamedDeclaration"||t.declaration.id?"Statement":"Expression"),t.source&&i(t.source,e,"Expression")};Y.ExportAllDeclaration=function(t,e,i){t.exported&&i(t.exported,e),i(t.source,e,"Expression")};Y.ImportDeclaration=function(t,e,i){for(var s=0,r=t.specifiers;s<r.length;s+=1){var n=r[s];i(n,e)}i(t.source,e,"Expression")};Y.ImportExpression=function(t,e,i){i(t.source,e,"Expression")};Y.ImportSpecifier=Y.ImportDefaultSpecifier=Y.ImportNamespaceSpecifier=Y.Identifier=Y.PrivateIdentifier=Y.Literal=ur;Y.TaggedTemplateExpression=function(t,e,i){i(t.tag,e,"Expression"),i(t.quasi,e,"Expression")};Y.ClassDeclaration=Y.ClassExpression=function(t,e,i){return i(t,e,"Class")};Y.Class=function(t,e,i){t.id&&i(t.id,e,"Pattern"),t.superClass&&i(t.superClass,e,"Expression"),i(t.body,e)};Y.ClassBody=function(t,e,i){for(var s=0,r=t.body;s<r.length;s+=1){var n=r[s];i(n,e)}};Y.MethodDefinition=Y.PropertyDefinition=Y.Property=function(t,e,i){t.computed&&i(t.key,e,"Expression"),t.value&&i(t.value,e,"Expression")};function A0(t){var e,i;try{return{success:!0,ast:Q0(t,{ecmaVersion:2020,locations:!0,sourceType:"script",allowReturnOutsideFunction:!0})}}catch(s){return{success:!1,error:{message:s.message,line:((e=s.loc)==null?void 0:e.line)||1,column:((i=s.loc)==null?void 0:i.column)||0}}}}class o2{constructor(e,i){this.code=e,this.originalArray=[...i],this.array=[...i],this.steps=[],this.variables=new Map,this.stats={comparisons:0,swaps:0},this.sortedIndices=new Set,this.codeLines=e.split(`
`)}generate(){const e=A0(this.code);if(e.success)try{return this.analyzeAST(e.ast),this.steps}catch(i){console.warn("[Interpreter] AST analysis failed, falling back to pattern detection:",i)}return this.patternBasedGeneration(),this.steps}analyzeAST(e){const i=[];n2(e,{FunctionDeclaration:s=>{this.isAlgorithmFunction(s)&&i.push(s)},FunctionExpression:s=>{this.isAlgorithmFunction(s)&&i.push(s)},ArrowFunctionExpression:s=>{this.isAlgorithmFunction(s)&&i.push(s)}}),i.length===0?this.analyzeBlock(e):this.analyzeBlock(i[0].body);for(let s=0;s<this.array.length;s++)this.sortedIndices.add(s);this.emitStep("complete",{line:this.codeLines.length})}isAlgorithmFunction(e){var r;const i=((r=e.id)==null?void 0:r.name)||"";return["sort","bubble","quick","merge","insertion","selection","heap","search","linear","binary"].some(n=>i.toLowerCase().includes(n))}analyzeBlock(e){e&&a2(e,{ForStatement:(i,s)=>{this.handleForLoop(i,s)},WhileStatement:(i,s)=>{this.handleWhileLoop(i,s)},BinaryExpression:(i,s)=>{this.isComparisonOperator(i.operator)&&this.handleComparison(i,s)},AssignmentExpression:(i,s)=>{this.handleAssignment(i,s)},ArrayPattern:(i,s)=>{this.handleDestructuringSwap(i,s)}})}handleForLoop(e,i){var n,a;const s=((a=(n=e.loc)==null?void 0:n.start)==null?void 0:a.line)||1,r=this.extractLoopInit(e.init);r&&this.variables.set(r.name,r.value),this.emitStep("loop_start",{line:s,description:`Starting loop at line ${s}`,loopType:"for"})}handleWhileLoop(e,i){var r,n;const s=((n=(r=e.loc)==null?void 0:r.start)==null?void 0:n.line)||1;this.emitStep("loop_start",{line:s,description:`Starting while loop at line ${s}`,loopType:"while"})}handleComparison(e,i){var o,l;const s=((l=(o=e.loc)==null?void 0:o.start)==null?void 0:l.line)||1,r=this.extractArrayAccess(e.left),n=this.extractArrayAccess(e.right),a=[];if(r.length>0&&a.push(...r),n.length>0&&a.push(...n),a.length>=2){this.stats.comparisons++;const c=this.resolveIndex(a[0]),h=this.resolveIndex(a[1]);c!==null&&h!==null&&c>=0&&h>=0&&c<this.array.length&&h<this.array.length&&this.emitStep("compare",{line:s,indices:[c,h],description:`Comparing arr[${c}]=${this.array[c]} with arr[${h}]=${this.array[h]}`,result:this.evaluateComparison(this.array[c],this.array[h],e.operator)})}}handleAssignment(e,i){var a,o;const s=((o=(a=e.loc)==null?void 0:a.start)==null?void 0:o.line)||1,r=this.extractArrayAccess(e.left),n=this.extractArrayAccess(e.right);if(e.left.type==="Identifier"){const l=e.left.name;(l==="temp"||l==="key"||l==="pivot")&&this.variables.set(l,"pending_swap")}if(r.length>0&&n.length>0){const l=this.resolveIndex(r[0]),c=this.resolveIndex(n[0]);l!==null&&c!==null&&l!==c&&l>=0&&c>=0&&l<this.array.length&&c<this.array.length&&(this.pendingSwapIndices=this.pendingSwapIndices||[],this.pendingSwapIndices.push({i:l,j:c,line:s}))}}handleDestructuringSwap(e,i){var o,l,c;const s=i[i.length-2];if((s==null?void 0:s.type)!=="AssignmentExpression")return;const r=((l=(o=s.loc)==null?void 0:o.start)==null?void 0:l.line)||1;if(((c=s.right)==null?void 0:c.type)!=="ArrayExpression")return;const n=e.elements.filter(h=>(h==null?void 0:h.type)==="MemberExpression").map(h=>this.extractArrayAccess(h)).flat(),a=s.right.elements.filter(h=>(h==null?void 0:h.type)==="MemberExpression").map(h=>this.extractArrayAccess(h)).flat();if(n.length===2&&a.length===2){const h=this.resolveIndex(n[0]),d=this.resolveIndex(n[1]);h!==null&&d!==null&&h>=0&&d>=0&&h<this.array.length&&d<this.array.length&&([this.array[h],this.array[d]]=[this.array[d],this.array[h]],this.stats.swaps++,this.emitStep("swap",{line:r,indices:[h,d],description:`Swapped arr[${h}] â†” arr[${d}]`}))}}extractLoopInit(e){var i;if(!e)return null;if(e.type==="VariableDeclaration"&&e.declarations[0]){const s=e.declarations[0];if(s.id.type==="Identifier"&&((i=s.init)==null?void 0:i.type)==="Literal")return{name:s.id.name,value:s.init.value}}return null}extractArrayAccess(e){const i=[];return(e==null?void 0:e.type)==="MemberExpression"&&e.computed&&(e.property.type==="Identifier"?i.push(e.property.name):e.property.type==="Literal"?i.push(e.property.value):e.property.type==="BinaryExpression"&&i.push(this.evaluateBinaryExpr(e.property))),i}resolveIndex(e){if(typeof e=="number")return e;if(typeof e=="string"){if(this.variables.has(e)){const r=this.variables.get(e);if(typeof r=="number")return r}const i=e.match(/^(\w+)\s*\+\s*(\d+)$/);if(i){const r=this.variables.get(i[1]);if(typeof r=="number")return r+parseInt(i[2])}const s=e.match(/^(\w+)\s*-\s*(\d+)$/);if(s){const r=this.variables.get(s[1]);if(typeof r=="number")return r-parseInt(s[2])}}return null}evaluateBinaryExpr(e){if(e.type!=="BinaryExpression")return null;let i="",s="";return e.left.type==="Identifier"?i=e.left.name:e.left.type==="Literal"&&(i=String(e.left.value)),e.right.type==="Identifier"?s=e.right.name:e.right.type==="Literal"&&(s=String(e.right.value)),`${i}${e.operator}${s}`}isComparisonOperator(e){return[">","<",">=","<=","===","==","!==","!="].includes(e)}evaluateComparison(e,i,s){switch(s){case">":return e>i;case"<":return e<i;case">=":return e>=i;case"<=":return e<=i;case"===":case"==":return e===i;case"!==":case"!=":return e!==i;default:return!1}}emitStep(e,i={}){var s,r;this.steps.push({type:e,line:i.line||1,arrayState:[...this.array],variables:Object.fromEntries(this.variables),sorted:new Set(this.sortedIndices),comparing:i.indices&&e==="compare"?i.indices:[],swapping:i.indices&&e==="swap"?i.indices:[],description:i.description||"",stats:{...this.stats},i:((s=i.indices)==null?void 0:s[0])??-1,j:((r=i.indices)==null?void 0:r[1])??-1,guidanceIdx:i.guidanceIdx||0})}patternBasedGeneration(){const e=[...this.originalArray],i=new Set,s=e.length,r=(d={})=>{d.compare&&this.stats.comparisons++,d.swap&&this.stats.swaps++,this.steps.push({type:d.swap?"swap":d.compare?"compare":"step",arr:[...e],arrayState:[...e],sorted:new Set(i),comparing:d.comparing||[],swapping:d.swapping||[],i:d.i??-1,j:d.j??-1,line:d.line||1,guidanceIdx:d.guidanceIdx||0,stats:{...this.stats},variables:Object.fromEntries(this.variables),description:d.description||""})},n=/for.*i.*length.*for.*j.*if.*arr\[j\].*>.*arr\[j.*\+.*1\]/s.test(this.code),a=/key.*=.*arr\[i\].*while.*j.*>=.*0/s.test(this.code),o=/min.*=.*i.*for.*j.*if.*arr\[j\].*<.*arr\[min/s.test(this.code),l=/pivot|partition/i.test(this.code)&&/quickSort|quick_sort/i.test(this.code),c=/merge.*left.*right|mergeSort|merge_sort/is.test(this.code),h=/linear.*search|linearSearch|linear_search|target.*arr\[i\].*==|arr\[i\].*==.*target/is.test(this.code);if(n)for(let d=0;d<s-1;d++){for(let u=0;u<s-d-1;u++)this.variables.set("i",d),this.variables.set("j",u),r({comparing:[u,u+1],compare:!0,i:d,j:u,line:4,description:`Comparing arr[${u}] with arr[${u+1}]`}),e[u]>e[u+1]&&([e[u],e[u+1]]=[e[u+1],e[u]],r({swapping:[u,u+1],swap:!0,i:d,j:u,line:7,description:`Swapped arr[${u}] â†” arr[${u+1}]`}));i.add(s-d-1)}else if(a)for(let d=1;d<s;d++){let u=e[d],p=d-1;for(this.variables.set("i",d),this.variables.set("key",u),r({comparing:[d],i:d,j:p,line:3,description:`Key = arr[${d}] = ${u}`});p>=0&&e[p]>u;)this.variables.set("j",p),r({comparing:[p,p+1],compare:!0,i:d,j:p,line:5,description:`Comparing arr[${p}] with key`}),e[p+1]=e[p],r({swapping:[p,p+1],swap:!0,i:d,j:p,line:6,description:`Shifted arr[${p}] right`}),p--;e[p+1]=u,r({swapping:[p+1],i:d,j:p+1,line:8,description:`Inserted key at position ${p+1}`})}else if(o)for(let d=0;d<s-1;d++){let u=d;this.variables.set("i",d),this.variables.set("minIdx",u);for(let p=d+1;p<s;p++)this.variables.set("j",p),r({comparing:[u,p],compare:!0,i:d,j:p,line:5,description:`Comparing arr[${u}] with arr[${p}]`}),e[p]<e[u]&&(u=p,this.variables.set("minIdx",u));u!==d&&([e[d],e[u]]=[e[u],e[d]],r({swapping:[d,u],swap:!0,i:d,j:u,line:11,description:`Swapped arr[${d}] â†” arr[${u}]`})),i.add(d)}else if(l){const d=(u,p)=>{if(u<p){const f=e[p];this.variables.set("pivot",f),this.variables.set("lo",u),this.variables.set("hi",p);let g=u-1;for(let y=u;y<p;y++)this.variables.set("i",g),this.variables.set("j",y),r({comparing:[y,p],compare:!0,i:g,j:y,line:6,description:`Comparing arr[${y}] with pivot`}),e[y]<=f&&(g++,[e[g],e[y]]=[e[y],e[g]],r({swapping:[g,y],swap:!0,i:g,j:y,line:9,description:`Swapped arr[${g}] â†” arr[${y}]`}));[e[g+1],e[p]]=[e[p],e[g+1]],r({swapping:[g+1,p],swap:!0,i:g+1,j:p,line:11,description:`Placed pivot at position ${g+1}`});const m=g+1;d(u,m-1),d(m+1,p)}};d(0,s-1)}else if(c)for(let d=1;d<s;d*=2)for(let u=0;u<s-d;u+=2*d){const p=Math.min(u+2*d-1,s-1);for(let f=u;f<=p;f++)for(let g=f+1;g<=p;g++)this.variables.set("i",f),this.variables.set("j",g),r({comparing:[f,g],compare:!0,i:f,j:g,line:6}),e[f]>e[g]&&([e[f],e[g]]=[e[g],e[f]],r({swapping:[f,g],swap:!0,i:f,j:g,line:8}))}else if(h){let u=-1;this.variables.set("target",43);for(let p=0;p<s;p++)if(this.variables.set("i",p),r({comparing:[p],compare:!0,i:p,j:-1,line:8,description:`Checking if arr[${p}] (${e[p]}) equals target (43)`}),e[p]===43){u=p,this.variables.set("result",u),r({comparing:[p],i:p,j:-1,line:9,description:`Found target 43 at index ${p}!`});break}u===-1&&(this.variables.set("result",-1),r({comparing:[],i:s,j:-1,line:11,description:"Target 43 not found in array"}))}else for(let d=0;d<s-1;d++){for(let u=0;u<s-d-1;u++)this.variables.set("i",d),this.variables.set("j",u),r({comparing:[u,u+1],compare:!0,i:d,j:u,line:3,description:`Comparing arr[${u}] with arr[${u+1}]`}),e[u]>e[u+1]&&([e[u],e[u+1]]=[e[u+1],e[u]],r({swapping:[u,u+1],swap:!0,i:d,j:u,line:5,description:"Swapped"}));i.add(s-d-1)}for(let d=0;d<s;d++)i.add(d);r({line:12}),this.array=e}}const qc={dark:{bg:"#0f172a",cardBg:"#1e293b",barDefault:"#3b82f6",barCompare:"#fbbf24",barSwap:"#ef4444",barSorted:"#10b981",text:"#e2e8f0",glowStrength:15,borderAlpha:.5},light:{bg:"#f8fafc",cardBg:"#ffffff",barDefault:"#6366f1",barCompare:"#f59e0b",barSwap:"#f43f5e",barSorted:"#10b981",text:"#334155",glowStrength:0,borderAlpha:0}};class l2{constructor(e,i={}){this.canvas=document.getElementById(e),this.canvas&&(this.ctx=this.canvas.getContext("2d"),this.dpr=window.devicePixelRatio||1,this.options={barGap:12,barRadius:6,animationDuration:400,enableSound:!0,enableParticles:!1,showValues:!0,...i},this.array=[],this.barStates=[],this.comparing=[],this.swapping=[],this.sorted=new Set,this.isDark=document.documentElement.getAttribute("data-theme")==="dark",window.updateVisualizerTheme=()=>{this.detectTheme()},this.setupThemeObserver(),this.setupCanvas(),this.bindResize(),setTimeout(()=>this.detectTheme(),100),this.lastFrameTime=0,this.animate())}setupThemeObserver(){new MutationObserver(()=>this.detectTheme()).observe(document.documentElement,{attributes:!0,attributeFilter:["data-theme"]})}detectTheme(){this.isDark=document.documentElement.getAttribute("data-theme")==="dark",this.currentTheme=this.isDark?qc.dark:qc.light,SandboxController&&SandboxController.editor&&SandboxController.editor.setTheme(this.isDark?"dark":"light"),this.render()}setupCanvas(){const e=this.canvas.parentElement,i=this.canvas.getBoundingClientRect();let s=i.width,r=i.height;(s<50||r<50)&&(s=(e==null?void 0:e.offsetWidth)||600,r=300),this.width=s,this.height=r,this.canvas.width=this.width*this.dpr,this.canvas.height=this.height*this.dpr,this.ctx.setTransform(1,0,0,1,0,0),this.ctx.scale(this.dpr,this.dpr)}bindResize(){new ResizeObserver(()=>{this.setupCanvas(),this.calculateBarPositions(),this.render()}).observe(this.canvas.parentElement||this.canvas)}setArray(e){this.array=[...e],this.barStates=e.map((i,s)=>({value:i,targetX:0,targetY:0,currentX:0,currentY:0,targetHeight:0,currentHeight:0,state:"default"})),this.comparing=[],this.swapping=[],this.sorted=new Set,this.calculateBarPositions(),this.render()}calculateBarPositions(){const e=this.array.length;if(e===0)return;const i=40,s=40,r=40,n=this.width-i*2,a=this.height-s-r,o=(e-1)*this.options.barGap,l=Math.max(4,Math.min(50,(n-o)/e)),c=e*l+(e-1)*this.options.barGap,h=(this.width-c)/2,d=Math.max(...this.array,1);this.barWidth=l,this.maxValue=d,this.baselineY=this.height-s,this.barStates.forEach((u,p)=>{const f=h+p*(l+this.options.barGap),g=this.array[p]/d*a,m=this.baselineY-g;u.targetX=f,u.targetY=m,u.targetHeight=g,u.currentX===0&&(u.currentX=f,u.currentY=this.baselineY,u.currentHeight=0)})}updateState(e={}){const{array:i,comparing:s=[],swapping:r=[],sorted:n=[],pivot:a=-1}=e;if(i){if(this.array=[...i],i.forEach((o,l)=>{this.barStates[l]&&(this.barStates[l].value=o)}),r.length===2){const[o,l]=r;if(this.isValid(o)&&this.isValid(l)){const c=this.barStates[o];this.barStates[o]=this.barStates[l],this.barStates[l]=c,this.playSwapSound(this.barStates[o].value,this.barStates[l].value)}}this.calculateBarPositions()}this.comparing=s,this.swapping=r,this.sorted=new Set(n),this.pivot=a,this.barStates.forEach((o,l)=>{r.includes(l)?o.state="swapping":s.includes(l)?o.state="comparing":this.sorted.has(l)?o.state="sorted":l===a?o.state="pivot":o.state="default"})}isValid(e){return e>=0&&e<this.barStates.length}animate(e=performance.now()){requestAnimationFrame(r=>this.animate(r));const i=e-this.lastFrameTime;this.lastFrameTime=e;const s=Math.min(i,50);this.barStates.forEach(r=>{if(Math.abs(r.currentX-r.targetX)>.5){const n=s/(this.options.animationDuration*.4);r.currentX+=(r.targetX-r.currentX)*Math.min(n,1)}else r.currentX=r.targetX;r.currentY+=(r.targetY-r.currentY)*.2,r.currentHeight+=(r.targetHeight-r.currentHeight)*.2,r.state==="swapping"||r.state==="comparing"?r.zScale=r.zScale?r.zScale+(1.15-r.zScale)*.1:1:r.zScale=r.zScale?r.zScale+(1-r.zScale)*.1:1}),this.render()}render(){const e=this.ctx,i=this.currentTheme||qc.dark;e.fillStyle=i.bg,e.fillRect(0,0,this.width,this.height),e.strokeStyle=this.isDark?"rgba(255,255,255,0.1)":"rgba(0,0,0,0.1)",e.lineWidth=1,e.beginPath(),e.moveTo(40,this.baselineY+1),e.lineTo(this.width-40,this.baselineY+1),e.stroke(),[...this.barStates].sort((r,n)=>{const a=r.state==="swapping"?2:r.state==="comparing"?1:0,o=n.state==="swapping"?2:n.state==="comparing"?1:0;return a-o}).forEach(r=>{this.drawBar(e,r,i)})}drawBar(e,i,s){const{currentX:r,currentY:n,currentHeight:a,state:o,value:l,zScale:c=1}=i,h=this.getStateColor(o,s);e.save();const d=this.barWidth,u=r;if(c!==1){const f=u+d/2;e.translate(f,this.baselineY),e.scale(c,c),e.translate(-f,-this.baselineY),o==="swapping"&&e.translate(0,-4)}const p=this.options.barRadius;this.isDark?o!=="default"?(e.shadowColor=h,e.shadowBlur=15*c,e.shadowOffsetY=4*c):(e.shadowColor="transparent",e.shadowBlur=0):(e.shadowColor="rgba(0,0,0,0.1)",e.shadowBlur=4*c,e.shadowOffsetY=2*c),e.fillStyle=h,e.beginPath(),e.moveTo(u,this.baselineY),e.lineTo(u,n+p),e.arcTo(u,n,u+d,n,p),e.arcTo(u+d,n,u+d,n+p,p),e.lineTo(u+d,this.baselineY),e.closePath(),e.fill(),e.shadowColor="transparent",e.shadowBlur=0,e.shadowOffsetY=0,this.options.showValues&&d>14&&(e.font="bold 12px Inter, sans-serif",e.textAlign="center",e.textBaseline="bottom",e.fillStyle=s.text,e.fillText(l,u+d/2,n-6)),e.restore()}drawSearchOverlay(){const{low:e,high:i}=this.searchRange;if(e===void 0||i===void 0)return;const s=this.ctx;if(s.fillStyle=this.isDark?"rgba(15, 23, 42, 0.6)":"rgba(255, 255, 255, 0.6)",e>0){const r=this.barStates[0],n=this.barStates[e-1];if(r&&n){const o=n.currentX+this.barWidth+this.options.barGap/2;s.fillRect(0,0,o,this.height)}}if(i<this.barStates.length-1){const r=this.barStates[i+1];if(r){const n=r.currentX-this.options.barGap/2,a=this.width-n;s.fillRect(n,0,a,this.height)}}}drawPointers(){const e=this.ctx,{low:i,high:s,mid:r}=this.pointers,n=(a,o,l)=>{if(a===void 0||a<0||a>=this.barStates.length)return;const h=this.barStates[a].currentX+this.barWidth/2,d=this.height-35;e.fillStyle=l,e.strokeStyle=l,e.textAlign="center",e.textBaseline="bottom",e.beginPath(),e.moveTo(h,d),e.lineTo(h-4,d+6),e.lineTo(h+4,d+6),e.closePath(),e.fill(),e.font="bold 12px system-ui",e.fillText(o,h,d+20)};i!==void 0&&n(i,"L","#6366f1"),s!==void 0&&n(s,"H","#6366f1"),r!==void 0&&n(r,"M","#f59e0b")}getStateColor(e,i){switch(e){case"comparing":return i.barCompare;case"swapping":return i.barSwap;case"sorted":return i.barSorted;case"pivot":return i.barCompare;default:return i.barDefault}}adjustAlpha(e,i){if(e.startsWith("#")){const s=parseInt(e.slice(1,3),16),r=parseInt(e.slice(3,5),16),n=parseInt(e.slice(5,7),16);return`rgba(${s},${r},${n},${i})`}return e}roundRect(e,i,s,r,n,a){r<2*a&&(a=r/2),n<2*a&&(a=n/2),e.beginPath(),e.moveTo(i+a,s),e.arcTo(i+r,s,i+r,s+n,a),e.arcTo(i+r,s+n,i,s+n,a),e.arcTo(i,s+n,i,s,a),e.arcTo(i,s,i+r,s,a),e.closePath()}playSwapSound(e,i){this.options.enableSound&&(setTimeout(()=>this.playTone(e,50),0),setTimeout(()=>this.playTone(i,50),60))}playCompareSound(e,i){this.options.enableSound&&(this.playTone(e,30),setTimeout(()=>this.playTone(i,30),40))}playTone(e,i){try{const s=new(window.AudioContext||window.webkitAudioContext),r=s.createOscillator(),n=s.createGain();r.frequency.value=200+e/this.maxValue*600,n.gain.value=.04,n.gain.exponentialRampToValueAtTime(.001,s.currentTime+i/1e3),r.connect(n),n.connect(s.destination),r.start(),r.stop(s.currentTime+i/1e3)}catch{}}setSound(e){this.options.enableSound=e}}var c2=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};function h2(t){return t&&t.__esModule&&Object.prototype.hasOwnProperty.call(t,"default")?t.default:t}function d2(t){if(t.__esModule)return t;var e=t.default;if(typeof e=="function"){var i=function s(){return this instanceof s?Reflect.construct(e,arguments,this.constructor):e.apply(this,arguments)};i.prototype=e.prototype}else i={};return Object.defineProperty(i,"__esModule",{value:!0}),Object.keys(t).forEach(function(s){var r=Object.getOwnPropertyDescriptor(t,s);Object.defineProperty(i,s,r.get?r:{enumerable:!0,get:function(){return t[s]}})}),i}var L0={exports:{}};const u2={},p2=Object.freeze(Object.defineProperty({__proto__:null,default:u2},Symbol.toStringTag,{value:"Module"})),f2=d2(p2);(function(t,e){(function(s,r){t.exports=r()})(c2,()=>(()=>{var i={"./original-repo/interpreter.js":function(a,o,l){/**
 * @license
 * Copyright 2013 Neil Fraser
 * SPDX-License-Identifier: Apache-2.0
 */var c=function(h,d){typeof h=="string"&&(h=this.parse_(h,"code"));var u=h.constructor;this.newNode=function(){return new u({options:{}})};var p=this.newNode();for(var f in h)p[f]=f==="body"?h[f].slice():h[f];this.ast=p,this.tasks=[],this.initFunc_=d,this.paused_=!1,this.polyfills_=[],this.functionCounter_=0,this.stepFunctions_=Object.create(null);var g=/^step([A-Z]\w*)$/,m;for(var y in this)typeof this[y]=="function"&&(m=y.match(g))&&(this.stepFunctions_[m[1]]=this[y].bind(this));this.globalScope=this.createScope(this.ast,null),this.globalObject=this.globalScope.object,this.ast=this.parse_(this.polyfills_.join(`
`),"polyfills"),this.polyfills_=void 0,c.stripLocations_(this.ast,void 0,void 0);var b=new c.State(this.ast,this.globalScope);b.done=!1,this.stateStack=[b],this.run(),this.value=void 0,this.ast=p,b=new c.State(this.ast,this.globalScope),b.done=!1,this.stateStack.length=0,this.stateStack[0]=b};c.Completion={NORMAL:0,BREAK:1,CONTINUE:2,RETURN:3,THROW:4},c.Status={DONE:0,STEP:1,TASK:2,ASYNC:3},c.PARSE_OPTIONS={locations:!0,ecmaVersion:5},c.READONLY_DESCRIPTOR={configurable:!0,enumerable:!0,writable:!1},c.NONENUMERABLE_DESCRIPTOR={configurable:!0,enumerable:!1,writable:!0},c.READONLY_NONENUMERABLE_DESCRIPTOR={configurable:!0,enumerable:!1,writable:!1},c.NONCONFIGURABLE_READONLY_NONENUMERABLE_DESCRIPTOR={configurable:!1,enumerable:!1,writable:!1},c.VARIABLE_DESCRIPTOR={configurable:!1,enumerable:!0,writable:!0},c.STEP_ERROR={STEP_ERROR:!0},c.SCOPE_REFERENCE={SCOPE_REFERENCE:!0},c.VALUE_IN_DESCRIPTOR={VALUE_IN_DESCRIPTOR:!0},c.REGEXP_TIMEOUT={REGEXP_TIMEOUT:!0},c.toStringCycles_=[],c.vm=null,c.currentInterpreter_=null,c.nativeGlobal=typeof globalThis>"u"?this||window:globalThis,c.WORKER_CODE=["onmessage = function(e) {","var result;","var data = e.data;","switch (data[0]) {","case 'split':","result = data[1].split(data[2], data[3]);","break;","case 'match':","result = data[1].match(data[2]);","break;","case 'search':","result = data[1].search(data[2]);","break;","case 'replace':","result = data[1].replace(data[2], data[3]);","break;","case 'exec':","var regexp = data[1];","regexp.lastIndex = data[2];","result = [regexp.exec(data[3]), data[1].lastIndex];","break;","default:","throw Error('Unknown RegExp operation: ' + data[0]);","}","postMessage(result);","close();","};"],c.legalArrayLength=function(h){var d=h>>>0;return d===Number(h)?d:NaN},c.legalArrayIndex=function(h){var d=h>>>0;return String(d)===String(h)&&d!==4294967295?d:NaN},c.stripLocations_=function(h,d,u){d?h.start=d:delete h.start,u?h.end=u:delete h.end;for(var p in h)if(h[p]!==h.loc&&h.hasOwnProperty(p)){var f=h[p];f&&typeof f=="object"&&c.stripLocations_(f,d,u)}},c.prototype.REGEXP_MODE=2,c.prototype.REGEXP_THREAD_TIMEOUT=1e3,c.prototype.POLYFILL_TIMEOUT=1e3,c.prototype.getterStep_=!1,c.prototype.setterStep_=!1,c.prototype.appendCodeNumber_=0,c.prototype.taskCodeNumber_=0,c.prototype.parse_=function(h,d){var u={};for(var p in c.PARSE_OPTIONS)u[p]=c.PARSE_OPTIONS[p];return u.sourceFile=d,c.nativeGlobal.acorn.parse(h,u)},c.prototype.appendCode=function(h){var d=this.stateStack[0];if(!d||d.node.type!=="Program")throw Error("Expecting original AST to start with a Program node");if(typeof h=="string"&&(h=this.parse_(h,"appendCode"+this.appendCodeNumber_++)),!h||h.type!=="Program")throw Error("Expecting new AST to start with a Program node");this.populateScope_(h,d.scope),Array.prototype.push.apply(d.node.body,h.body),d.node.body.variableCache_=null,d.done=!1},c.prototype.step=function(){var h=this.stateStack,d;do{var u=h[h.length-1];if(this.paused_)return!0;if(!u||u.node.type==="Program"&&u.done){if(!this.tasks.length)return!1;if(u=this.nextTask_(),!u)return!0}var p=u.node,f=c.currentInterpreter_;c.currentInterpreter_=this;try{var g=this.stepFunctions_[p.type](h,u,p)}catch(m){if(m!==c.STEP_ERROR)throw this.value!==m&&(this.value=void 0),m}finally{c.currentInterpreter_=f}if(g&&h.push(g),this.getterStep_)throw this.value=void 0,Error("Getter not supported in this context");if(this.setterStep_)throw this.value=void 0,Error("Setter not supported in this context");!d&&!p.end&&(d=Date.now()+this.POLYFILL_TIMEOUT)}while(!p.end&&d>Date.now());return!0},c.prototype.run=function(){for(;!this.paused_&&this.step(););return this.paused_},c.prototype.getStatus=function(){if(this.paused_)return c.Status.ASYNC;var h=this.stateStack,d=h[h.length-1];if(d&&(d.node.type!=="Program"||!d.done))return c.Status.STEP;var u=this.tasks[0];return u?u.time>Date.now()?c.Status.TASK:c.Status.STEP:c.Status.DONE},c.prototype.initGlobal=function(h){this.setProperty(h,"NaN",NaN,c.NONCONFIGURABLE_READONLY_NONENUMERABLE_DESCRIPTOR),this.setProperty(h,"Infinity",1/0,c.NONCONFIGURABLE_READONLY_NONENUMERABLE_DESCRIPTOR),this.setProperty(h,"undefined",void 0,c.NONCONFIGURABLE_READONLY_NONENUMERABLE_DESCRIPTOR),this.setProperty(h,"window",h,c.READONLY_DESCRIPTOR),this.setProperty(h,"this",h,c.NONCONFIGURABLE_READONLY_NONENUMERABLE_DESCRIPTOR),this.setProperty(h,"self",h),this.OBJECT_PROTO=new c.Object(null),this.FUNCTION_PROTO=new c.Object(this.OBJECT_PROTO),this.initFunction(h),this.initObject(h),h.proto=this.OBJECT_PROTO,this.setProperty(h,"constructor",this.OBJECT,c.NONENUMERABLE_DESCRIPTOR),this.initArray(h),this.initString(h),this.initBoolean(h),this.initNumber(h),this.initDate(h),this.initRegExp(h),this.initError(h),this.initMath(h),this.initJSON(h);var d=this,u,p=this.createNativeFunction(function(m){throw EvalError("Can't happen")},!1);p.eval=!0,this.setProperty(h,"eval",p,c.NONENUMERABLE_DESCRIPTOR),this.setProperty(h,"parseInt",this.createNativeFunction(parseInt,!1),c.NONENUMERABLE_DESCRIPTOR),this.setProperty(h,"parseFloat",this.createNativeFunction(parseFloat,!1),c.NONENUMERABLE_DESCRIPTOR),this.setProperty(h,"isNaN",this.createNativeFunction(isNaN,!1),c.NONENUMERABLE_DESCRIPTOR),this.setProperty(h,"isFinite",this.createNativeFunction(isFinite,!1),c.NONENUMERABLE_DESCRIPTOR);for(var f=[[escape,"escape"],[unescape,"unescape"],[decodeURI,"decodeURI"],[decodeURIComponent,"decodeURIComponent"],[encodeURI,"encodeURI"],[encodeURIComponent,"encodeURIComponent"]],g=0;g<f.length;g++)u=function(m){return function(y){try{return m(y)}catch(b){d.throwException(d.URI_ERROR,b.message)}}}(f[g][0]),this.setProperty(h,f[g][1],this.createNativeFunction(u,!1),c.NONENUMERABLE_DESCRIPTOR);u=function(y){return d.createTask_(!1,arguments)},this.setProperty(h,"setTimeout",this.createNativeFunction(u,!1),c.NONENUMERABLE_DESCRIPTOR),u=function(y){return d.createTask_(!0,arguments)},this.setProperty(h,"setInterval",this.createNativeFunction(u,!1),c.NONENUMERABLE_DESCRIPTOR),u=function(y){d.deleteTask_(y)},this.setProperty(h,"clearTimeout",this.createNativeFunction(u,!1),c.NONENUMERABLE_DESCRIPTOR),u=function(y){d.deleteTask_(y)},this.setProperty(h,"clearInterval",this.createNativeFunction(u,!1),c.NONENUMERABLE_DESCRIPTOR),this.OBJECT=this.OBJECT,this.OBJECT_PROTO=this.OBJECT_PROTO,this.FUNCTION=this.FUNCTION,this.FUNCTION_PROTO=this.FUNCTION_PROTO,this.ARRAY=this.ARRAY,this.ARRAY_PROTO=this.ARRAY_PROTO,this.REGEXP=this.REGEXP,this.REGEXP_PROTO=this.REGEXP_PROTO,this.DATE=this.DATE,this.DATE_PROTO=this.DATE_PROTO,this.initFunc_&&this.initFunc_(this,h)},c.prototype.functionCodeNumber_=0,c.prototype.initFunction=function(h){var d=this,u,p=/^[A-Za-z_$][\w$]*$/;u=function(g){if(arguments.length)var m=String(arguments[arguments.length-1]);else var m="";var y=Array.prototype.slice.call(arguments,0,-1).join(",").trim();if(y){for(var b=y.split(/\s*,\s*/),w=0;w<b.length;w++){var k=b[w];p.test(k)||d.throwException(d.SYNTAX_ERROR,"Invalid function argument: "+k)}y=b.join(", ")}try{var x=d.parse_("(function("+y+") {"+m+"})","function"+d.functionCodeNumber_++)}catch(_){d.throwException(d.SYNTAX_ERROR,"Invalid code: "+_.message)}x.body.length!==1&&d.throwException(d.SYNTAX_ERROR,"Invalid code in function body");var E=x.body[0].expression;return d.createFunction(E,d.globalScope,"anonymous")},this.FUNCTION=this.createNativeFunction(u,!0),this.setProperty(h,"Function",this.FUNCTION,c.NONENUMERABLE_DESCRIPTOR),this.setProperty(this.FUNCTION,"prototype",this.FUNCTION_PROTO,c.NONENUMERABLE_DESCRIPTOR),this.setProperty(this.FUNCTION_PROTO,"constructor",this.FUNCTION,c.NONENUMERABLE_DESCRIPTOR),this.FUNCTION_PROTO.nativeFunc=function(){},this.FUNCTION_PROTO.nativeFunc.id=this.functionCounter_++,this.FUNCTION_PROTO.illegalConstructor=!0,this.setProperty(this.FUNCTION_PROTO,"length",0,c.READONLY_NONENUMERABLE_DESCRIPTOR),this.FUNCTION_PROTO.class="Function",u=function(g,m,y){var b=d.stateStack[d.stateStack.length-1];b.func_=g,b.funcThis_=m,b.arguments_=[],y!=null&&(y instanceof c.Object?b.arguments_=Array.from(y.properties):d.throwException(d.TYPE_ERROR,"CreateListFromArrayLike called on non-object")),b.doneExec_=!1},this.setNativeFunctionPrototype(this.FUNCTION,"apply",u),this.polyfills_.push("(function() {","var apply_ = Function.prototype.apply;","Function.prototype.apply = function apply(thisArg, args) {","var a2 = [];","for (var i = 0; i < args.length; i++) {","a2[i] = args[i];","}","return apply_(this, thisArg, a2);","};","})();"),u=function(g){var m=d.stateStack[d.stateStack.length-1];m.func_=this,m.funcThis_=g,m.arguments_=[];for(var y=1;y<arguments.length;y++)m.arguments_.push(arguments[y]);m.doneExec_=!1},this.setNativeFunctionPrototype(this.FUNCTION,"call",u),this.polyfills_.push("Object.defineProperty(Function.prototype, 'bind',","{configurable: true, writable: true, value:","function bind(oThis) {","if (typeof this !== 'function') {","throw TypeError('What is trying to be bound is not callable');","}","var aArgs   = Array.prototype.slice.call(arguments, 1),","fToBind = this,","fNOP    = function() {},","fBound  = function() {","return fToBind.apply(this instanceof fNOP","? this",": oThis,","aArgs.concat(Array.prototype.slice.call(arguments)));","};","if (this.prototype) {","fNOP.prototype = this.prototype;","}","fBound.prototype = new fNOP();","return fBound;","}","});",""),u=function(){return String(this)},this.setNativeFunctionPrototype(this.FUNCTION,"toString",u),this.setProperty(this.FUNCTION,"toString",this.createNativeFunction(u,!1),c.NONENUMERABLE_DESCRIPTOR),u=function(){return this.valueOf()},this.setNativeFunctionPrototype(this.FUNCTION,"valueOf",u),this.setProperty(this.FUNCTION,"valueOf",this.createNativeFunction(u,!1),c.NONENUMERABLE_DESCRIPTOR)},c.prototype.initObject=function(h){var d=this,u;u=function(g){if(g==null)return d.calledWithNew()?this:d.createObjectProto(d.OBJECT_PROTO);if(!(g instanceof c.Object)){var m=d.createObjectProto(d.getPrototype(g));return m.data=g,m}return g},this.OBJECT=this.createNativeFunction(u,!0),this.setProperty(this.OBJECT,"prototype",this.OBJECT_PROTO,c.NONENUMERABLE_DESCRIPTOR),this.setProperty(this.OBJECT_PROTO,"constructor",this.OBJECT,c.NONENUMERABLE_DESCRIPTOR),this.setProperty(h,"Object",this.OBJECT,c.NONENUMERABLE_DESCRIPTOR);var p=function(f){f==null&&d.throwException(d.TYPE_ERROR,"Cannot convert '"+f+"' to object")};u=function(g){p(g);var m=g instanceof c.Object?g.properties:g;return d.nativeToPseudo(Object.getOwnPropertyNames(m))},this.setProperty(this.OBJECT,"getOwnPropertyNames",this.createNativeFunction(u,!1),c.NONENUMERABLE_DESCRIPTOR),u=function(g){return p(g),g instanceof c.Object&&(g=g.properties),d.nativeToPseudo(Object.keys(g))},this.setProperty(this.OBJECT,"keys",this.createNativeFunction(u,!1),c.NONENUMERABLE_DESCRIPTOR),u=function(g){return g===null?d.createObjectProto(null):(g instanceof c.Object||d.throwException(d.TYPE_ERROR,"Object prototype may only be an Object or null, not "+g),d.createObjectProto(g))},this.setProperty(this.OBJECT,"create",this.createNativeFunction(u,!1),c.NONENUMERABLE_DESCRIPTOR),this.polyfills_.push("(function() {","var create_ = Object.create;","Object.create = function create(proto, props) {","var obj = create_(proto);","props && Object.defineProperties(obj, props);","return obj;","};","})();",""),u=function(g,m,y){return m=String(m),g instanceof c.Object||d.throwException(d.TYPE_ERROR,"Object.defineProperty called on non-object: "+g),y instanceof c.Object||d.throwException(d.TYPE_ERROR,"Property description must be an object"),g.preventExtensions&&!(m in g.properties)&&d.throwException(d.TYPE_ERROR,"Can't define property '"+m+"', object is not extensible"),d.setProperty(g,m,c.VALUE_IN_DESCRIPTOR,y.properties),g},this.setProperty(this.OBJECT,"defineProperty",this.createNativeFunction(u,!1),c.NONENUMERABLE_DESCRIPTOR),this.polyfills_.push("(function() {","var defineProperty_ = Object.defineProperty;","Object.defineProperty = function defineProperty(obj, prop, d1) {","var d2 = {};","if ('configurable' in d1) d2.configurable = d1.configurable;","if ('enumerable' in d1) d2.enumerable = d1.enumerable;","if ('writable' in d1) d2.writable = d1.writable;","if ('value' in d1) d2.value = d1.value;","if ('get' in d1) d2.get = d1.get;","if ('set' in d1) d2.set = d1.set;","return defineProperty_(obj, prop, d2);","};","})();","Object.defineProperty(Object, 'defineProperties',","{configurable: true, writable: true, value:","function defineProperties(obj, props) {","var keys = Object.keys(props);","for (var i = 0; i < keys.length; i++) {","Object.defineProperty(obj, keys[i], props[keys[i]]);","}","return obj;","}","});",""),u=function(g,m){if(g instanceof c.Object||d.throwException(d.TYPE_ERROR,"Object.getOwnPropertyDescriptor called on non-object: "+g),m=String(m),m in g.properties){var y=Object.getOwnPropertyDescriptor(g.properties,m),b=g.getter[m],w=g.setter[m],k=d.createObjectProto(d.OBJECT_PROTO);return b||w?(d.setProperty(k,"get",b),d.setProperty(k,"set",w)):(d.setProperty(k,"value",y.value),d.setProperty(k,"writable",y.writable)),d.setProperty(k,"configurable",y.configurable),d.setProperty(k,"enumerable",y.enumerable),k}},this.setProperty(this.OBJECT,"getOwnPropertyDescriptor",this.createNativeFunction(u,!1),c.NONENUMERABLE_DESCRIPTOR),u=function(g){return p(g),d.getPrototype(g)},this.setProperty(this.OBJECT,"getPrototypeOf",this.createNativeFunction(u,!1),c.NONENUMERABLE_DESCRIPTOR),u=function(g){return!!g&&!g.preventExtensions},this.setProperty(this.OBJECT,"isExtensible",this.createNativeFunction(u,!1),c.NONENUMERABLE_DESCRIPTOR),u=function(g){return g instanceof c.Object&&(g.preventExtensions=!0),g},this.setProperty(this.OBJECT,"preventExtensions",this.createNativeFunction(u,!1),c.NONENUMERABLE_DESCRIPTOR),this.setNativeFunctionPrototype(this.OBJECT,"toString",c.Object.prototype.toString),this.setNativeFunctionPrototype(this.OBJECT,"toLocaleString",c.Object.prototype.toString),this.setNativeFunctionPrototype(this.OBJECT,"valueOf",c.Object.prototype.valueOf),u=function(g){return p(this),this instanceof c.Object?String(g)in this.properties:this.hasOwnProperty(g)},this.setNativeFunctionPrototype(this.OBJECT,"hasOwnProperty",u),u=function(g){return p(this),this instanceof c.Object?Object.prototype.propertyIsEnumerable.call(this.properties,g):this.propertyIsEnumerable(g)},this.setNativeFunctionPrototype(this.OBJECT,"propertyIsEnumerable",u),u=function(g){for(;;){if(g=d.getPrototype(g),!g)return!1;if(g===this)return!0}},this.setNativeFunctionPrototype(this.OBJECT,"isPrototypeOf",u)},c.prototype.initArray=function(h){var d=this,u;u=function(f){if(d.calledWithNew())var g=this;else var g=d.createArray();var m=arguments[0];if(arguments.length===1&&typeof m=="number")isNaN(c.legalArrayLength(m))&&d.throwException(d.RANGE_ERROR,"Invalid array length: "+m),g.properties.length=m;else{for(var y=0;y<arguments.length;y++)g.properties[y]=arguments[y];g.properties.length=y}return g},this.ARRAY=this.createNativeFunction(u,!0),this.ARRAY_PROTO=this.ARRAY.properties.prototype,this.setProperty(h,"Array",this.ARRAY,c.NONENUMERABLE_DESCRIPTOR),u=function(f){return f&&f.class==="Array"},this.setProperty(this.ARRAY,"isArray",this.createNativeFunction(u,!1),c.NONENUMERABLE_DESCRIPTOR),this.setProperty(this.ARRAY_PROTO,"length",0,{configurable:!1,enumerable:!1,writable:!0}),this.ARRAY_PROTO.class="Array",this.polyfills_.push("(function() {","function createArrayMethod_(name, func) {","Object.defineProperty(func, 'name', {value: name});","Object.defineProperty(Array.prototype, name,","{configurable: true, writable: true, value: func});","}","createArrayMethod_('pop',","function() {","if (!this) throw TypeError();","var o = Object(this), len = o.length >>> 0;","if (!len || len < 0) {","o.length = 0;","return undefined;","}","len--;","var x = o[len];","delete o[len];","o.length = len;","return x;","}",");","createArrayMethod_('push',","function(var_args) {","if (!this) throw TypeError();","var o = Object(this), len = o.length >>> 0;","for (var i = 0; i < arguments.length; i++) {","o[len] = arguments[i];","len++;","}","o.length = len;","return len;","}",");","createArrayMethod_('shift',","function() {","if (!this) throw TypeError();","var o = Object(this), len = o.length >>> 0;","if (!len || len < 0) {","o.length = 0;","return undefined;","}","var value = o[0];","for (var i = 0; i < len - 1; i++) {","if ((i + 1) in o) {","o[i] = o[i + 1];","} else {","delete o[i];","}","}","delete o[i];","o.length = len - 1;","return value;","}",");","createArrayMethod_('unshift',","function(var_args) {","if (!this) throw TypeError();","var o = Object(this), len = o.length >>> 0;","if (!len || len < 0) {","len = 0;","}","for (var i = len - 1; i >= 0; i--) {","if (i in o) {","o[i + arguments.length] = o[i];","} else {","delete o[i + arguments.length];","}","}","for (var i = 0; i < arguments.length; i++) {","o[i] = arguments[i];","}","return (o.length = len + arguments.length);","}",");","createArrayMethod_('reverse',","function() {","if (!this) throw TypeError();","var o = Object(this), len = o.length >>> 0;","if (!len || len < 2) {","return o;","}","for (var i = 0; i < len / 2 - 0.5; i++) {","var x = o[i];","var hasX = i in o;","if ((len - i - 1) in o) {","o[i] = o[len - i - 1];","} else {","delete o[i];","}","if (hasX) {","o[len - i - 1] = x;","} else {","delete o[len - i - 1];","}","}","return o;","}",");","createArrayMethod_('indexOf',","function(searchElement, fromIndex) {","if (!this) throw TypeError();","var o = Object(this), len = o.length >>> 0;","var n = fromIndex | 0;","if (!len || n >= len) {","return -1;","}","var i = Math.max(n >= 0 ? n : len - Math.abs(n), 0);","while (i < len) {","if (i in o && o[i] === searchElement) {","return i;","}","i++;","}","return -1;","}",");","createArrayMethod_('lastIndexOf',","function(searchElement, fromIndex) {","if (!this) throw TypeError();","var o = Object(this), len = o.length >>> 0;","if (!len) {","return -1;","}","var n = len - 1;","if (arguments.length > 1) {","n = fromIndex | 0;","if (n) {","n = (n > 0 || -1) * Math.floor(Math.abs(n));","}","}","var i = n >= 0 ? Math.min(n, len - 1) : len - Math.abs(n);","while (i >= 0) {","if (i in o && o[i] === searchElement) {","return i;","}","i--;","}","return -1;","}",");","createArrayMethod_('slice',","function(start, end) {","if (!this) throw TypeError();","var o = Object(this), len = o.length >>> 0;","start |= 0;","start = (start >= 0) ? start : Math.max(0, len + start);","if (typeof end !== 'undefined') {","if (end !== Infinity) {","end |= 0;","}","if (end < 0) {","end = len + end;","} else {","end = Math.min(end, len);","}","} else {","end = len;","}","var size = end - start;","var cloned = new Array(size);","for (var i = 0; i < size; i++) {","if ((start + i) in o) {","cloned[i] = o[start + i];","}","}","return cloned;","}",");","createArrayMethod_('splice',","function(start, deleteCount, var_args) {","if (!this) throw TypeError();","var o = Object(this), len = o.length >>> 0;","start |= 0;","if (start < 0) {","start = Math.max(len + start, 0);","} else {","start = Math.min(start, len);","}","if (arguments.length < 2) {","deleteCount = len - start;","} else {","deleteCount |= 0;","deleteCount = Math.max(0, Math.min(deleteCount, len - start));","}","var removed = [];","for (var i = start; i < start + deleteCount; i++) {","if (i in o) {","removed.push(o[i]);","} else {","removed.length++;","}","if ((i + deleteCount) in o) {","o[i] = o[i + deleteCount];","} else {","delete o[i];","}","}","for (var i = start + deleteCount; i < len - deleteCount; i++) {","if ((i + deleteCount) in o) {","o[i] = o[i + deleteCount];","} else {","delete o[i];","}","}","for (var i = len - deleteCount; i < len; i++) {","delete o[i];","}","len -= deleteCount;","if (arguments.length > 2) {","var arl = arguments.length - 2;","for (var i = len - 1; i >= start; i--) {","if (i in o) {","o[i + arl] = o[i];","} else {","delete o[i + arl];","}","}","len += arl;","for (var i = 2; i < arguments.length; i++) {","o[start + i - 2] = arguments[i];","}","}","o.length = len;","return removed;","}",");","createArrayMethod_('concat',","function(var_args) {","if (!this) throw TypeError();","var o = Object(this);","var cloned = [];","for (var i = -1; i < arguments.length; i++) {","var value = (i === -1) ? o : arguments[i];","if (Array.isArray(value)) {","for (var j = 0, l = value.length; j < l; j++) {","if (j in value) {","cloned.push(value[j]);","} else {","cloned.length++;","}","}","} else {","cloned.push(value);","}","}","return cloned;","}",");","createArrayMethod_('join',","function(opt_separator) {","if (!this) throw TypeError();","var o = Object(this), len = o.length >>> 0;","var sep = typeof opt_separator === 'undefined' ?","',' : ('' + opt_separator);","var str = '';","for (var i = 0; i < len; i++) {","if (i && sep) str += sep;","str += (o[i] === null || o[i] === undefined) ? '' : o[i];","}","return str;","}",");","createArrayMethod_('every',","function(callback, thisArg) {","if (!this || typeof callback !== 'function') throw TypeError();","var t, k = 0;","var o = Object(this), len = o.length >>> 0;","if (arguments.length > 1) t = thisArg;","while (k < len) {","if (k in o && !callback.call(t, o[k], k, o)) return false;","k++;","}","return true;","}",");","createArrayMethod_('filter',","function(callback, var_args) {","if (!this || typeof callback !== 'function') throw TypeError();","var o = Object(this), len = o.length >>> 0;","var res = [];","var thisArg = arguments.length >= 2 ? arguments[1] : void 0;","for (var i = 0; i < len; i++) {","if (i in o) {","var val = o[i];","if (callback.call(thisArg, val, i, o)) res.push(val);","}","}","return res;","}",");","createArrayMethod_('forEach',","function(callback, thisArg) {","if (!this || typeof callback !== 'function') throw TypeError();","var t, k = 0;","var o = Object(this), len = o.length >>> 0;","if (arguments.length > 1) t = thisArg;","while (k < len) {","if (k in o) callback.call(t, o[k], k, o);","k++;","}","}",");","createArrayMethod_('map',","function(callback, thisArg) {","if (!this || typeof callback !== 'function') throw TypeError();","var t, k = 0;","var o = Object(this), len = o.length >>> 0;","if (arguments.length > 1) t = thisArg;","var a = new Array(len);","while (k < len) {","if (k in o) a[k] = callback.call(t, o[k], k, o);","k++;","}","return a;","}",");","createArrayMethod_('reduce',","function(callback /*, initialValue*/) {","if (!this || typeof callback !== 'function') throw TypeError();","var o = Object(this), len = o.length >>> 0;","var k = 0, value;","if (arguments.length === 2) {","value = arguments[1];","} else {","while (k < len && !(k in o)) k++;","if (k >= len) {","throw TypeError('Reduce of empty array with no initial value');","}","value = o[k++];","}","for (; k < len; k++) {","if (k in o) value = callback(value, o[k], k, o);","}","return value;","}",");","createArrayMethod_('reduceRight',","function(callback /*, initialValue*/) {","if (!this || typeof callback !== 'function') throw TypeError();","var o = Object(this), len = o.length >>> 0;","var k = len - 1, value;","if (arguments.length >= 2) {","value = arguments[1];","} else {","while (k >= 0 && !(k in o)) k--;","if (k < 0) {","throw TypeError('Reduce of empty array with no initial value');","}","value = o[k--];","}","for (; k >= 0; k--) {","if (k in o) value = callback(value, o[k], k, o);","}","return value;","}",");","createArrayMethod_('some',","function(callback /*, thisArg*/) {","if (!this || typeof callback !== 'function') throw TypeError();","var o = Object(this), len = o.length >>> 0;","var thisArg = arguments.length >= 2 ? arguments[1] : void 0;","for (var i = 0; i < len; i++) {","if (i in o && callback.call(thisArg, o[i], i, o)) return true;","}","return false;","}",");","createArrayMethod_('sort',","function(opt_comp) {","if (!this) throw TypeError();","if (typeof opt_comp !== 'function') {","opt_comp = undefined;","}","for (var i = 0; i < this.length; i++) {","var changes = 0;","for (var j = 0; j < this.length - i - 1; j++) {","if (opt_comp ? (opt_comp(this[j], this[j + 1]) > 0) :","(String(this[j]) > String(this[j + 1]))) {","var swap = this[j];","var hasSwap = j in this;","if ((j + 1) in this) {","this[j] = this[j + 1];","} else {","delete this[j];","}","if (hasSwap) {","this[j + 1] = swap;","} else {","delete this[j + 1];","}","changes++;","}","}","if (!changes) break;","}","return this;","}",");","createArrayMethod_('toLocaleString',","function() {","if (!this) throw TypeError();","var o = Object(this), len = o.length >>> 0;","var out = [];","for (var i = 0; i < len; i++) {","out[i] = (o[i] === null || o[i] === undefined) ? '' : o[i].toLocaleString();","}","return out.join(',');","}",");","})();","")},c.prototype.initString=function(h){var d=this,u;u=function(m){return m=arguments.length?c.nativeGlobal.String(m):"",d.calledWithNew()?(this.data=m,this):m},this.STRING=this.createNativeFunction(u,!0),this.setProperty(h,"String",this.STRING,c.NONENUMERABLE_DESCRIPTOR),this.setProperty(this.STRING,"fromCharCode",this.createNativeFunction(String.fromCharCode,!1),c.NONENUMERABLE_DESCRIPTOR);for(var p=["charAt","charCodeAt","concat","indexOf","lastIndexOf","slice","substr","substring","toLocaleLowerCase","toLocaleUpperCase","toLowerCase","toUpperCase","trim"],f=0;f<p.length;f++)this.setNativeFunctionPrototype(this.STRING,p[f],String.prototype[p[f]]);u=function(m,y,b){y=d.pseudoToNative(y),b=d.pseudoToNative(b);try{return String(this).localeCompare(m,y,b)}catch(w){d.throwException(d.ERROR,"localeCompare: "+w.message)}},this.setNativeFunctionPrototype(this.STRING,"localeCompare",u),u=function(m,y,b){var w=String(this);if(y=y?Number(y):void 0,d.isa(m,d.REGEXP)&&(m=m.data,d.maybeThrowRegExp(m,b),d.REGEXP_MODE===2)){if(c.vm){var k={string:w,separator:m,limit:y},x="string.split(separator, limit)",R=d.vmCall(x,k,m,b);R!==c.REGEXP_TIMEOUT&&b(d.nativeToPseudo(R))}else{var E=d.createWorker(),_=d.regExpTimeout(m,E,b);E.onmessage=function(C){clearTimeout(_),b(d.nativeToPseudo(C.data))},E.postMessage(["split",w,m,y])}return}var R=w.split(m,y);b(d.nativeToPseudo(R))},this.setAsyncFunctionPrototype(this.STRING,"split",u),u=function(m,y){var b=String(this);if(m=d.isa(m,d.REGEXP)?m.data:new RegExp(m),d.maybeThrowRegExp(m,y),d.REGEXP_MODE===2){if(c.vm){var w={string:b,regexp:m},k="string.match(regexp)",_=d.vmCall(k,w,m,y);_!==c.REGEXP_TIMEOUT&&y(_&&d.matchToPseudo_(_))}else{var x=d.createWorker(),E=d.regExpTimeout(m,x,y);x.onmessage=function(R){clearTimeout(E),y(R.data&&d.matchToPseudo_(R.data))},x.postMessage(["match",b,m])}return}var _=b.match(m);y(_&&d.matchToPseudo_(_))},this.setAsyncFunctionPrototype(this.STRING,"match",u),u=function(m,y){var b=String(this);if(d.isa(m,d.REGEXP)?m=m.data:m=new RegExp(m),d.maybeThrowRegExp(m,y),d.REGEXP_MODE===2){if(c.vm){var w={string:b,regexp:m},k="string.search(regexp)",x=d.vmCall(k,w,m,y);x!==c.REGEXP_TIMEOUT&&y(x)}else{var E=d.createWorker(),_=d.regExpTimeout(m,E,y);E.onmessage=function(R){clearTimeout(_),y(R.data)},E.postMessage(["search",b,m])}return}y(b.search(m))},this.setAsyncFunctionPrototype(this.STRING,"search",u),u=function(m,y,b){var w=String(this);if(y=String(y),d.isa(m,d.REGEXP)&&(m=m.data,d.maybeThrowRegExp(m,b),d.REGEXP_MODE===2)){if(c.vm){var k={string:w,substr:m,newSubstr:y},x="string.replace(substr, newSubstr)",E=d.vmCall(x,k,m,b);E!==c.REGEXP_TIMEOUT&&b(E)}else{var _=d.createWorker(),R=d.regExpTimeout(m,_,b);_.onmessage=function(C){clearTimeout(R),b(C.data)},_.postMessage(["replace",w,m,y])}return}b(w.replace(m,y))},this.setAsyncFunctionPrototype(this.STRING,"replace",u),this.polyfills_.push("(function() {","var replace_ = String.prototype.replace;","String.prototype.replace = function replace(substr, newSubstr) {","if (typeof newSubstr !== 'function') {","return replace_.call(this, substr, newSubstr);","}","var str = this;","if (substr instanceof RegExp) {","var subs = [];","var m = substr.exec(str);","while (m) {","m.push(m.index, str);","var inject = newSubstr.apply(null, m);","subs.push([m.index, m[0].length, inject]);","m = substr.global ? substr.exec(str) : null;","}","for (var i = subs.length - 1; i >= 0; i--) {","str = str.substring(0, subs[i][0]) + subs[i][2] + ","str.substring(subs[i][0] + subs[i][1]);","}","} else {","var i = str.indexOf(substr);","if (i !== -1) {","var inject = newSubstr(str.substr(i, substr.length), i, str);","str = str.substring(0, i) + inject + ","str.substring(i + substr.length);","}","}","return str;","};","})();","")},c.prototype.initBoolean=function(h){var d=this,u;u=function(f){return f=c.nativeGlobal.Boolean(f),d.calledWithNew()?(this.data=f,this):f},this.BOOLEAN=this.createNativeFunction(u,!0),this.setProperty(h,"Boolean",this.BOOLEAN,c.NONENUMERABLE_DESCRIPTOR)},c.prototype.initNumber=function(h){var d=this,u;u=function(m){return m=arguments.length?c.nativeGlobal.Number(m):0,d.calledWithNew()?(this.data=m,this):m},this.NUMBER=this.createNativeFunction(u,!0),this.setProperty(h,"Number",this.NUMBER,c.NONENUMERABLE_DESCRIPTOR);for(var p=["MAX_VALUE","MIN_VALUE","NaN","NEGATIVE_INFINITY","POSITIVE_INFINITY"],f=0;f<p.length;f++)this.setProperty(this.NUMBER,p[f],Number[p[f]],c.NONCONFIGURABLE_READONLY_NONENUMERABLE_DESCRIPTOR);u=function(m){try{return Number(this).toExponential(m)}catch(y){d.throwException(d.ERROR,y.message)}},this.setNativeFunctionPrototype(this.NUMBER,"toExponential",u),u=function(m){try{return Number(this).toFixed(m)}catch(y){d.throwException(d.ERROR,y.message)}},this.setNativeFunctionPrototype(this.NUMBER,"toFixed",u),u=function(m){try{return Number(this).toPrecision(m)}catch(y){d.throwException(d.ERROR,y.message)}},this.setNativeFunctionPrototype(this.NUMBER,"toPrecision",u),u=function(m){try{return Number(this).toString(m)}catch(y){d.throwException(d.ERROR,y.message)}},this.setNativeFunctionPrototype(this.NUMBER,"toString",u),u=function(m,y){m=m?d.pseudoToNative(m):void 0,y=y?d.pseudoToNative(y):void 0;try{return Number(this).toLocaleString(m,y)}catch(b){d.throwException(d.ERROR,"toLocaleString: "+b.message)}},this.setNativeFunctionPrototype(this.NUMBER,"toLocaleString",u)},c.prototype.initDate=function(h){var d=this,u;u=function(m,y){if(!d.calledWithNew())return c.nativeGlobal.Date();var b=[null].concat(Array.from(arguments));return this.data=new(Function.prototype.bind.apply(c.nativeGlobal.Date,b)),this},this.DATE=this.createNativeFunction(u,!0),this.DATE_PROTO=this.DATE.properties.prototype,this.setProperty(h,"Date",this.DATE,c.NONENUMERABLE_DESCRIPTOR),this.setProperty(this.DATE,"now",this.createNativeFunction(Date.now,!1),c.NONENUMERABLE_DESCRIPTOR),this.setProperty(this.DATE,"parse",this.createNativeFunction(Date.parse,!1),c.NONENUMERABLE_DESCRIPTOR),this.setProperty(this.DATE,"UTC",this.createNativeFunction(Date.UTC,!1),c.NONENUMERABLE_DESCRIPTOR);for(var p=["getDate","getDay","getFullYear","getHours","getMilliseconds","getMinutes","getMonth","getSeconds","getTime","getTimezoneOffset","getUTCDate","getUTCDay","getUTCFullYear","getUTCHours","getUTCMilliseconds","getUTCMinutes","getUTCMonth","getUTCSeconds","getYear","setDate","setFullYear","setHours","setMilliseconds","setMinutes","setMonth","setSeconds","setTime","setUTCDate","setUTCFullYear","setUTCHours","setUTCMilliseconds","setUTCMinutes","setUTCMonth","setUTCSeconds","setYear","toDateString","toJSON","toGMTString","toLocaleDateString","toLocaleString","toLocaleTimeString","toTimeString","toUTCString"],f=0;f<p.length;f++)u=function(g){return function(m){var y=this.data;y instanceof Date||d.throwException(d.TYPE_ERROR,g+" not called on a Date");for(var b=[],w=0;w<arguments.length;w++)b[w]=d.pseudoToNative(arguments[w]);return y[g].apply(y,b)}}(p[f]),this.setNativeFunctionPrototype(this.DATE,p[f],u);u=function(){try{return this.data.toISOString()}catch(m){d.throwException(d.RANGE_ERROR,"toISOString: "+m.message)}},this.setNativeFunctionPrototype(this.DATE,"toISOString",u)},c.prototype.initRegExp=function(h){var d=this,u;u=function(f,g){if(d.calledWithNew())var m=this;else{if(g===void 0&&d.isa(f,d.REGEXP))return f;var m=d.createObjectProto(d.REGEXP_PROTO)}f=f===void 0?"":String(f),g=g?String(g):"",/^[gmi]*$/.test(g)||d.throwException(d.SYNTAX_ERROR,"Invalid regexp flag: "+g);try{var y=new c.nativeGlobal.RegExp(f,g)}catch(b){d.throwException(d.SYNTAX_ERROR,b.message)}return d.populateRegExp(m,y),m},this.REGEXP=this.createNativeFunction(u,!0),this.REGEXP_PROTO=this.REGEXP.properties.prototype,this.setProperty(h,"RegExp",this.REGEXP,c.NONENUMERABLE_DESCRIPTOR),this.setProperty(this.REGEXP.properties.prototype,"global",void 0,c.READONLY_NONENUMERABLE_DESCRIPTOR),this.setProperty(this.REGEXP.properties.prototype,"ignoreCase",void 0,c.READONLY_NONENUMERABLE_DESCRIPTOR),this.setProperty(this.REGEXP.properties.prototype,"multiline",void 0,c.READONLY_NONENUMERABLE_DESCRIPTOR),this.setProperty(this.REGEXP.properties.prototype,"source","(?:)",c.READONLY_NONENUMERABLE_DESCRIPTOR),this.polyfills_.push("Object.defineProperty(RegExp.prototype, 'test',","{configurable: true, writable: true, value:","function test(str) {","return !!this.exec(str);","}","});"),u=function(f,g){var m=this.data;if(f=String(f),m.lastIndex=Number(d.getProperty(this,"lastIndex")),d.maybeThrowRegExp(m,g),d.REGEXP_MODE===2){if(c.vm){var y={string:f,regexp:m},b="regexp.exec(string)",E=d.vmCall(b,y,m,g);E!==c.REGEXP_TIMEOUT&&(d.setProperty(this,"lastIndex",m.lastIndex),g(d.matchToPseudo_(E)))}else{var w=d.createWorker(),k=d.regExpTimeout(m,w,g),x=this;w.onmessage=function(_){clearTimeout(k),d.setProperty(x,"lastIndex",_.data[1]),g(d.matchToPseudo_(_.data[0]))},w.postMessage(["exec",m,m.lastIndex,f])}return}var E=m.exec(f);d.setProperty(this,"lastIndex",m.lastIndex),g(d.matchToPseudo_(E))},this.setAsyncFunctionPrototype(this.REGEXP,"exec",u)},c.prototype.matchToPseudo_=function(h){if(h){for(var d=Object.getOwnPropertyNames(h),u=0;u<d.length;u++){var p=d[u];isNaN(Number(p))&&p!=="length"&&p!=="input"&&p!=="index"&&delete h[p]}return this.nativeToPseudo(h)}return null},c.prototype.initError=function(h){var d=this;this.ERROR=this.createNativeFunction(function(f){if(d.calledWithNew())var g=this;else var g=d.createObject(d.ERROR);return d.populateError(g,f),g},!0),this.setProperty(h,"Error",this.ERROR,c.NONENUMERABLE_DESCRIPTOR),this.setProperty(this.ERROR.properties.prototype,"message","",c.NONENUMERABLE_DESCRIPTOR),this.setProperty(this.ERROR.properties.prototype,"name","Error",c.NONENUMERABLE_DESCRIPTOR);var u=function(p){var f=d.createNativeFunction(function(g){if(d.calledWithNew())var m=this;else var m=d.createObject(f);return d.populateError(m,g),m},!0);return d.setProperty(f,"prototype",d.createObject(d.ERROR),c.NONENUMERABLE_DESCRIPTOR),d.setProperty(f.properties.prototype,"name",p,c.NONENUMERABLE_DESCRIPTOR),d.setProperty(h,p,f,c.NONENUMERABLE_DESCRIPTOR),f};this.EVAL_ERROR=u("EvalError"),this.RANGE_ERROR=u("RangeError"),this.REFERENCE_ERROR=u("ReferenceError"),this.SYNTAX_ERROR=u("SyntaxError"),this.TYPE_ERROR=u("TypeError"),this.URI_ERROR=u("URIError")},c.prototype.initMath=function(h){var d=this.createObjectProto(this.OBJECT_PROTO);this.setProperty(h,"Math",d,c.NONENUMERABLE_DESCRIPTOR);for(var u=["E","LN2","LN10","LOG2E","LOG10E","PI","SQRT1_2","SQRT2"],p=0;p<u.length;p++)this.setProperty(d,u[p],Math[u[p]],c.READONLY_NONENUMERABLE_DESCRIPTOR);for(var f=["abs","acos","asin","atan","atan2","ceil","cos","exp","floor","log","max","min","pow","random","round","sin","sqrt","tan"],p=0;p<f.length;p++)this.setProperty(d,f[p],this.createNativeFunction(Math[f[p]],!1),c.NONENUMERABLE_DESCRIPTOR)},c.prototype.initJSON=function(h){var d,u=this,p=u.createObjectProto(this.OBJECT_PROTO);this.setProperty(h,"JSON",p,c.NONENUMERABLE_DESCRIPTOR),d=function(g){try{var m=JSON.parse(String(g))}catch(y){u.throwException(u.SYNTAX_ERROR,y.message)}return u.nativeToPseudo(m)},this.setProperty(p,"parse",this.createNativeFunction(d,!1)),d=function(g,m,y){m&&m.class==="Function"?u.throwException(u.TYPE_ERROR,"Function replacer on JSON.stringify not supported"):m&&m.class==="Array"?(m=u.pseudoToNative(m),m=m.filter(function(k){return typeof k=="string"||typeof k=="number"})):m=null,typeof y!="string"&&typeof y!="number"&&(y=void 0);var b=u.pseudoToNative(g);try{var w=JSON.stringify(b,m,y)}catch(k){u.throwException(u.TYPE_ERROR,k.message)}return w},this.setProperty(p,"stringify",this.createNativeFunction(d,!1))},c.prototype.isa=function(h,d){if(h==null||!d)return!1;var u=d.properties.prototype;if(h===u)return!0;for(h=this.getPrototype(h);h;){if(h===u)return!0;h=h.proto}return!1},c.prototype.populateRegExp=function(h,d){h.data=new RegExp(d.source,d.flags),this.setProperty(h,"lastIndex",d.lastIndex,c.NONENUMERABLE_DESCRIPTOR),this.setProperty(h,"source",d.source,c.READONLY_NONENUMERABLE_DESCRIPTOR),this.setProperty(h,"global",d.global,c.READONLY_NONENUMERABLE_DESCRIPTOR),this.setProperty(h,"ignoreCase",d.ignoreCase,c.READONLY_NONENUMERABLE_DESCRIPTOR),this.setProperty(h,"multiline",d.multiline,c.READONLY_NONENUMERABLE_DESCRIPTOR)},c.prototype.populateError=function(h,d){d&&this.setProperty(h,"message",String(d),c.NONENUMERABLE_DESCRIPTOR);for(var u=[],p=this.stateStack.length-1;p>=0;p--){var f=this.stateStack[p],g=f.node;if(g.type==="CallExpression"){var m=f.func_;m&&u.length&&(u[u.length-1].datumName=this.getProperty(m,"name"))}g.loc&&(!u.length||g.type==="CallExpression")&&u.push({datumLoc:g.loc})}for(var y=String(this.getProperty(h,"name")),b=String(this.getProperty(h,"message")),w=y+": "+b+`
`,p=0;p<u.length;p++){var k=u[p].datumLoc,x=u[p].datumName,E=k.source+":"+k.start.line+":"+k.start.column;x?w+="  at "+x+" ("+E+`)
`:w+="  at "+E+`
`}this.setProperty(h,"stack",w.trim(),c.NONENUMERABLE_DESCRIPTOR)},c.prototype.createWorker=function(){var h=this.createWorker.blob_;return h||(h=new Blob([c.WORKER_CODE.join(`
`)],{type:"application/javascript"}),this.createWorker.blob_=h),new Worker(URL.createObjectURL(h))},c.prototype.vmCall=function(h,d,u,p){var f={timeout:this.REGEXP_THREAD_TIMEOUT};try{return c.vm.runInNewContext(h,d,f)}catch{p(null),this.throwException(this.ERROR,"RegExp Timeout: "+u)}return c.REGEXP_TIMEOUT},c.prototype.maybeThrowRegExp=function(h,d){var u;if(this.REGEXP_MODE===0)u=!1;else if(this.REGEXP_MODE===1)u=!0;else if(c.vm)u=!0;else if(typeof Worker=="function"&&typeof URL=="function")u=!0;else{try{c.vm=l("vm")}catch{}u=!!c.vm}u||(d(null),this.throwException(this.ERROR,"Regular expressions not supported: "+h))},c.prototype.regExpTimeout=function(h,d,u){var p=this;return setTimeout(function(){d.terminate(),u(null);try{p.throwException(p.ERROR,"RegExp Timeout: "+h)}catch{}},this.REGEXP_THREAD_TIMEOUT)},c.prototype.createObject=function(h){return this.createObjectProto(h&&h.properties.prototype)},c.prototype.createObjectProto=function(h){if(typeof h!="object")throw Error("Non object prototype");var d=new c.Object(h);return this.isa(d,this.ERROR)&&(d.class="Error"),d},c.prototype.createArray=function(){var h=this.createObjectProto(this.ARRAY_PROTO);return this.setProperty(h,"length",0,{configurable:!1,enumerable:!1,writable:!0}),h.class="Array",h},c.prototype.createFunctionBase_=function(h,d){var u=this.createObjectProto(this.FUNCTION_PROTO);if(d){var p=this.createObjectProto(this.OBJECT_PROTO);this.setProperty(u,"prototype",p,c.NONENUMERABLE_DESCRIPTOR),this.setProperty(p,"constructor",u,c.NONENUMERABLE_DESCRIPTOR)}else u.illegalConstructor=!0;return this.setProperty(u,"length",h,c.READONLY_NONENUMERABLE_DESCRIPTOR),u.class="Function",u},c.prototype.createFunction=function(h,d,u){var p=this.createFunctionBase_(h.params.length,!0);p.parentScope=d,p.node=h;var f=h.id?String(h.id.name):u||"";return this.setProperty(p,"name",f,c.READONLY_NONENUMERABLE_DESCRIPTOR),p},c.prototype.createNativeFunction=function(h,d){var u=this.createFunctionBase_(h.length,d);return u.nativeFunc=h,h.id=this.functionCounter_++,this.setProperty(u,"name",h.name,c.READONLY_NONENUMERABLE_DESCRIPTOR),u},c.prototype.createAsyncFunction=function(h){var d=this.createFunctionBase_(h.length,!0);return d.asyncFunc=h,h.id=this.functionCounter_++,this.setProperty(d,"name",h.name,c.READONLY_NONENUMERABLE_DESCRIPTOR),d},c.prototype.nativeToPseudo=function(h,d){if(h==null||h===!0||h===!1||typeof h=="string"||typeof h=="number")return h;if(h instanceof c.Object)throw Error("Object is already pseudo");var u=d||{pseudo:[],native:[]},p=u.native.indexOf(h);if(p!==-1)return u.pseudo[p];if(u.native.push(h),h instanceof RegExp){var f=this.createObjectProto(this.REGEXP_PROTO);return this.populateRegExp(f,h),u.pseudo.push(f),f}if(h instanceof Date){var g=this.createObjectProto(this.DATE_PROTO);return g.data=new Date(h.valueOf()),u.pseudo.push(g),g}var m;if(h instanceof Number?m=this.createObject(this.NUMBER):h instanceof String?m=this.createObject(this.STRING):h instanceof Boolean&&(m=this.createObject(this.BOOLEAN)),m)return m.data=h.valueOf(),u.pseudo.push(m),m;if(typeof h=="function"){var y=this,b=function(){var _=Array.prototype.slice.call(arguments).map(function(C){return y.pseudoToNative(C)}),R=h.apply(y,_);return y.nativeToPseudo(R)},w=Object.getOwnPropertyDescriptor(h,"prototype"),k=this.createNativeFunction(b,!!w);return u.pseudo.push(k),k}var x;Array.isArray(h)?x=this.createArray():x=this.createObjectProto(this.OBJECT_PROTO),u.pseudo.push(x);for(var E in h)this.setProperty(x,E,this.nativeToPseudo(h[E],u));return x},c.prototype.pseudoToNative=function(h,d){if(h==null||h===!0||h===!1||typeof h=="string"||typeof h=="number")return h;if(!(h instanceof c.Object))throw Error("Object is not pseudo");var u=d||{pseudo:[],native:[]},p=u.pseudo.indexOf(h);if(p!==-1)return u.native[p];if(u.pseudo.push(h),this.isa(h,this.REGEXP)){var f=new RegExp(h.data.source,h.data.flags);return f.lastIndex=h.data.lastIndex,u.native.push(f),f}if(this.isa(h,this.DATE)){var g=new Date(h.data.valueOf());return u.native.push(g),g}if(this.isa(h,this.NUMBER)||this.isa(h,this.STRING)||this.isa(h,this.BOOLEAN)){var m=Object(h.data);return u.native.push(m),m}var y=this.isa(h,this.ARRAY)?[]:{};u.native.push(y);var b;for(var w in h.properties)b=this.pseudoToNative(h.properties[w],u),Object.defineProperty(y,w,{value:b,writable:!0,enumerable:!0,configurable:!0});return y},c.prototype.getPrototype=function(h){switch(typeof h){case"number":return this.NUMBER.properties.prototype;case"boolean":return this.BOOLEAN.properties.prototype;case"string":return this.STRING.properties.prototype}return h?h.proto:null},c.prototype.getProperty=function(h,d){if(this.getterStep_)throw Error("Getter not supported in that context");if(d=String(d),h==null&&this.throwException(this.TYPE_ERROR,"Cannot read property '"+d+"' of "+h),typeof h=="object"&&!(h instanceof c.Object))throw TypeError("Expecting native value or pseudo object");if(d==="length"){if(this.isa(h,this.STRING))return String(h).length}else if(d.charCodeAt(0)<64&&this.isa(h,this.STRING)){var u=c.legalArrayIndex(d);if(!isNaN(u)&&u<String(h).length)return String(h)[u]}do if(h.properties&&d in h.properties){var p=h.getter[d];return p?(this.getterStep_=!0,p):h.properties[d]}while(h=this.getPrototype(h))},c.prototype.hasProperty=function(h,d){if(!(h instanceof c.Object))throw TypeError("Primitive data type has no properties");if(d=String(d),d==="length"&&this.isa(h,this.STRING))return!0;if(this.isa(h,this.STRING)){var u=c.legalArrayIndex(d);if(!isNaN(u)&&u<String(h).length)return!0}do if(h.properties&&d in h.properties)return!0;while(h=this.getPrototype(h));return!1},c.prototype.setProperty=function(h,d,u,p){if(this.setterStep_)throw Error("Setter not supported in that context");if(d=String(d),h==null&&this.throwException(this.TYPE_ERROR,"Cannot set property '"+d+"' of "+h),typeof h=="object"&&!(h instanceof c.Object))throw TypeError("Expecting native value or pseudo object");p&&("get"in p||"set"in p)&&("value"in p||"writable"in p)&&this.throwException(this.TYPE_ERROR,"Invalid property descriptor. Cannot both specify accessors and a value or writable attribute");var f=!this.stateStack||this.getScope().strict;if(!(h instanceof c.Object)){f&&this.throwException(this.TYPE_ERROR,"Can't create property '"+d+"' on '"+h+"'");return}if(this.isa(h,this.STRING)){var g=c.legalArrayIndex(d);if(d==="length"||!isNaN(g)&&g<String(h).length){f&&this.throwException(this.TYPE_ERROR,"Cannot assign to read only property '"+d+"' of String '"+h.data+"'");return}}if(h.class==="Array"){var m=h.properties.length,y;if(d==="length"){if(p){if(!("value"in p))return;u=p.value}if(u=c.legalArrayLength(u),isNaN(u)&&this.throwException(this.RANGE_ERROR,"Invalid array length"),u<m)for(y in h.properties)y=c.legalArrayIndex(y),!isNaN(y)&&u<=y&&delete h.properties[y]}else isNaN(y=c.legalArrayIndex(d))||(h.properties.length=Math.max(m,y+1))}if(h.preventExtensions&&!(d in h.properties)){f&&this.throwException(this.TYPE_ERROR,"Can't add property '"+d+"', object is not extensible");return}if(p){var b={};"get"in p&&p.get&&(h.getter[d]=p.get,b.get=this.setProperty.placeholderGet_),"set"in p&&p.set&&(h.setter[d]=p.set,b.set=this.setProperty.placeholderSet_),"configurable"in p&&(b.configurable=p.configurable),"enumerable"in p&&(b.enumerable=p.enumerable),"writable"in p&&(b.writable=p.writable,delete h.getter[d],delete h.setter[d]),"value"in p?(b.value=p.value,delete h.getter[d],delete h.setter[d]):u!==c.VALUE_IN_DESCRIPTOR&&(b.value=u,delete h.getter[d],delete h.setter[d]);try{Object.defineProperty(h.properties,d,b)}catch{this.throwException(this.TYPE_ERROR,"Cannot redefine property: "+d)}"get"in p&&!p.get&&delete h.getter[d],"set"in p&&!p.set&&delete h.setter[d]}else{if(u===c.VALUE_IN_DESCRIPTOR)throw ReferenceError("Value not specified");for(var w=h;!(d in w.properties);)if(w=this.getPrototype(w),!w){w=h;break}if(w.setter&&w.setter[d])return this.setterStep_=!0,w.setter[d];if(w.getter&&w.getter[d])f&&this.throwException(this.TYPE_ERROR,"Cannot set property '"+d+"' of object '"+h+"' which only has a getter");else try{h.properties[d]=u}catch{f&&this.throwException(this.TYPE_ERROR,"Cannot assign to read only property '"+d+"' of object '"+h+"'")}}},c.prototype.setProperty.placeholderGet_=function(){throw Error("Placeholder getter")},c.prototype.setProperty.placeholderSet_=function(){throw Error("Placeholder setter")},c.prototype.setNativeFunctionPrototype=function(h,d,u){this.setProperty(h.properties.prototype,d,this.createNativeFunction(u,!1),c.NONENUMERABLE_DESCRIPTOR)},c.prototype.setAsyncFunctionPrototype=function(h,d,u){this.setProperty(h.properties.prototype,d,this.createAsyncFunction(u),c.NONENUMERABLE_DESCRIPTOR)},c.prototype.getScope=function(){var h=this.stateStack[this.stateStack.length-1].scope;if(!h)throw Error("No scope found");return h},c.prototype.createScope=function(h,d){var u=!1;if(d&&d.strict)u=!0;else{var p=h.body&&h.body[0];p&&p.expression&&p.expression.type==="Literal"&&p.expression.value==="use strict"&&(u=!0)}var f=this.createObjectProto(null),g=new c.Scope(d,u,f);return d||this.initGlobal(g.object),this.populateScope_(h,g),g},c.prototype.createSpecialScope=function(h,d){if(!h)throw Error("parentScope required");var u=d||this.createObjectProto(null);return new c.Scope(h,h.strict,u)},c.prototype.getValueFromScope=function(h){for(var d=this.getScope();d&&d!==this.globalScope;){if(h in d.object.properties)return d.object.properties[h];d=d.parentScope}if(d===this.globalScope&&this.hasProperty(d.object,h))return this.getProperty(d.object,h);var u=this.stateStack[this.stateStack.length-1].node;u.type==="UnaryExpression"&&u.operator==="typeof"||this.throwException(this.REFERENCE_ERROR,h+" is not defined")},c.prototype.setValueToScope=function(h,d){for(var u=this.getScope(),p=u.strict;u&&u!==this.globalScope;){if(h in u.object.properties){try{u.object.properties[h]=d}catch{p&&this.throwException(this.TYPE_ERROR,"Cannot assign to read only variable '"+h+"'")}return}u=u.parentScope}if(u===this.globalScope&&(!p||this.hasProperty(u.object,h)))return this.setProperty(u.object,h,d);this.throwException(this.REFERENCE_ERROR,h+" is not defined")},c.prototype.populateScope_=function(h,d){var u;if(h.variableCache_)u=h.variableCache_;else{switch(u=Object.create(null),h.type){case"VariableDeclaration":for(var p=0;p<h.declarations.length;p++)u[h.declarations[p].id.name]=!0;break;case"FunctionDeclaration":u[h.id.name]=h;break;case"BlockStatement":case"CatchClause":case"DoWhileStatement":case"ForInStatement":case"ForStatement":case"IfStatement":case"LabeledStatement":case"Program":case"SwitchCase":case"SwitchStatement":case"TryStatement":case"WithStatement":case"WhileStatement":var f=h.constructor;for(var g in h)if(h[g]!==h.loc){var m=h[g];if(m&&typeof m=="object"){var y;if(Array.isArray(m)){for(var p=0;p<m.length;p++)if(m[p]&&m[p].constructor===f){y=this.populateScope_(m[p],d);for(var g in y)u[g]=y[g]}}else if(m.constructor===f){y=this.populateScope_(m,d);for(var g in y)u[g]=y[g]}}}}h.variableCache_=u}for(var g in u)u[g]===!0?this.setProperty(d.object,g,void 0,c.VARIABLE_DESCRIPTOR):this.setProperty(d.object,g,this.createFunction(u[g],d),c.VARIABLE_DESCRIPTOR);return u},c.prototype.calledWithNew=function(){return this.stateStack[this.stateStack.length-1].isConstructor},c.prototype.getValue=function(h){return h[0]===c.SCOPE_REFERENCE?this.getValueFromScope(h[1]):this.getProperty(h[0],h[1])},c.prototype.setValue=function(h,d){return h[0]===c.SCOPE_REFERENCE?this.setValueToScope(h[1],d):this.setProperty(h[0],h[1],d)},c.prototype.throwException=function(h,d){if(!this.globalScope)throw d===void 0?h:d;if(d===void 0||!(h instanceof c.Object))var u=h;else{var u=this.createObject(h);this.populateError(u,d)}throw this.unwind(c.Completion.THROW,u,void 0),c.STEP_ERROR},c.prototype.unwind=function(h,d,u){if(h===c.Completion.NORMAL)throw TypeError("Should not unwind for NORMAL completions");e:for(var p=this.stateStack;p.length>0;p.pop()){var f=p[p.length-1];switch(f.node.type){case"TryStatement":f.cv={type:h,value:d,label:u};return;case"CallExpression":case"NewExpression":if(h===c.Completion.RETURN){f.value=d;return}else if(h===c.Completion.BREAK||h===c.Completion.CONTINUE)throw Error("Unsyntactic break/continue not rejected by Acorn");break;case"Program":if(h===c.Completion.RETURN)return;f.done=!0;break e}if(h===c.Completion.BREAK){if(u?f.labels&&f.labels.indexOf(u)!==-1:f.isLoop||f.isSwitch){p.pop();return}}else if(h===c.Completion.CONTINUE&&(u?f.labels&&f.labels.indexOf(u)!==-1:f.isLoop))return}var g;if(this.isa(d,this.ERROR)){var m={EvalError,RangeError,ReferenceError,SyntaxError,TypeError,URIError},y=String(this.getProperty(d,"name")),b=this.getProperty(d,"message").valueOf(),w=m[y]||Error;g=w(b),g.stack=String(this.getProperty(d,"stack"))}else g=String(d);throw this.value=g,g},c.prototype.nodeSummary=function(h){switch(h.type){case"ArrayExpression":return"[...]";case"BinaryExpression":case"LogicalExpression":return this.nodeSummary(h.left)+" "+h.operator+" "+this.nodeSummary(h.right);case"CallExpression":return this.nodeSummary(h.callee)+"(...)";case"ConditionalExpression":return this.nodeSummary(h.test)+" ? "+this.nodeSummary(h.consequent)+" : "+this.nodeSummary(h.alternate);case"Identifier":return h.name;case"Literal":return h.raw;case"MemberExpression":var d=this.nodeSummary(h.object),u=this.nodeSummary(h.property);return h.computed?d+"["+u+"]":d+"."+u;case"NewExpression":return"new "+this.nodeSummary(h.callee)+"(...)";case"ObjectExpression":return"{...}";case"ThisExpression":return"this";case"UnaryExpression":return h.operator+" "+this.nodeSummary(h.argument);case"UpdateExpression":var p=this.nodeSummary(h.argument);return h.prefix?h.operator+p:p+h.operator}return"???"},c.prototype.createTask_=function(h,d){var u=this.stateStack[this.stateStack.length-1],p=Array.from(d),f=p.shift(),g=Math.max(Number(p.shift()||0),0),m=this.newNode(),y,b,w;if(f instanceof c.Object&&f.class==="Function")b=f,m.type="CallExpression",y=u.scope;else{try{w=this.parse_(String(f),"taskCode"+this.taskCodeNumber_++)}catch(R){this.throwException(this.SYNTAX_ERROR,"Invalid code: "+R.message)}m.type="EvalProgram_",m.body=w.body;var k=u.node.arguments[0],x=k?k.start:void 0,E=k?k.end:void 0;c.stripLocations_(m,x,E),y=this.globalScope,p.length=0}var _=new c.Task(b,p,y,m,h?g:-1);return this.scheduleTask_(_,g),_.pid},c.prototype.scheduleTask_=function(h,d){h.time=Date.now()+d,this.tasks.push(h),this.tasks.sort(function(u,p){return u.time-p.time})},c.prototype.deleteTask_=function(h){for(var d=0;d<this.tasks.length;d++)if(this.tasks[d].pid==h){this.tasks.splice(d,1);break}},c.prototype.nextTask_=function(){var h=this.tasks[0];if(!h||h.time>Date.now())return null;this.tasks.shift(),h.interval>=0&&this.scheduleTask_(h,h.interval);var d=new c.State(h.node,h.scope);return h.functionRef&&(d.doneCallee_=2,d.funcThis_=this.globalObject,d.func_=h.functionRef,d.doneArgs_=!0,d.arguments_=h.argsArray),d},c.prototype.createGetter_=function(h,d){if(!this.getterStep_)throw Error("Unexpected call to createGetter");this.getterStep_=!1;var u=Array.isArray(d)?d[0]:d,p=this.newNode();p.type="CallExpression";var f=new c.State(p,this.stateStack[this.stateStack.length-1].scope);return f.doneCallee_=2,f.funcThis_=u,f.func_=h,f.doneArgs_=!0,f.arguments_=[],f},c.prototype.createSetter_=function(h,d,u){if(!this.setterStep_)throw Error("Unexpected call to createSetter");this.setterStep_=!1;var p=Array.isArray(d)?d[0]:this.globalObject,f=this.newNode();f.type="CallExpression";var g=new c.State(f,this.stateStack[this.stateStack.length-1].scope);return g.doneCallee_=2,g.funcThis_=p,g.func_=h,g.doneArgs_=!0,g.arguments_=[u],g},c.prototype.boxThis_=function(h){if(h==null)return this.globalObject;if(!(h instanceof c.Object)){var d=this.createObjectProto(this.getPrototype(h));return d.data=h,d}return h},c.prototype.getGlobalScope=function(){return this.globalScope},c.prototype.setGlobalScope=function(h){this.globalScope=h,this.stateStack[0].scope=h},c.prototype.getStateStack=function(){return this.stateStack},c.prototype.setStateStack=function(h){this.stateStack=h},c.Value,c.State=function(h,d){this.node=h,this.scope=d},c.Scope=function(h,d,u){this.parentScope=h,this.strict=d,this.object=u},c.Object=function(h){this.getter=Object.create(null),this.setter=Object.create(null),this.properties=Object.create(null),this.proto=h},c.Object.prototype.proto=null,c.Object.prototype.class="Object",c.Object.prototype.data=null,c.Object.prototype.toString=function(){if(!c.currentInterpreter_)return"[object Interpreter.Object]";if(!(this instanceof c.Object))return String(this);if(this.class==="Array"){var h=c.toStringCycles_;h.push(this);try{var d=[],u=this.properties.length,p=!1;u>1024&&(u=1e3,p=!0);for(var f=0;f<u;f++){var g=this.properties[f];d[f]=g instanceof c.Object&&h.indexOf(g)!==-1?"...":g}p&&d.push("...")}finally{h.pop()}return d.join(",")}if(this.class==="Error"){var h=c.toStringCycles_;if(h.indexOf(this)!==-1)return"[object Error]";var m,y,b=this;do if("name"in b.properties){m=b.properties.name;break}while(b=b.proto);b=this;do if("message"in b.properties){y=b.properties.message;break}while(b=b.proto);h.push(this);try{m=m&&String(m),y=y&&String(y)}finally{h.pop()}return y?m+": "+y:String(m)}return this.data!==null?String(this.data):"[object "+this.class+"]"},c.Object.prototype.valueOf=function(){return c.currentInterpreter_?this.data===void 0||this.data===null||this.data instanceof RegExp?this:this.data instanceof Date?this.data.valueOf():this.data:this},c.Task=function(h,d,u,p,f){this.functionRef=h,this.argsArray=d,this.scope=u,this.node=p,this.interval=f,this.pid=++c.Task.pid,this.time=0},c.Task.pid=0,c.prototype.stepArrayExpression=function(h,d,u){var p=u.elements,f=d.n_||0;for(d.array_?(this.setProperty(d.array_,f,d.value),f++):(d.array_=this.createArray(),d.array_.properties.length=p.length);f<p.length;){if(p[f])return d.n_=f,new c.State(p[f],d.scope);f++}h.pop(),h[h.length-1].value=d.array_},c.prototype.stepAssignmentExpression=function(h,d,u){if(!d.doneLeft_){d.doneLeft_=!0;var p=new c.State(u.left,d.scope);return p.components=!0,p}if(!d.doneRight_){if(d.leftReference_||(d.leftReference_=d.value),d.doneGetter_&&(d.leftValue_=d.value),!d.doneGetter_&&u.operator!=="="){var f=this.getValue(d.leftReference_);if(d.leftValue_=f,this.getterStep_){d.doneGetter_=!0;var g=f;return this.createGetter_(g,d.leftReference_)}}return d.doneRight_=!0,u.operator==="="&&u.left.type==="Identifier"&&(d.destinationName=u.left.name),new c.State(u.right,d.scope)}if(d.doneSetter_){h.pop(),h[h.length-1].value=d.setterValue_;return}var m=d.leftValue_,y=d.value;switch(u.operator){case"=":m=y;break;case"+=":m+=y;break;case"-=":m-=y;break;case"*=":m*=y;break;case"/=":m/=y;break;case"%=":m%=y;break;case"<<=":m<<=y;break;case">>=":m>>=y;break;case">>>=":m>>>=y;break;case"&=":m&=y;break;case"^=":m^=y;break;case"|=":m|=y;break;default:throw SyntaxError("Unknown assignment expression: "+u.operator)}var b=this.setValue(d.leftReference_,m);if(b)return d.doneSetter_=!0,d.setterValue_=m,this.createSetter_(b,d.leftReference_,m);h.pop(),h[h.length-1].value=m},c.prototype.stepBinaryExpression=function(h,d,u){if(!d.doneLeft_)return d.doneLeft_=!0,new c.State(u.left,d.scope);if(!d.doneRight_)return d.doneRight_=!0,d.leftValue_=d.value,new c.State(u.right,d.scope);h.pop();var p=d.leftValue_,f=d.value,g;switch(u.operator){case"==":g=p==f;break;case"!=":g=p!=f;break;case"===":g=p===f;break;case"!==":g=p!==f;break;case">":g=p>f;break;case">=":g=p>=f;break;case"<":g=p<f;break;case"<=":g=p<=f;break;case"+":g=p+f;break;case"-":g=p-f;break;case"*":g=p*f;break;case"/":g=p/f;break;case"%":g=p%f;break;case"&":g=p&f;break;case"|":g=p|f;break;case"^":g=p^f;break;case"<<":g=p<<f;break;case">>":g=p>>f;break;case">>>":g=p>>>f;break;case"in":f instanceof c.Object||this.throwException(this.TYPE_ERROR,"'in' expects an object, not '"+f+"'"),g=this.hasProperty(f,p);break;case"instanceof":this.isa(f,this.FUNCTION)||this.throwException(this.TYPE_ERROR,"'instanceof' expects an object, not '"+f+"'"),g=p instanceof c.Object?this.isa(p,f):!1;break;default:throw SyntaxError("Unknown binary operator: "+u.operator)}h[h.length-1].value=g},c.prototype.stepBlockStatement=function(h,d,u){var p=d.n_||0,f=u.body[p];if(f)return d.n_=p+1,new c.State(f,d.scope);h.pop()},c.prototype.stepBreakStatement=function(h,d,u){var p=u.label&&u.label.name;this.unwind(c.Completion.BREAK,void 0,p)},c.prototype.evalCodeNumber_=0,c.prototype.stepCallExpression=function(h,d,u){if(!d.doneCallee_){d.doneCallee_=1;var p=new c.State(u.callee,d.scope);return p.components=!0,p}if(d.doneCallee_===1){d.doneCallee_=2;var f=d.value;if(Array.isArray(f)){if(d.func_=this.getValue(f),f[0]===c.SCOPE_REFERENCE?d.directEval_=f[1]==="eval":d.funcThis_=f[0],f=d.func_,this.getterStep_)return d.doneCallee_=1,this.createGetter_(f,d.value)}else d.func_=f;d.arguments_=[],d.n_=0}var f=d.func_;if(!d.doneArgs_){if(d.n_!==0&&d.arguments_.push(d.value),u.arguments[d.n_])return new c.State(u.arguments[d.n_++],d.scope);if(u.type==="NewExpression"){if((!(f instanceof c.Object)||f.illegalConstructor)&&this.throwException(this.TYPE_ERROR,this.nodeSummary(u.callee)+" is not a constructor"),f===this.ARRAY)d.funcThis_=this.createArray();else{var g=f.properties.prototype;(typeof g!="object"||g===null)&&(g=this.OBJECT_PROTO),d.funcThis_=this.createObjectProto(g)}d.isConstructor=!0}d.doneArgs_=!0}if(d.doneExec_)h.pop(),d.isConstructor&&typeof d.value!="object"?h[h.length-1].value=d.funcThis_:h[h.length-1].value=d.value;else{d.doneExec_=!0,f instanceof c.Object||this.throwException(this.TYPE_ERROR,this.nodeSummary(u.callee)+" is not a function");var m=f.node;if(m){for(var y=this.createScope(m.body,f.parentScope),b=this.createArray(),w=0;w<d.arguments_.length;w++)this.setProperty(b,w,d.arguments_[w]);this.setProperty(y.object,"arguments",b);for(var w=0;w<m.params.length;w++){var k=m.params[w].name,x=d.arguments_.length>w?d.arguments_[w]:void 0;this.setProperty(y.object,k,x)}return y.strict||(d.funcThis_=this.boxThis_(d.funcThis_)),this.setProperty(y.object,"this",d.funcThis_,c.READONLY_DESCRIPTOR),d.value=void 0,new c.State(m.body,y)}else if(f.eval){var E=d.arguments_[0];if(typeof E!="string")d.value=E;else{try{var _=this.parse_(String(E),"eval"+this.evalCodeNumber_++)}catch(L){this.throwException(this.SYNTAX_ERROR,"Invalid code: "+L.message)}var R=this.newNode();R.type="EvalProgram_",R.body=_.body,c.stripLocations_(R,u.start,u.end);var y=d.directEval_?d.scope:this.globalScope;return y.strict?y=this.createScope(_,y):this.populateScope_(_,y),this.value=void 0,new c.State(R,y)}}else if(f.nativeFunc)d.scope.strict||(d.funcThis_=this.boxThis_(d.funcThis_)),d.value=f.nativeFunc.apply(d.funcThis_,d.arguments_);else if(f.asyncFunc){var C=this,D=function(F){d.value=F,C.paused_=!1},q=f.asyncFunc.length-1,A=d.arguments_.concat(new Array(q)).slice(0,q);A.push(D),this.paused_=!0,d.scope.strict||(d.funcThis_=this.boxThis_(d.funcThis_)),f.asyncFunc.apply(d.funcThis_,A);return}else this.throwException(this.TYPE_ERROR,this.nodeSummary(u.callee)+" is not callable")}},c.prototype.stepConditionalExpression=function(h,d,u){var p=d.mode_||0;if(p===0)return d.mode_=1,new c.State(u.test,d.scope);if(p===1){d.mode_=2;var f=!!d.value;if(f&&u.consequent)return new c.State(u.consequent,d.scope);if(!f&&u.alternate)return new c.State(u.alternate,d.scope);this.value=void 0}h.pop(),u.type==="ConditionalExpression"&&(h[h.length-1].value=d.value)},c.prototype.stepContinueStatement=function(h,d,u){var p=u.label&&u.label.name;this.unwind(c.Completion.CONTINUE,void 0,p)},c.prototype.stepDebuggerStatement=function(h,d,u){h.pop()},c.prototype.stepDoWhileStatement=function(h,d,u){if(u.type==="DoWhileStatement"&&d.test_===void 0&&(d.value=!0,d.test_=!0),!d.test_)return d.test_=!0,new c.State(u.test,d.scope);if(!d.value)h.pop();else if(u.body)return d.test_=!1,d.isLoop=!0,new c.State(u.body,d.scope)},c.prototype.stepEmptyStatement=function(h,d,u){h.pop()},c.prototype.stepEvalProgram_=function(h,d,u){var p=d.n_||0,f=u.body[p];if(f)return d.n_=p+1,new c.State(f,d.scope);h.pop(),h[h.length-1].value=this.value},c.prototype.stepExpressionStatement=function(h,d,u){if(!d.done_)return this.value=void 0,d.done_=!0,new c.State(u.expression,d.scope);h.pop(),this.value=d.value},c.prototype.stepForInStatement=function(h,d,u){if(!d.doneInit_&&(d.doneInit_=!0,u.left.declarations&&u.left.declarations[0].init))return d.scope.strict&&this.throwException(this.SYNTAX_ERROR,"for-in loop variable declaration may not have an initializer"),new c.State(u.left,d.scope);if(!d.doneObject_)return d.doneObject_=!0,d.variable_||(d.variable_=d.value),new c.State(u.right,d.scope);if(d.isLoop||(d.isLoop=!0,d.object_=d.value,d.visited_=Object.create(null)),d.name_===void 0)e:for(;;){if(d.object_ instanceof c.Object)for(d.props_||(d.props_=Object.getOwnPropertyNames(d.object_.properties));;){var p=d.props_.shift();if(p===void 0)break;if(Object.prototype.hasOwnProperty.call(d.object_.properties,p)&&!d.visited_[p]&&(d.visited_[p]=!0,!!Object.prototype.propertyIsEnumerable.call(d.object_.properties,p))){d.name_=p;break e}}else if(d.object_!==null&&d.object_!==void 0)for(d.props_||(d.props_=Object.getOwnPropertyNames(d.object_));;){var p=d.props_.shift();if(p===void 0)break;if(d.visited_[p]=!0,!!Object.prototype.propertyIsEnumerable.call(d.object_,p)){d.name_=p;break e}}if(d.object_=this.getPrototype(d.object_),d.props_=null,d.object_===null){h.pop();return}}if(!d.doneVariable_){d.doneVariable_=!0;var f=u.left;if(f.type==="VariableDeclaration")d.variable_=[c.SCOPE_REFERENCE,f.declarations[0].id.name];else{d.variable_=null;var g=new c.State(f,d.scope);return g.components=!0,g}}if(d.variable_||(d.variable_=d.value),!d.doneSetter_){d.doneSetter_=!0;var m=d.name_,y=this.setValue(d.variable_,m);if(y)return this.createSetter_(y,d.variable_,m)}if(d.name_=void 0,d.doneVariable_=!1,d.doneSetter_=!1,u.body)return new c.State(u.body,d.scope)},c.prototype.stepForStatement=function(h,d,u){switch(d.mode_){default:if(d.mode_=1,u.init)return new c.State(u.init,d.scope);break;case 1:if(d.mode_=2,u.test)return new c.State(u.test,d.scope);break;case 2:if(d.mode_=3,u.test&&!d.value)h.pop();else return d.isLoop=!0,new c.State(u.body,d.scope);break;case 3:if(d.mode_=1,u.update)return new c.State(u.update,d.scope);break}},c.prototype.stepFunctionDeclaration=function(h,d,u){h.pop()},c.prototype.stepFunctionExpression=function(h,d,u){h.pop(),d=h[h.length-1];var p=d.scope;u.id&&(p=this.createSpecialScope(p)),d.value=this.createFunction(u,p,d.destinationName),u.id&&this.setProperty(p.object,u.id.name,d.value,c.READONLY_DESCRIPTOR)},c.prototype.stepIdentifier=function(h,d,u){if(h.pop(),d.components){h[h.length-1].value=[c.SCOPE_REFERENCE,u.name];return}var p=this.getValueFromScope(u.name);if(this.getterStep_){var f=p;return this.createGetter_(f,this.globalObject)}h[h.length-1].value=p},c.prototype.stepIfStatement=c.prototype.stepConditionalExpression,c.prototype.stepLabeledStatement=function(h,d,u){h.pop();var p=d.labels||[];p.push(u.label.name);var f=new c.State(u.body,d.scope);return f.labels=p,f},c.prototype.stepLiteral=function(h,d,u){h.pop();var p=u.value;if(p instanceof RegExp){var f=this.createObjectProto(this.REGEXP_PROTO);this.populateRegExp(f,p),p=f}h[h.length-1].value=p},c.prototype.stepLogicalExpression=function(h,d,u){if(u.operator!=="&&"&&u.operator!=="||")throw SyntaxError("Unknown logical operator: "+u.operator);if(!d.doneLeft_)return d.doneLeft_=!0,new c.State(u.left,d.scope);if(d.doneRight_)h.pop(),h[h.length-1].value=d.value;else if(u.operator==="&&"&&!d.value||u.operator==="||"&&d.value)h.pop(),h[h.length-1].value=d.value;else return d.doneRight_=!0,new c.State(u.right,d.scope)},c.prototype.stepMemberExpression=function(h,d,u){if(!d.doneObject_)return d.doneObject_=!0,new c.State(u.object,d.scope);var p;if(!u.computed)d.object_=d.value,p=u.property.name;else if(d.doneProperty_)p=d.value;else return d.object_=d.value,d.doneProperty_=!0,new c.State(u.property,d.scope);if(h.pop(),d.components)h[h.length-1].value=[d.object_,p];else{var f=this.getProperty(d.object_,p);if(this.getterStep_){var g=f;return this.createGetter_(g,d.object_)}h[h.length-1].value=f}},c.prototype.stepNewExpression=c.prototype.stepCallExpression,c.prototype.stepObjectExpression=function(h,d,u){var p=d.n_||0,f=u.properties[p];if(!d.object_)d.object_=this.createObjectProto(this.OBJECT_PROTO),d.properties_=Object.create(null);else{var g=d.destinationName;d.properties_[g]||(d.properties_[g]={}),d.properties_[g][f.kind]=d.value,d.n_=++p,f=u.properties[p]}if(f){var m=f.key;if(m.type==="Identifier")var g=m.name;else if(m.type==="Literal")var g=m.value;else throw SyntaxError("Unknown object structure: "+m.type);return d.destinationName=g,new c.State(f.value,d.scope)}for(var m in d.properties_){var y=d.properties_[m];if("get"in y||"set"in y){var b={configurable:!0,enumerable:!0,get:y.get,set:y.set};this.setProperty(d.object_,m,c.VALUE_IN_DESCRIPTOR,b)}else this.setProperty(d.object_,m,y.init)}h.pop(),h[h.length-1].value=d.object_},c.prototype.stepProgram=function(h,d,u){var p=u.body.shift();if(p)return d.done=!1,new c.State(p,d.scope);d.done=!0},c.prototype.stepReturnStatement=function(h,d,u){if(u.argument&&!d.done_)return d.done_=!0,new c.State(u.argument,d.scope);this.unwind(c.Completion.RETURN,d.value,void 0)},c.prototype.stepSequenceExpression=function(h,d,u){var p=d.n_||0,f=u.expressions[p];if(f)return d.n_=p+1,new c.State(f,d.scope);h.pop(),h[h.length-1].value=d.value},c.prototype.stepSwitchStatement=function(h,d,u){if(!d.test_)return d.test_=1,new c.State(u.discriminant,d.scope);for(d.test_===1&&(d.test_=2,d.switchValue_=d.value,d.defaultCase_=-1);;){var p=d.index_||0,f=u.cases[p];if(!d.matched_&&f&&!f.test){d.defaultCase_=p,d.index_=p+1;continue}if(!f&&!d.matched_&&d.defaultCase_!==-1){d.matched_=!0,d.index_=d.defaultCase_;continue}if(f){if(!d.matched_&&!d.tested_&&f.test)return d.tested_=!0,new c.State(f.test,d.scope);if(d.matched_||d.value===d.switchValue_){d.matched_=!0;var g=d.n_||0;if(f.consequent[g])return d.isSwitch=!0,d.n_=g+1,new c.State(f.consequent[g],d.scope)}d.tested_=!1,d.n_=0,d.index_=p+1}else{h.pop();return}}},c.prototype.stepThisExpression=function(h,d,u){h.pop(),h[h.length-1].value=this.getValueFromScope("this")},c.prototype.stepThrowStatement=function(h,d,u){if(d.done_)this.throwException(d.value);else return d.done_=!0,new c.State(u.argument,d.scope)},c.prototype.stepTryStatement=function(h,d,u){if(!d.doneBlock_)return d.doneBlock_=!0,new c.State(u.block,d.scope);if(d.cv&&d.cv.type===c.Completion.THROW&&!d.doneHandler_&&u.handler){d.doneHandler_=!0;var p=this.createSpecialScope(d.scope);return this.setProperty(p.object,u.handler.param.name,d.cv.value),d.cv=void 0,new c.State(u.handler.body,p)}if(!d.doneFinalizer_&&u.finalizer)return d.doneFinalizer_=!0,new c.State(u.finalizer,d.scope);h.pop(),d.cv&&this.unwind(d.cv.type,d.cv.value,d.cv.label)},c.prototype.stepUnaryExpression=function(h,d,u){if(!d.done_){d.done_=!0;var p=new c.State(u.argument,d.scope);return p.components=u.operator==="delete",p}h.pop();var f=d.value;switch(u.operator){case"-":f=-f;break;case"+":f=+f;break;case"!":f=!f;break;case"~":f=~f;break;case"delete":var g=!0;if(Array.isArray(f)){var m=f[0];m===c.SCOPE_REFERENCE&&(m=d.scope);var y=String(f[1]);try{delete m.properties[y]}catch{d.scope.strict?this.throwException(this.TYPE_ERROR,"Cannot delete property '"+y+"' of '"+m+"'"):g=!1}}f=g;break;case"typeof":f=f&&f.class==="Function"?"function":typeof f;break;case"void":f=void 0;break;default:throw SyntaxError("Unknown unary operator: "+u.operator)}h[h.length-1].value=f},c.prototype.stepUpdateExpression=function(h,d,u){if(!d.doneLeft_){d.doneLeft_=!0;var p=new c.State(u.argument,d.scope);return p.components=!0,p}if(d.leftSide_||(d.leftSide_=d.value),d.doneGetter_&&(d.leftValue_=d.value),!d.doneGetter_){var g=this.getValue(d.leftSide_);if(d.leftValue_=g,this.getterStep_){d.doneGetter_=!0;var f=g;return this.createGetter_(f,d.leftSide_)}}if(d.doneSetter_){h.pop(),h[h.length-1].value=d.setterValue_;return}var g=Number(d.leftValue_),m;if(u.operator==="++")m=g+1;else if(u.operator==="--")m=g-1;else throw SyntaxError("Unknown update expression: "+u.operator);var y=u.prefix?m:g,b=this.setValue(d.leftSide_,m);if(b)return d.doneSetter_=!0,d.setterValue_=y,this.createSetter_(b,d.leftSide_,m);h.pop(),h[h.length-1].value=y},c.prototype.stepVariableDeclaration=function(h,d,u){var p=u.declarations,f=d.n_||0,g=p[f];for(d.init_&&g&&(this.setValueToScope(g.id.name,d.value),d.init_=!1,g=p[++f]);g;){if(g.init)return d.n_=f,d.init_=!0,d.destinationName=g.id.name,new c.State(g.init,d.scope);g=p[++f]}h.pop()},c.prototype.stepWithStatement=function(h,d,u){if(!d.doneObject_)return d.doneObject_=!0,new c.State(u.object,d.scope);h.pop();var p=this.createSpecialScope(d.scope,d.value);return new c.State(u.body,p)},c.prototype.stepWhileStatement=c.prototype.stepDoWhileStatement,c.nativeGlobal.Interpreter=c,c.prototype.step=c.prototype.step,c.prototype.run=c.prototype.run,c.prototype.getStatus=c.prototype.getStatus,c.prototype.appendCode=c.prototype.appendCode,c.prototype.createObject=c.prototype.createObject,c.prototype.createObjectProto=c.prototype.createObjectProto,c.prototype.createNativeFunction=c.prototype.createNativeFunction,c.prototype.createAsyncFunction=c.prototype.createAsyncFunction,c.prototype.getProperty=c.prototype.getProperty,c.prototype.setProperty=c.prototype.setProperty,c.prototype.nativeToPseudo=c.prototype.nativeToPseudo,c.prototype.pseudoToNative=c.prototype.pseudoToNative,c.prototype.getGlobalScope=c.prototype.getGlobalScope,c.prototype.setGlobalScope=c.prototype.setGlobalScope,c.prototype.getStateStack=c.prototype.getStateStack,c.prototype.setStateStack=c.prototype.setStateStack,c.Status=c.Status,c.VALUE_IN_DESCRIPTOR=c.VALUE_IN_DESCRIPTOR,a.exports={Interpreter:c}},"./original-repo/acorn.js":function(a,o){(function(l,c){return c(o)})(typeof globalThis>"u"?this||window:globalThis,function(l){l.version="0.5.0";var c,h="",d,u;l.parse=function(P,Q){return h=String(P),d=h.length,f(Q),cv(),Sv(c.program)};var p={strictSemicolons:!1,allowTrailingCommas:!0,forbidReserved:!1,allowReturnOutsideFunction:!1,locations:!1,onComment:null,ranges:!1,program:null,sourceFile:null,directSourceFile:null};function f(P){c=P||{};for(var Q in p)Object.prototype.hasOwnProperty.call(c,Q)||(c[Q]=p[Q]);u=c.sourceFile}var g=function(P,Q){for(var j=1,z=0;;){Ma.lastIndex=z;var Oe=Ma.exec(P);if(Oe&&Oe.index<Q)++j,z=Oe.index+Oe[0].length;else break}return{line:j,column:Q-z}},m=0,y=0,b=0,w,k,x,E,_,R,C,D=0,q=0,A,F,L,W;function M(P,Q){var j=g(h,P);Q+=" ("+j.line+":"+j.column+")";var z=new SyntaxError(Q);throw z.pos=P,z.loc=j,z.raisedAt=m,z}var G=[],J={type:"num"},ce={type:"regexp"},re={type:"string"},le={type:"name"},oe={type:"eof"},ke={keyword:"break"},Qe={keyword:"case",beforeExpr:!0},qt={keyword:"catch"},Ze={keyword:"continue"},Dt={keyword:"debugger"},Xt={keyword:"default"},fr={keyword:"do",isLoop:!0},Ia={keyword:"else",beforeExpr:!0},$s={keyword:"finally"},qi={keyword:"for",isLoop:!0},ls={keyword:"function"},Is={keyword:"if"},gn={keyword:"return",beforeExpr:!0},gr={keyword:"switch"},iu={keyword:"throw",beforeExpr:!0},su={keyword:"try"},Nl={keyword:"var"},Ml={keyword:"while",isLoop:!0},ru={keyword:"with"},nu={keyword:"new",beforeExpr:!0},au={keyword:"this"},ou={keyword:"null",atomValue:null},lu={keyword:"true",atomValue:!0},cu={keyword:"false",atomValue:!1},Qa={keyword:"in",binop:7,beforeExpr:!0},G0={break:ke,case:Qe,catch:qt,continue:Ze,debugger:Dt,default:Xt,do:fr,else:Ia,finally:$s,for:qi,function:ls,if:Is,return:gn,switch:gr,throw:iu,try:su,var:Nl,while:Ml,with:ru,null:ou,true:lu,false:cu,new:nu,in:Qa,instanceof:{keyword:"instanceof",binop:7,beforeExpr:!0},this:au,typeof:{keyword:"typeof",prefix:!0,beforeExpr:!0},void:{keyword:"void",prefix:!0,beforeExpr:!0},delete:{keyword:"delete",prefix:!0,beforeExpr:!0}},ql={type:"[",beforeExpr:!0},Dl={type:"]"},mn={type:"{",beforeExpr:!0},mr={type:"}"},Di={type:"(",beforeExpr:!0},yi={type:")"},cs={type:",",beforeExpr:!0},Bi={type:";",beforeExpr:!0},On={type:":",beforeExpr:!0},hu={type:"."},du={type:"?",beforeExpr:!0},uu={binop:10,beforeExpr:!0},pu={isAssign:!0,beforeExpr:!0},Qs={isAssign:!0,beforeExpr:!0},Y0={postfix:!0,prefix:!0,isUpdate:!0},fu={prefix:!0,beforeExpr:!0},gu={binop:1,beforeExpr:!0},mu={binop:2,beforeExpr:!0},Z0={binop:3,beforeExpr:!0},H0={binop:4,beforeExpr:!0},K0={binop:5,beforeExpr:!0},J0={binop:6,beforeExpr:!0},ev={binop:7,beforeExpr:!0},tv={binop:8,beforeExpr:!0},iv={binop:9,prefix:!0,beforeExpr:!0},sv={binop:10,beforeExpr:!0};function Aa(P){for(var Q=P.split(" "),j=Object.create(null),z=0;z<Q.length;z++)j[Q[z]]=!0;return function(Oe){return j[Oe]||!1}}var rv=Aa("class enum extends super const export import"),Ou=Aa("implements interface let package private protected public static yield"),La=Aa("eval arguments"),nv=Aa("break case catch continue debugger default do else finally for function if return switch throw try var while with null true false instanceof typeof void delete new in this"),av=/[\u1680\u180e\u2000-\u200a\u202f\u205f\u3000\ufeff]/,yu="ÂªÂµÂºÃ€-Ã–Ã˜-Ã¶Ã¸-ËË†-Ë‘Ë -Ë¤Ë¬Ë®Í°-Í´Í¶Í·Íº-Í½Î†Îˆ-ÎŠÎŒÎŽ-Î¡Î£-ÏµÏ·-ÒÒŠ-Ô§Ô±-Õ–Õ™Õ¡-Ö‡×-×ª×°-×²Ø -ÙŠÙ®Ù¯Ù±-Û“Û•Û¥Û¦Û®Û¯Ûº-Û¼Û¿ÜÜ’-Ü¯Ý-Þ¥Þ±ßŠ-ßªß´ßµßºà €-à •à šà ¤à ¨à¡€-à¡˜à¢ à¢¢-à¢¬à¤„-à¤¹à¤½à¥à¥˜-à¥¡à¥±-à¥·à¥¹-à¥¿à¦…-à¦Œà¦à¦à¦“-à¦¨à¦ª-à¦°à¦²à¦¶-à¦¹à¦½à§Žà§œà§à§Ÿ-à§¡à§°à§±à¨…-à¨Šà¨à¨à¨“-à¨¨à¨ª-à¨°à¨²à¨³à¨µà¨¶à¨¸à¨¹à©™-à©œà©žà©²-à©´àª…-àªàª-àª‘àª“-àª¨àªª-àª°àª²àª³àªµ-àª¹àª½à«à« à«¡à¬…-à¬Œà¬à¬à¬“-à¬¨à¬ª-à¬°à¬²à¬³à¬µ-à¬¹à¬½à­œà­à­Ÿ-à­¡à­±à®ƒà®…-à®Šà®Ž-à®à®’-à®•à®™à®šà®œà®žà®Ÿà®£à®¤à®¨-à®ªà®®-à®¹à¯à°…-à°Œà°Ž-à°à°’-à°¨à°ª-à°³à°µ-à°¹à°½à±˜à±™à± à±¡à²…-à²Œà²Ž-à²à²’-à²¨à²ª-à²³à²µ-à²¹à²½à³žà³ à³¡à³±à³²à´…-à´Œà´Ž-à´à´’-à´ºà´½àµŽàµ àµ¡àµº-àµ¿à¶…-à¶–à¶š-à¶±à¶³-à¶»à¶½à·€-à·†à¸-à¸°à¸²à¸³à¹€-à¹†àºàº‚àº„àº‡àºˆàºŠàºàº”-àº—àº™-àºŸàº¡-àº£àº¥àº§àºªàº«àº­-àº°àº²àº³àº½à»€-à»„à»†à»œ-à»Ÿà¼€à½€-à½‡à½‰-à½¬à¾ˆ-à¾Œá€€-á€ªá€¿á-á•áš-áá¡á¥á¦á®-á°áµ-á‚á‚Žá‚ -áƒ…áƒ‡áƒáƒ-áƒºáƒ¼-á‰ˆá‰Š-á‰á‰-á‰–á‰˜á‰š-á‰á‰ -áŠˆáŠŠ-áŠáŠ-áŠ°áŠ²-áŠµáŠ¸-áŠ¾á‹€á‹‚-á‹…á‹ˆ-á‹–á‹˜-áŒáŒ’-áŒ•áŒ˜-ášáŽ€-áŽáŽ -á´á-á™¬á™¯-á™¿áš-áššáš -á›ªá›®-á›°áœ€-áœŒáœŽ-áœ‘áœ -áœ±á€-á‘á -á¬á®-á°áž€-áž³áŸ—áŸœá  -á¡·á¢€-á¢¨á¢ªá¢°-á£µá¤€-á¤œá¥-á¥­á¥°-á¥´á¦€-á¦«á§-á§‡á¨€-á¨–á¨ -á©”áª§á¬…-á¬³á­…-á­‹á®ƒ-á® á®®á®¯á®º-á¯¥á°€-á°£á±-á±á±š-á±½á³©-á³¬á³®-á³±á³µá³¶á´€-á¶¿á¸€-á¼•á¼˜-á¼á¼ -á½…á½ˆ-á½á½-á½—á½™á½›á½á½Ÿ-á½½á¾€-á¾´á¾¶-á¾¼á¾¾á¿‚-á¿„á¿†-á¿Œá¿-á¿“á¿–-á¿›á¿ -á¿¬á¿²-á¿´á¿¶-á¿¼â±â¿â‚-â‚œâ„‚â„‡â„Š-â„“â„•â„™-â„â„¤â„¦â„¨â„ª-â„­â„¯-â„¹â„¼-â„¿â……-â…‰â…Žâ… -â†ˆâ°€-â°®â°°-â±žâ± -â³¤â³«-â³®â³²â³³â´€-â´¥â´§â´­â´°-âµ§âµ¯â¶€-â¶–â¶ -â¶¦â¶¨-â¶®â¶°-â¶¶â¶¸-â¶¾â·€-â·†â·ˆ-â·Žâ·-â·–â·˜-â·žâ¸¯ã€…-ã€‡ã€¡-ã€©ã€±-ã€µã€¸-ã€¼ã-ã‚–ã‚-ã‚Ÿã‚¡-ãƒºãƒ¼-ãƒ¿ã„…-ã„­ã„±-ã†Žã† -ã†ºã‡°-ã‡¿ã€-ä¶µä¸€-é¿Œê€€-ê’Œê“-ê“½ê”€-ê˜Œê˜-ê˜Ÿê˜ªê˜«ê™€-ê™®ê™¿-êš—êš -ê›¯êœ—-êœŸêœ¢-êžˆêž‹-êžŽêž-êž“êž -êžªêŸ¸-ê ê ƒ-ê …ê ‡-ê Šê Œ-ê ¢ê¡€-ê¡³ê¢‚-ê¢³ê£²-ê£·ê£»ê¤Š-ê¤¥ê¤°-ê¥†ê¥ -ê¥¼ê¦„-ê¦²ê§ê¨€-ê¨¨ê©€-ê©‚ê©„-ê©‹ê© -ê©¶ê©ºêª€-êª¯êª±êªµêª¶êª¹-êª½ê«€ê«‚ê«›-ê«ê« -ê«ªê«²-ê«´ê¬-ê¬†ê¬‰-ê¬Žê¬‘-ê¬–ê¬ -ê¬¦ê¬¨-ê¬®ê¯€-ê¯¢ê°€-íž£íž°-íŸ†íŸ‹-íŸ»ï¤€-ï©­ï©°-ï«™ï¬€-ï¬†ï¬“-ï¬—ï¬ï¬Ÿ-ï¬¨ï¬ª-ï¬¶ï¬¸-ï¬¼ï¬¾ï­€ï­ï­ƒï­„ï­†-ï®±ï¯“-ï´½ïµ-ï¶ï¶’-ï·‡ï·°-ï·»ï¹°-ï¹´ï¹¶-ï»¼ï¼¡-ï¼ºï½-ï½šï½¦-ï¾¾ï¿‚-ï¿‡ï¿Š-ï¿ï¿’-ï¿—ï¿š-ï¿œ",ov="Ì€-Í¯Òƒ-Ò‡Ö‘-Ö½Ö¿××‚×„×…×‡Ø-ØšØ -Ù‰Ù²-Û“Û§-Û¨Û»-Û¼Ü°-ÝŠà €-à ”à ›-à £à ¥-à §à ©-à ­à¡€-à¡—à£¤-à£¾à¤€-à¤ƒà¤º-à¤¼à¤¾-à¥à¥‘-à¥—à¥¢-à¥£à¥¦-à¥¯à¦-à¦ƒà¦¼à¦¾-à§„à§‡à§ˆà§—à§Ÿ-à§ à¨-à¨ƒà¨¼à¨¾-à©‚à©‡à©ˆà©‹-à©à©‘à©¦-à©±à©µàª-àªƒàª¼àª¾-à«…à«‡-à«‰à«‹-à«à«¢-à«£à«¦-à«¯à¬-à¬ƒà¬¼à¬¾-à­„à­‡à­ˆà­‹-à­à­–à­—à­Ÿ-à­ à­¦-à­¯à®‚à®¾-à¯‚à¯†-à¯ˆà¯Š-à¯à¯—à¯¦-à¯¯à°-à°ƒà±†-à±ˆà±Š-à±à±•à±–à±¢-à±£à±¦-à±¯à²‚à²ƒà²¼à²¾-à³„à³†-à³ˆà³Š-à³à³•à³–à³¢-à³£à³¦-à³¯à´‚à´ƒàµ†-àµˆàµ—àµ¢-àµ£àµ¦-àµ¯à¶‚à¶ƒà·Šà·-à·”à·–à·˜-à·Ÿà·²à·³à¸´-à¸ºà¹€-à¹…à¹-à¹™àº´-àº¹à»ˆ-à»à»-à»™à¼˜à¼™à¼ -à¼©à¼µà¼·à¼¹à½-à½‡à½±-à¾„à¾†-à¾‡à¾-à¾—à¾™-à¾¼à¿†á€€-á€©á€-á‰á§-á­á±-á´á‚‚-á‚á‚-á‚á-áŸáœŽ-áœáœ -áœ°á€-áá²á³áž€-áž²áŸáŸ -áŸ©á ‹-á á -á ™á¤ -á¤«á¤°-á¤»á¥‘-á¥­á¦°-á§€á§ˆ-á§‰á§-á§™á¨€-á¨•á¨ -á©“á© -á©¼á©¿-áª‰áª-áª™á­†-á­‹á­-á­™á­«-á­³á®°-á®¹á¯¦-á¯³á°€-á°¢á±€-á±‰á±›-á±½á³-á³’á´€-á¶¾á¸-á¼•â€Œâ€â€¿â€â”âƒ-âƒœâƒ¡âƒ¥-âƒ°â¶-â¶–â· -â·¿ã€¡-ã€¨ã‚™ã‚šê™€-ê™­ê™´-ê™½êšŸê›°-ê›±êŸ¸-ê €ê †ê ‹ê £-ê §ê¢€-ê¢ê¢´-ê£„ê£-ê£™ê£³-ê£·ê¤€-ê¤‰ê¤¦-ê¤­ê¤°-ê¥…ê¦€-ê¦ƒê¦³-ê§€ê¨€-ê¨§ê©€-ê©ê©Œ-ê©ê©-ê©™ê©»ê« -ê«©ê«²-ê«³ê¯€-ê¯¡ê¯¬ê¯­ê¯°-ê¯¹ï¬ -ï¬¨ï¸€-ï¸ï¸ -ï¸¦ï¸³ï¸´ï¹-ï¹ï¼-ï¼™ï¼¿",vu=new RegExp("["+yu+"]"),lv=new RegExp("["+yu+ov+"]"),Na=/[\n\r\u2028\u2029]/,Ma=/\r\n|[\n\r\u2028\u2029]/g,qa=function(P){return P<65?P===36:P<91?!0:P<97?P===95:P<123?!0:P>=170&&vu.test(String.fromCharCode(P))},bu=function(P){return P<48?P===36:P<58?!0:P<65?!1:P<91?!0:P<97?P===95:P<123?!0:P>=170&&lv.test(String.fromCharCode(P))};function As(){this.line=R,this.column=m-C}function cv(){R=1,m=C=0,_=!0,yn()}function ot(P,Q){b=m,c.locations&&(k=new As),x=P,yn(),E=Q,_=P.beforeExpr}function hv(){var P=c.onComment&&c.locations&&new As,Q=m,j=h.indexOf("*/",m+=2);if(j===-1&&M(m-2,"Unterminated comment"),m=j+2,c.locations){Ma.lastIndex=Q;for(var z;(z=Ma.exec(h))&&z.index<m;)++R,C=z.index+z[0].length}c.onComment&&c.onComment(!0,h.slice(Q+2,j),Q,m,P,c.locations&&new As)}function Bl(){for(var P=m,Q=c.onComment&&c.locations&&new As,j=h.charCodeAt(m+=2);m<d&&j!==10&&j!==13&&j!==8232&&j!==8233;)++m,j=h.charCodeAt(m);c.onComment&&c.onComment(!1,h.slice(P+2,m),P,m,Q,c.locations&&new As)}function yn(){for(;m<d;){var P=h.charCodeAt(m);if(P===32)++m;else if(P===13){++m;var Q=h.charCodeAt(m);Q===10&&++m,c.locations&&(++R,C=m)}else if(P===10||P===8232||P===8233)++m,c.locations&&(++R,C=m);else if(P>8&&P<14)++m;else if(P===47){var Q=h.charCodeAt(m+1);if(Q===42)hv();else if(Q===47)Bl();else break}else if(P===160)++m;else if(P>=5760&&av.test(String.fromCharCode(P)))++m;else break}}function dv(){var P=h.charCodeAt(m+1);P>=48&&P<=57?Su(!0):(++m,ot(hu))}function uv(){var P=h.charCodeAt(m+1);_?(++m,wu()):P===61?lt(Qs,2):lt(uu,1)}function pv(){var P=h.charCodeAt(m+1);P===61?lt(Qs,2):lt(sv,1)}function fv(P){var Q=h.charCodeAt(m+1);Q===P?lt(P===124?gu:mu,2):Q===61?lt(Qs,2):lt(P===124?Z0:K0,1)}function gv(){var P=h.charCodeAt(m+1);P===61?lt(Qs,2):lt(H0,1)}function mv(P){var Q=h.charCodeAt(m+1);if(Q===P){if(Q===45&&h.charCodeAt(m+2)===62&&Na.test(h.slice(q,m))){m+=3,Bl(),yn(),Or();return}lt(Y0,2)}else Q===61?lt(Qs,2):lt(iv,1)}function Ov(P){var Q=h.charCodeAt(m+1),j=1;if(Q===P){j=P===62&&h.charCodeAt(m+2)===62?3:2,h.charCodeAt(m+j)===61?lt(Qs,j+1):lt(tv,j);return}if(Q===33&&P===60&&h.charCodeAt(m+2)===45&&h.charCodeAt(m+3)===45){m+=4,Bl(),yn(),Or();return}Q===61&&(j=h.charCodeAt(m+2)===61?3:2),lt(ev,j)}function yv(P){var Q=h.charCodeAt(m+1);Q===61?lt(J0,h.charCodeAt(m+2)===61?3:2):lt(P===61?pu:fu,1)}function vv(P){switch(P){case 46:return dv();case 40:return++m,ot(Di);case 41:return++m,ot(yi);case 59:return++m,ot(Bi);case 44:return++m,ot(cs);case 91:return++m,ot(ql);case 93:return++m,ot(Dl);case 123:return++m,ot(mn);case 125:return++m,ot(mr);case 58:return++m,ot(On);case 63:return++m,ot(du);case 48:var Q=h.charCodeAt(m+1);if(Q===120||Q===88)return bv();case 49:case 50:case 51:case 52:case 53:case 54:case 55:case 56:case 57:return Su(!1);case 34:case 39:return wv(P);case 47:return uv();case 37:case 42:return pv();case 124:case 38:return fv(P);case 94:return gv();case 43:case 45:return mv(P);case 60:case 62:return Ov(P);case 61:case 33:return yv(P);case 126:return lt(fu,1)}return!1}function Or(P){if(P?m=y+1:y=m,c.locations&&(w=new As),P)return wu();if(m>=d)return ot(oe);var Q=h.charCodeAt(m);if(qa(Q)||Q===92)return ku();var j=vv(Q);if(j===!1){var z=String.fromCharCode(Q);if(z==="\\"||vu.test(z))return ku();M(m,"Unexpected character '"+z+"'")}}function lt(P,Q){var j=h.slice(m,m+Q);m+=Q,ot(P,j)}function wu(){for(var P,Q,j=m;;){m>=d&&M(j,"Unterminated regexp");var z=h.charAt(m);if(Na.test(z)&&M(j,"Unterminated regexp"),P)P=!1;else{if(z==="[")Q=!0;else if(z==="]"&&Q)Q=!1;else if(z==="/"&&!Q)break;P=z==="\\"}++m}var Oe=h.slice(j,m);++m;var pe=xu();pe&&!/^[gmi]*$/.test(pe)&&M(j,"Invalid regexp flag");try{var ye=new RegExp(Oe,pe)}catch(qe){throw qe instanceof SyntaxError&&M(j,qe.message),qe}ot(ce,ye)}function vn(P,Q){for(var j=m,z=0,Oe=Q===void 0?1/0:Q,pe=0;pe<Oe;++pe){var ye=h.charCodeAt(m),qe;if(ye>=97?qe=ye-97+10:ye>=65?qe=ye-65+10:ye>=48&&ye<=57?qe=ye-48:qe=1/0,qe>=P)break;++m,z=z*P+qe}return m===j||Q!==void 0&&m-j!==Q?null:z}function bv(){m+=2;var P=vn(16);P===null&&M(y+2,"Expected hexadecimal number"),qa(h.charCodeAt(m))&&M(m,"Identifier directly after number"),ot(J,P)}function Su(P){var Q=m,j=!1,z=h.charCodeAt(m)===48;!P&&vn(10)===null&&M(Q,"Invalid number"),h.charCodeAt(m)===46&&(++m,vn(10),j=!0);var Oe=h.charCodeAt(m);(Oe===69||Oe===101)&&(Oe=h.charCodeAt(++m),(Oe===43||Oe===45)&&++m,vn(10)===null&&M(Q,"Invalid number"),j=!0),qa(h.charCodeAt(m))&&M(m,"Identifier directly after number");var pe=h.slice(Q,m),ye;j?ye=parseFloat(pe):!z||pe.length===1?ye=parseInt(pe,10):/[89]/.test(pe)||W?M(Q,"Invalid number"):ye=parseInt(pe,8),ot(J,ye)}function wv(P){m++;for(var Q="";;){m>=d&&M(y,"Unterminated string constant");var j=h.charCodeAt(m);if(j===P){++m,ot(re,Q);return}if(j===92){j=h.charCodeAt(++m);var z=/^[0-7]+/.exec(h.slice(m,m+3));for(z&&(z=z[0]);z&&parseInt(z,8)>255;)z=z.slice(0,-1);if(z==="0"&&(z=null),++m,z)W&&M(m-2,"Octal literal in strict mode"),Q+=String.fromCharCode(parseInt(z,8)),m+=z.length-1;else switch(j){case 110:Q+=`
`;break;case 114:Q+="\r";break;case 120:Q+=String.fromCharCode(Da(2));break;case 117:Q+=String.fromCharCode(Da(4));break;case 85:Q+=String.fromCharCode(Da(8));break;case 116:Q+="	";break;case 98:Q+="\b";break;case 118:Q+="\v";break;case 102:Q+="\f";break;case 48:Q+="\0";break;case 13:h.charCodeAt(m)===10&&++m;case 10:c.locations&&(C=m,++R);break;default:Q+=String.fromCharCode(j);break}}else(j===13||j===10||j===8232||j===8233)&&M(y,"Unterminated string constant"),Q+=String.fromCharCode(j),++m}}function Da(P){var Q=vn(16,P);return Q===null&&M(y,"Bad character escape sequence"),Q}var yr;function xu(){yr=!1;for(var P,Q=!0,j=m;;){var z=h.charCodeAt(m);if(bu(z))yr&&(P+=h.charAt(m)),++m;else if(z===92){yr||(P=h.slice(j,m)),yr=!0,h.charCodeAt(++m)!==117&&M(m,"Expecting Unicode escape sequence \\uXXXX"),++m;var Oe=Da(4),pe=String.fromCharCode(Oe);pe||M(m-1,"Invalid Unicode escape"),(Q?qa(Oe):bu(Oe))||M(m-4,"Invalid Unicode escape"),P+=pe}else break;Q=!1}return yr?P:h.slice(j,m)}function ku(){var P=xu(),Q=le;!yr&&nv(P)&&(Q=G0[P]),ot(Q,P)}function _e(){D=y,q=b,A=k,Or()}function jl(P){if(W=P,m=y,c.locations)for(;m<C;)C=h.lastIndexOf(`
`,C-2)+1,--R;yn(),Or()}function Tu(){this.type=null,this.start=y,this.end=null}function Eu(){this.start=w,this.end=null,u&&(this.source=u)}function ct(){var P=new Tu;return c.locations&&(P.loc=new Eu),c.directSourceFile&&(P.sourceFile=c.directSourceFile),c.ranges&&(P.range=[y,0]),P}function hs(P){var Q=new Tu;return Q.start=P.start,c.locations&&(Q.loc=new Eu,Q.loc.start=P.loc.start),c.ranges&&(Q.range=[P.range[0],0]),Q}function me(P,Q){return P.type=Q,P.end=q,c.locations&&(P.loc.end=A),c.ranges&&(P.range[1]=q),P}function Wl(P){return P.type==="ExpressionStatement"&&P.expression.type==="Literal"&&P.expression.value==="use strict"}function Ue(P){return x===P?(_e(),!0):!1}function Ba(){return!c.strictSemicolons&&(x===oe||x===mr||Na.test(h.slice(q,y)))}function Ls(){!Ue(Bi)&&!Ba()&&ji()}function He(P){x===P?_e():ji()}function ji(){M(y,"Unexpected token")}function ja(P){P.type!=="Identifier"&&P.type!=="MemberExpression"&&M(P.start,"Assigning to rvalue"),W&&P.type==="Identifier"&&La(P.name)&&M(P.start,"Assigning to "+P.name+" in strict mode")}function Sv(P){D=q=m,c.locations&&(A=new As),F=W=!1,L=[],Or();var Q=P||ct(),j=!0;for(P||(Q.body=[]);x!==oe;){var z=ai();Q.body.push(z),j&&Wl(z)&&jl(!0),j=!1}return me(Q,"Program")}var Fl={kind:"loop"},xv={kind:"switch"};function ai(){(x===uu||x===Qs&&E==="/=")&&Or(!0);var P=x,Q=ct();switch(P){case ke:case Ze:_e();var j=P===ke;Ue(Bi)||Ba()?Q.label=null:x!==le?ji():(Q.label=ds(),Ls());for(var z=0;z<L.length;++z){var Oe=L[z];if((Q.label===null||Oe.name===Q.label.name)&&(Oe.kind!==null&&(j||Oe.kind==="loop")||Q.label&&j))break}return z===L.length&&M(Q.start,"Unsyntactic "+P.keyword),me(Q,j?"BreakStatement":"ContinueStatement");case Dt:return _e(),Ls(),me(Q,"DebuggerStatement");case fr:return _e(),L.push(Fl),Q.body=ai(),L.pop(),He(Ml),Q.test=bn(),Ls(),me(Q,"DoWhileStatement");case qi:if(_e(),L.push(Fl),He(Di),x===Bi)return Ul(Q,null);if(x===Nl){var pe=ct();return _e(),Cu(pe,!0),me(pe,"VariableDeclaration"),pe.declarations.length===1&&Ue(Qa)?Pu(Q,pe):Ul(Q,pe)}var pe=bt(!1,!0);return Ue(Qa)?(ja(pe),Pu(Q,pe)):Ul(Q,pe);case ls:return _e(),Yl(Q,!0);case Is:return _e(),Q.test=bn(),Q.consequent=ai(),Q.alternate=Ue(Ia)?ai():null,me(Q,"IfStatement");case gn:return!F&&!c.allowReturnOutsideFunction&&M(y,"'return' outside of function"),_e(),Ue(Bi)||Ba()?Q.argument=null:(Q.argument=bt(),Ls()),me(Q,"ReturnStatement");case gr:_e(),Q.discriminant=bn(),Q.cases=[],He(mn),L.push(xv);for(var ye,qe;x!==mr;)if(x===Qe||x===Xt){var xn=x===Qe;ye&&me(ye,"SwitchCase"),Q.cases.push(ye=ct()),ye.consequent=[],_e(),xn?ye.test=bt():(qe&&M(D,"Multiple default clauses"),qe=!0,ye.test=null),He(On)}else ye||ji(),ye.consequent.push(ai());return ye&&me(ye,"SwitchCase"),_e(),L.pop(),me(Q,"SwitchStatement");case iu:return _e(),Na.test(h.slice(q,y))&&M(q,"Illegal newline after throw"),Q.argument=bt(),Ls(),me(Q,"ThrowStatement");case su:if(_e(),Q.block=wn(),Q.handler=null,x===qt){var vr=ct();_e(),He(Di),vr.param=ds(),W&&La(vr.param.name)&&M(vr.param.start,"Binding "+vr.param.name+" in strict mode"),He(yi),vr.body=wn(),Q.handler=me(vr,"CatchClause")}return Q.finalizer=Ue($s)?wn():null,!Q.handler&&!Q.finalizer&&M(Q.start,"Missing catch or finally clause"),me(Q,"TryStatement");case Nl:return _e(),Cu(Q),Ls(),me(Q,"VariableDeclaration");case Ml:return _e(),Q.test=bn(),L.push(Fl),Q.body=ai(),L.pop(),me(Q,"WhileStatement");case ru:return W&&M(y,"'with' in strict mode"),_e(),Q.object=bn(),Q.body=ai(),me(Q,"WithStatement");case mn:return wn();case Bi:return _e(),me(Q,"EmptyStatement");default:var Hl=E,Wa=bt();if(P===le&&Wa.type==="Identifier"&&Ue(On)){for(var z=0;z<L.length;++z)L[z].name===Hl&&M(Wa.start,"Label '"+Hl+"' is already declared");var _v=x.isLoop?"loop":x===gr?"switch":null;return L.push({name:Hl,kind:_v}),Q.body=ai(),L.pop(),Q.label=Wa,me(Q,"LabeledStatement")}else return Q.expression=Wa,Ls(),me(Q,"ExpressionStatement")}}function bn(){He(Di);var P=bt();return He(yi),P}function wn(P){var Q=ct(),j=!0,z=!1,Oe;for(Q.body=[],He(mn);!Ue(mr);){var pe=ai();Q.body.push(pe),j&&P&&Wl(pe)&&(Oe=z,jl(z=!0)),j=!1}return z&&!Oe&&jl(!1),me(Q,"BlockStatement")}function Ul(P,Q){return P.init=Q,He(Bi),P.test=x===Bi?null:bt(),He(Bi),P.update=x===yi?null:bt(),He(yi),P.body=ai(),L.pop(),me(P,"ForStatement")}function Pu(P,Q){return P.left=Q,P.right=bt(),He(yi),P.body=ai(),L.pop(),me(P,"ForInStatement")}function Cu(P,Q){for(P.declarations=[],P.kind="var";;){var j=ct();if(j.id=ds(),W&&La(j.id.name)&&M(j.id.start,"Binding "+j.id.name+" in strict mode"),j.init=Ue(pu)?bt(!0,Q):null,P.declarations.push(me(j,"VariableDeclarator")),!Ue(cs))break}}function bt(P,Q){var j=Vl(Q);if(!P&&x===cs){var z=hs(j);for(z.expressions=[j];Ue(cs);)z.expressions.push(Vl(Q));return me(z,"SequenceExpression")}return j}function Vl(P){var Q=kv(P);if(x.isAssign){var j=hs(Q);return j.operator=E,j.left=Q,_e(),j.right=Vl(P),ja(Q),me(j,"AssignmentExpression")}return Q}function kv(P){var Q=Tv(P);if(Ue(du)){var j=hs(Q);return j.test=Q,j.consequent=bt(!0),He(On),j.alternate=bt(!0,P),me(j,"ConditionalExpression")}return Q}function Tv(P){return zl(Xl(),-1,P)}function zl(P,Q,j){var z=x.binop;if(z!==null&&(!j||x!==Qa)&&z>Q){var Oe=hs(P);Oe.left=P,Oe.operator=E;var pe=x;_e(),Oe.right=zl(Xl(),z,j);var ye=me(Oe,pe===gu||pe===mu?"LogicalExpression":"BinaryExpression");return zl(ye,Q,j)}return P}function Xl(){if(x.prefix){var P=ct(),Q=x.isUpdate;return P.operator=E,P.prefix=!0,_=!0,_e(),P.argument=Xl(),Q?ja(P.argument):W&&P.operator==="delete"&&P.argument.type==="Identifier"&&M(P.start,"Deleting local variable in strict mode"),me(P,Q?"UpdateExpression":"UnaryExpression")}for(var j=Ev();x.postfix&&!Ba();){var P=hs(j);P.operator=E,P.prefix=!1,P.argument=j,ja(j),_e(),j=me(P,"UpdateExpression")}return j}function Ev(){return Sn(Gl())}function Sn(P,Q){var j;return Ue(hu)?(j=hs(P),j.object=P,j.property=ds(!0),j.computed=!1,Sn(me(j,"MemberExpression"),Q)):Ue(ql)?(j=hs(P),j.object=P,j.property=bt(),j.computed=!0,He(Dl),Sn(me(j,"MemberExpression"),Q)):!Q&&Ue(Di)?(j=hs(P),j.callee=P,j.arguments=Zl(yi,!1),Sn(me(j,"CallExpression"),Q)):P}function Gl(){var P;switch(x){case au:return P=ct(),_e(),me(P,"ThisExpression");case le:return ds();case J:case re:case ce:return P=ct(),P.value=E,P.raw=h.slice(y,b),_e(),me(P,"Literal");case ou:case lu:case cu:return P=ct(),P.value=x.atomValue,P.raw=x.keyword,_e(),me(P,"Literal");case Di:var Q=w,j=y;_e();var z=bt();return z.start=j,z.end=b,c.locations&&(z.loc.start=Q,z.loc.end=k),c.ranges&&(z.range=[j,b]),He(yi),z;case ql:return P=ct(),_e(),P.elements=Zl(Dl,!0,!0),me(P,"ArrayExpression");case mn:return Cv();case ls:return P=ct(),_e(),Yl(P,!1);case nu:return Pv()}ji()}function Pv(){var P=ct();return _e(),P.callee=Sn(Gl(),!0),P.arguments=Ue(Di)?Zl(yi,!1):G,me(P,"NewExpression")}function Cv(){var P=ct(),Q=!0,j=!1;for(P.properties=[],_e();!Ue(mr);){if(Q)Q=!1;else if(He(cs),c.allowTrailingCommas&&Ue(mr))break;var z={key:_u()},Oe=!1,pe;if(Ue(On)?(z.value=bt(!0),pe=z.kind="init"):z.key.type==="Identifier"&&(z.key.name==="get"||z.key.name==="set")?(Oe=j=!0,pe=z.kind=z.key.name,z.key=_u(),x!==Di&&ji(),z.value=Yl(ct(),!1)):ji(),z.key.type==="Identifier"&&(W||j))for(var ye=0;ye<P.properties.length;++ye){var qe=P.properties[ye];if(qe.key.name===z.key.name){var xn=pe===qe.kind||Oe&&qe.kind==="init"||pe==="init"&&(qe.kind==="get"||qe.kind==="set");xn&&!W&&pe==="init"&&qe.kind==="init"&&(xn=!1),xn&&M(z.key.start,"Redefinition of property")}}P.properties.push(z)}return me(P,"ObjectExpression")}function _u(){return x===J||x===re?Gl():ds(!0)}function Yl(P,Q){x===le?P.id=ds():Q?ji():P.id=null,P.params=[];var j=!0;for(He(Di);!Ue(yi);)j?j=!1:He(cs),P.params.push(ds());var z=F,Oe=L;if(F=!0,L=[],P.body=wn(!0),F=z,L=Oe,W||P.body.body.length&&Wl(P.body.body[0]))for(var pe=P.id?-1:0;pe<P.params.length;++pe){var ye=pe<0?P.id:P.params[pe];if((Ou(ye.name)||La(ye.name))&&M(ye.start,"Defining '"+ye.name+"' in strict mode"),pe>=0)for(var qe=0;qe<pe;++qe)ye.name===P.params[qe].name&&M(ye.start,"Argument name clash in strict mode")}return me(P,Q?"FunctionDeclaration":"FunctionExpression")}function Zl(P,Q,j){for(var z=[],Oe=!0;!Ue(P);){if(Oe)Oe=!1;else if(He(cs),Q&&c.allowTrailingCommas&&Ue(P))break;z.push(j&&x===cs?null:bt(!0))}return z}function ds(P){var Q=ct();return P&&c.forbidReserved==="everywhere"&&(P=!1),x===le?(!P&&(c.forbidReserved&&rv(E)||W&&Ou(E))&&h.slice(y,b).indexOf("\\")===-1&&M(y,"The keyword '"+E+"' is reserved"),Q.name=E):P&&x.keyword?Q.name=x.keyword:ji(),_=!1,_e(),me(Q,"Identifier")}})},vm:a=>{a.exports=f2}},s={};function r(a){var o=s[a];if(o!==void 0)return o.exports;var l=s[a]={exports:{}};return i[a].call(l.exports,l,l.exports,r),l.exports}r.d=(a,o)=>{for(var l in o)r.o(o,l)&&!r.o(a,l)&&Object.defineProperty(a,l,{enumerable:!0,get:o[l]})},r.o=(a,o)=>Object.prototype.hasOwnProperty.call(a,o),r.r=a=>{typeof Symbol<"u"&&Symbol.toStringTag&&Object.defineProperty(a,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(a,"__esModule",{value:!0})};var n={};return(()=>{/*!*******************************!*\
  !*** ./src/js-interpreter.js ***!
  \*******************************/r.r(n),r.d(n,{default:()=>l});const a=r("./original-repo/acorn.js");globalThis.acorn=a;const{Interpreter:o}=r("./original-repo/interpreter.js"),l=o})(),n=n.default,n})())})(L0);var g2=L0.exports;const m2=h2(g2);class rg{constructor(e,i,s={}){this.userCode=e,this.originalArray=[...i],this.callbacks={onCompare:s.onCompare||(()=>{}),onSwap:s.onSwap||(()=>{}),onStep:s.onStep||(()=>{}),onError:s.onError||(()=>{}),onSorted:s.onSorted||(()=>{}),onLog:s.onLog||(()=>{}),onVariables:s.onVariables||(()=>{}),onAutoAccess:s.onAutoAccess||(()=>{}),onLoopProgress:s.onLoopProgress||(()=>{}),onCallStack:s.onCallStack||(()=>{})},this.interpreter=null,this.stepCount=0,this.maxSteps=1e4,this.stats={comparisons:0,swaps:0},this.currentComparing=[],this.currentSwapping=[],this.currentAccessing=[],this.currentWriting=[],this.sorted=new Set,this.isInitialized=!1,this.lastLine=1,this.history=[],this.maxHistory=500,this.historyIndex=-1,this.trackedVariables=["arr","n","i","j","k","temp","temp2","swapped","key","min","max","minIdx","left","right","pivot","mid","lo","hi","p","size"],this.loopStack=[],this.autoVisualize=!0,this.callStack=[],this.lastCallStackLength=0,this.previousArrayState=[...i],this.swapDetectionEnabled=!0,this.comparisonOperator=">",this.comparisonMode="array-array",this.comparisonValues=[],this.comparisonVarNames=[],this.swapValues=[],this.swapLine=null,this.firstWriteLine=null}init(){try{const e=this.wrapUserCode(this.userCode);return this.interpreter=new m2(e,(i,s)=>{this.injectVisualizationAPI(i,s)}),this.isInitialized=!0,this.stepCount=0,this.stats={comparisons:0,swaps:0},this.sorted=new Set,this.history=[],this.historyIndex=-1,!0}catch(e){return this.callbacks.onError({type:"syntax",message:e.message,line:this.extractLineNumber(e)}),!1}}wrapUserCode(e){let i=this.transpileES6(e);const s=`var arr = [${this.originalArray.join(",")}];
`;let r=i;if(!/\w+\s*\(\s*arr\s*\)\s*;?\s*$/.test(i.trim())){const a=i.match(/function\s+(\w+)\s*\(/);a&&(r=i+`
${a[1]}(arr);`)}return s+r}transpileES6(e){let i=e;return i=i.replace(/\b(let|const)\s+/g,"var "),i=i.replace(/\(([^)]*)\)\s*=>\s*\{/g,"function($1) {"),i=i.replace(/\(([^)]*)\)\s*=>\s*([^{;\n][^;\n]*)/g,"function($1) { return $2; }"),i=i.replace(/(\b[a-zA-Z_]\w*)\s*=>\s*([^{;\n][^;\n]*)/g,"function($1) { return $2; }"),i=i.replace(/`([^`]*)`/g,(s,r)=>{const n=r.split(/\$\{([^}]+)\}/);return n.length===1?`"${r}"`:n.map((a,o)=>o%2===0?a?`"${a}"`:"":a).filter(a=>a).join(" + ")}),i=i.replace(/for\s*\(\s*var\s+(\w+)\s+of\s+(\w+)\s*\)/g,"for (var _i = 0, $1 = $2[_i]; _i < $2.length; _i++, $1 = $2[_i])"),i}injectVisualizationAPI(e,i){const s=this,r=e.nativeToPseudo({});e.setProperty(i,"visualize",r);const n=e.createNativeFunction(function(d,u){var g,m;const p=((g=d==null?void 0:d.valueOf)==null?void 0:g.call(d))??d,f=((m=u==null?void 0:u.valueOf)==null?void 0:m.call(u))??u;return s.stats.comparisons++,s.currentComparing=[p,f],s.currentSwapping=[],s.callbacks.onCompare(p,f),e.UNDEFINED});e.setProperty(r,"compare",n);const a=e.createNativeFunction(function(d,u){var g,m;const p=((g=d==null?void 0:d.valueOf)==null?void 0:g.call(d))??d,f=((m=u==null?void 0:u.valueOf)==null?void 0:m.call(u))??u;return s.stats.swaps++,s.currentComparing=[],s.currentSwapping=[p,f],s.callbacks.onSwap(p,f),e.UNDEFINED});e.setProperty(r,"swap",a);const o=e.createNativeFunction(function(d){var p;const u=((p=d==null?void 0:d.valueOf)==null?void 0:p.call(d))??d;return s.sorted.add(u),s.callbacks.onSorted(u),e.UNDEFINED});e.setProperty(r,"sorted",o);const l=e.createNativeFunction(function(d,u){var g,m;const p=((g=d==null?void 0:d.valueOf)==null?void 0:g.call(d))??d,f=((m=u==null?void 0:u.valueOf)==null?void 0:m.call(u))??u;return s.callbacks.onLog(p,f),e.UNDEFINED});e.setProperty(r,"log",l);const c=e.nativeToPseudo({});e.setProperty(i,"console",c);const h=e.createNativeFunction(function(...d){const u=d.map(p=>{var f;return((f=p==null?void 0:p.valueOf)==null?void 0:f.call(p))??p});return console.log("[Sandbox]",...u),e.UNDEFINED});e.setProperty(c,"log",h)}step(){if(!this.isInitialized||!this.interpreter)return{done:!0,error:"Not initialized"};if(this.stepCount>=this.maxSteps)return this.callbacks.onError({type:"runtime",message:`Execution limit exceeded (${this.maxSteps} steps). Possible infinite loop.`}),{done:!0,array:this.getArrayState()};try{const e=this.captureSnapshot(),i=this.interpreter.step();this.stepCount++;const s=this.getCurrentLine(),r=this.getCurrentNodeType();this.analyzeCurrentNode(),this.detectSwapPattern();const n=["ExpressionStatement","IfStatement","ForStatement","WhileStatement","ReturnStatement","AssignmentExpression","CallExpression","VariableDeclaration"];s!==this.lastLine&&n.includes(r)&&(this.lastLine=s);const a=this.getArrayState(),o=this.extractVariables();this.history.length<this.maxHistory&&(this.history.push(e),this.historyIndex=this.history.length-1);const l={array:a,line:this.lastLine,stepCount:this.stepCount,stats:{...this.stats},comparing:[...this.currentComparing],swapping:[...this.currentSwapping],accessing:[...this.currentAccessing],writing:[...this.currentWriting],sorted:new Set(this.sorted),variables:o};return console.log("%c[ExecutionEngine] CALLING onStep callback!","background: #f59e0b; color: black; font-weight: bold;"),console.log("[ExecutionEngine] stepState:",l),this.callbacks.onStep(l),console.log("[ExecutionEngine] onStep callback completed"),this.callbacks.onVariables(o),this.currentComparing=[],this.currentSwapping=[],this.currentAccessing=[],this.currentWriting=[],{done:!i,array:a,line:this.lastLine,stats:{...this.stats},variables:o}}catch(e){return this.callbacks.onError({type:"runtime",message:e.message,line:this.getCurrentLine()}),{done:!0,error:e.message,array:this.getArrayState()}}}stepUntilVisualization(e=100){const i=this.stats.comparisons,s=this.stats.swaps;for(let r=0;r<e;r++){const n=this.step();if(n.done||this.stats.comparisons>i||this.stats.swaps>s)return n}return{done:!1,array:this.getArrayState(),stats:{...this.stats}}}stepToNextStatement(){if(!this.isInitialized||!this.interpreter)return{done:!0,error:"Not initialized"};const e=this.lastLine,i=this.stats.comparisons,s=this.stats.swaps,r=[...this.getArrayState()];let n=!0,a=0;const o=100;let l=!1,c=null;for(;n&&a<o;)try{const p=this.captureSnapshot();n=this.interpreter.step(),this.stepCount++,a++;const f=this.getCurrentNode(),g=(f==null?void 0:f.type)||"",m=this.getCurrentLine();if(g==="IfStatement"){const x=this.interpreter.stateStack[this.interpreter.stateStack.length-1];x!=null&&x.doneTest_&&(l=!0,c=x==null?void 0:x.value)}this.analyzeCurrentNode(),this.detectSwapPattern(),this.history.length<this.maxHistory&&(this.history.push(p),this.historyIndex=this.history.length-1);const y=g==="ExpressionStatement"||g==="AssignmentExpression"||g==="VariableDeclaration",b=this.stats.swaps>s,w=this.stats.comparisons>i;if(l||w||b||m!==e&&m>0&&!y&&(g==="IfStatement"||g==="ForStatement"||g==="WhileStatement"||g==="ReturnStatement")){this.lastLine=m>0?m:this.lastLine;break}}catch(p){return this.callbacks.onError({type:"runtime",message:p.message,line:this.getCurrentLine()}),{done:!0,error:p.message,array:this.getArrayState()}}const h=this.getArrayState(),d=this.extractVariables();if(this.swapDetectionEnabled&&r){const p=[];for(let f=0;f<h.length;f++)h[f]!==r[f]&&p.push(f);if(p.length===2){const[f,g]=p;h[f]===r[g]&&h[g]===r[f]&&(this.currentSwapping=[f,g],this.swapValues=[r[f],r[g]],this.swapLine=this.firstWriteLine||this.lastLine,this.stats.swaps++,this.callbacks.onSwap(f,g),console.log("[AutoSwap] Detected swap:",f,"â†”",g,"values:",this.swapValues))}}const u={array:h,line:this.lastLine,stepCount:this.stepCount,stats:{...this.stats},comparing:[...this.currentComparing],comparisonOperator:this.comparisonOperator||">",comparisonMode:this.comparisonMode||"array-array",comparisonValues:[...this.comparisonValues||[]],comparisonVarNames:[...this.comparisonVarNames||[]],swapping:[...this.currentSwapping],swapValues:[...this.swapValues||[]],swapLine:this.swapLine||null,accessing:[...this.currentAccessing],writing:[...this.currentWriting],sorted:new Set(this.sorted),variables:d,branch:l?c?"if_true":"if_false":null};return this.callbacks.onStep(u),this.callbacks.onVariables(d),this.currentComparing=[],this.currentSwapping=[],this.comparisonOperator=">",this.comparisonMode="array-array",this.comparisonValues=[],this.comparisonVarNames=[],this.swapValues=[],this.swapLine=null,this.firstWriteLine=null,this.currentAccessing=[],this.currentWriting=[],{done:!n,array:h,line:this.lastLine,stats:{...this.stats},variables:d,branch:u.branch,microSteps:a}}getArrayState(){var e;if(!this.interpreter)return[...this.originalArray];try{const i=this.interpreter.globalObject,s=this.interpreter.getProperty(i,"arr");if(!s)return[...this.originalArray];const r=this.interpreter.getProperty(s,"length"),n=[];for(let a=0;a<r;a++){const o=this.interpreter.getProperty(s,a);n.push(((e=o==null?void 0:o.valueOf)==null?void 0:e.call(o))??o)}return n}catch(i){return console.warn("[ExecutionEngine] Failed to get array state:",i),[...this.originalArray]}}getCurrentLine(){var e,i,s,r;if(!((i=(e=this.interpreter)==null?void 0:e.stateStack)!=null&&i.length))return 1;try{const n=this.interpreter.stateStack[this.interpreter.stateStack.length-1],a=n==null?void 0:n.node;if((r=(s=a==null?void 0:a.loc)==null?void 0:s.start)!=null&&r.line)return Math.max(1,a.loc.start.line-1)}catch{}return this.lastLine}extractLineNumber(e){if(!e)return 1;const i=e.message||"";let s=i.match(/line:?\s*(\d+)/i);return s||(s=i.match(/(?:at|on)\s+line\s+(\d+)/i),s)||(s=i.match(/:(\d+):/),s)?parseInt(s[1],10):e.lineNumber?e.lineNumber:(s=i.match(/\((\d+):\d+\)/),s?parseInt(s[1],10):1)}reset(){this.interpreter=null,this.stepCount=0,this.stats={comparisons:0,swaps:0},this.currentComparing=[],this.currentSwapping=[],this.sorted=new Set,this.isInitialized=!1,this.lastLine=1,this.history=[],this.historyIndex=-1}isDone(){return this.interpreter?this.stepCount>=this.maxSteps:!0}getStats(){return{...this.stats}}getCurrentNodeType(){var e,i,s;if(!((i=(e=this.interpreter)==null?void 0:e.stateStack)!=null&&i.length))return"";try{const r=this.interpreter.stateStack[this.interpreter.stateStack.length-1];return((s=r==null?void 0:r.node)==null?void 0:s.type)||""}catch{return""}}getCurrentNode(){var e,i;if(!((i=(e=this.interpreter)==null?void 0:e.stateStack)!=null&&i.length))return null;try{const s=this.interpreter.stateStack[this.interpreter.stateStack.length-1];return(s==null?void 0:s.node)||null}catch{return null}}analyzeCurrentNode(){var r,n;const e=this.getCurrentNode();if(!e||!this.autoVisualize)return;const i=e.type,s=this.extractVariables();this.currentAccessing=[],this.currentWriting=[];try{(i==="ForStatement"||i==="WhileStatement")&&this.detectLoopProgress(e,s),i==="MemberExpression"&&this.detectArrayAccess(e,s),i==="BinaryExpression"&&this.detectAutoComparison(e,s),i==="IfStatement"&&e.test&&e.test.type==="BinaryExpression"&&this.detectAutoComparison(e.test,s),i==="WhileStatement"&&e.test&&(e.test.type==="BinaryExpression"?this.detectAutoComparison(e.test,s):e.test.type==="LogicalExpression"&&(((r=e.test.left)==null?void 0:r.type)==="BinaryExpression"&&this.detectAutoComparison(e.test.left,s),((n=e.test.right)==null?void 0:n.type)==="BinaryExpression"&&this.detectAutoComparison(e.test.right,s))),i==="AssignmentExpression"&&this.detectArrayWrite(e,s),i==="CallExpression"&&this.detectFunctionCall(e),i==="ReturnStatement"&&this.detectFunctionReturn(e),this.updateCallStack()}catch(a){console.warn("[AutoViz] Analysis error:",a.message)}}detectFunctionCall(e){var i,s,r,n,a,o;try{let l="anonymous";if((i=e.callee)!=null&&i.name?l=e.callee.name:(r=(s=e.callee)==null?void 0:s.property)!=null&&r.name&&(l=e.callee.property.name),l==="compare"||l==="swap"||l==="sorted"||l==="log")return;const c=((a=(n=e.loc)==null?void 0:n.start)==null?void 0:a.line)||this.lastLine,h=((o=e.arguments)==null?void 0:o.length)||0;this.pendingCall={name:l,line:c,argCount:h}}catch{}}detectFunctionReturn(e){this.pendingReturn=!0}updateCallStack(){var e,i,s,r,n;if((e=this.interpreter)!=null&&e.stateStack)try{const a=[];for(const o of this.interpreter.stateStack)if(((i=o.node)==null?void 0:i.type)==="CallExpression"&&o.doneCallee_){let l="anonymous";if((s=o.node.callee)!=null&&s.name&&(l=o.node.callee.name),l==="visualize"||l==="compare"||l==="swap")continue;const c=((n=(r=o.node.loc)==null?void 0:r.start)==null?void 0:n.line)||0;a.push({name:l,line:c})}(a.length!==this.lastCallStackLength||JSON.stringify(a)!==JSON.stringify(this.callStack))&&(this.callStack=a,this.lastCallStackLength=a.length,this.callbacks.onCallStack([...this.callStack]))}catch{}}getCallStack(){return[...this.callStack]}detectLoopProgress(e,i){var s,r,n,a,o,l;try{const c=e.init,h=e.test;let d=null,u=null;(n=(r=(s=c==null?void 0:c.declarations)==null?void 0:s[0])==null?void 0:r.id)!=null&&n.name?d=c.declarations[0].id.name:(a=h==null?void 0:h.left)!=null&&a.name&&(d=h.left.name),(o=h==null?void 0:h.right)!=null&&o.name&&i[h.right.name]!==void 0?u=i[h.right.name]:((l=h==null?void 0:h.right)==null?void 0:l.value)!==void 0&&(u=h.right.value);const p=i[d];d&&p!==void 0&&this.callbacks.onLoopProgress({variable:d,current:p,max:u,depth:this.loopStack.length})}catch{}}detectArrayAccess(e,i){var s,r,n,a,o;try{const l=(s=e.object)==null?void 0:s.name,c=((r=e.property)==null?void 0:r.name)||((n=e.property)==null?void 0:n.value);if(l==="arr"){let h=null;(a=e.property)!=null&&a.name&&i[e.property.name]!==void 0?h=i[e.property.name]:((o=e.property)==null?void 0:o.value)!==void 0&&(h=e.property.value),h!==null&&h>=0&&h<this.originalArray.length&&(this.currentAccessing.push(h),this.callbacks.onAutoAccess({type:"read",indices:[h]}))}}catch{}}detectAutoComparison(e,i){try{const s=e.operator;if(!["<",">","<=",">=","==","===","!=","!=="].includes(s))return;const r=e.left,n=e.right,a=u=>{var f,g,m,y,b,w;if(!u||u.type!=="MemberExpression"||((f=u.object)==null?void 0:f.name)!=="arr")return null;const p=u.property;if((p==null?void 0:p.type)==="Identifier"&&i[p.name]!==void 0)return{index:i[p.name],varName:p.name};if((p==null?void 0:p.type)==="Literal"&&typeof p.value=="number")return{index:p.value,varName:null};if((p==null?void 0:p.type)==="BinaryExpression"){const k=((g=p.left)==null?void 0:g.type)==="Identifier"?i[p.left.name]:((m=p.left)==null?void 0:m.type)==="Literal"?p.left.value:null,x=((y=p.right)==null?void 0:y.type)==="Identifier"?i[p.right.name]:((b=p.right)==null?void 0:b.type)==="Literal"?p.right.value:null;if(k!=null&&x!==null&&x!==void 0){let E=null;if(p.operator==="+"&&(E=k+x),p.operator==="-"&&(E=k-x),E!==null)return{index:E,varName:((w=p.left)==null?void 0:w.type)==="Identifier"?p.left.name:null}}}return null},o=u=>u?u.type==="Identifier"&&i[u.name]!==void 0?{value:i[u.name],varName:u.name}:u.type==="Literal"&&typeof u.value=="number"?{value:u.value,varName:null}:null:null,l=a(r),c=a(n),h=o(r),d=o(n);if(l&&c){const u=l.index,p=c.index;if(u>=0&&u<this.originalArray.length&&p>=0&&p<this.originalArray.length){const f=!(this.currentComparing.length===2&&this.currentComparing[0]===u&&this.currentComparing[1]===p);this.currentComparing=[u,p],this.comparisonOperator=s,this.comparisonMode="array-array",this.comparisonValues=[this.getArrayState()[u],this.getArrayState()[p]],this.comparisonVarNames=[l.varName,c.varName].filter(Boolean),f&&(this.stats.comparisons++,this.callbacks.onCompare(u,p));return}}if(l&&d){const u=l.index,p=d.value;if(u>=0&&u<this.originalArray.length&&typeof p=="number"){const f=this.getArrayState()[u],g=`${u}-${d.varName||p}`,m=this.lastComparisonKey!==g;this.lastComparisonKey=g,this.currentComparing=[u,-1],this.comparisonOperator=s,this.comparisonMode="array-value",this.comparisonValues=[f,p],this.comparisonVarNames=[l.varName,d.varName].filter(Boolean),m&&(this.stats.comparisons++,this.callbacks.onCompare(u,u));return}}if(h&&c){const u=h.value,p=c.index;if(p>=0&&p<this.originalArray.length&&typeof u=="number"){const f=this.getArrayState()[p],g=`${h.varName||u}-${p}`,m=this.lastComparisonKey!==g;this.lastComparisonKey=g,this.currentComparing=[-1,p],this.comparisonOperator=s,this.comparisonMode="value-array",this.comparisonValues=[u,f],this.comparisonVarNames=[h.varName,c.varName].filter(Boolean),m&&(this.stats.comparisons++,this.callbacks.onCompare(p,p));return}}}catch{}}detectArrayWrite(e,i){var s,r,n;try{const a=e.left;if((a==null?void 0:a.type)==="MemberExpression"&&((s=a.object)==null?void 0:s.name)==="arr"){let o=null;(r=a.property)!=null&&r.name&&i[a.property.name]!==void 0?o=i[a.property.name]:((n=a.property)==null?void 0:n.value)!==void 0&&(o=a.property.value),o!==null&&o>=0&&o<this.originalArray.length&&(this.currentWriting.push(o),this.callbacks.onAutoAccess({type:"write",indices:[o]}),this.firstWriteLine===null&&(this.firstWriteLine=this.getCurrentLine()))}}catch{}}detectSwapPattern(){if(this.swapDetectionEnabled)try{const e=this.getArrayState(),i=this.previousArrayState;if(!i||i.length!==e.length){this.previousArrayState=[...e];return}const s=[];for(let r=0;r<e.length;r++)e[r]!==i[r]&&s.push(r);if(s.length===2){const[r,n]=s;e[r]===i[n]&&e[n]===i[r]&&(this.currentSwapping=[r,n],this.swapValues=[i[r],i[n]],this.swapLine=this.firstWriteLine||this.lastLine,this.stats.swaps++,this.callbacks.onSwap(r,n))}this.previousArrayState=[...e]}catch{}}extractVariables(){var i,s,r,n;if(!this.interpreter)return{};const e={};try{const a=this.interpreter.globalObject;console.log("[ExtractVars] Checking global object properties:",a!=null&&a.properties?Object.keys(a.properties).slice(0,10):"none");for(const o of this.trackedVariables)try{const l=this.interpreter.getProperty(a,o);if(l!==void 0&&l!==this.interpreter.UNDEFINED){const c=((i=l==null?void 0:l.valueOf)==null?void 0:i.call(l))??l;if(o==="arr"&&(l!=null&&l.properties)){const h=this.getArrayState();e[o]=h}else(typeof c=="number"||typeof c=="boolean"||typeof c=="string")&&(e[o]=c)}}catch{}if(this.interpreter.stateStack&&this.interpreter.stateStack.length>0){console.log("[ExtractVars] State stack length:",this.interpreter.stateStack.length);for(let o=this.interpreter.stateStack.length-1;o>=0;o--){const l=this.interpreter.stateStack[o];if(!l)continue;o===this.interpreter.stateStack.length-1&&console.log("[ExtractVars] Top state type:",(s=l.node)==null?void 0:s.type,"has scope:",!!l.scope,"scope keys:",l.scope?Object.keys(l.scope).slice(0,5):"none");const c=l.scope;if(c){if(c.properties){const h=Object.keys(c.properties);h.length>0&&o===this.interpreter.stateStack.length-1&&console.log("[ExtractVars] Scope properties:",h);for(const d of this.trackedVariables)if(e[d]===void 0&&d in c.properties){const u=c.properties[d];if(u!==void 0&&u!==this.interpreter.UNDEFINED){const p=((r=u==null?void 0:u.valueOf)==null?void 0:r.call(u))??u;(typeof p=="number"||typeof p=="boolean"||typeof p=="string")&&(e[d]=p,console.log("[ExtractVars] Found via scope.properties:",d,"=",p))}}}if(c.object&&c.object.properties){for(const h of this.trackedVariables)if(e[h]===void 0&&h in c.object.properties){const d=c.object.properties[h];if(d!==void 0&&d!==this.interpreter.UNDEFINED){const u=((n=d==null?void 0:d.valueOf)==null?void 0:n.call(d))??d;(typeof u=="number"||typeof u=="boolean"||typeof u=="string")&&(e[h]=u,console.log("[ExtractVars] Found via scope.object.properties:",h,"=",u))}}}}}}console.log("[ExtractVars] RESULT:",Object.keys(e).length,"variables:",e)}catch(a){console.warn("[ExecutionEngine] Failed to extract variables:",a)}return e}captureSnapshot(){return{array:this.getArrayState(),line:this.lastLine,stepCount:this.stepCount,stats:{...this.stats},comparing:[...this.currentComparing],swapping:[...this.currentSwapping],sorted:new Set(this.sorted),variables:this.extractVariables()}}restoreSnapshot(e){return e?(this.lastLine=e.line,this.stats={...e.stats},this.sorted=new Set(e.sorted),this.currentComparing=[...e.comparing||[]],this.currentSwapping=[...e.swapping||[]],e):null}stepBack(){if(this.historyIndex<=0)return null;this.historyIndex--;const e=this.history[this.historyIndex];return e?(this.restoreSnapshot(e),this.callbacks.onStep({...e,stepCount:this.historyIndex+1}),this.callbacks.onVariables(e.variables||{}),e):null}stepForwardInHistory(){if(this.historyIndex>=this.history.length-1)return null;this.historyIndex++;const e=this.history[this.historyIndex];return e?(this.restoreSnapshot(e),this.callbacks.onStep({...e,stepCount:this.historyIndex+1}),this.callbacks.onVariables(e.variables||{}),e):null}getHistory(){return this.history}getHistoryIndex(){return this.historyIndex}canStepBack(){return this.historyIndex>0}goToStep(e){if(e<0||e>=this.history.length)return null;this.historyIndex=e;const i=this.history[e];return i?(this.restoreSnapshot(i),this.callbacks.onStep({...i,stepCount:e+1}),this.callbacks.onVariables(i.variables||{}),i):null}}class ng{constructor(e,i){this.originalCode=e,this.originalLines=e.split(`
`),this.originalLineCount=this.originalLines.length;const s=this.extractArrayFromCode(e);s&&s.length>0?(this.array=s,this.arrayInCode=!0):(this.array=[...i],this.arrayInCode=!1),this.steps=[],this.stats={comparisons:0,swaps:0},this.currentLine=0,this.isComplete=!1,this.skulptLoaded=!1,this.error=null,this.setupLineCount=0,this.instrumentationOffset=0}extractArrayFromCode(e){const i=e.match(/^arr\s*=\s*\[([\d\s,]+)\]/m);return i?i[1].split(",").map(s=>parseInt(s.trim(),10)).filter(s=>!isNaN(s)):null}parseError(e){var r,n;const i={type:"Error",message:"",originalLine:null,instrumentedLine:null,column:null,sourceText:"",rawError:e.toString(),arrayInfo:{length:this.array.length,indices:`0-${this.array.length-1}`}},s=e.toString();if(e.tp$name)i.type=e.tp$name;else{const a=s.match(/Sk\.builtin\.(\w+)/);a&&(i.type=a[1])}if((n=(r=e.args)==null?void 0:r.v)!=null&&n[0]){const a=e.args.v[0];i.message=a.v||a.toString()}else{const a=s.match(/:\s*(.+?)(?:\s+on line|$)/);a&&(i.message=a[1])}if(e.traceback&&e.traceback.length>0){const a=e.traceback[0];i.instrumentedLine=a.lineno,i.column=a.colno,i.sourceText=a.source||""}else{const a=s.match(/line\s+(\d+)/i);a&&(i.instrumentedLine=parseInt(a[1]))}return i.instrumentedLine!==null&&(i.originalLine=this.mapLineToOriginal(i.instrumentedLine)),i.originalLine!==null&&i.originalLine>0&&i.originalLine<=this.originalLineCount&&(i.sourceText=this.originalLines[i.originalLine-1].trim()),i}mapLineToOriginal(e){if(e<=this.setupLineCount)return null;const i=e-this.setupLineCount,s=Math.ceil(i/1.5);return s<1?1:s>this.originalLineCount?this.originalLineCount:s}async init(){try{return window.Sk||await this.loadSkulpt(),window.Sk.configure({output:e=>{console.log("[Python Output]",e)},read:this.builtinRead.bind(this),__future__:window.Sk.python3,execLimit:1e5,yieldLimit:100}),this.skulptLoaded=!0,!0}catch(e){return console.error("[PythonEngine] Initialization error:",e),this.error=e,!1}}async loadSkulpt(){console.log("[PythonEngine] Loading Skulpt from CDN...");const e="https://skulpt.org/js/",i="https://cdn.jsdelivr.net/npm/skulpt@1.2.0/dist/";try{await this.loadScript(e+"skulpt.min.js"),await this.loadScript(e+"skulpt-stdlib.js"),console.log("[PythonEngine] Skulpt loaded from primary CDN")}catch(s){console.warn("[PythonEngine] Primary CDN failed, trying fallback...",s);try{await this.loadScript(i+"skulpt.min.js"),await this.loadScript(i+"skulpt-stdlib.js"),console.log("[PythonEngine] Skulpt loaded from fallback CDN")}catch(r){throw console.error("[PythonEngine] All CDNs failed:",r),new Error("Failed to load Skulpt from any CDN")}}if(!window.Sk)throw new Error("Skulpt loaded but Sk object not found");console.log("[PythonEngine] Skulpt loaded successfully")}loadScript(e){return new Promise((i,s)=>{if(document.querySelector(`script[src="${e}"]`)){setTimeout(()=>i(),100);return}const r=document.createElement("script");r.src=e,r.async=!0;const n=setTimeout(()=>{s(new Error(`Script load timeout: ${e}`))},15e3);r.onload=()=>{clearTimeout(n),console.log(`[PythonEngine] Loaded: ${e}`),i()},r.onerror=()=>{clearTimeout(n),s(new Error(`Failed to load script: ${e}`))},document.head.appendChild(r)})}builtinRead(e){if(window.Sk.builtinFiles&&window.Sk.builtinFiles.files[e])return window.Sk.builtinFiles.files[e];throw new Error(`File not found: '${e}'`)}instrumentCode(e){const i=e.split(`
`),s=[],r=[];let n=!1,a=0;i.forEach((l,c)=>{const h=l.trim(),d=l.match(/^(\s*)/)[1],u=d.length,p=c+1;if(!h||h.startsWith("#")){s.push(l);return}for(;r.length>0&&u<r[r.length-1].indent;)r.pop();if(r.map(m=>m.name),h.startsWith("def ")){s.push(l),n=!0,a=u,r.length=0;return}if(h.startsWith("for ")){const m=h.match(/for\s+(\w+)\s+in/);if(m){const k=m[1];r.push({name:k,indent:u})}s.push(l);const y=d+"    ",b=r.map(k=>k.name),w=this.buildVarsObject(b);s.push(`${y}__step__(${p}, ${w})`);return}if(h.startsWith("while ")){s.push(l);const m=d+"    ",y=r.map(w=>w.name),b=this.buildVarsObject(y);s.push(`${m}__step__(${p}, ${b}, "while_true")`);return}if(h.startsWith("if ")&&h.endsWith(":")){s.push(l);const m=d+"    ",y=r.map(w=>w.name),b=this.buildVarsObject(y);s.push(`${m}__step__(${p}, ${b}, "if_true")`);return}if(h.startsWith("elif ")&&h.endsWith(":")||h==="else:"){s.push(l);const m=d+"    ",y=r.map(k=>k.name),b=this.buildVarsObject(y),w=h==="else:"?"else":"elif_true";s.push(`${m}__step__(${p}, ${b}, "${w}")`);return}if(h.includes("visualize.compare")||h.includes("visualize.swap")||h.includes("visualize.mark_sorted")){s.push(l);return}const f=h.match(/^([a-zA-Z_]\w*)\s*=\s*.+/);if(f&&!h.startsWith("arr[")){const m=f[1];!r.find(w=>w.name===m)&&m!=="arr"&&r.push({name:m,indent:u}),s.push(l);const y=r.map(w=>w.name),b=this.buildVarsObject(y);s.push(`${d}__step__(${p}, ${b})`);return}if(h.match(/^arr\[.+\]\s*=\s*.+/)){s.push(l);const m=r.map(b=>b.name),y=this.buildVarsObject(m);s.push(`${d}__step__(${p}, ${y})`);return}if(s.push(l),n&&u>a){const m=r.map(b=>b.name),y=this.buildVarsObject(m);s.push(`${d}__step__(${p}, ${y})`)}else s.push(`${d}__step__(${p}, {})`)});const o=s.join(`
`);return console.log(`[INSTRUMENTED CODE]:
`+o.split(`
`).slice(0,30).join(`
`)),o}extractVariables(e,i){const s=e.match(/^([a-zA-Z_]\w*)\s*=/);s&&i.add(s[1]);const r=e.match(/for\s+(\w+)\s+in/);r&&i.add(r[1])}buildVarsObjectFromSet(e){const i=Array.from(e).filter(r=>r&&r!=="arr");return i.length===0?"{}":`{${i.map(r=>`"${r}": __safe_get__("${r}")`).join(", ")}}`}buildVarsObject(e){return e.length===0?"{}":`{${e.map(s=>`"${s}": ${s}`).join(", ")}}`}getSetupCode(){const i=`
# Execution engine setup (Skulpt-compatible)

${this.arrayInCode?"":`arr = ${JSON.stringify(this.array)}`}
__steps__ = []
__stats__ = {"comparisons": 0, "swaps": 0}

def __copy_dict__(d):
    """Create shallow copy of dict (Skulpt-compatible)"""
    result = {}
    for k in d:
        result[k] = d[k]
    return result

# Safe variable access - returns None if variable doesn't exist
__var_store__ = {}

def __safe_get__(name):
    """Safely get a variable value, returning None if undefined"""
    return __var_store__.get(name, None)

def __safe_set__(name, value):
    """Store a variable value for safe retrieval"""
    __var_store__[name] = value
    return value

def __safe_vars__():
    """Legacy - kept for compatibility"""
    return {}

def __get_vars__(var_names):
    """Safely extract variables by name from the current scope.
    Uses globals() which works in Skulpt. Returns dict with only existing vars."""
    result = {}
    g = globals()
    for name in var_names:
        if name in g:
            result[name] = g[name]
    return result


def __step__(line, variables, branch=None):
    """Capture current execution state"""
    vars_copy = __copy_dict__(variables)
    
    step_data = {
        "line": line,
        "arrayState": arr[:],
        "variables": vars_copy,
        "stats": __copy_dict__(__stats__),
        "comparing": [],
        "swapping": [],
        "i": vars_copy.get("i", -1),
        "j": vars_copy.get("j", -1),
        "target": vars_copy.get("target", None),
        "result": vars_copy.get("result", None)
    }
    
    # Add branch info if provided (for if/elif/else/while visualization)
    if branch is not None:
        step_data["branch"] = branch
        if branch == "if_true":
            step_data["description"] = "Condition is True - entering if block"
        elif branch == "elif_true":
            step_data["description"] = "Condition is True - entering elif block"
        elif branch == "else":
            step_data["description"] = "All conditions False - entering else block"
        elif branch == "while_true":
            step_data["description"] = "Condition is True - loop body executing"
        elif branch == "while_false":
            step_data["description"] = "Condition is False - exiting loop"
    
    __steps__.append(step_data)

# â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
# AUTO-DETECTION HELPERS - For standard student code (no visualize API)
# â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

def __auto_compare_indices__(i, j, op):
    """Auto-detect and visualize array comparison: arr[i] > arr[j]
    i and j are already evaluated as integers when passed from Python expressions"""
    global __stats__
    __stats__["comparisons"] = __stats__["comparisons"] + 1
    
    # i and j are already integers (evaluated from expressions like j or j+1)
    # No need for int() conversion which can fail on edge cases
    
    # Determine result based on operator
    if op == ">":
        result = arr[i] > arr[j]
    elif op == "<":
        result = arr[i] < arr[j]
    elif op == ">=":
        result = arr[i] >= arr[j]
    elif op == "<=":
        result = arr[i] <= arr[j]
    elif op == "==":
        result = arr[i] == arr[j]
    elif op == "!=":
        result = arr[i] != arr[j]
    else:
        result = arr[i] > arr[j]
    
    desc = "Comparing arr[" + str(i) + "]=" + str(arr[i]) + " " + op + " arr[" + str(j) + "]=" + str(arr[j])
    
    __steps__.append({
        "line": 0,
        "arrayState": arr[:],
        "variables": {"i": i, "j": j},
        "stats": __copy_dict__(__stats__),
        "comparing": [i, j],
        "swapping": [],
        "i": i,
        "j": j,
        "type": "compare",
        "result": result,
        "description": desc
    })

def __auto_compare__(idx, op):
    """Auto-detect comparison in while loops: arr[j] > key"""
    global __stats__
    __stats__["comparisons"] = __stats__["comparisons"] + 1

def __auto_swap__(i, j):
    """Auto-detect and visualize swap: temp pattern
    i and j are already evaluated as integers when passed from Python expressions"""
    global __stats__
    __stats__["swaps"] = __stats__["swaps"] + 1
    
    # i and j are already integers (evaluated from expressions like j or j+1)
    desc = "Swapping arr[" + str(i) + "]=" + str(arr[i]) + " with arr[" + str(j) + "]=" + str(arr[j])
    
    __steps__.append({
        "line": 0,
        "arrayState": arr[:],
        "variables": {"i": i, "j": j},
        "stats": __copy_dict__(__stats__),
        "comparing": [],
        "swapping": [i, j],
        "i": i,
        "j": j,
        "type": "swap",
        "description": desc
    })

# Legacy internal functions (for backward compatibility)
def __compare__(i, j):
    """Track array comparison (internal)"""
    return visualize.compare(i, j)

def __swap__(i, j):
    """Track and perform array swap (internal)"""
    visualize.swap(i, j)

# â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
# VISUALIZATION API - Use these in your sorting algorithms!
# â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

class Visualize:
    """Visualization hooks for sorting algorithms"""
    
    def compare(self, i, j):
        """
        Compare two array elements and record the comparison.
        Returns True if arr[i] > arr[j], False otherwise.
        
        Usage: if visualize.compare(i, j):  # instead of: if arr[i] > arr[j]:
        """
        global __stats__
        __stats__["comparisons"] = __stats__["comparisons"] + 1
        i, j = int(i), int(j)
        result = arr[i] > arr[j]
        
        gt_sym = ">"
        le_sym = "<="
        desc = "Comparing arr[" + str(i) + "]=" + str(arr[i]) + " " + (gt_sym if result else le_sym) + " arr[" + str(j) + "]=" + str(arr[j])
        
        __steps__.append({
            "line": 0,
            "arrayState": arr[:],
            "variables": {"i": i, "j": j},
            "stats": __copy_dict__(__stats__),
            "comparing": [i, j],
            "swapping": [],
            "i": i,
            "j": j,
            "type": "compare",
            "result": result,
            "description": desc
        })
        
        return result
    
    def compare_less(self, i, j):
        """
        Compare if arr[i] < arr[j] and record the comparison.
        Returns True if arr[i] < arr[j], False otherwise.
        
        Usage: if visualize.compare_less(i, j):  # for selection sort
        """
        global __stats__
        __stats__["comparisons"] = __stats__["comparisons"] + 1
        i, j = int(i), int(j)
        result = arr[i] < arr[j]
        
        lt_sym = "<"
        ge_sym = ">="
        desc = "Comparing arr[" + str(i) + "]=" + str(arr[i]) + " " + (lt_sym if result else ge_sym) + " arr[" + str(j) + "]=" + str(arr[j])
        
        __steps__.append({
            "line": 0,
            "arrayState": arr[:],
            "variables": {"i": i, "j": j},
            "stats": __copy_dict__(__stats__),
            "comparing": [i, j],
            "swapping": [],
            "i": i,
            "j": j,
            "type": "compare",
            "result": result,
            "description": desc
        })
        
        return result
    
    def compare_value(self, i, value, op=">"):
        """
        Compare arr[i] against a value (for insertion sort, quick sort).
        Returns True/False based on the comparison.
        
        Usage: if visualize.compare_value(j, key, ">"):  # arr[j] > key
        """
        global __stats__
        __stats__["comparisons"] = __stats__["comparisons"] + 1
        i = int(i)
        
        if op == ">":
            result = arr[i] > value
        elif op == "<":
            result = arr[i] < value
        elif op == ">=":
            result = arr[i] >= value
        elif op == "<=":
            result = arr[i] <= value
        else:
            result = arr[i] > value
        
        desc = "Comparing arr[" + str(i) + "]=" + str(arr[i]) + " " + op + " " + str(value) + " = " + str(result)
        
        __steps__.append({
            "line": 0,
            "arrayState": arr[:],
            "variables": {"i": i, "value": value},
            "stats": __copy_dict__(__stats__),
            "comparing": [i],
            "swapping": [],
            "i": i,
            "j": -1,
            "type": "compare",
            "result": result,
            "description": desc
        })
        
        return result
    
    def swap(self, i, j):
        """
        Swap two array elements and record the swap.
        
        Usage: visualize.swap(i, j)  # instead of: arr[i], arr[j] = arr[j], arr[i]
        """
        global __stats__, arr
        __stats__["swaps"] = __stats__["swaps"] + 1
        
        i, j = int(i), int(j)
        arr[i], arr[j] = arr[j], arr[i]
        
        desc = "Swapped arr[" + str(i) + "] with arr[" + str(j) + "]"
        
        __steps__.append({
            "line": 0,
            "arrayState": arr[:],
            "variables": {"i": i, "j": j},
            "stats": __copy_dict__(__stats__),
            "comparing": [],
            "swapping": [i, j],
            "i": i,
            "j": j,
            "type": "swap",
            "description": desc
        })
    
    def mark_sorted(self, i):
        """
        Mark an element as sorted (for visual feedback).
        
        Usage: visualize.mark_sorted(i)
        """
        desc = "Element at index " + str(i) + " is now in sorted position"
        
        __steps__.append({
            "line": 0,
            "arrayState": arr[:],
            "variables": {"sorted_idx": int(i)},
            "stats": __copy_dict__(__stats__),
            "comparing": [],
            "swapping": [],
            "sorted": [int(i)],
            "i": int(i),
            "j": -1,
            "type": "sorted",
            "description": desc
        })

# Create the visualize instance
visualize = Visualize()

`;return this.setupLineCount=i.split(`
`).length,i}async generateSteps(){if(!this.skulptLoaded&&!await this.init())throw new Error("Failed to initialize Skulpt");const e=this.getSetupCode(),i=this.instrumentCode(this.originalCode),s=this.detectAndGenerateFunctionCall(this.originalCode),r=e+`
`+i+`
`+s+`
__result__ = __steps__`;console.log("[PythonEngine] Executing instrumented code:",r);try{const a=await window.Sk.misceval.asyncToPromise(()=>window.Sk.importMainWithBody("<stdin>",!1,r,!0)),o=a.$d.__steps__;o&&(this.steps=window.Sk.ffi.remapToJs(o));const l=a.$d.__stats__;l&&(this.stats=window.Sk.ffi.remapToJs(l));const c=a.$d.arr;return c&&(this.array=window.Sk.ffi.remapToJs(c)),this.isComplete=!0,console.log(`[PythonEngine] Generated ${this.steps.length} steps`),this.steps}catch(n){throw console.error("[PythonEngine] Execution error:",n),this.error=n,n.toString().includes("SyntaxError")?new Error(`Python syntax error: ${n.toString()}`):n}}detectAndGenerateFunctionCall(e){const i=["bubble_sort","insertion_sort","selection_sort","quick_sort","merge_sort","heap_sort","bubble","insertion","selection","quick","merge","heap","sort"];if(i.some(a=>{const o=new RegExp(`^${a}\\s*\\(`,"m"),l=e.split(`
`);for(const c of l){const h=c.trim();if(!h.startsWith("def ")&&o.test(h))return!0}return!1}))return console.log("[PythonEngine] Found existing function call, not adding another"),"";const r=e.match(/def\s+(\w+)\s*\(\s*(\w+)(?:\s*[,=][^)]*)?\s*\)/);if(r){const a=r[1],o=r[2];if(i.some(c=>a.toLowerCase().includes(c))||o==="arr"||o==="array")return console.log(`[PythonEngine] Detected sorting function: ${a}(${o}), adding call`),`
# Auto-generated call to execute the sorting function
${a}(arr)
`}const n=e.match(/def\s+(\w+)\s*\(\s*arr\s*\)/);if(n){const a=n[1];return console.log(`[PythonEngine] Found function taking 'arr': ${a}(arr), adding call`),`
# Auto-generated call to execute the function
${a}(arr)
`}return console.log("[PythonEngine] No sorting function detected, code will run as-is"),""}getStep(e){return this.steps[e]||null}getTotalSteps(){return this.steps.length}reset(){this.steps=[],this.array=[...this.originalArray],this.stats={comparisons:0,swaps:0},this.currentLine=0,this.isComplete=!1,this.error=null}getError(){return this.error}}const U={KEYWORD:"KEYWORD",IDENTIFIER:"IDENTIFIER",NUMBER:"NUMBER",STRING:"STRING",BOOLEAN:"BOOLEAN",PLUS:"PLUS",MINUS:"MINUS",STAR:"STAR",SLASH:"SLASH",PERCENT:"PERCENT",LT:"LT",GT:"GT",LE:"LE",GE:"GE",EQ:"EQ",NE:"NE",AND:"AND",OR:"OR",NOT:"NOT",ASSIGN:"ASSIGN",PLUS_ASSIGN:"PLUS_ASSIGN",MINUS_ASSIGN:"MINUS_ASSIGN",INCREMENT:"INCREMENT",DECREMENT:"DECREMENT",LPAREN:"LPAREN",RPAREN:"RPAREN",LBRACE:"LBRACE",RBRACE:"RBRACE",LBRACKET:"LBRACKET",RBRACKET:"RBRACKET",SEMICOLON:"SEMICOLON",COMMA:"COMMA",DOT:"DOT",EOF:"EOF"},O2=new Set(["int","void","boolean","char","double","float","long","short","byte","for","while","if","else","return","break","continue","true","false","null","public","private","static","final","class","new"]);class ag{constructor(e,i,s,r){this.type=e,this.value=i,this.line=s,this.column=r}toString(){return`Token(${this.type}, ${JSON.stringify(this.value)}, L${this.line}:${this.column})`}}class y2{constructor(e){this.source=e,this.tokens=[],this.current=0,this.line=1,this.column=1,this.lineStart=0}tokenize(){for(this.tokens=[];!this.isAtEnd();)this.scanToken();return this.tokens.push(new ag(U.EOF,"",this.line,this.column)),this.tokens}isAtEnd(){return this.current>=this.source.length}peek(){return this.isAtEnd()?"\0":this.source[this.current]}peekNext(){return this.current+1>=this.source.length?"\0":this.source[this.current+1]}advance(){const e=this.source[this.current];return this.current++,this.column++,e}match(e){return this.isAtEnd()||this.source[this.current]!==e?!1:(this.current++,this.column++,!0)}addToken(e,i){const s=this.column-String(i).length;this.tokens.push(new ag(e,i,this.line,s>0?s:1))}scanToken(){const e=this.advance();switch(e){case"(":this.addToken(U.LPAREN,"(");break;case")":this.addToken(U.RPAREN,")");break;case"{":this.addToken(U.LBRACE,"{");break;case"}":this.addToken(U.RBRACE,"}");break;case"[":this.addToken(U.LBRACKET,"[");break;case"]":this.addToken(U.RBRACKET,"]");break;case";":this.addToken(U.SEMICOLON,";");break;case",":this.addToken(U.COMMA,",");break;case".":this.addToken(U.DOT,".");break;case"*":this.addToken(U.STAR,"*");break;case"%":this.addToken(U.PERCENT,"%");break;case"+":this.match("+")?this.addToken(U.INCREMENT,"++"):this.match("=")?this.addToken(U.PLUS_ASSIGN,"+="):this.addToken(U.PLUS,"+");break;case"-":this.match("-")?this.addToken(U.DECREMENT,"--"):this.match("=")?this.addToken(U.MINUS_ASSIGN,"-="):this.addToken(U.MINUS,"-");break;case"=":this.match("=")?this.addToken(U.EQ,"=="):this.addToken(U.ASSIGN,"=");break;case"!":this.match("=")?this.addToken(U.NE,"!="):this.addToken(U.NOT,"!");break;case"<":this.match("=")?this.addToken(U.LE,"<="):this.addToken(U.LT,"<");break;case">":this.match("=")?this.addToken(U.GE,">="):this.addToken(U.GT,">");break;case"&":this.match("&")&&this.addToken(U.AND,"&&");break;case"|":this.match("|")&&this.addToken(U.OR,"||");break;case"/":if(this.match("/"))for(;this.peek()!==`
`&&!this.isAtEnd();)this.advance();else this.match("*")?this.skipBlockComment():this.addToken(U.SLASH,"/");break;case" ":case"\r":case"	":break;case`
`:this.line++,this.column=1,this.lineStart=this.current;break;case'"':this.scanString();break;case"'":this.scanChar();break;default:this.isDigit(e)?this.scanNumber(e):this.isAlpha(e)?this.scanIdentifier(e):console.warn(`[JavaTokenizer] Unknown character '${e}' at line ${this.line}`);break}}skipBlockComment(){let e=1;for(;e>0&&!this.isAtEnd();)this.peek()===`
`&&(this.line++,this.column=0),this.peek()==="*"&&this.peekNext()==="/"?(this.advance(),this.advance(),e--):this.peek()==="/"&&this.peekNext()==="*"?(this.advance(),this.advance(),e++):this.advance()}scanString(){const e=this.line;let i="";for(;this.peek()!=='"'&&!this.isAtEnd();)this.peek()===`
`&&(this.line++,this.column=1),this.peek()==="\\"&&this.peekNext()?(this.advance(),i+=this.scanEscapeSequence()):i+=this.advance();if(this.isAtEnd()){console.error(`[JavaTokenizer] Unterminated string at line ${e}`);return}this.advance(),this.addToken(U.STRING,i)}scanChar(){let e="";this.peek()==="\\"?(this.advance(),e=this.scanEscapeSequence()):this.peek()!=="'"&&(e=this.advance()),this.peek()==="'"&&(this.advance(),this.addToken(U.STRING,e))}scanEscapeSequence(){const e=this.advance();switch(e){case"n":return`
`;case"t":return"	";case"r":return"\r";case"\\":return"\\";case'"':return'"';case"'":return"'";default:return e}}scanNumber(e){let i=e;for(;this.isDigit(this.peek());)i+=this.advance();if(this.peek()==="."&&this.isDigit(this.peekNext()))for(i+=this.advance();this.isDigit(this.peek());)i+=this.advance();if(this.peek()==="e"||this.peek()==="E")for(i+=this.advance(),(this.peek()==="+"||this.peek()==="-")&&(i+=this.advance());this.isDigit(this.peek());)i+=this.advance();"LlFfDd".includes(this.peek())&&this.advance(),this.addToken(U.NUMBER,parseFloat(i))}scanIdentifier(e){let i=e;for(;this.isAlphaNumeric(this.peek());)i+=this.advance();O2.has(i)?i==="true"||i==="false"?this.addToken(U.BOOLEAN,i==="true"):this.addToken(U.KEYWORD,i):this.addToken(U.IDENTIFIER,i)}isDigit(e){return e>="0"&&e<="9"}isAlpha(e){return e>="a"&&e<="z"||e>="A"&&e<="Z"||e==="_"}isAlphaNumeric(e){return this.isAlpha(e)||this.isDigit(e)}}function N0(t){return new y2(t).tokenize()}const ne={PROGRAM:"Program",FUNCTION_DECL:"FunctionDeclaration",VAR_DECL:"VariableDeclaration",ARRAY_LITERAL:"ArrayLiteral",FOR_STATEMENT:"ForStatement",WHILE_STATEMENT:"WhileStatement",IF_STATEMENT:"IfStatement",BLOCK_STATEMENT:"BlockStatement",EXPRESSION_STMT:"ExpressionStatement",RETURN_STATEMENT:"ReturnStatement",ASSIGNMENT_EXPR:"AssignmentExpression",UPDATE_EXPR:"UpdateExpression",BINARY_EXPR:"BinaryExpression",UNARY_EXPR:"UnaryExpression",LOGICAL_EXPR:"LogicalExpression",CALL_EXPR:"CallExpression",MEMBER_EXPR:"MemberExpression",IDENTIFIER:"Identifier",LITERAL:"Literal"};class v2{constructor(e){this.tokens=e,this.current=0}parse(){const e=[];for(;!this.isAtEnd();){const i=this.parseStatement();i&&e.push(i)}return{type:ne.PROGRAM,body:e}}isAtEnd(){return this.peek().type===U.EOF}peek(){return this.tokens[this.current]}previous(){return this.tokens[this.current-1]}advance(){return this.isAtEnd()||this.current++,this.previous()}check(e){return this.isAtEnd()?!1:this.peek().type===e}checkKeyword(e){if(this.isAtEnd())return!1;const i=this.peek();return i.type===U.KEYWORD&&i.value===e}match(...e){for(const i of e)if(this.check(i))return this.advance(),!0;return!1}matchKeyword(e){return this.checkKeyword(e)?(this.advance(),!0):!1}expect(e,i){if(this.check(e))return this.advance();throw this.error(i||`Expected ${e}`)}error(e){const i=this.peek();return new Error(`[JavaParser] ${e} at line ${i.line}, col ${i.column} (got ${i.type}: ${JSON.stringify(i.value)})`)}parseStatement(){return this.match(U.SEMICOLON)?null:this.check(U.LBRACE)?this.parseBlockStatement():this.checkKeyword("for")?this.parseForStatement():this.checkKeyword("while")?this.parseWhileStatement():this.checkKeyword("if")?this.parseIfStatement():this.checkKeyword("return")?this.parseReturnStatement():this.isTypeKeyword()?this.parseDeclaration():this.parseExpressionStatement()}isTypeKeyword(){const e=["int","void","boolean","char","double","float","long","short","byte"];return this.peek().type===U.KEYWORD&&e.includes(this.peek().value)}parseDeclaration(){const e=this.peek().line;let s=this.advance().value,r=!1;this.match(U.LBRACKET)&&(this.expect(U.RBRACKET,"Expected ] after ["),r=!0);const a=this.expect(U.IDENTIFIER,"Expected identifier").value;return this.check(U.LPAREN)?this.parseFunctionDeclaration(s,a,r,e):this.parseVariableDeclaration(s,a,r,e)}parseFunctionDeclaration(e,i,s,r){this.expect(U.LPAREN,"Expected ( after function name");const n=[];if(!this.check(U.RPAREN))do{const o=this.parseParameter();n.push(o)}while(this.match(U.COMMA));this.expect(U.RPAREN,"Expected ) after parameters");const a=this.parseBlockStatement();return{type:ne.FUNCTION_DECL,line:r,name:i,returnType:e,returnsArray:s,params:n,body:a}}parseParameter(){let i=this.expect(U.KEYWORD,"Expected parameter type").value,s=!1;this.match(U.LBRACKET)&&(this.expect(U.RBRACKET,"Expected ] after ["),s=!0);const r=this.expect(U.IDENTIFIER,"Expected parameter name");return{type:i,name:r.value,isArray:s}}parseVariableDeclaration(e,i,s,r){let n=null;return this.match(U.ASSIGN)&&(s&&this.check(U.LBRACE)?n=this.parseArrayLiteral():n=this.parseExpression()),this.match(U.SEMICOLON),{type:ne.VAR_DECL,line:r,varType:e,name:i,isArray:s,init:n}}parseArrayLiteral(){const e=this.peek().line;this.expect(U.LBRACE,"Expected { for array literal");const i=[];if(!this.check(U.RBRACE))do i.push(this.parseExpression());while(this.match(U.COMMA));return this.expect(U.RBRACE,"Expected } after array literal"),{type:ne.ARRAY_LITERAL,line:e,elements:i}}parseBlockStatement(){const e=this.peek().line;this.expect(U.LBRACE,"Expected {");const i=[];for(;!this.check(U.RBRACE)&&!this.isAtEnd();){const s=this.parseStatement();s&&i.push(s)}return this.expect(U.RBRACE,"Expected }"),{type:ne.BLOCK_STATEMENT,line:e,body:i}}parseForStatement(){const e=this.peek().line;this.advance(),this.expect(U.LPAREN,"Expected ( after for");let i=null;if(!this.check(U.SEMICOLON))if(this.isTypeKeyword()){const a=this.advance(),o=this.expect(U.IDENTIFIER,"Expected variable name");this.expect(U.ASSIGN,"Expected = in for init");const l=this.parseExpression();i={type:ne.VAR_DECL,line:e,varType:a.value,name:o.value,isArray:!1,init:l}}else i=this.parseExpression();this.expect(U.SEMICOLON,"Expected ; after for init");let s=null;this.check(U.SEMICOLON)||(s=this.parseExpression()),this.expect(U.SEMICOLON,"Expected ; after for condition");let r=null;this.check(U.RPAREN)||(r=this.parseExpression()),this.expect(U.RPAREN,"Expected ) after for clauses");const n=this.check(U.LBRACE)?this.parseBlockStatement():this.wrapInBlock(this.parseStatement());return{type:ne.FOR_STATEMENT,line:e,init:i,test:s,update:r,body:n}}parseWhileStatement(){const e=this.peek().line;this.advance(),this.expect(U.LPAREN,"Expected ( after while");const i=this.parseExpression();this.expect(U.RPAREN,"Expected ) after while condition");const s=this.check(U.LBRACE)?this.parseBlockStatement():this.wrapInBlock(this.parseStatement());return{type:ne.WHILE_STATEMENT,line:e,test:i,body:s}}parseIfStatement(){const e=this.peek().line;this.advance(),this.expect(U.LPAREN,"Expected ( after if");const i=this.parseExpression();this.expect(U.RPAREN,"Expected ) after if condition");const s=this.check(U.LBRACE)?this.parseBlockStatement():this.wrapInBlock(this.parseStatement());let r=null;return this.matchKeyword("else")&&(this.checkKeyword("if")?r=this.parseIfStatement():r=this.check(U.LBRACE)?this.parseBlockStatement():this.wrapInBlock(this.parseStatement())),{type:ne.IF_STATEMENT,line:e,test:i,consequent:s,alternate:r}}parseReturnStatement(){const e=this.peek().line;this.advance();let i=null;return this.check(U.SEMICOLON)||(i=this.parseExpression()),this.match(U.SEMICOLON),{type:ne.RETURN_STATEMENT,line:e,argument:i}}parseExpressionStatement(){const e=this.peek().line,i=this.parseExpression();return this.match(U.SEMICOLON),{type:ne.EXPRESSION_STMT,line:e,expression:i}}wrapInBlock(e){return e?e.type===ne.BLOCK_STATEMENT?e:{type:ne.BLOCK_STATEMENT,line:e.line,body:[e]}:{type:ne.BLOCK_STATEMENT,body:[]}}parseExpression(){return this.parseAssignment()}parseAssignment(){const e=this.parseLogicalOr();if(this.match(U.ASSIGN,U.PLUS_ASSIGN,U.MINUS_ASSIGN)){const i=this.previous().value,s=this.parseAssignment();return{type:ne.ASSIGNMENT_EXPR,line:e.line||this.previous().line,operator:i,left:e,right:s}}return e}parseLogicalOr(){let e=this.parseLogicalAnd();for(;this.match(U.OR);){const i="||",s=this.parseLogicalAnd();e={type:ne.LOGICAL_EXPR,line:e.line,operator:i,left:e,right:s}}return e}parseLogicalAnd(){let e=this.parseEquality();for(;this.match(U.AND);){const i="&&",s=this.parseEquality();e={type:ne.LOGICAL_EXPR,line:e.line,operator:i,left:e,right:s}}return e}parseEquality(){let e=this.parseComparison();for(;this.match(U.EQ,U.NE);){const i=this.previous().value,s=this.parseComparison();e={type:ne.BINARY_EXPR,line:e.line,operator:i,left:e,right:s}}return e}parseComparison(){let e=this.parseAdditive();for(;this.match(U.LT,U.GT,U.LE,U.GE);){const i=this.previous().value,s=this.parseAdditive();e={type:ne.BINARY_EXPR,line:e.line,operator:i,left:e,right:s}}return e}parseAdditive(){let e=this.parseMultiplicative();for(;this.match(U.PLUS,U.MINUS);){const i=this.previous().value,s=this.parseMultiplicative();e={type:ne.BINARY_EXPR,line:e.line,operator:i,left:e,right:s}}return e}parseMultiplicative(){let e=this.parseUnary();for(;this.match(U.STAR,U.SLASH,U.PERCENT);){const i=this.previous().value,s=this.parseUnary();e={type:ne.BINARY_EXPR,line:e.line,operator:i,left:e,right:s}}return e}parseUnary(){if(this.match(U.NOT,U.MINUS)){const e=this.previous().value,i=this.parseUnary();return{type:ne.UNARY_EXPR,line:this.previous().line,operator:e,prefix:!0,argument:i}}if(this.match(U.INCREMENT,U.DECREMENT)){const e=this.previous().value,i=this.parsePostfix();return{type:ne.UPDATE_EXPR,line:this.previous().line,operator:e,prefix:!0,argument:i}}return this.parsePostfix()}parsePostfix(){let e=this.parsePrimary();for(;;)if(this.match(U.LBRACKET)){const i=this.parseExpression();this.expect(U.RBRACKET,"Expected ]"),e={type:ne.MEMBER_EXPR,line:e.line,object:e,property:i,computed:!0}}else if(this.match(U.DOT)){const i=this.expect(U.IDENTIFIER,"Expected property name");e={type:ne.MEMBER_EXPR,line:e.line,object:e,property:{type:ne.IDENTIFIER,name:i.value,line:i.line},computed:!1}}else if(this.match(U.LPAREN)){const i=[];if(!this.check(U.RPAREN))do i.push(this.parseExpression());while(this.match(U.COMMA));this.expect(U.RPAREN,"Expected )"),e={type:ne.CALL_EXPR,line:e.line,callee:e,arguments:i}}else if(this.match(U.INCREMENT,U.DECREMENT))e={type:ne.UPDATE_EXPR,line:e.line,operator:this.previous().value,prefix:!1,argument:e};else break;return e}parsePrimary(){const e=this.peek();if(this.match(U.NUMBER))return{type:ne.LITERAL,line:e.line,value:e.value,raw:String(e.value)};if(this.match(U.BOOLEAN))return{type:ne.LITERAL,line:e.line,value:e.value,raw:String(e.value)};if(this.match(U.STRING))return{type:ne.LITERAL,line:e.line,value:e.value,raw:`"${e.value}"`};if(this.match(U.IDENTIFIER))return{type:ne.IDENTIFIER,line:e.line,name:e.value};if(this.match(U.LPAREN)){const i=this.parseExpression();return this.expect(U.RPAREN,"Expected )"),i}if(this.matchKeyword("true"))return{type:ne.LITERAL,line:e.line,value:!0};if(this.matchKeyword("false"))return{type:ne.LITERAL,line:e.line,value:!1};if(this.matchKeyword("null"))return{type:ne.LITERAL,line:e.line,value:null};throw this.error("Unexpected token")}}function b2(t){const e=typeof t=="string"?N0(t):t;return new v2(e).parse()}class og{constructor(){this.scopes=[new Map]}enterScope(){this.scopes.push(new Map)}exitScope(){this.scopes.pop()}declareVariable(e,i){this.scopes[this.scopes.length-1].set(e,i)}getVisibleVariables(){const e=new Set;for(const i of this.scopes)for(const s of i.keys())s!=="arr"&&e.add(s);return Array.from(e)}}class w2{constructor(){this.scopeTracker=new og,this.indentLevel=0}transpile(e){return this.scopeTracker=new og,this.indentLevel=0,this.generate(e)}generate(e){if(!e)return"";switch(e.type){case ne.PROGRAM:return this.generateProgram(e);case ne.FUNCTION_DECL:return this.generateFunctionDecl(e);case ne.VAR_DECL:return this.generateVarDecl(e);case ne.ARRAY_LITERAL:return this.generateArrayLiteral(e);case ne.FOR_STATEMENT:return this.generateForStatement(e);case ne.WHILE_STATEMENT:return this.generateWhileStatement(e);case ne.IF_STATEMENT:return this.generateIfStatement(e);case ne.BLOCK_STATEMENT:return this.generateBlockStatement(e);case ne.EXPRESSION_STMT:return this.generateExpressionStmt(e);case ne.RETURN_STATEMENT:return this.generateReturnStatement(e);case ne.ASSIGNMENT_EXPR:return this.generateAssignment(e);case ne.UPDATE_EXPR:return this.generateUpdateExpr(e);case ne.BINARY_EXPR:return this.generateBinaryExpr(e);case ne.LOGICAL_EXPR:return this.generateBinaryExpr(e);case ne.UNARY_EXPR:return this.generateUnaryExpr(e);case ne.CALL_EXPR:return this.generateCallExpr(e);case ne.MEMBER_EXPR:return this.generateMemberExpr(e);case ne.IDENTIFIER:return e.name;case ne.LITERAL:return this.generateLiteral(e);default:return console.warn(`[JavaTranspiler] Unknown node type: ${e.type}`),""}}indent(){return"  ".repeat(this.indentLevel)}generateStepCall(e){const i=this.scopeTracker.getVisibleVariables();if(i.length===0)return`${this.indent()}__step__(${e}, {});
`;const s=i.map(r=>`${r}: ${r}`).join(", ");return`${this.indent()}__step__(${e}, {${s}});
`}generateProgram(e){return e.body.map(i=>this.generate(i)).join(`
`)}generateFunctionDecl(e){this.scopeTracker.enterScope();for(const r of e.params||[])this.scopeTracker.declareVariable(r.name,r.type);const i=(e.params||[]).map(r=>r.name).join(", ");let s=`function ${e.name}(${i}) `;return s+=this.generate(e.body),this.scopeTracker.exitScope(),s}generateVarDecl(e){this.scopeTracker.declareVariable(e.name,e.varType);let i=`${this.indent()}var ${e.name}`;return e.init&&(i+=` = ${this.generate(e.init)}`),i+=`;
`,i+=this.generateStepCall(e.line),i}generateArrayLiteral(e){return`[${e.elements.map(s=>this.generate(s)).join(", ")}]`}generateForStatement(e){var s;let i=`${this.indent()}for (`;if(e.init&&(e.init.type===ne.VAR_DECL?(this.scopeTracker.declareVariable(e.init.name,e.init.varType),i+=`var ${e.init.name} = ${this.generate(e.init.init)}`):i+=this.generate(e.init)),i+="; ",i+=e.test?this.generate(e.test):"",i+="; ",i+=e.update?this.generate(e.update):"",i+=`) {
`,this.indentLevel++,i+=this.generateStepCall(e.line),(s=e.body)!=null&&s.body)for(const r of e.body.body)i+=this.generate(r);return this.indentLevel--,i+=`${this.indent()}}
`,i}generateWhileStatement(e){var s;let i=`${this.indent()}while (${this.generate(e.test)}) {
`;if(this.indentLevel++,i+=this.generateStepCall(e.line),(s=e.body)!=null&&s.body)for(const r of e.body.body)i+=this.generate(r);return this.indentLevel--,i+=`${this.indent()}}
`,i}generateIfStatement(e){var s;let i=`${this.indent()}if (${this.generate(e.test)}) {
`;if(this.indentLevel++,i+=this.generateStepCall(e.line),(s=e.consequent)!=null&&s.body)for(const r of e.consequent.body)i+=this.generate(r);if(this.indentLevel--,i+=`${this.indent()}}`,e.alternate)if(e.alternate.type===ne.IF_STATEMENT)i+=" else "+this.generate(e.alternate).trim();else{if(i+=` else {
`,this.indentLevel++,i+=this.generateStepCall(e.line),e.alternate.body)for(const r of e.alternate.body)i+=this.generate(r);this.indentLevel--,i+=`${this.indent()}}`}return i+=`
`,i}generateBlockStatement(e){let i=`{
`;this.indentLevel++;for(const s of e.body||[])i+=this.generate(s);return this.indentLevel--,i+=`${this.indent()}}
`,i}generateExpressionStmt(e){var o,l,c;let i=`${this.indent()}${this.generate(e.expression)};
`;const s=e.expression,r=(s==null?void 0:s.type)===ne.ASSIGNMENT_EXPR&&((o=s==null?void 0:s.left)==null?void 0:o.type)===ne.MEMBER_EXPR&&((c=(l=s==null?void 0:s.left)==null?void 0:l.object)==null?void 0:c.name)==="arr",n=(s==null?void 0:s.type)===ne.UPDATE_EXPR,a=(s==null?void 0:s.type)===ne.ASSIGNMENT_EXPR;return(r||n||a)&&(i+=this.generateStepCall(e.line)),i}generateReturnStatement(e){return e.argument?`${this.indent()}return ${this.generate(e.argument)};
`:`${this.indent()}return;
`}generateAssignment(e){const i=this.generate(e.left),s=this.generate(e.right);return`${i} ${e.operator} ${s}`}generateUpdateExpr(e){const i=this.generate(e.argument);return e.prefix?`${e.operator}${i}`:`${i}${e.operator}`}generateBinaryExpr(e){const i=this.generate(e.left),s=this.generate(e.right);return`(${i} ${e.operator} ${s})`}generateUnaryExpr(e){const i=this.generate(e.argument);return`${e.operator}${i}`}generateCallExpr(e){const i=this.generate(e.callee),s=e.arguments.map(r=>this.generate(r)).join(", ");return`${i}(${s})`}generateMemberExpr(e){const i=this.generate(e.object);if(e.computed){const r=this.generate(e.property);return`${i}[${r}]`}const s=this.generate(e.property);return`${i}.${s}`}generateLiteral(e){return typeof e.value=="string"?`"${e.value}"`:e.value===null?"null":typeof e.value=="boolean"?e.value?"true":"false":String(e.value)}}const S2=`
// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
// JAVA EXECUTION ENGINE - RUNTIME SETUP
// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

var __steps__ = [];
var __stats__ = { comparisons: 0, swaps: 0 };

/**
 * Capture execution state at a step
 * @param {number} line - Source line number
 * @param {object} variables - Current variable values
 */
function __step__(line, variables) {
  // Deep copy variables
  var varsCopy = {};
  for (var k in variables) {
    if (variables.hasOwnProperty(k)) {
      varsCopy[k] = variables[k];
    }
  }
  
  // Capture step
  __steps__.push({
    line: line,
    arrayState: arr.slice(),
    variables: varsCopy,
    stats: { comparisons: __stats__.comparisons, swaps: __stats__.swaps },
    comparing: [],
    swapping: [],
    i: varsCopy.i !== undefined ? varsCopy.i : -1,
    j: varsCopy.j !== undefined ? varsCopy.j : -1
  });
}

// Array will be defined by engine before execution
`;function x2(t,e){const s=new w2().transpile(t);return S2+`var arr = ${JSON.stringify(e)};

`+s}class lg{constructor(e,i){this.originalCode=e,this.originalLines=e.split(`
`),this.array=[...i],this.steps=[],this.stats={comparisons:0,swaps:0},this.error=null,this.isComplete=!1}async init(){try{console.log("[JavaEngine] Starting initialization..."),console.log("[JavaEngine] Phase 1: Tokenizing...");const e=N0(this.originalCode);console.log(`[JavaEngine] Tokenized: ${e.length} tokens`),console.log("[JavaEngine] Phase 2: Parsing...");const i=b2(e);console.log(`[JavaEngine] Parsed: ${i.body.length} top-level statements`),console.log("[JavaEngine] Phase 3-4: Transpiling...");const s=x2(i,this.array);return console.log(`[JavaEngine] Transpiled: ${s.length} characters`),console.log("[JavaEngine] Transpiled JS Preview:"),console.log("---BEGIN TRANSPILED CODE---"),console.log(s.substring(0,800)),console.log("---END TRANSPILED CODE PREVIEW---"),console.log("[JavaEngine] Phase 5: Executing..."),this.steps=this.execute(s),console.log(`[JavaEngine] Executed: ${this.steps.length} steps captured`),console.log("[JavaEngine] Post-processing steps..."),this.steps=this.analyzeSteps(this.steps),this.isComplete=!0,console.log("[JavaEngine] Initialization complete!"),!0}catch(e){return console.error("[JavaEngine] Error:",e),this.error=e,!1}}execute(e){try{const s=new Function(e+`
return __steps__;`)();return Array.isArray(s)?s:[]}catch(i){throw console.error("[JavaEngine] Execution error:",i),new Error(`Java execution failed: ${i.message}`)}}analyzeSteps(e){if(!e||e.length<2)return e;let i=null,s=!1;for(let r=1;r<e.length;r++){const n=e[r-1],a=e[r],o=a.variables||{},l=n.variables||{},c=a.arrayState,h=n.arrayState;if(a.comparing&&a.comparing.length>0||a.swapping&&a.swapping.length>0)continue;const d=o.temp!==void 0&&l.temp===void 0,u=o.temp!==void 0&&l.temp!==void 0&&o.temp!==l.temp;if(d||u)s=!0,i=c?[...c]:null,o.temp,a.swapState="start",a.swapTemp=o.temp;else if(s&&i&&c){const p=[];for(let f=0;f<i.length;f++)i[f]!==c[f]&&p.push(f);p.length===1?a.swapState="middle":p.length===2&&(a.swapping=p.sort((f,g)=>f-g),a.swapState="complete",a.type="swap",a.stats.swaps=(a.stats.swaps||0)+1,s=!1,i=null)}if(!a.swapState&&!s&&h&&c){const p=this.detectSwap(h,c);p&&(a.swapping=p,a.type="swap")}if(!a.comparing||a.comparing.length===0)if(o.j!==void 0&&o.i!==void 0)if(o.key===void 0&&o.min_idx===void 0){const p=o.j;p>=0&&p<c.length-1&&(a.comparing=[p,p+1])}else o.key!==void 0&&(a.comparing=[o.j,o.i]);else o.min_idx!==void 0&&o.j!==void 0&&(a.comparing=[o.j,o.min_idx]);a.comparing&&a.comparing.length===2&&!a._comparisonCounted&&(a.stats.comparisons=(a.stats.comparisons||0)+1,a._comparisonCounted=!0),o.target!==void 0&&(a.isSearch=!0,a.target=o.target,a.searchIndex=o.i,(!a.comparing||a.comparing.length===0)&&o.i!==void 0&&o.i>=0&&(a.comparing=[o.i]))}return e}detectSwap(e,i){if(!e||!i||e.length!==i.length)return null;const s=[];for(let r=0;r<e.length;r++)e[r]!==i[r]&&s.push(r);if(s.length===2){const[r,n]=s;if(e[r]===i[n]&&e[n]===i[r])return s}return null}async generateSteps(){return this.isComplete||await this.init(),this.steps}getStep(e){return e>=0&&e<this.steps.length?this.steps[e]:null}getTotalSteps(){return this.steps.length}getFinalArray(){return this.steps.length>0?this.steps[this.steps.length-1].arrayState:this.array}getStats(){return this.steps.length>0?this.steps[this.steps.length-1].stats:this.stats}getError(){return this.error}isReady(){return this.isComplete&&this.steps.length>0}}function k2(t,e){if(!t||!t.trim())return{valid:!1,errors:["No code provided"]};switch(e){case"js":case"javascript":return T2(t);case"python":return E2(t);case"java":return P2(t);default:return{valid:!0,errors:[]}}}function T2(t){var e;try{return Q0(t,{ecmaVersion:5,locations:!0}),{valid:!0,errors:[]}}catch(i){return{valid:!1,errors:[`Line ${((e=i.loc)==null?void 0:e.line)||1}: ${i.message}`]}}}function E2(t){var o;const e=[],i=t.split(`
`);let s=0,r=0,n=0;for(let l=0;l<t.length;l++){switch(t[l]){case"(":s++;break;case")":s--;break;case"[":r++;break;case"]":r--;break;case"{":n++;break;case"}":n--;break}if(s<0){e.push('Unexpected closing parenthesis ")"');break}if(r<0){e.push('Unexpected closing bracket "]"');break}}s>0&&e.push('Unclosed parenthesis "("'),r>0&&e.push('Unclosed bracket "["'),n!==0&&e.push("Unbalanced braces");for(let l=0;l<i.length;l++){const c=i[l].trim();/^for\s+\w+\s+in\s*[^:]*$/.test(c)&&!c.endsWith(":")&&(/range\s*\([^)]*$/.test(c)?e.push(`Line ${l+1}: Incomplete range() syntax`):c.endsWith(":")||e.push(`Line ${l+1}: For loop missing colon ":"`)),/range\s*\([^)]*$/.test(c)&&!((o=i[l+1])!=null&&o.trim().startsWith(")"))&&e.push(`Line ${l+1}: Incomplete range() function`),/^if\s+.*[^:]$/.test(c)&&!c.includes("#")&&e.push(`Line ${l+1}: If statement missing colon ":"`),/^while\s+.*[^:]$/.test(c)&&!c.includes("#")&&e.push(`Line ${l+1}: While loop missing colon ":"`),/^def\s+\w+\s*\([^)]*\)\s*[^:]$/.test(c)&&e.push(`Line ${l+1}: Function definition missing colon ":"`)}if(t.match(/def\s+\w+\s*\([^)]*\)\s*:\s*$/m)&&!t.includes("return")&&!t.includes("pass")){const l=t.split(/def\s+\w+\s*\([^)]*\)\s*:\s*\n/)[1];(!l||!l.trim())&&e.push("Empty function body")}return e.length===0?{valid:!0,errors:[]}:{valid:!1,errors:e}}function P2(t){const e=[];let i=0,s=0;for(let n=0;n<t.length;n++){switch(t[n]){case"{":i++;break;case"}":i--;break;case"(":s++;break;case")":s--;break}if(i<0){e.push('Unexpected closing brace "}"');break}if(s<0){e.push('Unexpected closing parenthesis ")"');break}}i>0&&e.push('Unclosed brace "{"'),s>0&&e.push('Unclosed parenthesis "("');const r=t.split(`
`);for(let n=0;n<r.length;n++){const a=r[n].trim();!a||a.startsWith("//")||a.startsWith("/*")||a.endsWith("{")||a.endsWith("}")||a.startsWith("if")||a.startsWith("for")||a.startsWith("while")||a.startsWith("else")||/^for\s*\([^)]*$/.test(a)&&e.push(`Line ${n+1}: Incomplete for loop`)}return e.length===0?{valid:!0,errors:[]}:{valid:!1,errors:e}}class C2{constructor(e){this.container=document.getElementById(e),this.frames=[],this.heap=[],this.objectIdCounter=1,this.previousValues={},this.colors={number:"#10b981",string:"#f59e0b",boolean:"#8b5cf6",array:"#3b82f6",object:"#ec4899",undefined:"#6b7280",null:"#6b7280",reference:"#06b6d4",changed:"#ef4444",active:"#22c55e"}}init(){if(!this.container){console.warn("[MemoryVisualizer] Container not found");return}this.container.innerHTML=this.renderEmptyState(),this.frames=[],this.heap=[],this.previousValues={}}update(e){if(!this.container)return;const{variables:i,callStack:s,array:r,line:n}=e;this.buildFrames(s,i,n),this.buildHeap(r),this.render()}buildFrames(e,i,s){if(this.frames=[{name:"<global>",line:null,isActive:(e==null?void 0:e.length)===0,variables:{}}],e&&e.length>0)for(let n=0;n<e.length;n++){const a=e[n];this.frames.push({name:a.name+"()",line:a.line,isActive:n===e.length-1,variables:{}})}const r=this.frames[this.frames.length-1];if(i)for(const[n,a]of Object.entries(i)){const o=this.getVariableType(a),l=this.previousValues[n]!==void 0&&this.previousValues[n]!==a;r.variables[n]={value:a,type:o,isChanged:l,isReference:o==="array"||o==="object"},this.previousValues[n]=a}r.variables.arr&&(r.variables.arr.heapId=1)}buildHeap(e){this.heap=[],e&&e.length>0&&this.heap.push({id:1,type:"array",value:[...e]})}getVariableType(e){return e===null?"null":e===void 0?"undefined":Array.isArray(e)?"array":typeof e}render(){if(!this.container)return;const e=`
      <div class="memory-viz">
        <div class="memory-viz-frames">
          <div class="memory-viz-section-title">ðŸ“¦ Frames (Stack)</div>
          ${this.renderFrames()}
        </div>
        <div class="memory-viz-heap">
          <div class="memory-viz-section-title">ðŸ—ƒï¸ Objects (Heap)</div>
          ${this.renderHeap()}
        </div>
        <svg class="memory-viz-arrows" id="memoryVizArrows">
          <!-- Arrows rendered after DOM update -->
        </svg>
      </div>
    `;this.container.innerHTML=e,requestAnimationFrame(()=>this.renderArrows())}renderFrames(){return[...this.frames].reverse().map((i,s)=>`
      <div class="memory-frame ${i.isActive?"frame-active":""}" data-frame-idx="${s}">
        <div class="frame-header">
          <span class="frame-name">${i.name}</span>
          ${i.line?`<span class="frame-line">line ${i.line}</span>`:""}
        </div>
        <div class="frame-variables">
          ${this.renderVariables(i.variables)}
        </div>
      </div>
    `).join("")}renderVariables(e){const i=Object.entries(e);return i.length===0?'<div class="frame-empty">no variables</div>':i.map(([s,r])=>{const{value:n,type:a,isChanged:o,isReference:l,heapId:c}=r;return`
        <div class="frame-var ${o?"var-changed":""}" data-var-name="${s}">
          <span class="var-name">${s}</span>
          <span class="var-equals">=</span>
          ${l?this.renderReference(s,c):this.renderValue(n,a)}
        </div>
      `}).join("")}renderValue(e,i){const s=this.colors[i]||this.colors.undefined;let r=e;return i==="string"?r=`"${e}"`:(i==="null"||i==="undefined")&&(r=i),`<span class="var-value" style="color: ${s}">${r}</span>`}renderReference(e,i){return`
      <span class="var-reference" data-var="${e}" data-heap-id="${i}">
        <span class="reference-dot">â—</span>
        <span class="reference-arrow">â†’</span>
      </span>
    `}renderHeap(){return this.heap.length===0?'<div class="heap-empty">no objects</div>':this.heap.map(e=>e.type==="array"?this.renderArrayObject(e):this.renderGenericObject(e)).join("")}renderArrayObject(e){const{id:i,value:s}=e,r=s.map((n,a)=>`
      <div class="array-cell">
        <div class="array-index">${a}</div>
        <div class="array-value">${n}</div>
      </div>
    `).join("");return`
      <div class="heap-object heap-array" data-heap-id="${i}">
        <div class="heap-object-type">Array (id=${i})</div>
        <div class="heap-array-cells">
          ${r}
        </div>
      </div>
    `}renderGenericObject(e){const{id:i,type:s,value:r}=e;return`
      <div class="heap-object" data-heap-id="${i}">
        <div class="heap-object-type">${s} (id=${i})</div>
        <div class="heap-object-value">${JSON.stringify(r)}</div>
      </div>
    `}renderArrows(){var r;const e=(r=this.container)==null?void 0:r.querySelector("#memoryVizArrows");if(!e)return;const i=[];this.container.querySelectorAll(".var-reference").forEach(n=>{const a=n.dataset.heapId,o=this.container.querySelector(`[data-heap-id="${a}"]`);if(o){const l=n.getBoundingClientRect(),c=o.getBoundingClientRect(),h=this.container.getBoundingClientRect(),d=l.right-h.left,u=l.top+l.height/2-h.top,p=c.left-h.left,f=c.top+20-h.top,g=(d+p)/2;i.push(`
          <path 
            d="M ${d} ${u} C ${g} ${u}, ${g} ${f}, ${p} ${f}"
            class="memory-arrow"
            marker-end="url(#arrowhead)"
          />
        `)}}),e.innerHTML=`
      <defs>
        <marker id="arrowhead" markerWidth="10" markerHeight="7" 
                refX="9" refY="3.5" orient="auto">
          <polygon points="0 0, 10 3.5, 0 7" fill="${this.colors.reference}" />
        </marker>
      </defs>
      ${i.join("")}
    `}renderEmptyState(){return`
      <div class="memory-viz memory-viz-empty">
        <div class="memory-viz-placeholder">
          <span class="placeholder-icon">ðŸ“Š</span>
          <span class="placeholder-text">Run code to see memory visualization</span>
        </div>
      </div>
    `}clear(){this.frames=[],this.heap=[],this.previousValues={},this.init()}}class _2{constructor(e){this.container=document.getElementById(e),this.callStack=[],this.previousStackLength=0,this.maxVisibleFrames=8}init(){if(!this.container){console.warn("[CallStackVisualizer] Container not found");return}this.callStack=[],this.previousStackLength=0,this.render()}update(e){if(!this.container)return;const i=(e==null?void 0:e.length)||0,s=this.previousStackLength;let r="none";if(i>s?r="push":i<s&&(r="pop"),this.callStack=[{name:"<global>",line:null,isGlobal:!0}],e&&e.length>0)for(const n of e)this.callStack.push({name:n.name||"anonymous",line:n.line,isGlobal:!1});this.previousStackLength=i,this.render(r)}render(e="none"){if(!this.container)return;const i=[...this.callStack].reverse(),s=i.slice(0,this.maxVisibleFrames),r=i.length-this.maxVisibleFrames,n=`
      <div class="callstack-viz">
        <div class="callstack-title">
          <span class="callstack-icon">ðŸ“š</span>
          <span>Call Stack</span>
          <span class="callstack-count">(${this.callStack.length})</span>
        </div>
        <div class="callstack-frames">
          ${r>0?`
            <div class="callstack-hidden">
              ... ${r} more frames
            </div>
          `:""}
          ${s.map((a,o)=>this.renderFrame(a,o,e)).join("")}
        </div>
      </div>
    `;this.container.innerHTML=n}renderFrame(e,i,s){const r=i===0,n=s==="push"&&r,a=s==="pop"&&r;return`
      <div class="${["callstack-frame",r?"frame-top":"",e.isGlobal?"frame-global":"frame-function",n?"frame-push-anim":"",a?"frame-pop-anim":""].filter(Boolean).join(" ")}">
        <div class="frame-indicator">
          ${r?"â–¶":"â—‹"}
        </div>
        <div class="frame-content">
          <span class="frame-name">${e.name}${e.isGlobal?"":"()"}</span>
          ${e.line?`<span class="frame-line">line ${e.line}</span>`:""}
        </div>
      </div>
    `}clear(){this.callStack=[],this.previousStackLength=0,this.init()}}class R2{constructor(e){this.container=document.getElementById(e),this.currentStep=0,this.totalSteps=0,this.history=[],this.stepTypes={COMPARE:{icon:"ðŸ”",label:"Comparing",color:"#3b82f6"},SWAP:{icon:"ðŸ”„",label:"Swapping",color:"#f59e0b"},ASSIGN:{icon:"ðŸ“",label:"Assigning",color:"#10b981"},LOOP_START:{icon:"ðŸ”",label:"Loop Start",color:"#8b5cf6"},LOOP_INCREMENT:{icon:"âž¡ï¸",label:"Loop Step",color:"#6366f1"},LOOP_END:{icon:"âœ…",label:"Loop End",color:"#22c55e"},IF_TRUE:{icon:"âœ“",label:"Condition True",color:"#22c55e"},IF_FALSE:{icon:"âœ—",label:"Condition False",color:"#ef4444"},FUNCTION_CALL:{icon:"ðŸ“ž",label:"Calling",color:"#ec4899"},FUNCTION_RETURN:{icon:"â†©ï¸",label:"Returning",color:"#14b8a6"},READ:{icon:"ðŸ‘ï¸",label:"Reading",color:"#06b6d4"},WRITE:{icon:"âœï¸",label:"Writing",color:"#f97316"},SEARCH_CHECK:{icon:"ðŸ”",label:"Checking",color:"#06b6d4"},SEARCH_FOUND:{icon:"âœ…",label:"Found!",color:"#10b981"},SEARCH_NOT_FOUND:{icon:"âŒ",label:"Not Found",color:"#ef4444"},UNKNOWN:{icon:"â€¢",label:"Step",color:"#6b7280"}}}init(){this.container&&(this.currentStep=0,this.totalSteps=0,this.history=[],this.render({type:"UNKNOWN",message:"Click Run or Step to begin execution"}))}update(e){if(!this.container)return;const i=this.generateExplanation(e);this.history.push(i),this.currentStep=e.stepCount||this.history.length,this.totalSteps=Math.max(this.totalSteps,this.currentStep),this.render(i)}generateExplanation(e){const{comparing:i,swapping:s,accessing:r,writing:n,variables:a,line:o,nodeType:l,isSearch:c,target:h}=e;return c||h!==void 0?this.explainSearch(e):s&&s.length===2?this.explainSwap(s,e):i&&i.length===2?this.explainCompare(i,e):n&&n.length>0?this.explainWrite(n,e):r&&r.length>0?this.explainRead(r,e):l==="ForStatement"||l==="WhileStatement"?this.explainLoopStep(e):l==="IfStatement"?this.explainCondition(e):l==="CallExpression"?this.explainFunctionCall(e):l==="ReturnStatement"?this.explainReturn(e):{type:"UNKNOWN",message:`Executing line ${o||"?"}`,detail:null,tip:null}}explainCompare(e,i){const[s,r]=e,n=i.array||[],a=n[s],o=n[r],l=a>o?"greater than":a<o?"less than":"equal to",c=a>o;return{type:"COMPARE",message:`Comparing arr[${s}] and arr[${r}]`,detail:`Checking if ${a} > ${o}. Result: ${a} is ${l} ${o}.`,tip:c?`Since ${a} > ${o}, we need to swap these elements.`:`Since ${a} â‰¤ ${o}, no swap needed - already in order.`,values:{i:s,j:r,valI:a,valJ:o}}}explainSwap(e,i){const[s,r]=e,n=i.array||[],a=n[r],o=n[s];return{type:"SWAP",message:`Swapping arr[${s}] and arr[${r}]`,detail:`Moving ${o} from position ${r} to ${s}, and ${a} from position ${s} to ${r}.`,tip:`This brings the smaller value (${Math.min(a,o)}) closer to the front.`,values:{i:s,j:r,valI:a,valJ:o}}}explainSearch(e){const{searchIndex:i,target:s,array:r,variables:n,result:a}=e,o=i??(n==null?void 0:n.i)??0,l=r==null?void 0:r[o],c=s??(n==null?void 0:n.target)??43,h=a??(n==null?void 0:n.result);if(h!==void 0&&h>=0)return{type:"SEARCH_FOUND",message:`Found target ${c} at index ${h}!`,detail:`arr[${h}] = ${l} equals target ${c}`,tip:"Search complete - target was found!"};if(h===-1)return{type:"SEARCH_NOT_FOUND",message:`Target ${c} not found in array`,detail:"Searched all elements without finding the target",tip:"The target value does not exist in this array"};const d=l===c;return{type:"SEARCH_CHECK",message:`Checking arr[${o}]`,detail:`Is ${l} equal to ${c}? ${d?"Yes!":"No, continue searching..."}`,tip:d?"Found it!":`Move to next element (index ${o+1})`}}explainRead(e,i){const s=i.array||[],r=e.map(n=>`arr[${n}] = ${s[n]}`);return{type:"READ",message:`Reading ${e.length===1?"element":"elements"}`,detail:r.join(", "),tip:null,values:{indices:e}}}explainWrite(e,i){const s=i.array||[],r=e.map(n=>`arr[${n}] = ${s[n]}`);return{type:"WRITE",message:`Writing to ${e.length===1?"element":"elements"}`,detail:r.join(", "),tip:"The array state has been modified.",values:{indices:e}}}explainLoopStep(e){const{variables:i}=e,s=i==null?void 0:i.i,r=i==null?void 0:i.j,n=i==null?void 0:i.n;let a="";return s!==void 0&&n!==void 0&&(a=`Outer loop: i = ${s} (iterating up to ${n-1})`,r!==void 0&&(a+=`
Inner loop: j = ${r}`)),{type:"LOOP_INCREMENT",message:"Loop iteration",detail:a||"Processing loop step",tip:"The loop counter has been updated.",values:{i:s,j:r,n}}}explainCondition(e){return{type:"IF_TRUE",message:"Evaluating condition",detail:"Checking if the condition is true or false.",tip:null}}explainFunctionCall(e){const{callStack:i}=e,s=i==null?void 0:i[i.length-1];return{type:"FUNCTION_CALL",message:`Calling ${(s==null?void 0:s.name)||"function"}()`,detail:"Entering function and creating new stack frame.",tip:"Watch the call stack grow!"}}explainReturn(e){return{type:"FUNCTION_RETURN",message:"Returning from function",detail:"Exiting function and returning to caller.",tip:"The stack frame will be removed."}}render(e){if(!this.container)return;const i=this.stepTypes[e.type]||this.stepTypes.UNKNOWN,s=`
      <div class="step-explainer">
        <div class="step-header">
          <div class="step-icon" style="background: ${i.color}20; color: ${i.color}">
            ${i.icon}
          </div>
          <div class="step-title">
            <span class="step-label" style="color: ${i.color}">${i.label}</span>
            <span class="step-counter">Step ${this.currentStep} of ${this.totalSteps||"?"}</span>
          </div>
        </div>
        
        <div class="step-message">${e.message}</div>
        
        ${e.detail?`
          <div class="step-detail">${e.detail}</div>
        `:""}
        
        ${e.tip?`
          <div class="step-tip">
            <span class="tip-icon">ðŸ’¡</span>
            <span class="tip-text">${e.tip}</span>
          </div>
        `:""}
        
        <div class="step-navigation">
          <button class="step-nav-btn" id="stepExplainerPrev" ${this.currentStep<=1?"disabled":""}>
            â† Previous
          </button>
          <button class="step-nav-btn" id="stepExplainerNext">
            Next â†’
          </button>
        </div>
      </div>
    `;this.container.innerHTML=s}clear(){this.init()}}class $2{constructor(e){this.container=document.getElementById(e),this.loops=[],this.conditions=[],this.maxConditions=3}init(){this.container&&(this.loops=[],this.conditions=[],this.render())}updateLoop(e){if(!e||!e.variable)return;const i=this.loops.findIndex(s=>s.variable===e.variable&&s.depth===e.depth);i>=0?this.loops[i]=e:(this.loops=this.loops.filter(s=>s.depth<=e.depth),this.loops.push(e)),this.loops.sort((s,r)=>s.depth-r.depth),this.render()}updateCondition(e){e&&(this.conditions.unshift(e),this.conditions.length>this.maxConditions&&this.conditions.pop(),this.render())}update(e){const{variables:i,nodeType:s,comparing:r}=e,n=e.array||[],a=i&&i.n!==void 0?i.n:n.length;if(i&&(i.i!==void 0&&a>0&&this.updateLoop({variable:"i",current:i.i,max:a-1,depth:0}),i.j!==void 0&&a>0&&i.i!==void 0)){const o=Math.max(0,a-i.i-2);this.updateLoop({variable:"j",current:i.j,max:o,depth:1})}if(r&&r.length===2){const[o,l]=r,c=n[o]>n[l];this.updateCondition({expression:`arr[${o}] > arr[${l}]`,values:`${n[o]} > ${n[l]}`,result:c})}this.render()}render(){if(!this.container)return;const e=`
      <div class="controlflow-viz" style="display: flex; flex-direction: column; gap: 1rem;">
        
        <!-- Loops Section -->
        <div class="cf-section cf-loops">
          <div class="cf-section-header" style="
            display: flex; align-items: center; gap: 0.5rem; margin-bottom: 0.75rem;
            color: var(--text-muted); font-size: 0.75rem; text-transform: uppercase; letter-spacing: 0.05em; font-weight: 600;
          ">
            <span style="font-size: 0.9rem;">ðŸ”„</span> Loop Scopes
          </div>
          <div style="display: flex; flex-direction: column; gap: 0.5rem;">
            ${this.renderLoops()}
          </div>
        </div>

        <!-- Conditions Section -->
        <div class="cf-section cf-conditions">
           <div class="cf-section-header" style="
            display: flex; align-items: center; gap: 0.5rem; margin-bottom: 0.75rem;
            color: var(--text-muted); font-size: 0.75rem; text-transform: uppercase; letter-spacing: 0.05em; font-weight: 600;
          ">
            <span style="font-size: 0.9rem;">âš¡</span> Logic Trace
          </div>
          <div style="display: flex; flex-direction: column; gap: 0.5rem;">
            ${this.renderConditions()}
          </div>
        </div>
      </div>
    `;this.container.innerHTML=e}renderLoops(){return this.loops.length===0?`
        <div class="cf-empty" style="
            padding: 1rem; border: 1px dashed var(--border-soft); border-radius: 8px;
            text-align: center; color: var(--text-muted); font-size: 0.8rem;
        ">
            No active loops
        </div>`:this.loops.map(e=>{const{variable:i,current:s,max:r,depth:n}=e,a=r>0?Math.min(100,(s+1)/(r+1)*100):0,o=n>0,l=o?.9:1,c=i==="i"?"#3b82f6":i==="j"?"#8b5cf6":"#ec4899";return`
        <div class="cf-loop-card" style="
            position: relative;
            background: rgba(255,255,255,0.03);
            border: 1px solid rgba(255,255,255,0.05);
            border-radius: 8px;
            padding: 0.75rem;
            margin-left: ${n*16}px;
            opacity: ${l};
        ">
           ${o?'<div style="position: absolute; left: -12px; top: 50%; width: 10px; height: 1px; background: rgba(255,255,255,0.1);"></div>':""}
           
           <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 0.5rem;">
              <div style="display: flex; align-items: center; gap: 0.5rem;">
                 <span style="
                    display: inline-flex; align-items: center; justify-content: center;
                    width: 20px; height: 20px; border-radius: 4px;
                    background: ${c}20; color: ${c};
                    font-family: monospace; font-size: 0.8rem; font-weight: 700;
                    border: 1px solid ${c}40;
                 ">${i}</span>
                 <span style="font-size: 0.8rem; color: var(--text-body); font-family: monospace;">
                    index ${s} <span style="color: var(--text-muted);">/ ${r}</span>
                 </span>
              </div>
              <span style="font-size: 0.7rem; color: var(--text-muted);">${Math.round(a)}%</span>
           </div>
           
           <!-- Progress Track -->
           <div style="
              height: 4px; width: 100%;
              background: rgba(0,0,0,0.3);
              border-radius: 2px;
              overflow: hidden;
           ">
              <div style="
                 height: 100%; width: ${a}%;
                 background: ${c};
                 transition: width 0.3s ease;
                 box-shadow: 0 0 8px ${c}60;
              "></div>
           </div>
        </div>
      `}).join("")}renderConditions(){return this.conditions.length===0?`
        <div class="cf-empty" style="
            padding: 1rem; border: 1px dashed var(--border-soft); border-radius: 8px;
            text-align: center; color: var(--text-muted); font-size: 0.8rem;
        ">
            No logical checks yet
        </div>`:this.conditions.map((e,i)=>{const r=i===0?"background: rgba(255,255,255,0.05);":"",n=e.result?"#10b981":"#f43f5e",a=e.result?"True":"False",o=e.result?"rgba(16, 185, 129, 0.1)":"rgba(244, 63, 94, 0.1)";return`
        <div class="cf-condition-card" style="
            ${r}
            border-left: 3px solid ${n};
            background: var(--bg-card-hover, rgba(30, 41, 59, 0.5));
            padding: 0.6rem 0.8rem;
            border-radius: 0 6px 6px 0;
            display: flex; align-items: center; justify-content: space-between;
            font-family: 'JetBrains Mono', monospace; font-size: 0.8rem;
            transition: all 0.3s ease;
        ">
          <div style="display: flex; flex-direction: column; gap: 2px;">
             <span style="color: var(--text-body);">${e.expression}</span>
             <span style="color: var(--text-muted); font-size: 0.7rem;">${e.values}</span>
          </div>
          
          <div style="
             padding: 2px 8px; border-radius: 4px;
             background: ${o}; color: ${n};
             font-size: 0.7rem; font-weight: 600; letter-spacing: 0.05em;
             border: 1px solid ${n}30;
          ">
             ${a}
          </div>
        </div>
      `}).join("")}clear(){this.loops=[],this.conditions=[],this.init()}}class I2{constructor(e){this.container=typeof e=="string"?document.getElementById(e):e,this.nodes=[],this.currentNodeId=null,this.originalArray=[],this.algorithm="merge",this.maxDepth=0}init(e,i="merge"){this.originalArray=[...e],this.algorithm=i,this.reset()}reset(){this.nodes=[],this.currentNodeId=null,this.maxDepth=0,this.render()}isValidRange(e,i){return e===void 0||i===void 0||typeof e!="number"||typeof i!="number"||isNaN(e)||isNaN(i)?!1:e>i?(console.warn(`[DCTree] Invalid range: lo=${e} > hi=${i}`),!1):e<0||i>=this.originalArray.length?(console.warn(`[DCTree] Out of bounds: [${e}..${i}] for array length ${this.originalArray.length}`),!1):!0}updateFromStep(e){if(!e)return;const i=e.variables||{},s=e.arrayState||this.originalArray;let r=e.lo??this.extractDCVariables(i).lo,n=e.hi??this.extractDCVariables(i).hi;if(e.mid??this.extractDCVariables(i).mid,!this.isValidRange(r,n)){this.render();return}const a=this.findNode(r,n);if(a)this.currentNodeId!==null&&this.currentNodeId!==a.id&&this.nodes[this.currentNodeId]&&(this.nodes[this.currentNodeId].isActive=!1),a.isActive=!0,this.currentNodeId=a.id,this.updateElementsWithValues(r,n,s);else{const o=this.findParentNode(r,n),l=this.addNode(o,r,n,s);l!==null&&(this.currentNodeId=l)}this.render()}extractDCVariables(e){let i=e.lo??e.left??e.l??e.low??void 0,s=e.hi??e.right??e.r??e.high??void 0,r=e.mid??e.m??e.middle??void 0,n=e.pivot??e.pi??e.p??void 0;return{lo:i,hi:s,mid:r,pivot:n}}detectPhase(e,i){if(e.dcPhase){if(e.dcPhase==="divide")return"divide";if(e.dcPhase==="conquer")return"merge"}const s=(e.description||"").toLowerCase();return s.includes("merge")||s.includes("combine")||s.includes("conquer")?"merge":s.includes("partition")||s.includes("pivot")?"partition":s.includes("base case")||s.includes("single")?"base":s.includes("complete")||s.includes("sorted")?"complete":i!==void 0?"divide":"active"}findNode(e,i){return this.nodes.find(s=>s.lo===e&&s.hi===i)}findParentNode(e,i){let s=null,r=1/0;for(const n of this.nodes)if(e>=n.lo&&i<=n.hi&&!(e===n.lo&&i===n.hi)){const a=n.hi-n.lo;a<r&&(r=a,s=n)}return(s==null?void 0:s.id)??null}addNode(e,i,s,r){var p;if(!this.isValidRange(i,s))return console.warn(`[DCTree] Skipping invalid node: [${i}..${s}]`),null;const n=this.findNode(i,s);if(n)return console.log(`[DCTree] Node [${i}..${s}] already exists`),n.isActive=!0,n.id;const a=this.nodes.length,o=e!==null?(((p=this.nodes[e])==null?void 0:p.level)??0)+1:0,l=r||this.originalArray,c=[];for(let f=i;f<=s;f++){const g=l[f]!==void 0?l[f]:this.originalArray[f]!==void 0?this.originalArray[f]:"?";c.push({value:g,originalIndex:f,state:"normal"})}const h=s-i+1;c.length!==h&&console.warn(`[DCTree] Element count mismatch: got ${c.length}, expected ${h} for [${i}..${s}]`);const d=i===s,u={id:a,parentId:e,lo:i,hi:s,level:o,children:[],phase:d?"complete":"dividing",isComplete:d,pivotIndex:null,pivotValue:null,pivotPlaced:!1,pivotFinalPos:null,elements:c,isActive:!0,entryTime:performance.now(),completionTime:d?performance.now():null};return d&&u.elements[0]&&(u.elements[0].state="sorted"),this.currentNodeId!==null&&this.nodes[this.currentNodeId]&&(this.nodes[this.currentNodeId].isActive=!1),this.nodes.push(u),e!==null&&this.nodes[e]&&this.nodes[e].children.push(a),o>this.maxDepth&&(this.maxDepth=o),console.log(`[DCTree] Added node [${i}..${s}] phase=${u.phase} level=${o} elements=${c.length}`),d&&this.checkParentCompletion(u),a}setPivot(e,i,s,r){const n=this.findNode(e,i);if(!n){console.warn(`[DCTree] setPivot: Node [${e}..${i}] not found`);return}n.pivotIndex=s,n.pivotValue=r,n.phase="partitioning";const a=s-e;n.elements[a]&&(n.elements[a].state="pivot"),console.log(`[DCTree] Pivot set for [${e}..${i}]: value=${r} at index=${s}`),this.render()}markElement(e,i,s,r){const n=this.findNode(e,i);if(!n)return;const a=s-e;n.elements[a]&&n.elements[a].state!=="pivot"&&(n.elements[a].state=r),this.render()}colorPartitions(e,i,s){const r=this.findNode(e,i);r&&(r.elements.forEach((n,a)=>{n.state!=="pivot"&&(n.value<s?n.state="less":n.value>s&&(n.state="greater"))}),console.log(`[DCTree] Colored partitions for [${e}..${i}] around pivot=${s}`),this.render())}placePivot(e,i,s,r){const n=this.findNode(e,i);if(!n)return;n.pivotPlaced=!0,n.pivotFinalPos=s;const a=new Map;if(n.elements.forEach(d=>{d.state!=="normal"&&a.set(d.value,d.state)}),r)for(let d=e;d<=i;d++){const u=d-e;if(n.elements[u]){const p=r[d];n.elements[u].value=p,n.elements[u].originalIndex=d,d===s?n.elements[u].state="pivot":n.elements[u].state="normal"}}console.log(`[DCTree] Pivot placed at position ${s} for [${e}..${i}]`);const o=e,l=s-1,c=s+1,h=i;o<=l&&this.addNode(n.id,o,l,r)!==null&&console.log(`[DCTree] Created LEFT child [${o}..${l}]`),c<=h&&this.addNode(n.id,c,h,r)!==null&&console.log(`[DCTree] Created RIGHT child [${c}..${h}]`),this.render()}updateElementsWithValues(e,i,s){const r=this.findNode(e,i);if(!r||!s)return;const n=new Map;r.elements.forEach(a=>{n.set(a.value,a.state)});for(let a=e;a<=i;a++){const o=a-e;if(r.elements[o]){const l=s[a],c=n.get(l)||"normal";r.elements[o].value=l,r.elements[o].state=c}}this.render()}markComplete(e,i){const s=this.findNode(e,i);!s||s.isComplete||(s.phase="complete",s.isComplete=!0,s.completionTime=performance.now(),s.elements.forEach(r=>{r.state="sorted"}),console.log(`[DCTree] Node [${e}..${i}] marked COMPLETE`),this.checkParentCompletion(s),this.render())}checkParentCompletion(e){if(e.parentId===null)return;const i=this.nodes[e.parentId];if(!i||i.isComplete)return;i.children.every(r=>{const n=this.nodes[r];return n==null?void 0:n.isComplete})&&i.pivotPlaced&&(console.log(`[DCTree] All children complete for [${i.lo}..${i.hi}], marking parent complete`),this.markComplete(i.lo,i.hi))}render(){if(!this.container)return;if(this.container.innerHTML="",this.nodes.length===0){this.container.innerHTML=this.renderEmptyState();return}const e=document.createElement("div");e.className="dc-tree-wrapper",e.innerHTML=this.renderLegend();const i=this.nodes.find(s=>s.parentId===null);i?this.renderTreeRecursive(e,i,0):this.renderTreeRecursive(e,this.nodes[0],0),this.container.appendChild(e)}renderTreeRecursive(e,i,s,r=null){if(!i)return;const n=document.createElement("div");if(n.className="dc-subtree",r){const l=document.createElement("div");l.className="dc-arrow-container";const c=this.createArrow(i,r);l.appendChild(c),n.appendChild(l)}const a=this.createNodeElement(i);n.appendChild(a);const o=i.children.map(l=>this.nodes[l]).filter(Boolean);if(o.length>0){const l=document.createElement("div");l.className="dc-children-row",o[0]&&this.renderTreeRecursive(l,o[0],s+1,"left"),o[1]&&this.renderTreeRecursive(l,o[1],s+1,"right"),n.appendChild(l)}e.appendChild(n)}createArrow(e,i){const s=e.isComplete,r=e.phase==="merging",n=e.phase==="conquer"||e.phase==="merging";let a="phase-dividing";s?a="phase-complete":(r||n)&&(a="phase-merging");const o=document.createElementNS("http://www.w3.org/2000/svg","svg");o.setAttribute("class",`dc-arrow ${a}`),o.setAttribute("viewBox","0 0 24 24");const l=document.createElementNS("http://www.w3.org/2000/svg","path");return i==="left"?l.setAttribute("d","M 20 0 L 12 20"):l.setAttribute("d","M 4 0 L 12 20"),o.appendChild(l),o}renderEmptyState(){return`
      <div style="
        display: flex;
        flex-direction: column;
        align-items: center;
        justify-content: center;
        height: 100%;
        color: var(--text-muted);
        opacity: 0.7;
        gap: 1rem;
        padding-top: 3rem;
      ">
        <span style="font-size: 2rem;">ðŸŒ±</span>
        <span>Tree will grow here...</span>
      </div>
    `}renderLegend(){return`
      <div style="display: flex; gap: 1rem; margin-bottom: 1rem; opacity: 0.8; flex-wrap: wrap; justify-content: center;">
        <span style="display: flex; align-items: center; gap: 0.3rem; font-size: 0.7rem; color: var(--text-muted);">
          <span style="width: 8px; height: 8px; background: var(--accent-amber); border-radius: 50%;"></span> Divide
        </span>
        <span style="display: flex; align-items: center; gap: 0.3rem; font-size: 0.7rem; color: var(--text-muted);">
          <span style="width: 8px; height: 8px; background: var(--accent-sky); border-radius: 50%;"></span> Merge
        </span>
        <span style="display: flex; align-items: center; gap: 0.3rem; font-size: 0.7rem; color: var(--text-muted);">
          <span style="width: 8px; height: 8px; background: var(--accent-forest); border-radius: 50%;"></span> Sorted
        </span>
        <span style="display: flex; align-items: center; gap: 0.3rem; font-size: 0.7rem; color: var(--text-muted);">
          <span style="width: 8px; height: 8px; background: #8b5cf6; border-radius: 50%;"></span> Pivot
        </span>
      </div>
    `}createNodeElement(e){const i=e.isActive||e.id===this.currentNodeId,s=document.createElement("div");s.className="dc-node-wrapper";const r=document.createElement("div");let n=e.phase==="conquer"?"merging":e.phase;r.className=`dc-node phase-${n} ${i?"active":""}`;const a=document.createElement("div");a.className="dc-node-label",a.textContent=`[${e.lo}..${e.hi}]`,s.appendChild(a);const o=document.createElement("div");return o.className="dc-node-inner",e.elements.forEach((l,c)=>{const h=document.createElement("div");h.className=`dc-element state-${l.state}`,h.textContent=l.value,o.appendChild(h)}),r.appendChild(o),s.appendChild(r),s}start(){this.originalArray.length>0&&this.nodes.length===0&&(this.addNode(null,0,this.originalArray.length-1,this.originalArray),this.currentNodeId=0,this.render())}resetWithArray(e){this.init(e,this.algorithm),this.start()}addStepToTree(e){this.updateFromStep(e)}stepForward(){return!1}}function Q2(t){if(!t||t.length<=1)return!0;for(let e=0;e<t.length-1;e++)if(t[e]>t[e+1])return!1;return!0}function go(t,e){const i=Q2(t);if(i){const s=[...e].sort((a,o)=>a-o),r=[...t].sort((a,o)=>a-o);s.length===r.length&&s.every((a,o)=>a===r[o])?T("âœ… Sorting complete!","success"):T("âš ï¸ Array modified incorrectly!","warning")}else T("âŒ Sorting failed - array not sorted!","error");return i}function cg(t,e){t>=0?T(`âœ… Found ${e} at index ${t}`,"success"):T(`âŒ ${e} not found in array`,"info")}function hg(t,e){if(!t||!e||t.length!==e.length)return null;const i=[];for(let n=0;n<t.length;n++)t[n]!==e[n]&&i.push(n);if(i.length!==2)return null;const[s,r]=i;return t[s]===e[r]&&t[r]===e[s]?[s,r]:null}function A2(t,e,i){switch(e){case"<":return t<i;case">":return t>i;case"<=":return t<=i;case">=":return t>=i;case"==":case"===":return t===i;case"!=":case"!==":return t!==i;default:return t>i}}function dg(t){if(!t||t.length<2)return t;console.log("[analyzeSteps] Analyzing",t.length,"steps");let e=!1,i=null,s=null;for(let r=1;r<t.length;r++){const n=t[r-1],a=t[r],o=a.variables||{},l=n.variables||{};if(a.branch&&a.branch.includes("while")&&console.log(`[analyzeSteps] Step ${r} (${a.branch}): variables =`,JSON.stringify(o)),a.comparing&&a.comparing.length>0||a.swapping&&a.swapping.length>0)continue;const c=a.arrayState||a.arr,h=n.arrayState||n.arr,d=o.temp!==void 0&&l.temp===void 0,u=o.temp!==void 0&&l.temp!==void 0&&o.temp!==l.temp;if(d||u)e=!0,i=c?[...c]:null,s=o.temp,a.swapState="start",a.swapTemp=o.temp,console.log(`[analyzeSteps] Step ${r}: SWAP START, temp=${o.temp}`);else if(e&&i&&c){let g=[];for(let m=0;m<i.length;m++)i[m]!==c[m]&&g.push(m);if(g.length===1)a.swapState="middle",a.swapTemp=o.temp??l.temp??s,console.log(`[analyzeSteps] Step ${r}: SWAP MIDDLE, changed pos ${g[0]}`);else if(g.length===2){const m=hg(i,c);m&&(a.swapping=m,a.swapState="complete",a.type="swap",console.log(`[analyzeSteps] Step ${r}: SWAP COMPLETE [${m[0]}]â†”[${m[1]}]`),a.stats&&!a._swapCounted&&(a.stats.swaps=(a.stats.swaps||0)+1,a._swapCounted=!0)),e=!1,i=null,s=null}}if(!a.swapState&&!e&&h&&c){const g=hg(h,c);g&&(a.swapping=g,a.type="swap",console.log(`[analyzeSteps] Step ${r}: DIRECT SWAP [${g[0]}]â†”[${g[1]}]`),a.stats&&!a._swapCounted&&(a.stats.swaps=(a.stats.swaps||0)+1,a._swapCounted=!0))}if(o.key!==void 0&&!a.swapping&&h&&c){let g=[];for(let m=0;m<c.length;m++)c[m]!==h[m]&&g.push(m);g.length===1&&(a.shiftPosition=g[0],a.type="shift",a.shifting=[g[0]],console.log(`[analyzeSteps] Step ${r}: SHIFT at position [${g[0]}]`))}if(a.branch&&(a.branch==="if_true"||a.branch==="if_false"||a.branch==="while_true"||a.branch==="while_false")){let g=null;o.key!==void 0&&o.j!==void 0&&o.i!==void 0?(g=[o.j,o.i],console.log(`[analyzeSteps] Step ${r}: INSERTION SORT compare [${o.j}]vs[${o.i}] (key)`)):o.min_idx!==void 0&&o.j!==void 0?(g=[o.j,o.min_idx],console.log(`[analyzeSteps] Step ${r}: SELECTION SORT compare [${o.j}]vs[${o.min_idx}]`)):o.pivot!==void 0&&o.j!==void 0&&o.hi!==void 0?(g=[o.j,o.hi],console.log(`[analyzeSteps] Step ${r}: QUICK SORT compare [${o.j}]vs[${o.hi}] (pivot)`)):o.j!==void 0&&(g=[o.j,o.j+1],console.log(`[analyzeSteps] Step ${r}: BUBBLE SORT compare [${o.j}]vs[${o.j+1}]`)),g&&(a.comparing=g,a.result=a.branch==="if_true"||a.branch==="while_true",a.type=a.type||"compare",a.stats&&!a._compareCounted&&(a.stats.comparisons=(a.stats.comparisons||0)+1,a._compareCounted=!0))}if((o.low!==void 0||o.lo!==void 0||o.l!==void 0)&&(o.high!==void 0||o.hi!==void 0||o.r!==void 0)){a.isSearch=!0;const g=o.low??o.lo??o.l??-1,m=o.high??o.hi??o.r??-1,y=o.mid??o.m??-1;a.pointers={low:g,high:m,mid:y},a.searchRange={low:g,high:m},o.target!==void 0&&(a.target=o.target,y>=0&&c[y]!==void 0&&(a.comparing=[y],a.searchIndex=y))}else o.target!==void 0&&(a.isSearch=!0,a.target=o.target,a.searchIndex=o.i,(!a.comparing||a.comparing.length===0)&&o.i!==void 0&&o.i>=0&&(a.comparing=[o.i]),o.i!==void 0&&o.i>=0&&c&&c[o.i]===o.target&&(a.found=!0),o.result!==void 0&&o.result>=0&&o.result===o.i&&(a.found=!0))}return console.log("[analyzeSteps] Analysis complete"),t}var eu={editor:null,canvasViz:null,executionEngine:null,pythonEngine:null,useRealExecution:!0,currentLang:"python",currentAlgo:"bubble",originalArray:[38,27,43,3,9,82,10],currentArray:[],steps:[],stepIndex:0,isPlaying:!1,playInterval:null,stats:{comparisons:0,swaps:0},sorted:new Set,skulptLoading:!1,memoryViz:null,callStackViz:null,stepExplainer:null,controlFlowViz:null,dcTreeViz:null,dcCallStack:[],dcRangeToNode:new Map,visualizerMode:"bars",searchCheckedIndices:new Set,codeTemplates:{bubble:{js:`function bubbleSort(arr) {
  for (var i = 0; i < arr.length - 1; i++) {
    for (var j = 0; j < arr.length - i - 1; j++) {
      if (arr[j] > arr[j + 1]) {
        // Swap adjacent elements
        var temp = arr[j];
        arr[j] = arr[j + 1];
        arr[j + 1] = temp;
      }
    }
  }
  return arr;
}
bubbleSort(arr);`,python:`# Array to sort (edit this or use the input box above)
arr = [38, 27, 43, 3, 9, 82, 10]

def bubble_sort(arr):
    n = len(arr)
    for i in range(n - 1):
        for j in range(n - i - 1):
            # Compare adjacent elements
            if arr[j] > arr[j + 1]:
                # Swap if out of order
                temp = arr[j]
                arr[j] = arr[j + 1]
                arr[j + 1] = temp
    return arr

# Run the sorting algorithm
bubble_sort(arr)`,java:`// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
// BUBBLE SORT - Like bubbles rising, larger elements float up!
// Time: O(nÂ²) | Space: O(1) | Stable: Yes
// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

void bubbleSort(int[] arr) {
    int n = arr.length;
    
    // Outer loop: n-1 passes
    for (int i = 0; i < n - 1; i++) {
        // Inner loop: compare adjacent pairs
        for (int j = 0; j < n - i - 1; j++) {
            // Compare: is left element bigger?
            if (arr[j] > arr[j + 1]) {
                // Swap using temp variable
                int temp = arr[j];
                arr[j] = arr[j + 1];
                arr[j + 1] = temp;
            }
        }
    }
}

// Run the algorithm!
bubbleSort(arr);`},insertion:{js:`function insertionSort(arr) {
  for (var i = 1; i < arr.length; i++) {
    var key = arr[i];
    var j = i - 1;
    // Shift elements greater than key
    while (j >= 0 && arr[j] > key) {
      arr[j + 1] = arr[j];
      j--;
    }
    arr[j + 1] = key;
  }
  return arr;
}
insertionSort(arr);`,python:`# Array to sort (edit this or use the input box above)
arr = [38, 27, 43, 3, 9, 82, 10]

def insertion_sort(arr):
    for i in range(1, len(arr)):
        key = arr[i]
        j = i - 1
        # Shift elements greater than key to the right
        while j >= 0 and arr[j] > key:
            arr[j + 1] = arr[j]
            j -= 1
        # Insert key at correct position
        arr[j + 1] = key
    return arr

# Run the sorting algorithm
insertion_sort(arr)`,java:`// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
// INSERTION SORT - Like sorting playing cards in your hand!
// Time: O(nÂ²) | Space: O(1) | Stable: Yes
// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

void insertionSort(int[] arr) {
    for (int i = 1; i < arr.length; i++) {
        // Pick the element to insert
        int key = arr[i];
        int j = i - 1;
        
        // Shift elements greater than key
        while (j >= 0 && arr[j] > key) {
            arr[j + 1] = arr[j];
            j--;
        }
        
        // Insert key at correct position
        arr[j + 1] = key;
    }
}

// Run the algorithm!
insertionSort(arr);`},selection:{js:`function selectionSort(arr) {
  for (var i = 0; i < arr.length - 1; i++) {
    var minIdx = i;
    // Find minimum in unsorted portion
    for (var j = i + 1; j < arr.length; j++) {
      if (arr[j] < arr[minIdx]) {
        minIdx = j;
      }
    }
    // Swap minimum to correct position
    if (minIdx !== i) {
      var temp = arr[i];
      arr[i] = arr[minIdx];
      arr[minIdx] = temp;
    }
  }
  return arr;
}
selectionSort(arr);`,python:`# Array to sort (edit this or use the input box above)
arr = [38, 27, 43, 3, 9, 82, 10]

def selection_sort(arr):
    n = len(arr)
    for i in range(n - 1):
        # Find the minimum element in unsorted portion
        min_idx = i
        for j in range(i + 1, n):
            if arr[j] < arr[min_idx]:
                min_idx = j
        # Swap minimum with first unsorted element
        if min_idx != i:
            temp = arr[i]
            arr[i] = arr[min_idx]
            arr[min_idx] = temp
    return arr

# Run the sorting algorithm
selection_sort(arr)`,java:`// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
// SELECTION SORT - Find minimum and put it in its place!
// Time: O(nÂ²) | Space: O(1) | Unstable
// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

void selectionSort(int[] arr) {
    int n = arr.length;
    
    for (int i = 0; i < n - 1; i++) {
        // Find minimum in unsorted portion
        int min_idx = i;
        for (int j = i + 1; j < n; j++) {
            if (arr[j] < arr[min_idx]) {
                min_idx = j;
            }
        }
        
        // Swap minimum with first unsorted
        int temp = arr[i];
        arr[i] = arr[min_idx];
        arr[min_idx] = temp;
    }
}

// Run the algorithm!
selectionSort(arr);`},quick:{js:`function quickSort(arr, lo, hi) {
  if (lo === undefined) lo = 0;
  if (hi === undefined) hi = arr.length - 1;
  if (lo < hi) {
    // Partition using last element as pivot
    var pivot = arr[hi];
    var i = lo - 1;
    
    for (var j = lo; j < hi; j++) {
      if (arr[j] <= pivot) {
        i++;
        // Swap arr[i] and arr[j]
        var temp = arr[i];
        arr[i] = arr[j];
        arr[j] = temp;
      }
    }
    // Place pivot at correct position
    var temp2 = arr[i + 1];
    arr[i + 1] = arr[hi];
    arr[hi] = temp2;
    
    var p = i + 1;
    quickSort(arr, lo, p - 1);
    quickSort(arr, p + 1, hi);
  }
  return arr;
}
quickSort(arr);`,python:`# Array to sort (edit this or use the input box above)
arr = [38, 27, 43, 3, 9, 82, 10]

def quick_sort(arr, lo_param=0, hi_param=None):
    # Assign lo/hi as local variables (required for D&C tree visualization)
    lo = lo_param
    hi = hi_param if hi_param is not None else len(arr) - 1
    
    if lo < hi:
        # Partition: use last element as pivot
        pivot = arr[hi]
        i = lo - 1
        
        for j in range(lo, hi):
            if arr[j] <= pivot:
                i += 1
                # Swap arr[i] and arr[j]
                temp = arr[i]
                arr[i] = arr[j]
                arr[j] = temp
        
        # Place pivot in correct position
        temp = arr[i + 1]
        arr[i + 1] = arr[hi]
        arr[hi] = temp
        
        p = i + 1  # Partition index (this is 'mid' for D&C)
        mid = p    # Alias for tree visualization
        
        # Recursively sort left and right partitions
        quick_sort(arr, lo, p - 1)
        quick_sort(arr, p + 1, hi)
    
    return arr

# Run the sorting algorithm
quick_sort(arr)`,java:`// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
// QUICK SORT - Divide and conquer with a pivot!
// Time: O(n log n) avg | Space: O(log n) | Unstable
// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

void quickSort(int[] arr, int lo, int hi) {
    if (lo < hi) {
        // Choose pivot (last element)
        int pivot = arr[hi];
        int i = lo - 1;
        
        // Partition: move smaller elements left
        for (int j = lo; j < hi; j++) {
            if (arr[j] <= pivot) {
                i++;
                // Swap arr[i] and arr[j]
                int temp = arr[i];
                arr[i] = arr[j];
                arr[j] = temp;
            }
        }
        
        // Place pivot in correct position
        int temp = arr[i + 1];
        arr[i + 1] = arr[hi];
        arr[hi] = temp;
        
        int p = i + 1;
        
        // Recursively sort partitions
        quickSort(arr, lo, p - 1);
        quickSort(arr, p + 1, hi);
    }
}

// Run the algorithm!
quickSort(arr, 0, arr.length - 1);`},merge:{js:`// Merge Sort
function mergeSort(arr, lo = 0, hi = arr.length - 1) {
  // Base case
  if (lo >= hi) {
    return;
  }

  // Divide
  const mid = Math.floor((lo + hi) / 2);

  // Recursively sort
  mergeSort(arr, lo, mid);
  mergeSort(arr, mid + 1, hi);

  // Merge
  merge(arr, lo, mid, hi);
}

function merge(arr, lo, mid, hi) {
  // Create temp arrays
  const left = arr.slice(lo, mid + 1);
  const right = arr.slice(mid + 1, hi + 1);

  let i = 0, j = 0, k = lo;

  // Merge back to main array
  while (i < left.length && j < right.length) {
    if (left[i] <= right[j]) {
      arr[k++] = left[i++];
    } else {
      arr[k++] = right[j++];
    }
  }

  // Copy remaining elements
  while (i < left.length) arr[k++] = left[i++];
  while (j < right.length) arr[k++] = right[j++];
}
mergeSort(arr);`,python:`# Merge Sort
arr = [38, 27, 43, 3, 9, 82, 10]

def merge_sort(arr, lo, hi):
    # Base case
    if lo >= hi:
        return

    # Divide
    mid = (lo + hi) // 2

    # Recursively sort
    merge_sort(arr, lo, mid)
    merge_sort(arr, mid + 1, hi)

    # Merge logic
    left = arr[lo:mid+1]
    right = arr[mid+1:hi+1]

    i = 0
    j = 0
    k = lo

    while i < len(left) and j < len(right):
        if left[i] <= right[j]:
            arr[k] = left[i]
            i += 1
        else:
            arr[k] = right[j]
            j += 1
        k += 1

    while i < len(left):
        arr[k] = left[i]
        i += 1
        k += 1

    while j < len(right):
        arr[k] = right[j]
        j += 1
        k += 1

merge_sort(arr, 0, len(arr) - 1)`,java:`// Merge Sort
int[] arr = {38, 27, 43, 3, 9, 82, 10};

void mergeSort(int[] arr, int lo, int hi) {
    // Base case
    if (lo >= hi) {
        return;
    }

    // Divide
    int mid = (lo + hi) / 2;

    // Recursively sort
    mergeSort(arr, lo, mid);
    mergeSort(arr, mid + 1, hi);

    // Merge
    merge(arr, lo, mid, hi);
}

void merge(int[] arr, int lo, int mid, int hi) {
    // Temp arrays
    int[] left = Arrays.copyOfRange(arr, lo, mid + 1);
    int[] right = Arrays.copyOfRange(arr, mid + 1, hi + 1);

    int i = 0, j = 0, k = lo;

    // Merge logic
    while (i < left.length && j < right.length) {
        if (left[i] <= right[j]) {
            arr[k++] = left[i++];
        } else {
            arr[k++] = right[j++];
        }
    }

    // Copy remaining
    while (i < left.length) arr[k++] = left[i++];
    while (j < right.length) arr[k++] = right[j++];
}
mergeSort(arr, 0, arr.length - 1);`},linear:{python:`# Linear Search - Check each element until target is found
arr = [38, 27, 43, 3, 9, 82, 10]
target = 43
result = -1

for i in range(len(arr)):
    # Compare current element with target
    if arr[i] == target:
        result = i
        break  # Found! Exit loop

# result contains index if found, -1 if not found`,js:`// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
// LINEAR SEARCH - Check each element until found
// Time: O(n) | Space: O(1)
// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

var arr = [38, 27, 43, 3, 9, 82, 10];
var target = 43;
var result = -1;

for (var i = 0; i < arr.length; i++) {
  // Compare current element with target
  if (arr[i] === target) {
    result = i;  // Found! Store index
    break;       // Exit loop
  }
}
// result contains index if found, -1 if not found`,java:`// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
// LINEAR SEARCH - Check each element until found
// Time: O(n) | Space: O(1)
// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

int[] arr = {38, 27, 43, 3, 9, 82, 10};
int target = 43;
int result = -1;

for (int i = 0; i < arr.length; i++) {
    // Compare current element with target
    if (arr[i] == target) {
        result = i;  // Found! Store index
        break;       // Exit loop
    }
}
// result contains index if found, -1 if not found`},binary:{python:`# Binary Search - Divide and Conquer!
# NOTE: Array must be sorted for Binary Search to work
arr = [10, 20, 30, 40, 50, 60, 70, 80, 90]
target = 70
result = -1

low = 0
high = len(arr) - 1

while low <= high:
    mid = (low + high) // 2
    
    # Check if target is present at mid
    if arr[mid] == target:
        result = mid
        break
        
    # If target is greater, ignore left half
    elif arr[mid] < target:
        low = mid + 1
        
    # If target is smaller, ignore right half
    else:
        high = mid - 1

# result contains index if found, -1 if not found`,js:`// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
// BINARY SEARCH - Divide and Conquer!
// Time: O(log n) | Space: O(1) | Note: Array must be sorted
// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

var arr = [10, 20, 30, 40, 50, 60, 70, 80, 90];
var target = 70;
var result = -1;

var low = 0;
var high = arr.length - 1;

while (low <= high) {
  var mid = Math.floor((low + high) / 2);
  
  if (arr[mid] === target) {
    result = mid; // Found
    break;
  }
  
  if (arr[mid] < target) {
    low = mid + 1; // Search right half
  } else {
    high = mid - 1; // Search left half
  }
}
// result contains index if found, -1 if not found`,java:`// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
// BINARY SEARCH - Divide and Conquer!
// Time: O(log n) | Space: O(1) | Note: Array must be sorted
// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

int[] arr = {10, 20, 30, 40, 50, 60, 70, 80, 90};
int target = 70;
int result = -1;

int low = 0;
int high = arr.length - 1;

while (low <= high) {
    int mid = low + (high - low) / 2;
    
    if (arr[mid] == target) {
        result = mid;
        break;
    }
    
    if (arr[mid] < target) {
        low = mid + 1;
    } else {
        high = mid - 1;
    }
}
// result contains index if found, -1 if not found`}},algoInfo:{bubble:{title:"ðŸ«§ Bubble Sort",desc:'Like bubbles rising in water, larger elements "bubble up" to the end of the array.',best:"O(n)",avg:"O(nÂ²)",worst:"O(nÂ²)",guidance:[{step:"Understanding the Algorithm",hint:"Bubble Sort compares adjacent elements and swaps them if they are in wrong order."},{step:"Outer Loop",hint:"The outer loop runs n-1 times, where n is the array length."},{step:"Inner Loop & Comparison",hint:"Compare arr[j] with arr[j+1]. If arr[j] > arr[j+1], swap them."},{step:"Swap Operation",hint:"After each pass, the largest unsorted element bubbles to its correct position."}]},insertion:{title:"ðŸ“¥ Insertion Sort",desc:"Like sorting playing cards - pick elements one by one and insert them in their correct position.",best:"O(n)",avg:"O(nÂ²)",worst:"O(nÂ²)",guidance:[{step:"Pick Element",hint:'Start from index 1. This element is the "key" to insert.'},{step:"Compare & Shift",hint:"Compare key with elements to its left. Shift larger elements right."},{step:"Insert Key",hint:"Insert the key at its correct position in the sorted portion."}]},selection:{title:"ðŸ‘† Selection Sort",desc:"Find the minimum element from unsorted part and put it at the beginning.",best:"O(nÂ²)",avg:"O(nÂ²)",worst:"O(nÂ²)",guidance:[{step:"Find Minimum",hint:"Search the unsorted portion for the smallest element."},{step:"Swap",hint:"Swap the minimum with the first unsorted element."},{step:"Repeat",hint:"Move the boundary of sorted/unsorted and repeat."}]},binary:{title:"ðŸ” Binary Search",desc:"Repeatedly divides the search interval in half. Extremely fast, but the array MUST be sorted first.",best:"O(1)",avg:"O(log n)",worst:"O(log n)",guidance:[{step:"Check Middle",hint:"Compare target with the middle element."},{step:"Eliminate Half",hint:"If target > mid, discard left half. If target < mid, discard right half."},{step:"Repeat",hint:"Repeat detection on the remaining subarray."}]},quick:{title:"âš¡ Quick Sort",desc:'Pick a "pivot" and partition: smaller elements go left, larger go right.',best:"O(n log n)",avg:"O(n log n)",worst:"O(nÂ²)",guidance:[{step:"Choose Pivot",hint:"Select the last element as the pivot."},{step:"Partition",hint:"Rearrange so elements < pivot are left, > pivot are right."},{step:"Recurse",hint:"Recursively sort the left and right partitions."}]},merge:{title:"ðŸ”€ Merge Sort",desc:"Divide the array in half, sort each half, then merge them together.",best:"O(n log n)",avg:"O(n log n)",worst:"O(n log n)",guidance:[{step:"Divide",hint:"Split the array into two halves."},{step:"Conquer",hint:"Recursively sort each half."},{step:"Merge",hint:"Merge the sorted halves by comparing elements."}]},linear:{title:"ðŸ” Linear Search",desc:"Check each element one by one from the start until the target is found or the array ends.",best:"O(1)",avg:"O(n)",worst:"O(n)",guidance:[{step:"Start at Beginning",hint:"Begin checking from the first element (index 0)."},{step:"Compare with Target",hint:"Check if the current element equals the target value."},{step:"Found or Continue",hint:"If found, return the index. Otherwise, move to the next element."},{step:"Not Found",hint:"If we reach the end without finding, return -1."}]}},init(){var t=v("sandboxEditorMount");if(!t){console.warn("[Sandbox] Editor mount point not found, will initialize later");return}this.initEditor(),this.initCanvas(),this.initPythonTutorVisualizers(),this.parseArray(),this.renderArray(),this.bindEvents(),this.updateAlgoInfo(),console.log("[Sandbox] Controller initialized with Python Tutor visualizers")},initPythonTutorVisualizers(){v("memoryVisualizerContainer")&&(this.memoryViz=new C2("memoryVisualizerContainer"),this.memoryViz.init()),v("callStackContainer")&&(this.callStackViz=new _2("callStackContainer"),this.callStackViz.init()),v("stepExplainerContainer")&&(this.stepExplainer=new R2("stepExplainerContainer"),this.stepExplainer.init()),v("controlFlowContainer")&&(this.controlFlowViz=new $2("controlFlowContainer"),this.controlFlowViz.init()),console.log("[Sandbox] Python Tutor visualizers initialized")},initCanvas(){var t=v("sandboxCanvas");if(!t){console.warn("[Sandbox] Canvas element not found, using DOM fallback");var e=v("sandboxArrayViz");e&&(e.style.display="flex");return}try{this.canvasViz=new l2("sandboxCanvas",{showValues:!0,showIndices:!0,animationDuration:150,enableGradients:!0,enableShadows:!0}),console.log("[Sandbox] Canvas visualizer created")}catch(i){console.error("[Sandbox] Canvas init failed:",i);var e=v("sandboxArrayViz");e&&(e.style.display="flex")}},initEditor(){var e;var t=v("sandboxEditorMount");t&&(t.innerHTML="",this.editor=vR(t,{language:this.currentLang,initialCode:((e=this.codeTemplates[this.currentAlgo])==null?void 0:e[this.currentLang])||"",onChange:i=>this.onCodeChange(i),onCursorChange:i=>this.onCursorChange(i)}),console.log("[Sandbox] Editor created"))},onCodeChange(t){this.steps=[],this.stepIndex=0,this.updateVariables({i:"-",j:"-",comparing:"-",swapped:"-"},null),this.controlFlowViz&&this.controlFlowViz.clear(),this.syncCodeToArrayInput(),this.codeModified=!0},onCursorChange(t){var e=v("sandboxCurrentLine");e&&(e.textContent=t.line)},bindEvents(){var e,i,s,r,n,a,o,l,c,h,d;document.querySelectorAll(".sandbox-lang-btn").forEach(u=>{u.addEventListener("click",()=>{var p;document.querySelectorAll(".sandbox-lang-btn").forEach(f=>f.classList.remove("active")),u.classList.add("active"),this.currentLang=u.dataset.lang,this.loadTemplate(),this.updateExecutionModeBadge(),(p=O==null?void 0:O.play)==null||p.call(O,"click")})}),(e=v("sandboxAlgoSelect"))==null||e.addEventListener("change",u=>{var p;this.currentAlgo=u.target.value,this.loadTemplate(),this.updateAlgoInfo(),this.updateVisualizerMode(),this.reset(),(p=O==null?void 0:O.play)==null||p.call(O,"pop")}),(i=v("sandboxArrayInput"))==null||i.addEventListener("change",()=>{this.syncArrayInputToCode(),this.reset()}),(s=v("sandboxRun"))==null||s.addEventListener("click",()=>this.run()),(r=v("sandboxPause"))==null||r.addEventListener("click",()=>this.pause()),(n=v("sandboxStepBack"))==null||n.addEventListener("click",()=>this.stepBack()),(a=v("sandboxStep"))==null||a.addEventListener("click",()=>this.step()),(o=v("sandboxReset"))==null||o.addEventListener("click",()=>this.reset()),(l=v("sandboxVizToggle"))==null||l.addEventListener("click",()=>this.toggleVisualizerView()),(c=v("timelineSlider"))==null||c.addEventListener("input",u=>{var p=parseInt(u.target.value);this.goToTimelineStep(p)}),(h=v("toggleVarInspector"))==null||h.addEventListener("click",()=>{var u=v("sandboxVarGridEnhanced");if(u){var p=u.style.display==="none";u.style.display=p?"grid":"none",v("toggleVarInspector").textContent=p?"Collapse":"Expand"}}),(d=v("codyDismiss"))==null||d.addEventListener("click",()=>{var u=v("codyWelcome");u&&(u.style.animation="fadeOut 0.3s ease",setTimeout(()=>u.style.display="none",300))});const t=v("pseudocodeToggle");if(t){const u=t.cloneNode(!0);t.parentNode.replaceChild(u,t),u.addEventListener("click",()=>{console.log("[Sandbox] Pseudocode toggle clicked"),this.togglePseudocode()}),console.log("[Sandbox] Pseudocode toggle bound")}else console.warn("[Sandbox] Pseudocode toggle button NOT FOUND");this.setupKeyboardShortcuts()},setupKeyboardShortcuts(){document.addEventListener("keydown",t=>{var e=v("algorithm-sandbox");if(!(!e||e.style.display==="none")&&!(t.target.tagName==="INPUT"||t.target.tagName==="TEXTAREA"||t.target.isContentEditable||t.target.closest(".cm-editor")))switch(t.key){case" ":t.preventDefault(),this.isPlaying?this.pause():this.run();break;case"ArrowRight":t.preventDefault(),this.step();break;case"ArrowLeft":t.preventDefault(),this.stepBack();break;case"Escape":t.preventDefault(),this.reset();break;case"r":case"R":!t.ctrlKey&&!t.metaKey&&(t.preventDefault(),this.run());break;case"s":case"S":!t.ctrlKey&&!t.metaKey&&(t.preventDefault(),this.step());break}})},loadTemplate(){var e;var t=((e=this.codeTemplates[this.currentAlgo])==null?void 0:e[this.currentLang])||"";this.editor&&(this.editor.setCode(t),this.editor.setLanguage(this.currentLang))},parseArray(){var e;var t=((e=v("sandboxArrayInput"))==null?void 0:e.value)||"";this.originalArray=t.split(",").map(i=>parseInt(i.trim(),10)).filter(i=>!isNaN(i)),this.currentArray=[...this.originalArray],this.canvasViz&&this.canvasViz.setArray(this.originalArray)},syncArrayInputToCode(){var i;var t=((i=v("sandboxArrayInput"))==null?void 0:i.value)||"",e=t.split(",").map(s=>parseInt(s.trim(),10)).filter(s=>!isNaN(s));if(e.length!==0&&(this.originalArray=e,this.currentArray=[...e],this.canvasViz&&this.canvasViz.setArray(e),this.renderArray(),this.dcTreeViz&&this.dcTreeViz.init(e,this.currentAlgo),this.editor)){const s=this.editor.getCode();let r=s;if(this.currentLang==="python"){const n=`[${e.join(", ")}]`,a=/^arr\s*=\s*\[.*?\]$/m;a.test(s)&&(r=s.replace(a,`arr = ${n}`))}else if(this.currentLang==="js"){const n=`[${e.join(", ")}]`,a=/(var|let|const)\s+arr\s*=\s*\[.*?\]/m;a.test(s)&&(r=s.replace(a,`$1 arr = ${n}`))}else if(this.currentLang==="java"){const n=`{${e.join(", ")}}`,a=/int\[\]\s+arr\s*=\s*\{.*?\}/m;a.test(s)&&(r=s.replace(a,`int[] arr = ${n}`))}r!==s&&(this.editor.setCode(r),console.log(`[Sandbox] Array injected into ${this.currentLang} code: [${e.join(", ")}]`))}},syncCodeToArrayInput(){if(!this.editor)return;const t=this.editor.getCode();let e=null;const s={python:/^arr\s*=\s*\[([\d\s,]+)\]/m,js:/(?:var|let|const)\s+arr\s*=\s*\[([\d\s,]+)\]/m,java:/int\[\]\s+arr\s*=\s*\{([\d\s,]+)\}/m}[this.currentLang];if(s){const r=t.match(s);r&&(e=r[1].split(",").map(n=>parseInt(n.trim(),10)).filter(n=>!isNaN(n)))}if(e&&e.length>0&&!(this.originalArray.length===e.length&&this.originalArray.every((n,a)=>n===e[a]))){const n=v("sandboxArrayInput");n&&(n.value=e.join(", ")),this.originalArray=e,this.currentArray=[...e],this.canvasViz&&this.canvasViz.setArray(e),this.renderArray(),this.dcTreeViz&&this.dcTreeViz.init(e,this.currentAlgo),console.log(`[Sandbox] Array synced from code: [${e.join(", ")}]`)}},renderArray(t=[],e=[],i=new Set){if(this.canvasViz){this.canvasViz.updateState({array:this.currentArray,comparing:t,swapping:e,sorted:i});return}var s=v("sandboxArrayViz");if(s){var r=Math.max(...this.currentArray,1);s.innerHTML=this.currentArray.map((n,a)=>{var o=n/r*120;let l="sandbox-bar";return t.includes(a)&&(l+=" comparing"),e.includes(a)&&(l+=" swapping"),i.has(a)&&(l+=" sorted"),`<div class="${l}" style="height: ${o}px;">
        <span class="sandbox-bar-value">${n}</span>
      </div>`}).join("")}},renderArrayWithAutoViz(t){var e=t.comparing||[],i=t.swapping||[],s=t.accessing||[],r=t.writing||[],n=t.sorted||new Set,a=t.pointers||{},o=t.searchRange||{};if(this.canvasViz){const h={array:this.currentArray,comparing:e,swapping:i,accessing:s,writing:r,sorted:n,pointers:a,searchRange:o};this.visualizerMode==="search"&&t.isSearch&&(h.searchTarget=t.target,h.searchIndex=t.searchIndex??-1,h.checkedIndices=Array.from(this.searchCheckedIndices),h.foundIndex=t.found?t.searchIndex:-1,t.searchIndex>=0&&!t.found&&this.searchCheckedIndices.add(t.searchIndex)),this.canvasViz.updateState(h);return}var l=v("sandboxArrayViz");if(l){var c=Math.max(...this.currentArray,1);l.innerHTML=this.currentArray.map((h,d)=>{var u=h/c*120;let p="sandbox-bar";return i.includes(d)?p+=" swapping":e.includes(d)?p+=" comparing":r.includes(d)?p+=" writing":s.includes(d)?p+=" accessing":n.has(d)&&(p+=" sorted"),`<div class="${p}" style="height: ${u}px;">
        <span class="sandbox-bar-value">${h}</span>
      </div>`}).join("")}},updateVariables(t={},e=null){var i,s,r,n;v("varI")&&(v("varI").textContent=t.i??"-"),v("varJ")&&(v("varJ").textContent=t.j??"-"),v("varN")&&(v("varN").textContent=t.n??"-"),v("varTemp")&&(v("varTemp").textContent=t.temp??"-"),v("varCompare")&&(v("varCompare").textContent=t.comparing??"-"),v("varSwapped")&&(v("varSwapped").textContent=t.swapped??"-"),this.memoryViz&&this.memoryViz.update({variables:t,callStack:((s=(i=this.executionEngine)==null?void 0:i.getCallStack)==null?void 0:s.call(i))||[],array:this.currentArray,line:((n=(r=this.executionEngine)==null?void 0:r.getCurrentLine)==null?void 0:n.call(r))||0}),this.controlFlowViz&&t&&this.controlFlowViz.update({variables:t,array:this.currentArray,comparing:e})},async generateSteps(){var s;var t=((s=this.editor)==null?void 0:s.getCode())||"";if(!t.trim())return this.lastError={type:"empty",message:"No code to execute. Please enter some code or select a template."},this.steps=[],!1;if(this.lastError=null,this.currentLang==="js"||this.currentLang==="javascript")try{var e=A0(t);if(!e.success)return this.lastError={type:"syntax",message:`Syntax error on line ${e.error.line}: ${e.error.message}`},this.steps=[],!1;var i=new o2(t,this.originalArray);return this.steps=i.generate(),this.stats=i.stats,this.steps.length===0?(this.lastError={type:"noSteps",message:"Could not generate visualization steps. Make sure your code contains a sorting algorithm."},!1):(console.log(`[Sandbox] Generated ${this.steps.length} steps using AST interpreter`),!0)}catch(r){console.warn("[Sandbox] AST generation failed, using fallback:",r)}if(this.currentLang==="python")try{if(console.log("[Sandbox] Using Python execution engine (Skulpt)..."),v("sandboxGuidanceHint")&&(v("sandboxGuidanceHint").textContent="Loading Python interpreter..."),this.skulptLoading=!0,this.pythonEngine=new ng(t,this.originalArray),await this.pythonEngine.init(),this.steps=await this.pythonEngine.generateSteps(),console.log("[DEBUG] Raw steps from Python engine:"),this.steps.slice(0,10).forEach((r,n)=>{console.log(`  Step ${n}: line=${r.line}, branch=${r.branch}, vars=`,r.variables)}),this.steps=dg(this.steps),this.skulptLoading=!1,this.steps.length>0)return this.stats=this.steps[this.steps.length-1].stats||{comparisons:0,swaps:0},console.log(`[Sandbox] Generated ${this.steps.length} steps using Python engine`),v("sandboxGuidanceHint")&&(v("sandboxGuidanceHint").textContent="Python code executed! Use Step to visualize."),!0;console.warn("[Sandbox] Python engine returned no steps, using fallback")}catch(r){console.warn("[Sandbox] Python execution failed, using fallback:",r),this.skulptLoading=!1,this.lastError={type:"execution",message:`Python execution error: ${r.message||r.toString()}`},v("sandboxGuidanceHint")&&(v("sandboxGuidanceHint").textContent=`Error: ${r.message||"Python execution failed"}. Using fallback simulation.`)}this.generateStepsFallback(),this.steps.length>0&&this.lastError&&(console.log("[Sandbox] Fallback succeeded despite Python error"),this.lastError=null)},generateStepsFallback(){var y,b;var t=[...this.originalArray];this.steps=[],this.stats={comparisons:0,swaps:0};var e=new Set,i=(w={})=>{w.compare&&this.stats.comparisons++,w.swap&&this.stats.swaps++,this.steps.push({arr:[...t],arrayState:[...t],sorted:new Set(e),comparing:w.comparing||[],swapping:w.swapping||[],i:w.i??-1,j:w.j??-1,line:w.line||1,guidanceIdx:w.guidanceIdx||0,stats:{...this.stats},description:w.description||"",variables:w.variables||{},target:w.target,result:w.result})},s=t.length;switch(this.currentAlgo){case"bubble":for(var r=0;r<s-1;r++){for(var n=0;n<s-r-1;n++)i({comparing:[n,n+1],compare:!0,i:r,j:n,line:4,guidanceIdx:2,description:`Comparing arr[${n}] with arr[${n+1}]`}),t[n]>t[n+1]&&([t[n],t[n+1]]=[t[n+1],t[n]],i({swapping:[n,n+1],swap:!0,i:r,j:n,line:7,guidanceIdx:3,description:`Swapped arr[${n}] â†” arr[${n+1}]`}));e.add(s-r-1)}break;case"insertion":for(var r=1;r<s;r++){var a=t[r],n=r-1;for(i({comparing:[r],i:r,j:n,line:3,guidanceIdx:0,description:`Key = arr[${r}] = ${a}`});n>=0&&t[n]>a;)i({comparing:[n,n+1],compare:!0,i:r,j:n,line:5,guidanceIdx:1,description:`Comparing arr[${n}] with key`}),t[n+1]=t[n],i({swapping:[n,n+1],swap:!0,i:r,j:n,line:6,guidanceIdx:1,description:`Shifted arr[${n}] right`}),n--;t[n+1]=a,i({swapping:[n+1],i:r,j:n+1,line:8,guidanceIdx:2,description:`Inserted key at position ${n+1}`})}break;case"selection":for(var r=0;r<s-1;r++){for(var o=r,n=r+1;n<s;n++)i({comparing:[o,n],compare:!0,i:r,j:n,line:5,guidanceIdx:0,description:`Comparing arr[${o}] with arr[${n}]`}),t[n]<t[o]&&(o=n);o!==r&&([t[r],t[o]]=[t[o],t[r]],i({swapping:[r,o],swap:!0,i:r,j:o,line:11,guidanceIdx:1,description:`Swapped arr[${r}] â†” arr[${o}]`})),e.add(r)}break;case"quick":var l=(w,k)=>{if(w<k){for(var x=t[k],E=w-1,_=w;_<k;_++)i({comparing:[_,k],compare:!0,i:E,j:_,line:6,guidanceIdx:1,description:`Comparing arr[${_}] with pivot`}),t[_]<=x&&(E++,[t[E],t[_]]=[t[_],t[E]],i({swapping:[E,_],swap:!0,i:E,j:_,line:9,guidanceIdx:1,description:`Swapped arr[${E}] â†” arr[${_}]`}));[t[E+1],t[k]]=[t[k],t[E+1]],i({swapping:[E+1,k],swap:!0,i:E+1,j:k,line:11,guidanceIdx:1,description:`Placed pivot at position ${E+1}`});var R=E+1;l(w,R-1),l(R+1,k)}};l(0,s-1);break;case"merge":for(var c=(w,k,x)=>{var E=t.slice(w,k+1),_=t.slice(k+1,x+1),R=0,C=0,D=w;for(i({comparing:[],i:w,j:x,line:14,guidanceIdx:3,description:`Merging [${w}..${k}] and [${k+1}..${x}]`,variables:{lo:w,mid:k,hi:x,i:0,j:0,k:w}});R<E.length&&C<_.length;)i({comparing:[w+R,k+1+C],compare:!0,i:w+R,j:k+1+C,line:16,guidanceIdx:4,description:`Comparing left[${R}]=${E[R]} with right[${C}]=${_[C]}`,variables:{lo:w,mid:k,hi:x,i:R,j:C,k:D}}),E[R]<=_[C]?(t[D]=E[R],i({swapping:[D],i:w+R,j:k+1+C,line:17,guidanceIdx:4,description:`Placed ${E[R]} at position ${D}`,variables:{lo:w,mid:k,hi:x,i:R,j:C,k:D}}),R++):(t[D]=_[C],i({swapping:[D],i:w+R,j:k+1+C,line:19,guidanceIdx:4,description:`Placed ${_[C]} at position ${D}`,variables:{lo:w,mid:k,hi:x,i:R,j:C,k:D}}),C++),D++;for(;R<E.length;)t[D]=E[R],i({swapping:[D],i:w+R,j:-1,line:23,guidanceIdx:5,description:`Copied remaining ${E[R]} to position ${D}`,variables:{lo:w,mid:k,hi:x,i:R,j:C,k:D}}),R++,D++;for(;C<_.length;)t[D]=_[C],i({swapping:[D],i:-1,j:k+1+C,line:28,guidanceIdx:5,description:`Copied remaining ${_[C]} to position ${D}`,variables:{lo:w,mid:k,hi:x,i:R,j:C,k:D}}),C++,D++},h=1;h<s;h*=2)for(var d=0;d<s-h;d+=2*h){var u=d+h-1,p=Math.min(d+2*h-1,s-1);i({comparing:[],i:d,j:p,line:4,guidanceIdx:1,description:`Divide: processing [${d}..${p}], mid=${u}`,variables:{lo:d,mid:u,hi:p,size:h}}),c(d,u,p)}break;case"linear":var f=43,g=(b=(y=this.editor)==null?void 0:y.getCode())==null?void 0:b.match(/target\s*=\s*(\d+)/);g&&(f=parseInt(g[1],10));for(var m=-1,r=0;r<s;r++)if(i({comparing:[r],i:r,j:-1,line:8,guidanceIdx:1,description:`Checking if arr[${r}] (${t[r]}) equals target (${f})`,target:f,result:m,variables:{i:r,target:f,result:m}}),t[r]===f){m=r,i({comparing:[r],i:r,j:-1,line:9,guidanceIdx:2,description:`Found target ${f} at index ${r}!`,target:f,result:m,variables:{i:r,target:f,result:m}});break}m===-1&&i({comparing:[],i:s,j:-1,line:11,guidanceIdx:3,description:`Target ${f} not found in array`,target:f,result:-1,variables:{i:s,target:f,result:-1}});break}for(var r=0;r<s;r++)e.add(r);i({line:12,guidanceIdx:0})},async run(){var a,o,l,c,h,d;if(this.playInterval&&(clearInterval(this.playInterval),this.playInterval=null),this.clearPythonError(),this.steps.length>0&&this.stepIndex>0&&this.stepIndex<this.steps.length&&!this.sortingComplete){console.log("[Sandbox] Resuming from step",this.stepIndex),this.beginAutoPlay();return}var t=((a=this.editor)==null?void 0:a.getCode())||"";if(!t.trim()){T("âŒ No code to execute","error");return}var e=k2(t,this.currentLang);if(!e.valid){T(`âŒ Syntax Error: ${e.errors[0]}`,"error"),(o=O==null?void 0:O.play)==null||o.call(O,"error");return}if(this.useRealExecution&&(this.currentLang==="js"||this.currentLang==="javascript")){this.runWithExecutionEngine();return}if(this.currentLang==="python"){this.runWithPythonTranspilation(t);return}if(this.currentLang==="java"){this.runWithJavaEngine(t);return}if(this.steps.length===0){var i=await this.generateSteps();if(i===!1||this.lastError){var s=this.lastError||{message:"Could not generate steps"};T(`âŒ ${s.message}`,"error"),(l=O==null?void 0:O.play)==null||l.call(O,"error");return}}if(this.steps.length===0){T("âŒ No visualization steps generated. Check your code.","error");return}if(this.stepIndex>=this.steps.length){T("âœ… Already complete! Click Reset to start again.","info");return}this.isPlaying=!0,(c=v("sandboxRun"))==null||c.classList.add("section-hidden"),(h=v("sandboxPause"))==null||h.classList.remove("section-hidden");var r=parseInt(((d=v("sandboxSpeed"))==null?void 0:d.value)||5),n=1e3/r;this.playInterval=setInterval(()=>{var u,p,f;try{if(!this.step()){if(this.pause(),["linear","binary"].includes(this.currentAlgo)){const m=this.steps[this.steps.length-1],y=(m==null?void 0:m.target)??((u=m==null?void 0:m.variables)==null?void 0:u.target),b=((p=m==null?void 0:m.variables)==null?void 0:p.result)??-1;y!==void 0?cg(b,y):T("Search complete","info")}else go(this.currentArray,this.originalArray);(f=O==null?void 0:O.play)==null||f.call(O,"success")}}catch(g){console.error("[Sandbox] Step error:",g),this.pause(),T("âŒ Execution error","error")}},n)},runWithExecutionEngine(t){var a,o,l,c;var e=t||((a=this.editor)==null?void 0:a.getCode())||"";if(!e.trim()){T("âŒ No code to execute","error");return}this.showPhase2UI(!0),this.steps=[];const i=new rg(e,this.originalArray,{onCompare:()=>{},onSwap:()=>{},onStep:h=>{this.steps.push({line:h.line,arrayState:[...h.array],comparing:[...h.comparing||[]],comparisonOperator:h.comparisonOperator||">",comparisonMode:h.comparisonMode||"array-array",comparisonValues:[...h.comparisonValues||[]],comparisonVarNames:[...h.comparisonVarNames||[]],swapping:[...h.swapping||[]],swapValues:[...h.swapValues||[]],swapLine:h.swapLine||null,variables:{...h.variables||{}},stats:{...h.stats},sorted:new Set(h.sorted)})},onVariables:()=>{},onLoopProgress:()=>{},onCallStack:()=>{},onError:h=>{console.error("[Pre-gen] Error:",h),T(`âŒ ${h.message}`,"error")},onSorted:()=>{},onAutoAccess:()=>{}});if(!i.init()){T("âŒ Failed to initialize execution","error");return}let s=5e3;for(;s-- >0;)try{if(i.stepToNextStatement().done)break}catch(h){console.error("[Pre-gen] Runtime error:",h),T(`âŒ Runtime error: ${h.message}`,"error");return}if(console.log(`[JS Pre-gen] Generated ${this.steps.length} steps`),this.steps.length===0){T("âŒ No visualization steps generated","error");return}this.isPlaying=!0,this.stepIndex=0,(o=v("sandboxRun"))==null||o.classList.add("section-hidden"),(l=v("sandboxPause"))==null||l.classList.remove("section-hidden");var r=parseInt(((c=v("sandboxSpeed"))==null?void 0:c.value)||5),n=1e3/r;this.playInterval=setInterval(()=>{var h;this.stepThroughJSSteps()||(this.pause(),T("âœ… Execution complete!","success"),(h=O==null?void 0:O.play)==null||h.call(O,"success"))},n)},stepThroughJSSteps(){if(this.stepIndex>=this.steps.length){for(var t=0;t<this.currentArray.length;t++)this.sorted.add(t);return this.renderArray([],[],this.sorted),!1}const e=this.steps[this.stepIndex];if(this.stepIndex++,this.currentArray=[...e.arrayState],this.sorted=e.sorted||new Set,this.renderArray(e.comparing||[],e.swapping||[],this.sorted),e.stats&&(v("sandboxComparisons")&&(v("sandboxComparisons").textContent=e.stats.comparisons),v("sandboxSwaps")&&(v("sandboxSwaps").textContent=e.stats.swaps)),v("sandboxStepNum")&&(v("sandboxStepNum").textContent=this.stepIndex),e.variables&&this.updateVariablesFromEngine(e.variables),this.editor&&e.line>0){this.editor.highlightLine(e.line);const i={};for(const[s,r]of Object.entries(e.variables||{}))s!=="arr"&&r!==void 0&&(i[s]=r);if(this.visualizerMode==="tree")Object.keys(i).length>0&&this.editor.setAnnotation(e.line,i,null,null);else{let s=null,r="compare";if(e.comparing&&e.comparing.length>=1&&e.comparisonValues&&e.comparisonValues.length>=2){const n=e.comparisonOperator||">";if(s={left:e.comparisonValues[0],right:e.comparisonValues[1],operator:n,result:A2(e.comparisonValues[0],n,e.comparisonValues[1])},e.comparisonVarNames&&e.comparisonVarNames.length>0){const a=new Set(e.comparisonVarNames),o={};for(const[l,c]of Object.entries(i))a.has(l)&&(o[l]=c);Object.keys(i).forEach(l=>delete i[l]),Object.assign(i,o)}}if(e.swapping&&e.swapping.length>=2){const n=e.swapping[0],a=e.swapping[1],o=e.swapValues&&e.swapValues.length>=2?e.swapValues:[e.arrayState[n],e.arrayState[a]];s={left:o[0],right:o[1],indices:[n,a],result:!0},r="swap";const l={};for(const[c,h]of Object.entries(i))(c==="temp"||h===n||h===a)&&(l[c]=h);Object.keys(i).forEach(c=>delete i[c]),Object.assign(i,l)}if(Object.keys(i).length>0||s){let n=e.line;if(r==="swap")if(e.swapLine&&e.swapLine>0)n=e.swapLine;else{const o=this.editor.getCode().split(`
`);for(let l=0;l<o.length;l++)if(/^(var\s+|let\s+|const\s+)?temp\s*=\s*arr\[/.test(o[l].trim())){n=l+1;break}}this.editor.setAnnotation(n,i,s,r)}}}return this.updateTimeline(),this.updateStepExplanation({line:e.line,comparing:e.comparing,swapping:e.swapping,variables:e.variables}),this.updateDCTreeFromStep(e),!0},updateStats(t){v("sandboxComparisons")&&(v("sandboxComparisons").textContent=t.comparisons),v("sandboxSwaps")&&(v("sandboxSwaps").textContent=t.swaps)},updateVariablesFromEngine(t){if(t){v("varI")&&(v("varI").textContent=t.i!==void 0?t.i:"-"),v("varJ")&&(v("varJ").textContent=t.j!==void 0?t.j:"-"),v("varN")&&(v("varN").textContent=t.n!==void 0?t.n:"-"),v("varTemp")&&(v("varTemp").textContent=t.temp!==void 0?t.temp:"-");var e="-";t.i!==void 0&&t.j!==void 0&&(e=`[${t.i}, ${t.j}]`),v("varCompare")&&(v("varCompare").textContent=e),v("varSwapped")&&(v("varSwapped").textContent=t.swapped!==void 0?t.swapped?"Yes":"No":"-"),this.controlFlowViz&&Object.keys(t).length>0&&this.controlFlowViz.update({variables:t,array:this.currentArray}),this.updateEnhancedVariableGrid(t)}},updateEnhancedVariableGrid(t){var e=v("sandboxVarGridEnhanced");if(!(!e||!t)){var i="",s=Object.entries(t).filter(([c])=>c!=="arr");if(s.length===0)i=`<div class="var-empty-state" style="
        grid-column: 1 / -1;
        text-align: center;
        color: var(--text-muted);
        font-size: 0.8rem;
        padding: 1rem;
      ">Run or step to see variables</div>`;else for(var[r,n]of s){var a=n,o=typeof n,l=o==="number"?"#60a5fa":o==="boolean"?"#a78bfa":o==="string"?"#34d399":"#f59e0b";i+=`
          <div class="enhanced-var-item" style="
            background: var(--bg-paper);
            padding: 0.5rem;
            border-radius: 6px;
            text-align: center;
            border: 1px solid var(--border-soft);
          ">
            <div style="font-size: 0.7rem; color: var(--text-muted); text-transform: uppercase; margin-bottom: 0.25rem;">${r}</div>
            <div style="font-size: 1rem; font-weight: 600; color: ${l};">${a}</div>
            <div style="font-size: 0.6rem; color: var(--text-muted); opacity: 0.7;">${o}</div>
          </div>
        `}e.innerHTML=i}},showPhase2UI(t){var e=v("sandboxTimeline"),i=v("sandboxVarInspectorEnhanced"),s=v("sandboxStepExplanation"),r=v("sandboxLoopProgress"),n=v("sandboxCallStack");e&&(e.style.display=t?"block":"none"),i&&(i.style.display=t?"block":"none"),s&&(s.style.display=t?"block":"none"),r&&!t&&(r.style.display="none"),n&&!t&&(n.style.display="none"),t||(this.loopInfoStack=[])},updateTimeline(){var t=v("timelineSlider"),e=v("timelineStepLabel"),i=v("timelineMaxLabel"),s=0,r=0;if(this.steps&&this.steps.length>0)s=this.steps.length,r=this.stepIndex||0;else if(this.executionEngine){var n=this.executionEngine.getHistory();s=n.length,r=this.executionEngine.getHistoryIndex()}t&&s>0&&(t.max=s-1,t.value=r),e&&(e.textContent=`Step ${r+1}`),i&&(i.textContent=`of ${s}`)},goToTimelineStep(t){if(this.executionEngine){var e=this.executionEngine.goToStep(t);if(e){if(this.currentArray=e.array,this.renderArray(e.comparing,e.swapping,e.sorted),this.editor&&e.line>0){this.editor.highlightLine(e.line);const i={};for(const[n,a]of Object.entries(e.variables||{}))n!=="arr"&&a!==void 0&&(i[n]=a);let s=null,r="compare";if(e.comparing&&e.comparing.length>=2){const n=e.comparing[0],a=e.comparing[1];s={left:e.array[n],right:e.array[a],result:e.array[n]>e.array[a]}}if(e.swapping&&e.swapping.length>=2){const n=e.swapping[0],a=e.swapping[1];s={left:e.array[n],right:e.array[a],result:!0},r="swap"}(Object.keys(i).length>0||s)&&this.editor.setAnnotation(e.line,i,s,r)}this.updateTimeline(),this.updateStepExplanation(e)}}},updateStepExplanation(t){this.stepExplainer&&this.stepExplainer.update({...t,array:this.currentArray,stepCount:t.stepCount||this.stepIndex+1}),this.callStackViz&&t.callStack&&this.callStackViz.update(t.callStack),this.controlFlowViz&&this.controlFlowViz.update({...t,array:this.currentArray});var e=v("stepExplanationText");if(e){var i="";if(t.comparing&&t.comparing.length===2){var[s,r]=t.comparing,n=this.currentArray[s],a=this.currentArray[r];i=`Comparing arr[${s}] = ${n} with arr[${r}] = ${a}. `,n>a?i+=`Since ${n} > ${a}, they need to be swapped.`:i+=`Since ${n} â‰¤ ${a}, no swap needed.`}else if(t.swapping&&t.swapping.length===2){var[s,r]=t.swapping;i=`Swapping arr[${s}] and arr[${r}] to move the larger element forward.`}else t.line>0?i=`Executing line ${t.line} of your code.`:i=`Processing step ${t.stepCount||0}...`;e.textContent=i}},updateLoopProgress(t){var e=v("sandboxLoopProgress"),i=v("loopProgressBars");if(!(!e||!i)){e.style.display="block",this.loopInfoStack||(this.loopInfoStack=[]);var s=this.loopInfoStack.find(n=>n.variable===t.variable);s?(s.current=t.current,s.max=t.max):t.current!==void 0&&this.loopInfoStack.push({variable:t.variable,current:t.current,max:t.max});var r="";this.loopInfoStack.forEach((n,a)=>{var o=n.max?Math.min(n.current/n.max*100,100):0,l=a===0?"Outer":a===1?"Inner":`L${a+1}`,c=n.max!==null?n.max:"?";r+=`
        <div class="loop-progress-item" style="display: flex; align-items: center; gap: 0.5rem;">
          <span style="font-size: 0.75rem; color: var(--text-muted); min-width: 50px;">${l}: ${n.variable}</span>
          <div style="flex: 1; height: 6px; background: var(--bg-paper); border-radius: 3px; overflow: hidden;">
            <div style="height: 100%; width: ${o}%; background: linear-gradient(90deg, var(--accent-forest), var(--accent-ocean)); transition: width 0.2s ease;"></div>
          </div>
          <span style="font-size: 0.75rem; color: var(--accent-forest); min-width: 50px; text-align: right;">${n.current}/${c}</span>
        </div>
      `}),i.innerHTML=r||'<div style="text-align: center; color: var(--text-muted); font-size: 0.8rem;">No active loops</div>'}},updateCallStack(t){var e=v("sandboxCallStack"),i=v("callStackFrames");if(!(!e||!i)){t.length>0&&(e.style.display="block");var s="";t.length===0?s=`
        <div class="stack-frame-empty" style="text-align: center; color: var(--text-muted); font-size: 0.8rem; padding: 0.5rem;">
          No active function calls
        </div>
      `:t.forEach((r,n)=>{var a=n===t.length-1,o=a?"rgba(16, 185, 129, 0.2)":"var(--bg-paper)",l=a?"var(--accent-forest)":"var(--border-soft)";s+=`
          <div class="stack-frame" style="
            padding: 0.5rem;
            background: ${o};
            border: 1px solid ${l};
            border-radius: 6px;
            display: flex;
            justify-content: space-between;
            align-items: center;
          ">
            <span style="font-weight: 600; color: ${a?"var(--accent-forest)":"var(--text-body)"};">
              ${a?"â–¶ ":""}${r.name}()
            </span>
            <span style="font-size: 0.75rem; color: var(--text-muted);">
              line ${r.line}
            </span>
          </div>
        `}),i.innerHTML=s}},pause(){var t,e;this.isPlaying=!1,this.playInterval&&(clearInterval(this.playInterval),this.playInterval=null),(t=v("sandboxRun"))==null||t.classList.remove("section-hidden"),(e=v("sandboxPause"))==null||e.classList.add("section-hidden")},async step(){var c,h,d,u,p,f,g,m,y;if(console.log("[Sandbox.step] Called. useRealExecution:",this.useRealExecution,"currentLang:",this.currentLang),this.useRealExecution&&(this.currentLang==="js"||this.currentLang==="javascript"))return console.log("[Sandbox.step] Routing to stepWithExecutionEngine()"),this.stepWithExecutionEngine();if(this.currentLang==="python")return console.log("[Sandbox.step] Routing to stepWithPythonEngine()"),this.stepWithPythonEngine();if(this.currentLang==="java")return console.log("[Sandbox.step] Routing to stepWithJavaEngine()"),this.stepWithJavaEngine();if(console.log("[Sandbox.step] Using fallback generateSteps()"),this.steps.length===0&&await this.generateSteps(),this.stepIndex>=this.steps.length)return!1;var t=this.steps[this.stepIndex];this.currentArray=[...t.arrayState||t.arr],this.renderArray(t.comparing||[],t.swapping||[],t.sorted||new Set);var e=t.stats||this.stats;v("sandboxComparisons")&&(v("sandboxComparisons").textContent=e.comparisons),v("sandboxSwaps")&&(v("sandboxSwaps").textContent=e.swaps),v("sandboxStepNum")&&(v("sandboxStepNum").textContent=this.stepIndex+1);var i=t.variables||{},s=t.i>=0?t.i:i.i??null,r=t.j>=0?t.j:i.j??null,n={};if(s!=null&&s>=0&&(n.i=s),r!=null&&r>=0&&(n.j=r),((c=t.comparing)==null?void 0:c.length)>0){const b=t.arrayState||t.arr||this.currentArray;if(b){const w=t.comparing[0],k=t.comparing[1];b[w]!==void 0&&(n[`arr[${w}]`]=b[w]),b[k]!==void 0&&(n[`arr[${k}]`]=b[k])}}var a=null;if(t.type==="compare"&&((h=t.comparing)==null?void 0:h.length)>=2){const b=t.arrayState||t.arr||this.currentArray;a={left:b[t.comparing[0]],right:b[t.comparing[1]],result:t.result}}if(this.editor&&t.line>0?this.editor.setAnnotation(t.line,n,a):this.editor&&t.line===0&&this.editor.setAnnotation(5,n,a),this.updateVariables({i:s??"-",j:r??"-",comparing:((d=t.comparing)==null?void 0:d.length)>0?`[${t.comparing.join(", ")}]`:"-",swapped:((u=t.swapping)==null?void 0:u.length)>0?"Yes":"No"},t.comparing),t.description&&v("sandboxGuidanceHint")&&(v("sandboxGuidanceHint").textContent=t.description),t.pseudocodeLine!==void 0?this.highlightPseudocodeLine(t.pseudocodeLine):t.guidanceIdx!==void 0&&this.highlightPseudocodeLine(t.guidanceIdx),!t.description){var o=this.algoInfo[this.currentAlgo];if((p=o==null?void 0:o.guidance)!=null&&p[t.guidanceIdx]){var l=o.guidance[t.guidanceIdx];v("sandboxGuidanceStep")&&(v("sandboxGuidanceStep").textContent=l.step),v("sandboxGuidanceHint")&&(v("sandboxGuidanceHint").textContent=l.hint)}}return((f=t.comparing)==null?void 0:f.length)>0&&((g=O==null?void 0:O.play)==null||g.call(O,"pop")),((m=t.swapping)==null?void 0:m.length)>0&&((y=O==null?void 0:O.play)==null||y.call(O,"swoosh")),this.updateDCTreeFromStep(t),this.stepIndex++,this.stepIndex<this.steps.length},stepWithExecutionEngine(){var e;var t=((e=this.editor)==null?void 0:e.getCode())||"";if(!t.trim())return T("âŒ No code to execute","error"),!1;if(this.showPhase2UI(!0),!this.steps||this.steps.length===0){this.steps=[];const i=new rg(t,this.originalArray,{onCompare:()=>{},onSwap:()=>{},onStep:r=>{this.steps.push({line:r.line,arrayState:[...r.array],comparing:[...r.comparing||[]],swapping:[...r.swapping||[]],swapValues:[...r.swapValues||[]],swapLine:r.swapLine||null,variables:{...r.variables||{}},stats:{...r.stats},sorted:new Set(r.sorted)})},onVariables:()=>{},onLoopProgress:()=>{},onCallStack:()=>{},onError:r=>{console.error("[Pre-gen] Error:",r),T(`âŒ ${r.message}`,"error")},onSorted:()=>{},onAutoAccess:()=>{}});if(!i.init())return T("âŒ Failed to initialize execution","error"),!1;let s=5e3;for(;s-- >0;)try{if(i.stepToNextStatement().done)break}catch(r){return console.error("[Pre-gen] Runtime error:",r),T(`âŒ Runtime error: ${r.message}`,"error"),!1}console.log(`[JS Step Pre-gen] Generated ${this.steps.length} steps`),this.stepIndex=0}return this.stepThroughJSSteps()},stepWithPythonEngine(){var r,n,a,o,l,c,h,d,u,p,f,g,m,y,b,w,k,x,E,_,R;if(this.steps.length===0){var t=((r=this.editor)==null?void 0:r.getCode())||"";return t.trim()?(this.showPhase2UI(!0),this.runWithPythonTranspilation(t,!0),!0):(T("âŒ No code to execute","error"),!1)}if(this.stepIndex>=this.steps.length)return go(this.currentArray,this.originalArray),!1;var e=this.steps[this.stepIndex];console.log(`[stepWithPython] Step ${this.stepIndex}:`,{line:e.line,type:e.type,swapState:e.swapState,swapping:e.swapping,comparing:e.comparing,variables:e.variables,temp:(n=e.variables)==null?void 0:n.temp}),this.currentArray=[...e.arrayState||e.arr],this.visualizerMode==="search"&&e.isSearch?this.renderArrayWithAutoViz({comparing:e.comparing||[],swapping:e.swapping||[],sorted:e.sorted||new Set,isSearch:!0,target:e.target,searchIndex:e.searchIndex,found:e.found}):this.renderArray(e.comparing||[],e.swapping||[],e.sorted||new Set);var i=e.stats||this.stats;if(v("sandboxComparisons")&&(v("sandboxComparisons").textContent=i.comparisons),v("sandboxSwaps")&&(v("sandboxSwaps").textContent=i.swaps),v("sandboxStepNum")&&(v("sandboxStepNum").textContent=this.stepIndex+1),e.variables&&this.updateVariablesFromEngine(e.variables),["merge","quick"].includes(this.currentAlgo)&&this.dcTreeViz&&this.updateDCTreeFromStep(e),this.controlFlowViz&&((a=e.comparing)==null?void 0:a.length)>=2&&this.controlFlowViz.update({variables:e.variables||{},array:e.arrayState||this.currentArray,comparing:e.comparing}),this.editor&&e.line>0){this.editor.highlightLine(e.line);const C={},D=e.variables||{};for(const[A,F]of Object.entries(D))A!=="arr"&&F!==void 0&&F!==null&&(C[A]=F);let q=null;if(e.isSearch&&!e.pointers&&e.branch==="if_check"&&e.target!==void 0&&e.searchIndex!==void 0){const A=e.arrayState||e.arr||this.currentArray;if(A&&e.searchIndex>=0&&e.searchIndex<A.length){const F=A[e.searchIndex];q={left:F,right:e.target,result:F===e.target,operator:"==",isSearch:!0}}}else if(e.isSearch&&e.pointers&&e.target!==void 0){const A=e.arrayState||e.arr||this.currentArray,F=e.pointers.mid;if(A&&F>=0&&F<A.length){const L=A[F],W=e.target;if(e.branch==="if_check")q={left:L,right:W,result:L===W,operator:"==",isSearch:!0};else if(e.branch==="elif_check"){const M=L<W;q={left:L,right:W,result:M,operator:"<",isSearch:!0}}else e.branch==="else_check"&&(q={left:L,right:W,result:L>W,operator:">",isSearch:!0})}}else if(((o=e.comparing)==null?void 0:o.length)>=2){const A=e.arrayState||e.arr||this.currentArray;A&&(q={left:A[e.comparing[0]],right:A[e.comparing[1]],result:e.result!==void 0?e.result:A[e.comparing[0]]>A[e.comparing[1]]})}else if(e.type==="compare"&&e.variables){const A=e.variables.i??e.i,F=e.variables.j??e.j,L=e.arrayState||e.arr||this.currentArray;L&&A!==void 0&&F!==void 0&&(q={left:L[A],right:L[F],result:e.result})}if(e.branch==="else"&&!q&&(C.__branch__="â†’ else"),this.visualizerMode==="tree")Object.keys(C).length>0&&this.editor.setAnnotation(e.line,C,null,null);else{let A="compare",F=q;if(((l=e.swapping)==null?void 0:l.length)>=2){const L=e.arrayState||e.arr||this.currentArray;L&&(F={left:L[e.swapping[0]],right:L[e.swapping[1]],result:!0},A="swap")}if(e.type==="shift"&&e.shiftPosition!==void 0){const L=e.arrayState||e.arr||this.currentArray,W=e.variables||{};L&&W.key!==void 0&&(F={left:L[e.shiftPosition],right:W.key,result:!0},A="shift")}if(Object.keys(C).length>0||F){let L=C;if(C.mid!==void 0&&C.left!==void 0)L={},C.i!==void 0&&(L.i=C.i),C.j!==void 0&&(L.j=C.j);else if(e.isSearch&&!e.pointers&&F)L={},C.i!==void 0&&(L.i=C.i),C.target!==void 0&&(L.target=C.target),C.result!==void 0&&(L.result=C.result);else if(e.isSearch&&e.pointers&&F&&(e.branch==="if_check"||e.branch==="elif_check"||e.branch==="else_check"))L={},C.mid!==void 0?L.mid=C.mid:C.m!==void 0&&(L.m=C.m),C.target!==void 0&&(L.target=C.target);else if(e.isSearch&&e.pointers&&F)L={},C.low!==void 0?L.low=C.low:C.lo!==void 0&&(L.lo=C.lo),C.high!==void 0?L.high=C.high:C.hi!==void 0&&(L.hi=C.hi),C.mid!==void 0&&(L.mid=C.mid),C.target!==void 0&&(L.target=C.target);else if(F){const M=new Set;C.j!==void 0&&M.add("j"),C.min_idx!==void 0&&M.add("min_idx"),C.key!==void 0&&M.add("key"),C.pivot!==void 0&&M.add("pivot"),C.temp!==void 0&&M.add("temp"),L={};for(const G of M)C[G]!==void 0&&(L[G]=C[G])}this.editor.setAnnotation(e.line,L,F,A)}}}if(this.editor&&e.line===0&&e.type==="compare"&&((c=e.comparing)==null?void 0:c.length)>=2){const D=(((d=(h=this.editor).getCode)==null?void 0:d.call(h))||"").split(`
`);let q=0;for(let A=0;A<D.length;A++)if(D[A].includes("visualize.compare")){q=A+1;break}if(q>0){const A=e.arrayState||e.arr||this.currentArray;if(A){const F={left:A[e.comparing[0]],right:A[e.comparing[1]],result:e.result},L={i:((u=e.variables)==null?void 0:u.i)??e.i,j:((p=e.variables)==null?void 0:p.j)??e.j};this.editor.highlightLine(q),this.editor.setAnnotation(q,L,F)}}if(q===0){for(let A=0;A<D.length;A++)if(D[A].match(/arr\[\w+\]\s*[<>=!]+\s*arr\[\w+\]/)){q=A+1;break}if(q>0){const A=e.arrayState||e.arr||this.currentArray;if(A){const F={left:A[e.comparing[0]],right:A[e.comparing[1]],result:e.result},L={i:((f=e.variables)==null?void 0:f.i)??e.i,j:((g=e.variables)==null?void 0:g.j)??e.j};this.editor.highlightLine(q),this.editor.setAnnotation(q,L,F)}}}}if(this.editor&&e.line===0&&e.type==="swap"&&((m=e.swapping)==null?void 0:m.length)>=2){const D=(((b=(y=this.editor).getCode)==null?void 0:b.call(y))||"").split(`
`);let q=0;for(let A=0;A<D.length;A++)if(D[A].includes("visualize.swap")){q=A+1;break}if(q===0){for(let A=0;A<D.length;A++)if(D[A].match(/arr\[.+\]\s*=\s*temp/)){q=A+1;break}}if(q>0){const A=e.arrayState||e.arr||this.currentArray;if(A){const F={i:((w=e.variables)==null?void 0:w.i)??e.i,j:((k=e.variables)==null?void 0:k.j)??e.j},L={left:A[e.swapping[0]],right:A[e.swapping[1]],result:!0};this.editor.highlightLine(q),this.editor.setAnnotation(q,F,L,"swap")}}}return v("sandboxCurrentLine")&&(v("sandboxCurrentLine").textContent=e.line>0?e.line:"-"),e.description&&v("sandboxGuidanceHint")&&(v("sandboxGuidanceHint").textContent=e.description),((x=e.comparing)==null?void 0:x.length)>0&&((E=O==null?void 0:O.play)==null||E.call(O,"pop")),((_=e.swapping)==null?void 0:_.length)>0&&((R=O==null?void 0:O.play)==null||R.call(O,"swoosh")),this.updateDCTreeFromStep(e),this.stepIndex++,this.stepIndex<this.steps.length},async stepWithJavaEngine(){var s,r,n,a,o,l,c,h,d,u;if(this.steps.length===0){var t=((s=this.editor)==null?void 0:s.getCode())||"";if(!t.trim())return T("âŒ No code to execute","error"),!1;this.showPhase2UI(!0);try{if(console.log("[stepWithJavaEngine] Creating JavaExecutionEngine..."),this.javaEngine=new lg(t,this.originalArray),!await this.javaEngine.init()){const f=this.javaEngine.getError();return T(`âŒ Java Error: ${(f==null?void 0:f.message)||"Unknown error"}`,"error"),!1}if(this.steps=this.javaEngine.steps||[],console.log(`[stepWithJavaEngine] Generated ${this.steps.length} steps`),this.steps.length===0)return T("âš ï¸ No steps generated - check your code","warning"),!1;v("sandboxTotalSteps")&&(v("sandboxTotalSteps").textContent=this.steps.length)}catch(p){return console.error("[stepWithJavaEngine] Error:",p),T(`âŒ Java Error: ${p.message}`,"error"),!1}}if(this.stepIndex>=this.steps.length)return go(this.currentArray,this.originalArray),!1;var e=this.steps[this.stepIndex];console.log(`[stepWithJava] Step ${this.stepIndex}:`,{line:e.line,type:e.type,swapping:e.swapping,comparing:e.comparing,variables:e.variables}),this.currentArray=[...e.arrayState||e.arr],this.renderArray(e.comparing||[],e.swapping||[],e.sorted||new Set);var i=e.stats||this.stats;if(v("sandboxComparisons")&&(v("sandboxComparisons").textContent=i.comparisons||0),v("sandboxSwaps")&&(v("sandboxSwaps").textContent=i.swaps||0),v("sandboxStepNum")&&(v("sandboxStepNum").textContent=this.stepIndex+1),e.variables&&this.updateVariablesFromEngine(e.variables),this.controlFlowViz&&((r=e.comparing)==null?void 0:r.length)>=2&&this.controlFlowViz.update({variables:e.variables||{},array:e.arrayState||this.currentArray,comparing:e.comparing}),this.editor&&e.line>0){this.editor.highlightLine(e.line);const p={},f=e.variables||{};for(const[g,m]of Object.entries(f))g!=="arr"&&m!==void 0&&m!==null&&(p[g]=m);if(this.visualizerMode==="tree")Object.keys(p).length>0&&this.editor.setAnnotation(e.line,p,null,null);else{let g="compare",m=null;const w=(((a=(n=this.editor)==null?void 0:n.getCode)==null?void 0:a.call(n))||"").split(`
`)[e.line-1]||"",k=/arr\[.+\]\s*[<>!=]+\s*arr\[.+\]/.test(w)||w.includes("if (")||w.includes("while (");if(((o=e.comparing)==null?void 0:o.length)>=2&&k){const E=e.arrayState||this.currentArray;m={left:E[e.comparing[0]],right:E[e.comparing[1]],result:e.result!==void 0?e.result:E[e.comparing[0]]>E[e.comparing[1]]}}if(((l=e.swapping)==null?void 0:l.length)>=2){const E=e.arrayState||this.currentArray;m={left:E[e.swapping[0]],right:E[e.swapping[1]],result:!0},g="swap"}let x=p;k&&m?(x={},p.j!==void 0&&(x.j=p.j),p.min_idx!==void 0&&(x.min_idx=p.min_idx),p.key!==void 0&&(x.key=p.key)):g==="swap"&&(x={},p.j!==void 0&&(x.j=p.j),p.temp!==void 0&&(x.temp=p.temp)),this.editor.setAnnotation(e.line,x,m,g)}}return v("sandboxCurrentLine")&&(v("sandboxCurrentLine").textContent=e.line>0?e.line:"-"),e.description&&v("sandboxGuidanceHint")&&(v("sandboxGuidanceHint").textContent=e.description),((c=e.comparing)==null?void 0:c.length)>0&&((h=O==null?void 0:O.play)==null||h.call(O,"pop")),((d=e.swapping)==null?void 0:d.length)>0&&((u=O==null?void 0:O.play)==null||u.call(O,"swoosh")),this.updateDCTreeFromStep(e),this.stepIndex++,this.stepIndex<this.steps.length},stepBack(){var r,n,a,o;if(this.executionEngine&&(this.currentLang==="js"||this.currentLang==="javascript")){if(!this.executionEngine.canStepBack())return T("â®ï¸ Already at the beginning","info"),!1;var t=this.executionEngine.stepBack();if(t){if(this.currentArray=t.array,this.renderArray(t.comparing,t.swapping,t.sorted),v("sandboxComparisons")&&(v("sandboxComparisons").textContent=t.stats.comparisons),v("sandboxSwaps")&&(v("sandboxSwaps").textContent=t.stats.swaps),v("sandboxStepNum")&&(v("sandboxStepNum").textContent=this.executionEngine.getHistoryIndex()+1),v("sandboxCurrentLine")&&(v("sandboxCurrentLine").textContent=t.line),this.updateVariablesFromEngine(t.variables),this.editor&&t.line>0){this.editor.highlightLine(t.line);const l={};for(const[p,f]of Object.entries(t.variables||{}))p!=="arr"&&f!==void 0&&(l[p]=f);let c=null,h="compare";t.comparing&&t.comparing.length>=2&&(c={left:t.array[t.comparing[0]],right:t.array[t.comparing[1]],result:t.array[t.comparing[0]]>t.array[t.comparing[1]]}),t.swapping&&t.swapping.length>=2&&(c={left:t.array[t.swapping[0]],right:t.array[t.swapping[1]],result:!0},h="swap");let d=l;if(l.mid!==void 0&&l.left!==void 0)d={},l.i!==void 0&&(d.i=l.i),l.j!==void 0&&(d.j=l.j);else if(c){const p=new Set;l.j!==void 0&&p.add("j"),l.minIdx!==void 0&&p.add("minIdx"),l.min_idx!==void 0&&p.add("min_idx"),l.key!==void 0&&p.add("key"),l.pivot!==void 0&&p.add("pivot"),l.temp!==void 0&&p.add("temp"),d={};for(const f of p)l[f]!==void 0&&(d[f]=l[f])}(Object.keys(d).length>0||c)&&this.editor.setAnnotation(t.line,d,c,h)}return!0}return!1}if(this.stepIndex<=0)return T("â®ï¸ Already at the beginning","info"),!1;if(this.stepIndex=Math.max(0,this.stepIndex-1),this.stepIndex===0)return this.currentArray=[...this.originalArray],this.renderArray(),v("sandboxComparisons")&&(v("sandboxComparisons").textContent="0"),v("sandboxSwaps")&&(v("sandboxSwaps").textContent="0"),v("sandboxStepNum")&&(v("sandboxStepNum").textContent="0"),v("sandboxCurrentLine")&&(v("sandboxCurrentLine").textContent="-"),this.updateVariables(),!0;var e=this.steps[this.stepIndex-1];if(!e)return!1;this.currentArray=[...e.arrayState||e.arr],this.renderArray(e.comparing||[],e.swapping||[],e.sorted||new Set);var i=e.stats||this.stats;v("sandboxComparisons")&&(v("sandboxComparisons").textContent=i.comparisons),v("sandboxSwaps")&&(v("sandboxSwaps").textContent=i.swaps),v("sandboxStepNum")&&(v("sandboxStepNum").textContent=this.stepIndex);var s=e.variables||{};if(this.updateVariables({i:e.i>=0?e.i:s.i??"-",j:e.j>=0?e.j:s.j??"-",comparing:((r=e.comparing)==null?void 0:r.length)>0?`[${e.comparing.join(", ")}]`:"-",swapped:((n=e.swapping)==null?void 0:n.length)>0?"Yes":"No"},e.comparing),e.description&&v("sandboxGuidanceHint")&&(v("sandboxGuidanceHint").textContent=e.description),this.editor&&e.line>0){this.editor.highlightLine(e.line);const l={};for(const[p,f]of Object.entries(s))p!=="arr"&&f!==void 0&&f!==null&&(l[p]=f);let c=null;if(((a=e.comparing)==null?void 0:a.length)>=2){const p=e.arrayState||e.arr||this.currentArray;p&&(c={left:p[e.comparing[0]],right:p[e.comparing[1]],result:e.result})}let h=null;if(((o=e.swapping)==null?void 0:o.length)>=2){const p=e.arrayState||e.arr||this.currentArray;p&&(h={left:p[e.swapping[0]],right:p[e.swapping[1]]})}const d=c||h,u=h?"swap":c?"compare":void 0;if(Object.keys(l).length>0||d){let p=l;if(l.mid!==void 0&&l.left!==void 0)p={},l.i!==void 0&&(p.i=l.i),l.j!==void 0&&(p.j=l.j);else if(d){const g=new Set;l.j!==void 0&&g.add("j"),l.min_idx!==void 0&&g.add("min_idx"),l.key!==void 0&&g.add("key"),l.pivot!==void 0&&g.add("pivot"),l.temp!==void 0&&g.add("temp"),p={};for(const m of g)l[m]!==void 0&&(p[m]=l[m])}this.editor.setAnnotation(e.line,p,c,u)}}return!0},reset(){var e;this.pause(),this.parseArray(),this.steps=[],this.stepIndex=0,this.stats={comparisons:0,swaps:0},this.sorted=new Set,this.searchCheckedIndices=new Set,this.canvasViz&&this.visualizerMode==="search"&&(this.canvasViz.searchTarget=null,this.canvasViz.searchIndex=-1,this.canvasViz.checkedIndices=new Set,this.canvasViz.foundIndex=-1),this.clearPythonError(),this.executionEngine&&(this.executionEngine.reset(),this.executionEngine=null),this.resetDCState(),this.showPhase2UI(!1),this.renderArray(),v("sandboxComparisons")&&(v("sandboxComparisons").textContent="0"),v("sandboxSwaps")&&(v("sandboxSwaps").textContent="0"),v("sandboxStepNum")&&(v("sandboxStepNum").textContent="0"),v("sandboxCurrentLine")&&(v("sandboxCurrentLine").textContent="-"),this.updateVariables();var t=this.algoInfo[this.currentAlgo];(e=t==null?void 0:t.guidance)!=null&&e[0]&&(v("sandboxGuidanceStep")&&(v("sandboxGuidanceStep").textContent=t.guidance[0].step),v("sandboxGuidanceHint")&&(v("sandboxGuidanceHint").textContent=t.guidance[0].hint))},resetDCState(){this.dcCallStack=[],this.dcRangeToNode.clear(),this.dcTreeViz&&this.dcTreeViz.reset()},pushDCFrame(t,e,i="divide"){this.dcCallStack.push({lo:t,hi:e,phase:i,entered:performance.now()}),console.log(`[D&C Stack] PUSH [${t}..${e}] phase=${i}, depth=${this.dcCallStack.length}`)},popDCFrame(){const t=this.dcCallStack.pop();return t&&console.log(`[D&C Stack] POP [${t.lo}..${t.hi}], depth=${this.dcCallStack.length}`),t},getCurrentDCFrame(){return this.dcCallStack[this.dcCallStack.length-1]||null},updateAlgoInfo(){var e;var t=this.algoInfo[this.currentAlgo];t&&(v("sandboxAlgoTitle")&&(v("sandboxAlgoTitle").textContent=t.title),v("sandboxAlgoDesc")&&(v("sandboxAlgoDesc").textContent=t.desc),v("sandboxBestCase")&&(v("sandboxBestCase").textContent=t.best),v("sandboxAvgCase")&&(v("sandboxAvgCase").textContent=t.avg),v("sandboxWorstCase")&&(v("sandboxWorstCase").textContent=t.worst),(e=t.guidance)!=null&&e[0]&&(v("sandboxGuidanceStep")&&(v("sandboxGuidanceStep").textContent=t.guidance[0].step),v("sandboxGuidanceHint")&&(v("sandboxGuidanceHint").textContent=t.guidance[0].hint)))},updateVisualizerMode(){const t=["merge","quick"],e=["linear","binary"];let i=v("sandboxVizToggle");t.includes(this.currentAlgo)?(i||(i=this.createToggleButton()),i&&(i.style.display="inline-flex",this.updateToggleButtonText()),this.visualizerMode==="search"&&(this.visualizerMode="bars"),this.applyVisualizerMode()):e.includes(this.currentAlgo)?(i&&(i.style.display="none"),this.visualizerMode="search",this.showDCTreeContainer(!1),this.canvasViz&&(this.canvasViz.renderMode="search",this.canvasViz.searchTarget=null,this.canvasViz.searchIndex=-1,this.canvasViz.checkedIndices=new Set,this.canvasViz.foundIndex=-1,this.canvasViz.render()),this.searchCheckedIndices=new Set):(i&&(i.style.display="none"),this.visualizerMode="bars",this.showDCTreeContainer(!1),this.canvasViz&&(this.canvasViz.renderMode="bars")),console.log(`[Sandbox] Visualizer mode: ${this.visualizerMode} for ${this.currentAlgo}`)},toggleVisualizerView(){var t;this.visualizerMode==="bars"?this.visualizerMode="tree":this.visualizerMode="bars",this.updateToggleButtonText(),this.applyVisualizerMode();try{localStorage.setItem("sandboxVizMode",this.visualizerMode)}catch{}(t=O==null?void 0:O.play)==null||t.call(O,"pop"),console.log(`[Sandbox] Toggled to ${this.visualizerMode} view`)},updateToggleButtonText(){const t=v("sandboxVizToggle");t&&(this.visualizerMode==="bars"?(t.innerHTML="ðŸŒ³ Tree View",t.title="Switch to D&C Tree visualization"):(t.innerHTML="ðŸ“Š Bar Graph",t.title="Switch to Bar Graph visualization"))},applyVisualizerMode(){var t;if(this.visualizerMode==="tree"){if(this.showDCTreeContainer(!0),this.initDCTreeViz(),this.dcTreeViz&&((t=this.steps)==null?void 0:t.length)>0){this.dcTreeViz.reset();const e=Math.min(this.stepIndex,this.steps.length);console.log(`[Sandbox] Replaying ${e} steps for Tree View sync`);for(let i=0;i<e;i++)this.dcTreeViz.updateFromStep(this.steps[i])}}else this.showDCTreeContainer(!1);this.refreshCurrentAnnotation()},refreshCurrentAnnotation(){var e,i,s;if(this.stepIndex<=0||!((e=this.steps)!=null&&e.length))return;const t=this.steps[Math.min(this.stepIndex-1,this.steps.length-1)];!t||!this.editor||((s=(i=this.editor).clearAnnotation)==null||s.call(i),this.visualizerMode==="tree"?this.showDCAnnotation(t):this.showBarAnnotation(t))},showDCAnnotation(t){const e=this.detectDCPhase(t);if(!e)return;const i=(t==null?void 0:t.variables)||{},s=i.lo??i.left??i.l??i.low??"?",r=i.hi??i.right??i.r??i.high??"?";console.log(`[D&C] Showing ${e} annotation at line ${t.line}`),this.editor.setAnnotation(t.line,{},{left:s,right:r},e)},showBarAnnotation(t){var e,i;if(((e=t.swapping)==null?void 0:e.length)>=2){const[s,r]=t.swapping,n=t.arrayState||this.originalArray;this.editor.setAnnotation(t.line,{},{left:n[s],right:n[r],result:!0},"swap")}else if(((i=t.comparing)==null?void 0:i.length)>=2){const[s,r]=t.comparing,n=t.arrayState||this.originalArray,a=n[s]>n[r];this.editor.setAnnotation(t.line,{},{left:n[s],right:n[r],result:a},"compare")}},createToggleButton(){const t=document.querySelector(".sandbox-viz-header");if(!t)return console.log("[Sandbox] .sandbox-viz-header not found"),null;let e=v("sandboxVizToggle");if(e)return e;e=document.createElement("button"),e.id="sandboxVizToggle",e.className="btn btn-sm",e.style.cssText=`
      font-size: 0.8rem;
      padding: 0.4rem 0.85rem;
      background: var(--accent-forest);
      border: 1px solid rgba(255,255,255,0.1);
      border-radius: 8px;
      cursor: pointer;
      color: white;
      transition: all 0.2s ease;
      margin-left: 0.75rem;
      font-weight: 600;
      box-shadow: 0 4px 6px rgba(0,0,0,0.1);
      letter-spacing: 0.3px;
    `,e.title="Toggle between Bar Graph and D&C Tree",e.innerHTML="ðŸŒ³ Tree View";const i=document.getElementById("sandboxHeaderLeft");return i?i.appendChild(e):t.prepend(e),e.addEventListener("click",()=>this.toggleVisualizerView()),console.log("[Sandbox] Created toggle button dynamically"),e},showDCTreeContainer(t){const e=v("sandboxArrayViz"),i=v("sandboxPointers"),s=document.querySelector(".sandbox-tutor-viz"),r=v("sandboxDCTreeContainer"),n=v("sandboxCanvas");if(t){if(!r&&e){const a=document.createElement("div");a.id="sandboxDCTreeContainer",a.className="sandbox-dc-tree-container",a.style.cssText=`
          background: var(--bg-card, #1a1a2e);
          border-radius: 12px;
          padding: 0.5rem;
          min-height: 200px;
          border: 1px solid var(--border-soft, #333);
        `,a.innerHTML=`
          <div class="dc-tree-header" style="display: flex; align-items: center; gap: 0.5rem; margin-bottom: 0.5rem; color: var(--text-primary, #f0f0f0); padding: 0.5rem;">
            <span style="font-size: 1rem;">ðŸŒ³</span>
            <span style="font-weight: 600; font-size: 0.9rem;">Divide & Conquer Tree</span>
          </div>
          <div id="sandboxDCTree" class="sandbox-dc-tree" style="min-height: 180px; overflow: auto;"></div>
        `,e.parentElement.insertBefore(a,e)}else r&&(r.style.display="block");e&&(e.style.display="none"),i&&(i.style.display="none"),s&&(s.style.display="none"),n&&(n.style.display="none")}else i&&(i.style.display="block"),s&&(s.style.display="grid"),v("sandboxDCTreeContainer")&&(v("sandboxDCTreeContainer").style.display="none"),this.canvasViz&&n?(n.style.display="block",e&&(e.style.display="none")):(n&&(n.style.display="none"),e&&(e.style.display="flex"))},initDCTreeViz(){const t=v("sandboxDCTree");t&&(this.dcTreeViz||(this.dcTreeViz=new I2(t),this.originalArray&&this.originalArray.length>0&&(console.log("[Sandbox] Late-Initializing Tree Viz with array:",this.originalArray),this.dcTreeViz.init(this.originalArray,this.currentAlgo))),this.dcTreeViz.init(this.originalArray,this.currentAlgo),this.dcTreeViz.start(),console.log("[D&C] Tree initialized with root node:",this.originalArray))},updateDCTreeFromStep(t){var h,d,u;if(!["merge","quick"].includes(this.currentAlgo)||!this.dcTreeViz)return;const i=(t==null?void 0:t.variables)||{};let s=i.lo??i.left??i.l??i.low,r=i.hi??i.right??i.r??i.high;const n=i.pivot,a=i.p??i.mid;if(i.i,i.j,s===void 0||r===void 0){const p=this.extractDCVarsFromCode(t);s=p.lo??s,r=p.hi??r}const o=this.getCodeLine(t==null?void 0:t.line);if(this.currentAlgo==="quick"&&s!==void 0&&r!==void 0&&(/pivot\s*=\s*arr\[/i.test(o)&&n!==void 0&&(console.log(`[D&C] Pivot selected: ${n} at index ${r}`),this.dcTreeViz.setPivot(s,r,r,n),this.dcTreeViz.colorPartitions(s,r,n)),/\bp\s*=\s*i\s*\+\s*1/.test(o)&&a!==void 0&&(console.log(`[D&C] Pivot placed at position ${a}`),this.dcTreeViz.placePivot(s,r,a,t.arrayState)),s>=r&&(console.log(`[D&C] Base case: [${s}..${r}]`),this.dcTreeViz.markComplete(s,r)),/return\s+arr/i.test(o)&&(console.log(`[D&C] Return from [${s}..${r}]`),this.dcTreeViz.markComplete(s,r))),this.currentAlgo==="merge"&&s!==void 0&&r!==void 0){const p=i.mid??i.m??Math.floor((s+r)/2);let f=this.dcTreeViz.findNode(s,r);if(!f){const g=this.dcTreeViz.findParentNode(s,r);this.dcTreeViz.addNode(g,s,r,t.arrayState),f=this.dcTreeViz.findNode(s,r),console.log(`[D&C Merge] Created node [${s}..${r}] with parent=${g}`)}if(f&&(this.dcTreeViz.currentNodeId!==null&&this.dcTreeViz.currentNodeId!==f.id&&this.dcTreeViz.nodes[this.dcTreeViz.currentNodeId]&&(this.dcTreeViz.nodes[this.dcTreeViz.currentNodeId].isActive=!1),f.isActive=!0,this.dcTreeViz.currentNodeId=f.id),/mid\s*=\s*\(?\s*lo\s*\+\s*hi\s*\)?/i.test(o)&&f&&s<r&&(console.log(`[D&C Merge] Divide: [${s}..${r}], mid=${p}`),f.phase="dividing",p>=s&&p<r&&(this.dcTreeViz.findNode(s,p)||(this.dcTreeViz.addNode(f.id,s,p,t.arrayState),console.log(`[D&C Merge] Created LEFT child [${s}..${p}] under parent [${s}..${r}]`))),p+1<=r&&(this.dcTreeViz.findNode(p+1,r)||(this.dcTreeViz.addNode(f.id,p+1,r,t.arrayState),console.log(`[D&C Merge] Created RIGHT child [${p+1}..${r}] under parent [${s}..${r}]`)))),s>=r&&f&&(console.log(`[D&C Merge] Base case: [${s}..${r}]`),f.phase="complete",f.isComplete=!0,(h=f.elements)==null||h.forEach(g=>g.state="sorted"),this.dcTreeViz.checkParentCompletion(f)),/left\s*=\s*arr\s*\[\s*lo\s*:/i.test(o)&&f){console.log(`[D&C Merge] Merge starting: [${s}..${r}]`),f.phase="conquer";const g=this.dcTreeViz.findNode(s,p),m=this.dcTreeViz.findNode(p+1,r);g&&(g.phase="merging",(d=g.elements)==null||d.forEach(y=>y.state="merging")),m&&(m.phase="merging",(u=m.elements)==null||u.forEach(y=>y.state="merging"))}if((/while\s+i\s*<\s*len\s*\(\s*left\s*\)/i.test(o)||/while\s+j\s*<\s*len\s*\(\s*right\s*\)/i.test(o))&&f&&this.dcTreeViz.updateElementsWithValues(s,r,t.arrayState),f&&f.phase==="conquer"){const g=this.dcTreeViz.findNode(s,p),m=this.dcTreeViz.findNode(p+1,r);(g!=null&&g.isComplete||s===p)&&(m!=null&&m.isComplete||p+1===r)&&this.dcTreeViz.updateElementsWithValues(s,r,t.arrayState)}this.dcTreeViz.render()}const l=this.detectDCPhase(t);if(this.visualizerMode==="tree"&&l&&this.editor&&(t!=null&&t.line)){const p=s??"?",f=r??"?";this.editor.setAnnotation(t.line,{},{left:p,right:f},l)}const c={...t,lo:s,hi:r,mid:a};this.dcTreeViz.updateFromStep(c)},getCodeLine(t){return!this.editor||!t?"":this.editor.getCode().split(`
`)[t-1]||""},extractDCVarsFromCode(t){const e={lo:void 0,hi:void 0,mid:void 0};if(!t)return e;const i=t.variables||{};if(e.lo=i.lo??i.left??i.l??i.low,e.hi=i.hi??i.right??i.r??i.high,e.mid=i.mid??i.m??i.middle??i.p,e.lo!==void 0&&e.hi!==void 0)return e;const s=this.getCurrentDCFrame();if(s&&(e.lo=e.lo??s.lo,e.hi=e.hi??s.hi),e.lo===void 0||e.hi===void 0){const r=this.parseRangeFromCode(t);e.lo=e.lo??r.lo,e.hi=e.hi??r.hi,e.mid=e.mid??r.mid}return e},parseRangeFromCode(t){const e={lo:void 0,hi:void 0,mid:void 0};if(!this.editor)return e;const s=this.editor.getCode().split(`
`),r=(t.line||1)-1,n=Math.max(0,r-4),a=Math.min(s.length-1,r+1);for(let o=n;o<=a;o++){const l=s[o],c=l.match(/\b(?:lo|left|l|low)\s*=\s*(\d+)/i),h=l.match(/\b(?:hi|right|r|high)\s*=\s*(\d+)/i),d=l.match(/(?:quick_sort|merge_sort|mergesort|quicksort)\s*\(\s*\w+\s*,\s*(\d+)\s*,\s*(\d+)/i);c&&e.lo===void 0&&(e.lo=parseInt(c[1],10)),h&&e.hi===void 0&&(e.hi=parseInt(h[1],10)),d&&e.lo===void 0&&(e.lo=parseInt(d[1],10),e.hi=parseInt(d[2],10));const u=l.match(/\b(?:mid|middle|m|p)\s*=\s*(\d+)/);u&&e.mid===void 0&&(e.mid=parseInt(u[1],10))}return e},detectDCPhase(t){if(!(t!=null&&t.line)||!this.editor)return null;const i=this.editor.getCode().split(`
`),s=t.line-1,r=i[s]||"",n=t.variables||{},a=n.lo??n.left??n.l??n.low,o=n.hi??n.right??n.r??n.high;return a!==void 0&&o!==void 0&&a>=o?"base":/\bmid\s*=/.test(r)||/\bmiddle\s*=/.test(r)||this.currentAlgo==="merge"&&/merge_?[sS]ort\s*\([^)]*,\s*\w*lo\w*\s*,\s*\w*mid\w*\s*\)/i.test(r)||this.currentAlgo==="quick"&&/quick_?[sS]ort\s*\([^)]*,\s*\w*lo\w*\s*,\s*(?:p|pivot|mid)\s*-/i.test(r)?"divide":/\bmerge\s*\(/i.test(r)&&!/merge_?[sS]ort/i.test(r)||this.currentAlgo==="merge"&&/merge_?[sS]ort\s*\([^)]*,\s*\w*mid\w*\s*\+\s*1/i.test(r)||this.currentAlgo==="quick"&&/quick_?[sS]ort\s*\([^)]*,\s*(?:p|pivot|mid)\s*\+\s*1/i.test(r)?"conquer":this.currentAlgo==="quick"&&(/pivot\s*=\s*arr\[/i.test(r)||/\bp\s*=\s*i\s*\+\s*1/.test(r)||/\bmid\s*=\s*p/.test(r))?"partition":null},exportExecutionTrace(){if(!this.executionEngine){T("âš ï¸ No execution history to export","warning");return}var t=this.executionEngine.getHistory();if(!t||t.length===0){T("âš ï¸ No steps recorded yet. Run the algorithm first.","warning");return}var e={metadata:{algorithm:this.currentAlgo,language:this.currentLang,timestamp:new Date().toISOString(),totalSteps:t.length,originalArray:this.originalArray,finalArray:this.currentArray},summary:{comparisons:this.stats.comparisons,swaps:this.stats.swaps},steps:t.map((n,a)=>({step:a+1,line:n.line,array:n.array,comparing:n.comparing,swapping:n.swapping,variables:n.variables,stats:n.stats}))},i=new Blob([JSON.stringify(e,null,2)],{type:"application/json"}),s=URL.createObjectURL(i),r=document.createElement("a");r.href=s,r.download=`execution_trace_${this.currentAlgo}_${Date.now()}.json`,document.body.appendChild(r),r.click(),document.body.removeChild(r),URL.revokeObjectURL(s),T("âœ… Execution trace exported!","success")},updateExecutionModeBadge(){var t=v("executionModeBadge");if(t){var e=this.currentLang==="js"||this.currentLang==="javascript"||this.currentLang==="python"||this.currentLang==="java";e?(t.innerHTML="â–¶ï¸ Live Execution",t.style.background="linear-gradient(90deg, #10b981, #34d399)",t.style.color="#0a0a0f"):(t.innerHTML="ðŸ“ Template Preview",t.style.background="linear-gradient(90deg, #f59e0b, #fbbf24)",t.style.color="#0a0a0f")}},transpilePythonToJS(t){let e=t;e=e.replace(/def\s+(\w+)\s*\(([^)]*)\)\s*:/g,"function $1($2) {"),e=e.replace(/#(.*)$/gm,"//$1"),e=e.replace(/print\s*\(/g,"console.log("),e=e.replace(/len\s*\(\s*(\w+)\s*\)/g,"$1.length"),e=e.replace(/for\s+(\w+)\s+in\s+range\s*\(\s*0\s*,\s*([^)]+)\s*\)\s*:/g,"for (var $1 = 0; $1 < $2; $1++) {"),e=e.replace(/for\s+(\w+)\s+in\s+range\s*\(\s*(\d+)\s*,\s*([^)]+)\s*\)\s*:/g,"for (var $1 = $2; $1 < $3; $1++) {"),e=e.replace(/for\s+(\w+)\s+in\s+range\s*\(\s*([^,)]+)\s*\)\s*:/g,"for (var $1 = 0; $1 < $2; $1++) {"),e=e.replace(/if\s+(.+?):\s*$/gm,"if ($1) {"),e=e.replace(/elif\s+(.+?):\s*$/gm,"} else if ($1) {"),e=e.replace(/else\s*:\s*$/gm,"} else {"),e=e.replace(/while\s+(.+?):\s*$/gm,"while ($1) {"),e=e.replace(/(\w+)\[([^\]]+)\]\s*,\s*(\w+)\[([^\]]+)\]\s*=\s*(\w+)\[([^\]]+)\]\s*,\s*(\w+)\[([^\]]+)\]/g,function(d,u,p,f,g,m,y,b,w){return`var _temp = ${u}[${p}]; ${u}[${p}] = ${m}[${y}]; ${f}[${g}] = _temp`}),e=e.replace(/\s+and\s+/g," && "),e=e.replace(/\s+or\s+/g," || "),e=e.replace(/\s+not\s+/g," !"),e=e.replace(/\bTrue\b/g,"true"),e=e.replace(/\bFalse\b/g,"false"),e=e.replace(/\bNone\b/g,"null"),e=e.replace(/^(\s*)(\w+)\s*=\s*([^=])/gm,function(d,u,p,f){return p==="arr"||p==="_temp"?d:`${u}var ${p} = ${f}`});for(var i=e.split(`
`),s=[],r=[0],n=0;n<i.length;n++){for(var a=i[n],o=a.trimStart(),l=a.length-o.length;r.length>1&&l<r[r.length-1];)r.pop(),s.push(" ".repeat(r[r.length-1])+"}");o.endsWith("{")&&r.push(l+2),s.push(a)}for(;r.length>1;)r.pop(),s.push("}");e=s.join(`
`),e=e.replace(/:\s*(int|float|str|bool|list|dict)\s*=/g," =");var c=e.match(/function\s+(\w+)\s*\(/),h=/\w+\s*\(\s*arr\s*\)\s*;?\s*$/.test(e.trim());return c&&!h&&(e+=`
${c[1]}(arr);`),e},async runWithPythonTranspilation(t){var e,i,s;if(this.steps.length>0&&this.stepIndex>0&&this.stepIndex<this.steps.length&&!this.sortingComplete){console.log("[Sandbox] Resuming Python from step",this.stepIndex),this.beginAutoPlay();return}try{if(console.log("[Sandbox] Starting Python execution with Skulpt..."),v("sandboxGuidanceHint")&&(v("sandboxGuidanceHint").textContent="ðŸ Loading Python interpreter..."),(e=v("sandboxRun"))==null||e.setAttribute("disabled","true"),this.skulptLoading=!0,this.pythonEngine=new ng(t,this.originalArray),await this.pythonEngine.init(),this.steps=await this.pythonEngine.generateSteps(),this.steps=dg(this.steps),this.stepIndex=0,this.skulptLoading=!1,(i=v("sandboxRun"))==null||i.removeAttribute("disabled"),this.steps.length===0){T("âš ï¸ No visualization steps generated from Python code","warning"),this.generateStepsFallback(),this.beginAutoPlay();return}this.stats=this.steps[this.steps.length-1].stats||{comparisons:0,swaps:0},console.log(`[Sandbox] Python execution complete: ${this.steps.length} steps generated`),v("sandboxGuidanceHint")&&(v("sandboxGuidanceHint").textContent="ðŸ Python code executed! Visualizing..."),T(`âœ… Python code executed! ${this.steps.length} steps`,"success"),this.visualizerMode==="tree"&&this.dcTreeViz&&(this.dcTreeViz.resetWithArray(this.originalArray),console.log("[Sandbox] D&C tree initialized for",this.currentAlgo)),this.beginAutoPlay()}catch(r){if(console.error("[Sandbox] Python execution failed:",r),this.skulptLoading=!1,(s=v("sandboxRun"))==null||s.removeAttribute("disabled"),console.warn("[Sandbox] Python failed, falling back to JavaScript step generation"),this.generateStepsFallback(),this.steps.length>0){const n=v("sandboxErrorPanel");n&&(n.style.display="none"),v("sandboxGuidanceHint")&&(v("sandboxGuidanceHint").textContent="âš¡ Running with JavaScript simulation"),this.beginAutoPlay()}else this.showPythonError(r),v("sandboxGuidanceHint")&&(v("sandboxGuidanceHint").innerHTML=`
            <span style="color: #ef4444; font-weight: 600;">âš ï¸ Code Error!</span><br>
            Fix your code and click Run again.
          `)}},async runWithJavaEngine(t){var e,i,s,r;try{if(console.log("[Sandbox] Starting Java execution with JavaExecutionEngine..."),console.log(`[Sandbox] Executing code:
`,t.substring(0,200)+"..."),this.steps=[],this.stepIndex=0,this.javaEngine=null,v("sandboxGuidanceHint")&&(v("sandboxGuidanceHint").textContent="â˜• Transpiling Java code..."),(e=v("sandboxRun"))==null||e.setAttribute("disabled","true"),this.javaEngine=new lg(t,this.originalArray),!await this.javaEngine.init())throw this.javaEngine.getError()||new Error("Java execution failed");if(this.steps=this.javaEngine.steps||[],this.stepIndex=0,(i=v("sandboxRun"))==null||i.removeAttribute("disabled"),this.steps.length===0){T("âš ï¸ No visualization steps generated from Java code","warning");return}this.stats=this.steps[this.steps.length-1].stats||{comparisons:0,swaps:0},console.log(`[Sandbox] Java execution complete: ${this.steps.length} steps generated`),v("sandboxGuidanceHint")&&(v("sandboxGuidanceHint").textContent="â˜• Java code executed! Visualizing..."),T(`âœ… Java code executed! ${this.steps.length} steps`,"success"),this.visualizerMode==="tree"&&this.dcTreeViz&&(this.dcTreeViz.resetWithArray(this.originalArray),console.log("[Sandbox] D&C tree initialized for",this.currentAlgo)),this.beginAutoPlay()}catch(n){console.error("[Sandbox] Java execution failed:",n),(s=v("sandboxRun"))==null||s.removeAttribute("disabled"),T(`âŒ Java Error: ${n.message}`,"error"),(r=O==null?void 0:O.play)==null||r.call(O,"error"),v("sandboxGuidanceHint")&&(v("sandboxGuidanceHint").innerHTML=`
          <span style="color: #ef4444; font-weight: 600;">âš ï¸ Java Error!</span><br>
          ${n.message||"Check your code syntax."}
        `);return}},showPythonError(t){var g,m;const e=v("sandboxErrorPanel");if(!e)return;let i;(g=this.pythonEngine)!=null&&g.parseError?i=this.pythonEngine.parseError(t):i=this.parseErrorManual(t),console.log("[Sandbox] Parsed error:",i),e.style.display="block";const s=v("errorTypeLabel");s&&(s.textContent=i.type);const r=v("errorLineNum");r&&(r.textContent=i.originalLine||"?");const n=this.generateDynamicErrorDetails(i),a=v("errorMessage");a&&(a.textContent=n.message);const o=v("errorCodeContext"),l=v("errorCodeLine"),c=v("errorArrayInfo");o&&n.showCodeContext?(o.style.display="block",l&&(l.textContent=n.codeLine),c&&(c.textContent=n.arrayInfo)):o&&(o.style.display="none");const h=v("errorExplanation");h&&n.explanation?(h.textContent=n.explanation,h.style.display="block"):h&&(h.style.display="none");const d=v("errorSuggestion"),u=v("errorSuggestionText"),p=v("errorFixCode");d&&n.suggestion?(d.style.display="block",u&&(u.textContent=n.suggestion),p&&n.fixCode?(p.textContent=n.fixCode,p.style.display="block"):p&&(p.style.display="none")):d&&(d.style.display="none"),i.originalLine&&this.editor&&this.editor.showError(i.originalLine),T(`âŒ ${i.type}: Check the error panel for details`,"error"),(m=O==null?void 0:O.play)==null||m.call(O,"error");const f=v("errorDismissBtn");f&&(f.onclick=()=>this.clearPythonError())},parseErrorManual(t){const e=t.toString(),i={type:"Error",message:t.message||e,originalLine:null,sourceText:"",rawError:e,arrayInfo:{length:this.originalArray.length,indices:`0-${this.originalArray.length-1}`}},s=[{pattern:/IndexError/i,type:"IndexError"},{pattern:/SyntaxError/i,type:"SyntaxError"},{pattern:/NameError/i,type:"NameError"},{pattern:/TypeError/i,type:"TypeError"},{pattern:/ValueError/i,type:"ValueError"},{pattern:/ZeroDivisionError/i,type:"ZeroDivisionError"}];for(const{pattern:n,type:a}of s)if(n.test(e)){i.type=a;break}const r=e.match(/line\s+(\d+)/i);if(r){const n=parseInt(r[1]);i.originalLine=Math.max(1,Math.min(n-80,10))}return i},generateDynamicErrorDetails(t){var n;const e=((n=this.originalArray)==null?void 0:n.length)||7,i=t.rawError||"",s=t.sourceText||"",r={message:"",codeLine:s,arrayInfo:`${e} elements (valid indices: 0-${e-1})`,explanation:"",suggestion:"",fixCode:"",showCodeContext:!1};switch(t.type){case"IndexError":{const a=s.match(/arr\[([^\]]+)\]/),o=a?a[1]:"?";if(r.message="Array index out of bounds",r.codeLine=s||`arr[${o}]`,r.showCodeContext=!0,r.explanation=`You tried to access an array element at an index that doesn't exist. Your array has ${e} elements, so valid indices are 0 through ${e-1}. The expression '${o}' evaluated to a value outside this range.`,o.includes("+")){const l=o.match(/(\w+)\s*\+\s*(\d+)/);l&&(r.suggestion=`The offset ${l[2]} is too large. In bubble sort, you typically compare adjacent elements.`,r.fixCode=`arr[${l[1]} + 1]  # Compare with the next element`)}else r.suggestion="Make sure your loop bounds prevent accessing beyond the array size.",r.fixCode="for j in range(n - i - 1):  # Ensures j+1 is always valid";break}case"SyntaxError":{r.message="Python syntax error in your code",r.showCodeContext=!!s;const a=i.match(/bad token\s*'(.+?)'/i),o=i.match(/unexpected\s+(\S+)/i);a?r.explanation=`Python found an unexpected character: '${a[1]}'. This usually means there's a typo or missing punctuation near this location.`:o?r.explanation=`Python encountered something unexpected: '${o[1]}'. Check the structure of your code around this line.`:r.explanation="Python couldn't parse your code structure. Common causes include: missing colons after 'for', 'if', 'def', 'while'; mismatched parentheses or brackets; incorrect indentation.",r.suggestion="Check these common Python syntax requirements:",r.fixCode=`def function_name():  # Colon required after def
    for i in range(n):  # Colon required after for
        if condition:     # Colon required after if
            # 4 spaces indentation`;break}case"NameError":{const a=i.match(/name\s+['"](\w+)['"]/i),o=a?a[1]:"unknown";r.message=`Variable '${o}' is not defined`,r.showCodeContext=!!s,r.explanation=`You tried to use a variable called '${o}', but Python doesn't know what it is. This happens when you: (1) misspelled the variable name, (2) forgot to define it before using it, or (3) defined it inside a function but tried to use it outside.`,r.suggestion=`Make sure '${o}' is defined before you use it.`,r.fixCode=`${o} = 0  # Define the variable first
# Or check if you meant a different variable name`;break}case"TypeError":{r.message="Type mismatch in your code",r.showCodeContext=!!s,r.explanation="Python tried to perform an operation on incompatible types. For example, you can't add a string to a number directly, or compare different types in certain ways.",r.suggestion="Ensure you're working with consistent types.",r.fixCode=`# Example: Convert types when needed
int("5")      # String to integer
str(42)       # Integer to string
float("3.14") # String to float`;break}case"ZeroDivisionError":{r.message="Division by zero",r.showCodeContext=!!s,r.explanation="Your code attempted to divide a number by zero, which is mathematically undefined.",r.suggestion="Add a check to prevent division by zero.",r.fixCode=`if divisor != 0:
    result = value / divisor
else:
    result = 0  # Or handle appropriately`;break}default:{r.message=t.message||"An error occurred",r.showCodeContext=!!s,r.explanation="An error occurred while executing your Python code. Check the error message above for more details.",r.suggestion="Review your code for potential issues.";break}}return r},clearPythonError(){const t=v("sandboxErrorPanel");t&&(t.style.display="none"),this.editor&&this.editor.clearError()},beginAutoPlay(){var s,r,n;this.playInterval&&(clearInterval(this.playInterval),this.playInterval=null),this.isPlaying=!0,this.sortingComplete=!1,(s=v("sandboxRun"))==null||s.classList.add("section-hidden"),(r=v("sandboxPause"))==null||r.classList.remove("section-hidden");var t=parseInt(((n=v("sandboxSpeed"))==null?void 0:n.value)||5),e=1e3/t,i=this;this.playInterval=setInterval(async function(){var o,l,c;if(!i.isPlaying||i.sortingComplete){clearInterval(i.playInterval),i.playInterval=null;return}try{var a=await i.step();if(!a&&!i.sortingComplete){if(i.sortingComplete=!0,i.pause(),["linear","binary"].includes(i.currentAlgo)){const d=i.steps[i.steps.length-1],u=(d==null?void 0:d.target)??((o=d==null?void 0:d.variables)==null?void 0:o.target),p=((l=d==null?void 0:d.variables)==null?void 0:l.result)??-1;u!==void 0?cg(p,u):T("Search complete","info")}else go(i.currentArray,i.originalArray);(c=O==null?void 0:O.play)==null||c.call(O,"success")}}catch(h){console.error("[Sandbox] Step error:",h),i.sortingComplete=!0,i.pause(),T("âŒ Execution error","error")}},e)}};if(typeof document<"u"){var ug=()=>{v("sandboxEditorMount")&&eu.init()};document.readyState==="loading"?document.addEventListener("DOMContentLoaded",ug):setTimeout(ug,100)}typeof window<"u"&&(window.SandboxController=eu,console.log("[Sandbox] Controller exposed globally"));typeof window<"u"&&(window.SandboxController=eu);const ge={lectures:new Map,register(t){this.lectures.set(t.id,t)},get(t){return this.lectures.get(t)},getByCourse(t){return Array.from(this.lectures.values()).filter(e=>e.course===t)},getAll(){return Array.from(this.lectures.values())},getNextInPath(t){const e=this.get(t);if(!e)return null;const i=this.getByCourse(e.course),s=i.findIndex(r=>r.id===t);return i[s+1]||null}};typeof window<"u"&&(window.LectureLibrary=ge);const De={state:{lecture:null,currentStep:0,isPlaying:!1,isPaused:!1,speed:1,userScore:0,startTime:null,currentSide:"code",customInput:null},stepTimeout:null,visualizerInitialized:!1,inputPresets:{random:(t=7)=>Array.from({length:t},()=>Math.floor(Math.random()*99)+1),sorted:(t=7)=>Array.from({length:t},(e,i)=>(i+1)*10),reverse:(t=7)=>Array.from({length:t},(e,i)=>(t-i)*10),same:(t=7)=>Array.from({length:t},()=>42),twoElements:()=>[Math.floor(Math.random()*99)+1,Math.floor(Math.random()*99)+1]},validateArrayInput(t){if(typeof t=="string"){const e=t.split(",").map(i=>parseInt(i.trim())).filter(i=>!isNaN(i));return e.length<2?{valid:!1,error:"Need at least 2 elements"}:e.length>15?{valid:!1,error:"Maximum 15 elements"}:e.some(i=>i<1||i>999)?{valid:!1,error:"Values must be 1-999"}:{valid:!0,data:e}}return Array.isArray(t)?t.length<2?{valid:!1,error:"Need at least 2 elements"}:t.length>15?{valid:!1,error:"Maximum 15 elements"}:{valid:!0,data:t}:{valid:!1,error:"Invalid input format"}},applyCustomInput(t){const e=this.validateArrayInput(t);return e.valid?(this.state.customInput=e.data,this.state.lecture&&this.state.lecture.steps&&this.state.lecture.steps.forEach(i=>{i.visualState&&i.visualState.array&&(i.visualState.array=[...e.data])}),this.state.currentStep=0,this.state.answeredChallenges=new Set,this.pause(),this.render(),T(`Applied custom input: [${e.data.join(", ")}]`,"success"),!0):(T(e.error,"error"),!1)},applyPreset(t,e=7){const i=this.inputPresets[t];if(!i)return T("Unknown preset","error"),!1;const s=i(e);return this.applyCustomInput(s)},showCustomInputPanel(){const t=document.getElementById("eLectureCustomInputPanel");t&&(t.style.display="block")},hideCustomInputPanel(){const t=document.getElementById("eLectureCustomInputPanel");t&&(t.style.display="none")},codeStepper:{currentLine:0,breakpoints:new Set,isPaused:!1,keywords:["function","const","let","var","if","else","for","while","return","break","continue","switch","case","default","new","class","extends","import","export","async","await","try","catch","throw"],highlightSyntax(t){return t?t.replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/(\/\/.*$)/gm,'<span class="code-comment">$1</span>').replace(/(".*?"|'.*?'|`.*?`)/g,'<span class="code-string">$1</span>').replace(/\b(\d+)\b/g,'<span class="code-number">$1</span>').replace(new RegExp(`\\b(${this.keywords.join("|")})\\b`,"g"),'<span class="code-keyword">$1</span>').replace(/\b([a-zA-Z_][a-zA-Z0-9_]*)\s*\(/g,'<span class="code-function">$1</span>('):""},setLine(t){this.currentLine=t,this.updateLineHighlight()},updateLineHighlight(){document.querySelectorAll(".code-line").forEach((e,i)=>{e.classList.remove("active","executed"),i<this.currentLine&&e.classList.add("executed"),i===this.currentLine&&e.classList.add("active")})},toggleBreakpoint(t){this.breakpoints.has(t)?this.breakpoints.delete(t):this.breakpoints.add(t),this.updateBreakpointUI()},updateBreakpointUI(){document.querySelectorAll(".code-line").forEach((e,i)=>{e.classList.toggle("has-breakpoint",this.breakpoints.has(i))})},shouldPause(){return this.breakpoints.has(this.currentLine)},renderCode(t){if(!t)return'<div class="no-code">No code view for this step</div>';const e=t.split(`
`);return`
        <div class="code-container">
          <div class="code-header">
            <span>ðŸ“ Algorithm Code</span>
            <button class="code-copy-btn" onclick="navigator.clipboard.writeText(\`${t.replace(/`/g,"\\`")}\`); showToast('Code copied!', 'success');">ðŸ“‹ Copy</button>
          </div>
          <div class="code-lines">
            ${e.map((i,s)=>`
              <div class="code-line ${s===this.currentLine?"active":""} ${this.breakpoints.has(s)?"has-breakpoint":""}" 
                   onclick="ELectureEngineV5.codeStepper.toggleBreakpoint(${s})">
                <span class="line-number">${s+1}</span>
                <span class="line-content">${this.highlightSyntax(i)}</span>
                <span class="breakpoint-dot" title="Toggle breakpoint"></span>
              </div>
            `).join("")}
          </div>
        </div>
      `},reset(){this.currentLine=0,this.isPaused=!1}},variablePanel:{variables:{},history:[],maxHistory:50,set(t,e,i="auto"){const s=this.variables[t],r=JSON.stringify(s==null?void 0:s.value)!==JSON.stringify(e);this.variables[t]={value:e,type:i==="auto"?this.detectType(e):i,changed:r,timestamp:Date.now()},r&&(this.history.unshift({name:t,oldValue:s==null?void 0:s.value,newValue:e,timestamp:Date.now()}),this.history.length>this.maxHistory&&this.history.pop()),this.update()},detectType(t){return Array.isArray(t)?"array":typeof t=="object"&&t!==null?"object":typeof t},formatValue(t,e){return e==="array"?`[${t.join(", ")}]`:e==="object"?JSON.stringify(t,null,2):String(t)},render(){const t=Object.entries(this.variables);return t.length===0?'<div class="var-panel-empty">Variables will appear here during execution</div>':`
        <div class="var-panel">
          <div class="var-panel-header">
            <span>ðŸ” Variables</span>
            <span class="var-count">${t.length}</span>
          </div>
          <div class="var-list">
            ${t.map(([e,i])=>`
              <div class="var-item ${i.changed?"changed":""}">
                <span class="var-name">${e}</span>
                <span class="var-type">${i.type}</span>
                <span class="var-value">${this.formatValue(i.value,i.type)}</span>
              </div>
            `).join("")}
          </div>
          ${this.history.length>0?`
            <div class="var-history">
              <div class="history-header">ðŸ“œ Recent Changes</div>
              ${this.history.slice(0,5).map(e=>`
                <div class="history-item">
                  <span class="history-var">${e.name}</span>
                  <span class="history-change">${this.formatValue(e.oldValue,"auto")} â†’ ${this.formatValue(e.newValue,"auto")}</span>
                </div>
              `).join("")}
            </div>
          `:""}
        </div>
      `},update(){const t=document.getElementById("eLectureVarPanel");t&&(t.innerHTML=this.render())},clear(){this.variables={},this.history=[],this.update()},parseFromStep(t){if(!(t!=null&&t.visualState))return;const e=t.visualState;e.array&&this.set("array",e.array,"array"),e.i!==void 0&&this.set("i",e.i,"number"),e.j!==void 0&&this.set("j",e.j,"number"),e.left!==void 0&&this.set("left",e.left,"number"),e.right!==void 0&&this.set("right",e.right,"number"),e.pivot!==void 0&&this.set("pivot",e.pivot,"number"),e.minIndex!==void 0&&this.set("minIndex",e.minIndex,"number"),e.comparing&&this.set("comparing",e.comparing,"array"),e.swapping&&this.set("swapping",e.swapping,"array"),e.sorted&&this.set("sorted",e.sorted,"array")}},practiceMode:{isActive:!1,currentProblem:null,score:0,streak:0,maxStreak:0,xp:0,level:1,timer:null,timeLimit:60,timeRemaining:60,achievements:{firstSolve:{name:"First Steps",desc:"Solve your first problem",icon:"ðŸŽ¯",earned:!1},streak3:{name:"On a Roll",desc:"3 correct in a row",icon:"ðŸ”¥",earned:!1},streak5:{name:"Unstoppable",desc:"5 correct in a row",icon:"âš¡",earned:!1},speedster:{name:"Speedster",desc:"Solve in under 15 seconds",icon:"â±ï¸",earned:!1},perfectTen:{name:"Perfect 10",desc:"Score 10 in one session",icon:"ðŸ†",earned:!1},centurion:{name:"Centurion",desc:"Earn 100 XP",icon:"ðŸ’¯",earned:!1}},problemTypes:{swapPredict:{name:"Predict Swap",xp:10,difficulty:"easy"},comparePredict:{name:"Predict Compare",xp:10,difficulty:"easy"},pivotSelect:{name:"Select Pivot",xp:15,difficulty:"medium"},stepsCount:{name:"Count Steps",xp:20,difficulty:"medium"},bigO:{name:"Big-O",xp:25,difficulty:"hard"}},generateProblem(t="bubbleSort"){const e=Object.keys(this.problemTypes),i=e[Math.floor(Math.random()*e.length)],s=5+Math.floor(Math.random()*4),r=Array.from({length:s},()=>Math.floor(Math.random()*50)+1);let n={type:i,algorithm:t,array:r,question:"",options:[],correctIndex:0,xp:this.problemTypes[i].xp};switch(i){case"swapPredict":n.question=`In Bubble Sort, will ${r[0]} and ${r[1]} be swapped in the first pass?`,n.options=["Yes","No"],n.correctIndex=r[0]>r[1]?0:1;break;case"comparePredict":const a=Math.floor(Math.random()*(r.length-1));n.question=`Which is larger: arr[${a}]=${r[a]} or arr[${a+1}]=${r[a+1]}?`,n.options=[`arr[${a}]`,`arr[${a+1}]`,"Equal"],n.correctIndex=r[a]>r[a+1]?0:r[a]<r[a+1]?1:2;break;case"stepsCount":n.question=`Bubble Sort needs at most how many comparisons for an array of ${s} elements?`;const o=s,l=o*(o-1)/2;n.options=[String(l),String(l-o),String(l+o),String(o*o)],n.correctIndex=0;break;case"bigO":n.question="What is the average time complexity of Bubble Sort?",n.options=["O(n)","O(n log n)","O(nÂ²)","O(2â¿)"],n.correctIndex=2;break;default:n.question=`Which element is the minimum: ${r.slice(0,3).join(", ")}?`;const c=Math.min(...r.slice(0,3));n.options=r.slice(0,3).map(String),n.correctIndex=r.slice(0,3).indexOf(c)}return this.currentProblem=n,n},start(){this.isActive=!0,this.score=0,this.streak=0,this.timeRemaining=this.timeLimit,this.generateProblem(),this.startTimer(),this.render(),T("Practice Mode Started! ðŸŽ¯","success")},startTimer(){this.timer=setInterval(()=>{this.timeRemaining--,this.updateTimerDisplay(),this.timeRemaining<=0&&this.end()},1e3)},updateTimerDisplay(){const t=document.getElementById("practiceTimer");t&&(t.textContent=`â±ï¸ ${this.timeRemaining}s`,this.timeRemaining<=10&&t.classList.add("warning"))},submit(t){if(!this.currentProblem)return;const e=t===this.currentProblem.correctIndex,i=this.timeLimit-this.timeRemaining;e?(this.score++,this.streak++,this.maxStreak=Math.max(this.maxStreak,this.streak),this.xp+=this.currentProblem.xp,this.achievements.firstSolve.earned||(this.achievements.firstSolve.earned=!0,this.showAchievement("firstSolve")),this.streak>=3&&!this.achievements.streak3.earned&&(this.achievements.streak3.earned=!0,this.showAchievement("streak3")),this.streak>=5&&!this.achievements.streak5.earned&&(this.achievements.streak5.earned=!0,this.showAchievement("streak5")),i<=15&&!this.achievements.speedster.earned&&(this.achievements.speedster.earned=!0,this.showAchievement("speedster")),this.score>=10&&!this.achievements.perfectTen.earned&&(this.achievements.perfectTen.earned=!0,this.showAchievement("perfectTen")),this.xp>=100&&!this.achievements.centurion.earned&&(this.achievements.centurion.earned=!0,this.showAchievement("centurion")),T(`âœ… Correct! +${this.currentProblem.xp} XP`,"success")):(this.streak=0,T("âŒ Wrong! Streak reset","error")),this.generateProblem(),this.render()},showAchievement(t){const e=this.achievements[t],i=document.createElement("div");i.className="achievement-popup",i.innerHTML=`
        <span class="ach-icon">${e.icon}</span>
        <div class="ach-info">
          <div class="ach-name">${e.name}</div>
          <div class="ach-desc">${e.desc}</div>
        </div>
      `,document.body.appendChild(i),setTimeout(()=>i.remove(),3e3)},end(){clearInterval(this.timer),this.isActive=!1,this.renderResults(),T(`Practice ended! Score: ${this.score}, XP: ${this.xp}`,"info")},render(){const t=document.getElementById("practiceModePanel");!t||!this.currentProblem||(t.innerHTML=`
        <div class="practice-panel">
          <div class="practice-header">
            <span>ðŸŽ¯ Practice Mode</span>
            <span id="practiceTimer" class="${this.timeRemaining<=10?"warning":""}">â±ï¸ ${this.timeRemaining}s</span>
            <button class="btn-end-practice" onclick="ELectureEngineV5.practiceMode.end()">End</button>
          </div>
          <div class="practice-stats">
            <span>Score: ${this.score}</span>
            <span>ðŸ”¥ ${this.streak}</span>
            <span>â­ ${this.xp} XP</span>
          </div>
          <div class="practice-question">${this.currentProblem.question}</div>
          <div class="practice-array">[${this.currentProblem.array.join(", ")}]</div>
          <div class="practice-options">
            ${this.currentProblem.options.map((e,i)=>`
              <button class="practice-option" onclick="ELectureEngineV5.practiceMode.submit(${i})">${e}</button>
            `).join("")}
          </div>
        </div>
      `)},renderResults(){const t=document.getElementById("practiceModePanel");if(!t)return;const e=Object.entries(this.achievements).filter(([i,s])=>s.earned);t.innerHTML=`
        <div class="practice-results">
          <h3>ðŸ† Practice Complete!</h3>
          <div class="results-stats">
            <div class="stat-item"><span class="stat-value">${this.score}</span><span class="stat-label">Score</span></div>
            <div class="stat-item"><span class="stat-value">${this.maxStreak}</span><span class="stat-label">Max Streak</span></div>
            <div class="stat-item"><span class="stat-value">${this.xp}</span><span class="stat-label">XP Earned</span></div>
          </div>
          ${e.length>0?`
            <div class="results-achievements">
              <h4>Achievements Unlocked!</h4>
              ${e.map(([i,s])=>`<span class="ach-badge">${s.icon} ${s.name}</span>`).join("")}
            </div>
          `:""}
          <button class="btn-restart-practice" onclick="ELectureEngineV5.practiceMode.start()">Try Again</button>
        </div>
      `}},async load(t){const e=ge.get(t);return e?(this.state={lecture:e,currentStep:0,isPlaying:!1,isPaused:!1,speed:1,userScore:0,startTime:Date.now(),currentLanguage:"python",currentSide:"code",answeredChallenges:new Set},this.visualizerInitialized=!1,this.render(),ScreenReaderAnnouncer.announce(`Loaded lecture: ${e.title}`),e):(T(`Lecture not found: ${t}`,"error"),null)},async start(t){await this.load(t),this.showLecturePlayer(),this.showStartOverlay()},showStartOverlay(){const t=document.getElementById("eLectureVisualizer"),e=t?t.closest(".electure-flip-side"):document.querySelector(".electure-visual-side");if(!e)return;const i=document.getElementById("eLectureStartOverlay");i&&i.remove();const s=document.createElement("div");s.id="eLectureStartOverlay",s.className="electure-start-overlay",s.innerHTML=`
      <div class="start-btn-container">
        <button class="electure-big-play-btn" onclick="ELectureEngineV5.hideStartOverlay(); ELectureEngineV5.play()">
          <span class="big-play-icon">â–¶</span>
          <span class="big-play-text">Start Lecture</span>
        </button>
      </div>
    `;const r=document.getElementById("eLectureFlipCard");r?r.appendChild(s):e.appendChild(s)},hideStartOverlay(){const t=document.getElementById("eLectureStartOverlay");t&&(t.classList.add("fading-out"),setTimeout(()=>t.remove(),500))},showLecturePlayer(){let t=document.getElementById("eLecturePlayerOverlay");t||(t=document.createElement("div"),t.id="eLecturePlayerOverlay",t.className="electure-v5-overlay",document.body.appendChild(t)),t.classList.add("active"),this.render()},play(){this.state.lecture&&(this.state.isPlaying=!0,this.state.isPaused=!1,this.updateControls(),this.executeStep(this.state.currentStep))},pause(){this.state.isPaused=!0,this.state.isPlaying=!1,this.updateControls(),V.stop(),this.stepTimeout&&clearTimeout(this.stepTimeout),this.challengeTimeout&&clearTimeout(this.challengeTimeout)},togglePlay(){this.state.isPlaying&&!this.state.isPaused?this.pause():this.play()},next(){this.stepTimeout&&clearTimeout(this.stepTimeout),this.challengeTimeout&&clearTimeout(this.challengeTimeout),this.hideChallenge(),V.stop();const t=this.state.isPlaying&&!this.state.isPaused;this.state.currentStep<this.state.lecture.steps.length-1?(this.state.currentStep++,t?this.executeStep(this.state.currentStep):this.executeStepManual(this.state.currentStep)):this.complete()},prev(){this.stepTimeout&&clearTimeout(this.stepTimeout),this.challengeTimeout&&clearTimeout(this.challengeTimeout),this.hideChallenge(),V.stop();const t=this.state.isPlaying&&!this.state.isPaused;this.state.currentStep>0&&(this.state.currentStep--,t?this.executeStep(this.state.currentStep):this.executeStepManual(this.state.currentStep))},goToStep(t){this.stepTimeout&&clearTimeout(this.stepTimeout),t>=0&&t<this.state.lecture.steps.length&&(this.state.currentStep=t,this.executeStep(t))},setSpeed(t){this.state.speed=Math.max(.25,Math.min(4,t)),this.updateControls(),this.updateSpeedDisplay()},getCurrentCodeSource(){var e;const t=this.state.lecture;if(!t||!t.code)return"";if(t.code.languages){const i=this.state.currentLanguage||"python";return((e=t.code.languages[i])==null?void 0:e.source)||""}return t.code.source||""},getCurrentHighlightRanges(){var e;const t=this.state.lecture;if(!t||!t.code)return{};if(t.code.languages){const i=this.state.currentLanguage||"python";return((e=t.code.languages[i])==null?void 0:e.highlightRanges)||{}}return t.code.highlightRanges||{}},switchLanguage(t){if(this.state.currentLanguage===t)return;this.state.currentLanguage=t,this.render();const e=this.state.lecture.steps[this.state.currentStep];e!=null&&e.codeHighlight&&this.highlightCode(e.codeHighlight)},availableSpeeds:[.25,.5,.75,1,1.5,2,3,4],increaseSpeed(){const t=this.availableSpeeds.indexOf(this.state.speed);if(t<this.availableSpeeds.length-1)this.setSpeed(this.availableSpeeds[t+1]);else if(t===-1){const e=this.availableSpeeds.find(i=>i>this.state.speed);e&&this.setSpeed(e)}},decreaseSpeed(){const t=this.availableSpeeds.indexOf(this.state.speed);if(t>0)this.setSpeed(this.availableSpeeds[t-1]);else if(t===-1){const e=[...this.availableSpeeds].reverse().find(i=>i<this.state.speed);e&&this.setSpeed(e)}},first(){this.stepTimeout&&clearTimeout(this.stepTimeout),this.challengeTimeout&&clearTimeout(this.challengeTimeout),this.hideChallenge(),V.stop(),this.state.currentStep=0,this.state.isPlaying&&!this.state.isPaused?this.executeStep(0):this.executeStepManual(0)},last(){this.stepTimeout&&clearTimeout(this.stepTimeout),this.challengeTimeout&&clearTimeout(this.challengeTimeout),this.hideChallenge(),V.stop();const t=this.state.lecture.steps.length-1;this.state.currentStep=t,this.state.isPlaying&&!this.state.isPaused?this.executeStep(t):this.executeStepManual(t)},updateSpeedDisplay(){const t=document.getElementById("eLectureSpeedLabel");t&&(t.textContent=this.state.speed+"x");const e=document.getElementById("eLectureSpeedSlider");if(e){const i=this.availableSpeeds.indexOf(this.state.speed);i!==-1&&(e.value=i)}},async executeStep(t){const e=this.state.lecture.steps[t];if(!e)return;if(this.updateProgress(),e.showSide&&e.showSide!==this.state.currentSide)await this.flipTo(e.showSide);else{const n=this.state.lecture.steps[t-1];if(this.shouldFlip(n,e)){const o=e.type==="code_explain"||e.type==="intro"?"code":"visual";await this.flipTo(o)}}e.codeHighlight&&this.state.currentSide==="code"&&this.highlightCode(e.codeHighlight),e.visualState&&await this.updateVisualization(e.visualState),this.showNarration(e),ScreenReaderAnnouncer.announce(`Step ${t+1}: ${e.title}`),this.updateStepDisplay(e,t),this.state.lecture&&this.state.lecture.id&&ELectureGamification.completeStep(this.state.lecture.id,t);const i=e.narration||e.title,s=this.state.speed,r=Date.now()+Math.random();this.state.currentExecutionId=r,e.interactive&&e.challenge&&!this.state.answeredChallenges.has(t)?V.speak(i,()=>{this.state.currentExecutionId===r&&(this.challengeTimeout=setTimeout(()=>{this.state.currentExecutionId===r&&V.speak("Now, let me test your understanding.",()=>{this.state.currentExecutionId===r&&(this.pause(),this.showChallenge(e.challenge))},s)},800/s))},s):this.state.isPlaying&&!this.state.isPaused&&V.speak(i,()=>{this.state.currentExecutionId===r&&this.state.isPlaying&&!this.state.isPaused&&(this.stepTimeout=setTimeout(()=>{this.state.currentExecutionId===r&&this.next()},1200))},s)},async executeStepManual(t){const e=this.state.lecture.steps[t];if(!e)return;if(this.updateProgress(),e.showSide&&e.showSide!==this.state.currentSide)await this.flipTo(e.showSide);else{const r=this.state.lecture.steps[t-1];if(this.shouldFlip(r,e)){const a=e.type==="code_explain"||e.type==="intro"?"code":"visual";await this.flipTo(a)}}e.codeHighlight&&this.state.currentSide==="code"&&this.highlightCode(e.codeHighlight),e.visualState&&await this.updateVisualization(e.visualState),this.showNarration(e),ScreenReaderAnnouncer.announce(`Step ${t+1}: ${e.title}`),this.updateStepDisplay(e,t),this.state.lecture&&this.state.lecture.id&&ELectureGamification.completeStep(this.state.lecture.id,t);const i=e.narration||e.title,s=this.state.speed;V.speak(i,null,s),e.interactive&&e.challenge&&!this.state.answeredChallenges.has(t)&&(this.challengeTimeout=setTimeout(()=>{this.showChallenge(e.challenge)},3e3/s))},shouldFlip(t,e){if(!t)return!1;const i=["code_explain","intro"],s=i.includes(t.type),r=i.includes(e.type);return s!==r},async flipTo(t){const e=document.getElementById("eLectureFlipCard");!e||this.state.currentSide===t||(LectureAudio.play("flip"),e.classList.add("flipping"),await new Promise(i=>setTimeout(i,300)),this.state.currentSide=t,e.dataset.side=t,await new Promise(i=>setTimeout(i,300)),e.classList.remove("flipping"))},highlightCode(t){const e=this.state.lecture;if(!e.code||!e.code.highlightRanges)return;const i=e.code.highlightRanges[t];if(!i)return;document.querySelectorAll(".electure-code-line").forEach((r,n)=>{const a=n+1;r.classList.remove("highlighted","executed"),a>=i.start&&a<=i.end?r.classList.add("highlighted"):a<i.start&&r.classList.add("executed")})},async updateVisualization(t){const e=document.getElementById("eLectureVisualizer");if(e)if(t.array){const i=Math.max(...t.array);e.innerHTML=`
        <div class="electure-viz-bars">
          ${t.array.map((s,r)=>{var a,o,l,c;let n="electure-viz-bar";return(a=t.comparing)!=null&&a.includes(r)&&(n+=" comparing"),(o=t.swapping)!=null&&o.includes(r)&&(n+=" swapping"),(l=t.sorted)!=null&&l.includes(r)&&(n+=" sorted"),t.pivot===r&&(n+=" pivot"),t.found===r&&(n+=" found"),t.current===r&&(n+=" current"),(c=t.eliminated)!=null&&c.includes(r)&&(n+=" eliminated"),t.minIndex===r&&(n+=" comparing"),t.key===r&&(n+=" pivot"),`
              <div class="${n}" style="height: ${s/i*100}%">
                <span class="bar-value">${s}</span>
              </div>
            `}).join("")}
        </div>
        ${t.phase?`<div class="viz-phase-label">${t.phase}</div>`:""}
      `}else if(t.arrays)e.innerHTML=`
        <div class="electure-viz-arrays">
          ${t.arrays.map((i,s)=>`
            <div class="array-group">
              ${i.map(r=>`<div class="array-cell">${r}</div>`).join("")}
            </div>
          `).join("")}
        </div>
        ${t.phase?`<div class="viz-phase-label">${t.phase}</div>`:""}
      `;else if(t.stack)e.innerHTML=`
        <div class="electure-viz-stack">
          <div class="stack-container">
            ${t.stack.map((i,s)=>{let r="stack-item";return s===t.stack.length-1&&(r+=" top"),t.highlight===s&&(r+=" highlight"),t.popping&&s===t.stack.length-1&&(r+=" popping"),`<div class="${r}"><span>${i}</span></div>`}).join("")}
            ${t.stack.length===0?'<div class="stack-empty">Empty Stack</div>':""}
          </div>
        </div>
        ${t.phase?`<div class="viz-phase-label">${t.phase}</div>`:""}
      `;else if(t.nodes){const i=Array.isArray(t.nodes)?t.nodes:[];e.innerHTML=`
        <div class="electure-viz-linkedlist">
          ${i.map((s,r)=>{var o;let n="ll-node";(o=t.visited)!=null&&o.includes(r)&&(n+=" visited"),t.current===r&&(n+=" current");const a=typeof s=="object"?s.value||s.val:s;return`
              <div class="${n}">
                <div class="ll-value">${a}</div>
                ${r<i.length-1?'<div class="ll-arrow">â†’</div>':'<div class="ll-null">null</div>'}
              </div>
            `}).join("")}
          ${i.length===0?'<div class="ll-empty">Empty List</div>':""}
        </div>
        ${t.phase?`<div class="viz-phase-label">${t.phase}</div>`:""}
      `}else if(t.tree||t.visited&&!t.grid){const i=t.visited||[],s=t.treeData||[50,30,70,20,40,60,80];e.innerHTML=`
        <div class="electure-viz-tree">
          <div class="tree-display">
            <div class="tree-level">
              <div class="tree-node ${i.includes(s[0])?"visited":""} ${t.current===s[0]?"current":""}">${s[0]}</div>
            </div>
            <div class="tree-level">
              <div class="tree-node ${i.includes(s[1])?"visited":""} ${t.current===s[1]?"current":""}">${s[1]}</div>
              <div class="tree-node ${i.includes(s[2])?"visited":""} ${t.current===s[2]?"current":""}">${s[2]}</div>
            </div>
            <div class="tree-level">
              <div class="tree-node ${i.includes(s[3])?"visited":""} ${t.current===s[3]?"current":""}">${s[3]}</div>
              <div class="tree-node ${i.includes(s[4])?"visited":""} ${t.current===s[4]?"current":""}">${s[4]}</div>
              <div class="tree-node ${i.includes(s[5])?"visited":""} ${t.current===s[5]?"current":""}">${s[5]}</div>
              <div class="tree-node ${i.includes(s[6])?"visited":""} ${t.current===s[6]?"current":""}">${s[6]}</div>
            </div>
          </div>
        </div>
        ${t.phase?`<div class="viz-phase-label">${t.phase}</div>`:""}
      `}else if(t.grid||t.algorithm){const i=t.grid||[[0,0,0,0,0,0,0,0],[0,1,1,0,0,1,1,0],[0,0,0,0,0,0,0,0],[0,1,0,1,1,0,1,0],[0,0,0,0,0,0,0,0]],s=t.start||[0,0],r=t.goal||[4,7],n=t.visitedCells||[],a=t.pathCells||[],o=t.currentCell,l=t.frontierCells||[],c={bfs:"ðŸŒŠ Breadth-First Search",dfs:"ðŸ” Depth-First Search",dijkstra:"ðŸ“ Dijkstra's Algorithm",astar:"â­ A* Pathfinding",greedy:"ðŸŽ¯ Greedy Best-First"};e.innerHTML=`
        <div class="electure-viz-pathfinding">
          ${t.algorithm?`<div class="pathfinding-label">${c[t.algorithm]||t.algorithm}</div>`:""}
          <div class="pathfinding-grid">
            ${i.map((h,d)=>h.map((u,p)=>{let f="pf-cell";return u===1&&(f+=" wall"),d===s[0]&&p===s[1]&&(f+=" start"),d===r[0]&&p===r[1]&&(f+=" goal"),n.some(g=>g[0]===d&&g[1]===p)&&(f+=" explored"),a.some(g=>g[0]===d&&g[1]===p)&&(f+=" path"),o&&o[0]===d&&o[1]===p&&(f+=" current"),l.some(g=>g[0]===d&&g[1]===p)&&(f+=" frontier"),`<div class="${f}"></div>`}).join("")).join("")}
          </div>
          <div class="pf-legend">
            <span class="pf-legend-item"><span class="pf-dot start"></span> Start</span>
            <span class="pf-legend-item"><span class="pf-dot goal"></span> Goal</span>
            <span class="pf-legend-item"><span class="pf-dot explored"></span> Explored</span>
            <span class="pf-legend-item"><span class="pf-dot path"></span> Path</span>
            <span class="pf-legend-item"><span class="pf-dot wall"></span> Wall</span>
          </div>
        </div>
        ${t.phase?`<div class="viz-phase-label">${t.phase}</div>`:""}
      `}else t.phase&&(e.innerHTML=`
        <div class="electure-viz-message">
          <div class="viz-phase-label" style="font-size: 1.5rem; text-align: center; padding: 2rem;">${t.phase}</div>
        </div>
      `)},showNarration(t){const e=document.getElementById("eLectureNarration");e&&(e.classList.remove("step-entering"),e.offsetWidth,e.classList.add("step-entering"),e.innerHTML=`
        <div class="electure-speaking-indicator" id="eLectureSpeakingIndicator">
          <div class="speaking-waves">
            <span class="speaking-wave"></span>
            <span class="speaking-wave"></span>
            <span class="speaking-wave"></span>
            <span class="speaking-wave"></span>
            <span class="speaking-wave"></span>
          </div>
          <span class="speaking-text">Speaking...</span>
        </div>
        <div class="narration-content">
          <div class="narration-step-info">Step ${this.state.currentStep+1}: ${t.title}</div>
          <div class="narration-text">${t.narration}</div>
        </div>
      `,LectureAudio.play("step")),this.updateSpeakingIndicator()},updateSpeakingIndicator(){const t=document.getElementById("eLectureSpeakingIndicator");t&&(V.isSpeaking?t.classList.add("active"):t.classList.remove("active"))},updateStepDisplay(t,e){const i=document.getElementById("eLectureSteps");if(!i)return;i.querySelectorAll(".electure-step-item").forEach((r,n)=>{r.classList.remove("active","completed"),n===e?r.classList.add("active"):n<e&&r.classList.add("completed")})},updateProgress(){const t=document.getElementById("eLectureProgressFill"),e=document.getElementById("eLectureStepCounter"),i=document.getElementById("eLectureStepIndicator");if(t){const s=(this.state.currentStep+1)/this.state.lecture.steps.length*100;t.style.width=`${s}%`}e&&(e.textContent=`Step ${this.state.currentStep+1} of ${this.state.lecture.steps.length}`),i&&(i.textContent=`Step ${this.state.currentStep+1} / ${this.state.lecture.steps.length}`)},updateControls(){const t=document.getElementById("eLecturePlayIcon"),e=document.getElementById("eLecturePlayLabel");t&&(t.textContent=this.state.isPlaying&&!this.state.isPaused?"â¸":"â–¶"),e&&(e.textContent=this.state.isPlaying&&!this.state.isPaused?"Pause":"Play"),document.querySelectorAll(".electure-speed-btn").forEach(i=>{i.classList.toggle("active",parseFloat(i.dataset.speed)===this.state.speed)})},showChallenge(t){const e=document.getElementById("eLectureChallengeOverlay");e&&(e.innerHTML=`
      <div class="electure-challenge-card">
        <div class="challenge-header">
          <span class="challenge-icon">ðŸ¤”</span>
          <span class="challenge-question">${t.question}</span>
        </div>
        <div class="challenge-options">
          ${t.options.map((i,s)=>`
            <button class="challenge-option" onclick="ELectureEngineV5.answerChallenge(${s})">
              <span class="option-letter">${String.fromCharCode(65+s)}</span>
              <span class="option-text">${i}</span>
            </button>
          `).join("")}
        </div>
        <button class="challenge-skip" onclick="ELectureEngineV5.skipChallenge()">Skip â†’</button>
      </div>
    `,e.classList.add("active"),ScreenReaderAnnouncer.announce(`Quiz question: ${t.question}. ${t.options.length} options available.`,"assertive"))},answerChallenge(t){const e=this.state.currentStep,s=this.state.lecture.steps[e].challenge,r=t===s.correct;this.state.answeredChallenges.add(e),document.querySelectorAll(".challenge-option").forEach((a,o)=>{a.disabled=!0,o===s.correct?a.classList.add("correct"):o===t&&!r&&a.classList.add("incorrect")}),r?(this.state.userScore+=10,LectureAudio.play("correct"),Li.burst(window.innerWidth/2,window.innerHeight/2,20),T("Correct! +10 XP","success"),V.speak("That's right! Great job!",null,this.state.speed)):(LectureAudio.play("incorrect"),T("Not quite! "+(s.explanation||""),"info"),V.speak("Not quite. "+(s.explanation||"Let's move on."),null,this.state.speed)),setTimeout(()=>{this.hideChallenge(),V.stop(),this.play()},r?1200:2e3)},skipChallenge(){this.state.answeredChallenges.add(this.state.currentStep),V.stop(),this.hideChallenge(),this.play()},hideChallenge(){const t=document.getElementById("eLectureChallengeOverlay");t&&(t.classList.remove("active"),setTimeout(()=>{t.classList.contains("active")||(t.innerHTML="")},300))},complete(){const t=Date.now()-this.state.startTime,e=this.state.lecture,i=e.xpReward+this.state.userScore;StreakSystem.addXP(i,`Completed E-Lecture: ${e.title}`),this.saveProgress(e.id,{completed:!0,score:this.state.userScore,timeSpent:t,completedAt:Date.now()}),V.stop(),LectureCompletion.show({title:e.title,lectureId:e.id,xpEarned:i,score:this.state.userScore,timeSpent:t})},saveProgress(t,e){localStorage.setItem(`electure-progress-${t}`,JSON.stringify(e))},getProgress(t){const e=localStorage.getItem(`electure-progress-${t}`);return e?JSON.parse(e):null},exit(){this.pause(),V.stop();const t=document.getElementById("eLecturePlayerOverlay");t&&t.classList.remove("active")},render(){const t=document.getElementById("eLecturePlayerOverlay");if(!t||!this.state.lecture)return;const e=this.state.lecture,s=this.getCurrentCodeSource().split(`
`),r=e.course?`course-${e.course.toLowerCase().replace(/\s+/g,"-")}`:"";t.innerHTML=`
      <div class="electure-v5-player ${r}">
        <!-- Top Bar -->
        <div class="electure-topbar">
          <button class="electure-exit-btn" onclick="ELectureEngineV5.exit()">
            âœ• Exit
          </button>
          <div class="electure-title">${e.title}</div>
          <div class="electure-xp">
            <span>ðŸ†</span>
            <span id="eLectureXP">${this.state.userScore} XP</span>
          </div>
        </div>
        
        <!-- Progress Bar -->
        <div class="electure-progress-bar">
          <div class="electure-progress-fill" id="eLectureProgressFill" style="width: 0%"></div>
        </div>
        <div class="electure-step-counter" id="eLectureStepCounter">Step 1 of ${e.steps.length}</div>
        
        <!-- Main Content: Flip Card -->
        <div class="electure-flip-container">
          <div class="electure-flip-card" id="eLectureFlipCard" data-side="code">
            
            <!-- Code Side -->
            <div class="electure-flip-side electure-code-side">
              <div class="flip-side-header">
                <span class="flip-icon">ðŸ“</span>
                <span class="flip-title">The Code</span>
                <div class="lang-switcher">
                  <button class="lang-btn ${this.state.currentLanguage==="python"?"active":""}" onclick="ELectureEngineV5.switchLanguage('python')">
                    ðŸ Python
                  </button>
                  <button class="lang-btn ${this.state.currentLanguage==="java"?"active":""}" onclick="ELectureEngineV5.switchLanguage('java')">
                    â˜• Java
                  </button>
                </div>
                <button class="flip-btn action-link" onclick="ELectureEngineV5.flipTo('visual')">
                  See it in action â†’
                </button>
              </div>
              <div class="electure-code-display">
                <pre><code>${s.map((n,a)=>`<span class="electure-code-line" data-line="${a+1}"><span class="line-num">${a+1}</span>${this.escapeHtml(n)}</span>`).join(`
`)}</code></pre>
              </div>
            </div>
            
            <!-- Visual Side -->
            <div class="electure-flip-side electure-visual-side">
              <div class="flip-side-header">
                <span class="flip-icon">ðŸ“Š</span>
                <span class="flip-title">The Visualization</span>
                <button class="flip-btn" onclick="ELectureEngineV5.flipTo('code')">
                  â† Back to code
                </button>
              </div>
              <div class="electure-visualizer" id="eLectureVisualizer">
                <!-- Visualizer content -->
              </div>
            </div>
            
          </div>
        </div>
        
        <!-- Narration Box -->
        <div class="electure-narration" id="eLectureNarration">
          <div class="electure-speaking-indicator" id="eLectureSpeakingIndicator">
            <div class="speaking-waves">
              <span class="speaking-wave"></span>
              <span class="speaking-wave"></span>
              <span class="speaking-wave"></span>
              <span class="speaking-wave"></span>
              <span class="speaking-wave"></span>
            </div>
            <span class="speaking-text">Speaking...</span>
          </div>
          <div class="narration-content">
            <div class="narration-step-info">Ready to begin</div>
            <div class="narration-text">Click Play to start the lecture</div>
          </div>
        </div>
        
        <!-- Controls -->
        <div class="electure-controls">
          <div class="controls-row controls-nav">
            <button class="electure-ctrl-btn small" onclick="ELectureEngineV5.first()" title="First step (Home)">
              <span class="ctrl-icon">â®</span>
            </button>
            
            <button class="electure-ctrl-btn" onclick="ELectureEngineV5.prev()" title="Previous (â† or J)">
              <span class="ctrl-icon">â—€</span>
              <span class="ctrl-label">Back</span>
            </button>
            
            <button class="electure-ctrl-btn primary" onclick="ELectureEngineV5.togglePlay()" title="Play/Pause (Space)">
              <span class="ctrl-icon" id="eLecturePlayIcon">â–¶</span>
              <span class="ctrl-label" id="eLecturePlayLabel">Play</span>
            </button>
            
            <button class="electure-ctrl-btn" onclick="ELectureEngineV5.next()" title="Next (â†’ or L)">
              <span class="ctrl-icon">â­</span>
              <span class="ctrl-label">Next</span>
            </button>
            
            <button class="electure-ctrl-btn small" onclick="ELectureEngineV5.last()" title="Last step (End)">
              <span class="ctrl-icon">â­</span>
            </button>
          </div>
          
          <div class="controls-row controls-speed">
            <span class="speed-icon" title="Slower">ðŸ¢</span>
            <input type="range" class="speed-slider" id="eLectureSpeedSlider" 
                   min="0" max="7" step="1" value="3"
                   onchange="ELectureEngineV5.setSpeed(ELectureEngineV5.availableSpeeds[this.value])"
                   title="Playback speed ([/] keys)">
            <span class="speed-icon" title="Faster">ðŸ‡</span>
            <span class="speed-label" id="eLectureSpeedLabel">1x</span>
          </div>
          
          <div class="controls-row controls-step-indicator">
            <span class="step-indicator" id="eLectureStepIndicator">Step 1 / 1</span>
          </div>
        </div>
        <!-- Custom Input Panel (for sorting algorithms) -->
        <div class="custom-input-panel" id="eLectureCustomInputPanel" style="display: none;">
          <div class="input-panel-header">
            <span>ðŸ§ª Custom Input</span>
            <button class="panel-close" onclick="ELectureEngineV5.hideCustomInputPanel()">Ã—</button>
          </div>
          <div class="preset-chips">
            <button class="preset-chip" onclick="ELectureEngineV5.applyPreset('random')">ðŸŽ² Random</button>
            <button class="preset-chip" onclick="ELectureEngineV5.applyPreset('sorted')">ðŸ“ˆ Sorted</button>
            <button class="preset-chip" onclick="ELectureEngineV5.applyPreset('reverse')">ðŸ“‰ Reverse</button>
            <button class="preset-chip" onclick="ELectureEngineV5.applyPreset('same')">= Same</button>
          </div>
          <div class="custom-input-row">
            <input type="text" class="custom-input-field" id="eLectureCustomArrayInput" 
                   placeholder="e.g. 64, 34, 25, 12, 22, 11, 90">
            <button class="btn-apply" onclick="ELectureEngineV5.applyCustomInput(document.getElementById('eLectureCustomArrayInput').value)">Apply</button>
          </div>
        </div>
        
        <!-- Keyboard Shortcuts -->
        <div class="electure-shortcuts">
          <span class="shortcut-hint"><span class="shortcut-key">Space</span> Play/Pause</span>
          <span class="shortcut-hint"><span class="shortcut-key">â†â†’</span> Navigate</span>
          <span class="shortcut-hint"><span class="shortcut-key">[/]</span> Speed</span>
          <span class="shortcut-hint"><span class="shortcut-key">F</span> Flip</span>
          <span class="shortcut-hint"><span class="shortcut-key">I</span> Input</span>
          <span class="shortcut-hint"><span class="shortcut-key">Esc</span> Exit</span>
        </div>
        
        <!-- Challenge Overlay -->
        <div class="electure-challenge-overlay" id="eLectureChallengeOverlay"></div>
        
      </div>
    `},escapeHtml(t){const e=document.createElement("div");return e.textContent=t,e.innerHTML}};ge.register({id:"bubble-sort",title:"Bubble Sort: Complete Walkthrough",course:"algorithms",category:"sorting",difficulty:"beginner",duration:"12 min",description:"Learn how Bubble Sort works step by step with visualizations.",xpReward:100,code:{languages:{python:{source:`def bubble_sort(arr):
    n = len(arr)
    
    for i in range(n - 1):
        for j in range(n - i - 1):
            if arr[j] > arr[j + 1]:
                # Swap elements
                arr[j], arr[j + 1] = arr[j + 1], arr[j]
    
    return arr`,highlightRanges:{outer_loop:{start:4,end:4},inner_loop:{start:5,end:5},comparison:{start:6,end:6},swap:{start:7,end:8}}},java:{source:`public static void bubbleSort(int[] arr) {
    int n = arr.length;
    
    for (int i = 0; i < n - 1; i++) {
        for (int j = 0; j < n - i - 1; j++) {
            if (arr[j] > arr[j + 1]) {
                // Swap elements
                int temp = arr[j];
                arr[j] = arr[j + 1];
                arr[j + 1] = temp;
            }
        }
    }
}`,highlightRanges:{outer_loop:{start:4,end:4},inner_loop:{start:5,end:5},comparison:{start:6,end:6},swap:{start:7,end:10}}}}},steps:[{id:1,type:"intro",title:"What is Bubble Sort?",narration:"Hey there! Today we are going to learn about Bubble Sort, one of the simplest sorting algorithms out there. Imagine you have a line of students arranged by height, but they are all jumbled up. Bubble Sort works by comparing neighbors and swapping them if they are in the wrong order. We keep doing this until everyone is in the right place. Lets see how it works!",codeHighlight:null,visualState:{array:[64,34,25,12,22,11,90],phase:"Initial Array"},duration:1e4,interactive:!1},{id:2,type:"code_explain",title:"The Outer Loop",narration:"Now lets look at the code. See this outer loop here? It runs n minus 1 times, where n is how many elements we have. Why n minus 1? Because after each complete pass through the array, the biggest unsorted element floats up to its correct spot at the end, like a bubble rising in water. Thats actually where the name Bubble Sort comes from!",codeHighlight:"outer_loop",visualState:null,duration:1e4,interactive:!1},{id:3,type:"code_explain",title:"The Inner Loop",narration:"This inner loop is where the magic happens. It goes through and compares each pair of neighbors. Notice something clever here. The loop only goes up to n minus i minus 1. Thats because the last i elements are already sorted from our previous passes. No need to check them again!",codeHighlight:"inner_loop",visualState:null,duration:9e3,interactive:!1},{id:4,type:"visualize",title:"First Comparison",narration:"Alright, lets see this in action! Here we have our array. We start by looking at the first two numbers, 64 and 34. Now, should they be swapped? Well, 64 is bigger than 34, and we want smaller numbers on the left. So yes, we need to swap them!",codeHighlight:"comparison",visualState:{array:[64,34,25,12,22,11,90],comparing:[0,1],phase:"Comparing 64 and 34"},duration:9e3,interactive:!0,challenge:{type:"predict",question:"Will 64 and 34 be swapped?",options:["Yes, because 64 > 34","No, they are in order"],correct:0,explanation:"Since 64 > 34, they are out of order and must be swapped."}},{id:5,type:"swap",title:"Swapping Elements",narration:"And there we go! We swapped them. Now 34 is in the first position and 64 moved one spot to the right. See how 64 is starting to bubble up towards where it belongs?",codeHighlight:"swap",visualState:{array:[34,64,25,12,22,11,90],swapping:[0,1],phase:"Swapped!"},duration:7e3,interactive:!1},{id:6,type:"visualize",title:"Continue Comparing",narration:"Now we move on to the next pair. We compare 64 and 25. Again, 64 is the bigger one, so it needs to swap with 25. You can see 64 is making its way to the right!",codeHighlight:"comparison",visualState:{array:[34,64,25,12,22,11,90],comparing:[1,2],phase:"Comparing 64 and 25"},duration:7e3,interactive:!1},{id:7,type:"swap",title:"Another Swap",narration:"After swapping, 25 moves to the left and 64 continues bubbling up. Can you see the pattern? The larger number keeps pushing forward, step by step.",codeHighlight:"swap",visualState:{array:[34,25,64,12,22,11,90],swapping:[1,2],phase:"64 bubbles up"},duration:6e3,interactive:!1},{id:8,type:"visualize",title:"Continuing the Pass",narration:"Lets fast forward a bit. 64 keeps comparing and swapping. Its bigger than 12? Swap! Bigger than 22? Swap! Bigger than 11? Swap! But wait, when 64 meets 90, no swap is needed because 90 is already bigger. So 64 stops right there.",codeHighlight:"comparison",visualState:{array:[34,25,12,22,11,64,90],sorted:[6],phase:"90 and 64 in place"},duration:1e4,interactive:!1},{id:9,type:"visualize",title:"End of First Pass",narration:"And thats our first complete pass done! Look at what happened. The biggest number, 90, is now sitting at the very end where it belongs. This is exactly why we call it Bubble Sort. The largest values bubble up to the top, just like air bubbles in water!",codeHighlight:"outer_loop",visualState:{array:[34,25,12,22,11,64,90],sorted:[5,6],phase:"First pass complete!"},duration:9e3,interactive:!0,challenge:{type:"predict",question:"How many more complete passes do we need?",options:["1 more pass","5 more passes","The array is sorted"],correct:1,explanation:"We need n-1 passes total. With 7 elements, that's 6 passes. We've done 1, so 5 more to go!"}},{id:10,type:"visualize",title:"Multiple Passes",narration:"After several more passes, each time a new element finds its home. You can see the green sorted section growing from the right side. Eventually, the whole array is sorted. Beautiful, isnt it?",codeHighlight:null,visualState:{array:[11,12,22,25,34,64,90],sorted:[0,1,2,3,4,5,6],phase:"Fully Sorted!"},duration:7e3,interactive:!1},{id:11,type:"code_explain",title:"Time Complexity: Worst Case",narration:"Now lets talk about how fast, or rather how slow, Bubble Sort is. In the worst case, imagine the array is completely backwards. We would need to make n minus 1 passes, and in each pass, we compare almost n pairs. Multiply those together and you get O of n squared. Thats not great for large amounts of data!",codeHighlight:null,visualState:null,duration:11e3,interactive:!0,challenge:{type:"select",question:"What is the time complexity of Bubble Sort?",options:["O(n)","O(n log n)","O(nÂ²)","O(2â¿)"],correct:2,explanation:"Bubble Sort has O(nÂ²) time complexity due to nested loops."}},{id:12,type:"code_explain",title:"Space Complexity",narration:"Heres some good news though! Bubble Sort is very memory efficient. It only needs a couple of extra variables to do the swapping. Everything else happens in place, right in the original array. So the space complexity is O of 1, which means constant space. Nice and simple!",codeHighlight:"swap",visualState:null,duration:1e4,interactive:!1},{id:13,type:"intro",title:"When to Use Bubble Sort?",narration:"So when would you actually use Bubble Sort? Honestly, not often in the real world because of that O of n squared time. But its perfect when your array is almost sorted, because then its nearly O of n. Its also great when you have very little memory, or when you need a simple, stable sorting algorithm for teaching purposes.",codeHighlight:null,visualState:{array:[11,12,22,25,34,64,90],sorted:[0,1,2,3,4,5,6],phase:"When to use?"},duration:12e3,interactive:!1},{id:14,type:"intro",title:"Common Mistakes",narration:"A few tips before we wrap up. Watch out for off by one errors in your loop bounds. Dont forget to reduce the inner loop range with n minus i minus 1. And always test with edge cases like empty arrays or arrays with just one element. Trust me, these little things can trip you up!",codeHighlight:null,visualState:null,duration:1e4,interactive:!1},{id:15,type:"intro",title:"Congratulations!",narration:"And thats it! You have mastered Bubble Sort! You now understand how the algorithm works, its time and space complexity, and when its appropriate to use it. Great job, and keep on learning!",codeHighlight:null,visualState:{array:[11,12,22,25,34,64,90],sorted:[0,1,2,3,4,5,6],phase:"ðŸŽ‰ Complete!"},duration:8e3,interactive:!1}],quiz:[{question:"What is the time complexity of Bubble Sort?",options:["O(n)","O(nÂ²)","O(n log n)","O(1)"],correct:1,explanation:"Bubble Sort has O(nÂ²) time complexity due to its nested loops."}]});ge.register({id:"binary-search",title:"Binary Search: Divide and Conquer",course:"algorithms",category:"searching",difficulty:"beginner",duration:"10 min",description:"Master the efficient O(log n) search algorithm.",xpReward:100,code:{languages:{python:{source:`def binary_search(arr, target):
    left = 0
    right = len(arr) - 1
    
    while left <= right:
        mid = (left + right) // 2
        
        if arr[mid] == target:
            return mid  # Found!
        elif arr[mid] < target:
            left = mid + 1  # Search right half
        else:
            right = mid - 1  # Search left half
    
    return -1  # Not found`,highlightRanges:{init:{start:2,end:3},loop:{start:5,end:5},mid:{start:6,end:6},found:{start:8,end:9},go_right:{start:10,end:11},go_left:{start:12,end:13}}},java:{source:`public static int binarySearch(int[] arr, int target) {
    int left = 0;
    int right = arr.length - 1;
    
    while (left <= right) {
        int mid = (left + right) / 2;
        
        if (arr[mid] == target) {
            return mid;  // Found!
        } else if (arr[mid] < target) {
            left = mid + 1;  // Search right half
        } else {
            right = mid - 1;  // Search left half
        }
    }
    
    return -1;  // Not found
}`,highlightRanges:{init:{start:2,end:3},loop:{start:5,end:5},mid:{start:6,end:6},found:{start:8,end:9},go_right:{start:10,end:11},go_left:{start:12,end:13}}}}},steps:[{id:1,type:"intro",title:"What is Binary Search?",narration:"Binary Search is a fast algorithm for finding an element in a SORTED array. Instead of checking every element (O(n)), it eliminates half the remaining elements with each comparison (O(log n)).",codeHighlight:null,visualState:{array:[2,5,8,12,16,23,38,56,72,91],target:23,phase:"Find 23"},duration:6e3,interactive:!1},{id:2,type:"code_explain",title:"Initialize Pointers",narration:"We start with two pointers: left at the beginning (index 0) and right at the end (index n-1). These define our search space.",codeHighlight:"init",visualState:{array:[2,5,8,12,16,23,38,56,72,91],low:0,high:9,phase:"Initialize"},duration:5e3,interactive:!1},{id:3,type:"visualize",title:"Find the Middle",narration:"We calculate the middle index: (0 + 9) / 2 = 4. The element at index 4 is 16. Is 23 equal to 16? Greater? Less?",codeHighlight:"mid",visualState:{array:[2,5,8,12,16,23,38,56,72,91],low:0,high:9,mid:4,target:23,phase:"Check middle: 16"},duration:5e3,interactive:!0,challenge:{type:"predict",question:"23 compared to 16 is:",options:["Less than","Equal to","Greater than"],correct:2,explanation:"23 > 16, so we search the right half."}},{id:4,type:"visualize",title:"Eliminate Left Half",narration:"Since 23 > 16, we know 23 must be in the right half. We move left pointer to mid + 1 = 5. We just eliminated half the array!",codeHighlight:"go_right",visualState:{array:[2,5,8,12,16,23,38,56,72,91],low:5,high:9,eliminated:[0,1,2,3,4],phase:"Search right half"},duration:5e3,interactive:!1},{id:5,type:"visualize",title:"Find New Middle",narration:"New middle: (5 + 9) / 2 = 7. Element at index 7 is 56. Since 23 < 56, we search the left half.",codeHighlight:"mid",visualState:{array:[2,5,8,12,16,23,38,56,72,91],low:5,high:9,mid:7,eliminated:[0,1,2,3,4],phase:"Check: 56"},duration:4e3,interactive:!1},{id:6,type:"visualize",title:"Eliminate Right Half",narration:"23 < 56, so we move right pointer to mid - 1 = 6. Our search space is now just indices 5-6.",codeHighlight:"go_left",visualState:{array:[2,5,8,12,16,23,38,56,72,91],low:5,high:6,eliminated:[0,1,2,3,4,7,8,9],phase:"Narrowing down..."},duration:4e3,interactive:!1},{id:7,type:"visualize",title:"Found It!",narration:"New middle: (5 + 6) / 2 = 5. Element at index 5 is 23. That's our target! ðŸŽ‰ We found it in just 3 comparisons!",codeHighlight:"found",visualState:{array:[2,5,8,12,16,23,38,56,72,91],found:5,phase:"ðŸŽ‰ Found at index 5!"},duration:5e3,interactive:!1},{id:8,type:"code_explain",title:"Time Complexity",narration:"We halve the search space with each comparison. For n elements: n â†’ n/2 â†’ n/4 â†’ ... â†’ 1. This takes logâ‚‚(n) steps, so time complexity is O(log n).",codeHighlight:null,visualState:null,duration:5e3,interactive:!0,challenge:{type:"select",question:"For an array of 1,000,000 elements, max comparisons needed?",options:["1,000,000","1,000","20","10"],correct:2,explanation:"logâ‚‚(1,000,000) â‰ˆ 20. Binary search is incredibly efficient!"}},{id:9,type:"intro",title:"Key Requirement",narration:"IMPORTANT: Binary search only works on SORTED arrays! If the array isn't sorted, you must sort it first (O(n log n)) or use linear search.",codeHighlight:null,visualState:null,duration:4e3,interactive:!1},{id:10,type:"intro",title:"Congratulations!",narration:"You now understand Binary Search! You know how it works, its O(log n) efficiency, and that it requires a sorted array. Great work! ðŸŽ‰",codeHighlight:null,visualState:{array:[2,5,8,12,16,23,38,56,72,91],found:5,phase:"ðŸŽ‰ Complete!"},duration:4e3,interactive:!1}],quiz:[{question:"What is required for Binary Search to work?",options:["Unsorted array","Sorted array","Linked list","Graph"],correct:1,explanation:"Binary Search requires a sorted array to work correctly."}]});ge.register({id:"quick-sort",title:"Quick Sort: Divide and Conquer",course:"algorithms",category:"sorting",difficulty:"intermediate",duration:"14 min",description:"Master the efficient divide-and-conquer sorting algorithm.",xpReward:150,code:{languages:{python:{source:`def quick_sort(arr, low=0, high=None):
    if high is None:
        high = len(arr) - 1
    if low < high:
        pivot_index = partition(arr, low, high)
        quick_sort(arr, low, pivot_index - 1)
        quick_sort(arr, pivot_index + 1, high)
    return arr

def partition(arr, low, high):
    pivot = arr[high]
    i = low - 1
    for j in range(low, high):
        if arr[j] <= pivot:
            i += 1
            arr[i], arr[j] = arr[j], arr[i]
    arr[i + 1], arr[high] = arr[high], arr[i + 1]
    return i + 1`,highlightRanges:{base_case:{start:4,end:4},partition_call:{start:5,end:5},recurse:{start:6,end:7},pivot_select:{start:11,end:11},compare_swap:{start:14,end:17},place_pivot:{start:18,end:18}}},java:{source:`public static void quickSort(int[] arr, int low, int high) {
    if (low < high) {
        int pivotIndex = partition(arr, low, high);
        quickSort(arr, low, pivotIndex - 1);
        quickSort(arr, pivotIndex + 1, high);
    }
}

public static int partition(int[] arr, int low, int high) {
    int pivot = arr[high];
    int i = low - 1;
    for (int j = low; j < high; j++) {
        if (arr[j] <= pivot) {
            i++;
            int temp = arr[i];
            arr[i] = arr[j];
            arr[j] = temp;
        }
    }
    int temp = arr[i + 1];
    arr[i + 1] = arr[high];
    arr[high] = temp;
    return i + 1;
}`,highlightRanges:{base_case:{start:2,end:2},partition_call:{start:3,end:3},recurse:{start:4,end:5},pivot_select:{start:10,end:10},compare_swap:{start:12,end:18},place_pivot:{start:20,end:22}}}}},steps:[{id:1,type:"intro",title:"What is Quick Sort?",narration:'Quick Sort is a divide-and-conquer algorithm. It works by selecting a "pivot" element from the array and partitioning the other elements into two sub-arrays, according to whether they are less than or greater than the pivot.',visualState:{array:[64,34,25,12,22,11,90,50],phase:"Initial Array"},duration:1e4},{id:2,type:"intro",title:"The Pivot Concept",narration:"Think of the pivot as a class representative. We want everyone shorter than them to stand on the left, and everyone taller on the right. Once they are in the middle, they are in their final correct spot!",visualState:{array:[64,34,25,12,22,11,90,50],pivot:7,phase:"Choosing Pivot: 50"},duration:1e4},{id:3,type:"visualize",title:"Partitioning: Start",narration:'We pick the last element, 50, as our pivot. We set a "low" pointer (index -1) to track the smaller elements zone.',codeHighlight:"pivot_select",visualState:{array:[64,34,25,12,22,11,90,50],pivot:7,current:0,phase:"Pivot: 50, Scanning..."},duration:8e3},{id:4,type:"visualize",title:"Comparing Elements",narration:"We check 64. Is it smaller than 50? No. So we ignore it and move to 34. Is 34 smaller? Yes! We increment our small-zone pointer and swap 34 to the front.",codeHighlight:"compare_swap",visualState:{array:[34,64,25,12,22,11,90,50],pivot:7,comparing:[1,7],swapping:[0,1],phase:"Swapped 34 to front"},duration:12e3},{id:5,type:"visualize",title:"Partitioning Continues",narration:"25 is smaller than 50, swap it! 12 is smaller, swap it! 22 is smaller, swap it! 11 is smaller, swap it! Notice how all small numbers are gathering on the left?",codeHighlight:"compare_swap",visualState:{array:[34,25,12,22,11,64,90,50],pivot:7,sorted:[0,1,2,3,4],warning:[5,6],phase:"Building small zone"},duration:1e4,interactive:!0,challenge:{type:"predict",question:"Where will 50 go next?",options:["Stay at end","After 11","Before 34"],correct:1}},{id:6,type:"visualize",title:"Placing the Pivot",narration:"We hit 90 (larger). We are done scanning. Now, we place our pivot 50 right after the small zone. It goes between 11 and 64.",codeHighlight:"place_pivot",visualState:{array:[34,25,12,22,11,50,90,64],pivot:5,phases:"Pivot 50 is home!"},duration:9e3},{id:7,type:"intro",title:"Divide and Conquer",narration:"Now 50 is locked in. We have a left sub-array [34, 25, 12, 22, 11] and a right sub-array [90, 64]. We apply the exact same logic to them!",codeHighlight:"recurse",visualState:{array:[34,25,12,22,11,50,90,64],sorted:[5],phase:"Split into Left & Right"},duration:1e4},{id:8,type:"visualize",title:"Left Partition",narration:"Lets focus on the left side. Pivot is now 11. It compares with 34, 25... wait, 11 is the smallest! It will swap with itself (or stay put) and define the start.",visualState:{array:[11,25,12,22,34,50,90,64],pivot:0,sorted:[0,5],phase:"11 Sorted"},duration:1e4},{id:9,type:"visualize",title:"Recursive Magic",narration:"The recursion continues. 22 becomes pivot for the remaining block... swaps with 12... and settles. This keeps happening until every sub-array has size 0 or 1.",visualState:{array:[11,12,22,25,34,50,90,64],sorted:[0,1,2,3,4,5],phase:"Left side sorted!"},duration:1e4},{id:10,type:"visualize",title:"Right Partition",narration:"Now the right side [90, 64]. Pivot is 64. 90 is larger, so no swap. We place 64 before 90.",visualState:{array:[11,12,22,25,34,50,64,90],sorted:[0,1,2,3,4,5,6,7],phase:"Right side sorted!"},duration:9e3},{id:11,type:"code_explain",title:"Complexity Analysis",narration:"On average, Quick Sort splits the array roughly in half each time (log n levels). Doing n work at each level gives O(n log n). This is very fast!",codeHighlight:null,visualState:null,duration:8e3},{id:12,type:"intro",title:"Worst Case Scenario",narration:"BUT, if the pivot is always the smallest or largest element (like a sorted array), we dont split evenly. We just peel off one element. That degrades to O of n squared.",duration:1e4,interactive:!0,challenge:{type:"select",question:"When is Quick Sort slow?",options:["Random data","Sorted data","Large data"],correct:1}},{id:13,type:"intro",title:"Why use it?",narration:"Despite the worst case, Quick Sort is often faster in practice than Merge Sort because it works in-place (low memory) and has good cache locality.",duration:8e3},{id:14,type:"intro",title:"Congratulations!",narration:"You have mastered Quick Sort! The key is the partition step: putting smaller things left and bigger things right.",visualState:{array:[11,12,22,25,34,50,64,90],sorted:[0,1,2,3,4,5,6,7],phase:"ðŸŽ‰ Complete!"},duration:6e3}],quiz:[{question:"What does the pivot do?",options:["Splits array randomly","Separates small & large elements","Finds the max value"],correct:1},{question:"What is the space complexity?",options:["O(n)","O(log n)","O(1)"],correct:1,explanation:"O(log n) stack space for recursion."}]});ge.register({id:"merge-sort",title:"Merge Sort: Split and Merge",course:"algorithms",category:"sorting",difficulty:"intermediate",duration:"12 min",description:"Efficient stable sorting algorithm.",xpReward:150,code:{languages:{python:{source:`def merge_sort(arr):
    if len(arr) <= 1:
        return arr
    mid = len(arr) // 2
    left = merge_sort(arr[:mid])
    right = merge_sort(arr[mid:])
    return merge(left, right)

def merge(left, right):
    result = []
    i = j = 0
    while i < len(left) and j < len(right):
        if left[i] <= right[j]:
            result.append(left[i])
            i += 1
        else:
            result.append(right[j])
            j += 1
    result.extend(left[i:])
    result.extend(right[j:])
    return result`,highlightRanges:{base_case:{start:2,end:3},split:{start:4,end:7},merge_loop:{start:12,end:19}}},java:{source:`public static void mergeSort(int[] arr, int left, int right) {
    if (left < right) {
        int mid = (left + right) / 2;
        mergeSort(arr, left, mid);
        mergeSort(arr, mid + 1, right);
        merge(arr, left, mid, right);
    }
}

public static void merge(int[] arr, int l, int m, int r) {
    int[] L = Arrays.copyOfRange(arr, l, m + 1);
    int[] R = Arrays.copyOfRange(arr, m + 1, r + 1);
    int i = 0, j = 0, k = l;
    while (i < L.length && j < R.length) {
        if (L[i] <= R[j]) arr[k++] = L[i++];
        else arr[k++] = R[j++];
    }
    while (i < L.length) arr[k++] = L[i++];
    while (j < R.length) arr[k++] = R[j++];
}`,highlightRanges:{base_case:{start:2,end:2},split:{start:3,end:6},merge_loop:{start:14,end:17}}}}},steps:[{id:1,type:"intro",title:"What is Merge Sort?",narration:"Merge Sort is a stable, divide-and-conquer algorithm. It follows a simple philosophy: it is easier to sort two small lists and merge them, than to sort one big list all at once.",visualState:{array:[38,27,43,3,9,82,10,15],phase:"Initial Array"},duration:11e3},{id:2,type:"visualize",title:"Divide Phase: Splitting",narration:"First, we cut the array exactly in half. Then we cut those halves in half. We keep chopping until we have individual elements.",codeHighlight:"split",visualState:{arrays:[[38,27,43,3],[9,82,10,15]],phase:"Splitting to smaller chunks"},duration:9e3},{id:3,type:"visualize",title:"Down to Singles",narration:"Eventually, we reach the base case. A list with one element is technically already sorted, right? Now we have 8 sorted mini-lists.",visualState:{arrays:[[38],[27],[43],[3],[9],[82],[10],[15]],phase:"Base Case Reached"},duration:9e3,interactive:!0,challenge:{type:"predict",question:"Why split to single elements?",options:["They are sorted","Its fun","To mix them"],correct:0}},{id:4,type:"visualize",title:"First Merge",narration:"Now the magic happens. We merge pairs back together. Merge 38 and 27. Since 27 is smaller, it goes first. We get [27, 38].",codeHighlight:"merge_loop",visualState:{arrays:[[27,38],[3,43],[9,82],[10,15]],phase:"Merging pairs..."},duration:1e4},{id:5,type:"visualize",title:"Comparing and Merging",narration:"Look at the second pair: 43 vs 3. 3 wins! So we get [3, 43]. We do this for all neighboring pairs.",visualState:{arrays:[[27,38],[3,43],[9,82],[10,15]],comparing:[1,2],phase:"Sorted pairs created"},duration:8e3},{id:6,type:"visualize",title:"Merging Larger Lists",narration:"Now we merge [27, 38] with [3, 43]. We compare the heads of both lists: 27 vs 3. 3 is smaller, so it starts the new list.",codeHighlight:"merge_loop",visualState:{arrays:[[3,27,38,43],[9,10,15,82]],comparing:[0,2],phase:"Comparing list heads"},duration:1e4},{id:7,type:"visualize",title:"The Zipper Effect",narration:"Think of it like a zipper coming together. We keep picking the smallest available number from the front of our two lists. 9 vs 27? 9 wins. 10 vs 27? 10 wins.",visualState:{arrays:[[3,27,38,43],[9,10,15,82]],phase:"Zipping sorted lists"},duration:1e4},{id:8,type:"visualize",title:"Final Merge",narration:"Finally, we merge the two halves of size 4. We step through comparing element by element. 3... 9... 10... 15... 27... and so on.",visualState:{array:[3,9,10,15,27,38,43,82],sorted:[0,1,2,3,4,5,6,7],phase:"Final Merge Complete"},duration:12e3},{id:9,type:"intro",title:"Time Analysis",narration:"The beauty of Merge Sort is consistency. It is ALWAYS O of n log n. Best case, worst case, average case. It never degrades like Quick Sort.",duration:8e3,interactive:!0,challenge:{type:"select",question:"Merge Sort worst case?",options:["O(n)","O(n log n)","O(nÂ²)"],correct:1}},{id:10,type:"intro",title:"Space Analysis",narration:"The catch? We needed all those extra arrays to hold the pieces. Merge Sort uses O of n extra memory. This can be expensive for massive datasets.",duration:9e3},{id:11,type:"intro",title:"Stability",narration:'Merge Sort is "Stable". If you have two "5"s, they stay in their original relative order. This is crucial when sorting complex data like spreadsheets.',duration:8e3},{id:12,type:"intro",title:"Congratulations!",narration:"You mastered Merge Sort! The most reliable sorting algorithm in the world.",visualState:{phase:"ðŸŽ‰ Complete!"},duration:6e3}],quiz:[{question:'Why is Merge Sort "Stable"?',options:["It never crashes","Preserves original order of equals","Uses fixed memory"],correct:1}]});ge.register({id:"selection-sort",title:"Selection Sort: Find the Minimum",course:"algorithms",category:"sorting",difficulty:"beginner",duration:"10 min",description:"Select the smallest element each pass.",xpReward:100,code:{languages:{python:{source:`def selection_sort(arr):
    for i in range(len(arr) - 1):
        min_idx = i
        for j in range(i + 1, len(arr)):
            if arr[j] < arr[min_idx]:
                min_idx = j
        arr[i], arr[min_idx] = arr[min_idx], arr[i]
    return arr`,highlightRanges:{outer:{start:2,end:2},find_min:{start:3,end:6},swap:{start:7,end:7}}},java:{source:`public static void selectionSort(int[] arr) {
    for (int i = 0; i < arr.length - 1; i++) {
        int minIdx = i;
        for (int j = i + 1; j < arr.length; j++) {
            if (arr[j] < arr[minIdx]) {
                minIdx = j;
            }
        }
        int temp = arr[i];
        arr[i] = arr[minIdx];
        arr[minIdx] = temp;
    }
}`,highlightRanges:{outer:{start:2,end:2},find_min:{start:3,end:8},swap:{start:9,end:11}}}}},steps:[{id:1,type:"intro",title:"What is Selection Sort?",narration:"Selection Sort is simple: it repeatedly finds the minimum element from the unsorted part and puts it at the beginning. Imagine scanning a crowd to find the shortest person, moving them to the front, then finding the next shortest.",visualState:{array:[64,25,12,22,11],phase:"Initial Array"},duration:1e4},{id:2,type:"visualize",title:"Pass 1: Start Scanning",narration:"We start at index 0. We assume the first element (64) is the minimum. Now we scan the rest of the array to see if we find anything smaller.",codeHighlight:"outer",visualState:{array:[64,25,12,22,11],minIndex:0,current:0,phase:"Assume min is 64"},duration:9e3},{id:3,type:"visualize",title:"Found Smaller!",narration:"We check 25. Is 25 < 64? Yes! So now 25 is our new minimum candidate. We remember its position.",codeHighlight:"find_min",visualState:{array:[64,25,12,22,11],minIndex:1,current:1,comparing:[0,1],phase:"New min found: 25"},duration:8e3},{id:4,type:"visualize",title:"Scanning Continues",narration:"We check 12. Smaller than 25? Yes! Update min. Check 22? No. Check 11? Yes! 11 is the new minimum.",codeHighlight:"find_min",visualState:{array:[64,25,12,22,11],minIndex:4,current:4,phase:"Found true min: 11"},duration:1e4,interactive:!0,challenge:{type:"predict",question:"What happens next?",options:["Swap 11 with 64","Swap 11 with 25","Nothing"],correct:0}},{id:5,type:"visualize",title:"Swap to Front",narration:"We reached the end. The smallest was 11. We swap it with our starting position (64). Now 11 is sorted!",codeHighlight:"swap",visualState:{array:[11,25,12,22,64],sorted:[0],swapping:[0,4],phase:"11 is sorted"},duration:9e3},{id:6,type:"visualize",title:"Pass 2: Next Minimum",narration:"Now we start from index 1. Current value is 25. We scan the rest: 12, 22, 64. We find 12 is the smallest remaining.",visualState:{array:[11,25,12,22,64],minIndex:2,sorted:[0],phase:"Scanning for next min..."},duration:9e3},{id:7,type:"visualize",title:"Swap Again",narration:"Swap 12 with 25. Now the first two elements [11, 12] are sorted. See how the sorted section grows from left to right?",visualState:{array:[11,12,25,22,64],sorted:[0,1],swapping:[1,2],phase:"11, 12 sorted"},duration:8e3},{id:8,type:"visualize",title:"Pass 3: Almost Done",narration:"Start at index 2 (value 25). Scan 22... found smaller! Scan 64... larger. Min is 22. Swap 22 with 25.",visualState:{array:[11,12,22,25,64],sorted:[0,1,2],swapping:[2,3],phase:"11, 12, 22 sorted"},duration:9e3},{id:9,type:"visualize",title:"Pass 4: Final Swap",narration:"Start at index 3 (value 25). Only 64 is left. 25 < 64, so 25 is already the minimum. It stays put. And since only one element remains, it must be the largest.",visualState:{array:[11,12,22,25,64],sorted:[0,1,2,3,4],phase:"Fully Sorted!"},duration:1e4},{id:10,type:"intro",title:"Complexity Analysis",narration:"Time complexity is O of n squared. Why? For the 1st element we scan n. For the 2nd, n-1. Roughly n times n steps. It is slow for large lists.",duration:8e3},{id:11,type:"intro",title:"Why use it?",narration:"Its distinct advantage: it makes the minimum number of swaps (at most n swaps). This matters if writing to memory is very expensive (like flash memory).",duration:1e4,interactive:!0,challenge:{type:"select",question:"Selection Sort best feature?",options:["Fastest time","Min swaps","Stable"],correct:1}},{id:12,type:"intro",title:"Congratulations!",narration:"You mastered Selection Sort! Identify the minimum, swap it to front. Repeat.",visualState:{phase:"ðŸŽ‰ Complete!"},duration:6e3}],quiz:[{question:"Selection Sort finds what each pass?",options:["Maximum","Minimum","Median"],correct:1}]});ge.register({id:"insertion-sort",title:"Insertion Sort: Build Sorted Section",course:"algorithms",category:"sorting",difficulty:"beginner",duration:"10 min",description:"Insert each element into its sorted position.",xpReward:100,code:{languages:{python:{source:`def insertion_sort(arr):
    for i in range(1, len(arr)):
        key = arr[i]
        j = i - 1
        while j >= 0 and arr[j] > key:
            arr[j + 1] = arr[j]
            j -= 1
        arr[j + 1] = key
    return arr`,highlightRanges:{outer:{start:2,end:2},shift:{start:5,end:7},insert:{start:8,end:8}}},java:{source:`public static void insertionSort(int[] arr) {
    for (int i = 1; i < arr.length; i++) {
        int key = arr[i];
        int j = i - 1;
        while (j >= 0 && arr[j] > key) {
            arr[j + 1] = arr[j];
            j--;
        }
        arr[j + 1] = key;
    }
}`,highlightRanges:{outer:{start:2,end:2},shift:{start:5,end:8},insert:{start:9,end:9}}}}},steps:[{id:1,type:"intro",title:"What is Insertion Sort?",narration:"Insertion Sort works exactly like sorting a hand of playing cards. You pick up cards one by one and insert them into their correct spot among the cards you already hold.",visualState:{array:[5,2,4,6,1,3],phase:"Cards on table"},duration:1e4},{id:2,type:"visualize",title:"First Card",narration:'We consider the first card (5) to be already "sorted" in our hand. We pick up the next card: 2. Is 2 smaller than 5?',codeHighlight:"outer",visualState:{array:[5,2,4,6,1,3],current:1,sorted:[0],phase:"Pick up 2"},duration:8e3},{id:3,type:"visualize",title:"Shift and Insert",narration:"Yes, 2 is smaller. So we shift 5 to the right to make space... and insert 2 at the front.",visualState:{array:[2,5,4,6,1,3],sorted:[0,1],swapping:[0,1],phase:"Inserted 2"},duration:8e3,interactive:!0,challenge:{type:"predict",question:"Whats next?",options:["Pick up 4","Pick up 6","Stop"],correct:0}},{id:4,type:"visualize",title:"Next Card: 4",narration:"Now we pick up 4. We compare it backwards against our sorted hand [2, 5]. Is 4 < 5? Yes, shift 5.",codeHighlight:"inner",visualState:{array:[2,4,5,6,1,3],current:2,sorted:[0,1],phase:"4 < 5, shift 5"},duration:9e3},{id:5,type:"visualize",title:"Finding the Spot",narration:"Now compare 4 against 2. Is 4 < 2? No. So we stop. The correct spot for 4 is right after 2.",visualState:{array:[2,4,5,6,1,3],sorted:[0,1,2],phase:"Insert 4 after 2"},duration:8e3},{id:6,type:"visualize",title:"Next Card: 6",narration:"Pick up 6. Compare with 5. 6 > 5, so it is already in the correct place! Best case scenario.",visualState:{array:[2,4,5,6,1,3],current:3,sorted:[0,1,2,3],phase:"6 is already placed"},duration:8e3},{id:7,type:"visualize",title:"Deep Insertion: 1",narration:"Pick up 1. This needs to go all the way to the start. Watch: 1 < 6 (shift), 1 < 5 (shift), 1 < 4 (shift), 1 < 2 (shift).",visualState:{array:[1,2,4,5,6,3],current:4,sorted:[1,2,3,4],swapping:[0,1,2,3,4],phase:"Shifting everyone..."},duration:12e3},{id:8,type:"visualize",title:"Final Insertion",narration:"Finally, we insert 3. It slides past 6, 5, and 4, then stops after 2. The array is fully sorted!",visualState:{array:[1,2,3,4,5,6],sorted:[0,1,2,3,4,5],phase:"Sorted!"},duration:8e3},{id:9,type:"intro",title:"Time Complexity",narration:"Worst case (reverse sorted) is O of n squared because we shift everyone every time. But best case (already sorted) is O of n!",duration:9e3,interactive:!0,challenge:{type:"select",question:"Best case complexity?",options:["O(1)","O(n)","O(nÂ²)"],correct:1}},{id:10,type:"intro",title:"Online Algorithm",narration:'Insertion Sort is an "Online Algorithm". It can sort data as it arrives, piece by piece. You dont need the full array to start.',duration:8e3},{id:11,type:"intro",title:"Conclusion",narration:"Use Insertion Sort for very small arrays (size < 50) or nearly sorted data. It beats Quick Sort in those specific cases!",visualState:{phase:"ðŸŽ‰ Complete!"},duration:6e3}],quiz:[{question:"Insertion Sort best case?",options:["O(nÂ²)","O(n)","O(1)"],correct:1}]});ge.register({id:"heap-sort",title:"Heap Sort: Tree-Based Sorting",course:"algorithms",category:"sorting",difficulty:"intermediate",duration:"12 min",description:"Build a heap and extract elements.",xpReward:150,code:{languages:{python:{source:`def heap_sort(arr):
    n = len(arr)
    for i in range(n // 2 - 1, -1, -1):
        heapify(arr, n, i)
    for i in range(n - 1, 0, -1):
        arr[0], arr[i] = arr[i], arr[0]
        heapify(arr, i, 0)
    return arr

def heapify(arr, n, i):
    largest = i
    left = 2 * i + 1
    right = 2 * i + 2
    if left < n and arr[left] > arr[largest]:
        largest = left
    if right < n and arr[right] > arr[largest]:
        largest = right
    if largest != i:
        arr[i], arr[largest] = arr[largest], arr[i]
        heapify(arr, n, largest)`,highlightRanges:{build:{start:3,end:4},extract:{start:5,end:8}}},java:{source:`public static void heapSort(int[] arr) {
    int n = arr.length;
    for (int i = n / 2 - 1; i >= 0; i--)
        heapify(arr, n, i);
    for (int i = n - 1; i > 0; i--) {
        int temp = arr[0];
        arr[0] = arr[i];
        arr[i] = temp;
        heapify(arr, i, 0);
    }
}

public static void heapify(int[] arr, int n, int i) {
    int largest = i;
    int left = 2 * i + 1;
    int right = 2 * i + 2;
    if (left < n && arr[left] > arr[largest]) largest = left;
    if (right < n && arr[right] > arr[largest]) largest = right;
    if (largest != i) {
        int swap = arr[i];
        arr[i] = arr[largest];
        arr[largest] = swap;
        heapify(arr, n, largest);
    }
}`,highlightRanges:{build:{start:3,end:4},extract:{start:5,end:10}}}}},steps:[{id:1,type:"intro",title:"What is Heap Sort?",narration:'Heap Sort turns the array into a "Binary Heap" (a special tree) where the parent is always bigger than children. Then we use this to sort.',visualState:{array:[4,10,3,5,1],phase:"Initial Array"},duration:1e4},{id:2,type:"visualize",title:"Build Max Heap: Start",narration:'We start from the middle and "heapify" backwards. Index 1 is 10. Left child is 5, right is 1. 10 is bigger than both. Good.',codeHighlight:"build",visualState:{array:[4,10,3,5,1],tree:!0,phase:"Checking node 10"},duration:9e3},{id:3,type:"visualize",title:"Heapify Root",narration:"Move to index 0 (value 4). Left child is 10, Right is 3. 10 is bigger than 4! So we must swap 4 and 10 to satisfy the heap property.",visualState:{array:[10,4,3,5,1],swapping:[0,1],tree:!0,phase:"Swapped 4 and 10"},duration:1e4},{id:4,type:"visualize",title:"Trickle Down",narration:"Now 4 is at index 1. Its children are 5 and 1. 5 is bigger than 4! Swap again. Now 10 is at the top, and everything below is ordered correctly.",visualState:{array:[10,5,3,4,1],swapping:[1,3],tree:!0,phase:"Max Heap Built!"},duration:1e4,interactive:!0,challenge:{type:"predict",question:"Where is the largest element now?",options:["Last index","Root (Index 0)","Random"],correct:1}},{id:5,type:"visualize",title:"Extract Max",narration:"Now we sort! Swap the root (10) with the last element (1). 10 is now in its final sorted spot at the end.",codeHighlight:"extract",visualState:{array:[1,5,3,4,10],sorted:[4],swapping:[0,4],tree:!0,phase:"10 Sorted"},duration:9e3},{id:6,type:"visualize",title:"Repair the Heap",narration:"The new root is 1. It is too small! Swap with larger child (5). Now 5 is root.",visualState:{array:[5,1,3,4,10],sorted:[4],swapping:[0,1],tree:!0,phase:"Repairing..."},duration:8e3},{id:7,type:"visualize",title:"Repair Continued",narration:"1 is still not happy. Swap with child 4. Now the heap [5, 4, 3, 1] is valid again.",visualState:{array:[5,4,3,1,10],sorted:[4],swapping:[1,3],tree:!0,phase:"Heap Restored"},duration:8e3},{id:8,type:"visualize",title:"Extract Next Max",narration:"Swap root (5) with last unsorted (1). 5 is now sorted. Array ends are: 5, 10.",visualState:{array:[1,4,3,5,10],sorted:[3,4],swapping:[0,3],tree:!0,phase:"5 Sorted"},duration:9e3},{id:9,type:"visualize",title:"Repair Again",narration:"New root 1 is smaller than child 4. Swap! Heap is [4, 1, 3].",visualState:{array:[4,1,3,5,10],sorted:[3,4],swapping:[0,1],tree:!0,phase:"Heap Restored"},duration:8e3},{id:10,type:"visualize",title:"Final Extractions",narration:"Swap 4 with 3... 4 Sorted. Repair... Swap 3 with 1... 3 Sorted. Finally 1 remains.",visualState:{array:[1,3,4,5,10],sorted:[0,1,2,3,4],phase:"Fully Sorted!"},duration:12e3},{id:11,type:"intro",title:"Time Complexity",narration:'Heap Sort is O of n log n. We do "log n" work (repairing levels) for "n" elements. It is reliable and consistent.',duration:8e3},{id:12,type:"intro",title:"Space Complexity",narration:"O of 1 space! We did everything inside the array itself. This is a huge advantage over Merge Sort.",duration:7e3,interactive:!0,challenge:{type:"select",question:"Space Complexity?",options:["O(n)","O(log n)","O(1)"],correct:2}},{id:13,type:"intro",title:"Congratulations!",narration:"You mastered Heap Sort! Its technically beautiful and very memory efficient.",visualState:{phase:"ðŸŽ‰ Complete!"},duration:6e3}],quiz:[{question:"Heap Sort time complexity?",options:["O(n)","O(n log n)","O(nÂ²)"],correct:1}]});ge.register({id:"linear-search",title:"Linear Search: The Simple Scan",course:"algorithms",category:"searching",difficulty:"beginner",duration:"8 min",description:"Check every element one by one.",xpReward:100,code:{languages:{python:{source:`def linear_search(arr, target):
    for i in range(len(arr)):
        if arr[i] == target:
            return i
    return -1`,highlightRanges:{loop:{start:2,end:2},compare:{start:3,end:4}}},java:{source:`public static int linearSearch(int[] arr, int target) {
    for (int i = 0; i < arr.length; i++) {
        if (arr[i] == target) {
            return i;
        }
    }
    return -1;
}`,highlightRanges:{loop:{start:2,end:2},compare:{start:3,end:4}}}}},steps:[{id:1,type:"intro",title:"What is Linear Search?",narration:"Linear Search is the most intuitive searching method. It simply checks every single item one by one until it finds what it is looking for. Like looking for your keys in every pocket!",visualState:{array:[4,2,7,1,9,3],target:7,phase:"Target: 7"},duration:1e4},{id:2,type:"visualize",title:"Start Searching",narration:"We start at the very beginning (Index 0). Is 4 equal to 7? No.",codeHighlight:"loop",visualState:{array:[4,2,7,1,9,3],current:0,target:7,phase:"Checking index 0"},duration:8e3},{id:3,type:"visualize",title:"Check Next",narration:"Move to Index 1. Is 2 equal to 7? No. We keep going.",visualState:{array:[4,2,7,1,9,3],current:1,target:7,phase:"Checking index 1"},duration:7e3},{id:4,type:"visualize",title:"Found It!",narration:"Move to Index 2. Is 7 equal to 7? YES! We found our target. We return the index 2.",codeHighlight:"compare",visualState:{array:[4,2,7,1,9,3],current:2,found:2,target:7,phase:"Found at index 2!"},duration:9e3,interactive:!0,challenge:{type:"predict",question:"How many comparisons made?",options:["1","3","6"],correct:1}},{id:5,type:"intro",title:"Worst Case Scenario",narration:"What if the number isnt there? Let search for 5.",visualState:{array:[4,2,7,1,9,3],target:5,phase:"New Target: 5"},duration:8e3},{id:6,type:"visualize",title:"Scanning All",narration:"We check 4... 2... 7... 1... 9... 3... None of them match.",visualState:{array:[4,2,7,1,9,3],current:5,target:5,visited:[0,1,2,3,4,5],phase:"Scanned everything"},duration:1e4},{id:7,type:"visualize",title:"Return -1",narration:"We reached the end of the array. The target 5 does not exist. We return -1 to indicate failure.",visualState:{array:[4,2,7,1,9,3],target:5,phase:"Return -1"},duration:8e3},{id:8,type:"intro",title:"Complexity Analysis",narration:"In the worst case (item last or missing), we check n items. So it is O of n linear time.",duration:8e3,interactive:!0,challenge:{type:"select",question:"Best case complexity?",options:["O(1)","O(n)","O(log n)"],correct:0}},{id:9,type:"intro",title:"When to use?",narration:"Use Linear Search when your data is UNSORTED. If data is sorted, Binary Search is much faster.",duration:8e3},{id:10,type:"intro",title:"Congratulations!",narration:"You mastered Linear Search! Simple, reliable, and works on any list.",visualState:{phase:"ðŸŽ‰ Complete!"},duration:6e3}],quiz:[{question:"Linear Search works on?",options:["Only sorted","Only unsorted","Both"],correct:2}]});ge.register({id:"stack-operations",title:"Stack Operations: LIFO in Action",course:"datastructures",category:"stacks",difficulty:"beginner",duration:"10 min",description:"Push, pop, and peek with LIFO principle.",xpReward:100,code:{languages:{python:{source:`class Stack:
    def __init__(self):
        self.items = []
    
    def push(self, item):
        self.items.append(item)
    
    def pop(self):
        return self.items.pop()
    
    def peek(self):
        return self.items[-1]
    
    def is_empty(self):
        return len(self.items) == 0`,highlightRanges:{push:{start:5,end:6},pop:{start:8,end:9},peek:{start:11,end:12}}},java:{source:`class Stack {
    private ArrayList<Integer> items = new ArrayList<>();
    
    public void push(int item) {
        items.add(item);
    }
    
    public int pop() {
        return items.remove(items.size() - 1);
    }
    
    public int peek() {
        return items.get(items.size() - 1);
    }
    
    public boolean isEmpty() {
        return items.size() == 0;
    }
}`,highlightRanges:{push:{start:4,end:6},pop:{start:8,end:10},peek:{start:12,end:14}}}}},steps:[{id:1,type:"intro",title:"What is a Stack?",narration:"A Stack is a LIFO (Last In, First Out) data structure. Think of a stack of pancakes compared to a queue of people.",visualState:{stack:[],phase:"Empty Stack"},duration:1e4},{id:2,type:"visualize",title:"Pushing First Item",narration:"Let push 10. It goes to the bottom.",codeHighlight:"push",visualState:{stack:[10],phase:"Pushed 10"},duration:7e3},{id:3,type:"visualize",title:"Stacking Up",narration:"Now push 20. It goes ON TOP of 10. That is the key rule.",visualState:{stack:[10,20],phase:"Pushed 20"},duration:7e3},{id:4,type:"visualize",title:"One More Push",narration:"Push 30. Now 30 is at the top (the peak).",visualState:{stack:[10,20,30],phase:"Pushed 30"},duration:7e3,interactive:!0,challenge:{type:"predict",question:"Which item comes out first?",options:["10","20","30"],correct:2}},{id:5,type:"visualize",title:"Peeking",narration:"Peek lets us look at the top item without removing it. We see 30.",codeHighlight:"peek",visualState:{stack:[10,20,30],current:2,phase:"Peeking at 30"},duration:8e3},{id:6,type:"visualize",title:"Popping",narration:"Now lets Pop! The top item (30) is removed first.",codeHighlight:"pop",visualState:{stack:[10,20],popping:!0,phase:"Popped 30"},duration:9e3},{id:7,type:"visualize",title:"Pop Again",narration:"Pop again. Now 20 comes out. See how we are reversing the order?",visualState:{stack:[10],popping:!0,phase:"Popped 20"},duration:8e3},{id:8,type:"visualize",title:"Emptying the Stack",narration:"Pop the last item 10. Now the stack is empty.",visualState:{stack:[],popping:!0,phase:"Popped 10"},duration:8e3},{id:9,type:"visualize",title:"Stack Underflow",narration:"If we try to pop again, we cant! The stack is empty. This is called stack underflow.",visualState:{stack:[],warning:!0,phase:"Stack Underflow!"},duration:9e3},{id:10,type:"intro",title:"Complexity",narration:"Push and Pop are O of 1. We just touch the top. Very fast.",duration:7e3,interactive:!0,challenge:{type:"select",question:"Complexity of Pop?",options:["O(n)","O(log n)","O(1)"],correct:2}},{id:11,type:"intro",title:"Congratulations!",narration:"You mastered Stacks! Essential for recursion, undo histories, and parsing code.",visualState:{phase:"ðŸŽ‰ Complete!"},duration:6e3}],quiz:[{question:"LIFO stands for?",options:["Last In First Out","Last In Fast Out","Linear In First Out"],correct:0}]});ge.register({id:"linked-list-traversal",title:"Linked List Traversal: Following the Chain",course:"datastructures",category:"linkedlists",difficulty:"beginner",duration:"11 min",description:"Navigate and manipulate linked nodes.",xpReward:100,code:{languages:{python:{source:`class Node:
    def __init__(self, val):
        self.value = val
        self.next = None

def traverse(head):
    current = head
    while current is not None:
        print(current.value)
        current = current.next`,highlightRanges:{node:{start:1,end:4},traverse:{start:6,end:10}}},java:{source:`class Node {
    int value;
    Node next;
    Node(int val) {
        this.value = val;
        this.next = null;
    }
}

public static void traverse(Node head) {
    Node current = head;
    while (current != null) {
        System.out.println(current.value);
        current = current.next;
    }
}`,highlightRanges:{node:{start:1,end:7},traverse:{start:10,end:15}}}}},steps:[{id:1,type:"intro",title:"What is a Linked List?",narration:"A linked list is like a treasure hunt. Each node contains a value AND a pointer to the next node.",visualState:{nodes:[10,20,30,40],phase:"A chain of nodes"},duration:9e3},{id:2,type:"visualize",title:"Starting at Head",narration:"Start at head node 10. Current points to this first element.",visualState:{nodes:[10,20,30,40],current:0,phase:"current = head (10)"},duration:8e3},{id:3,type:"visualize",title:"Following Pointers",narration:"Move to next. Current now points to 20. Continue following the chain.",visualState:{nodes:[10,20,30,40],current:1,visited:[0],phase:"current = current.next (20)"},duration:9e3,interactive:!0,challenge:{type:"predict",question:"Last nodes next is?",options:["head","null","0"],correct:1}},{id:4,type:"visualize",title:"Reaching the End",narration:"Keep going until current is null. Weve visited every node!",visualState:{nodes:[10,20,30,40],visited:[0,1,2,3],phase:"Traversal complete!"},duration:8e3},{id:5,type:"intro",title:"Arrays vs Linked Lists",narration:"Arrays have O of 1 random access. Linked lists excel at insertions in the middle.",visualState:{nodes:[10,20,30,40],phase:"Trade-offs"},duration:8e3},{id:6,type:"intro",title:"Complexity",narration:"Traversal is O of n. Insert at head is O of 1.",visualState:{nodes:[10,20,30,40],phase:"O(n) traversal"},duration:7e3,interactive:!0,challenge:{type:"select",question:"Traversal complexity?",options:["O(1)","O(n)","O(nÂ²)"],correct:1}},{id:7,type:"intro",title:"Congratulations!",narration:"You mastered Linked Lists! Foundation for many advanced structures.",visualState:{phase:"ðŸŽ‰ Complete!"},duration:6e3}],quiz:[{question:"Insert at head complexity?",options:["O(1)","O(n)","O(log n)"],correct:0}]});ge.register({id:"binary-tree-traversal",title:"Binary Tree Traversal: Four Ways to Explore",course:"datastructures",category:"trees",difficulty:"intermediate",duration:"14 min",description:"Pre-order, in-order, post-order, and level-order.",xpReward:150,code:{languages:{python:{source:`def inorder(node):
    if node is None:
        return
    inorder(node.left)
    print(node.value)
    inorder(node.right)

def preorder(node):
    if node is None:
        return
    print(node.value)
    preorder(node.left)
    preorder(node.right)`,highlightRanges:{inorder:{start:1,end:6},preorder:{start:8,end:13}}},java:{source:`public static void inorder(TreeNode node) {
    if (node == null) return;
    inorder(node.left);
    System.out.println(node.value);
    inorder(node.right);
}

public static void preorder(TreeNode node) {
    if (node == null) return;
    System.out.println(node.value);
    preorder(node.left);
    preorder(node.right);
}`,highlightRanges:{inorder:{start:1,end:5},preorder:{start:8,end:12}}}}},steps:[{id:1,type:"intro",title:"What is a Binary Tree?",narration:"A binary tree is like a decision structure. Each node splits into a maximum of two branches: Left and Right.",visualState:{tree:!0,visited:[],phase:"Tree Root: 50"},duration:9e3},{id:2,type:"visualize",title:"1. Pre-order Traversal",narration:'Pre-order rule: "Root, then Left, then Right". We visit the Root (50) deeply first.',codeHighlight:"preorder",visualState:{tree:!0,visited:[50],current:50,phase:"Pre: Visit 50"},duration:8e3},{id:3,type:"visualize",title:"Pre-order: Left Branch",narration:"Go Left to 30. Visit it. Go Left to 20. Visit it. Hit leaf.",visualState:{tree:!0,visited:[50,30,20],current:20,phase:"Pre: 50 -> 30 -> 20"},duration:8e3},{id:4,type:"visualize",title:"Pre-order: Backtracking",narration:"Back to 30, go Right to 40. Visit it. Now 30s branch is done. Back to 50, go Right to 70.",visualState:{tree:!0,visited:[50,30,20,40,70],current:70,phase:"Pre: ... -> 40 -> 70"},duration:9e3},{id:5,type:"visualize",title:"2. In-order Traversal",narration:'In-order rule: "Left, then Root, then Right". Start at 50, but dont visit yet! Go left to 30... Left to 20.',codeHighlight:"inorder",visualState:{tree:!0,visited:[],current:20,phase:"Go deep left..."},duration:9e3},{id:6,type:"visualize",title:"In-order: Processing",narration:"At 20, no left child. Visit 20. Back to 30. Visit 30. Go Right to 40. Visit 40.",visualState:{tree:!0,visited:[20,30,40],phase:"Left Branch Done"},duration:9e3},{id:7,type:"visualize",title:"In-order: The Root",narration:"Now we truly visit the Root 50. Then we explore the entire right subtree (60, 70, 80). Notice the numbers 20,30,40,50,60,70,80 are SORTED!",visualState:{tree:!0,visited:[20,30,40,50,60,70,80],phase:"Sorted Output!"},duration:1e4,interactive:!0,challenge:{type:"predict",question:"In-order makes sorted list on?",options:["Heap","BST","Any Tree"],correct:1}},{id:8,type:"visualize",title:"3. Post-order Traversal",narration:'Post-order rule: "Left, Right, then Root". Roots are visited LAST. 20... 40... then 30.',visualState:{tree:!0,visited:[20,40,30],phase:"Children before Parent"},duration:9e3},{id:9,type:"visualize",title:"Post-order Utility",narration:"Why use this? It is perfect for deleting a tree. You delete the children before you delete the parent!",visualState:{tree:!0,visited:[20,40,30,60,80,70,50],phase:"Root 50 is Last"},duration:8e3},{id:10,type:"intro",title:"4. Level-order (BFS)",narration:"Finally, Level-order visits horizontally. Level 1 (50). Level 2 (30, 70). Level 3 (20, 40, 60, 80).",visualState:{tree:!0,visited:[50,30,70,20,40,60,80],phase:"Layer by Layer"},duration:9e3},{id:11,type:"intro",title:"Congratulations!",narration:"You mastered Tree Traversals! Memorizing Pre, In, and Post order is key for interviews.",visualState:{phase:"ðŸŽ‰ Complete!"},duration:6e3}],quiz:[{question:"Which gives sorted BST output?",options:["Pre-order","In-order","Post-order"],correct:1}]});ge.register({id:"bfs-pathfinding",title:"BFS: Explore Level by Level",course:"algorithms",category:"pathfinding",difficulty:"intermediate",duration:"12 min",description:"Find shortest path using queue-based exploration.",xpReward:150,code:{languages:{python:{source:`from collections import deque

def bfs(graph, start, goal):
    queue = deque([start])
    visited = {start}
    parent = {}
    while queue:
        current = queue.popleft()
        if current == goal:
            return reconstruct_path(parent, goal)
        for neighbor in graph[current]:
            if neighbor not in visited:
                visited.add(neighbor)
                parent[neighbor] = current
                queue.append(neighbor)
    return None`,highlightRanges:{queue:{start:4,end:6},dequeue:{start:8,end:8},explore:{start:11,end:16}}},java:{source:`public static List<Integer> bfs(int[][] graph, int start, int goal) {
    Queue<Integer> queue = new LinkedList<>();
    Set<Integer> visited = new HashSet<>();
    Map<Integer, Integer> parent = new HashMap<>();
    
    queue.add(start);
    visited.add(start);
    
    while (!queue.isEmpty()) {
        int current = queue.poll();
        if (current == goal) return reconstructPath(parent, goal);
        for (int neighbor : graph[current]) {
            if (!visited.contains(neighbor)) {
                visited.add(neighbor);
                parent.put(neighbor, current);
                queue.add(neighbor);
            }
        }
    }
    return null;
}`,highlightRanges:{queue:{start:2,end:7},dequeue:{start:10,end:10},explore:{start:12,end:18}}}}},steps:[{id:1,type:"intro",title:"What is BFS?",narration:"Breadth First Search explores layer by layer, like ripples from a stone in water. Lets watch it work step by step!",visualState:{algorithm:"bfs",grid:[[0,0,0,0,0,0,0,0],[0,1,1,0,0,1,1,0],[0,0,0,0,0,0,0,0],[0,1,0,1,1,0,1,0],[0,0,0,0,0,0,0,0]],start:[0,0],goal:[4,7],currentCell:null,frontierCells:[],visitedCells:[],phase:"Ready"},duration:8e3},{id:2,type:"visualize",title:"Step 1: Add Start",narration:"Add starting cell [0,0] to the queue. It is now in the FRONTIER (yellow) - waiting to be processed.",codeHighlight:"queue",visualState:{algorithm:"bfs",currentCell:null,frontierCells:[[0,0]],visitedCells:[],phase:"Queue: [0,0]"},duration:7e3},{id:3,type:"visualize",title:"Step 2: Process [0,0]",narration:"Dequeue [0,0]. Mark VISITED (green). Add neighbors [0,1] and [1,0] to frontier.",codeHighlight:"dequeue",visualState:{algorithm:"bfs",currentCell:[0,0],frontierCells:[[0,1],[1,0]],visitedCells:[[0,0]],phase:"Processing [0,0]"},duration:8e3},{id:4,type:"visualize",title:"Step 3: Process [0,1]",narration:"Dequeue [0,1]. Mark visited. Walls at [1,1] and [1,2]! Add only [0,2] to frontier.",visualState:{algorithm:"bfs",currentCell:[0,1],frontierCells:[[1,0],[0,2]],visitedCells:[[0,0],[0,1]],phase:"Skipping walls"},duration:8e3,interactive:!0,challenge:{type:"predict",question:"Why skip [1,1] and [1,2]?",options:["Already visited","They are walls","Too far"],correct:1}},{id:5,type:"visualize",title:"Step 4-5: Expand Wave",narration:"Process [1,0] and [0,2]. Add [2,0], [0,3], [1,3]. The wave spreads outward evenly!",visualState:{algorithm:"bfs",currentCell:[0,2],frontierCells:[[2,0],[0,3],[1,3]],visitedCells:[[0,0],[0,1],[1,0],[0,2]],phase:"Wave expanding"},duration:8e3},{id:6,type:"visualize",title:"Step 6-7: Continue",narration:"Process more cells. Wave reaches [0,4], [2,1], [2,2], [1,4]. Walls at [1,5],[1,6] block direct path!",visualState:{algorithm:"bfs",currentCell:[1,4],frontierCells:[[2,3],[0,5]],visitedCells:[[0,0],[0,1],[1,0],[0,2],[2,0],[0,3],[1,3],[2,1],[2,2],[0,4],[1,4]],phase:"Moving right"},duration:8e3},{id:7,type:"visualize",title:"Step 8-9: Around Top Walls",narration:"Go around walls via row 0. Add [0,5], [0,6], [0,7]. Also expand through row 2.",visualState:{algorithm:"bfs",currentCell:[0,5],frontierCells:[[2,4],[0,6],[2,5]],visitedCells:[[0,0],[0,1],[1,0],[0,2],[2,0],[0,3],[1,3],[2,1],[2,2],[0,4],[1,4],[2,3],[0,5]],phase:"Going around walls"},duration:8e3},{id:8,type:"visualize",title:"Step 10-11: Row 2 Path",narration:"Expand through row 2: [2,4], [2,5]. Wall at [3,3],[3,4] blocks going down early. Continue right!",visualState:{algorithm:"bfs",currentCell:[2,5],frontierCells:[[0,7],[1,7],[3,5],[2,6]],visitedCells:[[0,0],[0,1],[1,0],[0,2],[2,0],[0,3],[1,3],[2,1],[2,2],[0,4],[1,4],[2,3],[0,5],[2,4],[0,6],[2,5]],phase:"Navigating walls"},duration:8e3},{id:9,type:"visualize",title:"Step 12-13: Approaching Goal",narration:"Almost there! Reach [2,6], [2,7], [3,5]. Then [3,7], [4,5], [4,6]. Goal [4,7] is next!",visualState:{algorithm:"bfs",currentCell:[4,6],frontierCells:[[4,7]],visitedCells:[[0,0],[0,1],[1,0],[0,2],[2,0],[0,3],[1,3],[2,1],[2,2],[0,4],[1,4],[2,3],[0,5],[2,4],[0,6],[2,5],[0,7],[1,7],[3,5],[2,6],[2,7],[4,5],[3,7],[4,6]],phase:"Almost there!"},duration:8e3},{id:10,type:"visualize",title:"GOAL FOUND!",narration:"Dequeued [4,7] - GOAL! BFS guarantees this is the shortest path in terms of steps.",visualState:{algorithm:"bfs",currentCell:[4,7],frontierCells:[],visitedCells:[[0,0],[0,1],[1,0],[0,2],[2,0],[0,3],[1,3],[2,1],[2,2],[0,4],[1,4],[2,3],[0,5],[2,4],[0,6],[2,5],[0,7],[1,7],[3,5],[2,6],[2,7],[4,5],[3,7],[4,6],[4,7]],phase:"GOAL!"},duration:8e3,interactive:!0,challenge:{type:"select",question:"Why is this the shortest?",options:["BFS explores by distance","Lucky path","Only path"],correct:0}},{id:11,type:"visualize",title:"Reconstruct Path",narration:"Trace back: [4,7]â†[4,6]â†[4,5]â†[3,5]â†[2,5]â†[2,4]â†[2,3]â†[1,3]â†[0,3]â†[0,2]â†[0,1]â†[0,0]",visualState:{algorithm:"bfs",currentCell:null,frontierCells:[],visitedCells:[],pathCells:[[0,0],[0,1],[0,2],[0,3],[1,3],[2,3],[2,4],[2,5],[3,5],[4,5],[4,6],[4,7]],phase:"Shortest Path!"},duration:9e3},{id:12,type:"intro",title:"Congratulations!",narration:"BFS complete! Yellow=frontier, Blue=current, Green=visited, Orange=path.",visualState:{phase:"ðŸŽ‰ Complete!"},duration:6e3}],quiz:[{question:"BFS uses which structure?",options:["Stack","Queue","Array"],correct:1}]});ge.register({id:"dfs-pathfinding",title:"DFS: Explore Deep First",course:"algorithms",category:"pathfinding",difficulty:"intermediate",duration:"11 min",description:"Dive deep before backtracking.",xpReward:150,code:{languages:{python:{source:`def dfs(graph, start, goal, visited=None):
    if visited is None:
        visited = set()
    visited.add(start)
    if start == goal:
        return [start]
    for neighbor in graph[start]:
        if neighbor not in visited:
            path = dfs(graph, neighbor, goal, visited)
            if path:
                return [start] + path
    return None`,highlightRanges:{visit:{start:4,end:4},recurse:{start:7,end:11}}},java:{source:`public static List<Integer> dfs(int[][] graph, int start, int goal, 
                                   Set<Integer> visited) {
    visited.add(start);
    if (start == goal) {
        List<Integer> path = new ArrayList<>();
        path.add(start);
        return path;
    }
    for (int neighbor : graph[start]) {
        if (!visited.contains(neighbor)) {
            List<Integer> path = dfs(graph, neighbor, goal, visited);
            if (path != null) {
                path.add(0, start);
                return path;
            }
        }
    }
    return null;
}`,highlightRanges:{visit:{start:3,end:3},recurse:{start:9,end:16}}}}},steps:[{id:1,type:"intro",title:"What is DFS?",narration:"Depth First Search dives deep into one path before backtracking. Watch it work step by step!",visualState:{algorithm:"dfs",grid:[[0,0,0,0,0,0,0,0],[0,1,1,0,0,1,1,0],[0,0,0,0,0,0,0,0],[0,1,0,1,1,0,1,0],[0,0,0,0,0,0,0,0]],start:[0,0],goal:[4,7],currentCell:null,stackCells:[],visitedCells:[],phase:"Ready"},duration:8e3},{id:2,type:"visualize",title:"Step 1: Push Start",narration:"Push [0,0] onto the STACK. DFS uses Last-In-First-Out. The NEWEST cell gets explored first!",codeHighlight:"visit",visualState:{algorithm:"dfs",currentCell:null,stackCells:[[0,0]],visitedCells:[],phase:"Stack: [0,0]"},duration:7e3},{id:3,type:"visualize",title:"Step 2: Pop [0,0]",narration:"Pop [0,0]. Mark VISITED (green). Push neighbors [0,1] and [1,0]. Top of stack is [1,0].",codeHighlight:"visit",visualState:{algorithm:"dfs",currentCell:[0,0],stackCells:[[0,1],[1,0]],visitedCells:[[0,0]],phase:"Visiting [0,0]"},duration:7e3,interactive:!0,challenge:{type:"predict",question:"Which is popped next?",options:["[0,1] (First)","[1,0] (Top)"],correct:1}},{id:4,type:"visualize",title:"Step 3: Pop [1,0] - Go Deep!",narration:"Pop [1,0] (top). Visit. Push [2,0]. DFS goes DOWN instead of RIGHT - diving deep!",visualState:{algorithm:"dfs",currentCell:[1,0],stackCells:[[0,1],[2,0]],visitedCells:[[0,0],[1,0]],phase:"Diving down!"},duration:7e3},{id:5,type:"visualize",title:"Step 4-5: Continue Down",narration:"Pop [2,0], [3,0]. Visit. Push [4,0], [2,1]. DFS explores one direction fully!",visualState:{algorithm:"dfs",currentCell:[3,0],stackCells:[[0,1],[4,0],[2,1]],visitedCells:[[0,0],[1,0],[2,0],[3,0]],phase:"Going deeper"},duration:7e3},{id:6,type:"visualize",title:"Step 6: Pop [2,1]",narration:"Pop [2,1]. Visit. Push [2,2]. Wall at [3,1] - skip it!",visualState:{algorithm:"dfs",currentCell:[2,1],stackCells:[[0,1],[4,0],[2,2]],visitedCells:[[0,0],[1,0],[2,0],[3,0],[2,1]],phase:"Branch right"},duration:7e3},{id:7,type:"visualize",title:"Step 7-8: Row 2 Exploration",narration:"Pop [2,2], [2,3]. Visit. Push [2,4], [3,2]. DFS zigzags through the maze!",visualState:{algorithm:"dfs",currentCell:[2,3],stackCells:[[0,1],[4,0],[3,2],[2,4]],visitedCells:[[0,0],[1,0],[2,0],[3,0],[2,1],[2,2],[2,3]],phase:"Exploring row 2"},duration:8e3},{id:8,type:"visualize",title:"Step 9-10: Continue Right",narration:"Pop [2,4], [2,5]. Visit. Push [3,5], [2,6]. Wall at [3,3],[3,4] blocks below!",visualState:{algorithm:"dfs",currentCell:[2,5],stackCells:[[0,1],[4,0],[3,2],[3,5],[2,6]],visitedCells:[[0,0],[1,0],[2,0],[3,0],[2,1],[2,2],[2,3],[2,4],[2,5]],phase:"Navigating walls"},duration:8e3},{id:9,type:"visualize",title:"Step 11-12: Approaching Goal",narration:"Pop [2,6], [2,7], [3,7]. Push [4,7] - thats our goal! Almost there!",visualState:{algorithm:"dfs",currentCell:[3,7],stackCells:[[0,1],[4,0],[3,2],[3,5],[4,7]],visitedCells:[[0,0],[1,0],[2,0],[3,0],[2,1],[2,2],[2,3],[2,4],[2,5],[2,6],[2,7],[3,7]],phase:"Goal in sight!"},duration:8e3},{id:10,type:"visualize",title:"GOAL FOUND!",narration:"Pop [4,7] - GOAL! DFS found a path, but its NOT the shortest - it went all the way left first!",visualState:{algorithm:"dfs",currentCell:[4,7],stackCells:[],visitedCells:[[0,0],[1,0],[2,0],[3,0],[2,1],[2,2],[2,3],[2,4],[2,5],[2,6],[2,7],[3,7],[4,7]],phase:"GOAL!"},duration:8e3,interactive:!0,challenge:{type:"select",question:"Is this the shortest path?",options:["Yes","No, DFS finds ANY path"],correct:1}},{id:11,type:"visualize",title:"The Winding Path",narration:"Path: [0,0]â†’[1,0]â†’[2,0]â†’[2,1]â†’[2,2]â†’[2,3]â†’[2,4]â†’[2,5]â†’[2,6]â†’[2,7]â†’[3,7]â†’[4,7]",visualState:{algorithm:"dfs",currentCell:null,stackCells:[],visitedCells:[],pathCells:[[0,0],[1,0],[2,0],[2,1],[2,2],[2,3],[2,4],[2,5],[2,6],[2,7],[3,7],[4,7]],phase:"Path Found!"},duration:9e3},{id:12,type:"intro",title:"Congratulations!",narration:"DFS complete! Orange=stack, Blue=current, Green=visited, Orange=path.",visualState:{phase:"ðŸŽ‰ Complete!"},duration:6e3}],quiz:[{question:"DFS explores how?",options:["Level by level","Deep first"],correct:1}]});ge.register({id:"dijkstra-pathfinding",title:"Dijkstra: Weighted Shortest Path",course:"algorithms",category:"pathfinding",difficulty:"intermediate",duration:"14 min",description:"Find shortest path with edge weights.",xpReward:150,code:{languages:{python:{source:`import heapq

def dijkstra(graph, start, goal):
    dist = {start: 0}
    pq = [(0, start)]
    parent = {}
    while pq:
        d, u = heapq.heappop(pq)
        if u == goal:
            return {'dist': d, 'path': reconstruct_path(parent, goal)}
        for v, weight in graph[u]:
            new_dist = d + weight
            if v not in dist or new_dist < dist[v]:
                dist[v] = new_dist
                parent[v] = u
                heapq.heappush(pq, (new_dist, v))
    return None`,highlightRanges:{init:{start:4,end:6},extract:{start:8,end:10},relax:{start:11,end:17}}},java:{source:`public static Map<String, Object> dijkstra(int[][] graph, int start, int goal) {
    Map<Integer, Integer> dist = new HashMap<>();
    PriorityQueue<int[]> pq = new PriorityQueue<>((a,b) -> a[0] - b[0]);
    Map<Integer, Integer> parent = new HashMap<>();
    
    dist.put(start, 0);
    pq.add(new int[]{0, start});
    
    while (!pq.isEmpty()) {
        int[] curr = pq.poll();
        int d = curr[0], u = curr[1];
        if (u == goal) return reconstructPath(parent, goal, d);
        for (int[] edge : graph[u]) {
            int v = edge[0], weight = edge[1];
            int newDist = d + weight;
            if (!dist.containsKey(v) || newDist < dist.get(v)) {
                dist.put(v, newDist);
                parent.put(v, u);
                pq.add(new int[]{newDist, v});
            }
        }
    }
    return null;
}`,highlightRanges:{init:{start:2,end:7},extract:{start:10,end:12},relax:{start:13,end:21}}}}},steps:[{id:1,type:"intro",title:"What is Dijkstra?",narration:"Dijkstras algorithm finds shortest paths in WEIGHTED graphs. Watch it step by step!",visualState:{algorithm:"dijkstra",grid:[[0,0,0,0,0,0,0,0],[0,1,1,0,0,1,1,0],[0,0,0,0,0,0,0,0],[0,1,0,1,1,0,1,0],[0,0,0,0,0,0,0,0]],start:[0,0],goal:[4,7],currentCell:null,frontierCells:[],visitedCells:[],phase:"Ready"},duration:8e3},{id:2,type:"visualize",title:"Step 1: Initialize",narration:"Set dist[0,0]=0, all others=âˆž. Add [0,0] to priority queue.",codeHighlight:"init",visualState:{algorithm:"dijkstra",currentCell:null,frontierCells:[[0,0]],visitedCells:[],distances:{"0,0":0},phase:"dist[0,0]=0"},duration:7e3},{id:3,type:"visualize",title:"Step 2: Extract [0,0]",narration:"Pop [0,0] dist=0. Mark visited. Relax [0,1] and [1,0]. Set dist=1 for both.",codeHighlight:"extract",visualState:{algorithm:"dijkstra",currentCell:[0,0],frontierCells:[[0,1],[1,0]],visitedCells:[[0,0]],distances:{"0,0":0,"0,1":1,"1,0":1},phase:"Relaxing"},duration:8e3,interactive:!0,challenge:{type:"predict",question:"Next extraction?",options:["[0,1] or [1,0] (dist=1)","Random"],correct:0}},{id:4,type:"visualize",title:"Step 3-4: Expand Wave",narration:"Extract [0,1], [1,0]. Relax neighbors. Walls at [1,1],[1,2] block direct path. Add [0,2], [2,0].",visualState:{algorithm:"dijkstra",currentCell:[0,2],frontierCells:[[2,0],[0,3],[1,3]],visitedCells:[[0,0],[0,1],[1,0],[0,2]],distances:{"0,2":2,"0,3":3},phase:"Expanding"},duration:8e3},{id:5,type:"visualize",title:"Step 5-6: Continue",narration:"Extract by lowest distance. Wave reaches [0,4], [2,1], [2,2], [1,4]. Walls at [1,5],[1,6]!",visualState:{algorithm:"dijkstra",currentCell:[1,4],frontierCells:[[2,3],[0,5]],visitedCells:[[0,0],[0,1],[1,0],[0,2],[2,0],[0,3],[1,3],[2,1],[2,2],[0,4],[1,4]],distances:{"1,4":5,"0,5":5},phase:"Navigating"},duration:8e3},{id:6,type:"visualize",title:"Step 7-8: Row 2 Path",narration:"Extract [2,3], [2,4], [2,5]. Wall at [3,3],[3,4] blocks going down early.",visualState:{algorithm:"dijkstra",currentCell:[2,5],frontierCells:[[0,7],[3,5],[2,6]],visitedCells:[[0,0],[0,1],[1,0],[0,2],[2,0],[0,3],[1,3],[2,1],[2,2],[0,4],[1,4],[2,3],[0,5],[2,4],[0,6],[2,5]],distances:{"2,5":6,"3,5":7},phase:"Almost there"},duration:8e3},{id:7,type:"visualize",title:"Step 9-10: Approaching Goal",narration:"Extract [2,6], [2,7], [3,5]. Add [3,7], [4,5], [4,6]. Goal [4,7] coming up!",visualState:{algorithm:"dijkstra",currentCell:[4,6],frontierCells:[[4,7]],visitedCells:[[0,0],[0,1],[1,0],[0,2],[2,0],[0,3],[1,3],[2,1],[2,2],[0,4],[1,4],[2,3],[0,5],[2,4],[0,6],[2,5],[0,7],[1,7],[3,5],[2,6],[2,7],[4,5],[3,7],[4,6]],distances:{"4,6":10,"4,7":11},phase:"Almost there!"},duration:8e3},{id:8,type:"visualize",title:"GOAL FOUND!",narration:"Extract [4,7] with dist=11. This is the OPTIMAL weighted distance!",visualState:{algorithm:"dijkstra",currentCell:[4,7],frontierCells:[],visitedCells:[[0,0],[0,1],[1,0],[0,2],[2,0],[0,3],[1,3],[2,1],[2,2],[0,4],[1,4],[2,3],[0,5],[2,4],[0,6],[2,5],[0,7],[1,7],[3,5],[2,6],[2,7],[4,5],[3,7],[4,6],[4,7]],phase:"GOAL! dist=11"},duration:8e3,interactive:!0,challenge:{type:"select",question:"Is this optimal?",options:["Yes, guaranteed!","Maybe"],correct:0}},{id:9,type:"visualize",title:"Reconstruct Path",narration:"Path: [0,0]â†’[0,1]â†’[0,2]â†’[0,3]â†’[1,3]â†’[2,3]â†’[2,4]â†’[2,5]â†’[3,5]â†’[4,5]â†’[4,6]â†’[4,7]",visualState:{algorithm:"dijkstra",currentCell:null,frontierCells:[],visitedCells:[],pathCells:[[0,0],[0,1],[0,2],[0,3],[1,3],[2,3],[2,4],[2,5],[3,5],[4,5],[4,6],[4,7]],phase:"Optimal Path!"},duration:9e3},{id:10,type:"intro",title:"Congratulations!",narration:"Dijkstra complete! Yellow=frontier, Blue=current, Green=visited, Orange=path.",visualState:{phase:"ðŸŽ‰ Complete!"},duration:6e3}],quiz:[{question:"Dijkstra works with negative weights?",options:["Yes","No"],correct:1}]});ge.register({id:"astar-pathfinding",title:"A* Search: The Smart Pathfinder",course:"algorithms",category:"pathfinding",difficulty:"advanced",duration:"14 min",description:"Combines Dijkstra with heuristic guidance.",xpReward:200,code:{languages:{python:{source:`import heapq

def a_star(start, goal, heuristic, get_neighbors):
    open_set = [(0, start)]
    g_score = {start: 0}
    parent = {}
    while open_set:
        _, current = heapq.heappop(open_set)
        if current == goal:
            return reconstruct_path(parent, goal)
        for neighbor, cost in get_neighbors(current):
            tentative_g = g_score[current] + cost
            if neighbor not in g_score or tentative_g < g_score[neighbor]:
                g_score[neighbor] = tentative_g
                f_score = tentative_g + heuristic(neighbor, goal)
                parent[neighbor] = current
                heapq.heappush(open_set, (f_score, neighbor))
    return None`,highlightRanges:{init:{start:4,end:6},fscore:{start:14,end:14}}},java:{source:`public static List<int[]> aStar(int[] start, int[] goal, 
                                  BiFunction<int[], int[], Integer> heuristic) {
    PriorityQueue<int[]> open = new PriorityQueue<>((a,b) -> a[0] - b[0]);
    Map<String, Integer> gScore = new HashMap<>();
    Map<String, int[]> parent = new HashMap<>();
    
    open.add(new int[]{0, start[0], start[1]});
    gScore.put(key(start), 0);
    
    while (!open.isEmpty()) {
        int[] curr = open.poll();
        int[] current = {curr[1], curr[2]};
        if (Arrays.equals(current, goal)) return reconstructPath(parent, goal);
        for (int[][] neighbor : getNeighbors(current)) {
            int tentativeG = gScore.get(key(current)) + neighbor[1][0];
            if (!gScore.containsKey(key(neighbor[0])) || tentativeG < gScore.get(key(neighbor[0]))) {
                gScore.put(key(neighbor[0]), tentativeG);
                int fScore = tentativeG + heuristic.apply(neighbor[0], goal);
                parent.put(key(neighbor[0]), current);
                open.add(new int[]{fScore, neighbor[0][0], neighbor[0][1]});
            }
        }
    }
    return null;
}`,highlightRanges:{init:{start:3,end:8},fscore:{start:18,end:18}}}}},steps:[{id:1,type:"intro",title:"What is A*?",narration:"A* combines Dijkstra (optimal) with a heuristic (smart). It uses f = g + h. Watch step by step!",visualState:{algorithm:"astar",grid:[[0,0,0,0,0,0,0,0],[0,1,1,0,0,1,1,0],[0,0,0,0,0,0,0,0],[0,1,0,1,1,0,1,0],[0,0,0,0,0,0,0,0]],start:[0,0],goal:[4,7],currentCell:null,openCells:[],visitedCells:[],phase:"Ready"},duration:8e3},{id:2,type:"visualize",title:"Step 1: Initialize",narration:"For [0,0]: g=0, h=11 (Manhattan to [4,7]), f=11. Add to OPEN set.",codeHighlight:"init",visualState:{algorithm:"astar",currentCell:null,openCells:[[0,0]],visitedCells:[],fScores:{"0,0":11},phase:"f[0,0]=0+11=11"},duration:7e3},{id:3,type:"visualize",title:"Step 2: Expand [0,0]",narration:"Pop [0,0]. Add neighbors: [0,1] f=1+10=11, [1,0] f=1+10=11. Both equal!",visualState:{algorithm:"astar",currentCell:[0,0],openCells:[[0,1],[1,0]],visitedCells:[[0,0]],fScores:{"0,1":11,"1,0":11},phase:"Expanding [0,0]"},duration:8e3,interactive:!0,challenge:{type:"predict",question:"f for [0,1]?",options:["f = g + h = 1 + 10 = 11","f = h = 10"],correct:0}},{id:4,type:"visualize",title:"Step 3-4: Expand Wave",narration:"Expand [0,1], [1,0]. Add [0,2], [2,0], [1,3]. Walls at [1,1],[1,2] blocked!",visualState:{algorithm:"astar",currentCell:[0,2],openCells:[[2,0],[0,3],[1,3]],visitedCells:[[0,0],[0,1],[1,0],[0,2]],fScores:{"0,3":11,"1,3":11},phase:"Following h"},duration:8e3},{id:5,type:"visualize",title:"Step 5-6: Navigate Right",narration:"Expand toward goal. A* favors lower h (closer to goal). Add [0,4], [2,3], [1,4].",visualState:{algorithm:"astar",currentCell:[1,4],openCells:[[2,3],[0,5]],visitedCells:[[0,0],[0,1],[1,0],[0,2],[2,0],[0,3],[1,3],[2,1],[2,2],[0,4],[1,4]],fScores:{"0,5":11,"2,3":11},phase:"Moving right"},duration:8e3},{id:6,type:"visualize",title:"Step 7-8: Row 2 Path",narration:"Expand [2,3], [2,4], [2,5]. Wall at [3,3],[3,4] blocks below. Go through [3,5]!",visualState:{algorithm:"astar",currentCell:[2,5],openCells:[[0,7],[3,5],[2,6]],visitedCells:[[0,0],[0,1],[1,0],[0,2],[2,0],[0,3],[1,3],[2,1],[2,2],[0,4],[1,4],[2,3],[0,5],[2,4],[0,6],[2,5]],fScores:{"3,5":11,"2,6":11},phase:"Navigating"},duration:8e3},{id:7,type:"visualize",title:"Step 9-10: Approaching Goal",narration:"Expand [2,6], [2,7], [3,5], [3,7], [4,5], [4,6]. Goal [4,7] is next!",visualState:{algorithm:"astar",currentCell:[4,6],openCells:[[4,7]],visitedCells:[[0,0],[0,1],[1,0],[0,2],[2,0],[0,3],[1,3],[2,1],[2,2],[0,4],[1,4],[2,3],[0,5],[2,4],[0,6],[2,5],[0,7],[1,7],[3,5],[2,6],[2,7],[4,5],[3,7],[4,6]],fScores:{"4,7":11},phase:"Almost there!"},duration:8e3},{id:8,type:"visualize",title:"GOAL FOUND!",narration:"Pop [4,7] - GOAL! f=11=g+h=11+0. A* found the optimal path!",visualState:{algorithm:"astar",currentCell:[4,7],openCells:[],visitedCells:[[0,0],[0,1],[1,0],[0,2],[2,0],[0,3],[1,3],[2,1],[2,2],[0,4],[1,4],[2,3],[0,5],[2,4],[0,6],[2,5],[0,7],[1,7],[3,5],[2,6],[2,7],[4,5],[3,7],[4,6],[4,7]],phase:"GOAL! f=11"},duration:8e3,interactive:!0,challenge:{type:"select",question:"Why is this optimal?",options:["Heuristic is admissible","Lucky"],correct:0}},{id:9,type:"visualize",title:"Optimal Path",narration:"Path: [0,0]â†’[0,1]â†’[0,2]â†’[0,3]â†’[1,3]â†’[2,3]â†’[2,4]â†’[2,5]â†’[3,5]â†’[4,5]â†’[4,6]â†’[4,7]",visualState:{algorithm:"astar",currentCell:null,openCells:[],visitedCells:[],pathCells:[[0,0],[0,1],[0,2],[0,3],[1,3],[2,3],[2,4],[2,5],[3,5],[4,5],[4,6],[4,7]],phase:"Optimal Path!"},duration:9e3},{id:10,type:"intro",title:"Congratulations!",narration:"A* complete! Yellow=open, Blue=current, Green=closed, Orange=path.",visualState:{phase:"ðŸŽ‰ Complete!"},duration:6e3}],quiz:[{question:"A* uses f = g + h. What is g?",options:["Cost from start","Estimated to goal"],correct:0}]});ge.register({id:"greedy-bestfirst",title:"Greedy Best-First: Chase the Goal",course:"algorithms",category:"pathfinding",difficulty:"intermediate",duration:"10 min",description:"Uses only heuristic, ignores path cost.",xpReward:150,code:{languages:{python:{source:`import heapq

def greedy_best_first(start, goal, heuristic, get_neighbors):
    open_set = [(heuristic(start, goal), start)]
    visited = set()
    parent = {}
    while open_set:
        _, current = heapq.heappop(open_set)
        if current == goal:
            return reconstruct_path(parent, goal)
        visited.add(current)
        for neighbor in get_neighbors(current):
            if neighbor not in visited:
                parent[neighbor] = current
                heapq.heappush(open_set, (heuristic(neighbor, goal), neighbor))
    return None`,highlightRanges:{heuristic:{start:4,end:4},select:{start:8,end:9}}},java:{source:`public static List<int[]> greedyBestFirst(int[] start, int[] goal,
                                           BiFunction<int[], int[], Integer> heuristic) {
    PriorityQueue<int[]> open = new PriorityQueue<>((a,b) -> a[0] - b[0]);
    Set<String> visited = new HashSet<>();
    Map<String, int[]> parent = new HashMap<>();
    
    open.add(new int[]{heuristic.apply(start, goal), start[0], start[1]});
    
    while (!open.isEmpty()) {
        int[] curr = open.poll();
        int[] current = {curr[1], curr[2]};
        if (Arrays.equals(current, goal)) return reconstructPath(parent, goal);
        visited.add(key(current));
        for (int[] neighbor : getNeighbors(current)) {
            if (!visited.contains(key(neighbor))) {
                parent.put(key(neighbor), current);
                open.add(new int[]{heuristic.apply(neighbor, goal), neighbor[0], neighbor[1]});
            }
        }
    }
    return null;
}`,highlightRanges:{heuristic:{start:7,end:7},select:{start:10,end:12}}}}},steps:[{id:1,type:"intro",title:"What is Greedy Best-First?",narration:"Greedy uses ONLY h (distance to goal). No g! Its the speed demon. Watch step by step.",visualState:{algorithm:"greedy",grid:[[0,0,0,0,0,0,0,0],[0,1,1,0,0,1,1,0],[0,0,0,0,0,0,0,0],[0,1,0,1,1,0,1,0],[0,0,0,0,0,0,0,0]],start:[0,0],goal:[4,7],currentCell:null,openCells:[],visitedCells:[],phase:"Ready"},duration:8e3},{id:2,type:"visualize",title:"Step 1: Initialize",narration:"For [0,0]: h=11 (Manhattan to [4,7]). Thats it! No g. Add to open.",codeHighlight:"heuristic",visualState:{algorithm:"greedy",currentCell:null,openCells:[[0,0]],visitedCells:[],hScores:{"0,0":11},phase:"h[0,0]=11"},duration:7e3,interactive:!0,challenge:{type:"predict",question:"Greedy ignores?",options:["g (cost)","h (distance)"],correct:0}},{id:3,type:"visualize",title:"Step 2: Expand [0,0]",narration:"Pop [0,0]. Add [0,1] h=10, [1,0] h=10. Both equal! Greedy picks toward goal.",visualState:{algorithm:"greedy",currentCell:[0,0],openCells:[[0,1],[1,0]],visitedCells:[[0,0]],hScores:{"0,1":10,"1,0":10},phase:"h=10 both"},duration:7e3},{id:4,type:"visualize",title:"Step 3-4: Beeline Right!",narration:"Pop [0,1], [0,2]. Add [0,3], [1,3]. Greedy runs STRAIGHT toward goal - lowest h!",visualState:{algorithm:"greedy",currentCell:[0,3],openCells:[[1,0],[1,3],[0,4]],visitedCells:[[0,0],[0,1],[0,2],[0,3]],hScores:{"0,4":7,"1,3":8},phase:"h decreasing!"},duration:7e3},{id:5,type:"visualize",title:"Step 5-6: Continue Right",narration:"Pop [0,4], [0,5]. h keeps dropping! Walls at [1,5],[1,6] dont affect row 0.",visualState:{algorithm:"greedy",currentCell:[0,5],openCells:[[1,0],[1,3],[0,6]],visitedCells:[[0,0],[0,1],[0,2],[0,3],[0,4],[0,5]],hScores:{"0,6":5,"0,7":4},phase:"Beelining!"},duration:7e3},{id:6,type:"visualize",title:"Step 7-8: Top Row Sprint",narration:"Pop [0,6], [0,7]. We reached column 7! Now need to go down to [4,7].",visualState:{algorithm:"greedy",currentCell:[0,7],openCells:[[1,0],[1,3],[1,7]],visitedCells:[[0,0],[0,1],[0,2],[0,3],[0,4],[0,5],[0,6],[0,7]],hScores:{"1,7":3},phase:"Top row done!"},duration:8e3},{id:7,type:"visualize",title:"Step 9-10: Going Down",narration:"Pop [1,7], [2,7], [3,7]. h = 3, 2, 1. Almost there! Straight path down!",visualState:{algorithm:"greedy",currentCell:[3,7],openCells:[[1,0],[1,3],[4,7]],visitedCells:[[0,0],[0,1],[0,2],[0,3],[0,4],[0,5],[0,6],[0,7],[1,7],[2,7],[3,7]],hScores:{"4,7":0},phase:"hâ†’0!"},duration:8e3},{id:8,type:"visualize",title:"GOAL FOUND!",narration:"Pop [4,7] - GOAL! h=0. Fast path but is it shortest? Greedy ignores cost traveled!",visualState:{algorithm:"greedy",currentCell:[4,7],openCells:[],visitedCells:[[0,0],[0,1],[0,2],[0,3],[0,4],[0,5],[0,6],[0,7],[1,7],[2,7],[3,7],[4,7]],phase:"GOAL! h=0"},duration:8e3,interactive:!0,challenge:{type:"select",question:"Is this guaranteed shortest?",options:["Yes","No, ignores g"],correct:1}},{id:9,type:"visualize",title:"Path Found",narration:"Path: [0,0]â†’[0,1]â†’[0,2]â†’[0,3]â†’[0,4]â†’[0,5]â†’[0,6]â†’[0,7]â†’[1,7]â†’[2,7]â†’[3,7]â†’[4,7]",visualState:{algorithm:"greedy",currentCell:null,openCells:[],visitedCells:[],pathCells:[[0,0],[0,1],[0,2],[0,3],[0,4],[0,5],[0,6],[0,7],[1,7],[2,7],[3,7],[4,7]],phase:"Path Found!"},duration:9e3},{id:10,type:"intro",title:"Congratulations!",narration:"Greedy complete! Yellow=open, Blue=current, Green=closed, Orange=path. Fast but not optimal!",visualState:{phase:"ðŸŽ‰ Complete!"},duration:6e3}],quiz:[{question:"Greedy Best-First uses?",options:["g only","h only","g + h"],correct:1}]});const L2={problems:{"two-sum":{title:"Two Sum",difficulty:"Easy",category:"ðŸ—ƒï¸ Hash Map",description:"Given an array of integers nums and a target, return indices of two numbers that add up to target.",steps:[{title:"Understanding the Problem",narration:"We need to find two numbers in the array that add up to our target sum. The brute force approach would check every pair, but that would be O of n squared.",code:`// Input: nums = [2, 7, 11, 15], target = 9
// Output: [0, 1] because nums[0] + nums[1] = 9`},{title:"The Hash Map Insight",narration:"Heres the key insight: as we scan the array, for each number x, we need to find target minus x. A hash map lets us check this in O of 1 time!",code:`// For target = 9 and nums[0] = 2
// We need: 9 - 2 = 7
// Is 7 in our map? Check instantly!`},{title:"Building the Solution",narration:"We iterate through the array once. For each number, check if the complement exists in our map. If yes, we found our answer. If no, add the current number to the map.",code:`function twoSum(nums, target) {
  const map = new Map();
  for (let i = 0; i < nums.length; i++) {
    const complement = target - nums[i];
    if (map.has(complement)) {
      return [map.get(complement), i];
    }
    map.set(nums[i], i);
  }
}`},{title:"Complexity Analysis",narration:"Time complexity is O of n because we traverse the array once. Space complexity is O of n for the hash map. Much better than O of n squared brute force!",code:`// Time: O(n) - single pass
// Space: O(n) - hash map storage`}]},"valid-parentheses":{title:"Valid Parentheses",difficulty:"Easy",category:"ðŸ“š Stack",description:"Given a string containing brackets, determine if the input string is valid.",steps:[{title:"Understanding Validity",narration:"A valid string has every opening bracket closed by the same type in the correct order. Think of it like nesting: the most recent opening bracket must close first.",code:`// Valid: "([]){}" âœ“
// Invalid: "([)]" âœ— - wrong order
// Invalid: "(((" âœ— - not closed`},{title:"Stack Intuition",narration:"A stack is perfect here! Push opening brackets. When we see a closing bracket, pop and check if it matches. If they dont match, or stack is empty when we need to pop, its invalid.",code:`// For input "[()]"
// See "[" -> push
// See "(" -> push  Stack: ["[", "("]
// See ")" -> pop, matches "(" âœ“
// See "]" -> pop, matches "[" âœ“`},{title:"Implementation",narration:"We use a map for bracket pairs. Iterate through the string, pushing opening brackets and checking closing ones against the top of stack.",code:`function isValid(s) {
  const stack = [];
  const pairs = {"(": ")", "[": "]", "{": "}"};
  
  for (const char of s) {
    if (pairs[char]) {
      stack.push(char);
    } else {
      if (pairs[stack.pop()] !== char) {
        return false;
      }
    }
  }
  return stack.length === 0;
}`},{title:"Complexity",narration:"Time is O of n, we visit each character once. Space is O of n in worst case, like all opening brackets.",code:`// Time: O(n)
// Space: O(n)`}]},"climbing-stairs":{title:"Climbing Stairs",difficulty:"Easy",category:"ðŸ§® Dynamic Programming",description:"You can climb 1 or 2 steps at a time. How many distinct ways to reach step n?",steps:[{title:"Recognizing the Pattern",narration:"This is the classic Fibonacci problem in disguise! To reach step n, you either came from step n minus 1 or step n minus 2.",code:`// n=1: 1 way (1)
// n=2: 2 ways (1+1, 2)
// n=3: 3 ways (1+1+1, 1+2, 2+1)
// n=4: 5 ways
// See the pattern? 1, 2, 3, 5, 8...`},{title:"The Recurrence",narration:"Ways to reach step n equals ways to step n minus 1 plus ways to step n minus 2. This is exactly the Fibonacci formula!",code:`// f(n) = f(n-1) + f(n-2)
// Base cases:
// f(1) = 1
// f(2) = 2`},{title:"DP Solution",narration:"Instead of recursive calls which would be exponential, we build up from the base cases. We only need two previous values.",code:`function climbStairs(n) {
  if (n <= 2) return n;
  let prev1 = 1, prev2 = 2;
  for (let i = 3; i <= n; i++) {
    const current = prev1 + prev2;
    prev1 = prev2;
    prev2 = current;
  }
  return prev2;
}`},{title:"Optimal Complexity",narration:"Time is O of n, space is O of 1 since we only store two variables. Much better than the O of 2 to the n recursive approach!",code:`// Time: O(n)
// Space: O(1)`}]},"binary-search":{title:"Binary Search",difficulty:"Easy",category:"ðŸ” Searching",description:"Search for a target in a sorted array. Return index or -1.",steps:[{title:"The Power of Sorted Arrays",narration:"Binary search is one of the most important algorithms. With a sorted array, we can eliminate half the search space with each comparison.",code:`// Linear Search: Check EVERY element O(n)
// Binary Search: Eliminate HALF each time O(log n)
// For n=1000000: 1000000 vs 20 comparisons!`},{title:"How It Works",narration:"Look at the middle element. If its our target, done! If target is smaller, search left half. If larger, search right half. Repeat.",code:`// arr = [1, 3, 5, 7, 9, 11], target = 7
// mid = arr[2] = 5  ->  7 > 5, go right
// mid = arr[4] = 9  ->  7 < 9, go left
// mid = arr[3] = 7  ->  Found!`},{title:"Implementation",narration:"We maintain left and right pointers. Calculate mid, compare, and adjust pointers. Very important: use left plus right minus left divided by 2 to avoid overflow.",code:`function binarySearch(nums, target) {
  let left = 0, right = nums.length - 1;
  
  while (left <= right) {
    const mid = left + Math.floor((right-left)/2);
    if (nums[mid] === target) return mid;
    if (nums[mid] < target) left = mid + 1;
    else right = mid - 1;
  }
  return -1;
}`},{title:"Logarithmic Magic",narration:"Time is O of log n because we halve the search space each iteration. Space is O of 1. This is why binary search is so powerful!",code:`// Time: O(log n)
// Space: O(1)`}]}},currentProblem:null,currentStep:0,start(t){const e=this.problems[t];if(!e){T("Problem not found","error");return}this.currentProblem=e,this.currentStep=0,this.showUI(),this.showStep(0)},showUI(){let t=document.getElementById("problemWalkthroughModal");t||(t=document.createElement("div"),t.id="problemWalkthroughModal",t.className="problem-walkthrough-modal",document.body.appendChild(t)),t.innerHTML=`
      <div class="problem-walkthrough-content">
        <div class="problem-header">
          <div class="problem-title-section">
            <h2>${this.currentProblem.title}</h2>
            <span class="problem-difficulty ${this.currentProblem.difficulty.toLowerCase()}">${this.currentProblem.difficulty}</span>
            <span class="problem-category">${this.currentProblem.category}</span>
          </div>
          <button class="modal-close" onclick="ProblemNarration.close()">âœ•</button>
        </div>
        
        <div class="problem-description">${this.currentProblem.description}</div>
        
        <div class="step-container" id="problemStepContainer"></div>
        
        <div class="walkthrough-controls">
          <button class="btn btn-secondary" onclick="ProblemWalkthrough.prevStep()" id="problemPrevBtn" disabled>
            â®ï¸ Previous
          </button>
          <div class="step-progress">
            <span id="problemStepProgress">Step 1 of ${this.currentProblem.steps.length}</span>
          </div>
          <button class="btn btn-primary" onclick="ProblemWalkthrough.nextStep()" id="problemNextBtn">
            Next â­ï¸
          </button>
        </div>
        
        <div class="narration-controls">
          <button class="btn btn-accent" onclick="ProblemWalkthrough.narrateStep()" id="narrateBtn">
            ðŸŽ¤ Narrate
          </button>
        </div>
      </div>
    `,t.classList.add("active")},showStep(t){const e=this.currentProblem.steps[t],i=document.getElementById("problemStepContainer");i.innerHTML=`
      <div class="step-title">${e.title}</div>
      <div class="step-narration">${e.narration}</div>
      <pre class="step-code"><code>${this.escapeHtml(e.code)}</code></pre>
    `,document.getElementById("problemStepProgress").textContent=`Step ${t+1} of ${this.currentProblem.steps.length}`,document.getElementById("problemPrevBtn").disabled=t===0,document.getElementById("problemNextBtn").disabled=t>=this.currentProblem.steps.length-1},nextStep(){this.currentStep<this.currentProblem.steps.length-1&&(this.currentStep++,this.showStep(this.currentStep))},prevStep(){this.currentStep>0&&(this.currentStep--,this.showStep(this.currentStep))},narrateStep(){const t=this.currentProblem.steps[this.currentStep];if(window.ELectureNarrator)V.speak(t.narration);else{const e=new SpeechSynthesisUtterance(t.narration);e.rate=.9,speechSynthesis.speak(e)}},close(){const t=document.getElementById("problemWalkthroughModal");t&&t.classList.remove("active"),speechSynthesis.cancel()},escapeHtml(t){const e=document.createElement("div");return e.textContent=t,e.innerHTML},getAll(){return Object.entries(this.problems).map(([t,e])=>({id:t,...e}))}};window.ProblemNarration=L2;const M0={activeCategory:"all",getCategories(){const t=new Set;return ge.getAll().forEach(e=>t.add(e.category)),["all",...Array.from(t)]},getLecturesByCategory(t){const e=ge.getAll();return t==="all"?e:e.filter(i=>i.category===t)},showBrowser(){let t=document.getElementById("lectureBrowserOverlay");t||(t=document.createElement("div"),t.id="lectureBrowserOverlay",t.className="lecture-browser-overlay",document.body.appendChild(t)),t.classList.add("active"),this.renderBrowser()},closeBrowser(){const t=document.getElementById("lectureBrowserOverlay");t&&t.classList.remove("active")},setCategory(t){this.activeCategory=t,this.renderBrowser()},renderBrowser(){const t=document.getElementById("lectureBrowserOverlay");if(!t)return;const e=this.getCategories(),i=this.getLecturesByCategory(this.activeCategory),s=ELectureGamification.getProgress();t.innerHTML=`
      <div class="lecture-browser">
        <div class="browser-header">
          <h2>ðŸ“š E-Learning Library</h2>
          <button class="browser-close" onclick="LectureBrowser.closeBrowser()">âœ•</button>
        </div>
        
        <div class="browser-progress-bar">
          <div class="progress-info">
            <span class="level-badge">Level ${s.level}</span>
            <span class="xp-text">${s.totalXP} XP</span>
            <span class="streak-badge">${s.streak>0?"ðŸ”¥ "+s.streak+" day streak":""}</span>
          </div>
          <div class="xp-bar">
            <div class="xp-fill" style="width: ${Math.min(100,s.totalXP/(s.level*100)*100)}%"></div>
          </div>
        </div>
        
        
        <div class="browser-categories">
          ${e.map(r=>`
            <button class="category-btn ${r===this.activeCategory?"active":""}" 
                    onclick="LectureBrowser.setCategory('${r}')">
              ${r==="all"?"ðŸ“‹ All":this.getCategoryIcon(r)+" "+this.formatCategory(r)}
            </button>
          `).join("")}
          <button class="category-btn practice-problems-btn" 
                  onclick="LectureBrowser.closeBrowser(); setTimeout(() => { 
                    let modal = document.getElementById('problemsModal');
                    if (!modal) {
                      modal = document.createElement('div');
                      modal.id = 'problemsModal';
                      modal.className = 'learning-modal';
                      document.body.appendChild(modal);
                    }
                    const problems = ProblemNarration.getAll();
                    const problemCards = problems.map(p => \`
                      <div class=&quot;problem-card&quot; onclick=&quot;document.getElementById('problemsModal').classList.remove('active'); ProblemNarration.start('\${p.id}');&quot;>
                        <div class=&quot;problem-card-header&quot;>
                          <span class=&quot;problem-card-title&quot;>\${p.title}</span>
                          <span class=&quot;problem-difficulty \${p.difficulty.toLowerCase()}&quot;>\${p.difficulty}</span>
                        </div>
                        <div class=&quot;problem-card-category&quot;>\${p.category}</div>
                        <div class=&quot;problem-card-desc&quot;>\${p.description}</div>
                        <div class=&quot;problem-card-steps&quot;>\${p.steps.length} steps</div>
                      </div>
                    \`).join('');
                    modal.innerHTML = \`
                      <div class=&quot;learning-modal-content&quot; style=&quot;max-width: 700px;&quot;>
                        <div class=&quot;learning-modal-header&quot;>
                          <h3>ðŸ“ Practice Problems</h3>
                          <button class=&quot;modal-close&quot; onclick=&quot;document.getElementById('problemsModal').classList.remove('active')&quot;>âœ•</button>
                        </div>
                        <div class=&quot;problem-grid&quot;>
                          \${problemCards}
                        </div>
                      </div>
                    \`;
                    modal.classList.add('active');
                  }, 100);" style="background: linear-gradient(135deg, #22c55e, #16a34a);">
            ðŸ“ Practice Problems
          </button>
        </div>
        
        <div class="browser-lectures">
          ${i.map(r=>{const n=s.completedLessons.includes(r.id),a=r.prerequisiteConcept?ConceptLibrary.get(r.prerequisiteConcept):null;return`
              <div class="lecture-card ${n?"completed":""}" onclick="LectureBrowser.startLecture('${r.id}')">
                <div class="card-header">
                  <span class="difficulty-badge ${r.difficulty}">${r.difficulty}</span>
                  ${n?'<span class="completed-badge">âœ“</span>':""}
                </div>
                <h3 class="card-title">${r.title}</h3>
                <p class="card-desc">${r.description}</p>
                <div class="card-meta">
                  <span class="meta-item">â±ï¸ ${r.duration}</span>
                  <span class="meta-item">ðŸ† ${r.xpReward} XP</span>
                </div>
                ${a?`
                  <div class="concept-link" onclick="event.stopPropagation(); LectureBrowser.showConcept('${a.id}')">
                    ðŸ’¡ Learn ${a.title} first
                  </div>
                `:""}
              </div>
            `}).join("")}
        </div>
      </div>
    `},getCategoryIcon(t){return{sorting:"ðŸ“Š",searching:"ðŸ”",arrays:"ðŸ“‹",strings:"ðŸ“","dynamic-programming":"ðŸ§©",graphs:"ðŸ•¸ï¸",stacks:"ðŸ“š","linked-lists":"ðŸ”—","two-pointer":"ðŸ‘†","binary-search":"ðŸŽ¯",design:"ðŸ—ï¸"}[t]||"ðŸ“–"},formatCategory(t){return t.split("-").map(e=>e[0].toUpperCase()+e.slice(1)).join(" ")},startLecture(t){this.closeBrowser(),De.load(t)},showConcept(t){if(!ConceptLibrary.get(t))return;let i=document.getElementById("conceptModal");i||(i=document.createElement("div"),i.id="conceptModal",i.className="concept-modal-overlay",document.body.appendChild(i)),i.classList.add("active"),i.innerHTML=`
      <div class="concept-modal">
        <button class="modal-close" onclick="document.getElementById('conceptModal').classList.remove('active')">âœ•</button>
        ${ConceptLibrary.renderConcept(t)}
        <div class="concept-actions">
          <button class="play-concept-btn" onclick="ConceptLibrary.playConcept('${t}')">
            ðŸŽ™ï¸ Listen to Explanation
          </button>
          <button class="close-btn" onclick="document.getElementById('conceptModal').classList.remove('active')">
            Got it!
          </button>
        </div>
      </div>
    `}};window.LectureBrowser=M0;const Al={approaches:new Map,register(t){this.approaches.set(t.id,t)},get(t){return this.approaches.get(t)},getForLecture(t){return Array.from(this.approaches.values()).filter(e=>e.lectureId===t)},renderApproach(t){const e=this.get(t);return e?`
      <div class="naive-approach">
        <div class="naive-header">
          <span class="naive-icon">âš ï¸</span>
          <h3>${e.title}</h3>
          <span class="complexity-badge bad">${e.naiveComplexity}</span>
        </div>
        
        <div class="naive-intro">
          <p>${e.intro}</p>
        </div>
        
        <div class="naive-code">
          <div class="code-label">The Obvious Approach:</div>
          <pre><code>${e.naiveCode}</code></pre>
        </div>
        
        <div class="naive-problem">
          <div class="problem-label">âŒ Why It Fails:</div>
          <p>${e.whyFails}</p>
        </div>
        
        <div class="scale-comparison">
          <div class="scale-label">At Scale:</div>
          <div class="scale-bars">
            ${e.scaleDemo.map(i=>`
              <div class="scale-item">
                <span class="n-label">n = ${i.n.toLocaleString()}</span>
                <div class="bar-container">
                  <div class="bar naive" style="width: ${Math.min(100,i.naiveOps/e.scaleDemo[e.scaleDemo.length-1].naiveOps*100)}%">
                    ${i.naiveOps.toLocaleString()} ops
                  </div>
                </div>
              </div>
            `).join("")}
          </div>
        </div>
        
        <div class="naive-transition">
          <p>ðŸ’¡ ${e.transition}</p>
        </div>
      </div>
    `:""},playApproach(t){const e=this.get(t);e&&V.speak(e.narration)}};Al.register({id:"two-sum-naive",lectureId:"two-sum-sorted",title:"The Brute Force Trap",naiveComplexity:"O(nÂ²)",optimalComplexity:"O(n)",intro:"When you first see this problem, the obvious solution jumps out: just check every possible pair using two nested loops.",naiveCode:`function twoSumNaive(arr, target) {
  // Check every pair - O(nÂ²)
  for (let i = 0; i < arr.length; i++) {
    for (let j = i + 1; j < arr.length; j++) {
      if (arr[i] + arr[j] === target) {
return [i, j];
      }
    }
  }
  return [-1, -1];
}`,whyFails:"With nested loops, we check nÃ—(n-1)/2 pairs. For 10,000 elements, that's nearly 50 million comparisons. The array is SORTED, but we're completely ignoring that valuable property!",scaleDemo:[{n:100,naiveOps:4950,optimalOps:100},{n:1e3,naiveOps:499500,optimalOps:1e3},{n:1e4,naiveOps:49995e3,optimalOps:1e4}],transition:"The array is sorted. That one word changes everything. With two pointers, we can find the answer in a single pass.",narration:"When you first see this problem, your brain immediately thinks: just check every pair. Two nested loops, compare each element with every other. And it works! But look at the cost. For a thousand elements, we make half a million comparisons. The array is sorted, but we're ignoring that completely. That's the trap. The optimal solution uses two pointers and solves it in just one pass."});Al.register({id:"binary-search-naive",lectureId:"binary-search",title:"Linear Scan: The Slow Path",naiveComplexity:"O(n)",optimalComplexity:"O(log n)",intro:"The simplest way to find an element? Start at the beginning and check each one until you find it.",naiveCode:`function linearSearch(arr, target) {
  // Check every element - O(n)
  for (let i = 0; i < arr.length; i++) {
    if (arr[i] === target) {
      return i;
    }
  }
  return -1;
}`,whyFails:"Linear search checks every element one by one. If the target is at the end (or not there), we check ALL n elements. But with a sorted array, we can eliminate HALF the remaining elements with each comparison!",scaleDemo:[{n:100,naiveOps:100,optimalOps:7},{n:1e3,naiveOps:1e3,optimalOps:10},{n:1e6,naiveOps:1e6,optimalOps:20}],transition:"Binary search cuts the search space in half each time. For a million elements, just 20 comparisons instead of a million!",narration:"Linear search is simple. Start at the beginning, check each element. But it's painfully slow. For a million elements, worst case is a million checks. Binary search? Just 20. Because each comparison eliminates half the remaining possibilities. That's the power of logarithmic time."});Al.register({id:"coin-change-naive",lectureId:"coin-change",title:"The Greedy Trap",naiveComplexity:"Wrong Answer!",optimalComplexity:"O(amount Ã— coins)",intro:"Greedy seems perfect: always pick the largest coin that fits. Simple, fast, intuitive. But fundamentally broken.",naiveCode:`function coinChangeGreedy(coins, amount) {
  // Sort coins descending - always pick largest
  coins.sort((a, b) => b - a);
  let count = 0;
  
  for (const coin of coins) {
    while (amount >= coin) {
      amount -= coin;
      count++;
    }
  }
  
  return amount === 0 ? count : -1;
}`,whyFails:"Coins [1, 3, 4], amount 6. Greedy picks: 4 + 1 + 1 = 3 coins. But 3 + 3 = 2 coins is better! Greedy makes locally optimal choices that lead to globally suboptimal results.",scaleDemo:[{n:6,naiveOps:3,optimalOps:2},{n:12,naiveOps:4,optimalOps:3},{n:15,naiveOps:5,optimalOps:4}],transition:"Dynamic Programming considers ALL combinations efficiently. Build up from smaller amounts, remembering optimal solutions.",narration:"Greedy is tempting. Always pick the biggest coin. It's fast, it's simple. But it's wrong. Coins 1, 3, 4. Amount 6. Greedy picks 4, then 1, then 1. Three coins. But 3 plus 3 is only two coins! Greedy makes locally optimal choices that lead to globally suboptimal results. We need Dynamic Programming to consider all paths and find the true minimum."});window.NaiveApproachLibrary=Al;const pr={mistakes:new Map,register(t){this.mistakes.set(t.id,t)},get(t){return this.mistakes.get(t)},getByCategory(t){return Array.from(this.mistakes.values()).filter(e=>e.category===t)},getAll(){return Array.from(this.mistakes.values())},renderMistake(t){const e=this.get(t);return e?`
      <div class="mistake-card">
        <div class="mistake-header">
          <span class="mistake-category">${e.category}</span>
          <h3>${e.name}</h3>
        </div>
        
        <div class="code-comparison">
          <div class="code-side wrong">
            <div class="side-label">âŒ Wrong</div>
            <pre><code>${e.wrongCode}</code></pre>
          </div>
          <div class="code-side correct">
            <div class="side-label">âœ“ Correct</div>
            <pre><code>${e.correctCode}</code></pre>
          </div>
        </div>
        
        <div class="mistake-explanation">
          <strong>Why it fails:</strong> ${e.explanation}
        </div>
        
        ${e.context?`<div class="mistake-context">ðŸ“Œ Common in: ${e.context}</div>`:""}
      </div>
    `:""},playMistake(t){const e=this.get(t);e&&V.speak(e.narration)}};pr.register({id:"off-by-one-length",category:"Off-By-One",name:"Array Length vs Last Index",context:"All array problems",wrongCode:`// WRONG: Goes one too far!
for (let i = 0; i <= arr.length; i++) {
  console.log(arr[i]); // undefined at last
}`,correctCode:`// CORRECT: Use < not <=
for (let i = 0; i < arr.length; i++) {
  console.log(arr[i]);
}`,explanation:"Array of length 5 has indices 0-4, not 0-5. Using <= goes one past the end.",narration:"Off by one. The most common bug in programming. An array with five elements has indices zero through four, not zero through five. Using less than or equal goes one step too far and accesses undefined."});pr.register({id:"off-by-one-pointers",category:"Off-By-One",name:"Two Pointers Same Element",context:"Two Sum, Container Water",wrongCode:`// WRONG: Can use same element twice!
while (left <= right) {
  // left === right means same index
}`,correctCode:`// CORRECT: Strict inequality
while (left < right) {
  // Ensures different indices
}`,explanation:"Two Sum needs TWO different elements. If left equals right, we add one number to itself.",narration:"When using two pointers for Two Sum, we need two different numbers. Less than or equal lets left equal right, which means adding one number to itself. That is not valid."});pr.register({id:"boundary-empty",category:"Boundary",name:"Empty Array Access",context:"Find Max, Binary Search",wrongCode:`// WRONG: Crashes on empty!
function findMax(arr) {
  let max = arr[0]; // undefined!
  ...
}`,correctCode:`// CORRECT: Check first
function findMax(arr) {
  if (arr.length === 0) return null;
  let max = arr[0];
  ...
}`,explanation:"Accessing arr[0] on empty array gives undefined. Always check length first.",narration:"Empty array is a classic edge case. Accessing index zero on an empty array gives undefined. Comparing with undefined gives unexpected results. Always check if the array is empty first."});pr.register({id:"type-string-number",category:"Type Mismatch",name:"Grid String Characters",context:"Number of Islands",wrongCode:`// WRONG: Grid uses strings!
if (grid[r][c] === 1) { // Never true
  // grid[r][c] is "1", not 1
}`,correctCode:`// CORRECT: Compare with string
if (grid[r][c] === '1') {
  // Now it matches
}`,explanation:'LeetCode grids often use string characters. "1" is not equal to 1.',narration:"Number of Islands is a classic trap. The grid uses string characters, not numbers. Comparing with number one never matches string quote one quote. Always check what type your data is."});pr.register({id:"init-dp-wrong",category:"Wrong Init",name:"DP Array Zero Default",context:"Coin Change, DP Problems",wrongCode:`// WRONG: Zero breaks Math.min!
const dp = new Array(n).fill(0);
// Math.min(0, something) = 0 always`,correctCode:`// CORRECT: Use Infinity
const dp = new Array(n).fill(Infinity);
dp[0] = 0; // Base case`,explanation:'Initialize DP to Infinity for minimization problems. Zero means "already solved" which breaks the logic.',narration:"In Coin Change, initializing to zero breaks the minimization. Zero means already solved with zero coins. We need Infinity to represent not yet solved, so any valid solution wins the minimum comparison."});pr.register({id:"logic-bst-local",category:"Logic Error",name:"BST Only Checks Parent",context:"Validate BST",wrongCode:`// WRONG: Only checks immediate parent
if (node.left.val >= node.val) return false;
if (node.right.val <= node.val) return false;`,correctCode:`// CORRECT: Track valid range
function isValid(node, min, max) {
  if (node.val <= min || node.val >= max) 
    return false;
  return isValid(node.left, min, node.val) &&
 isValid(node.right, node.val, max);
}`,explanation:"A BST node must be greater than ALL ancestors on left path, not just immediate parent.",narration:"A common BST validation mistake: only checking the immediate parent. But a node in the right subtree must be greater than all ancestors above it, not just its parent. Pass down the valid range as you recurse."});window.MistakesLibrary=pr;const N2={mode:"split",isAnimating:!1,syncEnabled:!0,setMode(t){this.mode=t;const e=document.querySelector(".electure-flip-container");e&&(e.dataset.mode=t,document.querySelectorAll(".view-mode-btn").forEach(i=>{i.classList.toggle("active",i.dataset.mode===t)}))},flipToCode(){if(this.isAnimating)return;this.isAnimating=!0;const t=document.getElementById("eLectureFlipCard");t&&(t.dataset.side="code",t.classList.add("flipping"),setTimeout(()=>{t.classList.remove("flipping"),this.isAnimating=!1},600))},flipToVisual(){if(this.isAnimating)return;this.isAnimating=!0;const t=document.getElementById("eLectureFlipCard");t&&(t.dataset.side="visual",t.classList.add("flipping"),setTimeout(()=>{t.classList.remove("flipping"),this.isAnimating=!1},600))},toggle(){const t=document.getElementById("eLectureFlipCard");t&&(t.dataset.side==="code"?this.flipToVisual():this.flipToCode())},syncWithNarration(t){if(!this.syncEnabled)return;const e=t.toLowerCase(),i=["look at","see how","watch","notice","observe","visualize","array looks","pointer moves"],s=["the code","this line","function","return","variable","loop","if statement"],r=i.some(a=>e.includes(a)),n=s.some(a=>e.includes(a));r&&!n?this.flipToVisual():n&&!r&&this.flipToCode()},highlightCodeLines(t){document.querySelectorAll(".electure-code-line").forEach(e=>{const i=parseInt(e.dataset.line);e.classList.toggle("highlighted",t.includes(i))})},renderControls(){return`
      <div class="view-mode-controls">
        <button class="view-mode-btn ${this.mode==="code"?"active":""}" 
                data-mode="code" onclick="FlipCardSync.setMode('code')">
          ðŸ’» Code
        </button>
        <button class="view-mode-btn ${this.mode==="split"?"active":""}" 
                data-mode="split" onclick="FlipCardSync.setMode('split')">
          âš¡ Split
        </button>
        <button class="view-mode-btn ${this.mode==="visual"?"active":""}" 
                data-mode="visual" onclick="FlipCardSync.setMode('visual')">
          ðŸ“Š Visual
        </button>
        <button class="flip-toggle-btn" onclick="FlipCardSync.toggle()" title="Flip (F key)">
          ðŸ”„
        </button>
      </div>
    `}};window.FlipCardSync=N2;const tu={storageKey:"electure_settings",defaults:{narrationSpeed:1,narrationEnabled:!0,reducedMotion:!1,highContrast:!1,fontSize:"medium",autoAdvance:!1},speedOptions:[{label:"Slow",value:.7},{label:"Normal",value:1},{label:"Fast",value:1.3},{label:"Very Fast",value:1.6}],fontSizeOptions:[{label:"Small",value:"small"},{label:"Medium",value:"medium"},{label:"Large",value:"large"}],load(){try{const t=localStorage.getItem(this.storageKey);return t?{...this.defaults,...JSON.parse(t)}:{...this.defaults}}catch{return{...this.defaults}}},save(t){try{localStorage.setItem(this.storageKey,JSON.stringify(t)),this.apply(t)}catch(e){console.warn("Could not save settings:",e)}},get(t){return this.load()[t]},set(t,e){const i=this.load();i[t]=e,this.save(i)},apply(t){V&&V.setSpeed&&V.setSpeed(t.narrationSpeed),document.body.classList.toggle("reduce-motion",t.reducedMotion),document.body.classList.toggle("high-contrast",t.highContrast),document.body.dataset.fontSize=t.fontSize},render(){const t=this.load();return`
      <div class="settings-panel">
        <div class="settings-header">
          <h3>âš™ï¸ Settings</h3>
          <button class="settings-close" onclick="SettingsPanel.close()">âœ•</button>
        </div>
        
        <div class="settings-group">
          <label>Narration Speed</label>
          <div class="speed-buttons">
            ${this.speedOptions.map(e=>`
              <button class="speed-btn ${t.narrationSpeed===e.value?"active":""}"
                      onclick="SettingsPanel.set('narrationSpeed', ${e.value})">
                ${e.label}
              </button>
            `).join("")}
          </div>
        </div>
        
        <div class="settings-group">
          <label class="toggle-label">
            <input type="checkbox" ${t.narrationEnabled?"checked":""}
                   onchange="SettingsPanel.set('narrationEnabled', this.checked)">
            <span>Enable Narration</span>
          </label>
        </div>
        
        <div class="settings-group">
          <label class="toggle-label">
            <input type="checkbox" ${t.reducedMotion?"checked":""}
                   onchange="SettingsPanel.set('reducedMotion', this.checked)">
            <span>Reduce Motion</span>
          </label>
        </div>
        
        <div class="settings-group">
          <label class="toggle-label">
            <input type="checkbox" ${t.highContrast?"checked":""}
                   onchange="SettingsPanel.set('highContrast', this.checked)">
            <span>High Contrast</span>
          </label>
        </div>
        
        <div class="settings-group">
          <label>Font Size</label>
          <div class="font-buttons">
            ${this.fontSizeOptions.map(e=>`
              <button class="font-btn ${t.fontSize===e.value?"active":""}"
                      onclick="SettingsPanel.set('fontSize', '${e.value}')">
                ${e.label}
              </button>
            `).join("")}
          </div>
        </div>
      </div>
    `},show(){let t=document.getElementById("settingsPanelOverlay");t||(t=document.createElement("div"),t.id="settingsPanelOverlay",t.className="settings-overlay",document.body.appendChild(t)),t.innerHTML=this.render(),t.classList.add("active")},close(){const t=document.getElementById("settingsPanelOverlay");t&&t.classList.remove("active")},init(){window.matchMedia("(prefers-reduced-motion: reduce)").matches&&this.set("reducedMotion",!0),this.apply(this.load())}};window.SettingsPanel=tu;tu.init();ge.register({id:"two-sum-sorted",title:"Two Sum in Sorted Array",course:"algorithms",category:"arrays",difficulty:"beginner",duration:"20 min",description:"Find two numbers that add up to a target using the Two-Pointer technique.",xpReward:150,prerequisiteConcept:"two-pointer",code:{languages:{python:{source:`def two_sum(numbers, target):
    # Step 1: Set up two pointers
    left = 0                         # Start of array
    right = len(numbers) - 1         # End of array
    
    # Step 2: Keep searching while pointers haven't crossed
    while left < right:
        # Step 3: Calculate current sum
        current_sum = numbers[left] + numbers[right]
        
        # Step 4: Check if we found the answer
        if current_sum == target:
            return [left + 1, right + 1]  # Found it! (1-indexed)
        # Step 5: Sum too small? Move left pointer right
        elif current_sum < target:
            left += 1
        # Step 6: Sum too big? Move right pointer left
        else:
            right -= 1
    
    # No solution found
    return []`,highlightRanges:{setup:{start:2,end:4},while_loop:{start:7,end:7},calc_sum:{start:9,end:9},check_found:{start:12,end:13},too_small:{start:15,end:16},too_big:{start:18,end:19},no_solution:{start:22,end:22}}},java:{source:`public static int[] twoSum(int[] numbers, int target) {
    // Step 1: Set up two pointers
    int left = 0;                      // Start of array
    int right = numbers.length - 1;    // End of array
    
    // Step 2: Keep searching while pointers haven't crossed
    while (left < right) {
        // Step 3: Calculate current sum
        int sum = numbers[left] + numbers[right];
        
        // Step 4: Check if we found the answer
        if (sum == target) {
            return new int[]{left + 1, right + 1}; // Found it! (1-indexed)
        }
        // Step 5: Sum too small? Move left pointer right
        else if (sum < target) {
            left++;
        }
        // Step 6: Sum too big? Move right pointer left
        else {
            right--;
        }
    }
    
    // No solution found
    return new int[]{};
}`,highlightRanges:{setup:{start:2,end:4},while_loop:{start:7,end:7},calc_sum:{start:9,end:9},check_found:{start:12,end:14},too_small:{start:16,end:18},too_big:{start:20,end:22},no_solution:{start:26,end:26}}}}},steps:[{id:1,type:"intro",showSide:"visual",title:"ðŸ‘‹ Welcome! Let's Solve Two Sum",narration:"Hey there! Today we're going to solve a classic interview problem called Two Sum. Here's the challenge: you're given a sorted array of numbers and a target sum. Your job is to find TWO numbers in the array that add up to that target. For example, look at this array: [1, 3, 5, 7, 9, 11]. If our target is 12, we need to find which two numbers add up to 12. Can you spot them? Take a moment to think!",codeHighlight:null,visualState:{array:[1,3,5,7,9,11],target:12,phase:"ðŸŽ¯ Find two numbers that sum to 12",annotation:"Look at the array... which two add to 12?"},duration:1e4,interactive:!1},{id:2,type:"intro",showSide:"visual",title:"ðŸ¤” The Obvious (But Slow) Way",narration:"The first idea that comes to mind is: check every possible pair! Pick the first number, try adding it to every other number. Then pick the second number, try adding it to every remaining number. And so on. This is called the 'brute force' approach. It works, but here's the problem: for an array with 1000 numbers, you'd need to check almost 500,000 pairs! That's way too slow for big arrays.",codeHighlight:null,visualState:{array:[1,3,5,7,9,11],phase:"ðŸ¢ Brute Force: Check ALL pairs",annotation:"For n=1000: ~500,000 checks! O(nÂ²) = SLOW"},duration:1e4,interactive:!0,challenge:{type:"predict",question:"For an array of 1000 elements, roughly how many pairs would we check?",options:["About 1,000","About 10,000","About 500,000","About 1,000,000"],correct:2,explanation:"With n=1000, we check nÃ—(n-1)/2 â‰ˆ 500,000 pairs. That's O(nÂ²) - very slow!"}},{id:3,type:"intro",showSide:"visual",title:"ðŸ’¡ The Key Insight: It's SORTED!",narration:"Here's the game-changer: the array is SORTED! This isn't just a small detail - it's the key to a much faster solution. In a sorted array, small numbers are on the left and big numbers are on the right. This means if we're smart about where we look, we can skip most of the work! Instead of checking every pair, we'll use two pointers - one starting at each end of the array.",codeHighlight:null,visualState:{array:[1,3,5,7,9,11],phase:"âœ¨ Sorted Array = Special Powers!",annotation:"Small â† [sorted] â†’ Big"},duration:9e3,interactive:!1},{id:4,type:"code_explain",showSide:"code",title:"ðŸ“ Step 1: Set Up Two Pointers",narration:"Let's look at the code! First, we create two pointers. Think of them as two helpers standing at opposite ends of the array. The LEFT pointer starts at index 0, pointing to our smallest number (1). The RIGHT pointer starts at the last index, pointing to our largest number (11). These pointers will walk toward each other until they find the answer or meet in the middle.",codeHighlight:"setup",visualState:{array:[1,3,5,7,9,11],left:0,right:5,pointers:[{index:0,label:"L",color:"#60a5fa"},{index:5,label:"R",color:"#f472b6"}],phase:"L points to 1, R points to 11"},duration:1e4,interactive:!1},{id:5,type:"visualize",showSide:"visual",title:"ðŸ‘€ Visualize: Our Starting Position",narration:"Look at the visualization! See the blue L under index 0? That's our left pointer at value 1. See the pink R under index 5? That's our right pointer at value 11. They're as far apart as possible right now. As we search, they'll move closer together. This is called the Two Pointer technique, and it's one of the most useful patterns in programming!",codeHighlight:"setup",visualState:{array:[1,3,5,7,9,11],left:0,right:5,pointers:[{index:0,label:"L",color:"#60a5fa"},{index:5,label:"R",color:"#f472b6"}],phase:"ðŸ”µ L=1 â†â€•â€•â€•â€•â€•â€•â†’ R=11 ðŸ”´",annotation:"Pointers start at opposite ends"},duration:8e3,interactive:!1},{id:6,type:"code_explain",showSide:"code",title:"ðŸ”„ Step 2: The Main Loop",narration:"Now comes the main loop! We'll keep going 'while left is less than right'. This means: as long as our pointers haven't crossed each other or met, keep searching. Why? Because if they cross, we've checked all possible pairs! In each iteration, we calculate the sum of the values at our two pointers and make a decision based on that sum.",codeHighlight:"while_loop",visualState:{array:[1,3,5,7,9,11],left:0,right:5,phase:"Loop while L < R",annotation:"Continue until pointers meet"},duration:9e3,interactive:!1},{id:7,type:"code_explain",showSide:"code",title:"âž• Step 3: Calculate the Sum",narration:"Inside the loop, the first thing we do is calculate the sum of the two values our pointers are pointing at. Right now, left points to 1 and right points to 11, so our sum is 1 + 11 = 12. We store this in a variable called 'sum'. Now we need to compare this sum to our target!",codeHighlight:"calc_sum",visualState:{array:[1,3,5,7,9,11],left:0,right:5,sum:12,target:12,phase:"sum = numbers[L] + numbers[R]",annotation:"1 + 11 = 12"},duration:8e3,interactive:!0,challenge:{type:"predict",question:"Our sum is 12 and target is 12. What should we do?",options:["Return the answer - we found it!","Move the left pointer","Move the right pointer"],correct:0,explanation:"Yes! When sum equals target, we've found our answer!"}},{id:8,type:"visualize",showSide:"visual",title:"ðŸŽ‰ Found It! (Lucky First Try)",narration:"Amazing! Our very first sum (1 + 11 = 12) equals our target of 12! In the code, when sum equals target, we return the indices. We got lucky this time - we found the answer immediately! But what if the target was different? Let's explore what happens when the sum ISN'T equal to the target. This is where the magic of the algorithm really shines.",codeHighlight:"check_found",visualState:{array:[1,3,5,7,9,11],left:0,right:5,sum:12,target:12,phase:"ðŸŽ‰ sum === target â†’ FOUND!",annotation:"1 + 11 = 12 âœ“ Return [1, 6]"},duration:8e3,interactive:!1},{id:9,type:"visualize",showSide:"visual",title:"ðŸ”„ New Challenge: Target = 8",narration:"Let's try a different target: 8. Starting fresh, our pointers are at 1 and 11, giving sum = 12. But 12 is bigger than 8! Our sum is TOO BIG. So here's the critical question: how do we make the sum smaller? Remember, the array is sorted. To get a smaller sum, we need a smaller number. The RIGHT side has bigger numbers, so moving right pointer LEFT gives us smaller numbers!",codeHighlight:null,visualState:{array:[1,3,5,7,9,11],left:0,right:5,sum:12,target:8,phase:"12 > 8 â†’ Sum TOO BIG!",annotation:"Need smaller sum... move R left!"},duration:1e4,interactive:!1},{id:10,type:"code_explain",showSide:"code",title:"â¬…ï¸ Sum Too Big? Move Right Pointer Left",narration:"Look at the code: when sum is greater than target, we decrease the right pointer (right--). This moves it one position to the left, to a smaller number. In our example, right moves from index 5 (value 11) to index 4 (value 9). Now our new sum is 1 + 9 = 10. Still bigger than 8! So we move right again, to index 3 (value 7). Sum = 1 + 7 = 8. Perfect!",codeHighlight:"too_big",visualState:{array:[1,3,5,7,9,11],left:0,right:3,sum:8,target:8,phase:"R moved: 11â†’9â†’7, Found 1+7=8!",annotation:"Sum too big â†’ move R left"},duration:1e4,interactive:!0,challenge:{type:"predict",question:"If sum = 6 and target = 10, what should we do?",options:["Move left pointer right","Move right pointer left","Return no solution"],correct:0,explanation:"Sum 6 < Target 10, so we need a BIGGER sum. Move left pointer right to get a bigger number!"}},{id:11,type:"code_explain",showSide:"code",title:"âž¡ï¸ Sum Too Small? Move Left Pointer Right",narration:"What if the sum is too SMALL? Let's say target is 16 and we start with sum = 1 + 11 = 12. That's less than 16! To get a BIGGER sum, we need a BIGGER number on the left side. So we move the left pointer RIGHT (left++). This gives us 3 + 11 = 14. Still too small! Move left again: 5 + 11 = 16. Found it! See the pattern?",codeHighlight:"too_small",visualState:{array:[1,3,5,7,9,11],left:2,right:5,sum:16,target:16,phase:"L moved: 1â†’3â†’5, Found 5+11=16!",annotation:"Sum too small â†’ move L right"},duration:1e4,interactive:!1},{id:12,type:"intro",showSide:"visual",title:"ðŸ§  The Beautiful Logic",narration:"Here's the elegant logic in one view: If our sum is TOO SMALL, we need bigger numbers. Since left points to smaller values, moving it RIGHT gives us a bigger value. If sum is TOO BIG, we need smaller numbers. Since right points to bigger values, moving it LEFT gives us a smaller value. Each move eliminates possibilities we don't need to check!",codeHighlight:null,visualState:{phase:"ðŸ“‹ Decision Guide",annotation:"sum < target â†’ left++\\nsum > target â†’ right--\\nsum = target â†’ ðŸŽ‰ Found!"},duration:9e3,interactive:!1},{id:13,type:"code_explain",showSide:"code",title:"âš¡ Why Is This So Fast?",narration:"Let's talk efficiency! In the worst case, left starts at 0 and right starts at n-1. Each iteration, we move ONE pointer. Eventually they meet in the middle. So we do at most n moves total - that's O(n) time! Compare this to the brute force O(nÂ²). For n=1000, that's 1000 operations vs 500,000. We're literally 500 times faster!",codeHighlight:"while_loop",visualState:{phase:"âš¡ Time: O(n) | Space: O(1)",annotation:"Brute force: O(nÂ²) â†’ Two pointer: O(n)\\n500,000 ops â†’ 1,000 ops = 500x faster!"},duration:9e3,interactive:!1},{id:14,type:"intro",showSide:"visual",title:"ðŸŽ¯ When To Use Two Pointers",narration:"You now have a powerful tool in your coding toolkit! Use Two Pointers when: 1) The array is SORTED, 2) You're looking for pairs that satisfy some condition, 3) You want O(n) time instead of O(nÂ²). This pattern shows up everywhere - in problems about pairs, subarrays, palindromes, and more!",codeHighlight:null,visualState:{phase:"ðŸŽ¯ Two Pointer Checklist",annotation:"âœ“ Sorted array?\\nâœ“ Finding pairs?\\nâœ“ Need O(n)?\\nâ†’ Use Two Pointers!"},duration:9e3,interactive:!1},{id:15,type:"intro",showSide:"visual",title:"ðŸ† Congratulations!",narration:"You did it! You've mastered the Two Sum problem using the Two Pointer technique. You learned why brute force is slow, how sorted arrays enable clever optimizations, and the elegant logic of moving pointers based on sum comparisons. This is a foundational pattern that will help you solve many more problems. Great job, and keep coding!",codeHighlight:null,visualState:{phase:"ðŸ† Two Sum MASTERED!",annotation:"Key insight: Sorted + pairs = Two Pointers\\nO(nÂ²) â†’ O(n) = Huge win!"},duration:8e3,interactive:!1}],quiz:[{id:"two-sum-q1",question:"What is the key requirement for using the two-pointer approach?",options:["Array must be sorted","Array must have even length","Array must have no duplicates"],correct:0},{id:"two-sum-q2",question:"If sum < target, we should:",options:["Move right pointer left","Move left pointer right","Move both pointers"],correct:1},{id:"two-sum-q3",question:"What is the time complexity of the Two Pointer solution?",options:["O(nÂ²)","O(n log n)","O(n)","O(1)"],correct:2}]});ge.register({id:"number-of-islands",title:"Number of Islands",course:"algorithms",category:"graphs",difficulty:"intermediate",duration:"25 min",description:"Count islands in a 2D grid using DFS or BFS traversal.",xpReward:180,prerequisiteConcept:"graph-traversal",code:{languages:{python:{source:`def numIslands(grid):
    # Step 1: Handle edge case
    if not grid or len(grid) == 0:
        return 0
    
    # Step 2: Initialize counter and dimensions
    count = 0
    rows = len(grid)
    cols = len(grid[0])
    
    # Step 3: DFS function to explore and sink an island
    def dfs(r, c):
        # Check boundaries and water
        if r < 0 or r >= rows or c < 0 or c >= cols:
            return
        if grid[r][c] != '1':
            return
        
        # Mark as visited (sink this cell)
        grid[r][c] = '0'
        
        # Explore all 4 directions
        dfs(r + 1, c)  # down
        dfs(r - 1, c)  # up
        dfs(r, c + 1)  # right
        dfs(r, c - 1)  # left
    
    # Step 4: Scan the entire grid
    for r in range(rows):
        for c in range(cols):
            # Found new island!
            if grid[r][c] == '1':
                count += 1     # Count it
                dfs(r, c)      # Sink the entire island
    
    # Step 5: Return total count
    return count`,highlightRanges:{edge_case:{start:2,end:4},init:{start:6,end:9},dfs_bounds:{start:13,end:15},dfs_water:{start:16,end:17},dfs_sink:{start:20,end:20},dfs_explore:{start:23,end:26},main_loop:{start:29,end:34},found_island:{start:32,end:34},return_result:{start:37,end:37}}},java:{source:`public static int numIslands(char[][] grid) {
    // Step 1: Handle edge case
    if (grid == null || grid.length == 0) return 0;
    
    // Step 2: Initialize counter and dimensions
    int count = 0;
    int rows = grid.length;
    int cols = grid[0].length;
    
    // Step 4: Scan the entire grid
    for (int r = 0; r < rows; r++) {
        for (int c = 0; c < cols; c++) {
            // Found new island!
            if (grid[r][c] == '1') {
                count++;           // Count it
                dfs(grid, r, c);   // Sink the entire island
            }
        }
    }
    
    // Step 5: Return total count
    return count;
}

// Step 3: DFS function to explore and sink an island
private static void dfs(char[][] grid, int r, int c) {
    int rows = grid.length, cols = grid[0].length;
    // Check boundaries and water
    if (r < 0 || r >= rows || c < 0 || c >= cols) return;
    if (grid[r][c] != '1') return;
    
    // Mark as visited (sink this cell)
    grid[r][c] = '0';
    
    // Explore all 4 directions
    dfs(grid, r + 1, c);  // down
    dfs(grid, r - 1, c);  // up
    dfs(grid, r, c + 1);  // right
    dfs(grid, r, c - 1);  // left
}`,highlightRanges:{edge_case:{start:2,end:3},init:{start:5,end:8},main_loop:{start:11,end:19},found_island:{start:14,end:17},dfs_bounds:{start:29,end:30},dfs_sink:{start:33,end:33},dfs_explore:{start:36,end:39}}}}},steps:[{id:1,type:"intro",showSide:"visual",title:"ðŸï¸ Welcome to Number of Islands!",narration:"Today we're solving a classic graph problem! Imagine you have a map represented as a 2D grid. Each cell is either '1' (land) or '0' (water). An island is a group of '1's connected horizontally or vertically - NOT diagonally. Your mission: count how many separate islands exist in the grid!",codeHighlight:null,visualState:{phase:"ðŸï¸ Count the Islands!",annotation:"1 = Land, 0 = Water\\nConnected = horizontal/vertical only"},duration:1e4,interactive:!1},{id:2,type:"visualize",showSide:"visual",title:"ðŸ—ºï¸ Example Grid",narration:"Look at this example grid! Can you spot the islands? The 1s in the top-left are all connected - that's one island. The single 1 in the middle is isolated - that's a second island. And the two 1s in the bottom-right are connected - that's the third island. Total: 3 islands!",codeHighlight:null,visualState:{grid:[["1","1","0","0","0"],["1","1","0","0","0"],["0","0","1","0","0"],["0","0","0","1","1"]],phase:"How many islands?",annotation:"Island 1: top-left\\nIsland 2: center\\nIsland 3: bottom-right"},duration:1e4,interactive:!0,challenge:{type:"predict",question:"How many islands are in this grid?",options:["1","2","3","4"],correct:2,explanation:"There are 3 islands: top-left cluster, center single, and bottom-right pair!"}},{id:3,type:"intro",showSide:"visual",title:"ðŸ¤” The Strategy: Find, Count, Sink!",narration:"Here's our genius strategy: Scan the grid cell by cell. When we find a '1' (land), that's a NEW island! We increment our count, then 'sink' the entire island by marking all its connected cells as '0'. This way, we never count the same island twice! It's like exploring an island and then making it disappear into the water.",codeHighlight:null,visualState:{phase:"ðŸ“‹ The Algorithm",annotation:"1. Find a 1 (land)\\n2. Count it (+1)\\n3. Sink the whole island (mark all as 0)\\n4. Repeat until done!"},duration:1e4,interactive:!1},{id:4,type:"intro",showSide:"visual",title:'ðŸ” How Do We "Sink" an Island?',narration:"To sink an island, we use DFS - Depth First Search. Starting from any land cell, we mark it as water ('0'), then recursively do the same for all its neighbors (up, down, left, right). This spreads out like a flood, marking every connected '1' as '0'. When DFS finishes, the entire island has been 'sunk'!",codeHighlight:null,visualState:{phase:"ðŸŒŠ DFS = Flood the Island",annotation:"Start at any 1 â†’ Mark as 0\\nâ†’ Visit neighbors â†’ Repeat\\nâ†’ Whole island sinks!"},duration:1e4,interactive:!1},{id:5,type:"code_explain",showSide:"code",title:"ðŸ“¦ Step 1: Setup",narration:"Let's look at the code! First, we handle the edge case: if the grid is empty, return 0. Then we initialize our island counter to 0 and store the grid dimensions. We'll need rows and cols to check if we're staying within bounds during our DFS exploration.",codeHighlight:"init",visualState:{phase:"Initialize: count = 0",annotation:"rows = grid height, cols = grid width"},duration:9e3,interactive:!1},{id:6,type:"code_explain",showSide:"code",title:"ðŸ›¡ï¸ DFS: Boundary Check",narration:"Our DFS function starts with a boundary check. If the row or column is outside the grid (negative or too large), we immediately return - there's nothing to explore there! This prevents 'out of bounds' errors. Think of it as: 'Am I even on the map?'",codeHighlight:"dfs_bounds",visualState:{phase:"Check: Is (r, c) valid?",annotation:"r < 0 or r >= rows â†’ OUT\\nc < 0 or c >= cols â†’ OUT"},duration:9e3,interactive:!1},{id:7,type:"code_explain",showSide:"code",title:"ðŸ’§ DFS: Water Check",narration:"Next, we check if the current cell is water ('0') or already visited. If it's not land ('1'), we return - nothing to sink here! This includes cells we've already marked as '0' during our DFS. This check prevents infinite loops and unnecessary work.",codeHighlight:"dfs_water",visualState:{phase:"Check: Is it land?",annotation:'grid[r][c] !== "1" â†’ Stop\\nAlready water or visited!'},duration:9e3,interactive:!0,challenge:{type:"predict",question:'Why do we check if grid[r][c] !== "1"?',options:["To find the largest island","To avoid visiting water or already-visited cells","To count faster"],correct:1,explanation:'We only want to process unvisited land cells. Water and visited cells (both "0") should stop the recursion!'}},{id:8,type:"code_explain",showSide:"code",title:"ðŸŒŠ Sink the Current Cell",narration:"Now the magic happens! We mark the current cell as '0' (water). This is our 'visited' marker - by sinking this cell, we ensure we never process it again. It's elegant: we don't need a separate 'visited' array because we modify the grid directly!",codeHighlight:"dfs_sink",visualState:{phase:'grid[r][c] = "0"',annotation:"Mark as visited by sinking it!"},duration:8e3,interactive:!1},{id:9,type:"code_explain",showSide:"code",title:"ðŸ§­ Explore All Directions",narration:"After sinking the current cell, we recursively call DFS on all four neighbors: down, up, right, left. Each call will either hit water/boundary and return, or find land and continue sinking. This spreads out in all directions until the entire island is underwater!",codeHighlight:"dfs_explore",visualState:{phase:"Explore: â†‘ â†“ â† â†’",annotation:"dfs(r+1, c) â†’ Down\\ndfs(r-1, c) â†’ Up\\ndfs(r, c+1) â†’ Right\\ndfs(r, c-1) â†’ Left"},duration:9e3,interactive:!1},{id:10,type:"visualize",showSide:"visual",title:"ðŸŽ¬ Watch DFS in Action!",narration:"Watch the sinking process! Starting at top-left (0,0), we mark it as '0', then explore down to (1,0), mark it, explore right to (1,1) and (0,1). Each cell gets sunk, and DFS backtracks when it hits water or boundaries. When done, the entire island is gone - sunk beneath the waves!",codeHighlight:null,visualState:{phase:"ðŸŒŠ Sinking Island 1...",animation:"dfs_spread",annotation:"Start â†’ Spread â†’ Sink â†’ Backtrack"},duration:1e4,interactive:!1},{id:11,type:"code_explain",showSide:"code",title:"ðŸ”„ The Main Loop",narration:"Now putting it all together! We scan every cell in the grid with nested loops. When we find a '1' that hasn't been sunk yet, we've discovered a new island! We increment count and call DFS to sink it. After DFS returns, that island is gone, and we continue scanning for more.",codeHighlight:"found_island",visualState:{phase:"Scan grid â†’ Find 1 â†’ Count â†’ Sink",annotation:'if grid[r][c] === "1": count++, dfs(r,c)'},duration:9e3,interactive:!1},{id:12,type:"intro",showSide:"visual",title:"âš¡ Time & Space Complexity",narration:"How efficient is this? Time: O(rows Ã— cols). We visit each cell at most twice - once in the main loop, once during DFS. Space: O(rows Ã— cols) in the worst case for the recursion stack (imagine a grid of all 1s). This is as good as it gets for this problem!",codeHighlight:null,visualState:{phase:"âš¡ Complexity Analysis",annotation:"Time: O(m Ã— n)\\nSpace: O(m Ã— n) for recursion"},duration:8e3,interactive:!1},{id:13,type:"intro",showSide:"visual",title:"ðŸŽ¯ Key Takeaways",narration:"Remember these key insights! First, use DFS or BFS to explore connected components. Second, mark visited cells to avoid double-counting - here we 'sink' them by changing to '0'. Third, each time you find unvisited land, that's a new island. This pattern works for any 'count connected components' problem!",codeHighlight:null,visualState:{phase:"ðŸŽ¯ Key Insights",annotation:"âœ“ DFS/BFS for connected components\\nâœ“ Mark visited to avoid duplicates\\nâœ“ Each unvisited land = new island"},duration:9e3,interactive:!1},{id:14,type:"intro",showSide:"visual",title:"ðŸ† Congratulations!",narration:"You've mastered the Number of Islands problem! You learned how to model a grid as a graph, use DFS to explore connected regions, and the clever 'sink' technique to mark visited cells. This is a foundational pattern for many grid and graph problems. Great job!",codeHighlight:null,visualState:{phase:"ðŸ† Number of Islands MASTERED!",annotation:"Find â†’ Count â†’ Sink â†’ Repeat!"},duration:8e3,interactive:!1}],quiz:[{id:"islands-q1",question:'Why do we mark visited cells as "0"?',options:["To count them","To avoid counting the same island twice","For visualization"],correct:1},{id:"islands-q2",question:"What traversal algorithm do we use?",options:["Binary Search","DFS (Depth First Search)","Merge Sort"],correct:1},{id:"islands-q3",question:"What is the time complexity?",options:["O(n)","O(n log n)","O(rows Ã— cols)","O(nÂ²)"],correct:2}]});ge.register({id:"kth-largest",title:"Kth Largest Element",course:"algorithms",category:"sorting",difficulty:"intermediate",duration:"22 min",description:"Find the Kth largest element using QuickSelect - faster than sorting!",xpReward:170,prerequisiteConcept:"quicksort",code:{languages:{python:{source:`def findKthLargest(nums, k):
    # Target: the (n-k)th smallest = kth largest
    target_index = len(nums) - k
    
    def quickSelect(left, right):
        # Partition and get pivot's final position
        pivot_index = partition(left, right)
        
        # Found it!
        if pivot_index == target_index:
            return nums[pivot_index]
        # Target is on the right side
        elif pivot_index < target_index:
            return quickSelect(pivot_index + 1, right)
        # Target is on the left side
        else:
            return quickSelect(left, pivot_index - 1)
    
    def partition(left, right):
        pivot = nums[right]  # Use rightmost as pivot
        i = left             # Pointer for smaller elements
        
        for j in range(left, right):
            if nums[j] <= pivot:
                nums[i], nums[j] = nums[j], nums[i]
                i += 1
        
        # Place pivot in its final position
        nums[i], nums[right] = nums[right], nums[i]
        return i
    
    return quickSelect(0, len(nums) - 1)`,highlightRanges:{target:{start:2,end:3},quickselect_start:{start:5,end:7},found_check:{start:10,end:11},go_right:{start:13,end:14},go_left:{start:16,end:17},partition_start:{start:20,end:22},partition_loop:{start:24,end:27},partition_place:{start:30,end:31}}},java:{source:`public static int findKthLargest(int[] nums, int k) {
    int targetIndex = nums.length - k;
    return quickSelect(nums, 0, nums.length - 1, targetIndex);
}

private static int quickSelect(int[] nums, int left, int right, int target) {
    int pivotIndex = partition(nums, left, right);
    
    if (pivotIndex == target) {
        return nums[pivotIndex];
    } else if (pivotIndex < target) {
        return quickSelect(nums, pivotIndex + 1, right, target);
    } else {
        return quickSelect(nums, left, pivotIndex - 1, target);
    }
}

private static int partition(int[] nums, int left, int right) {
    int pivot = nums[right];
    int i = left;
    
    for (int j = left; j < right; j++) {
        if (nums[j] <= pivot) {
            int temp = nums[i];
            nums[i] = nums[j];
            nums[j] = temp;
            i++;
        }
    }
    
    int temp = nums[i];
    nums[i] = nums[right];
    nums[right] = temp;
    return i;
}`,highlightRanges:{target:{start:2,end:2},quickselect_start:{start:6,end:7},found_check:{start:9,end:10},go_right:{start:11,end:12},go_left:{start:13,end:14},partition_start:{start:19,end:21},partition_loop:{start:23,end:29},partition_place:{start:32,end:34}}}}},steps:[{id:1,type:"intro",showSide:"visual",title:"ðŸ† Welcome to Kth Largest!",narration:"Here's a classic interview problem! Given an unsorted array, find the Kth largest element. For example, in [3, 2, 1, 5, 6, 4] with k=2, the 2nd largest is 5. Sounds simple - just sort and pick, right? But what if the array has millions of elements and you only need one value?",codeHighlight:null,visualState:{array:[3,2,1,5,6,4],k:2,phase:"ðŸ† Find 2nd Largest",annotation:"Array: [3,2,1,5,6,4], k=2"},duration:1e4,interactive:!1},{id:2,type:"intro",showSide:"visual",title:"ðŸ“Š The Naive Approach: Sort It!",narration:"The obvious solution: sort the array in descending order, then return the element at index k-1. For our example, sorted descending: [6, 5, 4, 3, 2, 1]. The 2nd largest (k=2) is at index 1, which is 5! This works, but sorting takes O(n log n) time. Can we do better?",codeHighlight:null,visualState:{sorted:[6,5,4,3,2,1],k:2,phase:"Sorted â†’ Pick index k-1",annotation:"O(n log n) - Can we do better?"},duration:9e3,interactive:!0,challenge:{type:"predict",question:"What is the time complexity of the sorting approach?",options:["O(n)","O(n log n)","O(nÂ²)","O(log n)"],correct:1,explanation:"Standard sorting is O(n log n). But we only need ONE element - surely we can skip some work!"}},{id:3,type:"intro",showSide:"visual",title:"ðŸ’¡ The Key Insight: Partial Sorting!",narration:"Here's the brilliant insight: we don't need FULL sorting! We just need to know where the kth largest ends up. Remember QuickSort's partition? It places one element in its FINAL sorted position. If that position is what we want, we're done! If not, we only search ONE side. This is QuickSelect!",codeHighlight:null,visualState:{phase:"ðŸ’¡ QuickSelect Insight",annotation:"Partition puts 1 element in final position\\nOnly search the relevant half!\\nAverage: O(n) time!"},duration:1e4,interactive:!1},{id:4,type:"code_explain",showSide:"code",title:"ðŸŽ¯ The Target Index",narration:"First, let's convert 'kth largest' to an index. In a sorted array, the kth largest is at index n-k. For k=2 in an array of 6 elements: 6-2=4. So we want the element that would be at index 4 after sorting. We call this our 'target index'.",codeHighlight:"target",visualState:{phase:"targetIndex = n - k",annotation:"k=2, n=6 â†’ targetIndex = 4\\n(5 would be at index 4 when sorted)"},duration:9e3,interactive:!1},{id:5,type:"intro",showSide:"visual",title:"ðŸ”„ How Partition Works",narration:"Partition is the heart of QuickSelect! We pick a 'pivot' (usually the last element). Then we rearrange so all elements smaller than pivot are on its left, and all larger are on its right. After partition, THE PIVOT IS IN ITS FINAL SORTED POSITION! We return this position.",codeHighlight:null,visualState:{before:[3,2,1,5,6,4],pivot:4,phase:"Partition: smaller â† pivot â†’ larger",annotation:"Pivot 4 ends up in its final position!"},duration:1e4,interactive:!1},{id:6,type:"code_explain",showSide:"code",title:"ðŸ“¦ Partition Implementation",narration:"Look at the partition code! We use the rightmost element as pivot. Variable 'i' tracks where to place small elements. We scan with 'j' - whenever we find something smaller than or equal to pivot, we swap it to position 'i' and increment 'i'. Finally, we swap the pivot to position 'i'.",codeHighlight:"partition_loop",visualState:{phase:"Partition Loop",annotation:"i = boundary between small and large\\nj = scanner through array"},duration:1e4,interactive:!1},{id:7,type:"visualize",showSide:"visual",title:"ðŸŽ¬ Partition Example",narration:"Let's trace partition on [3,2,1,5,6,4]. Pivot is 4. i=0. j scans: 3<=4? Yes, swap (stays), i=1. 2<=4? Yes, i=2. 1<=4? Yes, i=3. 5<=4? No. 6<=4? No. Finally, swap pivot to index 3. Result: [3,2,1,4,6,5]. Pivot 4 is now at index 3 - its FINAL position!",codeHighlight:null,visualState:{before:[3,2,1,5,6,4],after:[3,2,1,4,6,5],pivotIndex:3,phase:"Pivot 4 â†’ Index 3",annotation:"4 is now in its final sorted position!"},duration:1e4,interactive:!0,challenge:{type:"predict",question:"After partitioning [3,2,1,5,6,4] with pivot 4, what index is 4 at?",options:["Index 2","Index 3","Index 4","Index 5"],correct:1,explanation:"There are 3 elements smaller than 4 (3,2,1), so 4 goes to index 3!"}},{id:8,type:"code_explain",showSide:"code",title:"ðŸŽ¯ Found the Target?",narration:"After partition, we check: is the pivot at our target index? If yes - we found our answer! Return that element. This is the beauty of QuickSelect: we might find the answer on the first partition! But usually, we need to narrow down...",codeHighlight:"found_check",visualState:{pivotIndex:3,targetIndex:4,phase:"Is pivotIndex === targetIndex?",annotation:"3 !== 4, so not found yet!"},duration:9e3,interactive:!1},{id:9,type:"code_explain",showSide:"code",title:"âž¡ï¸ Search Right Side",narration:"If pivot landed LEFT of our target (pivotIndex < targetIndex), the answer must be on the RIGHT side! We only recurse into the right portion. In our example, pivot is at 3 but we want index 4. So we search right of the pivot: indices 4-5 only.",codeHighlight:"go_right",visualState:{array:[3,2,1,4,6,5],searchRange:[4,5],phase:"Target on RIGHT â†’ recurse right",annotation:"Ignore left half completely!"},duration:9e3,interactive:!1},{id:10,type:"code_explain",showSide:"code",title:"â¬…ï¸ Search Left Side",narration:"Conversely, if pivot landed RIGHT of our target (pivotIndex > targetIndex), the answer is on the LEFT. We recurse into the left portion only. Either way, we're cutting our search space roughly in half each time - that's where the O(n) average comes from!",codeHighlight:"go_left",visualState:{phase:"Target on LEFT â†’ recurse left",annotation:"Each recursion: problem size halves!"},duration:8e3,interactive:!1},{id:11,type:"visualize",showSide:"visual",title:"ðŸ” Complete Trace",narration:"Full trace for k=2: Target index = 4. First partition: pivot 4 at index 3. 3<4, go right [4,5]. Second partition in [6,5]: pivot 5 at index 4. Index 4 === target! Return nums[4] = 5. Done in just 2 partitions, not a full sort!",codeHighlight:null,visualState:{trace:"Round 1: [3,2,1,4,6,5], pivot@3\\nRound 2: search [6,5], pivot@4\\nFound! Answer = 5",phase:"ðŸŽ‰ Found: 5 is 2nd largest!",annotation:"2 partitions vs full sort!"},duration:1e4,interactive:!1},{id:12,type:"intro",showSide:"visual",title:"âš¡ Time Complexity",narration:"Average case: O(n)! First partition: n work. Second: n/2 (half the elements). Third: n/4. Total: n + n/2 + n/4 + ... = 2n = O(n). BUT worst case is O(nÂ²) if we always pick the smallest/largest as pivot. Randomized pivot selection helps avoid this!",codeHighlight:null,visualState:{phase:"âš¡ Complexity",annotation:"Average: O(n) - faster than O(n log n) sort!\\nWorst: O(nÂ²) - but rare with random pivot"},duration:9e3,interactive:!1},{id:13,type:"intro",showSide:"visual",title:"ðŸŽ¯ When To Use QuickSelect",narration:"Use QuickSelect when you need one specific order statistic (kth smallest/largest) and don't need the array sorted. It's O(n) average vs O(n log n) for sorting. The tradeoff: it modifies the original array. If you need the array unchanged, use a min-heap approach instead.",codeHighlight:null,visualState:{phase:"ðŸŽ¯ When To Use",annotation:"âœ“ Need only 1 element\\nâœ“ Array can be modified\\nâœ“ Want O(n) average\\nâœ— Use heap if k is very small"},duration:9e3,interactive:!1},{id:14,type:"intro",showSide:"visual",title:"ðŸ† Congratulations!",narration:"You've mastered QuickSelect! You learned how partition places one element in its final position, how QuickSelect uses this to find kth elements in O(n) average time, and when to use it versus sorting or heaps. This is a powerful technique for interview and competitive programming!",codeHighlight:null,visualState:{phase:"ðŸ† QuickSelect MASTERED!",annotation:"Partition â†’ Check â†’ Recurse one side\\nO(n) average!"},duration:8e3,interactive:!1}],quiz:[{id:"kth-q1",question:"What is the average time complexity of QuickSelect?",options:["O(log n)","O(n)","O(n log n)","O(nÂ²)"],correct:1},{id:"kth-q2",question:"What does partition guarantee about the pivot?",options:["It's the largest","It's in its final sorted position","It's the median"],correct:1},{id:"kth-q3",question:"If pivot index < target index, which side do we search?",options:["Left side","Right side","Both sides"],correct:1}]});ge.register({id:"rotated-search",title:"Search in Rotated Array",course:"algorithms",category:"searching",difficulty:"advanced",duration:"22 min",description:"Find a target in a rotated sorted array using modified binary search.",xpReward:200,prerequisiteConcept:"binary-search",code:{languages:{python:{source:`def search(nums, target):
    left = 0
    right = len(nums) - 1
    
    while left <= right:
        mid = (left + right) // 2
        
        # Found the target!
        if nums[mid] == target:
            return mid
        
        # Left half is sorted
        if nums[left] <= nums[mid]:
            # Target is in the sorted left half
            if nums[left] <= target < nums[mid]:
                right = mid - 1
            else:
                left = mid + 1
        # Right half is sorted
        else:
            # Target is in the sorted right half
            if nums[mid] < target <= nums[right]:
                left = mid + 1
            else:
                right = mid - 1
    
    return -1  # Not found`,highlightRanges:{init:{start:2,end:3},while_loop:{start:5,end:5},calc_mid:{start:6,end:6},found_check:{start:9,end:10},left_sorted:{start:13,end:13},target_in_left:{start:15,end:16},right_sorted:{start:20,end:20},target_in_right:{start:22,end:23}}},java:{source:`public static int search(int[] nums, int target) {
    int left = 0;
    int right = nums.length - 1;
    
    while (left <= right) {
        int mid = (left + right) / 2;
        
        // Found the target!
        if (nums[mid] == target) {
            return mid;
        }
        
        // Left half is sorted
        if (nums[left] <= nums[mid]) {
            // Target is in the sorted left half
            if (nums[left] <= target && target < nums[mid]) {
                right = mid - 1;
            } else {
                left = mid + 1;
            }
        }
        // Right half is sorted
        else {
            // Target is in the sorted right half
            if (nums[mid] < target && target <= nums[right]) {
                left = mid + 1;
            } else {
                right = mid - 1;
            }
        }
    }
    
    return -1;  // Not found
}`,highlightRanges:{init:{start:2,end:3},while_loop:{start:5,end:5},calc_mid:{start:6,end:6},found_check:{start:9,end:11},left_sorted:{start:14,end:14},target_in_left:{start:16,end:17},right_sorted:{start:23,end:23},target_in_right:{start:25,end:26}}}}},steps:[{id:1,type:"intro",showSide:"visual",title:"ðŸ”„ Welcome to Rotated Search!",narration:"Here's a tricky problem! You have a sorted array that's been 'rotated' - imagine picking it up from one end and wrapping it around. For example, [0,1,2,4,5,6,7] rotated becomes [4,5,6,7,0,1,2]. The array is no longer fully sorted, but it has TWO sorted portions. Can we still use binary search?",codeHighlight:null,visualState:{original:[0,1,2,4,5,6,7],rotated:[4,5,6,7,0,1,2],phase:"ðŸ”„ Sorted â†’ Rotated",annotation:"Two sorted portions: [4,5,6,7] and [0,1,2]"},duration:1e4,interactive:!1},{id:2,type:"intro",showSide:"visual",title:"ðŸŽ¯ The Challenge",narration:"Given rotated array [4,5,6,7,0,1,2] and target 0, find its index. The answer is index 4. Linear search would take O(n), but we want O(log n)! The key insight: even though the whole array isn't sorted, at least ONE HALF is always sorted. We can use this property!",codeHighlight:null,visualState:{array:[4,5,6,7,0,1,2],target:0,phase:"Find 0 in O(log n)",annotation:"Answer: index 4"},duration:9e3,interactive:!0,challenge:{type:"predict",question:"In [4,5,6,7,0,1,2], which half is sorted?",options:["Left half [4,5,6,7]","Right half [0,1,2]","Both halves","Neither half"],correct:2,explanation:"Both halves are sorted! [4,5,6,7] and [0,1,2] are each individually sorted."}},{id:3,type:"intro",showSide:"visual",title:"ðŸ’¡ The Key Insight",narration:"Here's the magic: when we calculate mid in binary search, we can check which half is sorted by comparing nums[left] with nums[mid]. If nums[left] <= nums[mid], the left half is sorted! Otherwise, the right half is sorted. Once we know which half is sorted, we can check if target is in that range!",codeHighlight:null,visualState:{phase:"ðŸ’¡ One Half is Always Sorted!",annotation:"nums[left] <= nums[mid] â†’ Left sorted\\nnums[left] > nums[mid] â†’ Right sorted"},duration:1e4,interactive:!1},{id:4,type:"code_explain",showSide:"code",title:"ðŸ“¦ Setup: Standard Binary Search Start",narration:"We start just like regular binary search! Left pointer at 0, right pointer at the end. We'll keep going while left <= right. The difference comes in how we decide which half to search - we can't just compare target to mid like normal binary search.",codeHighlight:"init",visualState:{array:[4,5,6,7,0,1,2],left:0,right:6,phase:"left = 0, right = 6",annotation:"Standard binary search setup"},duration:9e3,interactive:!1},{id:5,type:"code_explain",showSide:"code",title:"ðŸŽ¯ Check: Found the Target?",narration:"Calculate mid and check if we found the target. In our example: mid = (0+6)/2 = 3, nums[3] = 7. Is 7 our target 0? No! So we need to decide which half to search. This is where it gets interesting...",codeHighlight:"found_check",visualState:{array:[4,5,6,7,0,1,2],mid:3,midValue:7,target:0,phase:"nums[3] = 7 â‰  0",annotation:"Not found, need to narrow down"},duration:9e3,interactive:!1},{id:6,type:"code_explain",showSide:"code",title:"â¬…ï¸ Is Left Half Sorted?",narration:"We check: is nums[left] <= nums[mid]? That's nums[0]=4 <= nums[3]=7. YES! So the left half [4,5,6,7] is sorted. Now we can ask: is our target 0 in the sorted range [4, 7]? Since 0 < 4, target is NOT in the left half. So we search right!",codeHighlight:"left_sorted",visualState:{array:[4,5,6,7,0,1,2],leftHalf:[4,5,6,7],phase:"Left [4,5,6,7] is sorted",annotation:"Is target 0 in range [4,7]? NO! â†’ Go right"},duration:1e4,interactive:!0,challenge:{type:"predict",question:"Target is 0, left half is [4,5,6,7]. Where should we search?",options:["Left half","Right half"],correct:1,explanation:"0 is not in range [4,7], so it must be in the right half!"}},{id:7,type:"code_explain",showSide:"code",title:"âž¡ï¸ Is Right Half Sorted?",narration:"Alternatively, if nums[left] > nums[mid], the RIGHT half is sorted! In that case, we check if target is in the sorted right half's range: nums[mid] < target <= nums[right]. If yes, search right. If no, search left. It's all about using the sorted portion!",codeHighlight:"right_sorted",visualState:{phase:"When Right Half is Sorted",annotation:"nums[left] > nums[mid] â†’ Right sorted\\nCheck: nums[mid] < target <= nums[right]?"},duration:9e3,interactive:!1},{id:8,type:"visualize",showSide:"visual",title:"ðŸŽ¬ Complete Trace",narration:"Let's trace finding 0 in [4,5,6,7,0,1,2]. Round 1: left=0, right=6, mid=3. nums[3]=7â‰ 0. Left sorted [4,7]. 0 not in range, go right. Round 2: left=4, right=6, mid=5. nums[5]=1â‰ 0. Left sorted [0,1]. 0 is in range, go left. Round 3: left=4, right=4, mid=4. nums[4]=0. FOUND at index 4!",codeHighlight:null,visualState:{trace:"R1: mid=3 (7) â†’ right\\nR2: mid=5 (1) â†’ left\\nR3: mid=4 (0) â†’ FOUND!",phase:"ðŸŽ‰ Found 0 at index 4!",annotation:"3 iterations = O(log n)"},duration:1e4,interactive:!1},{id:9,type:"intro",showSide:"visual",title:"ðŸ§  The Decision Tree",narration:"Let's summarize the decision logic! First, check if left half is sorted (nums[left] <= nums[mid]). If yes, check if target is in that range. If target is in range, go left. Otherwise go right. If left half is NOT sorted, the right half must be. Apply the same logic!",codeHighlight:null,visualState:{phase:"ðŸ§  Decision Tree",annotation:"Left sorted? â†’ Target in [left,mid)? â†’ Go left\\nRight sorted? â†’ Target in (mid,right]? â†’ Go right"},duration:9e3,interactive:!1},{id:10,type:"code_explain",showSide:"code",title:"ðŸ“‹ Left Sorted: Go Left or Right?",narration:"When left half is sorted: Target goes LEFT if nums[left] <= target AND target < nums[mid]. This means target is within the sorted portion. Otherwise, target must be in the unsorted (rotated) right portion, so go right!",codeHighlight:"target_in_left",visualState:{phase:"Left Sorted Decision",annotation:"target in [nums[left], nums[mid]) â†’ left\\notherwise â†’ right"},duration:9e3,interactive:!1},{id:11,type:"code_explain",showSide:"code",title:"ðŸ“‹ Right Sorted: Go Left or Right?",narration:"When right half is sorted: Target goes RIGHT if nums[mid] < target AND target <= nums[right]. This means target is within the sorted portion. Otherwise, target must be in the unsorted (rotated) left portion, so go left!",codeHighlight:"target_in_right",visualState:{phase:"Right Sorted Decision",annotation:"target in (nums[mid], nums[right]] â†’ right\\notherwise â†’ left"},duration:9e3,interactive:!1},{id:12,type:"intro",showSide:"visual",title:"âš¡ Time & Space Complexity",narration:"Just like regular binary search, we halve the search space each iteration. Time: O(log n). Space: O(1) - we only use a few variables. The beauty is we maintain O(log n) despite the array not being fully sorted!",codeHighlight:null,visualState:{phase:"âš¡ Complexity",annotation:"Time: O(log n)\\nSpace: O(1)\\nJust as fast as regular binary search!"},duration:8e3,interactive:!1},{id:13,type:"intro",showSide:"visual",title:"ðŸŽ¯ Key Takeaways",narration:"Remember: in a rotated sorted array, one half is ALWAYS sorted! We identify which half by comparing nums[left] to nums[mid]. Then we check if target is in the sorted half's range. If yes, search there. If no, search the other half. This pattern works for any rotation!",codeHighlight:null,visualState:{phase:"ðŸŽ¯ Key Insights",annotation:"âœ“ One half is always sorted\\nâœ“ Compare nums[left] vs nums[mid]\\nâœ“ Check if target in sorted range\\nâœ“ Narrow down each iteration"},duration:9e3,interactive:!1},{id:14,type:"intro",showSide:"visual",title:"ðŸ† Congratulations!",narration:"You've mastered searching in rotated sorted arrays! This is a classic interview problem that tests your understanding of binary search and how to adapt it when conditions change. The key insight - identifying the sorted half - is a technique you can apply to many variations of this problem!",codeHighlight:null,visualState:{phase:"ðŸ† Rotated Search MASTERED!",annotation:"Find sorted half â†’ Check range â†’ Narrow down\\nO(log n) even with rotation!"},duration:8e3,interactive:!1}],quiz:[{id:"rotated-q1",question:"In a rotated sorted array, how many sorted portions exist?",options:["0","1","2","Depends on rotation"],correct:2},{id:"rotated-q2",question:"How do we identify if the left half is sorted?",options:["nums[left] <= nums[mid]","nums[left] > nums[mid]","nums[mid] <= nums[right]"],correct:0},{id:"rotated-q3",question:"What is the time complexity?",options:["O(n)","O(log n)","O(n log n)","O(1)"],correct:1}]});ge.register({id:"coin-change",title:"Coin Change: DP Classic",course:"algorithms",category:"dynamic-programming",difficulty:"intermediate",duration:"25 min",description:"Find the minimum number of coins to make a target amount using Dynamic Programming.",xpReward:200,prerequisiteConcept:"dynamic-programming",code:{languages:{python:{source:`def coinChange(coins, amount):
    # Step 1: Create DP array
    # dp[i] = minimum coins needed for amount i
    dp = [float('inf')] * (amount + 1)
    
    # Step 2: Base case - 0 coins for amount 0
    dp[0] = 0
    
    # Step 3: Fill the DP table
    for i in range(1, amount + 1):
        # Try each coin
        for coin in coins:
            # Can we use this coin?
            if coin <= i and dp[i - coin] != float('inf'):
                # Take minimum: current best OR use this coin
                dp[i] = min(dp[i], dp[i - coin] + 1)
    
    # Step 4: Return answer (or -1 if impossible)
    return -1 if dp[amount] == float('inf') else dp[amount]`,highlightRanges:{create_dp:{start:2,end:4},base_case:{start:6,end:7},outer_loop:{start:10,end:10},inner_loop:{start:12,end:12},check_coin:{start:14,end:14},update_dp:{start:16,end:16},return_result:{start:19,end:19}}},java:{source:`public static int coinChange(int[] coins, int amount) {
    // Step 1: Create DP array
    int[] dp = new int[amount + 1];
    Arrays.fill(dp, Integer.MAX_VALUE);
    
    // Step 2: Base case - 0 coins for amount 0
    dp[0] = 0;
    
    // Step 3: Fill the DP table
    for (int i = 1; i <= amount; i++) {
        // Try each coin
        for (int coin : coins) {
            // Can we use this coin?
            if (coin <= i && dp[i - coin] != Integer.MAX_VALUE) {
                // Take minimum: current best OR use this coin
                dp[i] = Math.min(dp[i], dp[i - coin] + 1);
            }
        }
    }
    
    // Step 4: Return answer (or -1 if impossible)
    return dp[amount] == Integer.MAX_VALUE ? -1 : dp[amount];
}`,highlightRanges:{create_dp:{start:2,end:4},base_case:{start:6,end:7},outer_loop:{start:10,end:10},inner_loop:{start:12,end:12},check_coin:{start:14,end:14},update_dp:{start:16,end:16},return_result:{start:22,end:22}}}}},steps:[{id:1,type:"intro",showSide:"visual",title:"ðŸ’° Welcome to Coin Change!",narration:"Welcome to one of the most famous Dynamic Programming problems! Here's the challenge: you have coins of different values, and you need to make a specific amount. But here's the catch - you want to use the MINIMUM number of coins possible. For example, with coins [1, 2, 5] and target 11, what's the fewest coins you need? Think about it!",codeHighlight:null,visualState:{coins:[1,2,5],target:11,phase:"ðŸ’° Coins: [1, 2, 5] | Target: 11",annotation:"What's the minimum coins to make 11?"},duration:1e4,interactive:!1},{id:2,type:"intro",showSide:"visual",title:"ðŸª™ The Answer: 3 Coins!",narration:"The answer is 3 coins: 5 + 5 + 1 = 11! But how do we figure this out systematically? You might think: just use the biggest coins first! That's called the 'greedy' approach. And it seems to work here... 5 + 5 = 10, then add 1 to get 11. Three coins! But wait - does greedy ALWAYS work?",codeHighlight:null,visualState:{coins:[1,2,5],target:11,solution:[5,5,1],phase:"âœ“ Answer: 5 + 5 + 1 = 11 (3 coins)",annotation:"But is greedy always optimal?"},duration:9e3,interactive:!1},{id:3,type:"intro",showSide:"visual",title:"âš ï¸ The Greedy Trap!",narration:"Here's where it gets interesting! Let's try coins [1, 3, 4] with target 6. Greedy says: use 4 first (leaves 2), then two 1s. That's 4 + 1 + 1 = 3 coins. But wait! We could use 3 + 3 = 6, which is only 2 coins! Greedy failed us! The locally best choice wasn't the globally best. We need a smarter approach.",codeHighlight:null,visualState:{coins:[1,3,4],target:6,phase:"âŒ Greedy: 4+1+1 = 3 coins",annotation:"âœ“ Optimal: 3+3 = 2 coins!"},duration:1e4,interactive:!0,challenge:{type:"predict",question:"Why does the greedy approach fail?",options:["It's too slow","The local best isn't always global best","It uses too much memory"],correct:1,explanation:"Taking the largest coin first might block a better combination using smaller coins!"}},{id:4,type:"intro",showSide:"visual",title:"ðŸ§  Dynamic Programming to the Rescue!",narration:"Dynamic Programming is perfect for this problem! The key insight is: to find the minimum coins for amount 11, we can break it down. If we use a 5-coin, we need minimum coins for amount 6 plus one. If we use a 2-coin, we need minimum coins for amount 9 plus one. We try all options and pick the minimum! This is called 'optimal substructure'.",codeHighlight:null,visualState:{phase:"ðŸ§  DP: Break into subproblems",annotation:"dp[11] = 1 + min(dp[6], dp[9], dp[10])"},duration:1e4,interactive:!1},{id:5,type:"intro",showSide:"visual",title:"ðŸ“Š The DP Formula",narration:"Here's the magic formula: dp[amount] = 1 + minimum of dp[amount - coin] for each coin. In words: 'The minimum coins for this amount equals one coin plus the minimum coins for the remaining amount after using that coin.' We try each coin and pick whichever gives the smallest total!",codeHighlight:null,visualState:{phase:"ðŸ“Š The Formula",annotation:"dp[i] = 1 + min(dp[i - coin]) for each coin"},duration:9e3,interactive:!1},{id:6,type:"code_explain",showSide:"code",title:"ðŸ“¦ Step 1: Create the DP Array",narration:"Let's look at the code! First, we create an array called 'dp'. The index represents the amount, and the value at that index is the minimum coins needed. We make it size 'amount + 1' so we can store dp[0] through dp[amount]. We initialize everything to Infinity, meaning 'impossible' or 'haven't solved yet'.",codeHighlight:"create_dp",visualState:{dpTable:[1/0,1/0,1/0,1/0,1/0,1/0,1/0,1/0,1/0,1/0,1/0,1/0],phase:"dp = [âˆž, âˆž, âˆž, âˆž, âˆž, âˆž, âˆž, âˆž, âˆž, âˆž, âˆž, âˆž]",annotation:"Index = amount, Value = min coins"},duration:1e4,interactive:!1},{id:7,type:"code_explain",showSide:"code",title:"ðŸŽ¯ Step 2: The Base Case",narration:"The base case is crucial! How many coins do we need to make amount 0? Zero coins! We set dp[0] = 0. This is our starting point - from here, we'll build up solutions for all larger amounts. Think of it as: 'I already have nothing, so I need nothing to make nothing!'",codeHighlight:"base_case",visualState:{dpTable:[0,1/0,1/0,1/0,1/0,1/0,1/0,1/0,1/0,1/0,1/0,1/0],phase:"dp[0] = 0 (base case!)",annotation:"Zero coins for zero amount"},duration:9e3,interactive:!0,challenge:{type:"predict",question:"Why is dp[0] = 0 important?",options:["It's just a placeholder","It's the base case we build from","It prevents errors"],correct:1,explanation:"dp[0] = 0 is our foundation! When we use a coin that exactly equals an amount, we're adding 1 to dp[0]."}},{id:8,type:"code_explain",showSide:"code",title:"ðŸ”„ Step 3: The Outer Loop",narration:"Now we loop through every amount from 1 to our target (11). For each amount i, we'll figure out the minimum coins needed. We solve smaller amounts first because dp[i] depends on smaller values. This is called 'bottom-up' DP - we start small and build up!",codeHighlight:"outer_loop",visualState:{phase:"for i = 1 to amount:",annotation:"Solve amounts 1, 2, 3, ... up to 11"},duration:9e3,interactive:!1},{id:9,type:"code_explain",showSide:"code",title:"ðŸª™ Step 4: Try Each Coin",narration:"Inside the outer loop, we try each coin! For amount i, we ask: 'What if I used coin 1? What about coin 2? Coin 5?' For each coin, we check if it fits (coin <= i) and if we can solve the remaining amount (dp[i - coin] isn't Infinity). Then we take the minimum!",codeHighlight:"inner_loop",visualState:{phase:"for each coin in [1, 2, 5]:",annotation:"Try using each denomination"},duration:9e3,interactive:!1},{id:10,type:"visualize",showSide:"visual",title:"ðŸ”¢ Watch It Build: Amount 5",narration:"Let's trace amount 5! We try coin 1: dp[5-1] + 1 = dp[4] + 1. We try coin 2: dp[5-2] + 1 = dp[3] + 1. We try coin 5: dp[5-5] + 1 = dp[0] + 1 = 0 + 1 = 1! That's the best - just one coin! dp[5] = 1 because we can use a single 5-coin.",codeHighlight:"update_dp",visualState:{dpTable:[0,1,1,2,2,1,"?","?","?","?","?","?"],currentAmount:5,phase:"dp[5] = 1 (use one 5-coin!)",annotation:"Trying coins: 5 wins with 1 coin"},duration:1e4,interactive:!0,challenge:{type:"predict",question:"What is dp[6] with coins [1, 2, 5]?",options:["1 coin","2 coins (5+1 or 2+2+2)","3 coins"],correct:1,explanation:"dp[6] = 2. We can use 5+1 or 2+2+2, but both need 2 coins minimum!"}},{id:11,type:"visualize",showSide:"visual",title:"ðŸ“Š The Complete Table",narration:"After processing all amounts, here's our complete DP table! dp[11] = 3, which means the minimum coins for amount 11 is 3. The solution is 5 + 5 + 1. Notice how each entry was calculated using smaller entries - that's the power of DP! We solved 11 by solving 1 through 10 first.",codeHighlight:null,visualState:{dpTable:[0,1,1,2,2,1,2,2,3,3,2,3],phase:"âœ… Complete DP Table",annotation:"dp[11] = 3 â†’ Answer: 3 coins!"},duration:9e3,interactive:!1},{id:12,type:"code_explain",showSide:"code",title:"ðŸ”™ Step 5: Return the Answer",narration:"Finally, we return dp[amount]! If it's still Infinity, that means we couldn't make that amount with the given coins, so we return -1. Otherwise, we return the minimum number of coins. In our example, dp[11] = 3, so we return 3!",codeHighlight:"return_result",visualState:{phase:"return dp[11] = 3",annotation:"Answer: 3 coins (5 + 5 + 1)"},duration:8e3,interactive:!1},{id:13,type:"intro",showSide:"visual",title:"âš¡ Time & Space Complexity",narration:"How efficient is this? Time: O(amount Ã— number of coins). We fill 'amount' cells, and for each, we check each coin. Space: O(amount) for the DP array. This is much better than trying all combinations, which would be exponential! DP saves us by reusing solutions to subproblems.",codeHighlight:null,visualState:{phase:"âš¡ Complexity Analysis",annotation:"Time: O(amount Ã— coins)\\nSpace: O(amount)"},duration:9e3,interactive:!1},{id:14,type:"intro",showSide:"visual",title:"ðŸ† Congratulations!",narration:"You've mastered the Coin Change problem! You learned why greedy doesn't always work, how DP breaks problems into subproblems, and how to build solutions bottom-up. This pattern - building a table of optimal solutions - appears in many DP problems. The key insight: optimal substructure means the best solution contains best sub-solutions!",codeHighlight:null,visualState:{phase:"ðŸ† Coin Change MASTERED!",annotation:"Key: dp[i] = 1 + min(dp[i-coin])\\nGreedy fails â†’ DP wins!"},duration:8e3,interactive:!1}],quiz:[{id:"coin-q1",question:"What does dp[i] represent?",options:["Number of ways to make amount i","Minimum coins for amount i","Maximum coins for amount i"],correct:1},{id:"coin-q2",question:"Why does greedy fail for Coin Change?",options:["It's too slow","Local best might not be global best","It uses too much memory"],correct:1},{id:"coin-q3",question:"What is the time complexity?",options:["O(n)","O(amount Ã— coins)","O(nÂ²)","O(2^n)"],correct:1}]});ge.register({id:"longest-substring",title:"Longest Substring Without Repeating",course:"algorithms",category:"strings",difficulty:"intermediate",duration:"15 min",description:"Find the longest substring without repeating characters using Sliding Window.",xpReward:150,prerequisiteConcept:"sliding-window",code:{languages:{python:{source:`def lengthOfLongestSubstring(s):
    seen = {}  # char -> last index
    max_len = 0
    left = 0
    
    for right in range(len(s)):
        char = s[right]
        
        if char in seen and seen[char] >= left:
            # Shrink window past the duplicate
            left = seen[char] + 1
        
        seen[char] = right
        max_len = max(max_len, right - left + 1)
    
    return max_len`,highlightRanges:{init:{start:2,end:4},expand:{start:6,end:7},shrink:{start:9,end:11},update:{start:13,end:14}}},java:{source:`public static int lengthOfLongestSubstring(String s) {
    Map<Character, Integer> seen = new HashMap<>();
    int maxLen = 0;
    int left = 0;
    
    for (int right = 0; right < s.length(); right++) {
        char c = s.charAt(right);
        
        if (seen.containsKey(c) && seen.get(c) >= left) {
            // Shrink window past the duplicate
            left = seen.get(c) + 1;
        }
        
        seen.put(c, right);
        maxLen = Math.max(maxLen, right - left + 1);
    }
    
    return maxLen;
}`,highlightRanges:{init:{start:2,end:4},expand:{start:6,end:7},shrink:{start:9,end:12},update:{start:14,end:15}}}}},steps:[{id:1,type:"intro",title:"The Problem",narration:"Given a string, find the length of the longest substring without repeating characters. For 'abcabcbb', the answer is 3 ('abc'). For 'bbbbb', it's 1 ('b').",codeHighlight:null,visualState:{phase:'"abcabcbb" â†’ "abc" = 3'},duration:7e3,interactive:!1},{id:2,type:"intro",title:"Sliding Window Approach",narration:"This is a classic sliding window problem! We maintain a window of unique characters. When we see a duplicate, we shrink the window from the left until it's unique again.",codeHighlight:null,visualState:{phase:"Window expands â†’ duplicate â†’ shrink"},duration:8e3,interactive:!1},{id:3,type:"code_explain",title:"Track Character Positions",narration:"We use a Map to remember where we last saw each character. 'left' marks the start of our window, 'right' expands it. We track the maximum length seen.",codeHighlight:"init",visualState:{phase:"Map: char â†’ last index"},duration:6e3,interactive:!1},{id:4,type:"visualize",title:"Expanding the Window",narration:"For 'abcabcbb': right moves through a, b, c - window is 'abc', length 3. Then we hit 'a' again! It's a duplicate.",codeHighlight:"expand",visualState:{phase:"Window: [abc] | right â†’ a (duplicate!)"},duration:7e3,interactive:!0,challenge:{type:"predict",question:"When we see a duplicate, what should we do?",options:["Restart from beginning","Move left past the previous occurrence","Skip the character"],correct:1,explanation:"We move left just past where we saw this character before, keeping the window valid."}},{id:5,type:"code_explain",title:"Shrinking on Duplicate",narration:"When we find a duplicate that's within our window, we move 'left' to just after the previous occurrence. This removes the duplicate and keeps our window valid.",codeHighlight:"shrink",visualState:{phase:"left jumps past duplicate's last position"},duration:7e3,interactive:!1},{id:6,type:"code_explain",title:"Update and Track Maximum",narration:"After each step, update the character's position and check if current window is the longest we've seen. Window length = right - left + 1.",codeHighlight:"update",visualState:{phase:"maxLen = max(maxLen, right - left + 1)"},duration:6e3,interactive:!1},{id:7,type:"intro",title:"Congratulations!",narration:"You've mastered Longest Substring with Sliding Window! Key insight: expand right, shrink left on duplicates, track the max. Time O(n), Space O(min(m,n)) where m is charset size.",codeHighlight:null,visualState:{phase:"ðŸŽ‰ Longest Substring Complete!"},duration:5e3,interactive:!1}],quiz:[{id:"longest-q1",question:"Why do we check if seen.get(char) >= left?",options:["For speed","The duplicate might be outside our current window","To count characters"],correct:1}]});ge.register({id:"valid-parentheses",title:"Valid Parentheses",course:"algorithms",category:"stacks",difficulty:"beginner",duration:"12 min",description:"Check if brackets are properly matched using a stack.",xpReward:100,code:{languages:{python:{source:`def isValid(s):
    stack = []
    pairs = {')': '(', '}': '{', ']': '['}
    
    for char in s:
        if char in '({[':
            stack.append(char)
        else:
            if not stack or stack.pop() != pairs[char]:
                return False
    
    return len(stack) == 0`,highlightRanges:{init:{start:2,end:3},push:{start:6,end:7},pop:{start:9,end:10},result:{start:12,end:12}}},java:{source:`public static boolean isValid(String s) {
    Stack<Character> stack = new Stack<>();
    Map<Character, Character> pairs = Map.of(')', '(', '}', '{', ']', '[');
    
    for (char c : s.toCharArray()) {
        if (c == '(' || c == '{' || c == '[') {
            stack.push(c);
        } else {
            if (stack.isEmpty() || stack.pop() != pairs.get(c)) {
                return false;
            }
        }
    }
    
    return stack.isEmpty();
}`,highlightRanges:{init:{start:2,end:3},push:{start:6,end:7},pop:{start:9,end:11},result:{start:15,end:15}}}}},steps:[{id:1,type:"intro",title:"The Problem",narration:"Given a string with brackets, determine if they're properly matched. '()[]{}' is valid. '([)]' is not - the brackets cross each other. '(((' is not - unclosed brackets.",codeHighlight:null,visualState:{phase:'"()[]{}": Valid | "([)]": Invalid | "(((": Invalid'},duration:8e3,interactive:!1},{id:2,type:"intro",title:"Stack: Last In, First Out",narration:"A stack is perfect here! When we see an opening bracket, push it. When we see a closing bracket, it must match the MOST RECENT opening - that's the top of the stack!",codeHighlight:null,visualState:{phase:"Stack: Push opens, Pop for closes"},duration:7e3,interactive:!1},{id:3,type:"code_explain",title:"Push Opening Brackets",narration:"When we see '(', '{', or '[', push it onto the stack. We're keeping track of brackets that need to be closed.",codeHighlight:"push",visualState:{phase:'See "(" â†’ push â†’ stack: ["("]'},duration:6e3,interactive:!1},{id:4,type:"visualize",title:"Pop and Match",narration:"When we see a closing bracket, pop from the stack. The popped bracket MUST match! ')' matches '(', ']' matches '[', '}' matches '{'. If not, invalid!",codeHighlight:"pop",visualState:{phase:'See ")" â†’ pop "(" â†’ match âœ“'},duration:7e3,interactive:!0,challenge:{type:"predict",question:'Stack has ["(", "["]. We see "]". Valid?',options:["Yes, they match",'No, we pop "[" and "]" matches',"Actually yes!"],correct:1,explanation:'We pop "[" which matches "]". Valid so far!'}},{id:5,type:"code_explain",title:"Final Check",narration:"After processing all characters, the stack should be empty. If there are leftover opening brackets, they were never closed - invalid!",codeHighlight:"result",visualState:{phase:"End: stack empty â†’ âœ“ valid"},duration:5e3,interactive:!1},{id:6,type:"intro",title:"Congratulations!",narration:"You've learned Valid Parentheses with stacks! The stack naturally handles the 'most recent must match' requirement. Time O(n), Space O(n).",codeHighlight:null,visualState:{phase:"ðŸŽ‰ Valid Parentheses Complete!"},duration:5e3,interactive:!1}],quiz:[{id:"paren-q1",question:"Why is a stack ideal for this problem?",options:["It's fast","Most recent opening must match first","It uses less space"],correct:1}]});ge.register({id:"climbing-stairs",title:"Climbing Stairs",course:"algorithms",category:"dynamic-programming",difficulty:"beginner",duration:"10 min",description:"Count ways to climb stairs - the gentlest DP introduction.",xpReward:100,prerequisiteConcept:"dynamic-programming",code:{languages:{python:{source:`def climbStairs(n):
    if n <= 2:
        return n
    
    prev2 = 1  # ways to reach step 1
    prev1 = 2  # ways to reach step 2
    
    for i in range(3, n + 1):
        current = prev1 + prev2
        prev2 = prev1
        prev1 = current
    
    return prev1`,highlightRanges:{base:{start:2,end:3},init:{start:5,end:6},dp:{start:8,end:11}}},java:{source:`public static int climbStairs(int n) {
    if (n <= 2) return n;
    
    int prev2 = 1; // ways to reach step 1
    int prev1 = 2; // ways to reach step 2
    
    for (int i = 3; i <= n; i++) {
        int current = prev1 + prev2;
        prev2 = prev1;
        prev1 = current;
    }
    
    return prev1;
}`,highlightRanges:{base:{start:2,end:2},init:{start:4,end:5},dp:{start:7,end:11}}}}},steps:[{id:1,type:"intro",title:"The Problem",narration:"You're climbing a staircase with n steps. Each time you can climb 1 or 2 steps. How many distinct ways can you reach the top? For n=3: 1+1+1, 1+2, 2+1 = 3 ways.",codeHighlight:null,visualState:{phase:"n=3 â†’ 3 ways | n=5 â†’ 8 ways"},duration:8e3,interactive:!1},{id:2,type:"intro",title:"The Key Insight",narration:"To reach step n, you either came from step n-1 (one step) or step n-2 (two steps). So ways(n) = ways(n-1) + ways(n-2). This is Fibonacci in disguise!",codeHighlight:null,visualState:{phase:"ways(n) = ways(n-1) + ways(n-2)"},duration:8e3,interactive:!0,challenge:{type:"predict",question:"If ways(4)=5 and ways(5)=8, what is ways(6)?",options:["10","13","15"],correct:1,explanation:"ways(6) = ways(5) + ways(4) = 8 + 5 = 13"}},{id:3,type:"code_explain",title:"Space Optimization",narration:"We only need the last two values, not the full array! We track prev1 (n-1) and prev2 (n-2), update as we go. Space drops from O(n) to O(1).",codeHighlight:"dp",visualState:{phase:"Only track last 2 â†’ O(1) space"},duration:7e3,interactive:!1},{id:4,type:"intro",title:"Congratulations!",narration:"You've solved Climbing Stairs! This is the gentlest introduction to DP. The pattern: identify the recurrence, build from base cases, optimize space if possible.",codeHighlight:null,visualState:{phase:"ðŸŽ‰ Climbing Stairs Complete!"},duration:5e3,interactive:!1}],quiz:[{id:"climb-q1",question:"Climbing Stairs is equivalent to which sequence?",options:["Prime numbers","Fibonacci sequence","Powers of 2"],correct:1}]});ge.register({id:"reverse-linked-list",title:"Reverse Linked List",course:"algorithms",category:"linked-lists",difficulty:"beginner",duration:"10 min",description:"Reverse a singly linked list in-place.",xpReward:100,code:{languages:{python:{source:`def reverseList(head):
    prev = None
    curr = head
    
    while curr is not None:
        next_node = curr.next  # Save next
        curr.next = prev       # Reverse pointer
        prev = curr            # Move prev forward
        curr = next_node       # Move curr forward
    
    return prev  # New head`,highlightRanges:{init:{start:2,end:3},save:{start:6,end:6},reverse:{start:7,end:9}}},java:{source:`public static ListNode reverseList(ListNode head) {
    ListNode prev = null;
    ListNode curr = head;
    
    while (curr != null) {
        ListNode next = curr.next;  // Save next
        curr.next = prev;            // Reverse pointer
        prev = curr;                 // Move prev forward
        curr = next;                 // Move curr forward
    }
    
    return prev;  // New head
}`,highlightRanges:{init:{start:2,end:3},save:{start:6,end:6},reverse:{start:7,end:9}}}}},steps:[{id:1,type:"intro",title:"The Problem",narration:"Given a linked list, reverse it so the last node becomes the first and vice versa. This is a fundamental linked list operation you'll use everywhere.",codeHighlight:null,visualState:{phase:"1 -> 2 -> 3 -> null becomes 3 -> 2 -> 1 -> null"},duration:7e3,interactive:!1},{id:2,type:"code_explain",title:"Two Pointers",narration:"We use two pointers: prev (starts null) and curr (starts at head). We'll walk through the list, reversing each pointer as we go.",codeHighlight:"init",visualState:{phase:"prev=null, curr=1"},duration:6e3,interactive:!1},{id:3,type:"visualize",title:"Reverse Step by Step",narration:"At each node: save the next pointer, point current back to prev, move prev to current, move current forward. We're literally flipping the arrows!",codeHighlight:"reverse",visualState:{phase:"Flip arrows one by one"},duration:8e3,interactive:!0,challenge:{type:"predict",question:"After reversing, what does the old head point to?",options:["The second node","null","The new head"],correct:1,explanation:"The old head becomes the new tail, pointing to null."}},{id:4,type:"intro",title:"Congratulations!",narration:"You've mastered linked list reversal! Time O(n), Space O(1). This pattern - walking with two pointers while modifying - appears in many list problems.",codeHighlight:null,visualState:{phase:"Reversed! Time O(n), Space O(1)"},duration:5e3,interactive:!1}],quiz:[{id:"rev-q1",question:"Why save next before reversing?",options:["For speed","We lose access after flipping","Its optional"],correct:1}]});ge.register({id:"palindrome-check",title:"Valid Palindrome",course:"algorithms",category:"strings",difficulty:"beginner",duration:"8 min",description:"Check if a string reads the same forwards and backwards.",xpReward:80,prerequisiteConcept:"two-pointer",code:{languages:{python:{source:`def isPalindrome(s):
    s = ''.join(c.lower() for c in s if c.isalnum())
    left, right = 0, len(s) - 1
    
    while left < right:
        if s[left] != s[right]:
            return False
        left += 1
        right -= 1
    return True`,highlightRanges:{clean:{start:2,end:2},compare:{start:5,end:9}}},java:{source:`public static boolean isPalindrome(String s) {
    s = s.toLowerCase().replaceAll("[^a-z0-9]", "");
    int left = 0, right = s.length() - 1;
    
    while (left < right) {
        if (s.charAt(left) != s.charAt(right)) {
            return false;
        }
        left++;
        right--;
    }
    return true;
}`,highlightRanges:{clean:{start:2,end:2},compare:{start:5,end:11}}}}},steps:[{id:1,type:"intro",title:"The Problem",narration:"A palindrome reads the same forwards and backwards. 'racecar' is a palindrome. 'A man a plan a canal Panama' is too (ignoring spaces and case)!",codeHighlight:null,visualState:{phase:"racecar: r-a-c-e-c-a-r (palindrome!)"},duration:7e3,interactive:!1},{id:2,type:"intro",title:"Two Pointers from Ends",narration:"Classic two-pointer! Start from both ends. If characters match, move inward. If they ever differ, not a palindrome. If pointers meet, it's valid!",codeHighlight:null,visualState:{phase:"L -> ... <- R (converge)"},duration:6e3,interactive:!0,challenge:{type:"predict",question:'Checking "abba": left=a, right=a. What next?',options:["Valid palindrome","Check b and b","Invalid"],correct:1,explanation:"They match! Move inward to compare b and b."}},{id:3,type:"intro",title:"Congratulations!",narration:"Palindrome check complete! Clean the string, two pointers from ends. Time O(n), Space O(1) if we modify in place.",codeHighlight:null,visualState:{phase:"O(n) time, O(1) space"},duration:5e3,interactive:!1}],quiz:[{id:"pal-q1",question:"Why clean the string first?",options:["Speed","Ignore non-alphanumeric chars","Required"],correct:1}]});ge.register({id:"max-subarray",title:"Maximum Subarray (Kadane)",course:"algorithms",category:"dynamic-programming",difficulty:"intermediate",duration:"12 min",description:"Find the contiguous subarray with the largest sum.",xpReward:140,code:{languages:{python:{source:`def maxSubArray(nums):
    max_sum = nums[0]
    current_sum = nums[0]
    
    for i in range(1, len(nums)):
        # Either extend current or start fresh
        current_sum = max(nums[i], current_sum + nums[i])
        max_sum = max(max_sum, current_sum)
    
    return max_sum`,highlightRanges:{init:{start:2,end:3},dp:{start:6,end:8}}},java:{source:`public static int maxSubArray(int[] nums) {
    int maxSum = nums[0];
    int currentSum = nums[0];
    
    for (int i = 1; i < nums.length; i++) {
        // Either extend current or start fresh
        currentSum = Math.max(nums[i], currentSum + nums[i]);
        maxSum = Math.max(maxSum, currentSum);
    }
    
    return maxSum;
}`,highlightRanges:{init:{start:2,end:3},dp:{start:6,end:8}}}}},steps:[{id:1,type:"intro",title:"The Problem",narration:"Given an array (possibly with negatives), find the contiguous subarray with the maximum sum. For [-2,1,-3,4,-1,2,1,-5,4], the answer is [4,-1,2,1] with sum 6.",codeHighlight:null,visualState:{phase:"Find max contiguous sum"},duration:8e3,interactive:!1},{id:2,type:"code_explain",title:"Kadane Key Insight",narration:"At each position, we decide: extend the current subarray or start a new one? If adding current element to existing sum is WORSE than just the element alone, start fresh!",codeHighlight:"dp",visualState:{phase:"currentSum = max(num, currentSum + num)"},duration:8e3,interactive:!0,challenge:{type:"predict",question:"currentSum=-5, nums[i]=10. New currentSum?",options:["5 (extend)","10 (start fresh)","-5"],correct:1,explanation:"max(10, -5+10) = max(10, 5) = 10. Starting fresh is better!"}},{id:3,type:"intro",title:"Congratulations!",narration:"You've learned Kadane's algorithm! The brilliance: O(n) time, O(1) space, one pass. Decide at each step whether to extend or restart.",codeHighlight:null,visualState:{phase:"O(n) time, O(1) space"},duration:5e3,interactive:!1}],quiz:[{id:"kad-q1",question:"When do we start a new subarray?",options:["When element is negative","When extending gives worse sum than element alone","Every 5 elements"],correct:1}]});ge.register({id:"house-robber",title:"House Robber",course:"algorithms",category:"dynamic-programming",difficulty:"intermediate",duration:"14 min",description:"Maximize loot without robbing adjacent houses.",xpReward:150,prerequisiteConcept:"dynamic-programming",code:{languages:{python:{source:`def rob(nums):
    if len(nums) == 0:
        return 0
    if len(nums) == 1:
        return nums[0]
    
    prev2 = 0           # Max without house i-2
    prev1 = nums[0]     # Max including house 0
    
    for i in range(1, len(nums)):
        current = max(prev1, prev2 + nums[i])
        prev2 = prev1
        prev1 = current
    
    return prev1`,highlightRanges:{base:{start:2,end:5},dp:{start:10,end:13}}},java:{source:`public static int rob(int[] nums) {
    if (nums.length == 0) return 0;
    if (nums.length == 1) return nums[0];
    
    int prev2 = 0;           // Max without house i-2
    int prev1 = nums[0];     // Max including house 0
    
    for (int i = 1; i < nums.length; i++) {
        int current = Math.max(prev1, prev2 + nums[i]);
        prev2 = prev1;
        prev1 = current;
    }
    
    return prev1;
}`,highlightRanges:{base:{start:2,end:3},dp:{start:8,end:12}}}}},steps:[{id:1,type:"intro",title:"The Problem",narration:"You're a robber planning to rob houses. But adjacent houses have alarms connected - rob two neighbors and you're caught! Maximize money without triggering alarms.",codeHighlight:null,visualState:{phase:"[2,7,9,3,1] - Cannot rob adjacent"},duration:8e3,interactive:!1},{id:2,type:"code_explain",title:"The Choice",narration:"At each house, two choices: skip it (keep previous max) or rob it (add its value to max from 2 houses ago). We take the better option!",codeHighlight:"dp",visualState:{phase:"max(skip, rob this + max from i-2)"},duration:8e3,interactive:!0,challenge:{type:"predict",question:"prev1=7, prev2=2, nums[i]=9. Current max?",options:["7 (skip)","11 (rob: 2+9)","9"],correct:1,explanation:"max(7, 2+9) = max(7, 11) = 11. Rob this house!"}},{id:3,type:"intro",title:"Congratulations!",narration:"House Robber mastered! Classic DP with space optimization. Same pattern as Climbing Stairs: only need last two values.",codeHighlight:null,visualState:{phase:"O(n) time, O(1) space"},duration:5e3,interactive:!1}],quiz:[{id:"rob-q1",question:"Why track prev2 (two houses back)?",options:["For counting","Can rob non-adjacent houses","Random"],correct:1}]});ge.register({id:"container-water",title:"Container With Most Water",course:"algorithms",category:"two-pointer",difficulty:"intermediate",duration:"12 min",description:"Find two lines that hold the most water.",xpReward:140,prerequisiteConcept:"two-pointer",code:{languages:{python:{source:`def maxArea(height):
    left, right = 0, len(height) - 1
    max_water = 0
    
    while left < right:
        width = right - left
        h = min(height[left], height[right])
        max_water = max(max_water, width * h)
        
        if height[left] < height[right]:
            left += 1
        else:
            right -= 1
    return max_water`,highlightRanges:{init:{start:2,end:3},area:{start:6,end:8},move:{start:10,end:13}}},java:{source:`public static int maxArea(int[] height) {
    int left = 0, right = height.length - 1;
    int maxWater = 0;
    
    while (left < right) {
        int width = right - left;
        int h = Math.min(height[left], height[right]);
        maxWater = Math.max(maxWater, width * h);
        
        if (height[left] < height[right]) {
            left++;
        } else {
            right--;
        }
    }
    return maxWater;
}`,highlightRanges:{init:{start:2,end:3},area:{start:6,end:8},move:{start:10,end:14}}}}},steps:[{id:1,type:"intro",title:"The Problem",narration:"Lines of different heights form walls. Find two walls that, with the x-axis, form a container holding the most water. Area = width times the shorter height.",codeHighlight:null,visualState:{phase:"Area = width x min(left, right)"},duration:8e3,interactive:!1},{id:2,type:"code_explain",title:"Two Pointers Strategy",narration:"Start at the widest possible container. Then the only way to improve is finding a taller wall. Move the pointer at the shorter wall - it's limiting our height!",codeHighlight:"move",visualState:{phase:"Move shorter wall toward center"},duration:8e3,interactive:!0,challenge:{type:"predict",question:"left height=3, right height=7. Which moves?",options:["Left (shorter)","Right (taller)","Both"],correct:0,explanation:"The shorter wall limits area. Move left pointer hoping for taller wall."}},{id:3,type:"intro",title:"Congratulations!",narration:"Container With Most Water solved! The insight: we can only improve by finding taller walls, so always move the limiting factor.",codeHighlight:null,visualState:{phase:"O(n) time, O(1) space"},duration:5e3,interactive:!1}],quiz:[{id:"cont-q1",question:"Why move the shorter wall?",options:["Random choice","Its the limiting factor","Speed"],correct:1}]});ge.register({id:"search-rotated",title:"Search in Rotated Sorted Array",course:"algorithms",category:"binary-search",difficulty:"intermediate",duration:"15 min",description:"Binary search in an array that was rotated.",xpReward:160,prerequisiteConcept:"binary-search",code:{languages:{python:{source:`def search_rotated(nums, target):
    left, right = 0, len(nums) - 1
    
    while left <= right:
        mid = (left + right) // 2
        if nums[mid] == target:
            return mid
        
        # Which half is sorted?
        if nums[left] <= nums[mid]:
            # Left half sorted
            if target >= nums[left] and target < nums[mid]:
                right = mid - 1
            else:
                left = mid + 1
        else:
            # Right half sorted
            if target > nums[mid] and target <= nums[right]:
                left = mid + 1
            else:
                right = mid - 1
    return -1`,highlightRanges:{check_sorted:{start:10,end:10},search_left:{start:12,end:15},search_right:{start:18,end:21}}},java:{source:`public static int searchRotated(int[] nums, int target) {
    int left = 0, right = nums.length - 1;
    
    while (left <= right) {
        int mid = (left + right) / 2;
        if (nums[mid] == target) return mid;
        
        // Which half is sorted?
        if (nums[left] <= nums[mid]) {
            // Left half sorted
            if (target >= nums[left] && target < nums[mid]) {
                right = mid - 1;
            } else {
                left = mid + 1;
            }
        } else {
            // Right half sorted
            if (target > nums[mid] && target <= nums[right]) {
                left = mid + 1;
            } else {
                right = mid - 1;
            }
        }
    }
    return -1;
}`,highlightRanges:{check_sorted:{start:9,end:9},search_left:{start:11,end:15},search_right:{start:18,end:22}}}}},steps:[{id:1,type:"intro",title:"The Problem",narration:"A sorted array was rotated: [0,1,2,4,5,6,7] becomes [4,5,6,7,0,1,2]. Find a target in O(log n). The key: at any mid, one half is still sorted!",codeHighlight:null,visualState:{phase:"[4,5,6,7 | 0,1,2] - One half always sorted"},duration:8e3,interactive:!1},{id:2,type:"code_explain",title:"Find the Sorted Half",narration:"Compare left with mid. If left <= mid, left half is sorted. Otherwise right half is sorted. Then check if target is in the sorted half - that's easy to verify!",codeHighlight:"check_sorted",visualState:{phase:"nums[left] <= nums[mid] means left half sorted"},duration:8e3,interactive:!0,challenge:{type:"predict",question:"[4,5,6,7,0,1,2], mid=7. Which half is sorted?",options:["Left [4,5,6,7]","Right [0,1,2]","Neither"],correct:0,explanation:"4 <= 7, so left half [4,5,6,7] is sorted!"}},{id:3,type:"intro",title:"Congratulations!",narration:"Search in Rotated Array mastered! The trick: one half is always sorted. Check if target is there, otherwise go to the other half. O(log n)!",codeHighlight:null,visualState:{phase:"O(log n) - Modified binary search"},duration:5e3,interactive:!1}],quiz:[{id:"rot-q1",question:"How do we know which half is sorted?",options:["Random","Compare left with mid","Check all elements"],correct:1}]});ge.register({id:"lru-cache",title:"LRU Cache",course:"algorithms",category:"design",difficulty:"hard",duration:"20 min",description:"Design a cache that evicts least recently used items.",xpReward:200,code:{languages:{python:{source:`from collections import OrderedDict

class LRUCache:
    def __init__(self, capacity):
        self.capacity = capacity
        self.cache = OrderedDict()
    
    def get(self, key):
        if key not in self.cache:
            return -1
        # Move to end (most recent)
        self.cache.move_to_end(key)
        return self.cache[key]
    
    def put(self, key, value):
        if key in self.cache:
            self.cache.move_to_end(key)
        self.cache[key] = value
        if len(self.cache) > self.capacity:
            # Remove oldest (first key)
            self.cache.popitem(last=False)`,highlightRanges:{structure:{start:4,end:6},get:{start:8,end:13},put:{start:15,end:21}}},java:{source:`class LRUCache extends LinkedHashMap<Integer, Integer> {
    private int capacity;
    
    public LRUCache(int capacity) {
        super(capacity, 0.75f, true);
        this.capacity = capacity;
    }
    
    public int get(int key) {
        return super.getOrDefault(key, -1);
    }
    
    public void put(int key, int value) {
        super.put(key, value);
    }
    
    @Override
    protected boolean removeEldestEntry(Map.Entry<Integer, Integer> eldest) {
        return size() > capacity;
    }
}`,highlightRanges:{structure:{start:1,end:6},get:{start:9,end:11},put:{start:13,end:19}}}}},steps:[{id:1,type:"intro",title:"The Problem",narration:"Design a cache with fixed capacity. When full and we add something new, evict the Least Recently Used item. Both get and put must be O(1)!",codeHighlight:null,visualState:{phase:"Cache: O(1) get, O(1) put, evict LRU"},duration:8e3,interactive:!1},{id:2,type:"code_explain",title:"Map Trick",narration:"JavaScript Map maintains insertion order! On access, delete and re-insert to move to end. First key is oldest (LRU). This gives us O(1) for everything!",codeHighlight:"get",visualState:{phase:"Map keeps order, first = oldest"},duration:8e3,interactive:!0,challenge:{type:"predict",question:"What happens when cache is full and we put new item?",options:["Error","Delete first (oldest) key","Nothing"],correct:1,explanation:"Delete the first key (least recently used) to make room."}},{id:3,type:"intro",title:"Congratulations!",narration:"LRU Cache mastered! The classic solution uses HashMap + Doubly Linked List. JavaScript Map's order property gives us a simpler solution!",codeHighlight:null,visualState:{phase:"Real interview favorite!"},duration:5e3,interactive:!1}],quiz:[{id:"lru-q1",question:"Why delete and re-set on get?",options:["Bug fix","Moves item to most recent position","Required by Map"],correct:1}]});ge.register({id:"lcs",title:"Longest Common Subsequence",course:"algorithms",category:"dynamic-programming",difficulty:"hard",duration:"18 min",description:"Find the longest subsequence common to two strings.",xpReward:180,prerequisiteConcept:"dynamic-programming",code:{languages:{python:{source:`def longestCommonSubsequence(text1, text2):
    m, n = len(text1), len(text2)
    dp = [[0] * (n + 1) for _ in range(m + 1)]
    
    for i in range(1, m + 1):
        for j in range(1, n + 1):
            if text1[i-1] == text2[j-1]:
                dp[i][j] = dp[i-1][j-1] + 1
            else:
                dp[i][j] = max(dp[i-1][j], dp[i][j-1])
    
    return dp[m][n]`,highlightRanges:{init:{start:2,end:3},match:{start:7,end:8},no_match:{start:9,end:10}}},java:{source:`public static int longestCommonSubsequence(String text1, String text2) {
    int m = text1.length(), n = text2.length();
    int[][] dp = new int[m + 1][n + 1];
    
    for (int i = 1; i <= m; i++) {
        for (int j = 1; j <= n; j++) {
            if (text1.charAt(i-1) == text2.charAt(j-1)) {
                dp[i][j] = dp[i-1][j-1] + 1;
            } else {
                dp[i][j] = Math.max(dp[i-1][j], dp[i][j-1]);
            }
        }
    }
    
    return dp[m][n];
}`,highlightRanges:{init:{start:2,end:3},match:{start:7,end:8},no_match:{start:9,end:10}}}}},steps:[{id:1,type:"intro",title:"The Problem",narration:"Find the longest subsequence present in both strings. 'abcde' and 'ace' have LCS 'ace' (length 3). Subsequence doesn't need to be contiguous!",codeHighlight:null,visualState:{phase:"abcde, ace -> LCS = ace (3)"},duration:8e3,interactive:!1},{id:2,type:"code_explain",title:"2D DP Table",narration:"dp[i][j] = LCS of text1[0..i-1] and text2[0..j-1]. If chars match, extend previous LCS. If not, take max of skipping either char.",codeHighlight:"match",visualState:{phase:"Match: dp[i-1][j-1] + 1"},duration:8e3,interactive:!0,challenge:{type:"predict",question:"text1[i]=c, text2[j]=c, dp[i-1][j-1]=2. What is dp[i][j]?",options:["2","3","1"],correct:1,explanation:"Characters match! dp[i][j] = dp[i-1][j-1] + 1 = 2 + 1 = 3"}},{id:3,type:"intro",title:"Congratulations!",narration:"LCS complete! Classic 2D DP problem. Used in diff tools, DNA sequence alignment, and spell checkers. Time O(mn), Space O(mn).",codeHighlight:null,visualState:{phase:"Time O(mn), Space O(mn)"},duration:5e3,interactive:!1}],quiz:[{id:"lcs-q1",question:"When chars dont match, we:",options:["Return 0","Take max of skipping either char","Skip both"],correct:1}]});ge.register({id:"valid-palindrome",title:"Valid Palindrome",course:"algorithms",category:"strings",difficulty:"beginner",duration:"12 min",description:"Check if a string is a valid palindrome after removing non-alphanumeric characters.",xpReward:100,prerequisiteConcept:"two-pointer",code:{languages:{python:{source:`def isPalindrome(s):
    # Step 1: Clean the string
    cleaned = ''.join(c.lower() for c in s if c.isalnum())
    
    # Step 2: Two pointers from both ends
    left = 0
    right = len(cleaned) - 1
    
    # Step 3: Compare characters
    while left < right:
        if cleaned[left] != cleaned[right]:
            return False  # Mismatch found
        left += 1
        right -= 1
    
    return True  # All characters matched`,highlightRanges:{clean:{start:2,end:3},pointers:{start:5,end:7},compare:{start:10,end:14}}},java:{source:`public static boolean isPalindrome(String s) {
    // Step 1: Clean the string
    String cleaned = s.toLowerCase().replaceAll("[^a-z0-9]", "");
    
    // Step 2: Two pointers from both ends
    int left = 0;
    int right = cleaned.length() - 1;
    
    // Step 3: Compare characters
    while (left < right) {
        if (cleaned.charAt(left) != cleaned.charAt(right)) {
            return false;  // Mismatch found
        }
        left++;
        right--;
    }
    
    return true;  // All characters matched
}`,highlightRanges:{clean:{start:2,end:3},pointers:{start:5,end:7},compare:{start:10,end:16}}}}},steps:[{id:1,type:"intro",showSide:"visual",title:"ðŸ‘‹ Valid Palindrome Problem",narration:"Let's solve a classic interview problem! A palindrome reads the same backwards as forwards. But here's the twist: we only consider alphanumeric characters and ignore cases. So 'A man, a plan, a canal: Panama' IS a palindrome because if we strip the spaces and punctuation and lowercase everything, we get 'amanaplanacanalpanama'. Can you see it reads the same both ways?",codeHighlight:null,visualState:{phase:"ðŸ”¤ Valid Palindrome",annotation:'"racecar" = âœ“\\n"hello" = âœ—\\n"A man, a plan..." = âœ“'},duration:1e4,interactive:!1},{id:2,type:"intro",showSide:"visual",title:"ðŸ¤” Two Approaches",narration:"The naive way? Reverse the string and compare. That works but creates extra space. The clever way? Use two pointers! Start one at the beginning, one at the end. Move them towards each other, comparing characters. If they all match, it's a palindrome. If any mismatch, it's not. This is O(n) time and O(1) extra space!",codeHighlight:null,visualState:{phase:"Two Pointers vs Reverse",annotation:"Reverse: O(n) space\\nTwo Pointers: O(1) space!"},duration:9e3,interactive:!0,challenge:{type:"predict",question:'For "racecar", where do the pointers start?',options:["Both at index 0","Left at 0, Right at 6","Both in the middle"],correct:1,explanation:"Two pointers start at opposite ends! L=0 (r), R=6 (r)"}},{id:3,type:"code_explain",showSide:"code",title:"ðŸ§¹ Step 1: Clean the String",narration:"First, we clean the string. We convert everything to lowercase and remove all non-alphanumeric characters using a regex. The pattern /[^a-z0-9]/g matches anything that ISN'T a lowercase letter or digit, and we replace those with empty strings. Now we have a clean string to work with!",codeHighlight:"clean",visualState:{phase:'Clean: "A man!" â†’ "aman"',annotation:"Lowercase + remove non-alphanumeric"},duration:9e3,interactive:!1},{id:4,type:"code_explain",showSide:"code",title:"ðŸ“ Step 2: Set Up Pointers",narration:"We set up two pointers: left at index 0, right at the last index. For 'racecar', left points to 'r' at position 0, and right points to 'r' at position 6. They'll walk towards each other, meeting in the middle.",codeHighlight:"pointers",visualState:{phase:"racecar: Lâ†’r...râ†R",annotation:"L=0, R=6 (length-1)"},duration:8e3,interactive:!1},{id:5,type:"code_explain",showSide:"code",title:"ðŸ”„ Step 3: Compare Characters",narration:"In the while loop, we compare characters at left and right. If they don't match, we immediately return false. If they match, we move both pointers inward: left++ and right--. We continue until the pointers cross. If we get through the entire loop without finding a mismatch, it's a palindrome!",codeHighlight:"compare",visualState:{phase:"Compare: r=r âœ“, a=a âœ“, c=c âœ“",annotation:"All match â†’ return true!"},duration:1e4,interactive:!0,challenge:{type:"predict",question:'For "hello", when L=1 (e) and R=3 (l), what happens?',options:["Continue checking","Return false - mismatch!","Return true"],correct:1,explanation:'e â‰  l, so we return false immediately. "hello" is NOT a palindrome.'}},{id:6,type:"intro",showSide:"visual",title:"ðŸ† Complexity Analysis",narration:"Time complexity is O(n) - we scan through the string once. Space complexity is O(n) for the cleaned string, or O(1) if we check in-place by skipping non-alphanumeric characters without creating a new string. This is a perfect example of the Two Pointer technique applied to strings!",codeHighlight:null,visualState:{phase:"âš¡ Time: O(n) | Space: O(1)*",annotation:"*O(1) if checking in-place"},duration:7e3,interactive:!1}],quiz:[{id:"pal-q1",question:"What do we do with spaces and punctuation?",options:["Keep them","Remove them","Replace with X"],correct:1},{id:"pal-q2",question:"When do pointers stop moving?",options:["When they cross each other","After n iterations","When a match is found"],correct:0}]});ge.register({id:"validate-bst",title:"Validate Binary Search Tree",course:"algorithms",category:"trees",difficulty:"medium",duration:"15 min",description:"Determine if a binary tree is a valid BST using bound checking.",xpReward:150,prerequisiteConcept:"binary-tree",code:{languages:{python:{source:`def isValidBST(root):
    return validate(root, float('-inf'), float('inf'))

def validate(node, min_val, max_val):
    # Base case: empty tree is valid
    if node is None:
        return True
    
    # Check if current node violates BST property
    if node.val <= min_val or node.val >= max_val:
        return False
    
    # Left subtree: max is current node's value
    # Right subtree: min is current node's value
    return validate(node.left, min_val, node.val) and \\
           validate(node.right, node.val, max_val)`,highlightRanges:{entry:{start:1,end:2},base:{start:5,end:7},check:{start:10,end:11},recurse:{start:15,end:16}}},java:{source:`public static boolean isValidBST(TreeNode root) {
    return validate(root, Long.MIN_VALUE, Long.MAX_VALUE);
}

private static boolean validate(TreeNode node, long min, long max) {
    // Base case: empty tree is valid
    if (node == null) return true;
    
    // Check if current node violates BST property
    if (node.val <= min || node.val >= max) {
        return false;
    }
    
    // Left subtree: max is current node's value
    // Right subtree: min is current node's value
    return validate(node.left, min, node.val) &&
           validate(node.right, node.val, max);
}`,highlightRanges:{entry:{start:1,end:2},base:{start:7,end:7},check:{start:10,end:12},recurse:{start:16,end:17}}}}},steps:[{id:1,type:"intro",showSide:"visual",title:"ðŸŒ³ What Makes a Valid BST?",narration:"A Binary Search Tree has a special property: for every node, ALL values in its left subtree must be LESS than the node, and ALL values in its right subtree must be GREATER. Not just the immediate children - the ENTIRE subtree! This is a common trap in interviews. Let's see how to validate this efficiently.",codeHighlight:null,visualState:{phase:"ðŸŒ³ BST Property",annotation:"Left subtree < Node < Right subtree\\nMust be true for ALL nodes!"},duration:1e4,interactive:!1},{id:2,type:"intro",showSide:"visual",title:"âŒ The Common Mistake",narration:"Many people just check if left child is smaller and right child is larger. But that's not enough! Consider a tree with root 5, left child 1, and 1's right child is 6. The node 6 is less than its parent 1... wait, no it's greater than 1, so it passes locally. But 6 is also in the LEFT subtree of 5, so it should be less than 5! It fails the GLOBAL property.",codeHighlight:null,visualState:{phase:"âŒ Wrong: Only checking parent-child",annotation:"   5\\n  / \\\\\\n 1   7\\n  \\\\\\n   6 â† Invalid! 6 > 5 but in left subtree"},duration:11e3,interactive:!0,challenge:{type:"predict",question:"Tree [5,1,7,null,6]. Is node 6 in a valid position?",options:["Yes, 6 > 1","No, 6 should be < 5","Yes, it follows BST rules"],correct:1,explanation:"6 is in the LEFT subtree of 5, so it must be < 5. But 6 > 5, so it is INVALID!"}},{id:3,type:"code_explain",showSide:"code",title:"ðŸ’¡ The Solution: Min/Max Bounds",narration:"The key insight is to track valid BOUNDS for each node. Every node must be greater than a minimum value and less than a maximum value. We start with -Infinity to +Infinity. When we go left, the current node becomes the new maximum. When we go right, the current node becomes the new minimum. This propagates the constraints down the tree!",codeHighlight:"entry",visualState:{phase:"Start: min=-âˆž, max=+âˆž",annotation:"Bounds narrow as we descend"},duration:1e4,interactive:!1},{id:4,type:"code_explain",showSide:"code",title:"ðŸ” Check Bounds",narration:"At each node, we check if the value is within bounds. If node.val is less than or equal to min, or greater than or equal to max, the BST property is violated and we return false. Note: we use strict inequalities because BST typically doesn't allow duplicates.",codeHighlight:"check",visualState:{phase:"Check: min < node.val < max",annotation:"Violation â†’ return false"},duration:8e3,interactive:!1},{id:5,type:"code_explain",showSide:"code",title:"ðŸ”„ Recurse with Updated Bounds",narration:"The magic happens in recursion! For the left subtree, the current node's value becomes the new MAX - everything on the left must be smaller. For the right subtree, the current node's value becomes the new MIN - everything on the right must be larger. Both subtrees must be valid for the whole tree to be valid.",codeHighlight:"recurse",visualState:{phase:"Left: max=node.val | Right: min=node.val",annotation:"Bounds propagate constraints down"},duration:1e4,interactive:!0,challenge:{type:"predict",question:"At node 5, we go left to node 3. What are the new bounds for 3?",options:["min=-âˆž, max=5","min=5, max=âˆž","min=3, max=5"],correct:0,explanation:"Going LEFT sets max=5. Node 3 must be between -âˆž and 5."}},{id:6,type:"intro",showSide:"visual",title:"ðŸ† Complexity",narration:"Time complexity is O(n) - we visit each node exactly once. Space complexity is O(h) for the recursion stack, where h is the tree height. In the worst case (skewed tree), that's O(n). In a balanced tree, it's O(log n). You've mastered BST validation!",codeHighlight:null,visualState:{phase:"âš¡ Time: O(n) | Space: O(h)",annotation:"h = height of tree"},duration:7e3,interactive:!1}],quiz:[{id:"bst-q1",question:"What bounds does the root node have?",options:["(0, 100)","(-âˆž, +âˆž)","(min, max)"],correct:1},{id:"bst-q2",question:"When going to left child, which bound changes?",options:["Min becomes current value","Max becomes current value","Both change"],correct:1}]});ge.register({id:"detect-cycle",title:"Detect Cycle in Linked List",course:"algorithms",category:"linked-lists",difficulty:"medium",duration:"14 min",description:"Detect if a linked list has a cycle using Floyd Tortoise and Hare algorithm.",xpReward:140,prerequisiteConcept:"linked-list",code:{languages:{python:{source:`def hasCycle(head):
    # Step 1: Handle edge cases
    if not head or not head.next:
        return False
    
    # Step 2: Initialize slow and fast pointers
    slow = head
    fast = head
    
    # Step 3: Move pointers at different speeds
    while fast and fast.next:
        slow = slow.next       # Slow moves 1 step
        fast = fast.next.next  # Fast moves 2 steps
        
        # Step 4: If they meet, there's a cycle!
        if slow == fast:
            return True
    
    # Fast reached the end - no cycle
    return False`,highlightRanges:{edge:{start:2,end:4},init:{start:6,end:8},move:{start:11,end:13},detect:{start:16,end:17}}},java:{source:`public static boolean hasCycle(ListNode head) {
    // Step 1: Handle edge cases
    if (head == null || head.next == null) return false;
    
    // Step 2: Initialize slow and fast pointers
    ListNode slow = head;
    ListNode fast = head;
    
    // Step 3: Move pointers at different speeds
    while (fast != null && fast.next != null) {
        slow = slow.next;       // Slow moves 1 step
        fast = fast.next.next;  // Fast moves 2 steps
        
        // Step 4: If they meet, there's a cycle!
        if (slow == fast) {
            return true;
        }
    }
    
    // Fast reached the end - no cycle
    return false;
}`,highlightRanges:{edge:{start:2,end:3},init:{start:5,end:7},move:{start:10,end:12},detect:{start:15,end:17}}}}},steps:[{id:1,type:"intro",showSide:"visual",title:"ðŸ”— The Cycle Detection Problem",narration:"Imagine a linked list where the tail connects back to some earlier node, creating a loop. If you tried to traverse this list, you'd be stuck forever! Your task is to detect if such a cycle exists. The obvious approach is to track all visited nodes in a hash set. But can we do it with O(1) space? Yes! Using the famous Floyd's Cycle Detection algorithm.",codeHighlight:null,visualState:{phase:"ðŸ”— Linked List Cycle",annotation:"1â†’2â†’3â†’4â†’5â†’2 (cycle back to 2!)"},duration:1e4,interactive:!1},{id:2,type:"intro",showSide:"visual",title:"ðŸ¢ðŸ‡ Tortoise and Hare",narration:"Floyd's algorithm uses two pointers: one SLOW (the tortoise) and one FAST (the hare). The slow pointer moves one step at a time. The fast pointer moves TWO steps at a time. Here's the key insight: if there's a cycle, the fast pointer will eventually lap the slow pointer and they'll meet! If there's no cycle, the fast pointer reaches the end first.",codeHighlight:null,visualState:{phase:"ðŸ¢ Slow: 1 step | ðŸ‡ Fast: 2 steps",annotation:"If cycle exists â†’ they WILL meet!"},duration:1e4,interactive:!0,challenge:{type:"predict",question:"In a list of 5 nodes with a cycle, will fast catch slow?",options:["Yes, fast will lap slow","No, slow is too far ahead","Only if cycle is at the end"],correct:0,explanation:"In a cycle, fast gains 1 position per iteration, so it WILL catch slow!"}},{id:3,type:"code_explain",showSide:"code",title:"ðŸ“ Initialize Two Pointers",narration:"We start both pointers at the head. The slow pointer (tortoise) will move one node at a time. The fast pointer (hare) will move two nodes at a time. Think of it like two runners on a circular track - the faster one will eventually lap the slower one.",codeHighlight:"init",visualState:{phase:"Start: slow=head, fast=head",annotation:"Both start at the same position"},duration:8e3,interactive:!1},{id:4,type:"code_explain",showSide:"code",title:"ðŸƒ Move at Different Speeds",narration:"In each iteration, slow moves one step (slow = slow.next) and fast moves two steps (fast = fast.next.next). We need to check that fast and fast.next exist before moving - if either is null, we've reached the end and there's no cycle.",codeHighlight:"move",visualState:{phase:"Each iteration:",annotation:"slow += 1 step\\nfast += 2 steps"},duration:9e3,interactive:!1},{id:5,type:"code_explain",showSide:"code",title:"ðŸŽ¯ Detect the Meeting",narration:"After moving the pointers, we check if they point to the same node. If slow === fast, we've found a cycle! Think about why: in a cycle, fast is catching up to slow by 1 position each iteration. Eventually, the gap closes to 0 and they meet. This is guaranteed to happen if there's a cycle.",codeHighlight:"detect",visualState:{phase:"slow === fast â†’ CYCLE!",annotation:"Fast catches up by 1 each iteration"},duration:9e3,interactive:!0,challenge:{type:"predict",question:"If the list has no cycle, what happens to fast?",options:["It meets slow eventually","It reaches null (end)","It goes back to head"],correct:1,explanation:"Without a cycle, fast reaches the end (null) and the loop exits. Return false!"}},{id:6,type:"intro",showSide:"visual",title:"ðŸ† Why This Works & Complexity",narration:"In a cycle, fast catches slow because the gap decreases by 1 each step. If the cycle has length k, they meet within k iterations after slow enters the cycle. Time: O(n) - we traverse at most 2n nodes. Space: O(1) - just two pointers, no extra storage! This is a brilliant algorithm you'll use in many problems.",codeHighlight:null,visualState:{phase:"âš¡ Time: O(n) | Space: O(1)",annotation:"Floyd Algorithm - elegant & efficient!"},duration:8e3,interactive:!1}],quiz:[{id:"cycle-q1",question:"How many steps does fast pointer move?",options:["1","2","3"],correct:1},{id:"cycle-q2",question:"What indicates a cycle?",options:["fast reaches null","slow equals fast","slow reaches null"],correct:1}]});ge.register({id:"merge-intervals",title:"Merge Intervals",course:"algorithms",category:"arrays",difficulty:"medium",duration:"13 min",description:"Merge all overlapping intervals into non-overlapping intervals.",xpReward:140,prerequisiteConcept:"sorting",code:{languages:{python:{source:`def merge(intervals):
    # Step 1: Handle edge case
    if len(intervals) <= 1:
        return intervals
    
    # Step 2: Sort by start time
    intervals.sort(key=lambda x: x[0])
    
    # Step 3: Initialize result with first interval
    result = [intervals[0]]
    
    # Step 4: Process each interval
    for i in range(1, len(intervals)):
        current = intervals[i]
        last_merged = result[-1]
        
        # Step 5: Check for overlap
        if current[0] <= last_merged[1]:
            # Merge by extending the end
            last_merged[1] = max(last_merged[1], current[1])
        else:
            # No overlap, add as new interval
            result.append(current)
    
    return result`,highlightRanges:{sort:{start:6,end:7},init:{start:9,end:10},loop:{start:13,end:15},merge:{start:18,end:23}}},java:{source:`public static int[][] merge(int[][] intervals) {
    // Step 1: Handle edge case
    if (intervals.length <= 1) return intervals;
    
    // Step 2: Sort by start time
    Arrays.sort(intervals, (a, b) -> a[0] - b[0]);
    
    // Step 3: Initialize result with first interval
    List<int[]> result = new ArrayList<>();
    result.add(intervals[0]);
    
    // Step 4: Process each interval
    for (int i = 1; i < intervals.length; i++) {
        int[] current = intervals[i];
        int[] lastMerged = result.get(result.size() - 1);
        
        // Step 5: Check for overlap
        if (current[0] <= lastMerged[1]) {
            // Merge by extending the end
            lastMerged[1] = Math.max(lastMerged[1], current[1]);
        } else {
            // No overlap, add as new interval
            result.add(current);
        }
    }
    
    return result.toArray(new int[result.size()][]);
}`,highlightRanges:{sort:{start:5,end:6},init:{start:8,end:10},loop:{start:13,end:15},merge:{start:18,end:25}}}}},steps:[{id:1,type:"intro",showSide:"visual",title:"ðŸ“Š Merge Overlapping Intervals",narration:"You're given a collection of intervals like [[1,3], [2,6], [8,10], [15,18]]. Your job is to merge any that overlap. Looking at these: [1,3] and [2,6] overlap because 2 is between 1 and 3. They merge into [1,6]. The interval [8,10] doesn't overlap with [1,6] or [15,18], so it stays separate. Result: [[1,6], [8,10], [15,18]].",codeHighlight:null,visualState:{phase:"ðŸ“Š Merge Overlapping Intervals",annotation:"[1,3]+[2,6]=[1,6]\\n[8,10], [15,18] stay separate"},duration:11e3,interactive:!1},{id:2,type:"intro",showSide:"visual",title:"ðŸ’¡ The Key Insight: Sort First!",narration:"Here's the trick: sort all intervals by their start time. Why? Because after sorting, overlapping intervals will be adjacent! You only need to compare each interval with the one before it. This turns a potentially O(nÂ²) problem into O(n log n) - dominated by the sorting step.",codeHighlight:null,visualState:{phase:"Sort by start time first!",annotation:"Overlapping intervals become adjacent"},duration:9e3,interactive:!0,challenge:{type:"predict",question:"After sorting [[8,10], [1,3], [2,6]], what's the order?",options:["[[1,3], [2,6], [8,10]]","[[8,10], [2,6], [1,3]]","Stays the same"],correct:0,explanation:"Sort by start: 1, 2, 8 â†’ [[1,3], [2,6], [8,10]]"}},{id:3,type:"code_explain",showSide:"code",title:"ðŸ“‹ Sort and Initialize",narration:"First, we sort intervals by start time using a custom comparator (a[0] - b[0]). Then we initialize our result array with the first interval. This will be our 'current merged interval' that we compare against.",codeHighlight:"sort",visualState:{phase:"Sort: intervals.sort((a,b) => a[0]-b[0])",annotation:"Result starts with first interval"},duration:8e3,interactive:!1},{id:4,type:"code_explain",showSide:"code",title:"ðŸ”„ Process Each Interval",narration:"We iterate through the remaining intervals. For each one, we get the 'lastMerged' interval from our result. Then we check: does the current interval's start overlap with lastMerged's end? If current[0] <= lastMerged[1], they overlap!",codeHighlight:"loop",visualState:{phase:"Check: current[0] <= lastMerged[1]?",annotation:"If yes â†’ overlap!\\nIf no â†’ separate interval"},duration:9e3,interactive:!1},{id:5,type:"code_explain",showSide:"code",title:"ðŸ”— Merge or Add New",narration:"If overlapping, we merge by extending lastMerged's end to be the maximum of the two ends. Why max? Because one interval might completely contain the other! If no overlap, we simply add the current interval to our result as a new separate interval.",codeHighlight:"merge",visualState:{phase:"Merge: lastMerged[1] = max(ends)",annotation:"[1,6] + [2,4] â†’ [1,6] (max end wins)"},duration:1e4,interactive:!0,challenge:{type:"predict",question:"Merging [1,10] and [2,5], what's the result?",options:["[1,5]","[2,10]","[1,10]"],correct:2,explanation:"Overlap! End = max(10, 5) = 10. Result: [1,10]. The larger interval contains the smaller!"}},{id:6,type:"intro",showSide:"visual",title:"ðŸ† Complexity Analysis",narration:"Time complexity is O(n log n) due to sorting - the merging pass itself is just O(n). Space complexity is O(n) for the result array (or O(log n) if we only count sorting space). This is a very common interview problem that tests your ability to think about sorting and greedy approaches!",codeHighlight:null,visualState:{phase:"âš¡ Time: O(n log n) | Space: O(n)",annotation:"Sorting dominates the complexity"},duration:7e3,interactive:!1}],quiz:[{id:"merge-q1",question:"Why do we sort by start time?",options:["For efficiency","Overlapping intervals become adjacent","Required by problem"],correct:1},{id:"merge-q2",question:"When do two intervals overlap?",options:["current[0] <= lastMerged[1]","current[1] <= lastMerged[0]","They never overlap"],correct:0}]});ge.register({id:"product-except-self",title:"Product of Array Except Self",course:"algorithms",category:"arrays",difficulty:"medium",duration:"14 min",description:"Find product of all elements except self without using division.",xpReward:150,prerequisiteConcept:"prefix-sum",code:{languages:{python:{source:`def productExceptSelf(nums):
    n = len(nums)
    result = [0] * n
    
    # Step 1: Calculate prefix products (left to right)
    result[0] = 1
    for i in range(1, n):
        result[i] = result[i - 1] * nums[i - 1]
    
    # Step 2: Multiply by suffix products (right to left)
    suffix = 1
    for i in range(n - 1, -1, -1):
        result[i] *= suffix
        suffix *= nums[i]
    
    return result`,highlightRanges:{init:{start:2,end:3},prefix:{start:6,end:8},suffix:{start:11,end:14}}},java:{source:`public static int[] productExceptSelf(int[] nums) {
    int n = nums.length;
    int[] result = new int[n];
    
    // Step 1: Calculate prefix products (left to right)
    result[0] = 1;
    for (int i = 1; i < n; i++) {
        result[i] = result[i - 1] * nums[i - 1];
    }
    
    // Step 2: Multiply by suffix products (right to left)
    int suffix = 1;
    for (int i = n - 1; i >= 0; i--) {
        result[i] *= suffix;
        suffix *= nums[i];
    }
    
    return result;
}`,highlightRanges:{init:{start:2,end:3},prefix:{start:6,end:8},suffix:{start:11,end:15}}}}},steps:[{id:1,type:"intro",showSide:"visual",title:"âœ–ï¸ Product Except Self",narration:"Given [1, 2, 3, 4], return an array where each element is the product of all OTHER elements. So for index 0, it's 2*3*4 = 24. For index 1, it's 1*3*4 = 12. Result: [24, 12, 8, 6]. The catch? You can't use division! So you can't just calculate the total product and divide.",codeHighlight:null,visualState:{phase:"âœ–ï¸ Product Except Self",annotation:"[1,2,3,4] â†’ [24,12,8,6]\\nNo division allowed!"},duration:1e4,interactive:!1},{id:2,type:"intro",showSide:"visual",title:"ðŸ’¡ The Prefix-Suffix Insight",narration:"The key insight: for each position i, the answer is (product of all elements before i) * (product of all elements after i). We call these PREFIX and SUFFIX products. We can calculate prefixes in one pass left-to-right, and suffixes in another pass right-to-left. Two O(n) passes = O(n) total!",codeHighlight:null,visualState:{phase:"result[i] = prefix[i] Ã— suffix[i]",annotation:"prefix: products before i\\nsuffix: products after i"},duration:1e4,interactive:!0,challenge:{type:"predict",question:"For [1,2,3,4] at index 2, what are prefix and suffix?",options:["prefix=2, suffix=4","prefix=1Ã—2=2, suffix=4","prefix=6, suffix=4"],correct:1,explanation:"Prefix at index 2 is product before it: 1Ã—2=2. Suffix is product after: just 4."}},{id:3,type:"code_explain",showSide:"code",title:"âž¡ï¸ Pass 1: Prefix Products",narration:"First pass: calculate prefix products. result[0] = 1 (nothing before index 0). For each subsequent position, result[i] = result[i-1] Ã— nums[i-1]. After this pass for [1,2,3,4], we have [1, 1, 2, 6]. Each position holds the product of all elements before it.",codeHighlight:"prefix",visualState:{phase:"Prefix: [1, 1, 2, 6]",annotation:"result[i] = result[i-1] Ã— nums[i-1]"},duration:1e4,interactive:!1},{id:4,type:"code_explain",showSide:"code",title:"â¬…ï¸ Pass 2: Suffix Products",narration:"Second pass: multiply by suffix products going right-to-left. We track a running 'suffix' variable starting at 1. For each position (backwards), we multiply result[i] by suffix, then update suffix by multiplying it with nums[i]. This accumulates the product of all elements after each position.",codeHighlight:"suffix",visualState:{phase:"Suffix pass: [1,1,2,6] â†’ [24,12,8,6]",annotation:"result[i] *= suffix\\nsuffix *= nums[i]"},duration:11e3,interactive:!0,challenge:{type:"predict",question:"After prefix [1,1,2,6], at i=2, suffix=4. What is result[2]?",options:["2","6","8"],correct:2,explanation:"result[2] = prefix * suffix = 2 Ã— 4 = 8 âœ“"}},{id:5,type:"intro",showSide:"visual",title:"ðŸ† Complexity & Edge Cases",narration:"Time: O(n) with just two passes. Space: O(1) excluding output array! The beauty is we reuse the result array for prefix products, then modify in-place for suffix. Watch out for zeros: if there's one zero, only that position has a non-zero result. If there are two+ zeros, everything is zero!",codeHighlight:null,visualState:{phase:"âš¡ Time: O(n) | Space: O(1)",annotation:"Edge: [1,0,3] â†’ [0,3,0]\\n[0,0,3] â†’ [0,0,0]"},duration:8e3,interactive:!1}],quiz:[{id:"pxs-q1",question:"What is prefix[0]?",options:["0","1","nums[0]"],correct:1},{id:"pxs-q2",question:"How many passes through the array?",options:["1","2","3"],correct:1}]});ge.register({id:"spiral-matrix",title:"Spiral Matrix",course:"algorithms",category:"arrays",difficulty:"medium",duration:"15 min",description:"Traverse a matrix in spiral order using shrinking boundaries.",xpReward:150,prerequisiteConcept:"matrices",code:{language:"javascript",source:`function spiralOrder(matrix) {
  const result = [];
  if (!matrix.length) return result;
  
  // Define boundaries
  let top = 0, bottom = matrix.length - 1;
  let left = 0, right = matrix[0].length - 1;
  
  while (top <= bottom && left <= right) {
    // Right: traverse top row
    for (let i = left; i <= right; i++) {
      result.push(matrix[top][i]);
    }
    top++;
    
    // Down: traverse right column
    for (let i = top; i <= bottom; i++) {
      result.push(matrix[i][right]);
    }
    right--;
    
    // Left: traverse bottom row (if exists)
    if (top <= bottom) {
      for (let i = right; i >= left; i--) {
result.push(matrix[bottom][i]);
      }
      bottom--;
    }
    
    // Up: traverse left column (if exists)
    if (left <= right) {
      for (let i = bottom; i >= top; i--) {
result.push(matrix[i][left]);
      }
      left++;
    }
  }
  
  return result;
}`,highlightRanges:{bounds:{start:5,end:7},right_move:{start:10,end:13},down_move:{start:15,end:19},left_move:{start:21,end:26},up_move:{start:28,end:33}}},steps:[{id:1,type:"intro",showSide:"visual",title:"ðŸŒ€ Spiral Matrix Traversal",narration:"Given a matrix, traverse it in spiral order - starting from top-left, going right, then down, then left, then up, and repeating in a shrinking spiral until you've visited every element. For a 3x3 matrix [[1,2,3],[4,5,6],[7,8,9]], the spiral order is [1,2,3,6,9,8,7,4,5]. Visualize it like peeling an onion layer by layer!",codeHighlight:null,visualState:{phase:"ðŸŒ€ Spiral: â†’ â†“ â† â†‘ (repeat)",annotation:"1â†’2â†’3â†“6â†“9â†8â†7â†‘4â†’5"},duration:1e4,interactive:!1},{id:2,type:"intro",showSide:"visual",title:"ðŸ“¦ The Boundary Approach",narration:"The key is to track four boundaries: top, bottom, left, right. Initially, top=0, bottom=rows-1, left=0, right=cols-1. After traversing a row or column, we shrink the corresponding boundary inward. When boundaries cross, we're done! This elegantly handles rectangles of any shape.",codeHighlight:null,visualState:{phase:"Four Boundaries",annotation:"top=0, bottom=2\\nleft=0, right=2\\nShrink after each layer"},duration:9e3,interactive:!0,challenge:{type:"predict",question:"After traversing top row of 3x3, what happens to top boundary?",options:["top++","top--","Stays same"],correct:0,explanation:"After going right along top row, increment top (top++) to move it down."}},{id:3,type:"code_explain",showSide:"code",title:"âž¡ï¸ Move Right",narration:"First, traverse the top row from left to right. We iterate i from left to right, adding matrix[top][i] to our result. After the entire row is done, increment top - that row is processed and we won't visit it again.",codeHighlight:"right_move",visualState:{phase:"âž¡ï¸ Traverse top row",annotation:"for i = left to right\\nresult.push(matrix[top][i])\\ntop++"},duration:8e3,interactive:!1},{id:4,type:"code_explain",showSide:"code",title:"â¬‡ï¸ Move Down",narration:"Next, traverse the rightmost column from top to bottom. Iterate i from top to bottom, adding matrix[i][right]. After this column is done, decrement right - we won't visit this column again.",codeHighlight:"down_move",visualState:{phase:"â¬‡ï¸ Traverse right column",annotation:"for i = top to bottom\\nresult.push(matrix[i][right])\\nright--"},duration:8e3,interactive:!1},{id:5,type:"code_explain",showSide:"code",title:"â¬…ï¸ Move Left (with check)",narration:"Traverse bottom row from right to left - BUT only if top <= bottom! Why the check? In some matrices, the previous moves might have already crossed boundaries. If we've already processed all rows, we shouldn't traverse a ghost row.",codeHighlight:"left_move",visualState:{phase:"â¬…ï¸ Traverse bottom row",annotation:"if (top <= bottom)\\nbottom--"},duration:9e3,interactive:!0,challenge:{type:"predict",question:"For a 1Ã—4 matrix (single row), do we need the left traversal?",options:["Yes always","No, top > bottom after going right","Depends"],correct:1,explanation:"After going right on the only row, top becomes 1 while bottom is 0. top > bottom, so we skip!"}},{id:6,type:"intro",showSide:"visual",title:"ðŸ† Complexity",narration:"Time: O(mÃ—n) - we visit each cell exactly once. Space: O(1) excluding the output array. The elegance is in the boundary variables that naturally handle all edge cases: single row, single column, rectangular shapes, and square matrices. Master this pattern!",codeHighlight:null,visualState:{phase:"âš¡ Time: O(mÃ—n) | Space: O(1)",annotation:"Each cell visited exactly once"},duration:7e3,interactive:!1}],quiz:[{id:"spiral-q1",question:"How many directions does spiral traversal have?",options:["2","3","4"],correct:2},{id:"spiral-q2",question:"When do we stop the spiral?",options:["After one layer","When boundaries cross","After n iterations"],correct:1}]});ge.register({id:"single-number-triples",title:"Single Number (XOR Trick)",course:"algorithms",category:"bit-manipulation",difficulty:"medium",duration:"12 min",description:"Find the number that appears once when all others appear twice using XOR.",xpReward:130,prerequisiteConcept:"bit-manipulation",code:{languages:{python:{source:`def singleNumber(nums):
    # XOR all numbers together
    # Duplicates cancel out, leaving the single number
    
    result = 0
    
    for num in nums:
        result ^= num  # XOR with each number
    
    return result`,highlightRanges:{init:{start:5,end:5},loop:{start:7,end:8},result:{start:10,end:10}}},java:{source:`public static int singleNumber(int[] nums) {
    // XOR all numbers together
    // Duplicates cancel out, leaving the single number
    
    int result = 0;
    
    for (int num : nums) {
        result ^= num;  // XOR with each number
    }
    
    return result;
}`,highlightRanges:{init:{start:5,end:5},loop:{start:7,end:9},result:{start:11,end:11}}}}},steps:[{id:1,type:"intro",showSide:"visual",title:"ðŸ” Find the Unique Number",narration:"You're given an array where every element appears TWICE except for one element that appears only ONCE. Find that single element. For example, [4, 1, 2, 1, 2] has the single number 4. You could use a hash map, but that's O(n) space. Can we do it with O(1) space? Yes! Using the magical XOR operator.",codeHighlight:null,visualState:{phase:"ðŸ” Find the Single Number",annotation:"[4, 1, 2, 1, 2] â†’ 4\\nO(1) space required!"},duration:1e4,interactive:!1},{id:2,type:"intro",showSide:"visual",title:"âŠ• XOR Magic Properties",narration:"XOR (exclusive or) has magical properties! First: a XOR a = 0. Any number XORed with itself gives 0. Second: a XOR 0 = a. XOR with zero gives the original number. Third: XOR is commutative and associative - order doesn't matter! So if we XOR all numbers, pairs cancel to 0, leaving only the single number!",codeHighlight:null,visualState:{phase:"XOR Properties",annotation:"a âŠ• a = 0\\na âŠ• 0 = a\\na âŠ• b âŠ• a = b"},duration:11e3,interactive:!0,challenge:{type:"predict",question:"What is 5 XOR 3 XOR 5?",options:["5","3","0"],correct:1,explanation:"5 XOR 5 = 0, then 0 XOR 3 = 3. The 5s cancel out!"}},{id:3,type:"code_explain",showSide:"code",title:"ðŸ”„ XOR All Numbers",narration:"The code is elegantly simple! Start with result = 0. Loop through every number and XOR it with result. Each pair cancels out: 1 XOR 1 = 0, 2 XOR 2 = 0. Only the single number survives because it has no partner to cancel with!",codeHighlight:"loop",visualState:{phase:"result ^= each number",annotation:"0^4^1^2^1^2 = 0^4^0^0 = 4"},duration:9e3,interactive:!1},{id:4,type:"visualize",showSide:"visual",title:"ðŸ‘ï¸ Watch XOR in Action",narration:"Let's trace through [4,1,2,1,2]: Start with 0. XOR 4: 0^4=4. XOR 1: 4^1=5. XOR 2: 5^2=7. XOR 1: 7^1=6. XOR 2: 6^2=4. We're back to 4! The pairs (1,1) and (2,2) cancelled out in the XOR operations, leaving just 4.",codeHighlight:null,visualState:{phase:"Trace: [4,1,2,1,2]",annotation:"0â†’4â†’5â†’7â†’6â†’4 âœ“"},duration:1e4,interactive:!0,challenge:{type:"predict",question:"For [2,2,1], what is the final XOR result?",options:["0","1","2"],correct:1,explanation:"2 XOR 2 = 0, then 0 XOR 1 = 1. The single number is 1!"}},{id:5,type:"intro",showSide:"visual",title:"ðŸ† Complexity",narration:"Time: O(n) - single pass through the array. Space: O(1) - just one variable! This is the most elegant solution possible. XOR is a powerful tool for problems involving pairs, toggles, and finding unique elements. Add this pattern to your toolkit!",codeHighlight:null,visualState:{phase:"âš¡ Time: O(n) | Space: O(1)",annotation:"Most elegant solution possible!"},duration:7e3,interactive:!1}],quiz:[{id:"xor-q1",question:"What is 7 XOR 7?",options:["7","14","0"],correct:2},{id:"xor-q2",question:"Why do pairs cancel in XOR?",options:["They add up to 0","a XOR a = 0","XOR is random"],correct:1}]});const q0={shortcuts:[{key:"Space",action:"Play / Pause",context:"lecture"},{key:"â†’",action:"Next Step",context:"lecture"},{key:"â†",action:"Previous Step",context:"lecture"},{key:"F",action:"Flip Code / Visual",context:"lecture"},{key:"M",action:"Mute / Unmute Narration",context:"lecture"},{key:"Escape",action:"Exit Lecture",context:"lecture"},{key:"B",action:"Open Lecture Browser",context:"global"},{key:"Ctrl+S",action:"Open Settings",context:"global"},{key:"?",action:"Show This Help",context:"any"}],showHelp(){let t=document.getElementById("keyboardHelpModal");t||(t=document.createElement("div"),t.id="keyboardHelpModal",t.className="keyboard-help-modal",document.body.appendChild(t)),t.innerHTML=`
      <div class="keyboard-help-content">
        <div class="help-header">
          <h2>âŒ¨ï¸ Keyboard Shortcuts</h2>
          <button class="help-close" onclick="document.getElementById('keyboardHelpModal').classList.remove('active')">âœ•</button>
        </div>
        <div class="shortcuts-list">
          ${this.shortcuts.map(e=>`
            <div class="shortcut-item">
              <kbd>${e.key}</kbd>
              <span>${e.action}</span>
            </div>
          `).join("")}
        </div>
        <p class="help-tip">Press <kbd>?</kbd> anytime to show this help</p>
      </div>
    `,t.classList.add("active")},hideHelp(){const t=document.getElementById("keyboardHelpModal");t&&t.classList.remove("active")}};window.KeyboardShortcuts=q0;document.addEventListener("keydown",t=>{if(t.target.tagName==="INPUT"||t.target.tagName==="TEXTAREA"||t.target.isContentEditable||t.target.closest(".cm-editor"))return;if(t.key==="?"){t.preventDefault(),q0.showHelp();return}if((t.key==="b"||t.key==="B")&&!De.state.lecture){t.preventDefault(),M0.showBrowser();return}if(t.ctrlKey&&(t.key==="s"||t.key==="S")){t.preventDefault(),tu.show();return}if(!De.state.lecture)return;const e={" ":()=>{t.preventDefault(),De.togglePlay()},ArrowRight:()=>{t.preventDefault(),De.next()},ArrowLeft:()=>{t.preventDefault(),De.prev()},l:()=>{t.preventDefault(),De.next()},L:()=>{t.preventDefault(),De.next()},j:()=>{t.preventDefault(),De.prev()},J:()=>{t.preventDefault(),De.prev()},Home:()=>{t.preventDefault(),De.first()},End:()=>{t.preventDefault(),De.last()},"[":()=>{t.preventDefault(),De.decreaseSpeed()},"]":()=>{t.preventDefault(),De.increaseSpeed()},"-":()=>{t.preventDefault(),De.decreaseSpeed()},"=":()=>{t.preventDefault(),De.increaseSpeed()},"+":()=>{t.preventDefault(),De.increaseSpeed()},f:()=>{t.preventDefault(),De.flipTo(De.state.currentSide==="code"?"visual":"code")},F:()=>{t.preventDefault(),De.flipTo(De.state.currentSide==="code"?"visual":"code")},m:()=>{t.preventDefault(),V.toggle()},M:()=>{t.preventDefault(),V.toggle()},i:()=>{t.preventDefault();const i=document.getElementById("eLectureCustomInputPanel");i.style.display=i.style.display==="none"?"block":"none"},I:()=>{t.preventDefault();const i=document.getElementById("eLectureCustomInputPanel");i.style.display=i.style.display==="none"?"block":"none"},Escape:()=>{t.preventDefault(),De.exit()}};e[t.key]&&e[t.key]()});const nt={questions:new Map,register(t){this.questions.set(t.id,t)},get(t){return this.questions.get(t)},getAll(){return Array.from(this.questions.values())},getByCategory(t){return this.getAll().filter(e=>e.category===t)},getByDifficulty(t){return this.getAll().filter(e=>e.difficulty===t)},isCompleted(t){return localStorage.getItem(`problem-completed-${t}`)==="true"},markCompleted(t){localStorage.setItem(`problem-completed-${t}`,"true")}},M2={currentProblem:null,currentStep:0,open(t){const e=nt.get(t);if(!e){T("Problem not found","error");return}this.currentProblem=e,this.currentStep=0,this.render(),StreakSystem.addXP(10,`Started problem: ${e.title}`)},close(){const t=document.getElementById("walkthroughOverlay");t&&t.classList.remove("active"),this.currentProblem=null},startNarratorMode(){if(console.log("[Narrator] startNarratorMode called"),console.log("[Narrator] currentProblem:",this.currentProblem),!this.currentProblem){T("No problem selected","error");return}const t=this.currentProblem.id;console.log("[Narrator] Looking for lecture:",t);const e=ge.get(t);if(console.log("[Narrator] Found lecture:",e),!e){T("ðŸš§ Narrator lecture coming soon for this problem!","info");return}this.close(),setTimeout(()=>{console.log("[Narrator] Loading ELectureEngineV5 with:",t),De.start(t)},300)},goToStep(t){if(!this.currentProblem)return;const e=this.currentProblem.walkthrough.steps;if(t<0||t>=e.length)return;this.currentStep=t,this.updateStepDisplay();const i=document.querySelector(".walkthrough-container");i&&i.scrollTo({top:0,behavior:"smooth"})},nextStep(){if(!this.currentProblem)return;const t=this.currentProblem.walkthrough.steps;if(this.currentStep<t.length-1){this.currentStep++,this.updateStepDisplay();const e=document.querySelector(".walkthrough-container");e&&e.scrollTo({top:0,behavior:"smooth"})}else this.markComplete()},prevStep(){if(this.currentStep>0){this.currentStep--,this.updateStepDisplay();const t=document.querySelector(".walkthrough-container");t&&t.scrollTo({top:0,behavior:"smooth"})}},updateStepDisplay(){document.querySelectorAll(".walkthrough-step-tab").forEach((r,n)=>{r.classList.remove("active"),n===this.currentStep&&r.classList.add("active"),n<this.currentStep&&r.classList.add("completed")}),document.querySelectorAll(".walkthrough-step-section").forEach((r,n)=>{r.classList.remove("active"),n===this.currentStep&&r.classList.add("active")});const i=document.getElementById("walkthroughPrevBtn"),s=document.getElementById("walkthroughNextBtn");if(i&&(i.disabled=this.currentStep===0),s){const r=this.currentStep===this.currentProblem.walkthrough.steps.length-1;s.textContent=r?"Complete âœ“":"Next â†’",s.classList.toggle("primary",r)}},markComplete(){this.currentProblem&&(nt.markCompleted(this.currentProblem.id),StreakSystem.addXP(this.currentProblem.xpReward,`Completed: ${this.currentProblem.title}`),Li.burst(window.innerWidth/2,window.innerHeight/2,50),T(`ðŸŽ‰ Problem Complete! +${this.currentProblem.xpReward} XP`,"success"),setTimeout(()=>this.close(),1500))},copyCode(t){const e=t.closest(".code-block-wrapper").querySelector(".code-block");e&&(navigator.clipboard.writeText(e.textContent),t.textContent="Copied!",setTimeout(()=>t.textContent="Copy",2e3))},render(){const t=this.currentProblem;if(!t)return;let e=document.getElementById("walkthroughOverlay");e||(e=document.createElement("div"),e.id="walkthroughOverlay",e.className="walkthrough-overlay",document.body.appendChild(e));const i=`difficulty-${t.difficulty.toLowerCase()}`;e.innerHTML=`
      <div class="walkthrough-container">
        <!-- Header -->
        <div class="walkthrough-header">
          <button class="walkthrough-close-btn" onclick="ProblemWalkthrough.close()">Ã—</button>
          <button class="walkthrough-narrator-btn" onclick="event.stopPropagation(); ProblemWalkthrough.startNarratorMode();" title="ðŸŽ™ï¸ Narrator Walkthrough - Step-by-step visualization with voice narration">
            ðŸŽ™ï¸ Narrator
          </button>
          <h1 class="walkthrough-title">${t.title}</h1>
          <div class="walkthrough-meta">
            <span class="walkthrough-meta-item"><span class="difficulty-badge ${i}">${t.difficulty}</span></span>
            <span class="walkthrough-meta-item">âš¡ ${t.xpReward} XP</span>
            <span class="walkthrough-meta-item">â±ï¸ ~${t.estimatedTime} min</span>
            <span class="walkthrough-meta-item">ðŸ“ ${t.category}</span>
          </div>
        </div>
        
        <!-- Problem Statement -->
        <div class="walkthrough-problem">
          <div class="problem-statement">${t.problem.description}</div>
        </div>
        
        <!-- Step Tabs -->
        <div class="walkthrough-steps-nav">
          ${t.walkthrough.steps.map((s,r)=>`
            <button class="walkthrough-step-tab ${r===0?"active":""}" onclick="ProblemWalkthrough.goToStep(${r})">
              ${s.title}
            </button>
          `).join("")}
        </div>
        
        <!-- Content -->
        <div class="walkthrough-content">
          ${t.walkthrough.steps.map((s,r)=>`
            <div class="walkthrough-step-section ${r===0?"active":""}">
              <h2 class="step-title">
                <span class="step-number">${r+1}</span>
                ${s.title}
              </h2>
              <p class="step-description">${s.content}</p>
              ${s.code?this.renderCodeBlock(s.code,s.lang||"javascript"):""}
            </div>
          `).join("")}
          
          <!-- Edge Cases -->
          ${t.edgeCases&&t.edgeCases.length>0?`
            <div class="edge-cases-section">
              <h3 class="section-subtitle">âš ï¸ Edge Cases to Test</h3>
              <table class="edge-cases-table">
                <thead>
                  <tr>
                    <th>Case</th>
                    <th>Input</th>
                    <th>Expected</th>
                    <th>Why It Matters</th>
                  </tr>
                </thead>
                <tbody>
                  ${t.edgeCases.map(s=>`
                    <tr>
                      <td>${s.case}</td>
                      <td><code>${s.input}</code></td>
                      <td><code>${s.expected}</code></td>
                      <td>${s.why}</td>
                    </tr>
                  `).join("")}
                </tbody>
              </table>
            </div>
          `:""}
          
          <!-- Common Mistakes -->
          ${t.commonMistakes&&t.commonMistakes.length>0?`
            <div class="mistakes-section">
              <h3 class="section-subtitle">âŒ Common Mistakes</h3>
              ${t.commonMistakes.map(s=>`
                <div class="mistake-card">
                  <div class="mistake-header">
                    <span class="mistake-icon">âš ï¸</span>
                    <h4 class="mistake-title">${s.title}</h4>
                  </div>
                  <div class="mistake-comparison">
                    <div class="mistake-wrong">
                      <div class="mistake-label">âŒ Wrong</div>
                      <div class="mistake-code">${s.wrong}</div>
                    </div>
                    <div class="mistake-correct">
                      <div class="mistake-label">âœ“ Correct</div>
                      <div class="mistake-code">${s.correct}</div>
                    </div>
                  </div>
                  ${s.explanation?`<div class="mistake-explanation">${s.explanation}</div>`:""}
                </div>
              `).join("")}
            </div>
          `:""}
          
          <!-- Complexity Analysis -->
          ${t.complexity&&t.complexity.approaches?`
            <div class="complexity-section">
              <h3 class="section-subtitle">ðŸ“Š Complexity Analysis</h3>
              <table class="complexity-table">
                <thead>
                  <tr>
                    <th>Approach</th>
                    <th>Time</th>
                    <th>Space</th>
                    <th>When to Use</th>
                  </tr>
                </thead>
                <tbody>
                  ${t.complexity.approaches.map((s,r)=>`
                    <tr class="${r===0?"complexity-recommended":""}">
                      <td>${s.name}</td>
                      <td><code>${s.time}</code></td>
                      <td><code>${s.space}</code></td>
                      <td>${s.when}</td>
                    </tr>
                  `).join("")}
                </tbody>
              </table>
            </div>
          `:""}
        </div>
        
        <!-- Footer Navigation -->
        <div class="walkthrough-footer">
          <button class="walkthrough-nav-btn" id="walkthroughPrevBtn" onclick="ProblemWalkthrough.prevStep()" disabled>
            â† Previous
          </button>
          <button class="walkthrough-nav-btn" id="walkthroughNextBtn" onclick="ProblemWalkthrough.nextStep()">
            Next â†’
          </button>
        </div>
      </div>
    `,e.classList.add("active")},renderCodeBlock(t,e="javascript"){if(typeof t=="string")return`
        <div class="code-block-wrapper">
          <div class="code-block-header">
            <span class="code-block-lang">${e}</span>
            <button class="code-copy-btn" onclick="ProblemWalkthrough.copyCode(this)">Copy</button>
          </div>
          <pre class="code-block">${this.escapeHtml(t)}</pre>
        </div>
      `;const i=Object.keys(t),s="code-"+Math.random().toString(36).substr(2,9);return`
      <div class="code-block-wrapper multi-lang" data-block-id="${s}">
        <div class="code-block-header">
          <div class="code-lang-tabs">
            ${i.map((r,n)=>`
              <button class="code-lang-tab ${n===0?"active":""}" 
                      onclick="ProblemWalkthrough.switchLang('${s}', '${r}')">
                ${r==="javascript"?"JavaScript":r==="python"?"Python":"Java"}
              </button>
            `).join("")}
          </div>
          <button class="code-copy-btn" onclick="ProblemWalkthrough.copyCode(this)">Copy</button>
        </div>
        ${i.map((r,n)=>`
          <pre class="code-block" data-lang="${r}" style="${n===0?"":"display:none"}">${this.escapeHtml(t[r])}</pre>
        `).join("")}
      </div>
    `},switchLang(t,e){const i=document.querySelector(`[data-block-id="${t}"]`);i&&(i.querySelectorAll(".code-lang-tab").forEach(s=>{s.classList.remove("active"),s.textContent.toLowerCase().includes(e.slice(0,4))&&s.classList.add("active")}),i.querySelectorAll(".code-block").forEach(s=>{s.style.display=s.dataset.lang===e?"":"none"}))},escapeHtml(t){const e=document.createElement("div");return e.textContent=t,e.innerHTML}},D0={currentFilter:"all",render(t){const e=document.getElementById(t);if(!e)return;const i=nt.getAll();e.innerHTML=`
      <div class="problem-browser">
        <div class="problem-browser-header">
          <h2 style="margin: 0; font-size: 1.5rem; color: var(--text-heading);">
            ðŸ§  Practice Problems
          </h2>
          <div class="problem-filter-tabs">
            <button class="problem-filter-btn ${this.currentFilter==="all"?"active":""}" 
                    onclick="ProblemBrowser.filter('all')">All</button>
            <button class="problem-filter-btn ${this.currentFilter==="sorting"?"active":""}" 
                    onclick="ProblemBrowser.filter('sorting')">Sorting</button>
            <button class="problem-filter-btn ${this.currentFilter==="searching"?"active":""}" 
                    onclick="ProblemBrowser.filter('searching')">Searching</button>
            <button class="problem-filter-btn ${this.currentFilter==="graph"?"active":""}" 
                    onclick="ProblemBrowser.filter('graph')">Graphs</button>
            <button class="problem-filter-btn ${this.currentFilter==="dp"?"active":""}" 
                    onclick="ProblemBrowser.filter('dp')">DP</button>
          </div>
        </div>
        <div class="problem-cards-grid" id="problemCardsGrid">
          ${this.renderCards(i)}
        </div>
      </div>
    `},renderCards(t){const e=this.currentFilter==="all"?t:t.filter(i=>i.category===this.currentFilter);return e.length===0?`<div style="grid-column: 1/-1; text-align: center; padding: 3rem; color: var(--text-muted);">
        No problems in this category yet.
      </div>`:e.map(i=>{const s=nt.isCompleted(i.id),r=`difficulty-${i.difficulty.toLowerCase()}`;return`
        <div class="problem-card" onclick="ProblemWalkthrough.open('${i.id}')">
          <div class="problem-card-header">
            <h3 class="problem-card-title">${i.title}</h3>
            <span class="difficulty-badge ${r}">${i.difficulty}</span>
          </div>
          <div class="problem-card-meta">
            <span>âš¡ ${i.xpReward} XP</span>
            <span>â±ï¸ ~${i.estimatedTime} min</span>
          </div>
          <p class="problem-card-desc">${i.problem.description.slice(0,100)}...</p>
          <div class="problem-card-footer">
            <div class="problem-tags">
              <span class="problem-tag">${i.category}</span>
              ${i.tags?i.tags.map(n=>`<span class="problem-tag">${n}</span>`).join(""):""}
            </div>
            ${s?'<span class="problem-completed-badge">âœ“</span>':""}
          </div>
        </div>
      `}).join("")},filter(t){this.currentFilter=t;const e=document.getElementById("problemCardsGrid");e&&(e.innerHTML=this.renderCards(nt.getAll())),document.querySelectorAll(".problem-filter-btn").forEach(i=>{i.classList.remove("active"),(i.textContent.toLowerCase().includes(t)||t==="all"&&i.textContent==="All")&&i.classList.add("active")})}};nt.register({id:"two-sum-sorted",title:"Two Sum in Sorted Array",difficulty:"Beginner",xpReward:100,estimatedTime:15,category:"sorting",tags:["two-pointers","arrays"],problem:{description:`Given a sorted array of integers and a target sum, find two numbers that add up to the target. Return their indices.

Example:
  Input: arr = [1, 3, 5, 7, 9, 11], target = 12
  Output: [1, 4] (arr[1] + arr[4] = 3 + 9 = 12)`},walkthrough:{steps:[{title:"Understand the Problem",content:"The key insight is that the array is SORTED. This is a major hint to use two pointers! If the sum is too small, we move the left pointer right. If the sum is too big, we move the right pointer left.",code:`// What we know:
// - Array is SORTED (this is a hint to use two pointers!)
// - We need TWO numbers that sum to target
// - Return indices, not values

// Key insight: If sum is too small, move left pointer right
//              If sum is too big, move right pointer left`},{title:"Visualize the Approach",content:"Let's walk through an example with arr = [1, 3, 5, 7, 9, 11] and target = 12:",code:`Array: [1, 3, 5, 7, 9, 11]  Target: 12
L              R     L + R = 1 + 11 = 12 âœ“ Found!

// But what if target was 10?
Array: [1, 3, 5, 7, 9, 11]  Target: 10
L              R     1 + 11 = 12 > 10, move R left
L           R        1 + 9 = 10 âœ“ Found!`},{title:"The Solution",content:"Here's the optimal O(n) solution using two pointers:",code:{javascript:`function twoSumSorted(arr, target) {
  let left = 0;
  let right = arr.length - 1;

  while (left < right) {
    const sum = arr[left] + arr[right];

    if (sum === target) {
      return [left, right];
    } else if (sum < target) {
      left++; // Need bigger sum
    } else {
      right--; // Need smaller sum
    }
  }

  return [-1, -1]; // No solution found
}`,python:`def two_sum_sorted(arr, target):
    left = 0
    right = len(arr) - 1

    while left < right:
current_sum = arr[left] + arr[right]

if current_sum == target:
    return [left, right]
elif current_sum < target:
    left += 1  # Need bigger sum
else:
    right -= 1  # Need smaller sum

    return [-1, -1]  # No solution found`,java:`public int[] twoSumSorted(int[] arr, int target) {
    int left = 0;
    int right = arr.length - 1;

    while (left < right) {
int sum = arr[left] + arr[right];

if (sum == target) {
    return new int[]{left, right};
} else if (sum < target) {
    left++; // Need bigger sum
} else {
    right--; // Need smaller sum
}
    }

    return new int[]{-1, -1}; // No solution found
}`}}]},edgeCases:[{case:"Empty array",input:"[], 5",expected:"[-1, -1]",why:"Must handle empty input"},{case:"Single element",input:"[5], 5",expected:"[-1, -1]",why:"Need TWO numbers"},{case:"Target at ends",input:"[1, 11], 12",expected:"[0, 1]",why:"Boundary case"},{case:"No solution",input:"[1, 2, 3], 10",expected:"[-1, -1]",why:"Handle impossible case"},{case:"Negative numbers",input:"[-5, 0, 5], 0",expected:"[0, 2]",why:"Negatives are valid"}],commonMistakes:[{title:"Using nested loops (O(nÂ²) instead of O(n))",wrong:`for (let i = 0; i < arr.length; i++) {
  for (let j = i + 1; j < arr.length; j++) {
    if (arr[i] + arr[j] === target) return [i, j];
  }
}
// This is O(nÂ²) when O(n) is possible!`,correct:`let left = 0, right = arr.length - 1;
while (left < right) {
  // Use two pointers for O(n)
}`,explanation:"The nested loop approach wastes the sorted property. Two pointers gives us O(n) time."},{title:"Using left <= right condition",wrong:`while (left <= right) {
  // Bug! If left === right, we're using same element twice
}`,correct:`while (left < right) {
  // Ensures we use two different elements
}`,explanation:"We need two DIFFERENT numbers, so left must always be less than right."}],complexity:{approaches:[{name:"Two Pointers",time:"O(n)",space:"O(1)",when:"Array is sorted âœ“"},{name:"Hash Map",time:"O(n)",space:"O(n)",when:"Array is unsorted"},{name:"Brute Force",time:"O(nÂ²)",space:"O(1)",when:"Never (unless required)"}]}});nt.register({id:"kth-largest",title:"Find the Kth Largest Element",difficulty:"Intermediate",xpReward:150,estimatedTime:20,category:"sorting",tags:["quickselect","heap"],problem:{description:`Given an unsorted array, find the Kth largest element.
Note: Not the Kth distinct element.

Example:
  Input: arr = [3, 2, 1, 5, 6, 4], k = 2
  Output: 5 (sorted: [1,2,3,4,5,6], 2nd largest is 5)`},walkthrough:{steps:[{title:"Clarify Requirements",content:"Questions to ask: Is K always valid? What if array has duplicates? Can we modify the input? Key insight: Kth largest = (n-k+1)th smallest.",code:`// Questions to ask:
// - Is K always valid? (1 <= k <= arr.length)
// - What if array has duplicates? (count them separately)
// - Can we modify the input array?

// Key insight: Kth largest = (n-k+1)th smallest
// For k=2 in array of 6: we want position 5 (6-2+1=5)`},{title:"Simple Solution (Sort)",content:"The easiest approach is to sort and pick the kth element. This is O(n log n) time.",code:{javascript:`function findKthLargest(arr, k) {
  // Sort in descending order
  arr.sort((a, b) => b - a);
  return arr[k - 1]; // k-1 because 0-indexed
}`,python:`def find_kth_largest(arr, k):
    # Sort in descending order
    arr.sort(reverse=True)
    return arr[k - 1]  # k-1 because 0-indexed`,java:`public int findKthLargest(int[] arr, int k) {
    // Sort in ascending order then pick from end
    Arrays.sort(arr);
    return arr[arr.length - k];
}`}},{title:"Optimal Solution (QuickSelect)",content:"QuickSelect achieves O(n) average time by only partially sorting. We partition around a pivot and recurse into the relevant half.",code:`function findKthLargestOptimal(arr, k) {
  const targetIndex = arr.length - k;

  function quickSelect(left, right) {
    const pivotIndex = partition(left, right);
    if (pivotIndex === targetIndex) {
      return arr[pivotIndex];
    } else if (pivotIndex < targetIndex) {
      return quickSelect(pivotIndex + 1, right);
    } else {
      return quickSelect(left, pivotIndex - 1);
    }
  }

  function partition(left, right) {
    const pivot = arr[right];
    let i = left;
    for (let j = left; j < right; j++) {
      if (arr[j] <= pivot) {
[arr[i], arr[j]] = [arr[j], arr[i]];
i++;
      }
    }
    [arr[i], arr[right]] = [arr[right], arr[i]];
    return i;
  }

  return quickSelect(0, arr.length - 1);
}`}]},edgeCases:[{case:"K = 1 (largest)",input:"[3,1,2], 1",expected:"3",why:"Boundary"},{case:"K = length (smallest)",input:"[3,1,2], 3",expected:"1",why:"Other boundary"},{case:"All same elements",input:"[5,5,5], 2",expected:"5",why:"Duplicates"},{case:"Negative numbers",input:"[-1,-2], 1",expected:"-1",why:"Negatives work"}],commonMistakes:[{title:"Off-by-one error with K",wrong:`arr.sort((a, b) => b - a);
return arr[k]; // Bug! Returns (k+1)th largest`,correct:`arr.sort((a, b) => b - a);
return arr[k - 1]; // Correct: arrays are 0-indexed`,explanation:"Remember that arrays are 0-indexed, so kth largest is at index k-1."}],complexity:{approaches:[{name:"QuickSelect",time:"O(n) avg",space:"O(1)",when:"General case"},{name:"Sorting",time:"O(n log n)",space:"O(1)",when:"Simple implementation"},{name:"Min-Heap",time:"O(n log k)",space:"O(k)",when:"When k is small"}]}});nt.register({id:"rotated-search",title:"Search in Rotated Sorted Array",difficulty:"Advanced",xpReward:200,estimatedTime:25,category:"searching",tags:["binary-search","arrays"],problem:{description:`A sorted array has been rotated at some pivot unknown to you.
Find the target value. Return -1 if not found.

Example:
  Input: arr = [4, 5, 6, 7, 0, 1, 2], target = 0
  Output: 4 (index of 0)

Note: Original sorted array [0,1,2,4,5,6,7] was rotated at pivot 4`},walkthrough:{steps:[{title:"Understand Rotation",content:"When a sorted array is rotated, it creates two sorted portions. The key insight is that at least ONE half is always sorted!",code:`Original:  [0, 1, 2, 4, 5, 6, 7]

Rotated 4 positions:
   [4, 5, 6, 7, 0, 1, 2]
    ^^^^^^^^^  ^^^^^^^
    Part 2     Part 1

Key insight: At least ONE half is always sorted!`},{title:"Modified Binary Search",content:"We use binary search but must determine which half is sorted, then check if target is in that half.",code:`arr = [4, 5, 6, 7, 0, 1, 2], target = 0
       L        M        R

mid = 3, arr[mid] = 7, target = 0

Is left half [4,5,6,7] sorted?
  arr[L] <= arr[M] â†’ 4 <= 7 â†’ YES!

Is target (0) in sorted left half [4,5,6,7]?
  arr[L] <= 0 < arr[M] â†’ 4 <= 0 < 7 â†’ NO!

So search the right half â†’ L = mid + 1`},{title:"The Solution",content:"Here's the complete O(log n) solution:",code:`function searchRotated(arr, target) {
  let left = 0;
  let right = arr.length - 1;

  while (left <= right) {
    const mid = Math.floor((left + right) / 2);

    if (arr[mid] === target) {
      return mid;
    }

    // Check if LEFT half is sorted
    if (arr[left] <= arr[mid]) {
      // Target in left half?
      if (arr[left] <= target && target < arr[mid]) {
right = mid - 1;
      } else {
left = mid + 1;
      }
    }
    // RIGHT half must be sorted
    else {
      // Target in right half?
      if (arr[mid] < target && target <= arr[right]) {
left = mid + 1;
      } else {
right = mid - 1;
      }
    }
  }

  return -1;
}`}]},edgeCases:[{case:"Not rotated",input:"[1,2,3,4,5], 3",expected:"2",why:"Works like normal binary search"},{case:"Target at pivot",input:"[4,5,1,2,3], 1",expected:"2",why:"Edge of rotation"},{case:"Single element",input:"[1], 1",expected:"0",why:"Minimal case"},{case:"Target not found",input:"[4,5,1,2,3], 6",expected:"-1",why:"Handle missing"}],commonMistakes:[{title:"Wrong comparison for sorted half",wrong:"if (arr[left] < arr[mid]) // Fails when left === mid",correct:"if (arr[left] <= arr[mid]) // Must use <=",explanation:"When left equals mid (small subarrays), we need <= to correctly identify the sorted half."}],complexity:{approaches:[{name:"Modified Binary Search",time:"O(log n)",space:"O(1)",when:"Optimal solution"},{name:"Linear Search",time:"O(n)",space:"O(1)",when:"Never use for this"}]}});nt.register({id:"number-of-islands",title:"Number of Islands",difficulty:"Intermediate",xpReward:175,estimatedTime:20,category:"graph",tags:["dfs","bfs","matrix"],problem:{description:`Given a 2D grid of '1's (land) and '0's (water), count the number of islands.
An island is surrounded by water and formed by connecting adjacent lands horizontally or vertically.

Example:
  Input:
    [['1','1','0','0','0'],
     ['1','1','0','0','0'],
     ['0','0','1','0','0'],
     ['0','0','0','1','1']]
  Output: 3`},walkthrough:{steps:[{title:"Visualize the Problem",content:"Think of each '1' as land and '0' as water. Connected land cells (up/down/left/right) form one island.",code:`Grid visualization:
  1 1 0 0 0    â–ˆâ–ˆ â–ˆâ–ˆ Â·  Â·  Â·
  1 1 0 0 0    â–ˆâ–ˆ â–ˆâ–ˆ Â·  Â·  Â·    Island 1 (top-left)
  0 0 1 0 0    Â·  Â·  â–ˆâ–ˆ Â·  Â·    Island 2 (center)
  0 0 0 1 1    Â·  Â·  Â·  â–ˆâ–ˆ â–ˆâ–ˆ   Island 3 (bottom-right)

Strategy: For each unvisited '1', do DFS/BFS to mark all
connected '1's, then increment count.`},{title:"DFS Solution",content:`We scan the grid. When we find a '1', we increment count and "sink" the entire island by marking all connected '1's as '0'.`,code:`function numIslands(grid) {
  if (!grid || !grid.length) return 0;

  let count = 0;
  const rows = grid.length;
  const cols = grid[0].length;

  function dfs(r, c) {
    // Boundary check & water check
    if (r < 0 || r >= rows || c < 0 || c >= cols || grid[r][c] === '0') {
      return;
    }

    // Mark as visited (sink the island)
    grid[r][c] = '0';

    // Explore all 4 directions
    dfs(r - 1, c); // Up
    dfs(r + 1, c); // Down
    dfs(r, c - 1); // Left
    dfs(r, c + 1); // Right
  }

  for (let r = 0; r < rows; r++) {
    for (let c = 0; c < cols; c++) {
      if (grid[r][c] === '1') {
count++;
dfs(r, c); // Sink the entire island
      }
    }
  }

  return count;
}`}]},edgeCases:[{case:"Empty grid",input:"[]",expected:"0",why:"Handle empty"},{case:"All water",input:"[[0,0],[0,0]]",expected:"0",why:"No islands"},{case:"All land",input:"[[1,1],[1,1]]",expected:"1",why:"One big island"},{case:"Diagonal islands",input:"[[1,0],[0,1]]",expected:"2",why:"Diagonal â‰  connected"}],commonMistakes:[{title:"Counting diagonals as connected",wrong:`// Including diagonal directions
const directions = [[-1,-1],[-1,0],[-1,1],
            [0,-1],       [0,1],
            [1,-1], [1,0], [1,1]];`,correct:`// Only 4 directions (up, down, left, right)
const directions = [[-1,0], [1,0], [0,-1], [0,1]];`,explanation:"The problem specifies horizontal and vertical connections only, not diagonal."},{title:"String vs number comparison",wrong:"if (grid[r][c] === 1) // Never matches!",correct:"if (grid[r][c] === '1') // Grid uses strings",explanation:"The grid uses string characters '1' and '0', not numbers."}],complexity:{approaches:[{name:"DFS",time:"O(mÃ—n)",space:"O(mÃ—n)",when:"Simple recursion"},{name:"BFS",time:"O(mÃ—n)",space:"O(min(m,n))",when:"Iterative preference"},{name:"Union-Find",time:"O(mÃ—n)",space:"O(mÃ—n)",when:"Multiple queries"}]}});nt.register({id:"coin-change",title:"Coin Change",difficulty:"Intermediate",xpReward:175,estimatedTime:20,category:"dp",tags:["dynamic-programming","unbounded-knapsack"],problem:{description:`Given coins of different denominations and a total amount, find the minimum number of coins needed to make up that amount.
Return -1 if not possible.

Example:
  Input: coins = [1, 2, 5], amount = 11
  Output: 3 (5 + 5 + 1 = 11)`},walkthrough:{steps:[{title:"Identify DP Pattern",content:'This is an "Unbounded Knapsack" variant. We can use each coin unlimited times and want to minimize the count.',code:`This is an "Unbounded Knapsack" variant.
- We can use each coin unlimited times
- We want to minimize count
- Build solution from small amounts up

dp[i] = minimum coins needed to make amount i`},{title:"Build the DP Table",content:"Let's trace through coins = [1, 2, 5], amount = 11:",code:`coins = [1, 2, 5], amount = 11

dp[0] = 0  (0 coins for amount 0)
dp[1] = 1  (use coin 1)
dp[2] = 1  (use coin 2)
dp[3] = 2  (use coins 1+2)
dp[4] = 2  (use coins 2+2)
dp[5] = 1  (use coin 5)
dp[6] = 2  (use coins 5+1)
dp[7] = 2  (use coins 5+2)
dp[8] = 3  (use coins 5+2+1)
dp[9] = 3  (use coins 5+2+2)
dp[10] = 2 (use coins 5+5)
dp[11] = 3 (use coins 5+5+1) â† Answer!`},{title:"The Solution",content:"Here's the complete O(amount Ã— coins) solution:",code:{javascript:`function coinChange(coins, amount) {
  const dp = new Array(amount + 1).fill(Infinity);
  dp[0] = 0;

  for (let i = 1; i <= amount; i++) {
    for (const coin of coins) {
      if (coin <= i) {
dp[i] = Math.min(dp[i], 1 + dp[i - coin]);
      }
    }
  }
  return dp[amount] === Infinity ? -1 : dp[amount];
}`,python:`def coin_change(coins, amount):
    dp = [float('inf')] * (amount + 1)
    dp[0] = 0

    for i in range(1, amount + 1):
for coin in coins:
    if coin <= i:
        dp[i] = min(dp[i], 1 + dp[i - coin])

    return dp[amount] if dp[amount] != float('inf') else -1`,java:`public int coinChange(int[] coins, int amount) {
    int[] dp = new int[amount + 1];
    Arrays.fill(dp, amount + 1);
    dp[0] = 0;

    for (int i = 1; i <= amount; i++) {
for (int coin : coins) {
    if (coin <= i) {
        dp[i] = Math.min(dp[i], 1 + dp[i - coin]);
    }
}
    }
    return dp[amount] > amount ? -1 : dp[amount];
}`}}]},edgeCases:[{case:"Amount is 0",input:"[1,2], 0",expected:"0",why:"No coins needed"},{case:"Impossible",input:"[2], 3",expected:"-1",why:"Can't make odd with only 2s"},{case:"Single coin exact",input:"[5], 5",expected:"1",why:"One coin fits"},{case:"All coins too big",input:"[5,10], 3",expected:"-1",why:"No solution"}],commonMistakes:[{title:"Wrong initialization",wrong:`const dp = new Array(amount + 1).fill(0);
// Then Math.min(0, 1 + dp[i-coin]) = 0 always!`,correct:`const dp = new Array(amount + 1).fill(Infinity);
dp[0] = 0; // Base case`,explanation:"We need Infinity to correctly find minimum. Zero would make min always return 0."},{title:"Using greedy approach",wrong:`// Greedy doesn't work for coin change!
// coins = [1, 3, 4], amount = 6
// Greedy: 4 + 1 + 1 = 3 coins
// Optimal: 3 + 3 = 2 coins`,correct:"// Must use DP to find optimal solution",explanation:"Greedy picks largest coin first but misses optimal combinations."}],complexity:{approaches:[{name:"DP Bottom-Up",time:"O(amount Ã— n)",space:"O(amount)",when:"Optimal solution"},{name:"DP Top-Down",time:"O(amount Ã— n)",space:"O(amount)",when:"Memoization"},{name:"Greedy",time:"O(amount)",space:"O(1)",when:"WRONG - don't use!"}]}});nt.register({id:"valid-palindrome",title:"Valid Palindrome",difficulty:"Beginner",xpReward:100,estimatedTime:12,category:"strings",tags:["two-pointers","string"],problem:{description:`Given a string, determine if it is a palindrome, considering only alphanumeric characters and ignoring cases.

Example:
  Input: "A man, a plan, a canal: Panama"
  Output: true

  Input: "race a car"
  Output: false`},walkthrough:{steps:[{title:"Understand the Requirements",content:'We need to check if a string is a palindrome, but ONLY considering alphanumeric characters and ignoring case. This means "A man, a plan, a canal: Panama" becomes "amanaplanacanalpanama".',code:`// Key requirements:
// 1. Only alphanumeric (letters + digits)
// 2. Case insensitive
// 3. After filtering, check if palindrome`},{title:"Two-Pointer Solution",content:"Use two pointers from both ends, skipping non-alphanumeric characters. This achieves O(1) space instead of creating a new string.",code:{javascript:`function isPalindrome(s) {
  let left = 0;
  let right = s.length - 1;

  while (left < right) {
    while (left < right && !isAlphanumeric(s[left])) left++;
    while (left < right && !isAlphanumeric(s[right])) right--;

    if (s[left].toLowerCase() !== s[right].toLowerCase()) {
      return false;
    }
    left++;
    right--;
  }
  return true;
}

function isAlphanumeric(char) {
  const code = char.charCodeAt(0);
  return (code >= 48 && code <= 57) ||
 (code >= 65 && code <= 90) ||
 (code >= 97 && code <= 122);
}`,python:`def is_palindrome(s):
    left, right = 0, len(s) - 1

    while left < right:
while left < right and not s[left].isalnum():
    left += 1
while left < right and not s[right].isalnum():
    right -= 1

if s[left].lower() != s[right].lower():
    return False
left += 1
right -= 1

    return True`,java:`public boolean isPalindrome(String s) {
    int left = 0, right = s.length() - 1;

    while (left < right) {
while (left < right && !Character.isLetterOrDigit(s.charAt(left)))
    left++;
while (left < right && !Character.isLetterOrDigit(s.charAt(right)))
    right--;

if (Character.toLowerCase(s.charAt(left)) != 
    Character.toLowerCase(s.charAt(right))) {
    return false;
}
left++;
right--;
    }
    return true;
}`}}]},edgeCases:[{case:"Empty string",input:'""',expected:"true",why:"Empty is considered palindrome"},{case:"Only spaces",input:'"   "',expected:"true",why:"After filtering = empty = palindrome"},{case:"Single char",input:'"a"',expected:"true",why:"Single char = palindrome"},{case:"Numbers in string",input:'"0P"',expected:"false",why:"0 â‰  P, don't forget numbers"}],commonMistakes:[{title:"Returning false for empty strings",wrong:"if (cleaned.length === 0) return false;",correct:"if (cleaned.length === 0) return true; // Empty IS a palindrome",explanation:"By definition, an empty string reads the same forwards and backwards."}],complexity:{approaches:[{name:"Two Pointers",time:"O(n)",space:"O(1)",when:"Optimal solution"},{name:"Filter + Reverse",time:"O(n)",space:"O(n)",when:"Simpler but uses extra space"}]}});nt.register({id:"longest-substring",title:"Longest Substring Without Repeating Characters",difficulty:"Intermediate",xpReward:175,estimatedTime:18,category:"strings",tags:["sliding-window","hash-map"],problem:{description:`Given a string, find the length of the longest substring without repeating characters.

Example:
  Input: "abcabcbb"
  Output: 3 ("abc")

  Input: "bbbbb"
  Output: 1 ("b")

  Input: "pwwkew"
  Output: 3 ("wke")`},walkthrough:{steps:[{title:"Sliding Window Pattern",content:"Use a sliding window with a hash map to track character positions. When we see a repeat, shrink the window from the left.",code:`// Window: [left, right]
// Map: char -> last seen index

"abcabcbb"
 L
 R       -> map: {a:0}, len=1

"abcabcbb"
 L
  R      -> map: {a:0,b:1}, len=2

"abcabcbb"
 L
   R     -> map: {a:0,b:1,c:2}, len=3

"abcabcbb"
 L
    R    -> 'a' at 0, move L to 1
    L
    R    -> map: {a:3,b:1,c:2}, len=3`},{title:"The Solution",content:"Key insight: when we see a repeat, we move left pointer to max(left, lastSeenIndex + 1) to handle edge cases.",code:{javascript:`function lengthOfLongestSubstring(s) {
  const map = new Map();
  let left = 0, maxLen = 0;

  for (let right = 0; right < s.length; right++) {
    const char = s[right];
    if (map.has(char) && map.get(char) >= left) {
      left = map.get(char) + 1;
    }
    map.set(char, right);
    maxLen = Math.max(maxLen, right - left + 1);
  }
  return maxLen;
}`,python:`def length_of_longest_substring(s):
    char_map = {}
    left = max_len = 0

    for right, char in enumerate(s):
if char in char_map and char_map[char] >= left:
    left = char_map[char] + 1
char_map[char] = right
max_len = max(max_len, right - left + 1)

    return max_len`,java:`public int lengthOfLongestSubstring(String s) {
    Map<Character, Integer> map = new HashMap<>();
    int left = 0, maxLen = 0;

    for (int right = 0; right < s.length(); right++) {
char c = s.charAt(right);
if (map.containsKey(c) && map.get(c) >= left) {
    left = map.get(c) + 1;
}
map.put(c, right);
maxLen = Math.max(maxLen, right - left + 1);
    }
    return maxLen;
}`}}]},edgeCases:[{case:"Empty string",input:'""',expected:"0",why:"No characters"},{case:"All same",input:'"aaaa"',expected:"1",why:"Only one unique char possible"},{case:"All unique",input:'"abcd"',expected:"4",why:"Entire string is valid"},{case:"Repeat at end",input:'"abba"',expected:"2",why:"Tricky: must check if in window"}],commonMistakes:[{title:"Not checking if char is within window",wrong:`if (map.has(char)) {
  left = map.get(char) + 1; // Bug with "abba"!
}`,correct:`if (map.has(char) && map.get(char) >= left) {
  left = map.get(char) + 1;
}`,explanation:'In "abba", when we see second "a", the first "a" is no longer in our window.'}],complexity:{approaches:[{name:"Sliding Window",time:"O(n)",space:"O(min(n,m))",when:"Optimal (m = charset size)"},{name:"Brute Force",time:"O(nÂ³)",space:"O(n)",when:"Never use"}]}});nt.register({id:"validate-bst",title:"Validate Binary Search Tree",difficulty:"Intermediate",xpReward:175,estimatedTime:18,category:"trees",tags:["binary-tree","recursion"],problem:{description:`Given the root of a binary tree, determine if it is a valid BST.

A valid BST is defined as:
- Left subtree only contains nodes less than current
- Right subtree only contains nodes greater than current
- Both subtrees must also be valid BSTs

Example:
    2
   / \\
  1   3   -> true

    5
   / \\
  1   4
     / \\
    3   6   -> false (4 < 5 but 3 < 5 too)`},walkthrough:{steps:[{title:"The Common Mistake",content:"Most people only check immediate children, but BST property must hold for ALL descendants.",code:`// WRONG approach:
function isValidBST(node) {
  if (!node) return true;
  if (node.left && node.left.val >= node.val) return false;
  if (node.right && node.right.val <= node.val) return false;
  return isValidBST(node.left) && isValidBST(node.right);
}

// This passes:    5
//                / \\
//               1   6
//                  / \\
//                 3   7
// But 3 < 5, so it's INVALID!`},{title:"Range-Based Solution",content:"Pass valid ranges down the tree. Left children must be less than parent, right must be greater.",code:`function isValidBST(root) {
  return validate(root, -Infinity, Infinity);
}

function validate(node, min, max) {
  if (!node) return true;

  // Current node must be within range
  if (node.val <= min || node.val >= max) {
    return false;
  }

  // Left subtree: max becomes current node
  // Right subtree: min becomes current node
  return validate(node.left, min, node.val) &&
 validate(node.right, node.val, max);
}`}]},edgeCases:[{case:"Empty tree",input:"null",expected:"true",why:"Empty is valid BST"},{case:"Single node",input:"[5]",expected:"true",why:"Single node is valid"},{case:"Equal values",input:"[2,2,2]",expected:"false",why:"BST requires strictly less/greater"},{case:"INT_MIN/MAX",input:"[MIN,null,MAX]",expected:"true",why:"Edge values"}],commonMistakes:[{title:"Only checking immediate children",wrong:"if (node.left.val >= node.val) return false;",correct:"validate(node.left, min, node.val) // Pass range down",explanation:"A node deep in left subtree must be less than ALL ancestors above it."}],complexity:{approaches:[{name:"Range Validation",time:"O(n)",space:"O(h)",when:"Optimal (h = height)"},{name:"Inorder Traversal",time:"O(n)",space:"O(n)",when:"Alternative approach"}]}});nt.register({id:"detect-cycle",title:"Detect Cycle in Linked List",difficulty:"Intermediate",xpReward:150,estimatedTime:15,category:"linked-list",tags:["two-pointers","floyd"],problem:{description:`Given head of a linked list, determine if it has a cycle.

A cycle exists if some node can be reached again by following next pointers.

Example:
  3 -> 2 -> 0 -> -4
       ^         |
       |_________|   -> true (cycle at node 2)

  1 -> 2 -> null     -> false (no cycle)`},walkthrough:{steps:[{title:"Floyd's Cycle Detection",content:"Use two pointers: slow (1 step) and fast (2 steps). If there's a cycle, they will eventually meet.",code:`// Why does this work?
// If there's a cycle, fast will eventually "lap" slow
// Like two runners on a circular track

// No cycle: fast reaches null
// Has cycle: fast catches up to slow`},{title:"The Solution",content:"Simple O(1) space solution using Floyd's algorithm.",code:{javascript:`function hasCycle(head) {
  if (!head || !head.next) return false;
  let slow = head, fast = head;

  while (fast && fast.next) {
    slow = slow.next;
    fast = fast.next.next;
    if (slow === fast) return true;
  }
  return false;
}`,python:`def has_cycle(head):
    if not head or not head.next:
return False
    slow = fast = head

    while fast and fast.next:
slow = slow.next
fast = fast.next.next
if slow == fast:
    return True
    return False`,java:`public boolean hasCycle(ListNode head) {
    if (head == null || head.next == null) return false;
    ListNode slow = head, fast = head;

    while (fast != null && fast.next != null) {
slow = slow.next;
fast = fast.next.next;
if (slow == fast) return true;
    }
    return false;
}`}}]},edgeCases:[{case:"Empty list",input:"null",expected:"false",why:"No nodes = no cycle"},{case:"Single node no cycle",input:"1->null",expected:"false",why:"Single node pointing to null"},{case:"Single node self-loop",input:"1->1",expected:"true",why:"Node points to itself"},{case:"Cycle at tail",input:"1->2->3->2",expected:"true",why:"Tail points back"}],commonMistakes:[{title:"Using hash set (wastes space)",wrong:`const seen = new Set();
while (head) {
  if (seen.has(head)) return true;
  seen.add(head);
  head = head.next;
}`,correct:`// Use Floyd's algorithm for O(1) space
let slow = head, fast = head;
while (fast && fast.next) {...}`,explanation:"Hash set uses O(n) space. Floyd's tortoise and hare uses O(1)."}],complexity:{approaches:[{name:"Floyd's Algorithm",time:"O(n)",space:"O(1)",when:"Optimal"},{name:"Hash Set",time:"O(n)",space:"O(n)",when:"Simpler but wastes space"}]}});nt.register({id:"merge-intervals",title:"Merge Intervals",difficulty:"Intermediate",xpReward:175,estimatedTime:18,category:"arrays",tags:["sorting","intervals"],problem:{description:`Given an array of intervals, merge all overlapping intervals.

Example:
  Input: [[1,3], [2,6], [8,10], [15,18]]
  Output: [[1,6], [8,10], [15,18]]

  Explanation: [1,3] and [2,6] overlap, merge to [1,6]`},walkthrough:{steps:[{title:"Why Sorting First is Critical",content:"Without sorting, it's hard to know which intervals might overlap. Sorting by start time makes adjacent intervals candidates for merging.",code:`Unsorted: [[1,4], [0,2], [3,5]]

Without sort - confusing to process!

After sorting by start: [[0,2], [1,4], [3,5]]
- [0,2] and [1,4]: 1 <= 2 â†’ OVERLAP! Merge to [0,4]
- [0,4] and [3,5]: 3 <= 4 â†’ OVERLAP! Merge to [0,5]
- Result: [[0,5]]`},{title:"The Solution",content:"Sort by start, then iterate and merge overlapping intervals.",code:{javascript:`function merge(intervals) {
  if (intervals.length <= 1) return intervals;
  intervals.sort((a, b) => a[0] - b[0]);
  const result = [intervals[0]];

  for (let i = 1; i < intervals.length; i++) {
    const current = intervals[i];
    const last = result[result.length - 1];
    if (current[0] <= last[1]) {
      last[1] = Math.max(last[1], current[1]);
    } else {
      result.push(current);
    }
  }
  return result;
}`,python:`def merge(intervals):
    if len(intervals) <= 1:
return intervals
    intervals.sort(key=lambda x: x[0])
    result = [intervals[0]]

    for i in range(1, len(intervals)):
current = intervals[i]
last = result[-1]
if current[0] <= last[1]:
    last[1] = max(last[1], current[1])
else:
    result.append(current)
    return result`,java:`public int[][] merge(int[][] intervals) {
    if (intervals.length <= 1) return intervals;
    Arrays.sort(intervals, (a, b) -> a[0] - b[0]);
    List<int[]> result = new ArrayList<>();
    result.add(intervals[0]);

    for (int i = 1; i < intervals.length; i++) {
int[] current = intervals[i];
int[] last = result.get(result.size() - 1);
if (current[0] <= last[1]) {
    last[1] = Math.max(last[1], current[1]);
} else {
    result.add(current);
}
    }
    return result.toArray(new int[result.size()][]);
}`}}]},edgeCases:[{case:"Single interval",input:"[[1,3]]",expected:"[[1,3]]",why:"Nothing to merge"},{case:"Nested intervals",input:"[[1,10],[2,3]]",expected:"[[1,10]]",why:"[2,3] is fully inside"},{case:"Adjacent (touching)",input:"[[1,2],[2,3]]",expected:"[[1,3]]",why:"2 <= 2, they overlap!"},{case:"No overlap",input:"[[1,3],[5,7]]",expected:"[[1,3],[5,7]]",why:"Already separate"}],commonMistakes:[{title:"Using < instead of <=",wrong:"if (current[0] < lastMerged[1]) // Misses adjacent!",correct:"if (current[0] <= lastMerged[1]) // Adjacent should merge",explanation:"Adjacent intervals like [1,2] and [2,3] should merge to [1,3]."},{title:"Not taking max of ends",wrong:"lastMerged[1] = current[1]; // Wrong for nested!",correct:"lastMerged[1] = Math.max(lastMerged[1], current[1]);",explanation:"[1,10] and [2,3] should stay [1,10], not become [1,3]."}],complexity:{approaches:[{name:"Sort + Linear Scan",time:"O(n log n)",space:"O(n)",when:"Optimal"}]}});nt.register({id:"product-except-self",title:"Product of Array Except Self",difficulty:"Intermediate",xpReward:175,estimatedTime:18,category:"arrays",tags:["prefix-sum","math"],problem:{description:`Given an integer array, return an array where each element is the product of all elements except itself.

Constraint: Must be O(n) time WITHOUT using division!

Example:
  Input: [1, 2, 3, 4]
  Output: [24, 12, 8, 6]

  output[0] = 2*3*4 = 24
  output[1] = 1*3*4 = 12
  output[2] = 1*2*4 = 8
  output[3] = 1*2*3 = 6`},walkthrough:{steps:[{title:"Why Division Doesn't Work",content:"Even if division was allowed, it fails when there are zeros in the array!",code:`// Seems easy with division:
const total = nums.reduce((a, b) => a * b);
return nums.map(n => total / n);

// BUT: What if there's a ZERO?
// [1, 2, 0, 4] â†’ total = 0
// Dividing by 0 = Infinity
// Dividing 0 by anything = wrong result

// Also: The problem says NO DIVISION!`},{title:"The Prefix-Suffix Trick",content:"For each position, multiply all elements before it (prefix) with all elements after it (suffix).",code:`function productExceptSelf(nums) {
  const n = nums.length;
  const result = new Array(n);

  // First pass: Calculate prefix products
  result[0] = 1;
  for (let i = 1; i < n; i++) {
    result[i] = result[i - 1] * nums[i - 1];
  }

  // Second pass: Multiply by suffix products
  let suffix = 1;
  for (let i = n - 1; i >= 0; i--) {
    result[i] *= suffix;
    suffix *= nums[i];
  }

  return result;
}

// Example: [1, 2, 3, 4]
// prefix: [1, 1, 2, 6]
// suffix applied: [24, 12, 8, 6] âœ“`}]},edgeCases:[{case:"Contains zero",input:"[1,2,0,4]",expected:"[0,0,8,0]",why:"Only non-zero at position of zero"},{case:"Two zeros",input:"[1,0,0,4]",expected:"[0,0,0,0]",why:"All become zero"},{case:"Negative numbers",input:"[-1,2,-3]",expected:"[-6,3,-2]",why:"Handle signs correctly"},{case:"Two elements",input:"[3,4]",expected:"[4,3]",why:"Minimal case"}],commonMistakes:[{title:"Starting prefix at nums[0]",wrong:"result[0] = nums[0]; // This is the element itself!",correct:"result[0] = 1; // Empty product = 1",explanation:"prefix[0] should be 1 because there's nothing before it."}],complexity:{approaches:[{name:"Prefix-Suffix",time:"O(n)",space:"O(1)",when:"Optimal (excluding output array)"}]}});nt.register({id:"spiral-matrix",title:"Spiral Matrix",difficulty:"Intermediate",xpReward:175,estimatedTime:20,category:"matrix",tags:["matrix","simulation"],problem:{description:`Given an m x n matrix, return all elements in spiral order.

Example:
  Input: [[1, 2, 3],
  [4, 5, 6],
  [7, 8, 9]]

  Output: [1, 2, 3, 6, 9, 8, 7, 4, 5]

  Spiral path: â†’ â†’ â†’ â†“ â†“ â† â† â†‘ â†’`},walkthrough:{steps:[{title:"The Boundary Approach",content:"Keep 4 boundaries (top, bottom, left, right) and shrink them as you traverse.",code:`1. Go RIGHT along top row, then top++
2. Go DOWN along right column, then right--
3. Go LEFT along bottom row, then bottom--
4. Go UP along left column, then left++

Repeat while top <= bottom AND left <= right`},{title:"The Solution",content:"Carefully handle the boundaries to avoid duplicate elements.",code:`function spiralOrder(matrix) {
  if (!matrix.length || !matrix[0].length) return [];

  const result = [];
  let top = 0, bottom = matrix.length - 1;
  let left = 0, right = matrix[0].length - 1;

  while (top <= bottom && left <= right) {
    // Go RIGHT
    for (let col = left; col <= right; col++) {
      result.push(matrix[top][col]);
    }
    top++;

    // Go DOWN
    for (let row = top; row <= bottom; row++) {
      result.push(matrix[row][right]);
    }
    right--;

    // Go LEFT (check if row still exists)
    if (top <= bottom) {
      for (let col = right; col >= left; col--) {
result.push(matrix[bottom][col]);
      }
      bottom--;
    }

    // Go UP (check if column still exists)
    if (left <= right) {
      for (let row = bottom; row >= top; row--) {
result.push(matrix[row][left]);
      }
      left++;
    }
  }

  return result;
}`}]},edgeCases:[{case:"Single row",input:"[[1,2,3]]",expected:"[1,2,3]",why:"Only go right"},{case:"Single column",input:"[[1],[2],[3]]",expected:"[1,2,3]",why:"Only go down"},{case:"Single element",input:"[[5]]",expected:"[5]",why:"Just return it"},{case:"2x2",input:"[[1,2],[3,4]]",expected:"[1,2,4,3]",why:"Small complete spiral"}],commonMistakes:[{title:"Not checking boundaries before LEFT/UP",wrong:`// After going right and down, might have finished row
for (let col = right; col >= left; col--) {...}`,correct:`if (top <= bottom) { // Check if row still exists
  for (let col = right; col >= left; col--) {...}
}`,explanation:"For single-row matrices, going LEFT would duplicate elements."}],complexity:{approaches:[{name:"Boundary Shrinking",time:"O(mÃ—n)",space:"O(1)",when:"Optimal (excluding output)"}]}});nt.register({id:"single-number-triples",title:"Single Number II (Triples)",difficulty:"Intermediate",xpReward:175,estimatedTime:18,category:"bit-manipulation",tags:["bit-manipulation","math"],problem:{description:`Given an array where every element appears THREE times except one, find that single element.

Constraint: O(1) extra space, O(n) time

Example:
  Input: [2, 2, 3, 2]
  Output: 3

  Input: [0, 1, 0, 1, 0, 1, 99]
  Output: 99`},walkthrough:{steps:[{title:"Why XOR Doesn't Work Here",content:"XOR works for pairs (a^a=0), but for triples, a^a^a=a (not 0!)",code:`// XOR works for "appears twice except one":
// a ^ a = 0, so duplicates cancel out

// But for threes:
// a ^ a ^ a = a (not 0!)
// So XOR leaves extra copies`},{title:"Bit Counting Approach",content:"Count each bit position. If every number appeared 3 times, each bit count would be divisible by 3.",code:`function singleNumber(nums) {
  let result = 0;

  // Check each bit position (32 bits for integers)
  for (let bit = 0; bit < 32; bit++) {
    let sum = 0;

    // Count how many numbers have this bit set
    for (const num of nums) {
      if ((num >> bit) & 1) {
sum++;
      }
    }

    // If count % 3 !== 0, single number has this bit
    if (sum % 3 !== 0) {
      result |= (1 << bit);
    }
  }

  return result;
}

// Example: [2, 2, 3, 2]
// Binary: 10, 10, 11, 10
// Bit 0: 0+0+1+0 = 1 â†’ 1%3=1 â†’ set
// Bit 1: 1+1+1+1 = 4 â†’ 4%3=1 â†’ set
// Result: 11 = 3 âœ“`}]},edgeCases:[{case:"Single element",input:"[5]",expected:"5",why:"It appears once, rest appear thrice"},{case:"Contains zero",input:"[0,0,0,1]",expected:"1",why:"Zero handling"},{case:"Negative numbers",input:"[-2,-2,-2,99]",expected:"99",why:"Two's complement works"}],commonMistakes:[{title:"Using XOR like the pairs problem",wrong:"return nums.reduce((a, b) => a ^ b); // WRONG for triples",correct:"// Must use bit counting for triples",explanation:"XOR only cancels pairs. 3 copies of same number = that number."}],complexity:{approaches:[{name:"Bit Counting",time:"O(32n) = O(n)",space:"O(1)",when:"Optimal"},{name:"State Machine",time:"O(n)",space:"O(1)",when:"Advanced (using ones/twos)"}]}});window.QuestionBank=nt;window.ProblemWalkthrough=M2;window.ProblemBrowser=D0;setTimeout(()=>{D0.render("practiceProblemsContainer")},100);typeof window<"u"&&(window.ELectureEngineV5=De);const zt={lectures:{},register(t){this.lectures[t.id]=t},get(t){return this.lectures[t]||null},getAll(){return Object.values(this.lectures)},getByLevel(t){return this.getAll().filter(e=>e.level===t)}};zt.register({id:"sql-select-basics",title:"SELECT Basics: Querying Data",level:"Beginner",duration:"12 min",xp:100,icon:"ðŸ“Š",color:"#667eea",description:"Learn the fundamentals of retrieving data with SELECT statements.",steps:[{title:"Introduction to SELECT",narration:"The SELECT statement is the foundation of SQL. It's how we ask the database to show us specific information from our tables. Think of it as asking a question - you tell the database exactly what columns you want to see.",code:`-- Basic SELECT syntax
SELECT column1, column2, column3
FROM table_name;

-- Select all columns
SELECT * FROM employees;`,visual:`<div class="sql-result">
        <table class="result-table">
          <tr><th>id</th><th>name</th><th>department</th></tr>
          <tr><td>1</td><td>Alice</td><td>Engineering</td></tr>
          <tr><td>2</td><td>Bob</td><td>Marketing</td></tr>
          <tr><td>3</td><td>Carol</td><td>Engineering</td></tr>
        </table>
      </div>`},{title:"The WHERE Clause",narration:"WHERE is your filter. It lets you specify conditions to narrow down your results. Only rows that meet ALL your conditions will appear in the output. You can use comparison operators like =, <, >, <=, >=, and <> (not equal).",code:`-- Filter with WHERE
SELECT * FROM employees
WHERE department = 'Engineering';

-- Multiple conditions with AND
SELECT * FROM employees
WHERE department = 'Engineering'
  AND salary > 50000;

-- OR conditions
SELECT * FROM employees
WHERE department = 'Engineering'
   OR department = 'Marketing';`,visual:`<div class="sql-highlight">
        <div class="condition-box">WHERE filters rows BEFORE they appear in results</div>
        <div class="operators">= | < | > | <= | >= | <> | LIKE | IN | BETWEEN</div>
      </div>`},{title:"ORDER BY for Sorting",narration:"ORDER BY arranges your results in a specific order. By default, it sorts in ascending order (A to Z, smallest to largest). Add DESC for descending order. You can sort by multiple columns - the second column is used as a tiebreaker.",code:`-- Sort ascending (default)
SELECT * FROM employees
ORDER BY name;

-- Sort descending
SELECT * FROM employees
ORDER BY salary DESC;

-- Multiple sort columns
SELECT * FROM employees
ORDER BY department, salary DESC;`,visual:`<div class="sort-visual">
        <div class="asc">ASC: Aâ†’Z, 1â†’100</div>
        <div class="desc">DESC: Zâ†’A, 100â†’1</div>
      </div>`},{title:"DISTINCT and LIMIT",narration:"DISTINCT removes duplicate values from your results. LIMIT restricts how many rows are returned - perfect for previewing data or pagination. These are essential for working with large datasets.",code:`-- Get unique departments
SELECT DISTINCT department
FROM employees;

-- Limit results
SELECT * FROM employees
LIMIT 10;

-- Skip first 5, then get 10
SELECT * FROM employees
LIMIT 10 OFFSET 5;`,visual:`<div class="distinct-visual">
        <div>Before DISTINCT: [Eng, Mkt, Eng, Eng, Mkt]</div>
        <div>After DISTINCT: [Eng, Mkt]</div>
      </div>`},{title:"Aliases and Expressions",narration:"Aliases give columns or tables temporary names using AS. They make output more readable and are essential in complex queries. You can also use expressions to calculate values on the fly.",code:`-- Column alias
SELECT name AS employee_name,
       salary AS annual_salary
FROM employees;

-- Calculated columns
SELECT name,
       salary,
       salary * 0.1 AS bonus
FROM employees;

-- Table alias (useful for JOINs)
SELECT e.name, e.department
FROM employees AS e;`,visual:`<div class="alias-visual">
        <div class="before">salary_usd â†’ Readable Header</div>
        <div class="formula">Expression: salary * 0.1 = bonus</div>
      </div>`}],keyTakeaway:"SELECT is the heart of SQL querying. Master these basics: SELECT columns, FROM table, WHERE conditions, ORDER BY sorting, and LIMIT results.",practiceQuestions:[{q:"How do you select all columns?",a:"SELECT * FROM table_name"},{q:"How do you remove duplicates?",a:"Use SELECT DISTINCT"},{q:"Default ORDER BY direction?",a:"Ascending (ASC)"}]});zt.register({id:"sql-ddl",title:"DDL: Defining Database Structure",level:"Beginner",duration:"10 min",xp:100,icon:"ðŸ—ï¸",color:"#10b981",description:"Create, modify, and delete database objects with DDL commands.",steps:[{title:"What is DDL?",narration:"DDL stands for Data Definition Language. These commands define the structure of your database - the containers that hold your data. DDL commands are: CREATE, ALTER, DROP, and TRUNCATE. They change the schema, not the data itself.",code:`-- DDL Commands Overview
CREATE  -- Create new objects
ALTER   -- Modify existing objects
DROP    -- Delete objects permanently
TRUNCATE -- Empty a table quickly`,visual:'<div class="ddl-overview">DDL = Structure Commands (Schema)</div>'},{title:"CREATE TABLE",narration:"CREATE TABLE defines a new table with its columns and data types. Each column needs a name and a data type. Common types include INT, VARCHAR, DATE, DECIMAL, and BOOLEAN. You can also define constraints like NOT NULL and PRIMARY KEY.",code:`-- Create a table
CREATE TABLE employees (
  id INT PRIMARY KEY AUTO_INCREMENT,
  name VARCHAR(100) NOT NULL,
  email VARCHAR(255) UNIQUE,
  hire_date DATE,
  salary DECIMAL(10, 2),
  is_active BOOLEAN DEFAULT TRUE
);`,visual:`<div class="data-types">
        <span>INT</span><span>VARCHAR(n)</span><span>DATE</span>
        <span>DECIMAL(p,s)</span><span>BOOLEAN</span><span>TEXT</span>
      </div>`},{title:"ALTER TABLE",narration:"ALTER TABLE modifies an existing table's structure. You can add new columns, remove columns, change data types, add constraints, or rename columns. This is how you evolve your schema over time.",code:`-- Add a column
ALTER TABLE employees
ADD COLUMN phone VARCHAR(20);

-- Remove a column
ALTER TABLE employees
DROP COLUMN phone;

-- Modify column type
ALTER TABLE employees
MODIFY COLUMN name VARCHAR(150);

-- Add constraint
ALTER TABLE employees
ADD CONSTRAINT fk_dept
FOREIGN KEY (dept_id) REFERENCES departments(id);`,visual:'<div class="alter-visual">ALTER = Schema Evolution</div>'},{title:"DROP and TRUNCATE",narration:"DROP permanently deletes objects - tables, databases, indexes. Use with extreme caution! TRUNCATE removes all rows from a table but keeps the structure. It's faster than DELETE because it doesn't log individual row deletions.",code:`-- Drop a table (permanent!)
DROP TABLE IF EXISTS old_employees;

-- Drop entire database
DROP DATABASE test_db;

-- Truncate (empty table, keep structure)
TRUNCATE TABLE logs;

-- Unlike DELETE, TRUNCATE:
-- âœ“ Faster (no row-by-row logging)
-- âœ“ Resets auto-increment
-- âœ— Cannot use WHERE clause
-- âœ— Cannot rollback (in most DBs)`,visual:`<div class="danger-zone">
        <div class="warning">âš ï¸ DROP/TRUNCATE are irreversible!</div>
        <div class="tip">Always backup before using</div>
      </div>`}],keyTakeaway:"DDL defines your database structure. CREATE builds, ALTER modifies, DROP destroys, TRUNCATE empties. Always backup before schema changes!",practiceQuestions:[{q:"What does DDL stand for?",a:"Data Definition Language"},{q:"How to add a column?",a:"ALTER TABLE ... ADD COLUMN"},{q:"Difference DROP vs TRUNCATE?",a:"DROP deletes table, TRUNCATE empties it"}]});zt.register({id:"sql-dml",title:"DML: Manipulating Data",level:"Beginner",duration:"10 min",xp:100,icon:"âœï¸",color:"#f59e0b",description:"Insert, update, and delete data in your tables.",steps:[{title:"What is DML?",narration:"DML stands for Data Manipulation Language. While DDL defines structure, DML works with the actual data inside tables. The main DML commands are INSERT, UPDATE, and DELETE. These modify the rows in your tables.",code:`-- DML Commands Overview
INSERT  -- Add new rows
UPDATE  -- Modify existing rows
DELETE  -- Remove rows
SELECT  -- (Often grouped with DQL)`,visual:'<div class="dml-overview">DML = Data Commands (Rows)</div>'},{title:"INSERT: Adding Data",narration:"INSERT adds new rows to a table. You can insert one row at a time, multiple rows at once, or even copy data from another table. Always list columns explicitly - it makes your code clearer and safer.",code:`-- Insert single row
INSERT INTO employees (name, email, salary)
VALUES ('Alice Smith', 'alice@example.com', 75000);

-- Insert multiple rows
INSERT INTO employees (name, email, salary)
VALUES 
  ('Bob Jones', 'bob@example.com', 65000),
  ('Carol White', 'carol@example.com', 80000);

-- Insert from SELECT
INSERT INTO archive_employees
SELECT * FROM employees
WHERE is_active = FALSE;`,visual:`<div class="insert-visual">
        <div class="before">Table: 3 rows</div>
        <div class="arrow">â†’ INSERT â†’</div>
        <div class="after">Table: 4 rows</div>
      </div>`},{title:"UPDATE: Modifying Data",narration:"UPDATE changes existing data. The SET clause specifies which columns to change and their new values. ALWAYS use a WHERE clause unless you intend to update every row. Forgetting WHERE is a common and dangerous mistake!",code:`-- Update specific rows
UPDATE employees
SET salary = salary * 1.10
WHERE department = 'Engineering';

-- Update multiple columns
UPDATE employees
SET 
  salary = 85000,
  department = 'Senior Engineering'
WHERE id = 5;

-- âš ï¸ DANGEROUS: Updates ALL rows!
UPDATE employees SET salary = 0;`,visual:`<div class="update-warning">
        <div class="rule">âš ï¸ Always use WHERE with UPDATE!</div>
        <div class="tip">Test with SELECT first</div>
      </div>`},{title:"DELETE: Removing Data",narration:"DELETE removes rows from a table. Like UPDATE, always use WHERE unless you want to delete everything. DELETE is slower than TRUNCATE but allows you to specify conditions and can be rolled back in a transaction.",code:`-- Delete specific rows
DELETE FROM employees
WHERE terminated_date < '2020-01-01';

-- Delete with subquery
DELETE FROM orders
WHERE customer_id IN (
  SELECT id FROM customers
  WHERE is_deleted = TRUE
);

-- âš ï¸ DANGEROUS: Deletes ALL rows!
DELETE FROM employees;`,visual:`<div class="delete-visual">
        <div class="before">Table: 100 rows</div>
        <div class="condition">WHERE condition matches 10</div>
        <div class="after">Table: 90 rows</div>
      </div>`}],keyTakeaway:"DML manipulates data: INSERT adds rows, UPDATE modifies them, DELETE removes them. Always use WHERE with UPDATE and DELETE!",practiceQuestions:[{q:"What does DML stand for?",a:"Data Manipulation Language"},{q:"How to add a new row?",a:"INSERT INTO table VALUES(...)"},{q:"What happens if UPDATE has no WHERE?",a:"ALL rows are updated!"}]});zt.register({id:"sql-joins",title:"JOIN Operations: Combining Tables",level:"Intermediate",duration:"18 min",xp:150,icon:"ðŸ”—",color:"#8b5cf6",description:"Master all types of JOINs to combine data from multiple tables.",steps:[{title:"Why JOINs?",narration:"Relational databases split data across multiple tables to avoid redundancy. JOINs bring related data back together. Think of JOINs as connecting puzzle pieces - each table has a key that links to another table.",code:`-- Two related tables:
-- employees: id, name, dept_id
-- departments: id, name, location

-- Without JOIN: Two separate queries
-- With JOIN: One combined result`,visual:`<div class="join-concept">
        <div class="table">employees</div>
        <div class="link">ðŸ”— dept_id â†’ id</div>
        <div class="table">departments</div>
      </div>`},{title:"INNER JOIN",narration:"INNER JOIN returns only rows where there's a match in BOTH tables. If an employee has no department or a department has no employees, those rows won't appear. It's the most common type of JOIN.",code:`-- INNER JOIN: Only matching rows
SELECT 
  e.name AS employee,
  d.name AS department
FROM employees e
INNER JOIN departments d
  ON e.dept_id = d.id;

-- Same result with implicit JOIN
SELECT e.name, d.name
FROM employees e, departments d
WHERE e.dept_id = d.id;`,visual:`<div class="venn-diagram">
        <div class="circle left">Employees</div>
        <div class="intersection highlight">Match</div>
        <div class="circle right">Departments</div>
        <div class="caption">Only intersection returned</div>
      </div>`},{title:"LEFT JOIN",narration:"LEFT JOIN returns ALL rows from the left table, plus matching rows from the right. If there's no match, you get NULL values for right table columns. Use this when you want all records from your main table, even without matches.",code:`-- LEFT JOIN: All employees, even without dept
SELECT 
  e.name AS employee,
  d.name AS department
FROM employees e
LEFT JOIN departments d
  ON e.dept_id = d.id;

-- Result includes employees with NULL department`,visual:`<div class="venn-diagram">
        <div class="circle left highlight">ALL Employees</div>
        <div class="intersection highlight">Match</div>
        <div class="circle right">Departments</div>
        <div class="caption">All left + matching right</div>
      </div>`},{title:"RIGHT JOIN",narration:"RIGHT JOIN is the opposite of LEFT - it returns ALL rows from the right table plus matches from the left. It's less common; you can usually rewrite it as a LEFT JOIN by swapping the table order.",code:`-- RIGHT JOIN: All departments, even empty ones
SELECT 
  e.name AS employee,
  d.name AS department
FROM employees e
RIGHT JOIN departments d
  ON e.dept_id = d.id;

-- Equivalent to:
SELECT e.name, d.name
FROM departments d
LEFT JOIN employees e ON e.dept_id = d.id;`,visual:`<div class="venn-diagram">
        <div class="circle left">Employees</div>
        <div class="intersection highlight">Match</div>
        <div class="circle right highlight">ALL Departments</div>
      </div>`},{title:"FULL OUTER JOIN",narration:"FULL OUTER JOIN returns all rows from both tables. Where there's a match, you get combined data. Where there isn't, you get NULLs. It's useful when you need a complete picture of both datasets.",code:`-- FULL OUTER JOIN: Everything
SELECT 
  e.name AS employee,
  d.name AS department
FROM employees e
FULL OUTER JOIN departments d
  ON e.dept_id = d.id;

-- Results include:
-- âœ“ Employees with departments
-- âœ“ Employees without departments (dept is NULL)
-- âœ“ Departments without employees (emp is NULL)`,visual:`<div class="venn-diagram">
        <div class="circle left highlight">ALL</div>
        <div class="intersection highlight">Match</div>
        <div class="circle right highlight">ALL</div>
      </div>`},{title:"CROSS JOIN and SELF JOIN",narration:"CROSS JOIN produces a Cartesian product - every row from the first table paired with every row from the second. SELF JOIN joins a table with itself, useful for hierarchical data like employees and their managers.",code:`-- CROSS JOIN: Every combination
SELECT e.name, t.task_name
FROM employees e
CROSS JOIN tasks t;
-- 3 employees Ã— 4 tasks = 12 rows

-- SELF JOIN: Employee and their manager
SELECT 
  e.name AS employee,
  m.name AS manager
FROM employees e
LEFT JOIN employees m
  ON e.manager_id = m.id;`,visual:`<div class="cross-join-visual">
        <div>CROSS: 3 Ã— 4 = 12 combinations</div>
        <div>SELF: Table joins with itself</div>
      </div>`}],keyTakeaway:"INNER = only matches. LEFT = all left + matches. RIGHT = all right + matches. FULL = everything. CROSS = all combinations. SELF = table with itself.",practiceQuestions:[{q:"Which JOIN only returns matches?",a:"INNER JOIN"},{q:"How to get all employees even without department?",a:"LEFT JOIN"},{q:"What does CROSS JOIN produce?",a:"Cartesian product (all combinations)"}]});zt.register({id:"sql-aggregates",title:"Aggregate Functions: Summarizing Data",level:"Intermediate",duration:"15 min",xp:150,icon:"ðŸ§®",color:"#ec4899",description:"COUNT, SUM, AVG, GROUP BY, and HAVING for data analysis.",steps:[{title:"What are Aggregate Functions?",narration:"Aggregate functions perform calculations across multiple rows and return a single result. They collapse many rows into summary statistics. The main aggregates are COUNT, SUM, AVG, MIN, and MAX.",code:`-- Basic aggregate functions
SELECT 
  COUNT(*) AS total_employees,
  SUM(salary) AS total_payroll,
  AVG(salary) AS average_salary,
  MIN(salary) AS lowest_salary,
  MAX(salary) AS highest_salary
FROM employees;`,visual:`<div class="aggregate-visual">
        <div>100 rows â†’ COUNT â†’ 1 number</div>
        <div>Many values â†’ AVG â†’ 1 average</div>
      </div>`},{title:"COUNT Variations",narration:"COUNT has three variations: COUNT(*) counts all rows including NULLs. COUNT(column) counts non-NULL values in that column. COUNT(DISTINCT column) counts unique non-NULL values.",code:`-- Count all rows
SELECT COUNT(*) FROM employees;  -- 100

-- Count non-NULL emails
SELECT COUNT(email) FROM employees;  -- 95

-- Count unique departments
SELECT COUNT(DISTINCT department) 
FROM employees;  -- 5`,visual:`<div class="count-types">
        <div>COUNT(*) = All rows</div>
        <div>COUNT(col) = Non-NULL values</div>
        <div>COUNT(DISTINCT col) = Unique values</div>
      </div>`},{title:"GROUP BY: Grouping Results",narration:"GROUP BY divides rows into groups based on column values, then applies aggregate functions to each group separately. Every column in SELECT must either be in GROUP BY or inside an aggregate function.",code:`-- Count employees by department
SELECT 
  department,
  COUNT(*) AS employee_count,
  AVG(salary) AS avg_salary
FROM employees
GROUP BY department;

-- Multiple grouping columns
SELECT 
  department, 
  job_title,
  COUNT(*) AS count
FROM employees
GROUP BY department, job_title;`,visual:`<div class="group-visual">
        <div>Engineering: 30 employees â†’ 1 row</div>
        <div>Marketing: 15 employees â†’ 1 row</div>
        <div>Sales: 25 employees â†’ 1 row</div>
      </div>`},{title:"HAVING: Filtering Groups",narration:"HAVING filters groups AFTER aggregation, while WHERE filters rows BEFORE. Use WHERE for row-level conditions and HAVING for aggregate conditions. Remember: HAVING comes after GROUP BY.",code:`-- Find departments with more than 10 employees
SELECT 
  department, 
  COUNT(*) AS emp_count
FROM employees
GROUP BY department
HAVING COUNT(*) > 10;

-- Combine WHERE and HAVING
SELECT department, AVG(salary) AS avg_sal
FROM employees
WHERE hire_date > '2020-01-01'
GROUP BY department
HAVING AVG(salary) > 60000;`,visual:`<div class="having-visual">
        <div class="order">
          1. FROM â†’ 2. WHERE â†’ 3. GROUP BY â†’ 
          4. HAVING â†’ 5. SELECT â†’ 6. ORDER BY
        </div>
      </div>`},{title:"Aggregate with NULL",narration:"Aggregate functions ignore NULL values (except COUNT(*)). This can affect your results! AVG only divides by non-NULL count. Use COALESCE to handle NULLs explicitly.",code:`-- NULLs are ignored in aggregates
-- salaries: [50000, 60000, NULL, 70000]
SELECT AVG(salary) FROM employees;
-- Result: 60000 (sum/3, not sum/4)

-- Handle NULLs explicitly
SELECT AVG(COALESCE(salary, 0)) 
FROM employees;
-- Treats NULL as 0`,visual:`<div class="null-warning">
        <div>âš ï¸ NULL is NOT 0</div>
        <div>AVG ignores NULL values</div>
      </div>`}],keyTakeaway:"COUNT, SUM, AVG, MIN, MAX summarize data. GROUP BY creates groups. HAVING filters groups after aggregation. Watch out for NULL values!",practiceQuestions:[{q:"Difference between WHERE and HAVING?",a:"WHERE filters rows, HAVING filters groups"},{q:"How to count unique values?",a:"COUNT(DISTINCT column)"},{q:"Does AVG count NULLs?",a:"No, NULLs are ignored"}]});zt.register({id:"sql-subqueries",title:"Subqueries: Queries Within Queries",level:"Intermediate",duration:"14 min",xp:150,icon:"ðŸ”„",color:"#06b6d4",description:"Master nested queries, correlated subqueries, EXISTS, and IN.",steps:[{title:"What is a Subquery?",narration:"A subquery is a query nested inside another query. The inner query runs first, and its result is used by the outer query. Subqueries can appear in SELECT, FROM, WHERE, or HAVING clauses.",code:`-- Subquery in WHERE
SELECT name, salary
FROM employees
WHERE salary > (
  SELECT AVG(salary) FROM employees
);
-- Finds employees above average salary`,visual:`<div class="subquery-visual">
        <div class="outer">Outer Query</div>
        <div class="inner">( Inner Query )</div>
        <div class="flow">Inner runs first â†’ Result used by outer</div>
      </div>`},{title:"Subqueries with IN",narration:"When a subquery returns multiple values, use IN to check if a value matches any result. This is like asking 'is this value in this list?' The list comes from the subquery.",code:`-- Find employees in large departments
SELECT name, department
FROM employees
WHERE department IN (
  SELECT department
  FROM employees
  GROUP BY department
  HAVING COUNT(*) > 10
);

-- NOT IN for exclusion
SELECT * FROM products
WHERE category_id NOT IN (
  SELECT id FROM categories WHERE discontinued = TRUE
);`,visual:`<div class="in-visual">
        <div>Value IN (list) = TRUE if match found</div>
        <div>NOT IN = TRUE if no match</div>
      </div>`},{title:"Correlated Subqueries",narration:"A correlated subquery references the outer query's columns. It runs once for each row of the outer query, making it slower but more powerful. Use when the subquery needs to know about the current row.",code:`-- Find employees earning above their dept average
SELECT e1.name, e1.salary, e1.department
FROM employees e1
WHERE e1.salary > (
  SELECT AVG(e2.salary)
  FROM employees e2
  WHERE e2.department = e1.department  -- Correlation!
);
-- Note: e1.department links inner to outer`,visual:`<div class="correlated-visual">
        <div>For EACH outer row:</div>
        <div class="step">1. Pass value to inner query</div>
        <div class="step">2. Inner query executes</div>
        <div class="step">3. Result compared</div>
      </div>`},{title:"EXISTS and NOT EXISTS",narration:"EXISTS checks if a subquery returns any rows at all - it doesn't care about the values, just whether rows exist. It's often faster than IN for large datasets because it can stop at the first match.",code:`-- Find customers with orders
SELECT c.name
FROM customers c
WHERE EXISTS (
  SELECT 1 FROM orders o
  WHERE o.customer_id = c.id
);

-- Find customers WITHOUT orders
SELECT c.name
FROM customers c
WHERE NOT EXISTS (
  SELECT 1 FROM orders o
  WHERE o.customer_id = c.id
);`,visual:`<div class="exists-visual">
        <div>EXISTS = TRUE if any rows returned</div>
        <div>NOT EXISTS = TRUE if zero rows</div>
        <div class="tip">Often faster than IN for large data</div>
      </div>`},{title:"Subqueries in SELECT and FROM",narration:"Subqueries in SELECT create calculated columns. Subqueries in FROM create derived tables (also called inline views). These are powerful for complex transformations.",code:`-- Subquery in SELECT (scalar)
SELECT 
  name,
  salary,
  (SELECT AVG(salary) FROM employees) AS company_avg,
  salary - (SELECT AVG(salary) FROM employees) AS diff
FROM employees;

-- Subquery in FROM (derived table)
SELECT dept, avg_sal
FROM (
  SELECT department AS dept, AVG(salary) AS avg_sal
  FROM employees
  GROUP BY department
) AS dept_stats
WHERE avg_sal > 70000;`,visual:`<div class="derived-table">
        <div>FROM (subquery) AS alias</div>
        <div>Creates a temporary table</div>
      </div>`}],keyTakeaway:"Subqueries nest queries inside queries. IN checks multiple values. EXISTS checks if rows exist. Correlated subqueries reference outer query columns.",practiceQuestions:[{q:"What is a correlated subquery?",a:"Subquery that references outer query columns"},{q:"When to use EXISTS vs IN?",a:"EXISTS for large datasets, IN for small lists"},{q:"Where can subqueries appear?",a:"SELECT, FROM, WHERE, HAVING"}]});zt.register({id:"sql-window-functions",title:"Window Functions: Advanced Analytics",level:"Advanced",duration:"20 min",xp:200,icon:"ðŸªŸ",color:"#ef4444",description:"ROW_NUMBER, RANK, LAG, LEAD, and running totals without GROUP BY.",steps:[{title:"What are Window Functions?",narration:"Window functions perform calculations across a set of rows related to the current row - without collapsing them like GROUP BY does. You keep all your rows AND get aggregate-like calculations. The magic is the OVER() clause.",code:`-- Compare: GROUP BY collapses rows
SELECT department, AVG(salary) FROM employees GROUP BY department;
-- Returns 1 row per department

-- Window function: keeps all rows!
SELECT 
  name,
  department,
  salary,
  AVG(salary) OVER(PARTITION BY department) AS dept_avg
FROM employees;
-- Returns ALL rows with dept avg added`,visual:`<div class="window-vs-group">
        <div>GROUP BY: Many â†’ Few</div>
        <div>WINDOW: Many â†’ Many (with extras)</div>
      </div>`},{title:"PARTITION BY and ORDER BY",narration:"PARTITION BY divides rows into groups for the calculation - like GROUP BY but without collapsing. ORDER BY within the window determines the order for running calculations. Together they define your 'window frame'.",code:`SELECT 
  name,
  department,
  salary,
  -- Partition: separate calc per department
  SUM(salary) OVER(PARTITION BY department) AS dept_total,
  -- Order: running total within department
  SUM(salary) OVER(
    PARTITION BY department 
    ORDER BY hire_date
  ) AS running_total
FROM employees;`,visual:`<div class="partition-visual">
        <div>PARTITION BY = Group for calculation</div>
        <div>ORDER BY = Sequence within group</div>
      </div>`},{title:"Ranking Functions",narration:"ROW_NUMBER, RANK, and DENSE_RANK assign numbers to rows. ROW_NUMBER gives unique sequential numbers. RANK has gaps for ties. DENSE_RANK has no gaps. NTILE divides into buckets.",code:`SELECT 
  name,
  salary,
  ROW_NUMBER() OVER(ORDER BY salary DESC) AS row_num,
  RANK() OVER(ORDER BY salary DESC) AS rank,
  DENSE_RANK() OVER(ORDER BY salary DESC) AS dense_rank,
  NTILE(4) OVER(ORDER BY salary DESC) AS quartile
FROM employees;

-- Ties example: salaries 100, 90, 90, 80
-- ROW_NUMBER: 1, 2, 3, 4 (unique)
-- RANK:       1, 2, 2, 4 (gaps)
-- DENSE_RANK: 1, 2, 2, 3 (no gaps)`,visual:`<div class="ranking-visual">
        <div>ROW_NUMBER: 1,2,3,4 (always unique)</div>
        <div>RANK: 1,2,2,4 (ties share, gaps)</div>
        <div>DENSE_RANK: 1,2,2,3 (ties share, no gaps)</div>
      </div>`},{title:"LAG and LEAD",narration:"LAG accesses previous rows, LEAD accesses following rows. Perfect for comparing current row to previous or next. You can specify how many rows to look back/forward and a default for edge cases.",code:`SELECT 
  month,
  revenue,
  LAG(revenue, 1) OVER(ORDER BY month) AS prev_month,
  revenue - LAG(revenue, 1) OVER(ORDER BY month) AS change,
  LEAD(revenue, 1) OVER(ORDER BY month) AS next_month
FROM monthly_sales;

-- With default value for first/last rows
LAG(revenue, 1, 0) OVER(ORDER BY month)  -- Default 0`,visual:`<div class="lag-lead-visual">
        <div>â† LAG (previous)</div>
        <div>Current Row</div>
        <div>LEAD (next) â†’</div>
      </div>`},{title:"Frame Specifications",narration:"The frame clause defines exactly which rows to include in the calculation. ROWS BETWEEN specifies a fixed number of rows. RANGE BETWEEN uses value ranges. This gives precise control over moving averages and running totals.",code:`SELECT 
  date,
  value,
  -- Last 3 rows (including current)
  AVG(value) OVER(
    ORDER BY date
    ROWS BETWEEN 2 PRECEDING AND CURRENT ROW
  ) AS moving_avg_3,
  
  -- Running total from start to current
  SUM(value) OVER(
    ORDER BY date
    ROWS BETWEEN UNBOUNDED PRECEDING AND CURRENT ROW
  ) AS running_total
FROM daily_data;`,visual:`<div class="frame-visual">
        <div>UNBOUNDED PRECEDING = from start</div>
        <div>n PRECEDING = n rows back</div>
        <div>CURRENT ROW = this row</div>
        <div>n FOLLOWING = n rows ahead</div>
        <div>UNBOUNDED FOLLOWING = to end</div>
      </div>`}],keyTakeaway:"Window functions add aggregate-like calculations without collapsing rows. PARTITION BY groups, ORDER BY sequences. ROW_NUMBER/RANK for ranking. LAG/LEAD for comparisons.",practiceQuestions:[{q:"How is PARTITION BY different from GROUP BY?",a:"PARTITION BY keeps all rows, GROUP BY collapses"},{q:"Difference between RANK and DENSE_RANK?",a:"RANK has gaps after ties, DENSE_RANK doesn't"},{q:"How to access the previous row's value?",a:"LAG(column, 1)"}]});zt.register({id:"sql-cte",title:"CTEs: Common Table Expressions",level:"Advanced",duration:"14 min",xp:200,icon:"ðŸ“¦",color:"#6366f1",description:"Write cleaner queries with WITH clause and recursive CTEs.",steps:[{title:"What is a CTE?",narration:"A CTE (Common Table Expression) is a temporary named result set defined with the WITH clause. It makes complex queries more readable by breaking them into named pieces. Think of it as creating a temporary view just for one query.",code:`-- Basic CTE syntax
WITH high_earners AS (
  SELECT * FROM employees
  WHERE salary > 100000
)
SELECT department, COUNT(*) AS count
FROM high_earners
GROUP BY department;`,visual:`<div class="cte-visual">
        <div>WITH name AS (subquery)</div>
        <div>â†“</div>
        <div>Main query uses 'name'</div>
      </div>`},{title:"Multiple CTEs",narration:"You can chain multiple CTEs, with later ones able to reference earlier ones. This creates a clean, step-by-step progression for complex queries. Each CTE is separated by a comma.",code:`WITH 
  dept_stats AS (
    SELECT department, AVG(salary) AS avg_sal
    FROM employees
    GROUP BY department
  ),
  high_paying_depts AS (
    SELECT department 
    FROM dept_stats
    WHERE avg_sal > 80000
  )
SELECT e.name, e.department, e.salary
FROM employees e
JOIN high_paying_depts h 
  ON e.department = h.department;`,visual:`<div class="multiple-cte">
        <div class="step">CTE 1: Calculate</div>
        <div class="arrow">â†“</div>
        <div class="step">CTE 2: Filter</div>
        <div class="arrow">â†“</div>
        <div class="step">Main: Join & Select</div>
      </div>`},{title:"CTE vs Subquery",narration:"CTEs and subqueries can often do the same thing, but CTEs are more readable for complex queries. CTEs can be referenced multiple times in the same query. Some databases also optimize CTEs differently.",code:`-- Subquery (harder to read when nested)
SELECT * FROM (
  SELECT * FROM (
    SELECT * FROM employees WHERE active = TRUE
  ) AS active_emps
  WHERE salary > 50000
) AS well_paid
WHERE department = 'Engineering';

-- CTE (cleaner, step-by-step)
WITH active_emps AS (
  SELECT * FROM employees WHERE active = TRUE
),
well_paid AS (
  SELECT * FROM active_emps WHERE salary > 50000
)
SELECT * FROM well_paid WHERE department = 'Engineering';`,visual:`<div class="cte-benefits">
        <div>âœ“ More readable</div>
        <div>âœ“ Can reference multiple times</div>
        <div>âœ“ Self-documenting</div>
      </div>`},{title:"Recursive CTEs",narration:"Recursive CTEs can reference themselves! Perfect for hierarchical data like org charts, category trees, or bill of materials. They have a base case (anchor) and recursive case that builds on previous results.",code:`-- Employee hierarchy (org chart)
WITH RECURSIVE emp_hierarchy AS (
  -- Base case: top-level managers
  SELECT id, name, manager_id, 1 AS level
  FROM employees
  WHERE manager_id IS NULL
  
  UNION ALL
  
  -- Recursive case: employees under managers
  SELECT e.id, e.name, e.manager_id, h.level + 1
  FROM employees e
  JOIN emp_hierarchy h ON e.manager_id = h.id
)
SELECT * FROM emp_hierarchy ORDER BY level;`,visual:`<div class="recursive-visual">
        <div>1. Anchor query runs once</div>
        <div>2. Recursive query runs repeatedly</div>
        <div>3. Each run adds to the result</div>
        <div>4. Stops when no new rows</div>
      </div>`}],keyTakeaway:"CTEs create named temporary results with WITH. They improve readability, can be chained, and support recursion for hierarchical data.",practiceQuestions:[{q:"What does WITH define?",a:"A Common Table Expression (CTE)"},{q:"Can CTEs reference each other?",a:"Yes, later CTEs can reference earlier ones"},{q:"What is a recursive CTE used for?",a:"Hierarchical data like org charts"}]});zt.register({id:"sql-transactions",title:"Transactions: ACID and Data Integrity",level:"Advanced",duration:"16 min",xp:200,icon:"ðŸ”’",color:"#14b8a6",description:"COMMIT, ROLLBACK, isolation levels, and database integrity.",steps:[{title:"What is a Transaction?",narration:"A transaction is a group of SQL statements that execute as a single unit. Either ALL succeed, or NONE do. Think of transferring money: debit one account AND credit another - both must happen or neither should.",code:`-- Transfer $100 from Account A to B
BEGIN TRANSACTION;

UPDATE accounts SET balance = balance - 100 WHERE id = 'A';
UPDATE accounts SET balance = balance + 100 WHERE id = 'B';

COMMIT;  -- Make permanent
-- or ROLLBACK;  -- Undo everything`,visual:`<div class="transaction-visual">
        <div>BEGIN â†’ Operations â†’ COMMIT or ROLLBACK</div>
        <div class="all-or-nothing">All or Nothing</div>
      </div>`},{title:"ACID Properties",narration:"ACID defines the four guarantees of database transactions. Atomicity: all or nothing. Consistency: valid state to valid state. Isolation: concurrent transactions don't interfere. Durability: committed changes are permanent.",code:`-- ACID Properties
-- A - Atomicity:    All statements succeed or all fail
-- C - Consistency:  Data remains valid after transaction
-- I - Isolation:    Concurrent transactions don't interfere
-- D - Durability:   Committed data survives crashes`,visual:`<div class="acid-visual">
        <div class="a">A = All or Nothing</div>
        <div class="c">C = Valid â†’ Valid</div>
        <div class="i">I = No Interference</div>
        <div class="d">D = Permanent</div>
      </div>`},{title:"COMMIT and ROLLBACK",narration:"COMMIT makes all changes in the transaction permanent. ROLLBACK undoes all changes since BEGIN. Some databases auto-commit each statement unless you explicitly start a transaction.",code:`BEGIN TRANSACTION;

INSERT INTO orders (customer_id, total) VALUES (1, 99.99);
-- Order inserted (not yet committed)

-- Something went wrong?
ROLLBACK;  -- Order is undone!

-- Or everything OK:
COMMIT;  -- Order is permanent`,visual:`<div class="commit-rollback">
        <div class="commit">COMMIT â†’ Changes saved forever</div>
        <div class="rollback">ROLLBACK â†’ Changes discarded</div>
      </div>`},{title:"Isolation Levels",narration:"Isolation levels control how transactions see each other's changes. Higher isolation = more consistency but less concurrency. The levels are: Read Uncommitted, Read Committed, Repeatable Read, and Serializable.",code:`-- Set isolation level
SET TRANSACTION ISOLATION LEVEL READ COMMITTED;

-- Isolation Levels (low to high):
-- 1. READ UNCOMMITTED - Sees uncommitted changes (dirty reads)
-- 2. READ COMMITTED   - Only sees committed changes
-- 3. REPEATABLE READ  - Same data if re-read in transaction
-- 4. SERIALIZABLE     - Full isolation (slowest)`,visual:`<div class="isolation-levels">
        <div>Low: READ UNCOMMITTED (fast, risky)</div>
        <div>â†“</div>
        <div>High: SERIALIZABLE (slow, safe)</div>
      </div>`},{title:"Savepoints",narration:"Savepoints let you create checkpoints within a transaction. You can rollback to a savepoint without losing everything. Useful for complex transactions with multiple stages.",code:`BEGIN TRANSACTION;

INSERT INTO orders VALUES (...);
SAVEPOINT order_created;

INSERT INTO order_items VALUES (...);
-- Oops, item insertion failed

ROLLBACK TO order_created;  -- Keep order, undo items

-- Try different items
INSERT INTO order_items VALUES (...);

COMMIT;  -- Save order and new items`,visual:`<div class="savepoint-visual">
        <div>BEGIN â†’ SAVEPOINT A â†’ SAVEPOINT B â†’ ...</div>
        <div>ROLLBACK TO A = Undo back to A only</div>
      </div>`}],keyTakeaway:"Transactions group operations into atomic units. ACID guarantees reliability. COMMIT saves, ROLLBACK undoes. Isolation levels balance consistency and performance.",practiceQuestions:[{q:"What does ACID stand for?",a:"Atomic, Consistent, Isolated, Durable"},{q:"How to undo a transaction?",a:"ROLLBACK"},{q:"What isolation level prevents dirty reads?",a:"READ COMMITTED or higher"}]});zt.register({id:"sql-indexes",title:"Indexes: Query Performance Optimization",level:"Advanced",duration:"16 min",xp:200,icon:"âš¡",color:"#f97316",description:"B-trees, composite indexes, EXPLAIN, and query optimization.",steps:[{title:"What is an Index?",narration:"An index is like a book's index - it helps find data quickly without scanning every page. Without an index, the database must check every row (full table scan). With an index, it jumps directly to matching rows.",code:`-- Create an index
CREATE INDEX idx_employee_name ON employees(name);

-- Now this query is fast:
SELECT * FROM employees WHERE name = 'Alice';
-- Database uses index to find Alice directly`,visual:`<div class="index-visual">
        <div class="no-index">No Index: Scan 1M rows ðŸŒ</div>
        <div class="with-index">With Index: Jump to row ðŸš€</div>
      </div>`},{title:"Index Types",narration:"B-tree indexes are the default - great for equality and range queries. Hash indexes are fastest for exact matches. Full-text indexes help search text content. Each has its use case.",code:`-- B-tree (default) - good for =, <, >, <=, >=, BETWEEN
CREATE INDEX idx_salary ON employees(salary);

-- Hash index - only for exact matches (=)
CREATE INDEX idx_email ON employees(email) USING HASH;

-- Full-text - for text search
CREATE FULLTEXT INDEX idx_bio ON employees(biography);

-- Unique index - enforces uniqueness
CREATE UNIQUE INDEX idx_email_unique ON employees(email);`,visual:`<div class="index-types">
        <div>B-tree: Ranges & Equality âœ“</div>
        <div>Hash: Exact matches only</div>
        <div>Full-text: Text search</div>
      </div>`},{title:"Composite Indexes",narration:"Composite indexes cover multiple columns. Column order matters! The index can be used for queries that filter on the leftmost columns. Think of it like a phone book sorted by last name, then first name.",code:`-- Composite index on (department, salary)
CREATE INDEX idx_dept_salary 
ON employees(department, salary);

-- This uses the index:
SELECT * FROM employees 
WHERE department = 'Engineering';

-- This also uses the index:
SELECT * FROM employees 
WHERE department = 'Engineering' AND salary > 50000;

-- This CANNOT use the index (salary first):
SELECT * FROM employees 
WHERE salary > 50000;`,visual:`<div class="composite-visual">
        <div>Index on (A, B, C)</div>
        <div>âœ“ WHERE A = ?</div>
        <div>âœ“ WHERE A = ? AND B = ?</div>
        <div>âœ“ WHERE A = ? AND B = ? AND C = ?</div>
        <div>âœ— WHERE B = ? (skipped A)</div>
      </div>`},{title:"EXPLAIN: Query Analysis",narration:"EXPLAIN shows how the database will execute your query - which indexes it uses, how many rows it scans, and the execution plan. This is essential for understanding and optimizing slow queries.",code:`-- Analyze query execution
EXPLAIN SELECT * FROM employees WHERE name = 'Alice';

-- Shows:
-- - Table scanned
-- - Index used (or full scan)
-- - Estimated rows
-- - Query cost

-- More detail with ANALYZE
EXPLAIN ANALYZE SELECT * FROM orders WHERE total > 1000;`,visual:`<div class="explain-visual">
        <div>EXPLAIN reveals:</div>
        <div>â€¢ Index usage</div>
        <div>â€¢ Row estimates</div>
        <div>â€¢ Scan type</div>
        <div>â€¢ Cost estimates</div>
      </div>`},{title:"Index Trade-offs",narration:"Indexes speed up reads but slow down writes - every INSERT/UPDATE/DELETE must update all relevant indexes. Too many indexes waste space and hurt write performance. Index strategically on columns used in WHERE, JOIN, and ORDER BY.",code:`-- Good candidates for indexing:
-- âœ“ Primary keys (automatic)
-- âœ“ Foreign keys
-- âœ“ Columns in WHERE clauses
-- âœ“ Columns in JOIN conditions
-- âœ“ Columns in ORDER BY

-- Poor candidates:
-- âœ— Rarely queried columns
-- âœ— Low cardinality (few unique values)
-- âœ— Frequently updated columns`,visual:`<div class="tradeoffs">
        <div class="pros">Reads: Faster</div>
        <div class="cons">Writes: Slower</div>
        <div class="cons">Storage: More space</div>
        <div class="tip">Balance is key!</div>
      </div>`}],keyTakeaway:"Indexes speed up queries dramatically. Use B-tree for most cases, consider composite indexes for multi-column queries. Use EXPLAIN to verify. Balance read speed vs write overhead.",practiceQuestions:[{q:"What is the default index type?",a:"B-tree"},{q:"Does column order matter in composite indexes?",a:"Yes, leftmost columns must be used first"},{q:"How to see query execution plan?",a:"EXPLAIN statement"}]});zt.register({id:"sql-views",title:"Views: Virtual and Materialized Tables",level:"Advanced",duration:"12 min",xp:175,icon:"ðŸ‘ï¸",color:"#84cc16",description:"Create reusable query definitions and cached result sets.",steps:[{title:"What is a View?",narration:"A view is a saved query that acts like a virtual table. When you query a view, the underlying query runs automatically. Views simplify complex queries, provide security by hiding columns, and create a stable interface even if underlying tables change.",code:`-- Create a view
CREATE VIEW employee_summary AS
SELECT 
  e.name,
  e.department,
  e.salary,
  d.location
FROM employees e
JOIN departments d ON e.dept_id = d.id;

-- Use it like a table
SELECT * FROM employee_summary
WHERE department = 'Engineering';`,visual:`<div class="view-visual">
        <div>View = Saved Query</div>
        <div>Acts like a table</div>
        <div>Query runs when accessed</div>
      </div>`},{title:"View Benefits",narration:"Views provide abstraction - users query simple views instead of complex JOINs. They enhance security by exposing only certain columns. They create backward compatibility when table structures change.",code:`-- Security: Hide sensitive columns
CREATE VIEW public_employees AS
SELECT id, name, department
FROM employees;  -- salary is hidden!

-- Simplification: Complex logic once
CREATE VIEW monthly_sales_report AS
SELECT 
  DATE_TRUNC('month', order_date) AS month,
  SUM(total) AS revenue,
  COUNT(*) AS orders
FROM orders
GROUP BY 1;

-- Now users just: SELECT * FROM monthly_sales_report`,visual:`<div class="view-benefits">
        <div>âœ“ Simplifies complex queries</div>
        <div>âœ“ Hides sensitive data</div>
        <div>âœ“ Provides abstraction layer</div>
      </div>`},{title:"Updatable Views",narration:"Some views can be updated directly, and changes flow to underlying tables. Simple views on single tables are usually updatable. Complex views with JOINs, aggregates, or DISTINCT are typically read-only.",code:`-- Simple view (updatable)
CREATE VIEW active_employees AS
SELECT * FROM employees WHERE is_active = TRUE;

-- This updates the underlying table:
UPDATE active_employees SET salary = 60000 WHERE id = 5;

-- Complex view (NOT updatable)
CREATE VIEW dept_stats AS
SELECT department, AVG(salary) FROM employees GROUP BY department;
-- Cannot INSERT/UPDATE/DELETE here`,visual:`<div class="updatable-view">
        <div>Simple single-table â†’ Usually updatable</div>
        <div>JOINs, aggregates â†’ Read-only</div>
      </div>`},{title:"Materialized Views",narration:"A materialized view stores the query result physically, like a cached snapshot. It's faster to query but contains stale data until refreshed. Use for expensive queries that don't need real-time data.",code:`-- Create materialized view (PostgreSQL)
CREATE MATERIALIZED VIEW sales_summary AS
SELECT 
  product_id,
  SUM(quantity) AS total_sold,
  SUM(revenue) AS total_revenue
FROM sales
GROUP BY product_id;

-- Query is fast (pre-computed)
SELECT * FROM sales_summary WHERE total_revenue > 10000;

-- Refresh when needed
REFRESH MATERIALIZED VIEW sales_summary;`,visual:`<div class="materialized-view">
        <div>Regular View: Query runs each time</div>
        <div>Materialized: Results cached</div>
        <div>Trade-off: Speed vs Freshness</div>
      </div>`}],keyTakeaway:"Views are saved queries that act like tables. They simplify, secure, and abstract. Materialized views cache results for speed but need refreshing.",practiceQuestions:[{q:"What is a view?",a:"A saved query that acts like a virtual table"},{q:"Can all views be updated?",a:"No, only simple single-table views"},{q:"How to update materialized view data?",a:"REFRESH MATERIALIZED VIEW"}]});typeof window<"u"&&(window.SQLLectures=zt);const B0={state:{lecture:null,currentStep:0,isPlaying:!1,xpEarned:0,narrationEnabled:!0,autoPlay:!1,autoPlayTimer:null,isPaused:!1},async start(t){var i,s;const e=zt.get(t);if(!e){T(`SQL Lecture not found: ${t}`,"error"),console.error("[SQLLecturePlayer] Lecture not found:",t);return}this.state={lecture:e,currentStep:0,isPlaying:!0,xpEarned:0,narrationEnabled:!0,autoPlay:!1,autoPlayTimer:null},(i=V==null?void 0:V.init)==null||i.call(V),this.showPlayer(),this.renderStep(),T(`Starting: ${e.title}`,"success"),(s=O==null?void 0:O.play)==null||s.call(O,"electure_start")},showPlayer(){let t=document.getElementById("sqlLectureOverlay");t||(t=document.createElement("div"),t.id="sqlLectureOverlay",t.className="sql-lecture-overlay",document.body.appendChild(t)),t.innerHTML=this.renderPlayerHTML(),t.classList.add("active"),this.bindEvents()},renderPlayerHTML(){const t=this.state.lecture;return`
      <div class="sql-lecture-container">
        <div class="sql-lecture-header">
          <button class="sql-exit-btn" onclick="SQLLecturePlayer.close()">âœ• Exit</button>
          <h2>${t.title}</h2>
          <span class="sql-xp-badge">ðŸŽ–ï¸ ${t.xp} XP</span>
        </div>
        
        <div class="sql-lecture-progress">
          <div class="sql-progress-bar">
            <div class="sql-progress-fill" id="sqlProgressFill" style="width: 0%"></div>
          </div>
          <span class="sql-step-counter" id="sqlStepCounter">Step 1 of ${t.steps.length}</span>
        </div>

        <div class="sql-lecture-content" id="sqlLectureContent">
          <!-- Content rendered here -->
        </div>

        <div class="sql-lecture-controls">
          <button class="sql-ctrl-btn" onclick="SQLLecturePlayer.prev()" title="Previous">â—€ï¸</button>
          <button class="sql-ctrl-btn" onclick="SQLLecturePlayer.pauseNarration()" title="Pause Narration">â¸ï¸</button>
          <button class="sql-ctrl-btn" onclick="SQLLecturePlayer.playNarration()" title="Start Narration">â–¶ï¸</button>
          <button class="sql-ctrl-btn" onclick="SQLLecturePlayer.resetNarration()" title="Reset Narration">ðŸ”„</button>
          <button class="sql-ctrl-btn" onclick="SQLLecturePlayer.next()" title="Next">âž¡ï¸</button>
          <div style="width: 1px; height: 24px; background: #30363d; margin: 0 0.5rem;"></div>
          <button class="sql-ctrl-btn ${this.state.narrationEnabled?"active":""}" onclick="SQLLecturePlayer.toggleNarration()" id="sqlNarrationBtn" title="Toggle narration">
            ${this.state.narrationEnabled?"ðŸ”Š":"ðŸ”‡"}
          </button>
          <button class="sql-ctrl-btn" onclick="SQLLecturePlayer.speakCurrentStep()" title="Replay narration">ðŸ”</button>
        </div>
        
        <div class="sql-narration-bar" id="sqlNarrationBar">
          <!-- Narration text shown here -->
        </div>
      </div>
    `},renderStep(){var s;const t=this.state.lecture.steps[this.state.currentStep];if(!t)return;const e=document.getElementById("sqlLectureContent");if(!e)return;e.innerHTML=`
      <div class="sql-step-container">
        <div class="sql-code-section">
          <div class="sql-code-header">
            <span>ðŸ“ The Code</span>
            <button class="sql-see-action-btn" onclick="SQLLecturePlayer.copyCode()">ðŸ“‹ Copy</button>
          </div>
          <pre class="sql-code-block"><code>${this.highlightSQL(t.code||"")}</code></pre>
        </div>
        
        <div class="sql-explanation-section">
          <div class="sql-step-title">Step ${this.state.currentStep+1}: ${t.title}</div>
          <p class="sql-narration">${t.narration}</p>
          ${t.visual?`<div class="sql-visual">${t.visual}</div>`:""}
        </div>
      </div>
    `,this.updateProgress();const i=document.getElementById("sqlNarrationBar");i&&(i.textContent=t.narration),this.state.narrationEnabled&&this.speakCurrentStep(),(s=O==null?void 0:O.play)==null||s.call(O,"step_change")},speakCurrentStep(){var e,i,s,r;const t=(i=(e=this.state.lecture)==null?void 0:e.steps)==null?void 0:i[this.state.currentStep];t&&((s=V==null?void 0:V.stop)==null||s.call(V),(r=V==null?void 0:V.speak)==null||r.call(V,t.narration,()=>{this.state.autoPlay&&this.state.currentStep<this.state.lecture.steps.length-1?this.state.autoPlayTimer=setTimeout(()=>{this.next()},1e3):this.state.autoPlay&&this.state.currentStep===this.state.lecture.steps.length-1&&this.complete()}))},toggleNarration(){var e;this.state.narrationEnabled=!this.state.narrationEnabled;const t=document.getElementById("sqlNarrationBtn");t&&(t.innerHTML=this.state.narrationEnabled?"ðŸ”Š":"ðŸ”‡",t.classList.toggle("active",this.state.narrationEnabled)),this.state.narrationEnabled?this.speakCurrentStep():(e=V==null?void 0:V.stop)==null||e.call(V),T(this.state.narrationEnabled?"ðŸ”Š Narration enabled":"ðŸ”‡ Narration disabled")},togglePause(){const t=window.speechSynthesis,e=document.getElementById("sqlPauseBtn");if(!t){T("Speech synthesis not available");return}t.paused?(t.resume(),this.state.isPaused=!1,e&&(e.innerHTML="â¸ï¸"),T("â–¶ï¸ Narration resumed")):t.speaking?(t.pause(),this.state.isPaused=!0,e&&(e.innerHTML="â–¶ï¸"),T("â¸ï¸ Narration paused")):this.speakCurrentStep()},toggleAutoPlay(){var e;this.state.autoPlay=!this.state.autoPlay;const t=document.getElementById("sqlPlayBtn");t&&(t.innerHTML=this.state.autoPlay?"â¸ï¸":"â–¶ï¸"),this.state.autoPlay?(T("â–¶ï¸ Auto-play started"),this.state.narrationEnabled?this.speakCurrentStep():this.startAutoPlayTimer()):(T("â¸ï¸ Auto-play paused"),this.stopAutoPlayTimer(),(e=V==null?void 0:V.stop)==null||e.call(V))},startAutoPlayTimer(){this.stopAutoPlayTimer(),this.state.autoPlayTimer=setInterval(()=>{this.state.currentStep<this.state.lecture.steps.length-1?this.next():(this.stopAutoPlayTimer(),this.complete())},5e3)},stopAutoPlayTimer(){this.state.autoPlayTimer&&(clearInterval(this.state.autoPlayTimer),clearTimeout(this.state.autoPlayTimer),this.state.autoPlayTimer=null)},highlightSQL(t){if(!t)return"";let e=t.replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;");return["SELECT","FROM","WHERE","AND","OR","NOT","IN","LIKE","BETWEEN","ORDER BY","GROUP BY","HAVING","LIMIT","OFFSET","DISTINCT","AS","JOIN","INNER JOIN","LEFT JOIN","RIGHT JOIN","FULL OUTER JOIN","CROSS JOIN","ON","INSERT INTO","VALUES","UPDATE","SET","DELETE FROM","CREATE TABLE","ALTER TABLE","DROP TABLE","TRUNCATE TABLE","DROP DATABASE","PRIMARY KEY","FOREIGN KEY","REFERENCES","UNIQUE","NOT NULL","DEFAULT","AUTO_INCREMENT","BEGIN TRANSACTION","COMMIT","ROLLBACK","SAVEPOINT","ROLLBACK TO","CREATE INDEX","CREATE UNIQUE INDEX","CREATE VIEW","CREATE MATERIALIZED VIEW","WITH","RECURSIVE","UNION","UNION ALL","INTERSECT","EXCEPT","PARTITION BY","OVER","ROWS BETWEEN","UNBOUNDED PRECEDING","CURRENT ROW","UNBOUNDED FOLLOWING","CASE","WHEN","THEN","ELSE","END","COALESCE","NULLIF","COUNT","SUM","AVG","MIN","MAX","ROW_NUMBER","RANK","DENSE_RANK","NTILE","LAG","LEAD","INT","VARCHAR","TEXT","DATE","DATETIME","DECIMAL","BOOLEAN","FLOAT","IF","EXISTS","USING","ASC","DESC","NULL","TRUE","FALSE","SET TRANSACTION ISOLATION LEVEL","READ UNCOMMITTED","READ COMMITTED","REPEATABLE READ","SERIALIZABLE","ADD","MODIFY","COLUMN","CONSTRAINT","REFRESH"].forEach(s=>{const r=new RegExp(`\\b(${s})\\b`,"gi");e=e.replace(r,'<span class="sql-keyword">$1</span>')}),e=e.replace(/'([^']*)'/g,`<span class="sql-string">'$1'</span>`),e=e.replace(/\b(\d+)\b/g,'<span class="sql-number">$1</span>'),e=e.replace(/(--[^\n]*)/g,'<span class="sql-comment">$1</span>'),e=e.replace(/(\/\*[\s\S]*?\*\/)/g,'<span class="sql-comment">$1</span>'),e},updateProgress(){const t=document.getElementById("sqlProgressFill"),e=document.getElementById("sqlStepCounter");if(t){const i=(this.state.currentStep+1)/this.state.lecture.steps.length*100;t.style.width=`${i}%`}e&&(e.textContent=`Step ${this.state.currentStep+1} of ${this.state.lecture.steps.length}`)},next(){var t,e;this.state.currentStep<this.state.lecture.steps.length-1?((t=V==null?void 0:V.stop)==null||t.call(V),this.state.currentStep++,this.renderStep(),(e=O==null?void 0:O.play)==null||e.call(O,"click")):this.complete()},prev(){var t,e;this.state.currentStep>0&&((t=V==null?void 0:V.stop)==null||t.call(V),this.state.currentStep--,this.renderStep(),(e=O==null?void 0:O.play)==null||e.call(O,"click"))},first(){var t,e;(t=V==null?void 0:V.stop)==null||t.call(V),this.state.currentStep=0,this.renderStep(),(e=O==null?void 0:O.play)==null||e.call(O,"click")},last(){var t,e;(t=V==null?void 0:V.stop)==null||t.call(V),this.state.currentStep=this.state.lecture.steps.length-1,this.renderStep(),(e=O==null?void 0:O.play)==null||e.call(O,"click")},goToStep(t){var e;t>=0&&t<this.state.lecture.steps.length&&((e=V==null?void 0:V.stop)==null||e.call(V),this.state.currentStep=t,this.renderStep())},playNarration(){var t;this.state.autoPlay=!1,this.stopAutoPlayTimer(),V&&((t=V.resume)==null||t.call(V),T("â–¶ï¸ Narration Resumed"))},pauseNarration(){var t;this.state.autoPlay=!1,this.stopAutoPlayTimer(),(t=V==null?void 0:V.pause)==null||t.call(V),T("â¸ï¸ Narration Paused")},resetNarration(){var e,i;this.state.autoPlay=!1,this.stopAutoPlayTimer(),(e=V==null?void 0:V.stop)==null||e.call(V);const t=this.state.lecture.steps[this.state.currentStep];t&&t.narration&&((i=V==null?void 0:V.speak)==null||i.call(V,t.narration)),T("ðŸ”„ Narration Restarted")},updatePlayButton(){},copyCode(){const t=this.state.lecture.steps[this.state.currentStep];t&&t.code&&navigator.clipboard.writeText(t.code).then(()=>{var e;T("Code copied to clipboard!","success"),(e=O==null?void 0:O.play)==null||e.call(O,"success")}).catch(()=>{T("Failed to copy code","error")})},complete(){var i,s,r;const t=this.state.lecture;this.state.xpEarned=t.xp,this.stopAutoPlayTimer(),(i=V==null?void 0:V.stop)==null||i.call(V);const e=document.getElementById("sqlLectureContent");e&&(e.innerHTML=`
        <div class="sql-complete-screen">
          <div class="sql-complete-icon">ðŸŽ‰</div>
          <h2>Lecture Complete!</h2>
          <p class="sql-complete-title">${t.title}</p>
          
          <div class="sql-complete-stats">
            <div class="sql-stat">
              <span class="sql-stat-value">+${t.xp}</span>
              <span class="sql-stat-label">XP Earned</span>
            </div>
            <div class="sql-stat">
              <span class="sql-stat-value">${t.steps.length}</span>
              <span class="sql-stat-label">Steps Completed</span>
            </div>
          </div>

          <div class="sql-key-takeaway">
            <h3>ðŸ’¡ Key Takeaway</h3>
            <p>${t.keyTakeaway}</p>
          </div>

          ${t.practiceQuestions?`
            <div class="sql-practice-quiz">
              <h3>ðŸ§  Quick Review</h3>
              ${t.practiceQuestions.map((n,a)=>`
                <div class="sql-quiz-item">
                  <p class="sql-quiz-q">${a+1}. ${n.q}</p>
                  <p class="sql-quiz-a" onclick="this.classList.toggle('revealed')">Click to reveal: ${n.a}</p>
                </div>
              `).join("")}
            </div>
          `:""}

          <button class="sql-complete-btn" onclick="SQLLecturePlayer.close()">
            âœ“ Done
          </button>
        </div>
      `),T(`+${t.xp} XP earned!`,"success"),(s=O==null?void 0:O.play)==null||s.call(O,"electure_complete"),this.state.narrationEnabled&&((r=V==null?void 0:V.speak)==null||r.call(V,`Congratulations! You've completed ${t.title}. You earned ${t.xp} experience points.`))},close(){var e,i;this.stopAutoPlayTimer(),(e=V==null?void 0:V.stop)==null||e.call(V);const t=document.getElementById("sqlLectureOverlay");t&&(t.classList.remove("active"),setTimeout(()=>t.remove(),300)),this.state={lecture:null,currentStep:0,isPlaying:!1,xpEarned:0,narrationEnabled:!0,autoPlay:!1,autoPlayTimer:null},(i=O==null?void 0:O.play)==null||i.call(O,"close")},bindEvents(){const t=e=>{var i;if(!((i=document.getElementById("sqlLectureOverlay"))!=null&&i.classList.contains("active"))){document.removeEventListener("keydown",t);return}switch(e.key){case"ArrowRight":e.preventDefault(),this.next();break;case"ArrowLeft":e.preventDefault(),this.prev();break;case"Escape":this.close();break;case" ":e.preventDefault(),this.toggleAutoPlay();break;case"n":case"N":this.toggleNarration();break;case"r":case"R":this.speakCurrentStep();break;case"p":case"P":this.togglePause();break}};document.addEventListener("keydown",t)}};typeof window<"u"&&(window.SQLLecturePlayer=B0);typeof window<"u"&&window.ELectureEngineV5&&(window.ELectureEngineV5.startSQL=t=>B0.start(t));const Et={ready:!1,worker:null,requestId:0,pending:new Map,maxRows:200,timeLimitMs:1200,cmLab:null,cmPractice:null,currentChallengeId:null,progress:{xp:0,streak:0,lastSolvedDate:null,solved:{},attempts:{},lastQuery:{}},baseSchemaSql:`
CREATE TABLE customers (
  id INTEGER PRIMARY KEY,
  name TEXT NOT NULL,
  city TEXT NOT NULL
);
CREATE TABLE products (
  id INTEGER PRIMARY KEY,
  name TEXT NOT NULL,
  category TEXT NOT NULL,
  price_cents INTEGER NOT NULL
);
CREATE TABLE orders (
  id INTEGER PRIMARY KEY,
  customer_id INTEGER NOT NULL,
  order_date TEXT NOT NULL,
  FOREIGN KEY (customer_id) REFERENCES customers(id)
);
CREATE TABLE order_items (
  order_id INTEGER NOT NULL,
  product_id INTEGER NOT NULL,
  qty INTEGER NOT NULL,
  FOREIGN KEY (order_id) REFERENCES orders(id),
  FOREIGN KEY (product_id) REFERENCES products(id)
);
      `.trim(),baseSeedSql:`
INSERT INTO customers (id, name, city) VALUES
  (1, 'Asha', 'Pune'),
  (2, 'Bilal', 'Delhi'),
  (3, 'Chloe', 'Mumbai'),
  (4, 'Diego', 'Bengaluru'),
  (5, 'Eli', 'Pune');

INSERT INTO products (id, name, category, price_cents) VALUES
  (1, 'Espresso', 'Coffee', 180),
  (2, 'Latte', 'Coffee', 260),
  (3, 'Cappuccino', 'Coffee', 240),
  (4, 'Cold Brew', 'Coffee', 300),
  (5, 'Chai', 'Tea', 190),
  (6, 'Green Tea', 'Tea', 170),
  (7, 'Blueberry Muffin', 'Bakery', 220),
  (8, 'Croissant', 'Bakery', 210),
  (9, 'Banana Bread', 'Bakery', 250),
  (10, 'Cookie', 'Bakery', 140);

INSERT INTO orders (id, customer_id, order_date) VALUES
  (101, 1, '2025-01-05'),
  (102, 2, '2025-01-06'),
  (103, 1, '2025-01-10'),
  (104, 3, '2025-02-02'),
  (105, 4, '2025-02-07'),
  (106, 5, '2025-02-12'),
  (107, 2, '2025-03-01');

INSERT INTO order_items (order_id, product_id, qty) VALUES
  (101, 2, 1),
  (101, 8, 2),
  (102, 1, 2),
  (102, 10, 3),
  (103, 4, 1),
  (103, 7, 1),
  (104, 5, 2),
  (104, 9, 1),
  (105, 3, 1),
  (105, 8, 1),
  (106, 6, 1),
  (106, 10, 2),
  (107, 7, 2);
      `.trim(),universitySchema:`
CREATE TABLE students (
  id INTEGER PRIMARY KEY,
  name TEXT NOT NULL,
  major TEXT,
  gpa DECIMAL(3,2)
);
CREATE TABLE courses (
  id TEXT PRIMARY KEY,
  title TEXT NOT NULL,
  credits INTEGER
);
CREATE TABLE enrollments (
  student_id INTEGER,
  course_id TEXT,
  grade TEXT,
  PRIMARY KEY (student_id, course_id),
  FOREIGN KEY (student_id) REFERENCES students(id),
  FOREIGN KEY (course_id) REFERENCES courses(id)
);
  `.trim(),universitySeed:`
INSERT INTO students VALUES 
  (1, 'Alice', 'CS', 3.8),
  (2, 'Bob', 'Math', 3.5),
  (3, 'Carol', 'CS', 3.9),
  (4, 'David', 'Physics', 3.2),
  (5, 'Eve', 'Math', 3.7);

INSERT INTO courses VALUES 
  ('CS101', 'Intro to CS', 4),
  ('CS201', 'Data Structures', 4),
  ('MATH101', 'Calculus I', 3),
  ('PHY101', 'Physics I', 4);

INSERT INTO enrollments VALUES 
  (1, 'CS101', 'A'), (1, 'MATH101', 'B+'),
  (2, 'MATH101', 'A'), (2, 'CS101', 'B'),
  (3, 'CS101', 'A'), (3, 'CS201', 'A-'),
  (4, 'PHY101', 'B+'), (4, 'MATH101', 'C');
  `.trim(),socialSchema:`
CREATE TABLE users (
  id INTEGER PRIMARY KEY,
  username TEXT NOT NULL,
  joined_date DATE
);
CREATE TABLE posts (
  id INTEGER PRIMARY KEY,
  user_id INTEGER,
  content TEXT,
  likes INTEGER DEFAULT 0,
  FOREIGN KEY (user_id) REFERENCES users(id)
);
CREATE TABLE follows (
  follower_id INTEGER,
  followee_id INTEGER,
  PRIMARY KEY (follower_id, followee_id),
  FOREIGN KEY (follower_id) REFERENCES users(id),
  FOREIGN KEY (followee_id) REFERENCES users(id)
);
  `.trim(),socialSeed:`
INSERT INTO users VALUES 
  (1, 'tech_guru', '2024-01-01'),
  (2, 'code_wizard', '2024-01-15'),
  (3, 'design_pro', '2024-02-01'),
  (4, 'data_nerd', '2024-02-10');

INSERT INTO posts VALUES 
  (1, 1, 'Hello world!', 15),
  (2, 1, 'SQL is awesome', 42),
  (3, 2, 'Python vs JS?', 25),
  (4, 3, 'New UI design', 100),
  (5, 4, 'Big Data trends', 8);

INSERT INTO follows VALUES 
  (2, 1), (3, 1), (4, 1), -- Everyone follows tech_guru
  (1, 2), (3, 2),         -- tech_guru & design_pro follow code_wizard
  (1, 3);                 -- tech_guru follows design_pro
  `.trim(),challenges:[],loadProgress(){try{const t=localStorage.getItem("cse-helper-sql-progress");if(!t)return;const e=JSON.parse(t);this.progress={xp:e.xp||0,streak:e.streak||0,lastSolvedDate:e.lastSolvedDate||null,solved:e.solved||{},attempts:e.attempts||{},lastQuery:e.lastQuery||{}}}catch(t){console.warn("[SQLModule] Failed to load progress:",t)}},saveProgress(){try{localStorage.setItem("cse-helper-sql-progress",JSON.stringify(this.progress))}catch(t){console.warn("[SQLModule] Failed to save progress:",t)}},computeStreakOnSolve(){const t=new Date,e=t.toISOString().slice(0,10),i=this.progress.lastSolvedDate;if(!i){this.progress.streak=1,this.progress.lastSolvedDate=e;return}const s=new Date(i+"T00:00:00"),r=Math.floor((t-s)/(1e3*60*60*24));r===0||(r===1?(this.progress.streak=(this.progress.streak||0)+1,this.progress.lastSolvedDate=e):(this.progress.streak=1,this.progress.lastSolvedDate=e))},buildChallenges(){this.challenges=[{id:"coffee_e_1",title:"â˜• Top 3 most expensive items",difficulty:"easy",tags:["SELECT","ORDER BY","LIMIT"],story:"A barista wants to know which items are premium priced.",prompt:"Show the 3 most expensive products (name, price_cents).",starterSql:`SELECT name, price_cents
FROM products
ORDER BY price_cents DESC
LIMIT 3;`,solutionSql:`SELECT name, price_cents
FROM products
ORDER BY price_cents DESC
LIMIT 3;`,expected:{type:"table",columns:["name","price_cents"],rows:[["Cold Brew",300],["Latte",260],["Banana Bread",250]],orderMatters:!0},hints:["Use ORDER BY price_cents DESC.","Select only name and price_cents.","Finish with LIMIT 3."],explanation:"ORDER BY sorts rows; DESC gives highest prices first. LIMIT keeps only the first 3 rows."},{id:"coffee_e_2",title:"ðŸ§ Bakery items only",difficulty:"easy",tags:["WHERE"],story:"The shop is making a bakery-only menu board.",prompt:'List bakery product names (category = "Bakery") alphabetically.',starterSql:`SELECT name
FROM products
WHERE category = 'Bakery'
ORDER BY name;`,solutionSql:`SELECT name
FROM products
WHERE category = 'Bakery'
ORDER BY name;`,expected:{type:"table",columns:["name"],rows:[["Banana Bread"],["Blueberry Muffin"],["Cookie"],["Croissant"]],orderMatters:!0},hints:['Filter using WHERE category = "Bakery".',"Return only the name column.","ORDER BY name to sort alphabetically."],explanation:"WHERE filters rows. ORDER BY sorts the remaining rows. Returning fewer columns makes outputs easier to validate."},{id:"coffee_e_3",title:"ðŸ§¾ Orders in February 2025",difficulty:"easy",tags:["WHERE","BETWEEN"],story:"The owner is reviewing February performance.",prompt:"Show order id and order_date for orders in February 2025 (inclusive), ordered by date.",starterSql:`SELECT id, order_date
FROM orders
WHERE order_date BETWEEN '2025-02-01' AND '2025-02-28'
ORDER BY order_date;`,solutionSql:`SELECT id, order_date
FROM orders
WHERE order_date BETWEEN '2025-02-01' AND '2025-02-28'
ORDER BY order_date;`,expected:{type:"table",columns:["id","order_date"],rows:[[104,"2025-02-02"],[105,"2025-02-07"],[106,"2025-02-12"]],orderMatters:!0},hints:["Use BETWEEN for dates.","Select id and order_date from orders.","ORDER BY order_date to make it deterministic."],explanation:"Date strings in YYYY-MM-DD sort correctly lexicographically, so ORDER BY works nicely."},{id:"coffee_m_1",title:"ðŸ¤ Customers and their order count",difficulty:"medium",tags:["JOIN","GROUP BY","COUNT"],story:"The shop wants to see whoâ€™s ordering often.",prompt:"For each customer, show name and number of orders (including 0).",starterSql:`SELECT c.name, COUNT(o.id) AS order_count
FROM customers c
LEFT JOIN orders o ON o.customer_id = c.id
GROUP BY c.id
ORDER BY order_count DESC, c.name;`,solutionSql:`SELECT c.name, COUNT(o.id) AS order_count
FROM customers c
LEFT JOIN orders o ON o.customer_id = c.id
GROUP BY c.id
ORDER BY order_count DESC, c.name;`,expected:{type:"table",columns:["name","order_count"],rows:[["Asha",2],["Bilal",2],["Chloe",1],["Diego",1],["Eli",1]],orderMatters:!0},hints:["Use LEFT JOIN so customers with no orders still appear.","COUNT(o.id) counts only non-null order IDs.","GROUP BY customer id and ORDER BY count DESC."],explanation:"LEFT JOIN preserves all customers. COUNT(o.id) ignores NULLs so it returns 0 for customers without orders."},{id:"coffee_m_2",title:"ðŸ§¾ Order totals (in dollars)",difficulty:"medium",tags:["JOIN","SUM","GROUP BY"],story:"We want to print receipts with totals.",prompt:"For each order, show order_id and total_dollars (sum of qty * price).",starterSql:`SELECT oi.order_id, ROUND(SUM(oi.qty * p.price_cents) / 100.0, 2) AS total_dollars
FROM order_items oi
JOIN products p ON p.id = oi.product_id
GROUP BY oi.order_id
ORDER BY oi.order_id;`,solutionSql:`SELECT oi.order_id, ROUND(SUM(oi.qty * p.price_cents) / 100.0, 2) AS total_dollars
FROM order_items oi
JOIN products p ON p.id = oi.product_id
GROUP BY oi.order_id
ORDER BY oi.order_id;`,expected:{type:"table",columns:["order_id","total_dollars"],rows:[[101,6.8],[102,7.8],[103,5.2],[104,6.3],[105,4.5],[106,4.5],[107,7]],orderMatters:!0},hints:["Join order_items to products to get prices.","Total is SUM(qty * price_cents).","Divide by 100.0 to get dollars; use ROUND for neat output."],explanation:"Aggregations need GROUP BY. ROUND makes output deterministic and friendly."},{id:"coffee_m_3",title:"ðŸ“¦ Best-selling category",difficulty:"medium",tags:["JOIN","GROUP BY","SUM"],story:"The shop wants to stock more of what sells.",prompt:"Return category and total_qty sold, highest first. (If tie, alphabetical.)",starterSql:`SELECT p.category, SUM(oi.qty) AS total_qty
FROM order_items oi
JOIN products p ON p.id = oi.product_id
GROUP BY p.category
ORDER BY total_qty DESC, p.category;`,solutionSql:`SELECT p.category, SUM(oi.qty) AS total_qty
FROM order_items oi
JOIN products p ON p.id = oi.product_id
GROUP BY p.category
ORDER BY total_qty DESC, p.category;`,expected:{type:"table",columns:["category","total_qty"],rows:[["Bakery",11],["Coffee",6],["Tea",3]],orderMatters:!0},hints:["Join items to products to access category.","SUM(qty) to count how many units were sold.","ORDER BY total_qty DESC to find the top category."],explanation:"Weâ€™re grouping sales by category and summing quantities. Ordering by total_qty shows best sellers first."},{id:"coffee_h_1",title:"ðŸ§© Customers who bought both Coffee and Bakery",difficulty:"hard",tags:["JOIN","GROUP BY","HAVING"],story:"Marketing wants customers who enjoy both drinks and snacks.",prompt:"List customer names who have purchased at least one Coffee item AND at least one Bakery item.",starterSql:`SELECT c.name
FROM customers c
JOIN orders o ON o.customer_id = c.id
JOIN order_items oi ON oi.order_id = o.id
JOIN products p ON p.id = oi.product_id
GROUP BY c.id
HAVING SUM(CASE WHEN p.category = 'Coffee' THEN 1 ELSE 0 END) > 0
   AND SUM(CASE WHEN p.category = 'Bakery' THEN 1 ELSE 0 END) > 0
ORDER BY c.name;`,solutionSql:`SELECT c.name
FROM customers c
JOIN orders o ON o.customer_id = c.id
JOIN order_items oi ON oi.order_id = o.id
JOIN products p ON p.id = oi.product_id
GROUP BY c.id
HAVING SUM(CASE WHEN p.category = 'Coffee' THEN 1 ELSE 0 END) > 0
   AND SUM(CASE WHEN p.category = 'Bakery' THEN 1 ELSE 0 END) > 0
ORDER BY c.name;`,expected:{type:"table",columns:["name"],rows:[["Asha"],["Bilal"]],orderMatters:!0},hints:["Join customers â†’ orders â†’ order_items â†’ products.","Use GROUP BY per customer.","Use HAVING with conditional SUM/CASE for categories."],explanation:"HAVING filters after grouping. Conditional aggregation lets us check whether each category appears for that customer."},{id:"coffee_h_2",title:"ðŸ§  Repeat customers (2+ order days)",difficulty:"hard",tags:["COUNT DISTINCT","GROUP BY","HAVING"],story:"The owner wants to reward loyal customers.",prompt:"Show customer name and number of distinct order_date values; keep only those with 2 or more distinct days.",starterSql:`SELECT c.name, COUNT(DISTINCT o.order_date) AS active_days
FROM customers c
JOIN orders o ON o.customer_id = c.id
GROUP BY c.id
HAVING COUNT(DISTINCT o.order_date) >= 2
ORDER BY active_days DESC, c.name;`,solutionSql:`SELECT c.name, COUNT(DISTINCT o.order_date) AS active_days
FROM customers c
JOIN orders o ON o.customer_id = c.id
GROUP BY c.id
HAVING COUNT(DISTINCT o.order_date) >= 2
ORDER BY active_days DESC, c.name;`,expected:{type:"table",columns:["name","active_days"],rows:[["Asha",2],["Bilal",2]],orderMatters:!0},hints:["COUNT(DISTINCT ...) counts unique days.","Filter using HAVING (because itâ€™s an aggregate).","ORDER BY active_days DESC."],explanation:"COUNT DISTINCT measures how many different days the customer ordered. HAVING filters groups by that value."},{id:"coffee_e_5",title:"ðŸ’° Products below average price",difficulty:"easy",tags:["WHERE","Subquery"],story:"The manager wants to highlight budget-friendly options.",prompt:"Show products (name, price_cents) that cost less than the average price.",starterSql:`SELECT name, price_cents
FROM products
WHERE price_cents < (SELECT AVG(price_cents) FROM products)
ORDER BY price_cents;`,solutionSql:`SELECT name, price_cents
FROM products
WHERE price_cents < (SELECT AVG(price_cents) FROM products)
ORDER BY price_cents;`,expected:{type:"table",columns:["name","price_cents"],rows:[["Cookie",140],["Green Tea",170],["Espresso",180],["Chai",190],["Croissant",210]],orderMatters:!0},hints:["Use a subquery: (SELECT AVG(price_cents) FROM products)","Compare with WHERE price_cents < ...","Order by price_cents ascending."],explanation:"A subquery calculates the average, then the outer query filters products below it."},{id:"coffee_e_6",title:"ðŸ“Š Count products per category",difficulty:"easy",tags:["GROUP BY","COUNT"],story:"The shop wants to know product variety per category.",prompt:"Show each category and how many products it has, ordered by count descending.",starterSql:`SELECT category, COUNT(*) AS product_count
FROM products
GROUP BY category
ORDER BY product_count DESC;`,solutionSql:`SELECT category, COUNT(*) AS product_count
FROM products
GROUP BY category
ORDER BY product_count DESC;`,expected:{type:"table",columns:["category","product_count"],rows:[["Bakery",4],["Coffee",4],["Tea",2]],orderMatters:!0},hints:["GROUP BY category to group products.","COUNT(*) counts products per group.","ORDER BY the count descending."],explanation:"GROUP BY creates groups; COUNT(*) tallies rows in each group."},{id:"coffee_m_5",title:"ðŸ’µ Total revenue per customer",difficulty:"medium",tags:["JOIN","SUM","GROUP BY"],story:"The owner wants to know who spends the most.",prompt:"Show customer name and their total spending (SUM of price_cents * qty), ordered by spending DESC.",starterSql:`SELECT c.name, SUM(p.price_cents * oi.qty) AS total_spent
FROM customers c
JOIN orders o ON o.customer_id = c.id
JOIN order_items oi ON oi.order_id = o.id
JOIN products p ON p.id = oi.product_id
GROUP BY c.id
ORDER BY total_spent DESC;`,solutionSql:`SELECT c.name, SUM(p.price_cents * oi.qty) AS total_spent
FROM customers c
JOIN orders o ON o.customer_id = c.id
JOIN order_items oi ON oi.order_id = o.id
JOIN products p ON p.id = oi.product_id
GROUP BY c.id
ORDER BY total_spent DESC;`,expected:{type:"table",columns:["name","total_spent"],rows:[["Asha",1930],["Bilal",1200],["Diego",880],["Chloe",430],["Eli",410]],orderMatters:!0},hints:["Join all four tables: customers â†’ orders â†’ order_items â†’ products.","Use SUM(price_cents * qty) for total.","GROUP BY customer, ORDER BY total DESC."],explanation:"Multi-table JOIN with aggregation calculates spending per customer."},{id:"coffee_m_6",title:"ðŸš« Products never ordered",difficulty:"medium",tags:["LEFT JOIN","NULL"],story:"Inventory wants products that never sold.",prompt:"Show product names that have never been ordered (no matching order_items).",starterSql:`SELECT p.name
FROM products p
LEFT JOIN order_items oi ON oi.product_id = p.id
WHERE oi.order_id IS NULL
ORDER BY p.name;`,solutionSql:`SELECT p.name
FROM products p
LEFT JOIN order_items oi ON oi.product_id = p.id
WHERE oi.order_id IS NULL
ORDER BY p.name;`,expected:{type:"table",columns:["name"],rows:[["Banana Bread"],["Chai"],["Green Tea"]],orderMatters:!0},hints:["Use LEFT JOIN to keep all products.","Filter WHERE oi.order_id IS NULL for no matches.","Order alphabetically."],explanation:"LEFT JOIN includes unmatched rows; IS NULL finds products with no orders."},{id:"coffee_h_3",title:"ðŸ† Customer with highest single order value",difficulty:"hard",tags:["Subquery","MAX","JOIN"],story:"Find the VIP with the biggest single order.",prompt:"Show the customer name who placed the order with the highest total value (single order).",starterSql:`SELECT c.name
FROM customers c
JOIN orders o ON o.customer_id = c.id
JOIN order_items oi ON oi.order_id = o.id
JOIN products p ON p.id = oi.product_id
GROUP BY o.id
ORDER BY SUM(p.price_cents * oi.qty) DESC
LIMIT 1;`,solutionSql:`SELECT c.name
FROM customers c
JOIN orders o ON o.customer_id = c.id
JOIN order_items oi ON oi.order_id = o.id
JOIN products p ON p.id = oi.product_id
GROUP BY o.id
ORDER BY SUM(p.price_cents * oi.qty) DESC
LIMIT 1;`,expected:{type:"table",columns:["name"],rows:[["Asha"]],orderMatters:!1},hints:["Join all tables and GROUP BY order_id.","Calculate SUM per order.","ORDER BY the sum DESC, LIMIT 1."],explanation:"Group by order, sum values, then take the top one."},{id:"coffee_h_4",title:"ðŸ“ˆ Customer order count ranking",difficulty:"hard",tags:["COUNT","GROUP BY","ORDER BY"],story:"Rank customers by how many orders they've placed.",prompt:"Show customer name and order count, with a rank (1 = most orders). Include only customers with 2+ orders.",starterSql:`SELECT c.name, COUNT(o.id) AS order_count
FROM customers c
JOIN orders o ON o.customer_id = c.id
GROUP BY c.id
HAVING COUNT(o.id) >= 2
ORDER BY order_count DESC;`,solutionSql:`SELECT c.name, COUNT(o.id) AS order_count
FROM customers c
JOIN orders o ON o.customer_id = c.id
GROUP BY c.id
HAVING COUNT(o.id) >= 2
ORDER BY order_count DESC;`,expected:{type:"table",columns:["name","order_count"],rows:[["Asha",3],["Bilal",2]],orderMatters:!0},hints:["COUNT orders per customer.","Use HAVING for 2+ filter.","ORDER BY count DESC for ranking."],explanation:"HAVING filters aggregated results; ORDER BY creates implicit ranking."},{id:"hr_e_1",title:"ðŸ” All customers from Pune",difficulty:"easy",tags:["SELECT","WHERE"],story:"Find customers in a specific city.",prompt:"Show all columns for customers who live in 'Pune'.",starterSql:"",solutionSql:"SELECT * FROM customers WHERE city = 'Pune';",expected:{type:"table",columns:["id","name","city"],rows:[[1,"Asha","Pune"],[5,"Eli","Pune"]],orderMatters:!1},hints:["Start with SELECT * FROM customers...","Use WHERE to filter by city.","String values need single quotes: 'Pune'"],explanation:"SELECT * returns all columns. WHERE filters rows matching the condition."},{id:"hr_e_2",title:"ðŸ·ï¸ Unique categories",difficulty:"easy",tags:["SELECT","DISTINCT"],story:"List all product categories in the shop.",prompt:"Show all unique product categories, sorted alphabetically.",starterSql:"",solutionSql:"SELECT DISTINCT category FROM products ORDER BY category;",expected:{type:"table",columns:["category"],rows:[["Bakery"],["Coffee"],["Tea"]],orderMatters:!0},hints:["DISTINCT removes duplicates.","Select only the category column.","Add ORDER BY for alphabetical sorting."],explanation:"DISTINCT eliminates duplicate values in the result set."},{id:"hr_e_3",title:"ðŸ“Š Total products",difficulty:"easy",tags:["COUNT"],story:"The manager wants a quick inventory count.",prompt:"Count the total number of products in the store.",starterSql:"",solutionSql:"SELECT COUNT(*) AS total_products FROM products;",expected:{type:"table",columns:["total_products"],rows:[[10]],orderMatters:!1},hints:["Use COUNT(*) to count all rows.","Give the result a descriptive alias.","No WHERE needed - count everything."],explanation:"COUNT(*) counts all rows in the table regardless of NULL values."},{id:"hr_e_4",title:"ðŸ’² Cheapest product",difficulty:"easy",tags:["SELECT","ORDER BY","LIMIT"],story:"A customer wants the cheapest item.",prompt:"Show the name and price_cents of the cheapest product.",starterSql:"",solutionSql:"SELECT name, price_cents FROM products ORDER BY price_cents ASC LIMIT 1;",expected:{type:"table",columns:["name","price_cents"],rows:[["Cookie",140]],orderMatters:!1},hints:["ORDER BY price_cents puts cheapest first.","ASC means ascending (smallest first).","LIMIT 1 returns only the first row."],explanation:"ORDER BY ASC + LIMIT 1 is an efficient way to find the minimum value."},{id:"hr_m_1",title:"ðŸ§® Average price per category",difficulty:"medium",tags:["GROUP BY","AVG"],story:"Compare pricing across categories.",prompt:"Show each category with its average price_cents, rounded to 1 decimal.",starterSql:"",solutionSql:"SELECT category, ROUND(AVG(price_cents), 1) AS avg_price FROM products GROUP BY category ORDER BY avg_price DESC;",expected:{type:"table",columns:["category","avg_price"],rows:[["Coffee",245],["Bakery",205],["Tea",180]],orderMatters:!0},hints:["GROUP BY category to calculate per-category averages.","Use AVG() with ROUND() for clean output.","ORDER BY the average to rank categories."],explanation:"AVG() calculates the mean of values in each group created by GROUP BY."},{id:"hr_m_2",title:"ðŸ“… Orders per month",difficulty:"medium",tags:["GROUP BY","COUNT","SUBSTR"],story:"Analyze order patterns by month.",prompt:"Show month (YYYY-MM format) and order count for each month.",starterSql:"",solutionSql:"SELECT SUBSTR(order_date, 1, 7) AS month, COUNT(*) AS order_count FROM orders GROUP BY SUBSTR(order_date, 1, 7) ORDER BY month;",expected:{type:"table",columns:["month","order_count"],rows:[["2025-01",2],["2025-02",3],["2025-03",2]],orderMatters:!0},hints:["Use SUBSTR(order_date, 1, 7) to extract YYYY-MM.","GROUP BY the extracted month.","COUNT(*) gives orders per group."],explanation:"SUBSTR extracts part of a string. Grouping by this allows monthly aggregation."},{id:"hr_m_3",title:"ðŸŽ¯ Products ordered at least twice",difficulty:"medium",tags:["JOIN","GROUP BY","HAVING"],story:"Find popular products (ordered multiple times).",prompt:"Show product names that appear in 2 or more order_items, with their count.",starterSql:"",solutionSql:"SELECT p.name, COUNT(*) AS times_ordered FROM products p JOIN order_items oi ON oi.product_id = p.id GROUP BY p.id HAVING COUNT(*) >= 2 ORDER BY times_ordered DESC;",expected:{type:"table",columns:["name","times_ordered"],rows:[["Cookie",3],["Croissant",2],["Blueberry Muffin",2]],orderMatters:!0},hints:["JOIN products with order_items.","GROUP BY product and use COUNT(*).","HAVING filters groups after aggregation."],explanation:"HAVING is like WHERE but works on aggregated results after GROUP BY."},{id:"hr_m_4",title:"ðŸ”— Customers without orders",difficulty:"medium",tags:["LEFT JOIN","NULL"],story:"Find customers who haven't ordered yet.",prompt:"Show names of customers who have never placed an order.",starterSql:"",solutionSql:"SELECT c.name FROM customers c LEFT JOIN orders o ON o.customer_id = c.id WHERE o.id IS NULL ORDER BY c.name;",expected:{type:"table",columns:["name"],rows:[],orderMatters:!1},hints:["LEFT JOIN keeps all customers even without matching orders.","WHERE o.id IS NULL finds customers with no matches.","Check the data - all customers have orders!"],explanation:"In this dataset, all customers have placed orders. The result is empty but the query logic is correct."},{id:"hr_h_1",title:"ðŸ… Top spending customer",difficulty:"hard",tags:["JOIN","SUM","Subquery"],story:"Identify the VIP customer.",prompt:"Find the customer name with the highest total spending across all orders.",starterSql:"",solutionSql:"SELECT c.name FROM customers c JOIN orders o ON o.customer_id = c.id JOIN order_items oi ON oi.order_id = o.id JOIN products p ON p.id = oi.product_id GROUP BY c.id ORDER BY SUM(p.price_cents * oi.qty) DESC LIMIT 1;",expected:{type:"table",columns:["name"],rows:[["Asha"]],orderMatters:!1},hints:["Join all 4 tables to connect customers to their purchases.","SUM(price * qty) calculates total per customer.","ORDER BY the sum DESC, LIMIT 1 for the top."],explanation:"Multi-table JOIN with aggregation finds the highest spender."},{id:"hr_h_2",title:"ðŸ“ˆ Products above category average",difficulty:"hard",tags:["Subquery","Correlated"],story:"Find premium products within each category.",prompt:"Show products whose price_cents exceeds the average price of their own category.",starterSql:"",solutionSql:"SELECT p.name, p.category, p.price_cents FROM products p WHERE p.price_cents > (SELECT AVG(p2.price_cents) FROM products p2 WHERE p2.category = p.category) ORDER BY p.category, p.price_cents DESC;",expected:{type:"table",columns:["name","category","price_cents"],rows:[["Banana Bread","Bakery",250],["Blueberry Muffin","Bakery",220],["Cold Brew","Coffee",300],["Latte","Coffee",260],["Chai","Tea",190]],orderMatters:!0},hints:["Use a correlated subquery that calculates avg per category.","The subquery references the outer table (p.category).","Compare each product's price to its category's average."],explanation:"A correlated subquery runs once per outer row, comparing each product to its category's average."}]},updateBadges(){v("sqlXpBadge")&&(v("sqlXpBadge").textContent=`XP: ${this.progress.xp||0}`),v("sqlStreakBadge")&&(v("sqlStreakBadge").textContent=`Streak: ${this.progress.streak||0}`)},ensureEditors(){!this.cmLab&&v("sqlLabEditor")&&window.CodeMirror&&(this.cmLab=window.CodeMirror.fromTextArea(v("sqlLabEditor"),{mode:"text/x-sql",theme:"neo",lineNumbers:!0,indentWithTabs:!1,indentUnit:2,tabSize:2,autofocus:!1}),this.cmLab.on("keydown",(t,e)=>{var i,s;(e.ctrlKey||e.metaKey)&&e.key==="Enter"&&(e.preventDefault(),(i=v("btnSqlLabRun"))==null||i.click()),(e.ctrlKey||e.metaKey)&&e.key.toLowerCase()==="r"&&(e.preventDefault(),(s=v("btnSqlLabReset"))==null||s.click())})),!this.cmPractice&&v("sqlPracticeEditor")&&window.CodeMirror&&(this.cmPractice=window.CodeMirror.fromTextArea(v("sqlPracticeEditor"),{mode:"text/x-sql",theme:"neo",lineNumbers:!0,indentWithTabs:!1,indentUnit:2,tabSize:2,autofocus:!1}),this.cmPractice.on("keydown",(t,e)=>{var i,s,r;(e.ctrlKey||e.metaKey)&&e.key==="Enter"&&(e.preventDefault(),(i=v("btnSqlCheck"))==null||i.click()),(e.ctrlKey||e.metaKey)&&e.key.toLowerCase()==="r"&&(e.preventDefault(),(s=v("btnSqlReset"))==null||s.click()),e.altKey&&e.key==="ArrowRight"&&(e.preventDefault(),(r=v("btnSqlNext"))==null||r.click())}))},setReadyUI(t){const e=v("sqlReadyBadge");e&&(e.className=`badge ${t?"badge-green":"badge-amber"}`,e.textContent=t?"Ready âœ…":"Loading SQL Engineâ€¦")},async ensureReady(){var t;if(this.ready){this.ensureEditors(),this.updateBadges();return}this.loadProgress(),this.buildChallenges(),this.updateBadges(),this.setReadyUI(!1),await this.startWorker(),await this.resetDbToBase(),this.ready=!0,this.setReadyUI(!0),this.ensureEditors(),this.populateChallengeSelect(),(t=v("btnSqlLabPreview"))==null||t.click();try{localStorage.getItem("cse-helper-sql-seen")||(localStorage.setItem("cse-helper-sql-seen","1"),T("ðŸ§ª SQL Lab ready! Run your first query (Ctrl/Cmd+Enter)."))}catch(e){console.warn("[SQLModule] Failed to check onboarding state:",e)}},startWorker(){return new Promise((t,e)=>{try{this.worker&&(this.worker.terminate(),this.worker=null);const r=`
      let SQL = null;
      let db = null;

      function normalizeError(err) {
        const msg = (err && (err.message || err.toString())) || 'Unknown SQL error';
        let hintCategory = 'generic';
        if (/no such table/i.test(msg)) hintCategory = 'missing_table';
        else if (/no such column/i.test(msg)) hintCategory = 'missing_column';
        else if (/syntax error/i.test(msg)) hintCategory = 'syntax';
        else if (/near "/i.test(msg)) hintCategory = 'syntax';
        return { message: msg, raw: msg, hintCategory };
      }

      self.onmessage = async (e) => {
        const { type, requestId, payload } = e.data || {};

        try {
          if (type === 'INIT') {
            importScripts('https://cdnjs.cloudflare.com/ajax/libs/sql.js/1.10.2/sql-wasm.js');
            SQL = await initSqlJs({ locateFile: () => 'https://cdnjs.cloudflare.com/ajax/libs/sql.js/1.10.2/sql-wasm.wasm' });
            self.postMessage({ type: 'READY' });
            return;
          }

          if (type === 'INIT_DB') {
            if (!SQL) throw new Error('SQL engine not loaded');
            db = new SQL.Database();
            const sql = payload && payload.sql ? payload.sql : '';
            if (sql.trim()) db.run(sql);
            self.postMessage({ type: 'OK', requestId });
            return;
          }

          if (type === 'RESET_DB') {
            if (!SQL) throw new Error('SQL engine not loaded');
            if (db) db.close();
            db = new SQL.Database();
            const sql = payload && payload.sql ? payload.sql : '';
            if (sql.trim()) db.run(sql);
            self.postMessage({ type: 'OK', requestId });
            return;
          }

          if (type === 'RUN_QUERY') {
            if (!db) throw new Error('Database not initialized');
            const query = (payload && payload.query) ? payload.query : '';
            const maxRows = (payload && payload.maxRows) ? payload.maxRows : 200;

            // Execute (supports multiple statements). Return last result set.
            const results = db.exec(query);
            let out = { columns: [], rows: [], rowCount: 0, truncated: false, rowsModified: 0 };
            if (typeof db.getRowsModified === 'function') out.rowsModified = db.getRowsModified();

            if (results && results.length) {
              const last = results[results.length - 1];
              out.columns = last.columns || [];
              out.rows = last.values || [];
              out.rowCount = out.rows.length;
              if (out.rows.length > maxRows) {
                out.rows = out.rows.slice(0, maxRows);
                out.truncated = true;
              }
            }
            self.postMessage({ type: 'RESULT', requestId, result: out });
            return;
          }

        } catch (err) {
          self.postMessage({ type: 'ERROR', requestId, error: normalizeError(err) });
        }
      };
    `,n=new Blob([r],{type:"application/javascript"}),a=URL.createObjectURL(n),o=new Worker(a);URL.revokeObjectURL(a),this.worker=o;const l=c=>{c.data&&c.data.type==="READY"&&(o.removeEventListener("message",l),t())};o.addEventListener("message",l),o.addEventListener("message",c=>this._onWorkerMessage(c)),o.postMessage({type:"INIT"})}catch(i){e(i)}})},_onWorkerMessage(t){const e=t.data||{},{type:i,requestId:s}=e;if(!s)return;const r=this.pending.get(s);r&&(i==="RESULT"?(this.pending.delete(s),r.resolve(e.result)):i==="OK"?(this.pending.delete(s),r.resolve(!0)):i==="ERROR"&&(this.pending.delete(s),r.reject(e.error)))},_callWorker(t,e={},i=this.timeLimitMs){return new Promise((s,r)=>{if(!this.worker)return r({message:"SQL Worker not ready",hintCategory:"generic"});const n=++this.requestId,a=setTimeout(()=>{try{this.worker.terminate()}catch{}this.worker=null,this.pending.delete(n),r({message:"Query timed out. Try a simpler query (or add LIMIT).",hintCategory:"timeout"}),this.startWorker().then(()=>this.resetDbToBase()).catch(()=>{})},i);this.pending.set(n,{resolve:o=>{clearTimeout(a),s(o)},reject:o=>{clearTimeout(a),r(o)}}),this.worker.postMessage({type:t,requestId:n,payload:e})})},resetDbToBase(){const t=`${this.baseSchemaSql}

${this.baseSeedSql}`;return this._callWorker("RESET_DB",{sql:t},2e3)},initDbWith(t){return this._callWorker("RESET_DB",{sql:t},2e3)},async runQuery(t,e={}){if(!t||!t.trim())throw{message:"Write a query first.",hintCategory:"empty"};return await this._callWorker("RUN_QUERY",{query:t,maxRows:this.maxRows},e.timeoutMs||this.timeLimitMs)},renderTable(t,e){if(!t)return;if(!e||!e.columns){t.innerHTML='<div style="padding: 1rem; color: var(--text-muted); font-weight: 800;">No results.</div>';return}if(!e.columns.length){const o=e.rowsModified?`${e.rowsModified} row(s) affected.`:"Query executed (no table returned).";t.innerHTML=`<div style="padding: 1rem; color: var(--text-muted); font-weight: 800;">${o}</div>`;return}const i=e.columns,s=e.rows||[],r=e.truncated,n=`<thead><tr>${i.map(o=>`<th>${Si(String(o))}</th>`).join("")}</tr></thead>`,a=`<tbody>${s.map(o=>`<tr>${o.map(l=>`<td>${Si(l===null?"NULL":String(l))}</td>`).join("")}</tr>`).join("")}</tbody>`;t.innerHTML=`
  <div style="margin-bottom: 0.5rem;">
    <button class="btn btn-small btn-secondary" onclick="SQLModule.setTab('sqlLabTabs', 'sqlLabPaneEditor')">
      â¬…ï¸ Back to Editor
    </button>
  </div>
  <table class="sql-table">${n}${a}</table>
  ${r?`<div style="padding: 0.75rem; color: var(--text-muted); font-weight: 800;">Showing first ${this.maxRows} rows (truncated).</div>`:""}
`},populateChallengeSelect(){var s;const t=v("sqlChallengeSelect");if(!t)return;t.innerHTML="",this.challenges.forEach(r=>{const n=document.createElement("option");n.value=r.id,n.textContent=`${r.difficulty.toUpperCase()} â€¢ ${r.title}`,t.appendChild(n)});const e=this.progress.lastChallengeId,i=this.challenges.find(r=>r.id===e)?e:(s=this.challenges[0])==null?void 0:s.id;i&&(t.value=i,this.loadChallenge(i))},async loadChallenge(t){const e=this.challenges.find(a=>a.id===t);if(!e)return;this.currentChallengeId=t,this.progress.lastChallengeId=t,this.saveProgress(),await this.resetDbToBase(),v("sqlChallengeTitle").textContent=e.title,v("sqlChallengePrompt").textContent=e.prompt;const i={easy:"badge-easy",medium:"badge-medium",hard:"badge-hard"}[e.difficulty]||"badge-easy",s={easy:"2-3 min",medium:"5-7 min",hard:"8-10 min"}[e.difficulty]||"5 min";v("sqlChallengeBadges").innerHTML=`
  <span class="badge ${i}">${e.difficulty.toUpperCase()}</span>
  <span class="badge badge-time">â±ï¸ ${s}</span>
  ${e.tags.map(a=>`<span class="badge badge-sky">${Si(a)}</span>`).join("")}
  ${this.progress.solved[t]?'<span class="badge badge-easy">âœ… Solved</span>':""}
`;const r=this.progress.attempts[t]||0;v("sqlAttempts").textContent=`Attempts: ${r}`,v("sqlHints").innerHTML="",v("sqlSolution").style.display="none",v("sqlSolutionCode").textContent="",v("sqlExplanationCard").style.display="none",v("sqlPracticeStatus").textContent="Ready.",v("sqlPracticeResultsMeta").textContent="Run check to see results.",v("sqlDiff").textContent="No diff yet.",v("sqlPracticeResults").innerHTML="";const n=this.progress.lastQuery[t]||`-- Write your SQL query here
`;this.ensureEditors(),this.cmPractice&&(this.cmPractice.setValue(n),this.cmPractice.focus()),this.renderTable(v("sqlExpectedTable"),{columns:e.expected.columns,rows:e.expected.rows,rowCount:e.expected.rows.length,truncated:!1})},normalizeResultForCompare(t,e){const i=(t.columns||[]).map(r=>String(r).toLowerCase()),s=(t.rows||[]).map(r=>r.map(n=>n===null?"NULL":typeof n=="number"?Number.isInteger(n)?String(n):parseFloat(n.toFixed(2)).toString():String(n).trim()));return{cols:i,rows:s}},diffExpected(t,e,i){const s={ok:!1,notes:[],missing:[],extra:[]},r=e.columns.map(o=>String(o).toLowerCase());if(t.cols.length!==e.columns.length)s.notes.push(`Column count mismatch: expected ${e.columns.length}, got ${t.cols.length}`);else for(let o=0;o<e.columns.length;o++)t.cols[o]!==r[o]&&s.notes.push(`Column ${o+1} mismatch: expected "${e.columns[o]}", got "${t.cols[o]}"`);const n=e.rows.map(o=>o.map(l=>l===null?"NULL":typeof l=="number"?Number.isInteger(l)?String(l):parseFloat(l.toFixed(2)).toString():String(l).trim())),a=t.rows;if(i){const o=Math.max(n.length,a.length);for(let l=0;l<o;l++){const c=n[l],h=a[l];!c&&h?s.extra.push(h):c&&!h?s.missing.push(c):c&&h&&JSON.stringify(c)!==JSON.stringify(h)&&(s.missing.push(c),s.extra.push(h))}}else{const o=h=>JSON.stringify(h),l=new Map;n.forEach(h=>l.set(o(h),(l.get(o(h))||0)+1));const c=new Map;a.forEach(h=>c.set(o(h),(c.get(o(h))||0)+1));for(const[h,d]of l.entries()){const u=c.get(h)||0;if(u<d){const p=JSON.parse(h);for(let f=0;f<d-u;f++)s.missing.push(p)}}for(const[h,d]of c.entries()){const u=l.get(h)||0;if(d>u){const p=JSON.parse(h);for(let f=0;f<d-u;f++)s.extra.push(p)}}}return s.ok=s.notes.length===0&&s.missing.length===0&&s.extra.length===0,s},renderDiff(t){const e=v("sqlDiff");if(!e)return;const i=[];t.notes.slice(0,5).forEach(s=>i.push(`<div class="diff-line"><span class="diff-tag diff-note">NOTE</span><span>${Si(s)}</span></div>`)),t.missing.slice(0,6).forEach(s=>i.push(`<div class="diff-line"><span class="diff-tag diff-missing">MISSING</span><span>${Si(JSON.stringify(s))}</span></div>`)),t.extra.slice(0,6).forEach(s=>i.push(`<div class="diff-line"><span class="diff-tag diff-extra">EXTRA</span><span>${Si(JSON.stringify(s))}</span></div>`)),i.length||i.push('<div style="color: var(--text-muted); font-weight: 800;">Perfect match âœ…</div>'),e.innerHTML=i.join("")},hintTextForError(t){const e=(t==null?void 0:t.message)||"Unknown error";return(t==null?void 0:t.hintCategory)==="missing_table"?`${e}
Tip: Check table names in the Schema tab. (customers, products, orders, order_items)`:(t==null?void 0:t.hintCategory)==="missing_column"?`${e}
Tip: Check the column list carefully. Try selecting columns that exist.`:(t==null?void 0:t.hintCategory)==="syntax"?`${e}
Tip: Look near the keyword mentioned. Missing commas, quotes, or FROM are common.`:((t==null?void 0:t.hintCategory)==="timeout"||(t==null?void 0:t.hintCategory)==="empty",e)},async onLabRun(){var t;try{await this.ensureReady();const e=this.cmLab?this.cmLab.getValue():(t=v("sqlLabEditor"))==null?void 0:t.value,i=performance.now(),s=await this.runQuery(e,{timeoutMs:1200}),r=(performance.now()-i).toFixed(1);this.renderTable(v("sqlLabResults"),s);const n=[];s.columns.length&&n.push(`${s.rowCount}${s.truncated?"+":""} row(s)`),s.rowsModified&&n.push(`${s.rowsModified} modified`),n.push(`â±ï¸ ${r}ms`),v("sqlLabResultsMeta").textContent=n.length?n.join(" â€¢ "):"Query executed.",AudioEngine.play("sql_run_success"),T("âœ… Query ran successfully!"),this.addToHistory(e),this.setTab("sqlLabTabs","sqlLabPaneResults")}catch(e){AudioEngine.play("sql_run_error"),T(`âŒ ${this.hintTextForError(e)}`,"error")}},async onLabReset(){try{await this.ensureReady(),await this.resetDbToBase(),v("sqlLabResults").innerHTML="",v("sqlLabResultsMeta").textContent="Database reset.",AudioEngine.play("reset"),T("ðŸ”„ Database reset")}catch{T("Could not reset DB.","error")}},async switchDataset(t){let e,i;switch(t){case"university":e=this.universitySchema,i=this.universitySeed;break;case"social":e=this.socialSchema,i=this.socialSeed;break;case"coffee":default:e=this.baseSchemaSql,i=this.baseSeedSql;break}try{await this.ensureReady(),await this.runQuery(`
        DROP TABLE IF EXISTS order_items;
        DROP TABLE IF EXISTS orders;
        DROP TABLE IF EXISTS products;
        DROP TABLE IF EXISTS customers;
        DROP TABLE IF EXISTS enrollments;
        DROP TABLE IF EXISTS courses;
        DROP TABLE IF EXISTS students;
        DROP TABLE IF EXISTS follows;
        DROP TABLE IF EXISTS posts;
        DROP TABLE IF EXISTS users;
      `),await this.runQuery(e+`
`+i),t==="university"?this.cmLab.setValue("SELECT * FROM students;"):t==="social"?this.cmLab.setValue("SELECT * FROM users;"):this.cmLab.setValue("SELECT * FROM products;"),T(`ðŸ“š Loaded ${t} dataset`),AudioEngine.play("success"),setTimeout(()=>this.onLabPreview(),500)}catch(s){console.error(s),T("Error switching dataset","error")}},async onLabPreview(){var t;try{await this.ensureReady();const i=`SELECT * FROM ${((t=v("sqlLabPreviewTable"))==null?void 0:t.value)||"products"} LIMIT 8;`,s=await this.runQuery(i,{timeoutMs:1200});this.renderTable(v("sqlLabPreviewResults"),s),AudioEngine.play("sql_run_success")}catch(e){AudioEngine.play("sql_run_error"),T(`âŒ ${this.hintTextForError(e)}`,"error")}},async onPracticeCheck(){var i;const t=this.currentChallengeId,e=this.challenges.find(s=>s.id===t);if(e)try{await this.ensureReady(),v("sqlPracticeStatus").textContent="Runningâ€¦";const s=this.cmPractice?this.cmPractice.getValue():(i=v("sqlPracticeEditor"))==null?void 0:i.value;this.progress.attempts[t]=(this.progress.attempts[t]||0)+1,this.progress.lastQuery[t]=s,this.saveProgress(),v("sqlAttempts").textContent=`Attempts: ${this.progress.attempts[t]||0}`;const r=await this.runQuery(s,{timeoutMs:e.difficulty==="hard"?1600:1200});this.renderTable(v("sqlPracticeResults"),r),v("sqlPracticeResultsMeta").textContent=r.columns.length?`${r.rowCount}${r.truncated?"+":""} row(s)`:"Query executed.";const n=this.normalizeResultForCompare(r),a=this.diffExpected(n,e.expected,e.expected.orderMatters);if(this.renderDiff(a),a.ok){const o=!!this.progress.solved[t];if(this.progress.solved[t]=!0,!o){const l=e.difficulty==="easy"?10:e.difficulty==="medium"?20:40;this.progress.xp=(this.progress.xp||0)+l,this.computeStreakOnSolve(),this.updateBadges()}this.saveProgress(),v("sqlPracticeStatus").textContent="Correct âœ…",v("sqlExplanationCard").style.display="block",v("sqlExplanation").textContent=e.explanation,AudioEngine.play("sql_solve_success"),ProgressManager.onSQLSolved(),v("sqlChallengeBadges").innerHTML=`
      <span class="badge ${e.difficulty==="easy"?"badge-green":e.difficulty==="medium"?"badge-amber":"badge-coral"}">${e.difficulty.toUpperCase()}</span>
      ${e.tags.map(l=>`<span class="badge badge-sky">${Si(l)}</span>`).join("")}
      <span class="badge badge-green">âœ… Solved</span>
    `,window.matchMedia("(max-width: 768px)").matches&&this.setTab("sqlPracticeTabs","sqlPracticePaneResults")}else v("sqlPracticeStatus").textContent="Not quite â€” check diff.",AudioEngine.play("sql_run_error"),T("Not quite â€” check the diff for clues.","error"),window.matchMedia("(max-width: 768px)").matches&&this.setTab("sqlPracticeTabs","sqlPracticePaneResults")}catch(s){v("sqlPracticeStatus").textContent="Error.",AudioEngine.play("sql_run_error"),T(`âŒ ${this.hintTextForError(s)}`,"error")}},onPracticeReset(){const t=this.currentChallengeId;this.challenges.find(i=>i.id===t)&&(this.loadChallenge(t),AudioEngine.play("reset"),T("ðŸ”„ Challenge reset"))},onHint(){const t=this.currentChallengeId,e=this.challenges.find(o=>o.id===t);if(!e)return;const i=v("sqlHints"),s=i.querySelectorAll(".hint-line").length,r=this.progress.attempts[t]||0;if(s===0&&r<1){T("Try once first, then unlock a hint ðŸ’¡","error");return}if(s>=e.hints.length){T("All hints already shown.","success");return}const n=e.hints[s],a=document.createElement("p");a.className="hint-line",a.style.marginBottom="0.4rem",a.innerHTML=`<strong>Hint ${s+1}:</strong> ${Si(n)}`,i.appendChild(a),AudioEngine.play("sql_hint_open")},onRevealSolution(){const t=this.currentChallengeId,e=this.challenges.find(s=>s.id===t);if(!e)return;if((this.progress.attempts[t]||0)<2){T("Try at least 2 attempts before revealing the solution ðŸ§¾","error");return}v("sqlSolution").style.display="block",v("sqlSolutionCode").textContent=e.solutionSql,AudioEngine.play("sql_hint_open")},nextChallenge(){const t=v("sqlChallengeSelect");if(!t)return;const e=this.challenges.map(r=>r.id),i=e.indexOf(t.value),s=e[(i+1)%e.length];t.value=s,this.loadChallenge(s),T("âž¡ï¸ Next challenge")},setTab(t,e){const i=v(t);if(!i)return;i.querySelectorAll(".tab-btn").forEach(n=>n.classList.toggle("active",n.dataset.target===e));const s=i.closest(".control-panel");if(!s)return;s.querySelectorAll('[id^="sqlLabPane"],[id^="sqlPracticePane"]').forEach(n=>n.classList.add("sql-pane-hidden"));const r=v(e);r==null||r.classList.remove("sql-pane-hidden")},bindUI(){var i,s,r,n,a,o,l,c,h,d,u,p;(i=v("btnSqlLabRun"))==null||i.addEventListener("click",()=>this.onLabRun()),(s=v("btnSqlLabReset"))==null||s.addEventListener("click",()=>this.onLabReset()),(r=v("btnSqlLabPreview"))==null||r.addEventListener("click",()=>this.onLabPreview()),(n=v("sqlLabPreviewTable"))==null||n.addEventListener("change",()=>this.onLabPreview()),(a=v("sqlChallengeSelect"))==null||a.addEventListener("change",f=>this.loadChallenge(f.target.value)),(o=v("btnSqlCheck"))==null||o.addEventListener("click",()=>this.onPracticeCheck()),(l=v("btnSqlReset"))==null||l.addEventListener("click",()=>this.onPracticeReset()),(c=v("btnSqlHint"))==null||c.addEventListener("click",()=>this.onHint()),(h=v("btnSqlReveal"))==null||h.addEventListener("click",()=>this.onRevealSolution()),(d=v("btnSqlNext"))==null||d.addEventListener("click",()=>this.nextChallenge());const t=v("sqlLabTabs");t==null||t.addEventListener("click",f=>{const g=f.target.closest(".tab-btn");g&&this.setTab("sqlLabTabs",g.dataset.target)});const e=v("sqlPracticeTabs");e==null||e.addEventListener("click",f=>{const g=f.target.closest(".tab-btn");g&&this.setTab("sqlPracticeTabs",g.dataset.target)}),(u=v("btnSqlLabBeautify"))==null||u.addEventListener("click",()=>this.beautifySQL()),(p=v("btnSqlLabHistory"))==null||p.addEventListener("click",()=>{const f=v("sqlHistoryDropdown");f==null||f.classList.toggle("collapsed"),this.renderHistory()}),document.addEventListener("click",f=>{var g;f.target.closest(".history-dropdown")||(g=v("sqlHistoryDropdown"))==null||g.classList.add("collapsed")})},beautifySQL(){const t=this.cmLab||v("sqlLabEditor");let e=this.cmLab?this.cmLab.getValue():(t==null?void 0:t.value)||"";["SELECT","FROM","WHERE","AND","OR","ORDER BY","GROUP BY","HAVING","JOIN","LEFT JOIN","RIGHT JOIN","INNER JOIN","ON","AS","LIMIT","OFFSET","INSERT","UPDATE","DELETE","CREATE","DROP","TABLE","VALUES","SET","INTO","NOT NULL","PRIMARY KEY","FOREIGN KEY","REFERENCES","ASC","DESC","COUNT","SUM","AVG","MAX","MIN","DISTINCT","IN","LIKE","BETWEEN","IS NULL","IS NOT NULL","CASE","WHEN","THEN","ELSE","END"].forEach(s=>{const r=new RegExp("\\b"+s.replace(/ /g,"\\s+")+"\\b","gi");e=e.replace(r,s)}),e=e.replace(/\s+(SELECT|FROM|WHERE|ORDER BY|GROUP BY|HAVING|JOIN|LEFT JOIN|RIGHT JOIN|INNER JOIN|LIMIT)\s+/gi,(s,r)=>`
`+r.toUpperCase()+" "),e=e.trim().replace(/\n\s*\n/g,`
`),this.cmLab?this.cmLab.setValue(e):t&&(t.value=e),T("âœ¨ SQL beautified!")},queryHistory:JSON.parse(localStorage.getItem("cse-helper-sql-history")||"[]"),addToHistory(t){const e=t.trim();e&&(this.queryHistory=this.queryHistory.filter(i=>i!==e),this.queryHistory.unshift(e),this.queryHistory=this.queryHistory.slice(0,10),localStorage.setItem("cse-helper-sql-history",JSON.stringify(this.queryHistory)))},renderHistory(){const t=v("sqlHistoryList");if(t){if(this.queryHistory.length===0){t.innerHTML='<div style="color: var(--text-muted); padding: 0.5rem">No queries yet</div>';return}t.innerHTML=this.queryHistory.map((e,i)=>`
      <div class="history-item" style="
        padding: 0.5rem;
        cursor: pointer;
        border-bottom: 1px solid var(--border-soft);
        white-space: nowrap;
        overflow: hidden;
        text-overflow: ellipsis;
      " onclick="SQLModule.loadFromHistory(${i})" title="${Si(e)}">
        ${Si(e.substring(0,50))}${e.length>50?"...":""}
      </div>
    `).join("")}},loadFromHistory(t){var i;const e=this.queryHistory[t];if(e){if(this.cmLab)this.cmLab.setValue(e);else{const s=v("sqlLabEditor");s&&(s.value=e)}(i=v("sqlHistoryDropdown"))==null||i.classList.add("collapsed"),T("ðŸ“œ Query loaded from history")}}};function Si(t){return String(t).replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;").replace(/'/g,"&#039;")}typeof window<"u"&&(window.SQLModule=Et);const Zt=t=>document.getElementById(t),q2={usedQueries:new Set,async init(){var t,e,i;await Et.ensureReady(),this.refreshTable(),this.usedQueries.clear(),(t=Zt("btnSqlVizRun"))==null||t.addEventListener("click",()=>this.executeQuery()),(e=Zt("btnSqlVizReset"))==null||e.addEventListener("click",()=>this.resetData()),(i=Zt("sqlVizTableSelect"))==null||i.addEventListener("change",()=>this.refreshTable()),this.bindQueryButtons()},bindQueryButtons(){document.querySelectorAll("#sqlQueryButtons [data-query]").forEach(e=>{e.addEventListener("click",()=>{const i=e.dataset.query;this.addQueryTemplate(i,e)})})},getQueryTemplate(t){var r;const e=((r=Zt("sqlVizTableSelect"))==null?void 0:r.value)||"products",i=Math.floor(Math.random()*8999)+1e3;return{select:`SELECT * FROM ${e} WHERE id = 1;`,insert:`INSERT INTO ${e} (id, name, category, price_cents) VALUES (${i}, 'New Item ${i}', 'Category', 100);`,update:`UPDATE ${e} SET name = 'Updated Name' WHERE id = 1;`,delete:`DELETE FROM ${e} WHERE id = 999;`}[t]||""},addQueryTemplate(t,e){const i=Zt("sqlVizEditor");if(!i)return;const s=this.getQueryTemplate(t),r=i.value.trim();r?i.value=r+`

`+s:i.value=s,this.usedQueries.add(t);const n=Zt("sqlQueryNote");if(n){n.style.display="block";const a=4-this.usedQueries.size;n.textContent=a>0?`âœ… ${t.toUpperCase()} added! ${a} query type(s) remaining.`:"ðŸŽ‰ All query types added! Execute them now."}O.play("sql_hint_open"),T(`âž• ${t.toUpperCase()} template added!`)},async executeQuery(){var i;const t=Zt("sqlVizEditor"),e=(i=t==null?void 0:t.value)==null?void 0:i.trim();if(!e){this.showStatus("âš ï¸ Please enter a SQL query","warning");return}T("â³ Executing query...","info"),this.showStatus("â³ Executing...","info");try{await Et.ensureReady();const s=await Et.runQuery(e,{timeoutMs:2e3});this.showStatus(`âœ… Query executed! ${s.rowsModified?s.rowsModified+" rows affected":""}`,"success"),O.play("sql_run_success");const r=Zt("sqlVizTableContainer");r==null||r.classList.add("success-highlight"),setTimeout(()=>r==null?void 0:r.classList.remove("success-highlight"),1e3)}catch(s){this.showStatus(`âŒ ${s.message||"Invalid SQL query"}`,"error"),O.play("sql_run_error"),t==null||t.classList.add("shake-error"),setTimeout(()=>t==null?void 0:t.classList.remove("shake-error"),500)}finally{setTimeout(()=>this.refreshTable(),100)}},async resetData(){try{await Et.ensureReady(),await Et.resetDbToBase(),this.refreshTable(),this.showStatus("ðŸ”„ Database reset to original data","success"),T("ðŸ”„ Database reset!")}catch(t){this.showStatus(`âŒ ${t.message}`,"error")}},async refreshTable(){var t;try{const e=((t=Zt("sqlVizTableSelect"))==null?void 0:t.value)||"products";await Et.ensureReady();const i=await Et.runQuery(`SELECT * FROM ${e} LIMIT 50`,{timeoutMs:1e3});Et.renderTable(Zt("sqlVizTable"),i)}catch{Zt("sqlVizTable").innerHTML='<div style="padding: 1rem; color: var(--accent-coral)">Error loading table</div>'}},showStatus(t,e){const i=Zt("sqlVizStatus");i&&(i.style.display="block",i.textContent=t,i.style.background=e==="success"?"rgba(47, 106, 87, 0.15)":e==="error"?"rgba(212, 89, 63, 0.15)":"rgba(196, 148, 42, 0.15)",i.style.color=e==="success"?"var(--accent-forest)":e==="error"?"var(--accent-coral)":"var(--accent-amber)")}};typeof window<"u"&&(window.SQLVisualizer=q2);const I=t=>document.getElementById(t),j0={challengePool:[{id:"dc_sql_001",type:"sql",difficulty:"easy",title:"Find All Products",description:"Write a query to select all columns from the products table.",expectedQuery:"SELECT * FROM products",hints:["Use SELECT with *","The table name is 'products'"],xp:30},{id:"dc_sql_002",type:"sql",difficulty:"medium",title:"Top Spenders",description:"Find the total spending per customer. Show customer_id and total.",expectedQuery:"SELECT customer_id, SUM(total_cents) as total FROM orders GROUP BY customer_id",hints:["Use SUM() for totals","GROUP BY customer_id"],xp:50},{id:"dc_sql_003",type:"sql",difficulty:"hard",title:"Never Ordered",description:"Find customers who have never placed an order.",expectedQuery:"SELECT * FROM customers WHERE id NOT IN (SELECT customer_id FROM orders)",hints:["Use a subquery","NOT IN can filter out matches"],xp:75},{id:"dc_complexity_001",type:"complexity",difficulty:"easy",title:"Time Complexity Match",description:"Match each algorithm to its average time complexity.",content:{algorithms:["Binary Search","Bubble Sort","Merge Sort"],complexities:["O(log n)","O(nÂ²)","O(n log n)"],answers:[0,1,2]},hints:["Binary search halves the search space","Bubble sort has nested loops"],xp:40},{id:"dc_complexity_002",type:"complexity",difficulty:"medium",title:"Code Analysis",description:"What is the time complexity of this code?",content:{code:`for (let i = 0; i < n; i++) {
  for (let j = i; j < n; j++) {
    console.log(i, j);
  }
}`,options:["O(n)","O(n log n)","O(nÂ²)","O(2^n)"],answer:2},hints:["Count the nested loops","Inner loop depends on outer"],xp:50},{id:"dc_trace_001",type:"trace",difficulty:"easy",title:"Bubble Sort Step",description:"After one complete pass of Bubble Sort on [5, 2, 8, 1], what is the resulting array?",content:{initial:[5,2,8,1],options:["[2, 5, 1, 8]","[1, 2, 5, 8]","[2, 1, 5, 8]","[5, 2, 1, 8]"],answer:0},hints:["Bubble sort swaps adjacent elements","Largest element bubbles to the end"],xp:35},{id:"dc_trace_002",type:"trace",difficulty:"medium",title:"Quick Sort Pivot",description:"Using last element as pivot on [3, 7, 2, 5], what are the elements less than pivot (5)?",content:{initial:[3,7,2,5],options:["[3, 2]","[3, 7, 2]","[7]","[3, 2, 5]"],answer:0},hints:["Pivot is 5","Compare each element to pivot"],xp:50}],state:null,init(){this.loadState(),this.renderChallenge(),this.renderCalendar(),this.updateStats(),this.startCountdown(),this.bindEvents()},loadState(){const t=localStorage.getItem("dailyChallengeState"),e=this.getDateString();t?(this.state=JSON.parse(t),this.state.lastDate!==e&&(this.state.todayCompleted=!1,this.state.todayChallengeId=this.pickTodaysChallenge(),this.state.lastDate=e,this.state.hintUsed=!1,this.saveState())):(this.state={streak:0,totalCompleted:0,completedDates:{},todayCompleted:!1,todayChallengeId:this.pickTodaysChallenge(),lastDate:e,hintUsed:!1},this.saveState())},saveState(){localStorage.setItem("dailyChallengeState",JSON.stringify(this.state))},getDateString(t=new Date){return t.toISOString().split("T")[0]},pickTodaysChallenge(){const t=new Date,i=(t.getFullYear()*1e4+(t.getMonth()+1)*100+t.getDate())%this.challengePool.length;return this.challengePool[i].id},getTodaysChallenge(){return this.challengePool.find(t=>t.id===this.state.todayChallengeId)},renderChallenge(){const t=this.getTodaysChallenge();if(!t)return;const e={easy:"var(--accent-sage)",medium:"var(--accent-amber)",hard:"var(--accent-coral)"},i={sql:"SQL Query",complexity:"Time Complexity",trace:"Algorithm Trace"};I("dailyChallengeBadge").textContent=t.difficulty.charAt(0).toUpperCase()+t.difficulty.slice(1),I("dailyChallengeBadge").style.background=e[t.difficulty],I("dailyChallengeType").textContent=i[t.type],I("dailyChallengeTitle").textContent=t.title,I("dailyChallengeDesc").textContent=t.description;const s=I("dailyChallengeContent"),r=I("dailyChallengeInput");if(this.state.todayCompleted){s.innerHTML=`<div style="text-align: center; padding: 2rem;">
        <span style="font-size: 4rem">ðŸŽ‰</span>
        <h3 style="color: var(--accent-forest); margin: 1rem 0">Challenge Complete!</h3>
        <p>Come back tomorrow for a new challenge.</p>
      </div>`,r.innerHTML="",I("btnDailySubmit").disabled=!0,I("btnDailySubmit").textContent="âœ“ Completed";return}t.type==="sql"?(s.innerHTML='<p style="color: var(--text-muted); font-size: 0.9rem">Write your SQL query below:</p>',r.innerHTML=`<textarea id="dailySqlInput" rows="4" style="
        width: 100%; font-family: 'JetBrains Mono', monospace;
        padding: 1rem; border: 2px solid var(--border-soft);
        border-radius: 8px; background: var(--bg-paper);
      " placeholder="SELECT ..."></textarea>`):t.type==="complexity"?t.content.code?(s.innerHTML=`<pre style="background: #1e1e1e; color: #d4d4d4; padding: 1rem; border-radius: 8px; overflow-x: auto;">${t.content.code}</pre>`,r.innerHTML=t.content.options.map((n,a)=>`<label style="display: block; padding: 0.75rem; margin: 0.5rem 0; background: var(--bg-card); border: 2px solid var(--border-soft); border-radius: 8px; cursor: pointer;">
            <input type="radio" name="dailyComplexity" value="${a}" style="margin-right: 0.75rem"> ${n}
          </label>`).join("")):(s.innerHTML=`<div style="display: flex; gap: 2rem;">
          <div><strong>Algorithms:</strong><br>${t.content.algorithms.map((n,a)=>`<div style="padding: 0.5rem 0">${a+1}. ${n}</div>`).join("")}</div>
          <div><strong>Complexities:</strong><br>${t.content.complexities.map((n,a)=>`<div style="padding: 0.5rem 0">${String.fromCharCode(65+a)}. ${n}</div>`).join("")}</div>
        </div>`,r.innerHTML=`<p style="margin: 1rem 0">Match each algorithm (1, 2, 3) to its complexity (A, B, C):</p>
          <input id="dailyMatchInput" type="text" placeholder="e.g., 1A, 2B, 3C" style="width: 100%; padding: 0.75rem; border: 2px solid var(--border-soft); border-radius: 8px;">`):t.type==="trace"&&(s.innerHTML=`<div style="text-align: center;">
        <p>Initial array:</p>
        <div style="display: flex; gap: 0.5rem; justify-content: center; margin: 1rem 0;">
          ${t.content.initial.map(n=>`<span style="width: 40px; height: 40px; display: flex; align-items: center; justify-content: center; background: var(--accent-forest); color: white; border-radius: 8px; font-weight: 600;">${n}</span>`).join("")}
        </div>
      </div>`,r.innerHTML=t.content.options.map((n,a)=>`<label style="display: block; padding: 0.75rem; margin: 0.5rem 0; background: var(--bg-card); border: 2px solid var(--border-soft); border-radius: 8px; cursor: pointer;">
          <input type="radio" name="dailyTrace" value="${a}" style="margin-right: 0.75rem"> ${n}
        </label>`).join(""))},bindEvents(){var t,e,i;(t=I("btnDailySubmit"))==null||t.addEventListener("click",()=>this.submitAnswer()),(e=I("btnDailyHint"))==null||e.addEventListener("click",()=>this.showHint()),(i=I("btnDailySkip"))==null||i.addEventListener("click",()=>this.skipChallenge())},async submitAnswer(){var i,s,r,n;const t=this.getTodaysChallenge();let e=!1;if(t.type==="sql"){const a=(s=(i=I("dailySqlInput"))==null?void 0:i.value)==null?void 0:s.trim().toUpperCase().replace(/\s+/g," "),o=t.expectedQuery.toUpperCase().replace(/\s+/g," ");e=a===o||a.includes(o.split(" ").slice(0,3).join(" "))}else if(t.type==="complexity")if(t.content.code){const a=document.querySelector('input[name="dailyComplexity"]:checked');e=a&&parseInt(a.value)===t.content.answer}else{const a=(n=(r=I("dailyMatchInput"))==null?void 0:r.value)==null?void 0:n.toUpperCase().replace(/\s/g,""),o=t.content.answers.map((l,c)=>`${c+1}${String.fromCharCode(65+l)}`).join(",");e=a===o}else if(t.type==="trace"){const a=document.querySelector('input[name="dailyTrace"]:checked');e=a&&parseInt(a.value)===t.content.answer}e?await this.completeChallenge(t):this.showError()},async completeChallenge(t){const e=this.getDateString(),i=this.state.hintUsed?Math.floor(t.xp*.7):t.xp,s=this.getDateString(new Date(Date.now()-864e5));this.state.completedDates[s]?this.state.streak++:this.state.completedDates[e]||(this.state.streak=1),this.state.todayCompleted=!0,this.state.totalCompleted++,this.state.completedDates[e]=this.state.hintUsed?"completed":"perfect",this.saveState(),typeof ProgressTracker<"u"&&ProgressTracker.addXP(i),O==null||O.play("challenge_complete"),T(`ðŸŽ‰ +${i} XP! Streak: ${this.state.streak} days`),this.renderChallenge(),this.renderCalendar(),this.updateStats()},showError(){const t=I("dailyChallengeCard");t==null||t.classList.add("shake-error"),setTimeout(()=>t==null?void 0:t.classList.remove("shake-error"),500),O==null||O.play("error"),T("âŒ Not quite right. Try again!")},showHint(){var i,s;const t=this.getTodaysChallenge();if(!((i=t==null?void 0:t.hints)!=null&&i.length))return;const e=this.state.hintUsed?Math.min(1,t.hints.length-1):0;I("dailyHintText").textContent=t.hints[e],(s=I("dailyHintBox"))==null||s.classList.remove("collapsed"),this.state.hintUsed=!0,this.saveState()},skipChallenge(){if(confirm("Skip today's challenge? You won't earn XP but your streak will be preserved with a freeze.")){const t=this.getDateString();this.state.completedDates[t]="skipped",this.state.todayCompleted=!0,this.saveState(),this.renderChallenge(),this.renderCalendar(),T("â­ï¸ Challenge skipped. Streak preserved!")}},updateStats(){I("dailyStreakCount").textContent=this.state.streak,I("dailyChallengesCompleted").textContent=this.state.totalCompleted},renderCalendar(){const t=I("dailyCalendar");if(!t)return;const e=new Date,s=new Date(e.getFullYear(),e.getMonth(),1).getDay(),r=new Date(e.getFullYear(),e.getMonth()+1,0).getDate();let a=["Sun","Mon","Tue","Wed","Thu","Fri","Sat"].map(o=>`<div style="font-weight: 600; color: var(--text-muted); padding: 0.5rem;">${o}</div>`).join("");for(let o=0;o<s;o++)a+="<div></div>";for(let o=1;o<=r;o++){const l=`${e.getFullYear()}-${String(e.getMonth()+1).padStart(2,"0")}-${String(o).padStart(2,"0")}`,c=this.state.completedDates[l],h=o===e.getDate();let d="",u="transparent";c==="perfect"?(d="â­",u="rgba(196, 148, 42, 0.2)"):c==="completed"?(d="ðŸ”¥",u="rgba(212, 89, 63, 0.2)"):c==="skipped"&&(d="â„ï¸",u="rgba(61, 122, 148, 0.2)"),a+=`<div style="
        padding: 0.5rem;
        border-radius: 8px;
        background: ${u};
        ${h?"border: 2px solid var(--accent-coral);":""}
      ">${d||o}</div>`}t.innerHTML=a},startCountdown(){const t=()=>{const e=new Date,s=new Date(e.getFullYear(),e.getMonth(),e.getDate()+1)-e,r=Math.floor(s/36e5),n=Math.floor(s%36e5/6e4),a=Math.floor(s%6e4/1e3);I("dailyCountdown").textContent=`${r}:${String(n).padStart(2,"0")}:${String(a).padStart(2,"0")}`};t(),setInterval(t,1e3)}};var Og;const pg=(Og=UI.setSection)==null?void 0:Og.bind(UI);pg&&(UI.setSection=function(t){pg(t),t==="daily-challenge"&&j0.init(),t==="algorithm-race"&&(window.AlgorithmRace||B2).init(),t==="quiz-mode"&&F0.init(),t==="dashboard"&&W0.showDashboard()});const W0={currentCourse:null,courseConfig:{cse220:{name:"CSE 220: Data Structures",sections:["ds-array","ds-stack","ds-queue","ds-linkedlist","ds-tree","ds-hash","ds-heap","ds-graph","ds-sandbox","story-bigo","recursion-story","quiz-mode","electure-datastructures"],icon:"ðŸ“š",color:"#06b6d4"},cse221:{name:"CSE 221: Algorithms",sections:["algorithms","searching","pathfinding","algorithm-race","divide-conquer","dp","greedy","algorithm-sandbox","quiz-mode","electure-algorithms"],icon:"âš¡",color:"#f59e0b"},cse370:{name:"CSE 370: Database Systems",sections:["sql-lab","sql-practice","sql-lesson","sql-visualizer","quiz-mode","electure-sql"],icon:"ðŸ—„ï¸",color:"#8b5cf6"}},init(){localStorage.removeItem("cse-helper-lastSection"),this.bindEvents(),document.querySelectorAll("[id^='section-']").forEach(t=>{t.classList.add("section-hidden")}),this.showDashboard()},bindEvents(){var t,e,i;document.querySelectorAll(".course-card").forEach(s=>{s.addEventListener("click",()=>{const r=s.dataset.course;r&&this.enterCourse(r)})}),(t=I("sidebarLogo"))==null||t.addEventListener("click",()=>this.showDashboard()),(e=I("courseBackBtn"))==null||e.addEventListener("click",()=>this.showDashboard()),(i=I("btnDashboardDaily"))==null||i.addEventListener("click",()=>{UI.setSection("daily-challenge")})},showDashboard(){var e,i;this.currentCourse=null,document.querySelectorAll("[id^='section-']").forEach(s=>{s.classList.add("section-hidden")});const t=I("section-dashboard");t&&(t.classList.remove("section-hidden"),t.classList.add("page-slide-in")),(e=I("sidebar"))==null||e.classList.add("sidebar-hidden"),(i=I("mainContent"))==null||i.classList.add("dashboard-fullwidth")},enterCourse(t){const e=this.courseConfig[t];if(!e)return;this.currentCourse=t;const i=I("section-dashboard");i&&(i.style.opacity="1",i.style.transition="opacity 0.3s ease-out, transform 0.3s ease-out",i.style.opacity="0",i.style.transform="scale(0.98)"),setTimeout(()=>{var n;i&&(i.classList.add("section-hidden"),i.style.opacity="",i.style.transform="",i.style.transition="");const s=I("sidebar");s&&(s.style.transform="translateX(-100%)",s.classList.remove("sidebar-hidden"),s.style.transition="transform 0.4s cubic-bezier(0.4, 0, 0.2, 1)",requestAnimationFrame(()=>{s.style.transform="translateX(0)"}),setTimeout(()=>{s.style.transform="",s.style.transition=""},400)),(n=I("mainContent"))==null||n.classList.remove("dashboard-fullwidth"),this.filterNavbar(t);const r=e.sections[0];setTimeout(()=>{UI.setSection(r);const a=I(`section-${r}`);a&&(a.style.opacity="0",a.style.transform="translateX(20px)",a.classList.remove("section-hidden"),a.style.transition="opacity 0.4s ease-out, transform 0.4s ease-out",requestAnimationFrame(()=>{a.style.opacity="1",a.style.transform="translateX(0)"}),setTimeout(()=>{a.style.opacity="",a.style.transform="",a.style.transition=""},400))},100),T(`ðŸ“– Entering ${e.name}`),O==null||O.play("success")},300)},filterNavbar(t){const e=this.courseConfig[t];e&&(document.querySelectorAll(".nav-item[data-section]").forEach(i=>{const s=i.dataset.section;if(s==="quiz-mode"){i.classList.remove("sidebar-hidden");return}e.sections.includes(s)?i.classList.remove("sidebar-hidden"):i.classList.add("sidebar-hidden")}),document.querySelectorAll(".nav-section").forEach(i=>{i.querySelectorAll(".nav-item:not(.sidebar-hidden)").length===0?i.classList.add("sidebar-hidden"):i.classList.remove("sidebar-hidden")}))},resetNavbar(){document.querySelectorAll(".nav-item, .nav-section").forEach(t=>{t.classList.remove("sidebar-hidden")})}};W0.init();const F0={questions:{sorting:[{q:"What is the time complexity of Bubble Sort?",o:["O(n)","O(nÂ²)","O(log n)","O(n log n)"],a:1,e:"Bubble Sort uses nested loops, comparing adjacent elements."},{q:"Which sorting algorithm uses 'divide and conquer'?",o:["Bubble Sort","Selection Sort","Merge Sort","Insertion Sort"],a:2,e:"Merge Sort divides the array in half recursively."},{q:"What is the best-case time complexity of Quick Sort?",o:["O(n)","O(n log n)","O(nÂ²)","O(log n)"],a:1,e:"Best case occurs when pivot divides array evenly."},{q:"Which sort is stable?",o:["Quick Sort","Heap Sort","Merge Sort","Selection Sort"],a:2,e:"Merge Sort preserves relative order of equal elements."},{q:"Insertion Sort is best for:",o:["Large random arrays","Nearly sorted arrays","Reversed arrays","Arrays with duplicates"],a:1,e:"Nearly sorted arrays require few swaps."},{q:"What does 'in-place' sorting mean?",o:["Uses recursion","Requires O(1) extra space","Is stable","Uses O(n) space"],a:1,e:"In-place uses constant extra memory."},{q:"Heap Sort uses which data structure?",o:["Stack","Queue","Binary Heap","BST"],a:2,e:"Heap Sort builds a max/min heap."},{q:"Selection Sort finds the _____ element each pass.",o:["First","Middle","Minimum/Maximum","Random"],a:2,e:"It selects the min/max and places it correctly."},{q:"After one pass of Bubble Sort on [5,3,8,1], largest element is at:",o:["Start","Middle","End","Random position"],a:2,e:"Bubble Sort bubbles largest to the end."},{q:"Quick Sort worst case occurs when:",o:["Array is random","Pivot is always median","Array is already sorted","Array has duplicates"],a:2,e:"Sorted arrays with first/last pivot give O(nÂ²)."}],complexity:[{q:"O(1) means:",o:["Linear time","Constant time","Logarithmic time","Quadratic time"],a:1,e:"O(1) takes the same time regardless of input size."},{q:"Binary Search has complexity:",o:["O(n)","O(nÂ²)","O(log n)","O(1)"],a:2,e:"Binary Search halves the search space each step."},{q:"Which is faster for large n: O(n) or O(log n)?",o:["O(n)","O(log n)","Same","Depends on data"],a:1,e:"O(log n) grows much slower than O(n)."},{q:"Nested loops usually indicate:",o:["O(n)","O(log n)","O(nÂ²)","O(1)"],a:2,e:"Two nested loops each running n times = O(nÂ²)."},{q:"What is O(n!) typically seen in?",o:["Sorting","Searching","Permutations","Tree traversal"],a:2,e:"Generating all permutations is O(n!)."},{q:"Fibonacci recursive (naive) is:",o:["O(n)","O(log n)","O(2^n)","O(nÂ²)"],a:2,e:"Naive recursion has exponential time due to repeated work."},{q:"Hash table lookup is typically:",o:["O(n)","O(log n)","O(1)","O(nÂ²)"],a:2,e:"Good hash functions give constant time average."},{q:"What does 'amortized' mean?",o:["Worst case","Average over many operations","Best case","Space complexity"],a:1,e:"Amortized analysis averages cost over sequences."},{q:"Tree traversal is:",o:["O(1)","O(log n)","O(n)","O(nÂ²)"],a:2,e:"Must visit each node once = O(n)."},{q:"Merge Sort space complexity:",o:["O(1)","O(log n)","O(n)","O(nÂ²)"],a:2,e:"Merge Sort needs auxiliary array of size n."}],sql:[{q:"SELECT * FROM users means:",o:["Select all columns","Select all rows with filter","Delete all","Update all"],a:0,e:"* is a wildcard for all columns."},{q:"WHERE clause is for:",o:["Sorting","Filtering rows","Grouping","Joining"],a:1,e:"WHERE filters rows based on conditions."},{q:"GROUP BY is used with:",o:["WHERE only","Aggregate functions","ORDER BY only","INSERT"],a:1,e:"GROUP BY groups rows for aggregation like COUNT, SUM."},{q:"INNER JOIN returns:",o:["All rows from both tables","Matching rows only","All rows from left","All rows from right"],a:1,e:"INNER JOIN returns only matching rows."},{q:"COUNT(*) counts:",o:["Only non-null values","All rows","Distinct values","Columns"],a:1,e:"COUNT(*) counts all rows including nulls."},{q:"ORDER BY default is:",o:["Descending","Ascending","Random","By ID"],a:1,e:"ORDER BY defaults to ASC (ascending)."},{q:"LEFT JOIN includes:",o:["All right rows","Matching rows only","All left rows + matches","No nulls"],a:2,e:"LEFT JOIN keeps all left table rows."},{q:"HAVING filters:",o:["Before grouping","After grouping","Same as WHERE","Columns"],a:1,e:"HAVING filters groups after GROUP BY."},{q:"DISTINCT removes:",o:["Nulls","Duplicates","Empty strings","Zeros"],a:1,e:"DISTINCT returns unique values only."},{q:"PRIMARY KEY is:",o:["Always auto-increment","Unique identifier","Foreign key","Optional"],a:1,e:"PRIMARY KEY uniquely identifies each row."},{q:"Which returns all rows from both tables?",o:["INNER JOIN","LEFT JOIN","FULL OUTER JOIN","CROSS JOIN"],a:2,e:"FULL OUTER JOIN returns all rows from both."},{q:"NULL = NULL returns:",o:["TRUE","FALSE","NULL","Error"],a:2,e:"NULL comparisons return NULL, use IS NULL."},{q:"LIMIT 10 does:",o:["Skips 10 rows","Returns max 10 rows","Selects column 10","Deletes 10"],a:1,e:"LIMIT restricts result row count."},{q:"AVG() ignores:",o:["Zeros","NULL values","Negatives","Strings"],a:1,e:"AVG and other aggregates ignore NULLs."},{q:"Subquery is:",o:["Nested SELECT","Stored procedure","View","Trigger"],a:0,e:"Subquery is a SELECT inside another query."}],ds:[{q:"Stack uses which ordering?",o:["FIFO","LIFO","Random","Priority"],a:1,e:"Stack is Last-In-First-Out."},{q:"Queue uses which ordering?",o:["LIFO","FIFO","Random","Sorted"],a:1,e:"Queue is First-In-First-Out."},{q:"Binary Search Tree lookup is:",o:["O(1)","O(log n) average","O(nÂ²)","O(n!)"],a:1,e:"BST lookup is O(log n) for balanced trees."},{q:"Linked List insertion at head is:",o:["O(n)","O(log n)","O(1)","O(nÂ²)"],a:2,e:"Just update the head pointer = O(1)."},{q:"Array random access is:",o:["O(n)","O(log n)","O(1)","O(nÂ²)"],a:2,e:"Arrays support O(1) index access."},{q:"Which is NOT a tree traversal?",o:["Inorder","Preorder","Postorder","Linear"],a:3,e:"Linear is not a tree traversal method."},{q:"Min-Heap root contains:",o:["Maximum","Minimum","Average","Random"],a:1,e:"Min-Heap has smallest element at root."},{q:"Graph BFS uses:",o:["Stack","Queue","Heap","Array"],a:1,e:"BFS uses queue for level-order traversal."},{q:"Graph DFS uses:",o:["Queue","Heap","Stack/Recursion","Linked List"],a:2,e:"DFS uses stack (or recursion)."},{q:"Hash table collision handling:",o:["Ignore","Chaining or Probing","Delete","Sort"],a:1,e:"Collisions use chaining or open addressing."},{q:"Trie is best for:",o:["Numbers","Prefix/string search","Graphs","Sorting"],a:1,e:"Trie excels at prefix-based string lookup."},{q:"Doubly linked list has:",o:["One pointer","Two pointers per node","No pointers","Array indices"],a:1,e:"Each node has next AND prev pointers."}]},currentQuiz:[],currentIndex:0,answers:[],score:0,selectedAnswer:null,startTime:null,questionStartTime:null,timerInterval:null,init(){this.bindEvents(),this.showSelection()},bindEvents(){var t,e,i,s,r,n;document.querySelectorAll(".quiz-topic-btn").forEach(a=>{a.addEventListener("click",()=>this.startQuiz(a.dataset.topic))}),(t=I("btnQuizRandom"))==null||t.addEventListener("click",()=>this.startQuiz("random")),(e=I("btnQuizSubmit"))==null||e.addEventListener("click",()=>this.submitAnswer()),(i=I("btnQuizSkip"))==null||i.addEventListener("click",()=>this.nextQuestion()),(s=I("btnQuizNext"))==null||s.addEventListener("click",()=>this.nextQuestion()),(r=I("btnQuizRetry"))==null||r.addEventListener("click",()=>this.startQuiz(this.lastTopic)),(n=I("btnQuizNewTopic"))==null||n.addEventListener("click",()=>this.showSelection())},showSelection(){var t,e,i,s;(t=I("quizSelection"))==null||t.classList.remove("collapsed"),(e=I("quizQuestionCard"))==null||e.classList.add("collapsed"),(i=I("quizFeedback"))==null||i.classList.add("collapsed"),(s=I("quizResults"))==null||s.classList.add("collapsed")},startQuiz(t){var i,s;this.lastTopic=t;let e=[];t==="random"?e=[...this.questions.sorting,...this.questions.complexity,...this.questions.sql,...this.questions.ds]:e=[...this.questions[t]],this.currentQuiz=e.sort(()=>Math.random()-.5).slice(0,10),this.currentIndex=0,this.answers=[],this.score=0,this.startTime=Date.now(),(i=I("quizSelection"))==null||i.classList.add("collapsed"),(s=I("quizResults"))==null||s.classList.add("collapsed"),this.showQuestion()},showQuestion(){var e,i;if(this.currentIndex>=this.currentQuiz.length){this.showResults();return}(e=I("quizQuestionCard"))==null||e.classList.remove("collapsed"),(i=I("quizFeedback"))==null||i.classList.add("collapsed");const t=this.currentQuiz[this.currentIndex];I("quizProgress").textContent=`Question ${this.currentIndex+1} of ${this.currentQuiz.length}`,I("quizProgressBar").style.width=`${(this.currentIndex+1)/this.currentQuiz.length*100}%`,I("quizQuestion").textContent=t.q,I("quizOptions").innerHTML=t.o.map((s,r)=>`<label class="quiz-option" style="display: flex; align-items: center; padding: 1rem; background: var(--bg-card); border: 2px solid var(--border-soft); border-radius: 8px; cursor: pointer; transition: all 0.2s;">
        <input type="radio" name="quizAnswer" value="${r}" style="margin-right: 1rem; width: 18px; height: 18px;">
        <span>${s}</span>
      </label>`).join(""),this.selectedAnswer=null,I("btnQuizSubmit").disabled=!0,document.querySelectorAll('input[name="quizAnswer"]').forEach(s=>{s.addEventListener("change",r=>{this.selectedAnswer=parseInt(r.target.value),I("btnQuizSubmit").disabled=!1,document.querySelectorAll(".quiz-option").forEach(n=>n.style.borderColor="var(--border-soft)"),r.target.closest(".quiz-option").style.borderColor="#8B5CF6"})}),this.questionStartTime=Date.now(),this.startTimer(30)},startTimer(t){clearInterval(this.timerInterval);let e=t;I("quizTimer").textContent=`â±ï¸ 0:${String(e).padStart(2,"0")}`,this.timerInterval=setInterval(()=>{e--,I("quizTimer").textContent=`â±ï¸ 0:${String(e).padStart(2,"0")}`,e<=0&&(clearInterval(this.timerInterval),this.submitAnswer(!0))},1e3)},submitAnswer(t=!1){var s,r;clearInterval(this.timerInterval);const e=this.currentQuiz[this.currentIndex],i=!t&&this.selectedAnswer===e.a;i&&this.score++,this.answers.push({question:this.currentIndex,correct:i,time:Date.now()-this.questionStartTime}),(s=I("quizQuestionCard"))==null||s.classList.add("collapsed"),(r=I("quizFeedback"))==null||r.classList.remove("collapsed"),i?(I("quizFeedbackIcon").textContent="âœ…",I("quizFeedbackTitle").textContent="Correct!",I("quizFeedbackTitle").style.color="var(--accent-forest)",I("quizFeedbackXP").textContent="+10 XP",O==null||O.play("success")):(I("quizFeedbackIcon").textContent="âŒ",I("quizFeedbackTitle").textContent=t?"Time's up!":"Not quite...",I("quizFeedbackTitle").style.color="var(--accent-coral)",I("quizFeedbackXP").textContent=`Correct: ${e.o[e.a]}`,O==null||O.play("error")),I("quizFeedbackText").textContent=e.e},nextQuestion(){this.currentIndex++,this.showQuestion()},showResults(){var a,o,l;(a=I("quizQuestionCard"))==null||a.classList.add("collapsed"),(o=I("quizFeedback"))==null||o.classList.add("collapsed"),(l=I("quizResults"))==null||l.classList.remove("collapsed");const t=this.currentQuiz.length,e=Math.round(this.score/t*100),i=this.score*10,s=Math.round((Date.now()-this.startTime)/1e3),r=(s/t).toFixed(1);I("quizScoreDisplay").textContent=`${this.score}/${t}`,I("quizScoreDisplay").style.color=e>=70?"var(--accent-forest)":"var(--accent-coral)";const n=Math.min(5,Math.floor(e/20)+1);I("quizStars").textContent="â­".repeat(n)+"â˜†".repeat(5-n),I("quizXPEarned").textContent=`+${i} XP earned!`,I("quizTimeSpent").textContent=`Time: ${Math.floor(s/60)}:${String(s%60).padStart(2,"0")}`,I("quizAvgTime").textContent=`Avg: ${r}s/question`,typeof ProgressTracker<"u"&&ProgressTracker.addXP(i),O==null||O.play("challenge_complete"),T(`ðŸ§  Quiz complete! Score: ${this.score}/${t} (+${i} XP)`)}},D2={currentLang:"python",currentAlgo:"bubble",originalArray:[],currentArray:[],steps:[],stepIndex:0,playing:!1,timer:null,stats:{comparisons:0,swaps:0},codeTemplates:{bubble:{js:`function bubbleSort(arr) {
  const n = arr.length;
  for (let i = 0; i < n - 1; i++) {
    for (let j = 0; j < n - i - 1; j++) {
      if (arr[j] > arr[j + 1]) {
        // Swap
        [arr[j], arr[j+1]] = [arr[j+1], arr[j]];
      }
    }
  }
  return arr;
}`,python:`def bubble_sort(arr):
    n = len(arr)
    for i in range(n - 1):
        for j in range(n - i - 1):
  if arr[j] > arr[j + 1]:
      # Swap
      arr[j], arr[j+1] = arr[j+1], arr[j]
    return arr`,java:`void bubbleSort(int[] arr) {
    int n = arr.length;
    for (int i = 0; i < n - 1; i++) {
        for (int j = 0; j < n - i - 1; j++) {
  if (arr[j] > arr[j + 1]) {
      // Swap
      int temp = arr[j];
      arr[j] = arr[j + 1];
      arr[j + 1] = temp;
  }
        }
    }
}`},insertion:{js:`function insertionSort(arr) {
  for (let i = 1; i < arr.length; i++) {
    let key = arr[i];
    let j = i - 1;
    while (j >= 0 && arr[j] > key) {
      arr[j + 1] = arr[j];
      j--;
    }
    arr[j + 1] = key;
  }
  return arr;
}`,python:`def insertion_sort(arr):
    for i in range(1, len(arr)):
        key = arr[i]
        j = i - 1
        while j >= 0 and arr[j] > key:
  arr[j + 1] = arr[j]
  j -= 1
        arr[j + 1] = key
    return arr`,java:`void insertionSort(int[] arr) {
    for (int i = 1; i < arr.length; i++) {
        int key = arr[i];
        int j = i - 1;
        while (j >= 0 && arr[j] > key) {
  arr[j + 1] = arr[j];
  j--;
        }
        arr[j + 1] = key;
    }
}`},selection:{js:`function selectionSort(arr) {
  for (let i = 0; i < arr.length - 1; i++) {
    let minIdx = i;
    for (let j = i + 1; j < arr.length; j++) {
      if (arr[j] < arr[minIdx]) {
        minIdx = j;
      }
    }
    // Swap
    [arr[i], arr[minIdx]] = [arr[minIdx], arr[i]];
  }
  return arr;
}`,python:`def selection_sort(arr):
    for i in range(len(arr) - 1):
        min_idx = i
        for j in range(i + 1, len(arr)):
  if arr[j] < arr[min_idx]:
      min_idx = j
        # Swap
        arr[i], arr[min_idx] = arr[min_idx], arr[i]
    return arr`,java:`void selectionSort(int[] arr) {
    for (int i = 0; i < arr.length - 1; i++) {
        int minIdx = i;
        for (int j = i + 1; j < arr.length; j++) {
  if (arr[j] < arr[minIdx]) {
      minIdx = j;
  }
        }
        // Swap
        int temp = arr[i];
        arr[i] = arr[minIdx];
        arr[minIdx] = temp;
    }
}`},quick:{js:`function quickSort(arr, lo = 0, hi = arr.length - 1) {
  if (lo < hi) {
    const pivot = arr[hi];
    let i = lo - 1;
    for (let j = lo; j < hi; j++) {
      if (arr[j] <= pivot) {
        i++;
        [arr[i], arr[j]] = [arr[j], arr[i]];
      }
    }
    [arr[i + 1], arr[hi]] = [arr[hi], arr[i + 1]];
    quickSort(arr, lo, i);
    quickSort(arr, i + 2, hi);
  }
  return arr;
}`,python:`def quick_sort(arr, lo=0, hi=None):
    if hi is None: hi = len(arr) - 1
    if lo < hi:
        pivot = arr[hi]
        i = lo - 1
        for j in range(lo, hi):
  if arr[j] <= pivot:
      i += 1
      arr[i], arr[j] = arr[j], arr[i]
        arr[i + 1], arr[hi] = arr[hi], arr[i + 1]
        quick_sort(arr, lo, i)
        quick_sort(arr, i + 2, hi)
    return arr`,java:`void quickSort(int[] arr, int lo, int hi) {
    if (lo < hi) {
        int pivot = arr[hi];
        int i = lo - 1;
        for (int j = lo; j < hi; j++) {
  if (arr[j] <= pivot) {
      i++;
      int temp = arr[i];
      arr[i] = arr[j];
      arr[j] = temp;
  }
        }
        int temp = arr[i + 1];
        arr[i + 1] = arr[hi];
        arr[hi] = temp;
        quickSort(arr, lo, i);
        quickSort(arr, i + 2, hi);
    }
}`},merge:{js:`function mergeSort(arr) {
  if (arr.length <= 1) return arr;
  const mid = Math.floor(arr.length / 2);
  const left = mergeSort(arr.slice(0, mid));
  const right = mergeSort(arr.slice(mid));
  return merge(left, right);
}

function merge(left, right) {
  const result = [];
  while (left.length && right.length) {
    result.push(left[0] <= right[0] ? left.shift() : right.shift());
  }
  return [...result, ...left, ...right];
}`,python:`def merge_sort(arr):
    if len(arr) <= 1: return arr
    mid = len(arr) // 2
    left = merge_sort(arr[:mid])
    right = merge_sort(arr[mid:])
    return merge(left, right)

def merge(left, right):
    result = []
    while left and right:
        result.append(left.pop(0) if left[0] <= right[0] else right.pop(0))
    return result + left + right`,java:`int[] mergeSort(int[] arr) {
    if (arr.length <= 1) return arr;
    int mid = arr.length / 2;
    int[] left = mergeSort(Arrays.copyOfRange(arr, 0, mid));
    int[] right = mergeSort(Arrays.copyOfRange(arr, mid, arr.length));
    return merge(left, right);
}

int[] merge(int[] left, int[] right) {
    int[] result = new int[left.length + right.length];
    int i = 0, j = 0, k = 0;
    while (i < left.length && j < right.length)
        result[k++] = left[i] <= right[j] ? left[i++] : right[j++];
    while (i < left.length) result[k++] = left[i++];
    while (j < right.length) result[k++] = right[j++];
    return result;
}`}},algoInfo:{bubble:{title:"ðŸ«§ Bubble Sort",desc:`Like bubbles rising in water, larger elements "bubble up" to the end of the array. We repeatedly step through the list, compare adjacent elements, and swap them if they're in the wrong order.`,best:"O(n)",avg:"O(nÂ²)",worst:"O(nÂ²)",guidance:[{step:"Step 1: Outer Loop",hint:"The outer loop controls how many passes we make through the array."},{step:"Step 2: Inner Loop",hint:"The inner loop compares adjacent elements and swaps if needed."},{step:"Step 3: Comparison",hint:"Check if arr[j] > arr[j+1]. If true, they are out of order."},{step:"Step 4: Swap",hint:"Swap the two elements to put them in correct order."}]},insertion:{title:"ðŸ“¥ Insertion Sort",desc:"Like sorting playing cards in your hand. Pick elements one by one and insert them into their correct position in the sorted portion.",best:"O(n)",avg:"O(nÂ²)",worst:"O(nÂ²)",guidance:[{step:"Step 1: Pick Element",hint:'Start from index 1. The element at this position is the "key".'},{step:"Step 2: Compare & Shift",hint:"Compare key with elements to its left. Shift larger elements right."},{step:"Step 3: Insert",hint:"Insert the key at its correct position."}]},selection:{title:"ðŸ‘† Selection Sort",desc:"Find the minimum element from the unsorted part and put it at the beginning. Repeat for the remaining array.",best:"O(nÂ²)",avg:"O(nÂ²)",worst:"O(nÂ²)",guidance:[{step:"Step 1: Find Minimum",hint:"Search the unsorted portion for the smallest element."},{step:"Step 2: Swap",hint:"Swap the minimum with the first unsorted element."},{step:"Step 3: Repeat",hint:"Move the boundary of sorted/unsorted and repeat."}]},quick:{title:"âš¡ Quick Sort",desc:'Pick a "pivot" and partition: elements smaller than pivot go left, larger go right. Recursively sort the partitions.',best:"O(n log n)",avg:"O(n log n)",worst:"O(nÂ²)",guidance:[{step:"Step 1: Choose Pivot",hint:"Select the last element as the pivot."},{step:"Step 2: Partition",hint:"Rearrange so elements < pivot are left, > pivot are right."},{step:"Step 3: Recurse",hint:"Recursively sort the left and right partitions."}]},merge:{title:"ðŸ”€ Merge Sort",desc:"Divide the array in half, sort each half, then merge them back together in sorted order.",best:"O(n log n)",avg:"O(n log n)",worst:"O(n log n)",guidance:[{step:"Step 1: Divide",hint:"Split the array into two halves."},{step:"Step 2: Conquer",hint:"Recursively sort each half."},{step:"Step 3: Merge",hint:"Merge the sorted halves by comparing elements."}]}},init(){this.loadTemplate(),this.parseArray(),this.renderArray(),this.updateLineNumbers(),this.bindEvents(),this.updateAlgoInfo()},bindEvents(){var t,e,i,s,r,n,a,o;document.querySelectorAll(".sandbox-lang-btn").forEach(l=>{l.addEventListener("click",()=>{document.querySelectorAll(".sandbox-lang-btn").forEach(c=>c.classList.remove("active")),l.classList.add("active"),this.currentLang=l.dataset.lang,this.loadTemplate()})}),(t=I("sandboxAlgoSelect"))==null||t.addEventListener("change",l=>{this.currentAlgo=l.target.value,this.loadTemplate(),this.updateAlgoInfo(),this.reset()}),(e=I("sandboxCode"))==null||e.addEventListener("input",()=>{this.updateLineNumbers()}),(i=I("sandboxArrayInput"))==null||i.addEventListener("change",()=>{this.parseArray(),this.reset()}),(s=I("sandboxRun"))==null||s.addEventListener("click",()=>this.run()),(r=I("sandboxPause"))==null||r.addEventListener("click",()=>this.pause()),(n=I("sandboxStep"))==null||n.addEventListener("click",()=>this.step()),(a=I("sandboxReset"))==null||a.addEventListener("click",()=>this.reset()),(o=I("codyDismiss"))==null||o.addEventListener("click",()=>{const l=I("codyWelcome");l&&(l.style.animation="fadeOut 0.3s ease",setTimeout(()=>l.style.display="none",300))})},updateCodyMessage(t,e=!1){const i=I("codyMessage");i&&(i.innerHTML=t,e&&(i.style.animation="bounceIn 0.5s ease",setTimeout(()=>i.style.animation="",500)))},loadTemplate(){var i;const t=((i=this.codeTemplates[this.currentAlgo])==null?void 0:i[this.currentLang])||"",e=I("sandboxCode");e&&(e.value=t),this.updateLineNumbers()},updateLineNumbers(){var s;const e=(((s=I("sandboxCode"))==null?void 0:s.value)||"").split(`
`).length,i=I("sandboxLineNumbers");i&&(i.innerHTML=Array.from({length:e},(r,n)=>`<span>${n+1}</span>`).join(""))},setActiveLine(t){document.querySelectorAll("#sandboxLineNumbers span").forEach((i,s)=>{i.classList.toggle("active-line",s+1===t)}),I("sandboxCurrentLine")&&(I("sandboxCurrentLine").textContent=t>0?t:"-")},parseArray(){var e;const t=((e=I("sandboxArrayInput"))==null?void 0:e.value)||"";this.originalArray=t.split(",").map(i=>parseInt(i.trim(),10)).filter(i=>!isNaN(i)),this.currentArray=[...this.originalArray]},renderArray(t=[],e=[],i=new Set){const s=I("sandboxArrayViz");if(!s)return;const r=Math.max(...this.currentArray,1);s.innerHTML=this.currentArray.map((n,a)=>{const o=n/r*120;let l="sandbox-bar";return t.includes(a)&&(l+=" comparing"),e.includes(a)&&(l+=" swapping"),i.has(a)&&(l+=" sorted"),`<div class="${l}" style="height: ${o}px;">
        <span class="sandbox-bar-value">${n}</span>
      </div>`}).join("")},generateSteps(){var i;const t=((i=I("sandboxCode"))==null?void 0:i.value)||"",e=this.validateSyntax(t);if(e){this.showError(`âŒ Syntax Error: ${e}`);return}this.clearError();try{this.executePatternBased(t)}catch(s){this.showError(`âŒ Error: ${s.message}`)}},validateSyntax(t){const e=this.currentLang;if(e==="js")try{return new Function(t),null}catch(i){return i.message}else if(e==="python"){const i=t.split(`
`);for(let s=0;s<i.length;s++){const r=i[s].trim();if(!r||r.startsWith("#"))continue;const n=(r.match(/\(/g)||[]).length,a=(r.match(/\)/g)||[]).length;if(n!==a)return`Line ${s+1}: Unmatched parentheses`;if(/^(if|elif|else|for|while|def|class|try|except|finally|with)\b/.test(r)&&!r.endsWith(":"))return`Line ${s+1}: Missing colon after "${r.split(" ")[0]}"`}return null}else if(e==="java"){const i=(t.match(/\{/g)||[]).length,s=(t.match(/\}/g)||[]).length;if(i!==s)return`Unbalanced braces: ${i} "{" vs ${s} "}"`;const r=(t.match(/\(/g)||[]).length,n=(t.match(/\)/g)||[]).length;if(r!==n)return`Unbalanced parentheses: ${r} "(" vs ${n} ")"`;const a=t.split(`
`);for(let o=0;o<a.length;o++){const l=a[o].trim();if(!(!l||l.startsWith("//")||l.startsWith("/*")||l.endsWith("*/"))&&!(l.endsWith("{")||l.endsWith("}")||l.endsWith(":"))&&!/^(if|else|for|while|try|catch|finally|switch|case|default)\b/.test(l)&&/\w+\s*[=\+\-\*\/]\s*\w+\s*$/.test(l)&&!l.endsWith(";"))return`Line ${o+1}: Missing semicolon`}return null}return null},executePatternBased(t){const e=[...this.originalArray];this.steps=[],this.stats={comparisons:0,swaps:0};const i=new Set,s=this.currentLang;let r,n,a,o,l;s==="js"?(r=/for.*i.*length.*for.*j.*if.*arr\[j\].*>.*arr\[j.*\+.*1\]/s.test(t),n=/key.*=.*arr\[i\].*while.*j.*>=.*0/s.test(t),a=/min.*=.*i.*for.*j.*if.*arr\[j\].*<.*arr\[min/s.test(t),o=/pivot|partition/i.test(t)&&/quickSort|quick_sort/i.test(t),l=/merge.*left.*right|mergeSort|merge_sort/is.test(t)):s==="python"?(r=/for.*in.*range.*for.*in.*range.*if.*arr\[j\].*>.*arr\[j.*\+.*1\]/s.test(t),n=/key.*=.*arr\[i\].*while.*j.*>=.*0/s.test(t),a=/min.*=.*i.*for.*in.*range.*if.*arr\[j\].*<.*arr\[min/s.test(t),o=/pivot|partition/i.test(t)&&/quick_sort/i.test(t),l=/merge.*left.*right|merge_sort/is.test(t)):s==="java"&&(r=/for.*i.*<.*length.*for.*j.*<.*if.*arr\[j\].*>.*arr\[j.*\+.*1\]/s.test(t),n=/key.*=.*arr\[i\].*while.*j.*>=.*0/s.test(t),a=/min.*=.*i.*for.*j.*=.*if.*arr\[j\].*<.*arr\[min/s.test(t),o=/pivot|partition/i.test(t)&&/quickSort/i.test(t),l=/merge.*left.*right|mergeSort/is.test(t));const c=(d={})=>{d.compare&&this.stats.comparisons++,d.swap&&this.stats.swaps++,this.steps.push({arr:[...e],sorted:new Set(i),comparing:d.comparing||[],swapping:d.swapping||[],i:d.i??-1,j:d.j??-1,line:d.line||1,guidanceIdx:d.guidanceIdx||0})},h=e.length;if(r)for(let d=0;d<h-1;d++){for(let u=0;u<h-d-1;u++)c({comparing:[u,u+1],compare:!0,i:d,j:u,line:5,guidanceIdx:2}),e[u]>e[u+1]&&([e[u],e[u+1]]=[e[u+1],e[u]],c({swapping:[u,u+1],swap:!0,i:d,j:u,line:7,guidanceIdx:3}));i.add(h-d-1)}else if(n)for(let d=1;d<h;d++){let u=e[d],p=d-1;for(c({comparing:[d],i:d,j:p,line:3,guidanceIdx:0});p>=0&&e[p]>u;)c({comparing:[p,p+1],compare:!0,i:d,j:p,line:5,guidanceIdx:1}),e[p+1]=e[p],c({swapping:[p,p+1],swap:!0,i:d,j:p,line:6,guidanceIdx:1}),p--;e[p+1]=u,c({swapping:[p+1],i:d,j:p+1,line:8,guidanceIdx:2})}else if(a)for(let d=0;d<h-1;d++){let u=d;for(let p=d+1;p<h;p++)c({comparing:[u,p],compare:!0,i:d,j:p,line:4,guidanceIdx:0}),e[p]<e[u]&&(u=p);u!==d&&([e[d],e[u]]=[e[u],e[d]],c({swapping:[d,u],swap:!0,i:d,j:u,line:9,guidanceIdx:1})),i.add(d)}else if(o){const d=(u,p)=>{if(u<p){const f=e[p];let g=u-1;for(let y=u;y<p;y++)c({comparing:[y,p],compare:!0,i:g,j:y,line:5,guidanceIdx:1}),e[y]<=f&&(g++,[e[g],e[y]]=[e[y],e[g]],c({swapping:[g,y],swap:!0,i:g,j:y,line:7,guidanceIdx:2}));[e[g+1],e[p]]=[e[p],e[g+1]],c({swapping:[g+1,p],swap:!0,i:g+1,j:p,line:10,guidanceIdx:2});const m=g+1;d(u,m-1),d(m+1,p)}};d(0,h-1)}else if(l)for(let d=1;d<h;d*=2)for(let u=0;u<h-d;u+=2*d){const p=Math.min(u+2*d-1,h-1);for(let f=u;f<=p;f++)for(let g=f+1;g<=p;g++)c({comparing:[f,g],compare:!0,i:f,j:g,line:6}),e[f]>e[g]&&([e[f],e[g]]=[e[g],e[f]],c({swapping:[f,g],swap:!0,i:f,j:g,line:8}))}else{T("âš ï¸ Unknown algorithm pattern - using default visualization","warning");for(let d=0;d<h-1;d++){for(let u=0;u<h-d-1;u++)c({comparing:[u,u+1],compare:!0,i:d,j:u,line:3}),e[u]>e[u+1]&&([e[u],e[u+1]]=[e[u+1],e[u]],c({swapping:[u,u+1],swap:!0,i:d,j:u,line:5}));i.add(h-d-1)}}for(let d=0;d<h;d++)i.add(d);c({line:12,guidanceIdx:0})},showError(t){this.hasError=!0;const e=I("sandboxGuidanceHint"),i=I("sandboxGuidanceStep");i&&(i.textContent="âš ï¸ Code Error"),e&&(e.innerHTML=`<span style="color: var(--accent-coral)">${t}</span>`),T(t,"error")},clearError(){var e;this.hasError=!1;const t=this.algoInfo[this.currentAlgo];(e=t==null?void 0:t.guidance)!=null&&e[0]&&(I("sandboxGuidanceStep")&&(I("sandboxGuidanceStep").textContent=t.guidance[0].step),I("sandboxGuidanceHint")&&(I("sandboxGuidanceHint").textContent=t.guidance[0].hint))},executeInstrumented(t){const e=[...this.originalArray];this.steps=[],this.stats={comparisons:0,swaps:0};const i=new Set;try{const s=t.match(/function\s+(\w+)\s*\(/);if(!s)throw new Error("No function found. Please define a sorting function.");const r=s[1],n=`
        ${t}
        
        // Execute the sorting function on the array
        const __arr = [${e.join(",")}];
        const __steps = [];
        const __stats = { comparisons: 0, swaps: 0 };
        
        // Track original array indices for comparison visualization
        for (let __i = 0; __i < __arr.length; __i++) {
          for (let __j = __i + 1; __j < __arr.length; __j++) {
            // This won't track but we'll use the proxy approach
          }
        }
        
        try {
          ${r}(__arr);
        } catch(e) {
          throw new Error('Error executing ' + '${r}' + ': ' + e.message);
        }
        
        __arr; // Return final array
      `;this.generateStepsFromCode(t,e,i);for(let a=0;a<e.length;a++)i.add(a);this.steps.push({arr:[...e].sort((a,o)=>a-o),sorted:new Set(i),comparing:[],swapping:[],i:-1,j:-1,line:1,guidanceIdx:0})}catch(s){throw s}},generateStepsFromCode(t,e,i){const s=/for.*i.*length.*for.*j.*if.*arr\[j\].*arr\[j.*\+.*1\]/s.test(t),r=/min.*=.*i.*for.*j.*if.*arr\[j\].*<.*arr\[min/s.test(t),n=/key.*=.*arr\[i\].*while.*j.*>=.*0/s.test(t),a=(l={})=>{l.compare&&this.stats.comparisons++,l.swap&&this.stats.swaps++,this.steps.push({arr:[...e],sorted:new Set(i),comparing:l.comparing||[],swapping:l.swapping||[],i:l.i??-1,j:l.j??-1,line:l.line||1,guidanceIdx:l.guidanceIdx||0})},o=e.length;if(s)for(let l=0;l<o-1;l++){for(let c=0;c<o-l-1;c++)a({comparing:[c,c+1],compare:!0,i:l,j:c,line:5,guidanceIdx:2}),e[c]>e[c+1]&&([e[c],e[c+1]]=[e[c+1],e[c]],a({swapping:[c,c+1],swap:!0,i:l,j:c,line:7,guidanceIdx:3}));i.add(o-l-1)}else if(n)for(let l=1;l<o;l++){let c=e[l],h=l-1;for(a({comparing:[l],i:l,j:h,line:3,guidanceIdx:0});h>=0&&e[h]>c;)a({comparing:[h,h+1],compare:!0,i:l,j:h,line:5,guidanceIdx:1}),e[h+1]=e[h],a({swapping:[h,h+1],swap:!0,i:l,j:h,line:6,guidanceIdx:1}),h--;e[h+1]=c,a({swapping:[h+1],i:l,j:h+1,line:8,guidanceIdx:2})}else if(r)for(let l=0;l<o-1;l++){let c=l;for(let h=l+1;h<o;h++)a({comparing:[c,h],compare:!0,i:l,j:h,line:4,guidanceIdx:0}),e[h]<e[c]&&(c=h);c!==l&&([e[l],e[c]]=[e[c],e[l]],a({swapping:[l,c],swap:!0,i:l,j:c,line:9,guidanceIdx:1})),i.add(l)}else try{const c=new Function("arr",t+`
return arr;`)([...e]);for(let h=0;h<o-1;h++){for(let d=0;d<o-h-1;d++)a({comparing:[d,d+1],compare:!0,i:h,j:d,line:3}),e[d]>e[d+1]&&([e[d],e[d+1]]=[e[d+1],e[d]],a({swapping:[d,d+1],swap:!0,i:h,j:d,line:5}));i.add(o-h-1)}}catch(l){throw new Error("Could not execute your code: "+l.message)}for(let l=0;l<o;l++)i.add(l)},generateFallbackSteps(){const t=[...this.originalArray];this.steps=[],this.stats={comparisons:0,swaps:0};const e=new Set,i=t.length,s=(r={})=>{r.compare&&this.stats.comparisons++,r.swap&&this.stats.swaps++,this.steps.push({arr:[...t],sorted:new Set(e),comparing:r.comparing||[],swapping:r.swapping||[],i:r.i??-1,j:r.j??-1,line:r.line||1,guidanceIdx:r.guidanceIdx||0})};if(this.currentAlgo==="bubble")for(let r=0;r<i-1;r++){for(let n=0;n<i-r-1;n++)s({comparing:[n,n+1],compare:!0,i:r,j:n,line:4,guidanceIdx:2}),t[n]>t[n+1]&&([t[n],t[n+1]]=[t[n+1],t[n]],s({swapping:[n,n+1],swap:!0,i:r,j:n,line:6,guidanceIdx:3}));e.add(i-r-1)}else if(this.currentAlgo==="insertion")for(let r=1;r<i;r++){let n=t[r],a=r-1;for(s({comparing:[r],i:r,j:a,line:3,guidanceIdx:0});a>=0&&t[a]>n;)s({comparing:[a,a+1],compare:!0,i:r,j:a,line:5,guidanceIdx:1}),t[a+1]=t[a],s({swapping:[a,a+1],swap:!0,i:r,j:a,line:6,guidanceIdx:1}),a--;t[a+1]=n}else if(this.currentAlgo==="selection")for(let r=0;r<i-1;r++){let n=r;for(let a=r+1;a<i;a++)s({comparing:[n,a],compare:!0,i:r,j:a,line:4,guidanceIdx:0}),t[a]<t[n]&&(n=a);n!==r&&([t[r],t[n]]=[t[n],t[r]],s({swapping:[r,n],swap:!0,i:r,j:n,line:9,guidanceIdx:1})),e.add(r)}else for(let r=0;r<i-1;r++){for(let n=0;n<i-r-1;n++)s({comparing:[n,n+1],compare:!0,i:r,j:n,line:5}),t[n]>t[n+1]&&([t[n],t[n+1]]=[t[n+1],t[n]],s({swapping:[n,n+1],swap:!0,i:r,j:n,line:7}));e.add(i-r-1)}for(let r=0;r<i;r++)e.add(r);s({line:12})},run(){var i,s,r;const t=((i=I("sandboxCode"))==null?void 0:i.value)||"",e=this.validateSyntax(t);if(e){this.showError(`âŒ Syntax Error: ${e}`);return}this.steps.length===0&&this.generateSteps(),!this.hasError&&(this.stepIndex>=this.steps.length&&(this.stepIndex=0),this.playing=!0,(s=I("sandboxRun"))==null||s.classList.add("section-hidden"),(r=I("sandboxPause"))==null||r.classList.remove("section-hidden"),this.tick())},pause(){var t,e;this.playing=!1,clearTimeout(this.timer),(t=I("sandboxRun"))==null||t.classList.remove("section-hidden"),(e=I("sandboxPause"))==null||e.classList.add("section-hidden")},tick(){var t;if(this.playing)if(this.stepIndex<this.steps.length){this.applyStep(this.stepIndex),this.stepIndex++;const e=parseInt(((t=I("sandboxSpeed"))==null?void 0:t.value)||5);this.timer=setTimeout(()=>this.tick(),Math.max(50,600/e))}else this.pause(),this.onComplete()},step(){this.pause(),this.steps.length===0&&this.generateSteps(),this.stepIndex<this.steps.length&&(this.applyStep(this.stepIndex),this.stepIndex++)},applyStep(t){const e=this.steps[t];if(!e)return;if(this.currentArray=[...e.arr],this.renderArray(e.comparing,e.swapping,e.sorted),this.setActiveLine(e.line),I("varI")&&(I("varI").textContent=e.i>=0?e.i:"-"),I("varJ")&&(I("varJ").textContent=e.j>=0?e.j:"-"),I("varCompare")){const s=e.comparing;I("varCompare").textContent=s.length===2?`${this.currentArray[s[0]]} vs ${this.currentArray[s[1]]}`:"-"}I("varSwapped")&&(I("varSwapped").textContent=e.swapping.length>0?"true":"false"),I("sandboxComparisons")&&(I("sandboxComparisons").textContent=this.stats.comparisons),I("sandboxSwaps")&&(I("sandboxSwaps").textContent=this.stats.swaps),I("sandboxStepNum")&&(I("sandboxStepNum").textContent=t+1);const i=this.algoInfo[this.currentAlgo];if(i&&i.guidance&&i.guidance[e.guidanceIdx]){const s=i.guidance[e.guidanceIdx];I("sandboxGuidanceStep")&&(I("sandboxGuidanceStep").textContent=s.step),I("sandboxGuidanceHint")&&(I("sandboxGuidanceHint").textContent=s.hint)}e.comparing.length>0&&(O==null||O.play("compare")),e.swapping.length>0&&(O==null||O.play("swap"))},reset(){this.pause(),this.hasError=!1,this.clearError(),this.currentArray=[...this.originalArray],this.steps=[],this.stepIndex=0,this.stats={comparisons:0,swaps:0},this.renderArray(),this.setActiveLine(0),I("varI")&&(I("varI").textContent="-"),I("varJ")&&(I("varJ").textContent="-"),I("varCompare")&&(I("varCompare").textContent="-"),I("varSwapped")&&(I("varSwapped").textContent="-"),I("sandboxComparisons")&&(I("sandboxComparisons").textContent="0"),I("sandboxSwaps")&&(I("sandboxSwaps").textContent="0"),I("sandboxStepNum")&&(I("sandboxStepNum").textContent="0"),I("sandboxCurrentLine")&&(I("sandboxCurrentLine").textContent="-");const t=this.algoInfo[this.currentAlgo];t&&t.guidance&&t.guidance[0]&&(I("sandboxGuidanceStep")&&(I("sandboxGuidanceStep").textContent=t.guidance[0].step),I("sandboxGuidanceHint")&&(I("sandboxGuidanceHint").textContent=t.guidance[0].hint)),O==null||O.play("reset")},updateAlgoInfo(){const t=this.algoInfo[this.currentAlgo];t&&(I("sandboxAlgoTitle")&&(I("sandboxAlgoTitle").textContent=t.title),I("sandboxAlgoDesc")&&(I("sandboxAlgoDesc").textContent=t.desc),I("sandboxBestCase")&&(I("sandboxBestCase").textContent=t.best),I("sandboxAvgCase")&&(I("sandboxAvgCase").textContent=t.avg),I("sandboxWorstCase")&&(I("sandboxWorstCase").textContent=t.worst),t.guidance&&t.guidance[0]&&(I("sandboxGuidanceStep")&&(I("sandboxGuidanceStep").textContent=t.guidance[0].step),I("sandboxGuidanceHint")&&(I("sandboxGuidanceHint").textContent=t.guidance[0].hint)))},onComplete(){T("ðŸŽ‰ Sorting complete!"),O==null||O.play("sort_complete"),ProgressManager==null||ProgressManager.addXP(10)}},B2={leftState:null,rightState:null,racing:!1,sharedArray:[],algorithms:{bubble:async function*(t,e){let i=t.length;for(let s=0;s<i-1;s++)for(let r=0;r<i-s-1;r++)yield{type:"compare",indices:[r,r+1],side:e},t[r]>t[r+1]&&([t[r],t[r+1]]=[t[r+1],t[r]],yield{type:"swap",indices:[r,r+1],side:e});yield{type:"done",side:e}},selection:async function*(t,e){let i=t.length;for(let s=0;s<i-1;s++){let r=s;for(let n=s+1;n<i;n++)yield{type:"compare",indices:[r,n],side:e},t[n]<t[r]&&(r=n);r!==s&&([t[s],t[r]]=[t[r],t[s]],yield{type:"swap",indices:[s,r],side:e})}yield{type:"done",side:e}},insertion:async function*(t,e){for(let i=1;i<t.length;i++){let s=t[i],r=i-1;for(;r>=0&&(yield{type:"compare",indices:[r,r+1],side:e},t[r]>s);)t[r+1]=t[r],yield{type:"swap",indices:[r,r+1],side:e},r--;t[r+1]=s}yield{type:"done",side:e}},merge:async function*(t,e,i=0,s=t.length-1){if(i<s){const r=Math.floor((i+s)/2);yield*this.merge(t,e,i,r),yield*this.merge(t,e,r+1,s);const n=t.slice(i,r+1),a=t.slice(r+1,s+1);let o=0,l=0,c=i;for(;o<n.length&&l<a.length;)yield{type:"compare",indices:[i+o,r+1+l],side:e},n[o]<=a[l]?t[c++]=n[o++]:t[c++]=a[l++],yield{type:"swap",indices:[c-1],side:e};for(;o<n.length;)t[c++]=n[o++],yield{type:"swap",indices:[c-1],side:e};for(;l<a.length;)t[c++]=a[l++],yield{type:"swap",indices:[c-1],side:e}}i===0&&s===t.length-1&&(yield{type:"done",side:e})},quick:async function*(t,e,i=0,s=t.length-1){if(i<s){const r=t[s];let n=i-1;for(let o=i;o<s;o++)yield{type:"compare",indices:[o,s],side:e},t[o]<r&&(n++,[t[n],t[o]]=[t[o],t[n]],yield{type:"swap",indices:[n,o],side:e});[t[n+1],t[s]]=[t[s],t[n+1]],yield{type:"swap",indices:[n+1,s],side:e};const a=n+1;yield*this.quick(t,e,i,a-1),yield*this.quick(t,e,a+1,s)}i===0&&s===t.length-1&&(yield{type:"done",side:e})},heap:async function*(t,e){const i=t.length,s=async function*(r,n,a,o){let l=a;const c=2*a+1,h=2*a+2;c<n&&(yield{type:"compare",indices:[c,l],side:o},r[c]>r[l]&&(l=c)),h<n&&(yield{type:"compare",indices:[h,l],side:o},r[h]>r[l]&&(l=h)),l!==a&&([r[a],r[l]]=[r[l],r[a]],yield{type:"swap",indices:[a,l],side:o},yield*s(r,n,l,o))};for(let r=Math.floor(i/2)-1;r>=0;r--)yield*s(t,i,r,e);for(let r=i-1;r>0;r--)[t[0],t[r]]=[t[r],t[0]],yield{type:"swap",indices:[0,r],side:e},yield*s(t,r,0,e);yield{type:"done",side:e}}},init(){this.bindEvents(),this.generateArray(),this.updateTitles()},bindEvents(){var t,e,i,s,r,n;(t=I("btnRaceStart"))==null||t.addEventListener("click",()=>this.startRace()),(e=I("btnRaceReset"))==null||e.addEventListener("click",()=>this.reset()),(i=I("raceArraySize"))==null||i.addEventListener("input",a=>{I("raceArraySizeLabel").textContent=`${a.target.value} elements`}),(s=I("raceArraySize"))==null||s.addEventListener("change",()=>this.generateArray()),(r=I("raceAlgoLeft"))==null||r.addEventListener("change",()=>this.updateTitles()),(n=I("raceAlgoRight"))==null||n.addEventListener("change",()=>this.updateTitles())},updateTitles(){var e,i;const t={bubble:"Bubble Sort",selection:"Selection Sort",insertion:"Insertion Sort",merge:"Merge Sort",quick:"Quick Sort",heap:"Heap Sort"};I("raceLeftTitle").textContent=t[(e=I("raceAlgoLeft"))==null?void 0:e.value]||"Left",I("raceRightTitle").textContent=t[(i=I("raceAlgoRight"))==null?void 0:i.value]||"Right"},generateArray(){var e;const t=parseInt(((e=I("raceArraySize"))==null?void 0:e.value)||20);this.sharedArray=Array.from({length:t},()=>Math.floor(Math.random()*100)+1),this.renderBars("left",this.sharedArray),this.renderBars("right",this.sharedArray)},renderBars(t,e,i=[]){const s=I(t==="left"?"raceLeftCanvas":"raceRightCanvas");if(!s)return;const r=Math.max(...e),n=100/e.length;s.innerHTML=e.map((a,o)=>{const l=a/r*100,h=i.includes(o)?"var(--accent-amber)":t==="left"?"var(--accent-forest)":"var(--accent-coral)";return`<div style="position: absolute; bottom: 0; left: ${o*n}%; width: ${n-.5}%; height: ${l}%; background: ${h}; transition: height 0.05s;"></div>`}).join("")},async startRace(){var o,l,c;if(this.racing)return;this.racing=!0,(o=I("raceWinnerBanner"))==null||o.classList.add("collapsed");const t=((l=I("raceAlgoLeft"))==null?void 0:l.value)||"merge",e=((c=I("raceAlgoRight"))==null?void 0:c.value)||"bubble",i=[...this.sharedArray],s=[...this.sharedArray];this.leftState={arr:i,comparisons:0,swaps:0,done:!1,startTime:Date.now()},this.rightState={arr:s,comparisons:0,swaps:0,done:!1,startTime:Date.now()},I("raceLeftStatus").textContent="Racing...",I("raceRightStatus").textContent="Racing...",I("raceLeftStatus").style.background="var(--accent-forest)",I("raceLeftStatus").style.color="white",I("raceRightStatus").style.background="var(--accent-coral)",I("raceRightStatus").style.color="white";const r=this.algorithms[t].bind(this.algorithms)(i,"left"),n=this.algorithms[e].bind(this.algorithms)(s,"right"),a=async(h,d,u)=>{if(d.done)return;const p=await h.next();if(p.done)return;const f=p.value;f.type==="compare"?(d.comparisons++,this.renderBars(u,d.arr,f.indices)):f.type==="swap"?(d.swaps++,this.renderBars(u,d.arr,f.indices)):f.type==="done"&&(d.done=!0,d.endTime=Date.now()),this.updateStats(u,d),!d.done&&this.racing&&(await new Promise(g=>setTimeout(g,5)),await a(h,d,u))};await Promise.all([a(r,this.leftState,"left"),a(n,this.rightState,"right")]),this.showWinner(),this.racing=!1},updateStats(t,e){const i=t==="left"?"raceLeft":"raceRight";I(i+"Comparisons").textContent=e.comparisons,I(i+"Swaps").textContent=e.swaps,I(i+"Time").textContent=`${Date.now()-e.startTime}ms`;const s=e.comparisons+e.swaps,r=e.arr.length*e.arr.length,n=Math.min(100,s/r*100);I(i+"ProgressBar").style.width=`${n}%`,e.done&&(I(i+"Status").textContent="Done!",I(i+"ProgressBar").style.width="100%")},showWinner(){var o,l,c;const t=this.leftState.endTime-this.leftState.startTime,e=this.rightState.endTime-this.rightState.startTime,i=(o=I("raceLeftTitle"))==null?void 0:o.textContent,s=(l=I("raceRightTitle"))==null?void 0:l.textContent;let r,n,a;t<e?(r=i,n=t,a=e):e<t?(r=s,n=e,a=t):(r="It's a tie!",n=t,a=e),I("raceWinnerText").textContent=r==="It's a tie!"?"ðŸ¤ It's a Tie!":`ðŸ† ${r} Wins!`,I("raceWinnerStats").textContent=`Finished in ${n}ms vs ${a}ms (${Math.round((a-n)/n*100)}% faster)`,(c=I("raceWinnerBanner"))==null||c.classList.remove("collapsed"),O==null||O.play("challenge_complete"),T(`ðŸ Race complete! ${r} wins!`)},reset(){var t;this.racing=!1,this.generateArray(),I("raceLeftStatus").textContent="Ready",I("raceRightStatus").textContent="Ready",I("raceLeftStatus").style.background="var(--bg-card)",I("raceRightStatus").style.background="var(--bg-card)",I("raceLeftStatus").style.color="",I("raceRightStatus").style.color="",I("raceLeftComparisons").textContent="0",I("raceRightComparisons").textContent="0",I("raceLeftSwaps").textContent="0",I("raceRightSwaps").textContent="0",I("raceLeftTime").textContent="0ms",I("raceRightTime").textContent="0ms",I("raceLeftProgressBar").style.width="0%",I("raceRightProgressBar").style.width="0%",(t=I("raceWinnerBanner"))==null||t.classList.add("collapsed")}};typeof window<"u"&&(window.DailyChallengeManager=j0,window.QuizEngine=F0,window.SandboxManager=D2);const j2="modulepreload",W2=function(t){return"/"+t},fg={},js=function(e,i,s){let r=Promise.resolve();if(i&&i.length>0){document.getElementsByTagName("link");const a=document.querySelector("meta[property=csp-nonce]"),o=(a==null?void 0:a.nonce)||(a==null?void 0:a.getAttribute("nonce"));r=Promise.allSettled(i.map(l=>{if(l=W2(l),l in fg)return;fg[l]=!0;const c=l.endsWith(".css"),h=c?'[rel="stylesheet"]':"";if(document.querySelector(`link[href="${l}"]${h}`))return;const d=document.createElement("link");if(d.rel=c?"stylesheet":j2,c||(d.as="script"),d.crossOrigin="",d.href=l,o&&d.setAttribute("nonce",o),document.head.appendChild(d),c)return new Promise((u,p)=>{d.addEventListener("load",u),d.addEventListener("error",()=>p(new Error(`Unable to preload CSS for ${l}`)))})}))}function n(a){const o=new Event("vite:preloadError",{cancelable:!0});if(o.payload=a,window.dispatchEvent(o),!o.defaultPrevented)throw a}return r.then(a=>{for(const o of a||[])o.status==="rejected"&&n(o.reason);return e().catch(n)})},Er={"/dashboard":{section:"dashboard",title:"ðŸŽ“ Dashboard"},"/algorithms":{section:"algorithms",title:"âš¡ Sorting Algorithms",onEnter:()=>{typeof window.initSorting=="function"&&window.initSorting()}},"/searching":{section:"searching",title:"ðŸ” Searching Algorithms",onEnter:()=>{var t;(t=window.SearchViz)!=null&&t.init&&window.SearchViz.init()}},"/pathfinding":{section:"pathfinding",title:"ðŸ—ºï¸ Pathfinding",onEnter:()=>{typeof window.initPathfinding=="function"&&window.initPathfinding()}},"/divide-conquer":{section:"divide-conquer",title:"âœ‚ï¸ Divide & Conquer",onEnter:()=>{var t;(t=window.DCViz)!=null&&t.init&&window.DCViz.init()}},"/algorithm-race":{section:"algorithm-race",title:"ðŸ Algorithm Race"},"/algorithm-sandbox":{section:"algorithm-sandbox",title:"ðŸ§ª Algorithm Sandbox",onEnter:()=>{var t;(t=window.SandboxController)!=null&&t.init&&window.SandboxController.init()}},"/algorithms/midterm-solutions":{section:"algo-midterm-solutions",title:"ðŸ“ Algo Midterm Solutions",onEnter:async()=>{const t=document.getElementById("section-algo-midterm-solutions");if(t&&!t.querySelector(".algo-midterm-solutions-container"))try{console.log("[Router] Loading Algo Midterm Solutions...");const e=await fetch("components/sections/algorithms/midterm/index.html");if(!e.ok)throw new Error(`HTTP error! status: ${e.status}`);const i=await e.text();t.innerHTML=i;const{AlgorithmsMidtermController:s}=await js(async()=>{const{AlgorithmsMidtermController:r}=await import("./algorithms-midterm-CR8ATVR_.js");return{AlgorithmsMidtermController:r}},__vite__mapDeps([0,1]));new s}catch(e){console.error("[Router] Failed to load Algo Midterm Solutions:",e),t&&(t.innerHTML=`<div style="padding: 2rem; text-align: center; color: var(--accent-coral);"><h3>âŒ Failed to load content</h3><p>${e.message}</p></div>`)}}},"/algorithms/final-solutions":{section:"algo-final-solutions",title:"ðŸŽ“ Algo Final Solutions",onEnter:async()=>{const t=document.getElementById("section-algo-final-solutions");if(t&&!t.querySelector(".algo-final-solutions-container"))try{console.log("[Router] Loading Algo Final Solutions...");const e=await fetch("components/sections/algorithms/final/index.html");if(!e.ok)throw new Error(`HTTP error! status: ${e.status}`);const i=await e.text();t.innerHTML=i;const{AlgorithmsFinalController:s}=await js(async()=>{const{AlgorithmsFinalController:r}=await import("./algorithms-final-CU-PhYWn.js");return{AlgorithmsFinalController:r}},__vite__mapDeps([2,1]));new s}catch(e){console.error("[Router] Failed to load Algo Final Solutions:",e),t&&(t.innerHTML=`<div style="padding: 2rem; text-align: center; color: var(--accent-coral);"><h3>âŒ Failed to load content</h3><p>${e.message}</p></div>`)}}},"/ds-array":{section:"ds-array",title:"ðŸ“Š Arrays",onEnter:()=>{var t;(t=window.DS)!=null&&t.renderAll&&window.DS.renderAll()}},"/ds-stack":{section:"ds-stack",title:"ðŸ“š Stacks",onEnter:()=>{var t;(t=window.DS)!=null&&t.renderStack&&window.DS.renderStack()}},"/ds-queue":{section:"ds-queue",title:"ðŸŽ« Queues",onEnter:()=>{var t;(t=window.DS)!=null&&t.renderQueue&&window.DS.renderQueue()}},"/ds-linkedlist":{section:"ds-linkedlist",title:"ðŸ”— Linked Lists",onEnter:()=>{var t;(t=window.DS)!=null&&t.renderLinkedList&&window.DS.renderLinkedList()}},"/ds-tree":{section:"ds-tree",title:"ðŸŒ³ Binary Trees",onEnter:()=>{var t;(t=window.DS)!=null&&t.renderBST&&window.DS.renderBST()}},"/ds-hash":{section:"ds-hash",title:"ðŸ—‚ï¸ Hash Tables",onEnter:()=>{var t;(t=window.DS)!=null&&t.renderHashTable&&window.DS.renderHashTable()}},"/ds-heap":{section:"ds-heap",title:"ðŸ”º Heaps",onEnter:()=>{var t;(t=window.DS)!=null&&t.renderHeap&&window.DS.renderHeap()}},"/ds-graph":{section:"ds-graph",title:"ðŸ•¸ï¸ Graphs",onEnter:()=>{var t;(t=window.DS)!=null&&t.renderGraph&&window.DS.renderGraph()}},"/ds-sandbox":{section:"ds-sandbox",title:"ðŸ§ª DS Sandbox",onEnter:()=>{var t;(t=window.SandboxController)!=null&&t.init&&window.SandboxController.init()}},"/data-structures/lab-solutions":{section:"lab-solutions",title:"ðŸ§ª Lab Solutions",onEnter:async()=>{const t=document.getElementById("section-lab-solutions");if(t&&!t.querySelector(".lab-solutions-container"))try{console.log("[Router] Loading Lab Solutions module...");const e=await fetch("components/sections/data-structures/lab-solutions/index.html");if(!e.ok)throw new Error(`HTTP error! status: ${e.status}`);const i=await e.text();t.innerHTML=i;const{LabSolutionsController:s}=await js(async()=>{const{LabSolutionsController:n}=await import("./lab-solutions-DuYKF0zI.js");return{LabSolutionsController:n}},__vite__mapDeps([3,1]));new s().init(),console.log("[Router] Lab Solutions loaded successfully")}catch(e){console.error("[Router] Failed to load Lab Solutions:",e),t&&(t.innerHTML=`<div style="padding: 2rem; text-align: center; color: var(--accent-coral);"><h3>âŒ Failed to load content</h3><p>${e.message}</p></div>`)}}},"/data-structures/midterm-solutions":{section:"midterm-solutions",title:"ðŸ“ Midterm Solutions",onEnter:async()=>{const t=document.getElementById("section-midterm-solutions");if(t&&!t.querySelector(".midterm-solutions-container"))try{console.log("[Router] Loading Midterm Solutions module...");const e=await fetch("components/sections/data-structures/midterm-solutions/index.html");if(!e.ok)throw new Error(`HTTP error! status: ${e.status}`);const i=await e.text();t.innerHTML=i;const{MidtermSolutionsController:s}=await js(async()=>{const{MidtermSolutionsController:n}=await import("./midterm-solutions-DuY3BOLa.js");return{MidtermSolutionsController:n}},__vite__mapDeps([4,1]));new s().init(),console.log("[Router] Midterm Solutions loaded successfully")}catch(e){console.error("[Router] Failed to load Midterm Solutions:",e),t&&(t.innerHTML=`<div style="padding: 2rem; text-align: center; color: var(--accent-coral);"><h3>âŒ Failed to load content</h3><p>${e.message}</p></div>`)}}},"/data-structures/final-solutions":{section:"final-solutions",title:"ðŸŽ“ Final Solutions",onEnter:async()=>{const t=document.getElementById("section-final-solutions");if(t&&!t.querySelector(".final-solutions-container"))try{console.log("[Router] Loading Final Solutions module...");const e=await fetch("components/sections/data-structures/final-solutions/index.html");if(!e.ok)throw new Error(`HTTP error! status: ${e.status}`);const i=await e.text();t.innerHTML=i;const{FinalSolutionsController:s}=await js(async()=>{const{FinalSolutionsController:n}=await import("./final-solutions-Kjz0yZTx.js");return{FinalSolutionsController:n}},__vite__mapDeps([5,1]));new s().init(),console.log("[Router] Final Solutions loaded successfully")}catch(e){console.error("[Router] Failed to load Final Solutions:",e),t&&(t.innerHTML=`<div style="padding: 2rem; text-align: center; color: var(--accent-coral);"><h3>âŒ Failed to load content</h3><p>${e.message}</p></div>`)}}},"/sql":{section:"sql-lab",title:"ðŸ§ª SQL Lab",onEnter:()=>{var t;(t=window.SQLModule)!=null&&t.ensureReady&&window.SQLModule.ensureReady()}},"/sql-practice":{section:"sql-practice",title:"ðŸ SQL Practice",onEnter:()=>{var t;(t=window.SQLModule)!=null&&t.ensureReady&&window.SQLModule.ensureReady()}},"/sql-visualizer":{section:"sql-visualizer",title:"ðŸ‘ï¸ SQL Visualizer",onEnter:()=>{var t;(t=window.SQLVisualizer)!=null&&t.init&&window.SQLVisualizer.init()}},"/sql-lessons":{section:"sql-lessons",title:"ðŸ“˜ SQL Lessons"},"/relational-algebra":{section:"relational-algebra",title:"ðŸ”¢ Relational Algebra",onEnter:()=>{var t;(t=window.RelationalAlgebra)!=null&&t.init&&window.RelationalAlgebra.init()}},"/transactions":{section:"transactions",title:"ðŸ” Transactions & ACID",onEnter:()=>{var t;(t=window.TransactionSimulator)!=null&&t.init&&window.TransactionSimulator.init()}},"/btree":{section:"btree",title:"ðŸŒ³ B-Tree Index Visualizer",onEnter:()=>{var t;(t=window.BTreeVisualizer)!=null&&t.init&&window.BTreeVisualizer.init()}},"/nosql":{section:"nosql",title:"ðŸƒ Introduction to NoSQL"},"/schema-live":{section:"schema-live",title:"ðŸŽ¨ Schema-Live Workbench",onEnter:async()=>{var t,e;try{const i=document.getElementById("section-schema-live");if(((t=i==null?void 0:i.querySelector(".schema-live-editor"))==null?void 0:t.value)!==void 0&&((e=window.SchemaLive)==null?void 0:e.initialized))console.log("[Router] Schema-Live already initialized");else{console.log("[Router] Initializing Schema-Live module...");const{SchemaLive:r}=await js(async()=>{const{SchemaLive:n}=await import("./index-Cyt6TAot.js");return{SchemaLive:n}},[]);window.SchemaLive=r,r.init("section-schema-live"),console.log("[Router] Schema-Live initialized successfully")}}catch(i){console.error("[Router] Failed to initialize Schema-Live:",i);const s=document.getElementById("section-schema-live");if(s){const r=document.createElement("div");r.style.cssText="padding: 2rem; text-align: center; color: var(--accent-coral); background: rgba(196,69,54,0.1); border-radius: 8px; margin: 1rem;",r.innerHTML=`<h3>âŒ Failed to load Schema-Live</h3><p>${i.message}</p><pre style="font-size:0.75rem; opacity:0.6;">${i.stack}</pre>`,s.insertBefore(r,s.firstChild)}}}},"/db-erd":{section:"db-erd",title:"ðŸ“Š Entity-Relationship Diagrams",onEnter:()=>{var t;(t=window.ERDVisualizer)!=null&&t.render&&window.ERDVisualizer.render()}},"/db-eerd":{section:"db-eerd",title:"ðŸ”· Enhanced ER Diagrams",onEnter:()=>{var t;(t=window.EERDVisualizer)!=null&&t.render&&window.EERDVisualizer.render()}},"/db-schema":{section:"db-schema",title:"ðŸ—ï¸ Schema Design",onEnter:()=>{var t;(t=window.SchemaVisualizer)!=null&&t.render&&window.SchemaVisualizer.render()}},"/db-normalization":{section:"db-normalization",title:"ðŸ”§ Normalization",onEnter:()=>{var t;(t=window.NormalizationEngine)!=null&&t.render&&window.NormalizationEngine.render()}},"/lectures":{section:"electure-algorithms",title:"ðŸŽ“ E-Lectures: Algorithms"},"/lectures-ds":{section:"electure-datastructures",title:"ðŸŽ“ E-Lectures: Data Structures"},"/lectures-sql":{section:"electure-sql",title:"ðŸŽ“ E-Lectures: SQL"},"/quiz":{section:"quiz-mode",title:"ðŸ§  Quiz Mode"},"/story-recursion":{section:"story-recursion",title:"ðŸ”„ Recursion Story"},"/story-bigo":{section:"story-bigo",title:"ðŸŽï¸ Big O Story",onEnter:()=>{typeof window.renderBigO=="function"&&window.renderBigO()}}},Wi={currentRoute:null,currentSection:null,isNavigating:!1},U0={init(){window.addEventListener("hashchange",()=>this.handleRouteChange()),!window.location.hash||window.location.hash==="#"?window.location.hash="/dashboard":this.handleRouteChange(),console.log("[Router] âœ… Initialized with",Object.keys(Er).length,"routes")},navigateTo(t){if(t.startsWith("/")||(t="/"+t),!Er[t]){console.warn(`[Router] Unknown route: ${t}, looking up section mapping...`);const e=Object.entries(Er).find(([i,s])=>s.section===t.slice(1));if(e)t=e[0],console.log(`[Router] Resolved section to route: ${t}`);else{console.error(`[Router] Route not found: ${t}`),T(`âŒ Page not found: ${t}`);return}}if(Wi.currentRoute===t&&window.location.hash==="#"+t){console.log(`[Router] Already on route: ${t}`);return}console.log(`[Router] Navigating to: ${t}`),window.location.hash=t},handleRouteChange(){var t,e;if(!Wi.isNavigating){Wi.isNavigating=!0;try{let i=window.location.hash.slice(1)||"/dashboard";i.startsWith("/")||(i="/"+i);const s=Er[i];if(!s){console.warn(`[Router] Unknown route: ${i}, falling back to dashboard`),Wi.isNavigating=!1,this.navigateTo("/dashboard");return}typeof window.pauseSorting=="function"&&window.pauseSorting(),typeof window.pausePath=="function"&&window.pausePath(),(t=window.SortEngine)!=null&&t.clearCompletionTimers&&window.SortEngine.clearCompletionTimers(),(e=window.PathEngine)!=null&&e.clearCompletionTimers&&window.PathEngine.clearCompletionTimers(),this.showSection(s.section),Wi.currentRoute=i,Wi.currentSection=s.section,s.onEnter&&setTimeout(()=>s.onEnter(),50),this.updateNavUI(s.section),this.updateSidebarVisibility(s.section),document.title=`${s.title} | CSE Helper`,console.log(`[Router] Navigated to: ${i} (section: ${s.section})`)}finally{Wi.isNavigating=!1}}},showSection(t){document.querySelectorAll("section[id^='section-']").forEach(s=>{s.classList.add("section-hidden"),s.classList.remove("page-slide-in","animate-in")});const e=document.getElementById(`section-${t}`);e?(e.classList.remove("section-hidden"),e.classList.add("page-slide-in")):console.warn(`[Router] Section not found: section-${t}`);const i=document.getElementById("routerOutlet");i&&(i.style.display="none")},updateNavUI(t){document.querySelectorAll(".nav-item").forEach(i=>{i.classList.remove("active")});const e=document.querySelector(`.nav-item[data-section="${t}"]`);e&&e.classList.add("active")},updateSidebarVisibility(t){const e=document.getElementById("sidebar"),i=document.getElementById("mainContent"),s=document.body;t==="dashboard"?(e==null||e.classList.add("sidebar-hidden"),i==null||i.classList.add("dashboard-fullwidth","content-expanded"),s.classList.add("dashboard-active")):(s.classList.remove("dashboard-active"),i==null||i.classList.remove("dashboard-fullwidth"),e==null||e.classList.remove("sidebar-hidden"))},getCurrentRoute(){return Wi.currentRoute},getCurrentSection(){return Wi.currentSection},hasRoute(t){return t.startsWith("/")||(t="/"+t),!!Er[t]},getRoute(t){return t.startsWith("/")||(t="/"+t),Er[t]}};window.Router=U0;const St=t=>{const e=[document.getElementById(t),document.getElementById(t+"2")].filter(Boolean);return e.length===0?null:new Proxy(e[0],{get(i,s){if(s==="addEventListener")return(n,a)=>e.forEach(o=>o.addEventListener(n,a));if(s==="scrollIntoView")return n=>e.forEach(a=>a.scrollIntoView(n));if(s==="style")return new Proxy(i.style,{set(n,a,o){return e.forEach(l=>l.style[a]=o),!0},get(n,a){return n[a]}});if(s==="value"){const n=e.find(a=>a.id.endsWith("2"));if(n&&n.offsetParent!==null||n)return n.value}const r=Reflect.get(i,s);return typeof r=="function"?r.bind(i):r},set(i,s,r){return e.forEach(n=>n[s]=r),!0}})},V0={array:[],target:0,steps:[],stepIndex:0,isPlaying:!1,animationId:null,eliminated:new Set,currentAlgo:"binary",currentCodeLang:"python",metricComparisons:0,metricDiscarded:0,metricMemory:0,codeSnippets:{binary:{python:`def binary_search(arr, target):
    low, high = 0, len(arr) - 1
    while low <= high:
        mid = (low + high) // 2
        if arr[mid] == target:
            return mid
        elif arr[mid] < target:
            low = mid + 1
        else:
            high = mid - 1
    return -1`,java:`public static int binarySearch(int[] arr, int target) {
    int low = 0, high = arr.length - 1;
    while (low <= high) {
        int mid = low + (high - low) / 2;
        if (arr[mid] == target) return mid;
        else if (arr[mid] < target) low = mid + 1;
        else high = mid - 1;
    }
    return -1;
}`,cpp:`int binarySearch(vector<int>& arr, int target) {
    int low = 0, high = arr.size() - 1;
    while (low <= high) {
        int mid = low + (high - low) / 2;
        if (arr[mid] == target) return mid;
        else if (arr[mid] < target) low = mid + 1;
        else high = mid - 1;
    }
    return -1;
}`},linear:{python:`def linear_search(arr, target):
    for i in range(len(arr)):
        if arr[i] == target:
            return i
    return -1`,java:`public static int linearSearch(int[] arr, int target) {
    for (int i = 0; i < arr.length; i++) {
        if (arr[i] == target) return i;
    }
    return -1;
}`,cpp:`int linearSearch(vector<int>& arr, int target) {
    for (int i = 0; i < arr.size(); i++) {
        if (arr[i] == target) return i;
    }
    return -1;
}`},ternary:{python:`def ternary_search(arr, target):
    l, r = 0, len(arr) - 1
    while r >= l:
        mid1 = l + (r - l) // 3
        mid2 = r - (r - l) // 3
        if arr[mid1] == target: return mid1
        if arr[mid2] == target: return mid2
        if target < arr[mid1]: r = mid1 - 1
        elif target > arr[mid2]: l = mid2 + 1
        else: l = mid1 + 1; r = mid2 - 1
    return -1`,java:`public static int ternarySearch(int[] arr, int target) {
    int l = 0, r = arr.length - 1;
    while (r >= l) {
        int mid1 = l + (r - l) / 3;
        int mid2 = r - (r - l) / 3;
        if (arr[mid1] == target) return mid1;
        if (arr[mid2] == target) return mid2;
        if (target < arr[mid1]) r = mid1 - 1;
        else if (target > arr[mid2]) l = mid2 + 1;
        else { l = mid1 + 1; r = mid2 - 1; }
    }
    return -1;
}`,cpp:`int ternarySearch(vector<int>& arr, int target) {
    int l = 0, r = arr.size() - 1;
    while (r >= l) {
        int mid1 = l + (r - l) / 3;
        int mid2 = r - (r - l) / 3;
        if (arr[mid1] == target) return mid1;
        if (arr[mid2] == target) return mid2;
        if (target < arr[mid1]) r = mid1 - 1;
        else if (target > arr[mid2]) l = mid2 + 1;
        else { l = mid1 + 1; r = mid2 - 1; }
    }
    return -1;
}`}},resetScenario(){const t=document.getElementById("searchScenarioSelect2");t&&(t.selectedIndex=0);const e=document.getElementById("searchScenarioSelect");e&&(e.selectedIndex=0)},init(){this.isInitialized||(this.isInitialized=!0,this.bindEvents(),this.randomize(),this.renderCode())},bindEvents(){var e,i,s,r,n,a,o,l,c,h;(e=St("btnSearchStart"))==null||e.addEventListener("click",()=>this.start()),(i=St("btnSearchReset"))==null||i.addEventListener("click",()=>this.reset()),(s=St("btnSearchRandomize"))==null||s.addEventListener("click",()=>this.randomize()),(r=St("btnSearchLoadCustom"))==null||r.addEventListener("click",()=>this.parseInput()),(n=St("searchScenarioSelect"))==null||n.addEventListener("change",d=>this.handleScenario(d.target.value)),(a=St("btnSearchSkipBack"))==null||a.addEventListener("click",()=>this.skipBack()),(o=St("btnSearchStepBack"))==null||o.addEventListener("click",()=>this.stepBack()),(l=St("btnSearchPlayPause"))==null||l.addEventListener("click",()=>this.togglePlayPause()),(c=St("btnSearchStepForward"))==null||c.addEventListener("click",()=>this.stepForward()),(h=St("btnSearchSkipForward"))==null||h.addEventListener("click",()=>this.skipForward()),[document.getElementById("searchAlgoSelect"),document.getElementById("searchAlgoSelect2")].filter(Boolean).forEach(d=>{d.addEventListener("change",u=>this.switchAlgorithm(u.target.value))}),document.querySelectorAll(".search-code-tab").forEach(d=>{const u=d.cloneNode(!0);d.parentNode.replaceChild(u,d)}),document.querySelectorAll(".search-code-tab").forEach(d=>{d.addEventListener("click",u=>{document.querySelectorAll(".search-code-tab").forEach(p=>p.classList.remove("active")),u.currentTarget.classList.add("active"),this.currentCodeLang=u.currentTarget.dataset.lang,this.renderCode()})})},handleScenario(t){t==="first"?this.target=this.array[0]:t==="last"?this.target=this.array[this.array.length-1]:t==="missing"&&(this.target=999);const e=St("searchTarget");e&&(e.value=this.target),T==null||T(`Scenario: ${t}`,"info")},switchAlgorithm(t){this.currentAlgo=t,[document.getElementById("searchAlgoSelect"),document.getElementById("searchAlgoSelect2")].filter(Boolean).forEach(i=>{i.value!==t&&(i.value=t)}),this.reset(),this.renderCode()},start(){let t="";const e=document.getElementById("searchTarget2"),i=document.getElementById("searchTarget");if(e)t=e.value.trim();else if(i)t=i.value.trim();else return;if(t===""){T==null||T("Please enter a target number","warning");return}if(this.target=parseInt(t,10),isNaN(this.target)){T==null||T("Invalid target number","error");return}const s=document.getElementById("searchAlgoSelect2"),r=document.getElementById("searchAlgoSelect");s?this.currentAlgo=s.value:r&&(this.currentAlgo=r.value),this.steps=[],this.stepIndex=0,this.eliminated=new Set,this.array=this.array.map(n=>Number(n)),this.currentAlgo!=="linear"&&(this.array.sort((n,a)=>n-a),this.renderArray()),this.generateSteps(),this.steps.length!==0&&(this.isPlaying=!0,this.updatePlayPauseButton(),this.autoPlay())},parseInput(){let t="";const e=document.getElementById("searchCustomInput2"),i=document.getElementById("searchCustomInput");if(e)t=e.value.trim();else if(i)t=i.value.trim();else return;if(!t)return;const r=t.split(/[,\s]+/).filter(n=>n!=="").map(n=>parseInt(n,10)).filter(n=>!isNaN(n));r.length>0?(this.currentAlgo!=="linear"&&r.sort((n,a)=>n-a),this.array=r,this.reset(),this.resetScenario(),T==null||T("Custom array loaded","success")):T==null||T("Invalid array input","error")},randomize(){const e=[];let i=Math.floor(Math.random()*50)+10;for(let s=0;s<15;s++)e.push(i),i+=Math.floor(Math.random()*40)+5;this.array=e,this.reset(),this.resetScenario()},getSpeed(){const t=document.getElementById("speedSlider");return t?2e3-parseInt(t.value)*19:1e3},generateSteps(){this.steps=[],this.currentAlgo==="linear"?this.generateLinearSearchSteps():this.currentAlgo==="ternary"?this.generateTernarySearchSteps():this.generateBinarySearchSteps()},generateLinearSearchSteps(){let t=0,e=0,i=0;for(let s=0;s<this.array.length;s++)if(t++,i+=4,this.steps.push({currentIndex:s,status:"checking",explanation:`Checking index ${s} (Value: ${this.array[s]})`,metrics:{comparisons:t,discarded:e,memory:i}}),this.array[s]===this.target){this.steps.push({currentIndex:s,status:"found",explanation:`âœ… Found target ${this.target} at index ${s}!`,metrics:{comparisons:t,discarded:e,memory:i}});return}this.steps.push({currentIndex:-1,status:"not-found",explanation:`âŒ Target ${this.target} not found.`,metrics:{comparisons:t,discarded:e,memory:i}})},generateBinarySearchSteps(){let t=0,e=this.array.length-1,i=0,s=0,r=0,n=0;for(;t<=e&&n++<100;){const a=Math.floor((t+e)/2);if(i++,r+=4,this.steps.push({low:t,high:e,mid:a,status:"checking",explanation:`Checking Mid [${a}] (Value: ${this.array[a]})`,metrics:{comparisons:i,discarded:s,memory:r}}),this.array[a]===this.target){this.steps.push({low:t,high:e,mid:a,status:"found",explanation:`âœ… Found target ${this.target} at index ${a}`,metrics:{comparisons:i,discarded:s,memory:r}});return}else this.array[a]<this.target?(s++,this.steps.push({low:a+1,high:e,mid:a,status:"eliminate-left",explanation:`${this.array[a]} < ${this.target}. Searching Right.`,eliminateRange:[t,a],metrics:{comparisons:i,discarded:s,memory:r}}),t=a+1):(s++,this.steps.push({low:t,high:a-1,mid:a,status:"eliminate-right",explanation:`${this.array[a]} > ${this.target}. Searching Left.`,eliminateRange:[a,e],metrics:{comparisons:i,discarded:s,memory:r}}),e=a-1)}this.steps.push({low:-1,high:-1,mid:-1,status:"not-found",explanation:`âŒ Target ${this.target} not found.`,metrics:{comparisons:i,discarded:s,memory:r}})},generateTernarySearchSteps(){let t=0,e=this.array.length-1,i=0,s=0,r=0,n=0;for(;e>=t&&n++<100;){let a=e-t,o=t+Math.floor(a/3),l=e-Math.floor(a/3);if(o===l&&a>0&&(l=o+1),l>e&&(l=e),i+=2,r+=8,this.steps.push({low:t,high:e,mid1:o,mid2:l,mid:o,status:"checking",explanation:`Checking M1 [${o}] & M2 [${l}]. Target: ${this.target}`,metrics:{comparisons:i,discarded:s,memory:r}}),this.array[o]===this.target){this.steps.push({low:t,high:e,mid1:o,mid2:l,mid:o,status:"found",explanation:`âœ… Found at M1 [${o}]!`,metrics:{comparisons:i,discarded:s,memory:r}});return}if(this.array[l]===this.target){this.steps.push({low:t,high:e,mid1:o,mid2:l,mid:l,status:"found",explanation:`âœ… Found at M2 [${l}]!`,metrics:{comparisons:i,discarded:s,memory:r}});return}this.target<this.array[o]?(s++,this.steps.push({low:t,high:e,mid1:o,mid2:l,status:"eliminate-rest",eliminateRange:[o,e],explanation:`Target ${this.target} < ${this.array[o]}. Search Left.`,metrics:{comparisons:i,discarded:s,memory:r}}),e=o-1):this.target>this.array[l]?(s++,this.steps.push({low:t,high:e,mid1:o,mid2:l,status:"eliminate-rest",eliminateRange:[t,l],explanation:`Target ${this.target} > ${this.array[l]}. Search Right.`,metrics:{comparisons:i,discarded:s,memory:r}}),t=l+1):(s++,this.steps.push({low:t,high:e,mid1:o,mid2:l,status:"eliminate-sides",eliminateLeft:[t,o],eliminateRight:[l,e],explanation:`Target ${this.target} between M1 & M2. Search Middle.`,metrics:{comparisons:i,discarded:s,memory:r}}),t=o+1,e=l-1)}this.steps.push({low:-1,high:-1,mid:-1,status:"not-found",explanation:`âŒ Target ${this.target} not found.`,metrics:{comparisons:i,discarded:s,memory:r}})},async autoPlay(){var a;if(!this.isPlaying)return;if(this.stepIndex>=this.steps.length){this.isPlaying=!1,this.updatePlayPauseButton();return}const t=this.steps[this.stepIndex],e=this.stepIndex>0?this.steps[this.stepIndex-1]:null,i=this.getSpeed()*.4,s=o=>new Promise(l=>{this.animationTimeout=setTimeout(l,o)}),r={low:t.low,high:t.high,mid:e?e.mid:-1,mid1:e?e.mid1:-1,mid2:e?e.mid2:-1,activeIdx:t.currentIndex};if(this.renderRefPointers(r),this.updateHudVariables(r),i>50&&await s(i),this.renderRefPointers({low:t.low,high:t.high,mid:t.mid,mid1:t.mid1,mid2:t.mid2,activeIdx:t.currentIndex}),this.updateHudVariables(t),i>50&&await s(i),t.eliminateRange)for(let o=t.eliminateRange[0];o<=t.eliminateRange[1];o++)this.eliminated.add(o);if(t.eliminateLeft)for(let o=t.eliminateLeft[0];o<=t.eliminateLeft[1];o++)this.eliminated.add(o);if(t.eliminateRight)for(let o=t.eliminateRight[0];o<=t.eliminateRight[1];o++)this.eliminated.add(o);if(t.eliminateSides,this.renderArray(t),this.updateStepIndicator(),t.status==="found"||t.status==="not-found"){this.handleCompletion(t);return}(a=O==null?void 0:O.play)==null||a.call(O,"card_flip"),this.stepIndex++;const n=this.getSpeed();this.animationId=setTimeout(()=>this.autoPlay(),n)},updateHudVariables(t){const e=(i,s)=>{[document.getElementById(i),document.getElementById(i+"2")].filter(Boolean).forEach(n=>{n.textContent=s!=null&&s!==-1?s:"-"})};this.currentAlgo==="linear"?(e("hudLow",t.activeIdx),e("hudMid","-"),e("hudHigh","-")):this.currentAlgo==="ternary"?(e("hudLow",t.low),e("hudHigh",t.high),t.mid1!==void 0?e("hudMid",`M1:${t.mid1} M2:${t.mid2}`):e("hudMid","-")):(e("hudLow",t.low),e("hudHigh",t.high),e("hudMid",t.mid))},handleCompletion(t){var r,n;this.isPlaying=!1,this.updatePlayPauseButton();const e=this.currentAlgo==="linear"?t.currentIndex:t.mid,i=(a,o)=>{[document.getElementById(a),document.getElementById(a+"2")].filter(Boolean).forEach(c=>c.textContent=o)},s=t.status==="found"?e:"âœ—";i("varFound",s),i("searchResultValue",s),t.status==="found"?(r=O==null?void 0:O.play)==null||r.call(O,"sql_run_success"):(n=O==null?void 0:O.play)==null||n.call(O,"error")},togglePlayPause(){this.isPlaying=!this.isPlaying,this.updatePlayPauseButton(),this.isPlaying?(this.array.length===0&&this.randomize(),this.stepIndex>=this.steps.length&&this.steps.length>0&&this.reset(),this.steps.length===0?this.start():this.autoPlay()):(this.animationId&&clearTimeout(this.animationId),this.animationTimeout&&clearTimeout(this.animationTimeout))},reset(){this.animationId&&clearTimeout(this.animationId),this.animationTimeout&&clearTimeout(this.animationTimeout),this.isPlaying=!1,this.stepIndex=0,this.eliminated=new Set,this.steps=[],this.renderArray(),this.updateHudVariables({low:0,high:this.array.length-1,mid:-1}),this.updatePlayPauseButton(),this.updateStepIndicator()},renderCode(){const t=St("searchCodeContainer");if(t){const e=this.codeSnippets[this.currentAlgo][this.currentCodeLang];t.innerHTML=`<div class="code-block" style="margin:0; box-shadow:none; border:none;"><pre style="margin: 0; white-space: pre-wrap; background: transparent; padding: 0.5rem;"><code>${this.escapeHtml(e)}</code></pre></div>`}},escapeHtml(t){return t.replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;")},renderArray(t=null){if(!St("searchVisualization"))return;let i=-1,s=-1,r=-1,n=-1,a=-1,o=-1,l=-1;const c=this.eliminated||new Set;t?this.currentAlgo==="linear"?(i=t.currentIndex,t.status==="found"&&(s=t.currentIndex)):this.currentAlgo==="ternary"?(r=t.low,a=t.high,o=t.mid1,l=t.mid2,t.status==="found"&&(s=t.mid)):(r=t.low,n=t.mid,a=t.high,t.status==="found"&&(s=t.mid)):(r=0,a=this.array.length-1),t||this.updateHudVariables({low:r,high:a,mid:-1,mid1:-1,mid2:-1});const h=this.array.map((u,p)=>{let f=["ref-node"];s===p?f.push("found"):(i===p||this.currentAlgo==="binary"&&n===p||this.currentAlgo==="ternary"&&(o===p||l===p))&&f.push("active"),c.has(p)&&f.push("eliminated");const g=`0x${(1e3+p).toString(16).toUpperCase()}`,m=typeof u=="number"?u:parseInt(u);return`
        <div class="${f.join(" ")}" data-index="${p}" data-address="${g}">
           ${m}
        </div>
      `}).join("");[document.getElementById("searchVisualization"),document.getElementById("searchVisualization2")].filter(Boolean).forEach(u=>u.innerHTML=h),this.renderRefPointers({low:r,high:a,mid:n,mid1:o,mid2:l,activeIdx:i})},renderRefPointers(t){const{low:e,high:i,mid:s,mid1:r,mid2:n,activeIdx:a}=t||{};["","2"].forEach(l=>{const c=document.getElementById("searchPointerContainer"+l),h=c?c.closest(".search-ref-stage"):null;if(!c||!h)return;const d=h.querySelectorAll(".ref-node");if(d.length===0)return;const u=c.getBoundingClientRect(),p=(m,y,b,w=0)=>{const k=`ptr-${l}-${m}`;let x=document.getElementById(k);if(x||(x=document.createElement("div"),x.id=k,x.className=`ref-pointer ptr-${m}`,x.innerHTML=`<div class="ref-pointer-arrow"></div><div class="ref-pointer-label">${b}</div>`,c.appendChild(x)),y>=0&&d[y]){const _=d[y].getBoundingClientRect(),R=_.left-u.left+_.width/2,C=_.bottom-u.top+10+w;x.style.left=`${R}px`,x.style.top=`${C}px`,x.style.opacity="1",x.style.transform="translateX(-50%)"}else x.style.opacity="0"};this.currentAlgo==="linear"?(p("mid",a,"i"),p("low",-1,""),p("high",-1,"")):this.currentAlgo==="ternary"?(p("low",e,"L",0),p("high",i,"R",0),p("mid",r,"M1",35)):(p("low",e,"L",0),p("high",i,"H",0),p("mid",s,"M",35));const f=`ptr-${l}-m2`;let g=document.getElementById(f);if(g||(g=document.createElement("div"),g.id=f,g.className="ref-pointer ptr-mid",g.innerHTML='<div class="ref-pointer-arrow"></div><div class="ref-pointer-label">M2</div>',c.appendChild(g)),this.currentAlgo==="ternary"&&n>=0&&d[n]){const y=d[n].getBoundingClientRect(),b=y.left-u.left+y.width/2,w=y.bottom-u.top+10+35;g.style.left=`${b}px`,g.style.top=`${w}px`,g.style.opacity="1",g.style.transform="translateX(-50%)"}else g.style.opacity="0"})},updatePointers(t,e,i){},updatePlayPauseButton(){const t=St("btnSearchPlayPause");t&&(t.innerHTML=this.isPlaying?"â¸ï¸ Pause":"â–¶ï¸ Play")},updateStepIndicator(){const t=St("searchStepIndicator");t&&(t.textContent=`Step ${this.stepIndex} / ${this.steps.length}`)},skipBack(){this.isPlaying=!1,this.stepIndex=0,this.eliminated=new Set,this.reset()},stepBack(){if(this.isPlaying=!1,this.stepIndex>0){this.stepIndex--,this.eliminated=new Set;for(let t=0;t<this.stepIndex;t++){const e=this.steps[t];if(e.eliminateRange)for(let i=e.eliminateRange[0];i<=e.eliminateRange[1];i++)this.eliminated.add(i);if(e.eliminateLeft)for(let i=e.eliminateLeft[0];i<=e.eliminateLeft[1];i++)this.eliminated.add(i);if(e.eliminateRight)for(let i=e.eliminateRight[0];i<=e.eliminateRight[1];i++)this.eliminated.add(i);if(e.eliminateSides){if(e.eliminateLeft&&e.eliminateLeft.forEach(i=>this.eliminated.add(i)),e.eliminateLeft&&Array.isArray(e.eliminateLeft))for(let i=e.eliminateLeft[0];i<=e.eliminateLeft[1];i++)this.eliminated.add(i);if(e.eliminateRight&&Array.isArray(e.eliminateRight))for(let i=e.eliminateRight[0];i<=e.eliminateRight[1];i++)this.eliminated.add(i)}}this.renderArray(this.steps[this.stepIndex])}},stepForward(){if(this.isPlaying=!1,this.stepIndex<this.steps.length){const t=this.steps[this.stepIndex];if(t.eliminateRange)for(let e=t.eliminateRange[0];e<=t.eliminateRange[1];e++)this.eliminated.add(e);if(t.eliminateLeft)for(let e=t.eliminateLeft[0];e<=t.eliminateLeft[1];e++)this.eliminated.add(e);if(t.eliminateRight)for(let e=t.eliminateRight[0];e<=t.eliminateRight[1];e++)this.eliminated.add(e);this.renderArray(t),this.stepIndex++,this.updateStepIndicator()}},skipForward(){this.isPlaying=!1,this.stepIndex=this.steps.length-1;for(let t=0;t<=this.stepIndex;t++){const e=this.steps[t];if(e.eliminateRange)for(let i=e.eliminateRange[0];i<=e.eliminateRange[1];i++)this.eliminated.add(i);if(e.eliminateLeft)for(let i=e.eliminateLeft[0];i<=e.eliminateLeft[1];i++)this.eliminated.add(i);if(e.eliminateRight)for(let i=e.eliminateRight[0];i<=e.eliminateRight[1];i++)this.eliminated.add(i)}this.renderArray(this.steps[this.stepIndex]),this.updateStepIndicator()},scrollToVisualization(){const t=St("viz-panel-searching");t&&(t.scrollIntoView({behavior:"smooth",block:"start"}),setTimeout(()=>window.scrollBy({top:80,behavior:"smooth"}),300))}};typeof window<"u"&&(window.SearchViz=V0);const gg=t=>document.getElementById(t),z0={currentCategory:"sorting",categories:{sorting:{name:"Sorting",algorithms:["bubble","selection","insertion","merge","quick","heap"],description:"Watch how different sorting algorithms organize data step by step."},searching:{name:"Searching",algorithms:["linear","binary"],description:"See how search algorithms find elements in data."},"divide-conquer":{name:"Divide & Conquer",algorithms:["merge-tree","quick-partition","binary-search-tree"],description:"Visualize how problems are split, solved, and combined."},dp:{name:"Dynamic Programming",algorithms:["fibonacci","climbing-stairs","coin-change"],description:"Watch how DP builds solutions from subproblems."},greedy:{name:"Greedy",algorithms:["activity-selection","coin-greedy"],description:"See how greedy algorithms make locally optimal choices."}},init(){this.bindTabListeners(),this.updateActiveTabFromRoute(),window.addEventListener("hashchange",()=>{this.rebindTabs()})},bindTabListeners(){document.querySelectorAll(".viz-tab").forEach(t=>{const e=t.cloneNode(!0);t.parentNode.replaceChild(e,t)}),document.querySelectorAll(".viz-tab").forEach(t=>{t.addEventListener("click",e=>{const i=e.target.dataset.vizCategory;this.navigateToCategory(i)})})},rebindTabs(){setTimeout(()=>{this.bindTabListeners(),this.updateActiveTabFromRoute()},50)},navigateToCategory(t){var s,r;const i={sorting:"/algorithms",searching:"/searching","divide-conquer":"/divide-conquer"}[t];i&&((s=window.Router)!=null&&s.navigateTo)?window.Router.navigateTo(i):i&&(window.location.hash=i),(r=O==null?void 0:O.play)==null||r.call(O,"card_flip")},updateActiveTabFromRoute(){const t=window.location.hash.slice(1)||"/dashboard",i={"/algorithms":"sorting","/searching":"searching","/divide-conquer":"divide-conquer"}[t];i&&(this.currentCategory=i,document.querySelectorAll(".viz-tab").forEach(s=>{s.dataset.vizCategory===i?(s.style.background="var(--accent-forest)",s.style.color="white",s.classList.add("active")):(s.style.background="transparent",s.style.color="var(--text-body)",s.classList.remove("active"))}))},switchCategory(t){this.navigateToCategory(t)},showCategoryContent(t){document.querySelectorAll(".viz-category-panel").forEach(s=>{s.style.display="none"});const e=gg(`viz-panel-${t}`);e&&(e.style.display="block");const i=gg("sortingVizContent");i&&(i.style.display=t==="sorting"?"block":"none")}};typeof window<"u"&&(window.UnifiedViz=z0);const F2=t=>document.getElementById(t);function U2(t,e=null){if(!t)return null;const i=t.getContext("2d");if(!i)return null;const s=window.devicePixelRatio||1,r=t.getBoundingClientRect();t.width=r.width*s,t.height=r.height*s,i.scale(s,s);const n=r.width,a=r.height;return i.clearRect(0,0,n,a),e&&(i.fillStyle=e,i.fillRect(0,0,n,a)),{ctx:i,w:n,h:a}}const be={currentModule:null,renderCanvas(t,e){const i=F2(t),s=U2(i);s&&e(s.ctx,s.w,s.h)},roundRect(t,e,i,s,r,n){t.beginPath(),t.moveTo(e+n,i),t.lineTo(e+s-n,i),t.quadraticCurveTo(e+s,i,e+s,i+n),t.lineTo(e+s,i+r-n),t.quadraticCurveTo(e+s,i+r,e+s-n,i+r),t.lineTo(e+n,i+r),t.quadraticCurveTo(e,i+r,e,i+r-n),t.lineTo(e,i+n),t.quadraticCurveTo(e,i,e+n,i),t.closePath()},diamond(t,e,i,s,r){t.beginPath(),t.moveTo(e,i-r/2),t.lineTo(e+s/2,i),t.lineTo(e,i+r/2),t.lineTo(e-s/2,i),t.closePath()},ellipse(t,e,i,s,r){t.beginPath(),t.ellipse(e,i,s,r,0,0,Math.PI*2),t.closePath()},textCentered(t,e,i,s,r="bold 12px Inter",n="#1F2322"){t.font=r,t.fillStyle=n,t.textAlign="center",t.textBaseline="middle",t.fillText(e,i,s)},line(t,e,i,s,r,n=!1,a="#5F6663",o=2){if(t.strokeStyle=a,t.lineWidth=o,t.beginPath(),t.moveTo(e,i),t.lineTo(s,r),t.stroke(),n){const l=Math.atan2(r-i,s-e),c=10;t.beginPath(),t.moveTo(s,r),t.lineTo(s-c*Math.cos(l-Math.PI/6),r-c*Math.sin(l-Math.PI/6)),t.moveTo(s,r),t.lineTo(s-c*Math.cos(l+Math.PI/6),r-c*Math.sin(l+Math.PI/6)),t.stroke()}},colors:{entity:"#2F6A57",entityFill:"#E8F5E9",relationship:"#D4A853",relationshipFill:"#FFF9E8",attribute:"#5B8BA0",attributeFill:"#E3F2FD",key:"#C44536",keyFill:"#FFEBEE",text:"#1F2322",textMuted:"#5F6663",line:"#5F6663",highlight:"#8B687F",highlightFill:"#F3E5F5",bg:"#FFFEFA"},init(){console.log("[DBConcepts] Initializing database concepts module..."),this.bindEvents(),console.log("[DBConcepts] âœ… Database concepts module initialized")},bindEvents(){},getConnectionPoint(t,e){const i=t.x+t.w/2,s=t.y+t.h/2,r=e.x+e.w/2,n=e.y+e.h/2,a=Math.atan2(n-s,r-i),o=t.w/2,l=t.h/2;let c,h;return Math.abs(Math.cos(a))*l>Math.abs(Math.sin(a))*o?(c=i+(Math.cos(a)>0?o:-o),h=s+Math.tan(a)*(c-i)):(h=s+(Math.sin(a)>0?l:-l),c=i+(h-s)/Math.tan(a)),{x:c,y:h}},success(t){var e;T(`âœ… ${t}`),(e=O==null?void 0:O.play)==null||e.call(O,"success")},error(t){var e;T(`âŒ ${t}`,"error"),(e=O==null?void 0:O.play)==null||e.call(O,"error")},info(t){var e;T(`ðŸ’¡ ${t}`),(e=O==null?void 0:O.play)==null||e.call(O,"click")}};typeof window<"u"&&(window.DBConcepts=be);const $r={entities:[],relationships:[],selectedEntity:null,selectedRelationship:null,dragTarget:null,dragOffset:{x:0,y:0},notation:"chen",sampleERD:{entities:[{id:"student",name:"STUDENT",x:80,y:120,w:120,h:50,attributes:[{name:"student_id",isKey:!0},{name:"name",isKey:!1},{name:"email",isKey:!1}]},{id:"course",name:"COURSE",x:420,y:120,w:120,h:50,attributes:[{name:"course_id",isKey:!0},{name:"title",isKey:!1},{name:"credits",isKey:!1}]},{id:"instructor",name:"INSTRUCTOR",x:420,y:280,w:120,h:50,attributes:[{name:"instructor_id",isKey:!0},{name:"name",isKey:!1},{name:"department",isKey:!1}]}],relationships:[{id:"enrolls",name:"ENROLLS",entity1:"student",entity2:"course",cardinality:"M:N",x:250,y:120},{id:"teaches",name:"TEACHES",entity1:"instructor",entity2:"course",cardinality:"1:N",x:420,y:200}]},init(){console.log("[ERDVisualizer] Initializing..."),this.loadSampleERD(),this.bindEvents(),this.render(),console.log("[ERDVisualizer] âœ… Initialized")},loadSampleERD(){this.entities=JSON.parse(JSON.stringify(this.sampleERD.entities)),this.relationships=JSON.parse(JSON.stringify(this.sampleERD.relationships))},bindEvents(){var e,i,s,r,n,a,o;const t=v("erdCanvas");t&&(t.addEventListener("mousedown",l=>this.onMouseDown(l)),t.addEventListener("mousemove",l=>this.onMouseMove(l)),t.addEventListener("mouseup",l=>this.onMouseUp(l)),t.addEventListener("mouseleave",()=>this.onMouseUp())),(e=v("btnErdAddEntity"))==null||e.addEventListener("click",()=>this.addEntity()),(i=v("btnErdAddRelationship"))==null||i.addEventListener("click",()=>this.addRelationship()),(s=v("btnErdReset"))==null||s.addEventListener("click",()=>this.reset()),(r=v("btnErdNotation"))==null||r.addEventListener("click",()=>this.toggleNotation()),(n=v("btnErdSaveEntity"))==null||n.addEventListener("click",()=>this.saveEntityEdit()),(a=v("btnErdDeleteEntity"))==null||a.addEventListener("click",()=>this.deleteSelectedEntity()),(o=v("btnErdAddAttribute"))==null||o.addEventListener("click",()=>this.addAttributeToEditor())},getMousePos(t){const e=v("erdCanvas");if(!e)return{x:0,y:0};const i=e.getBoundingClientRect();return{x:t.clientX-i.left,y:t.clientY-i.top}},onMouseDown(t){var i,s;const e=this.getMousePos(t);for(const r of this.entities)if(this.isPointInRect(e,r)){this.dragTarget=r,this.dragOffset={x:e.x-r.x,y:e.y-r.y},this.selectEntity(r),(i=O==null?void 0:O.play)==null||i.call(O,"click");return}for(const r of this.relationships)if(this.isPointInDiamond(e,r)){this.dragTarget=r,this.dragOffset={x:e.x-r.x,y:e.y-r.y},this.selectRelationship(r),(s=O==null?void 0:O.play)==null||s.call(O,"click");return}this.selectedEntity=null,this.selectedRelationship=null,this.hideEditor(),this.render()},onMouseMove(t){if(!this.dragTarget)return;const e=this.getMousePos(t);this.dragTarget.x=e.x-this.dragOffset.x,this.dragTarget.y=e.y-this.dragOffset.y;const i=v("erdCanvas");if(i){const s=i.getBoundingClientRect(),r=this.dragTarget.w||80,n=this.dragTarget.h||40;this.dragTarget.x=Math.max(0,Math.min(s.width-r,this.dragTarget.x)),this.dragTarget.y=Math.max(0,Math.min(s.height-n,this.dragTarget.y))}this.render()},onMouseUp(){this.dragTarget=null},isPointInRect(t,e){return t.x>=e.x&&t.x<=e.x+e.w&&t.y>=e.y&&t.y<=e.y+e.h},isPointInDiamond(t,e){const i=e.x,s=e.y,r=40,n=25,a=Math.abs(t.x-i)/r,o=Math.abs(t.y-s)/n;return a+o<=1},selectEntity(t){this.selectedEntity=t,this.selectedRelationship=null,this.showEntityEditor(t),this.render()},selectRelationship(t){this.selectedRelationship=t,this.selectedEntity=null,this.showRelationshipEditor(t),this.render()},addEntity(){var r;const t="entity_"+Date.now(),e=v("erdCanvas"),i=e?e.getBoundingClientRect().width:600,s={id:t,name:"NEW_ENTITY",x:Math.random()*(i-150)+25,y:Math.random()*150+50,w:120,h:50,attributes:[{name:"id",isKey:!0}]};this.entities.push(s),this.selectEntity(s),this.render(),T("âž• Entity added! Click to edit."),(r=O==null?void 0:O.play)==null||r.call(O,"ds_insert")},addRelationship(){var r;if(this.entities.length<2){T("Add at least 2 entities first!","error");return}const t="rel_"+Date.now(),e=this.entities[0],i=this.entities[1],s={id:t,name:"RELATES",entity1:e.id,entity2:i.id,cardinality:"1:N",x:(e.x+i.x+e.w)/2,y:(e.y+i.y+e.h)/2};this.relationships.push(s),this.selectRelationship(s),this.render(),T("âž• Relationship added! Drag to position."),(r=O==null?void 0:O.play)==null||r.call(O,"ds_insert")},deleteSelectedEntity(){var t;this.selectedEntity&&(this.relationships=this.relationships.filter(e=>e.entity1!==this.selectedEntity.id&&e.entity2!==this.selectedEntity.id),this.entities=this.entities.filter(e=>e.id!==this.selectedEntity.id),this.selectedEntity=null,this.hideEditor(),this.render(),T("ðŸ—‘ï¸ Entity deleted"),(t=O==null?void 0:O.play)==null||t.call(O,"ds_remove"))},reset(){var t;this.loadSampleERD(),this.selectedEntity=null,this.selectedRelationship=null,this.hideEditor(),this.render(),T("ðŸ”„ ERD reset to sample"),(t=O==null?void 0:O.play)==null||t.call(O,"reset")},toggleNotation(){var i;this.notation=this.notation==="chen"?"crowsfoot":"chen",this.render();const t=this.notation==="chen"?"Chen Notation":"Crow's Foot Notation";T(`ðŸ”„ Switched to ${t}`),(i=O==null?void 0:O.play)==null||i.call(O,"click");const e=v("btnErdNotation");e&&(e.textContent=this.notation==="chen"?"ðŸ¦¶ Crow's Foot":"ðŸ’Ž Chen")},showEntityEditor(t){var s;const e=v("erdEntityEditor");if(!e)return;e.style.display="block",(s=v("erdRelEditor"))!=null&&s.style&&(v("erdRelEditor").style.display="none"),v("erdEntityName").value=t.name;const i=v("erdAttributesList");i&&(i.innerHTML=t.attributes.map((r,n)=>`
        <div class="erd-attr-row" data-index="${n}">
          <input type="checkbox" ${r.isKey?"checked":""} onchange="ERDVisualizer.toggleAttrKey(${n})">
          <input type="text" value="${r.name}" class="input-field" style="flex:1" onchange="ERDVisualizer.updateAttrName(${n}, this.value)">
          <button class="btn btn-small" onclick="ERDVisualizer.removeAttribute(${n})">âœ•</button>
        </div>
      `).join(""))},showRelationshipEditor(t){var n;const e=v("erdRelEditor");if(!e)return;e.style.display="block",(n=v("erdEntityEditor"))!=null&&n.style&&(v("erdEntityEditor").style.display="none"),v("erdRelName").value=t.name;const i=v("erdRelEntity1"),s=v("erdRelEntity2"),r=v("erdRelCardinality");i&&(i.innerHTML=this.entities.map(a=>`<option value="${a.id}" ${a.id===t.entity1?"selected":""}>${a.name}</option>`).join("")),s&&(s.innerHTML=this.entities.map(a=>`<option value="${a.id}" ${a.id===t.entity2?"selected":""}>${a.name}</option>`).join("")),r&&(r.value=t.cardinality)},hideEditor(){var t,e;(t=v("erdEntityEditor"))!=null&&t.style&&(v("erdEntityEditor").style.display="none"),(e=v("erdRelEditor"))!=null&&e.style&&(v("erdRelEditor").style.display="none")},saveEntityEdit(){var t,e,i;this.selectedEntity&&(this.selectedEntity.name=((e=(t=v("erdEntityName"))==null?void 0:t.value)==null?void 0:e.toUpperCase())||"ENTITY",this.render(),T("âœ… Entity updated"),(i=O==null?void 0:O.play)==null||i.call(O,"success"))},toggleAttrKey(t){this.selectedEntity&&(this.selectedEntity.attributes[t].isKey=!this.selectedEntity.attributes[t].isKey,this.render())},updateAttrName(t,e){this.selectedEntity&&(this.selectedEntity.attributes[t].name=e,this.render())},addAttributeToEditor(){var t;this.selectedEntity&&(this.selectedEntity.attributes.push({name:"new_attr",isKey:!1}),this.showEntityEditor(this.selectedEntity),this.render(),(t=O==null?void 0:O.play)==null||t.call(O,"ds_insert"))},removeAttribute(t){var e;this.selectedEntity&&(this.selectedEntity.attributes.splice(t,1),this.showEntityEditor(this.selectedEntity),this.render(),(e=O==null?void 0:O.play)==null||e.call(O,"ds_remove"))},saveRelationshipEdit(){var t,e,i,s,r,n;this.selectedRelationship&&(this.selectedRelationship.name=((e=(t=v("erdRelName"))==null?void 0:t.value)==null?void 0:e.toUpperCase())||"RELATES",this.selectedRelationship.entity1=(i=v("erdRelEntity1"))==null?void 0:i.value,this.selectedRelationship.entity2=(s=v("erdRelEntity2"))==null?void 0:s.value,this.selectedRelationship.cardinality=((r=v("erdRelCardinality"))==null?void 0:r.value)||"1:N",this.render(),T("âœ… Relationship updated"),(n=O==null?void 0:O.play)==null||n.call(O,"success"))},render(){be.renderCanvas("erdCanvas",(t,e,i)=>{const s=be.colors;this.drawGrid(t,e,i);for(const r of this.relationships)this.drawRelationship(t,r,r===this.selectedRelationship);for(const r of this.entities)this.drawEntity(t,r,r===this.selectedEntity);t.font="bold 11px Inter",t.fillStyle=s.textMuted,t.textAlign="right",t.fillText(`Notation: ${this.notation==="chen"?"Chen":"Crow's Foot"}`,e-10,i-10)})},drawGrid(t,e,i){t.strokeStyle="rgba(0,0,0,0.05)",t.lineWidth=1;const s=20;for(let r=0;r<e;r+=s)t.beginPath(),t.moveTo(r,0),t.lineTo(r,i),t.stroke();for(let r=0;r<i;r+=s)t.beginPath(),t.moveTo(0,r),t.lineTo(e,r),t.stroke()},drawEntity(t,e,i){const s=be.colors,r=e.x,n=e.y,a=e.w,o=e.h;if(t.fillStyle=i?s.highlightFill:s.entityFill,t.strokeStyle=i?s.highlight:s.entity,t.lineWidth=i?3:2,be.roundRect(t,r,n,a,o,8),t.fill(),t.stroke(),t.font="bold 14px Inter",t.fillStyle=s.text,t.textAlign="center",t.textBaseline="middle",t.fillText(e.name,r+a/2,n+o/2),e.attributes){const c=n-30;e.attributes.forEach((h,d)=>{const u=r+(d-(e.attributes.length-1)/2)*50+a/2,p=c;if(t.strokeStyle=s.line,t.lineWidth=1,t.beginPath(),t.moveTo(r+a/2,n),t.lineTo(u,p+12),t.stroke(),t.fillStyle=h.isKey?s.keyFill:s.attributeFill,t.strokeStyle=h.isKey?s.key:s.attribute,t.lineWidth=h.isKey?2:1.5,be.ellipse(t,u,p,35,14),t.fill(),t.stroke(),t.font=h.isKey?"bold 10px Inter":"10px Inter",t.fillStyle=s.text,t.textAlign="center",t.textBaseline="middle",t.fillText(h.name,u,p),h.isKey){const f=t.measureText(h.name).width;t.strokeStyle=s.key,t.lineWidth=1,t.beginPath(),t.moveTo(u-f/2,p+6),t.lineTo(u+f/2,p+6),t.stroke()}})}},drawRelationship(t,e,i){const s=be.colors,r=this.entities.find(h=>h.id===e.entity1),n=this.entities.find(h=>h.id===e.entity2);if(!r||!n)return;const a=e.x,o=e.y,l={x:r.x+r.w/2,y:r.y+r.h/2},c={x:n.x+n.w/2,y:n.y+n.h/2};t.strokeStyle=s.line,t.lineWidth=2,t.beginPath(),t.moveTo(l.x,l.y),t.lineTo(a,o),t.stroke(),t.beginPath(),t.moveTo(a,o),t.lineTo(c.x,c.y),t.stroke(),this.drawCardinality(t,e,l,c,a,o),t.fillStyle=i?s.highlightFill:s.relationshipFill,t.strokeStyle=i?s.highlight:s.relationship,t.lineWidth=i?3:2,be.diamond(t,a,o,80,50),t.fill(),t.stroke(),t.font="bold 11px Inter",t.fillStyle=s.text,t.textAlign="center",t.textBaseline="middle",t.fillText(e.name,a,o)},drawCardinality(t,e,i,s,r,n){const a=be.colors,o=e.cardinality.split(":"),l=o[0]||"1",c=o[1]||"N";if(this.notation==="chen"){t.font="bold 14px Inter",t.fillStyle=a.relationship;const h=this.getMidpoint(i,{x:r,y:n},.3);t.textAlign="center",t.fillText(l,h.x,h.y-15);const d=this.getMidpoint({x:r,y:n},s,.7);t.fillText(c,d.x,d.y-15)}else this.drawCrowsFootSymbol(t,i,{x:r,y:n},l),this.drawCrowsFootSymbol(t,s,{x:r,y:n},c)},drawCrowsFootSymbol(t,e,i,s){const r=be.colors,n=40,a=Math.atan2(i.y-e.y,i.x-e.x),o=e.x+Math.cos(a)*n,l=e.y+Math.sin(a)*n;t.strokeStyle=r.relationship,t.lineWidth=2,s==="N"||s==="M"?(t.beginPath(),t.moveTo(o,l),t.lineTo(o+15*Math.cos(a+.4),l+15*Math.sin(a+.4)),t.moveTo(o,l),t.lineTo(o+15*Math.cos(a),l+15*Math.sin(a)),t.moveTo(o,l),t.lineTo(o+15*Math.cos(a-.4),l+15*Math.sin(a-.4)),t.stroke()):(t.beginPath(),t.moveTo(o-8*Math.cos(a+Math.PI/2),l-8*Math.sin(a+Math.PI/2)),t.lineTo(o+8*Math.cos(a+Math.PI/2),l+8*Math.sin(a+Math.PI/2)),t.stroke())},getMidpoint(t,e,i=.5){return{x:t.x+(e.x-t.x)*i,y:t.y+(e.y-t.y)*i}},generateSQL(){var i,s;if(this.entities.length===0)return T("âš ï¸ No entities to generate SQL from","error"),"";const t=[];this.entities.forEach(r=>{const n=r.name.toLowerCase().replace(/\s+/g,"_"),a=[];r.attributes&&r.attributes.length>0?r.attributes.forEach(o=>{const l=o.name.toLowerCase();let c=`  ${l}`;l.includes("id")?c+=" INTEGER":l.includes("date")||l.includes("time")?c+=" DATETIME":l.includes("price")||l.includes("amount")||l.includes("salary")?c+=" DECIMAL(10,2)":l.includes("count")||l.includes("qty")||l.includes("credits")?c+=" INTEGER":c+=" VARCHAR(255)",o.isKey&&(c+=" PRIMARY KEY"),a.push(c)}):(a.push("  id INTEGER PRIMARY KEY"),a.push("  name VARCHAR(255)")),t.push(`CREATE TABLE ${n} (
${a.join(`,
`)}
);`)}),this.relationships.forEach(r=>{if(r.cardinality==="M:N"){const n=this.entities.find(o=>o.id===r.entity1),a=this.entities.find(o=>o.id===r.entity2);if(n&&a){const o=n.name.toLowerCase().replace(/\s+/g,"_"),l=a.name.toLowerCase().replace(/\s+/g,"_"),h=`CREATE TABLE ${`${o}_${l}`} (
  ${o}_id INTEGER,
  ${l}_id INTEGER,
  PRIMARY KEY (${o}_id, ${l}_id),
  FOREIGN KEY (${o}_id) REFERENCES ${o}(id),
  FOREIGN KEY (${l}_id) REFERENCES ${l}(id)
);`;t.push(h)}}}),this.relationships.forEach(r=>{if(r.cardinality==="1:N"||r.cardinality==="N:1"){const n=r.cardinality==="1:N"?this.entities.find(o=>o.id===r.entity2):this.entities.find(o=>o.id===r.entity1),a=r.cardinality==="1:N"?this.entities.find(o=>o.id===r.entity1):this.entities.find(o=>o.id===r.entity2);if(n&&a){const o=n.name.toLowerCase().replace(/\s+/g,"_"),l=a.name.toLowerCase().replace(/\s+/g,"_");t.push(`-- Add FK to ${o} for ${r.cardinality} relationship`),t.push(`ALTER TABLE ${o} ADD COLUMN ${l}_id INTEGER REFERENCES ${l}(id);`)}}});const e=t.join(`

`);return(i=navigator.clipboard)==null||i.writeText(e).then(()=>{T("ðŸ“‹ SQL copied to clipboard!","success")}).catch(()=>{T("ðŸ“ SQL generated (see console)","info")}),console.log(`[ERD â†’ SQL]
`+e),this.showSQLModal(e),(s=O==null?void 0:O.play)==null||s.call(O,"success"),e},showSQLModal(t){let e=document.getElementById("erdSqlModal");e||(e=document.createElement("div"),e.id="erdSqlModal",e.style.cssText=`
        position: fixed; top: 0; left: 0; right: 0; bottom: 0;
        background: rgba(0,0,0,0.7); display: flex; align-items: center;
        justify-content: center; z-index: 10000;
      `,e.innerHTML=`
        <div style="background: white; border-radius: 16px; padding: 2rem; max-width: 600px; width: 90%; max-height: 80vh; overflow: auto;">
          <h3 style="margin-top: 0;">ðŸ“„ Generated SQL</h3>
          <pre id="erdSqlContent" style="background: #1e1e1e; color: #d4d4d4; padding: 1rem; border-radius: 8px; overflow-x: auto; font-size: 0.85rem;"></pre>
          <div style="display: flex; gap: 1rem; margin-top: 1rem;">
            <button class="btn btn-primary" onclick="navigator.clipboard.writeText(document.getElementById('erdSqlContent').textContent); window.showToast?.('Copied!');">ðŸ“‹ Copy</button>
            <button class="btn btn-secondary" onclick="document.getElementById('erdSqlModal').remove();">âœ• Close</button>
          </div>
        </div>
      `,document.body.appendChild(e)),document.getElementById("erdSqlContent").textContent=t,e.style.display="flex",e.addEventListener("click",i=>{i.target===e&&e.remove()})}};typeof window<"u"&&(window.ERDVisualizer=$r);const it=t=>document.getElementById(t),Ir={entities:[],hierarchies:[],selectedEntity:null,selectedHierarchy:null,dragTarget:null,dragOffset:{x:0,y:0},sampleEERD:{entities:[{id:"person",name:"PERSON",x:280,y:50,w:120,h:50,isSuper:!0,attributes:[{name:"person_id",isKey:!0},{name:"name",isKey:!1},{name:"dob",isKey:!1}]},{id:"student",name:"STUDENT",x:100,y:250,w:120,h:50,isSub:!0,parentId:"person",attributes:[{name:"student_id",isKey:!1},{name:"gpa",isKey:!1}]},{id:"employee",name:"EMPLOYEE",x:280,y:250,w:120,h:50,isSub:!0,parentId:"person",attributes:[{name:"emp_id",isKey:!1},{name:"salary",isKey:!1}]},{id:"instructor",name:"INSTRUCTOR",x:460,y:250,w:120,h:50,isSub:!0,parentId:"person",attributes:[{name:"rank",isKey:!1}]}],hierarchies:[{id:"person_hierarchy",superEntity:"person",subEntities:["student","employee","instructor"],constraint:"overlapping",completeness:"partial",x:280,y:150}]},init(){console.log("[EERDVisualizer] Initializing..."),this.loadSampleEERD(),this.bindEvents(),this.render(),console.log("[EERDVisualizer] âœ… Initialized")},loadSampleEERD(){this.entities=JSON.parse(JSON.stringify(this.sampleEERD.entities)),this.hierarchies=JSON.parse(JSON.stringify(this.sampleEERD.hierarchies))},bindEvents(){var e,i,s,r,n,a,o,l,c;const t=it("eerdCanvas");t&&(t.addEventListener("mousedown",h=>this.onMouseDown(h)),t.addEventListener("mousemove",h=>this.onMouseMove(h)),t.addEventListener("mouseup",()=>this.onMouseUp()),t.addEventListener("mouseleave",()=>this.onMouseUp())),(e=it("btnEerdAddSuper"))==null||e.addEventListener("click",()=>this.addSuperEntity()),(i=it("btnEerdAddSub"))==null||i.addEventListener("click",()=>this.addSubEntity()),(s=it("btnEerdToggleConstraint"))==null||s.addEventListener("click",()=>this.toggleConstraint()),(r=it("btnEerdToggleCompleteness"))==null||r.addEventListener("click",()=>this.toggleCompleteness()),(n=it("btnEerdReset"))==null||n.addEventListener("click",()=>this.reset()),(a=it("btnEerdSaveEntity"))==null||a.addEventListener("click",()=>this.saveEntityEdit()),(o=it("btnEerdDeleteEntity"))==null||o.addEventListener("click",()=>this.deleteSelectedEntity()),(l=it("btnEerdAddAttribute"))==null||l.addEventListener("click",()=>this.addAttributeToEditor()),(c=it("eerdEntityType"))==null||c.addEventListener("change",h=>this.onTypeChange(h.target.value))},getMousePos(t){const e=it("eerdCanvas");if(!e)return{x:0,y:0};const i=e.getBoundingClientRect();return{x:t.clientX-i.left,y:t.clientY-i.top}},onMouseDown(t){var i;const e=this.getMousePos(t);for(const s of this.entities)if(this.isPointInRect(e,s)){this.dragTarget=s,this.dragOffset={x:e.x-s.x,y:e.y-s.y},this.selectedEntity=s,this.showEntityEditor(s),(i=O==null?void 0:O.play)==null||i.call(O,"click"),this.render();return}this.selectedEntity=null,this.hideEditor(),this.render()},onMouseMove(t){if(!this.dragTarget)return;const e=this.getMousePos(t);if(this.dragTarget.x=e.x-this.dragOffset.x,this.dragTarget.y=e.y-this.dragOffset.y,this.dragTarget.isSuper){const i=this.hierarchies.find(s=>s.superEntity===this.dragTarget.id);i&&(i.x=this.dragTarget.x+this.dragTarget.w/2,i.y=this.dragTarget.y+this.dragTarget.h+50)}this.render()},onMouseUp(){this.dragTarget=null},isPointInRect(t,e){return t.x>=e.x&&t.x<=e.x+e.w&&t.y>=e.y&&t.y<=e.y+e.h},addSuperEntity(){var r;const t="super_"+Date.now(),e=it("eerdCanvas"),i=e?e.getBoundingClientRect().width:600,s={id:t,name:"SUPERCLASS",x:i/2-60,y:50,w:120,h:50,isSuper:!0,attributes:[{name:"id",isKey:!0}]};this.entities.push(s),this.hierarchies.push({id:"hier_"+Date.now(),superEntity:t,subEntities:[],constraint:"disjoint",completeness:"partial",x:s.x+60,y:s.y+100}),this.selectedEntity=s,this.render(),T("âž• Superclass added! Add subclasses to specialize."),(r=O==null?void 0:O.play)==null||r.call(O,"ds_insert")},addSubEntity(){var n;const t=this.entities.find(a=>a.isSuper);if(!t){T("Add a superclass first!","error");return}const e=this.hierarchies.find(a=>a.superEntity===t.id);if(!e)return;const i="sub_"+Date.now(),s=e.subEntities.length,r={id:i,name:"SUBCLASS_"+(s+1),x:t.x+(s-1)*150,y:t.y+200,w:120,h:50,isSub:!0,parentId:t.id,attributes:[{name:"special_attr",isKey:!1}]};this.entities.push(r),e.subEntities.push(i),this.selectedEntity=r,this.render(),T("âž• Subclass added to hierarchy!"),(n=O==null?void 0:O.play)==null||n.call(O,"ds_insert")},toggleConstraint(){var i;if(this.hierarchies.length===0)return;const t=this.hierarchies[0];t.constraint=t.constraint==="disjoint"?"overlapping":"disjoint",this.render();const e=t.constraint==="disjoint"?"Disjoint (d) - No overlap":"Overlapping (o) - Can belong to multiple";T(`ðŸ”„ ${e}`),(i=O==null?void 0:O.play)==null||i.call(O,"click")},toggleCompleteness(){var i;if(this.hierarchies.length===0)return;const t=this.hierarchies[0];t.completeness=t.completeness==="total"?"partial":"total",this.render();const e=t.completeness==="total"?"Total (double line) - Every super must be a sub":"Partial (single line) - Super may not be specialized";T(`ðŸ”„ ${e}`),(i=O==null?void 0:O.play)==null||i.call(O,"click")},reset(){var t;this.loadSampleEERD(),this.selectedEntity=null,this.render(),T("ðŸ”„ EERD reset to sample"),(t=O==null?void 0:O.play)==null||t.call(O,"reset")},showEntityEditor(t){const e=it("eerdEntityEditor");if(!e)return;e.style.display="block",it("eerdEntityName").value=t.name,it("eerdEntityType").value=t.isSuper?"super":"sub";const i=it("eerdAttributesList");i&&t.attributes&&(i.innerHTML=t.attributes.map((s,r)=>`
        <div class="flex gap-2 align-center" data-index="${r}">
          <input type="checkbox" ${s.isKey?"checked":""} onchange="EERDVisualizer.toggleAttrKey(${r})">
          <input type="text" value="${s.name}" class="input-field" style="flex:1" onchange="EERDVisualizer.updateAttrName(${r}, this.value)">
          <button class="btn btn-small" onclick="EERDVisualizer.removeAttribute(${r})">âœ•</button>
        </div>
      `).join(""))},hideEditor(){const t=it("eerdEntityEditor");t&&(t.style.display="none")},saveEntityEdit(){var e,i,s,r;if(!this.selectedEntity)return;this.selectedEntity.name=((i=(e=it("eerdEntityName"))==null?void 0:e.value)==null?void 0:i.toUpperCase())||"ENTITY";const t=(s=it("eerdEntityType"))==null?void 0:s.value;if(t==="super"&&!this.selectedEntity.isSuper)this.selectedEntity.isSuper=!0,this.selectedEntity.isSub=!1,delete this.selectedEntity.parentId;else if(t==="sub"&&!this.selectedEntity.isSub){this.selectedEntity.isSub=!0,this.selectedEntity.isSuper=!1;const n=this.entities.find(a=>a.isSuper);if(n){this.selectedEntity.parentId=n.id;const a=this.hierarchies.find(o=>o.superEntity===n.id);a&&!a.subEntities.includes(this.selectedEntity.id)&&a.subEntities.push(this.selectedEntity.id)}}this.render(),T("âœ… Entity updated"),(r=O==null?void 0:O.play)==null||r.call(O,"success")},deleteSelectedEntity(){var e;if(!this.selectedEntity)return;const t=this.selectedEntity.id;for(const i of this.hierarchies)i.subEntities=i.subEntities.filter(s=>s!==t);this.hierarchies=this.hierarchies.filter(i=>i.superEntity!==t),this.entities=this.entities.filter(i=>i.id!==t),this.selectedEntity=null,this.hideEditor(),this.render(),T("ðŸ—‘ï¸ Entity deleted"),(e=O==null?void 0:O.play)==null||e.call(O,"ds_remove")},onTypeChange(t){var e;(e=O==null?void 0:O.play)==null||e.call(O,"click")},toggleAttrKey(t){var e;(e=this.selectedEntity)!=null&&e.attributes&&(this.selectedEntity.attributes[t].isKey=!this.selectedEntity.attributes[t].isKey,this.render())},updateAttrName(t,e){var i;(i=this.selectedEntity)!=null&&i.attributes&&(this.selectedEntity.attributes[t].name=e,this.render())},addAttributeToEditor(){var t;this.selectedEntity&&(this.selectedEntity.attributes||(this.selectedEntity.attributes=[]),this.selectedEntity.attributes.push({name:"new_attr",isKey:!1}),this.showEntityEditor(this.selectedEntity),this.render(),(t=O==null?void 0:O.play)==null||t.call(O,"ds_insert"))},removeAttribute(t){var e,i;(e=this.selectedEntity)!=null&&e.attributes&&(this.selectedEntity.attributes.splice(t,1),this.showEntityEditor(this.selectedEntity),this.render(),(i=O==null?void 0:O.play)==null||i.call(O,"ds_remove"))},render(){be.renderCanvas("eerdCanvas",(t,e,i)=>{be.colors,this.drawGrid(t,e,i);for(const s of this.hierarchies)this.drawHierarchy(t,s);for(const s of this.entities)this.drawEntity(t,s,s===this.selectedEntity);this.drawLegend(t,e,i)})},drawGrid(t,e,i){t.strokeStyle="rgba(0,0,0,0.05)",t.lineWidth=1;const s=20;for(let r=0;r<e;r+=s)t.beginPath(),t.moveTo(r,0),t.lineTo(r,i),t.stroke();for(let r=0;r<i;r+=s)t.beginPath(),t.moveTo(0,r),t.lineTo(e,r),t.stroke()},drawEntity(t,e,i){const s=be.colors,r=e.x,n=e.y,a=e.w,o=e.h;let l,c;e.isSuper?(l=i?s.highlightFill:"#E3F2FD",c=i?s.highlight:"#1976D2"):e.isSub?(l=i?s.highlightFill:"#E8F5E9",c=i?s.highlight:s.entity):(l=i?s.highlightFill:s.entityFill,c=i?s.highlight:s.entity),t.fillStyle=l,t.strokeStyle=c,t.lineWidth=i?3:2,be.roundRect(t,r,n,a,o,8),t.fill(),t.stroke(),t.font="bold 13px Inter",t.fillStyle=s.text,t.textAlign="center",t.textBaseline="middle",t.fillText(e.name,r+a/2,n+o/2),e.isSuper?(t.font="bold 9px Inter",t.fillStyle="#1976D2",t.fillText("SUPERCLASS",r+a/2,n-8)):e.isSub&&(t.font="bold 9px Inter",t.fillStyle=s.entity,t.fillText("SUBCLASS",r+a/2,n-8))},drawHierarchy(t,e){be.colors;const i=this.entities.find(l=>l.id===e.superEntity),s=e.subEntities.map(l=>this.entities.find(c=>c.id===l)).filter(l=>l);if(!i)return;const r=e.x,n=e.y,a=20,o={x:i.x+i.w/2,y:i.y+i.h};t.strokeStyle="#5F6663",t.lineWidth=e.completeness==="total"?4:2,t.beginPath(),t.moveTo(o.x,o.y),t.lineTo(r,n-a),t.stroke(),e.completeness==="total"&&(t.strokeStyle="#FFFEFA",t.lineWidth=2,t.beginPath(),t.moveTo(o.x,o.y+2),t.lineTo(r,n-a),t.stroke()),t.strokeStyle="#5F6663",t.lineWidth=2;for(const l of s){const c={x:l.x+l.w/2,y:l.y};t.beginPath(),t.moveTo(r,n+a),t.lineTo(c.x,c.y),t.stroke()}t.fillStyle="#FFFEFA",t.strokeStyle="#5F6663",t.lineWidth=2,t.beginPath(),t.arc(r,n,a,0,Math.PI*2),t.fill(),t.stroke(),t.font="bold 16px Inter",t.fillStyle=e.constraint==="disjoint"?"#C44536":"#1976D2",t.textAlign="center",t.textBaseline="middle",t.fillText(e.constraint==="disjoint"?"d":"o",r,n),t.font="bold 10px Inter",t.fillStyle="#5F6663",t.fillText("ISA",r+a+15,n)},drawLegend(t,e,i){const s=be.colors,r=e-150,n=i-80;t.fillStyle="rgba(255,255,254,0.9)",t.strokeStyle="#ddd",t.lineWidth=1,be.roundRect(t,r-10,n-10,150,75,8),t.fill(),t.stroke(),t.font="bold 10px Inter",t.fillStyle=s.text,t.textAlign="left",t.fillText("Constraints:",r,n+5),t.font="9px Inter",t.fillStyle="#C44536",t.fillText("d = Disjoint (exclusive)",r,n+22),t.fillStyle="#1976D2",t.fillText("o = Overlapping (shared)",r,n+37),t.fillStyle=s.textMuted,t.fillText("Double line = Total",r,n+52)}};typeof window<"u"&&(window.EERDVisualizer=Ir);const Ke=t=>document.getElementById(t),Qr={currentLevel:"all",animating:!1,selectedTable:null,selectedLevel:null,hoveredItem:null,hoveredLevel:null,tableRects:[],tooltipEl:null,lastMousePos:{x:0,y:0},colors:{external:{bg:"rgba(139, 92, 246, 0.08)",border:"#8B5CF6",fill:"#EDE9FE",header:"#8B5CF6",text:"#6D28D9",hover:"rgba(139, 92, 246, 0.2)"},conceptual:{bg:"rgba(16, 185, 129, 0.08)",border:"#10B981",fill:"#D1FAE5",header:"#059669",text:"#047857",hover:"rgba(16, 185, 129, 0.2)"},internal:{bg:"rgba(59, 130, 246, 0.08)",border:"#3B82F6",fill:"#DBEAFE",header:"#2563EB",text:"#1D4ED8",hover:"rgba(59, 130, 246, 0.2)"}},schema:{external:[{name:"SalesView",tables:["orders","customers"],description:"Sales team dashboard - aggregated order data"},{name:"HRView",tables:["employees","departments"],description:"HR management - employee records"},{name:"InventoryView",tables:["products","orders"],description:"Stock tracking - product availability"}],conceptual:[{name:"customers",columns:["id PK","name","email","city"],description:"Customer master data"},{name:"products",columns:["id PK","name","category","price"],description:"Product catalog"},{name:"orders",columns:["id PK","customer_id FK","order_date","total"],description:"Sales orders"},{name:"employees",columns:["id PK","name","dept_id FK","salary"],description:"Employee records"},{name:"departments",columns:["id PK","name","budget"],description:"Company departments"}],internal:[{type:"file",name:"customers.dat",storage:"Heap file, 4KB pages",description:"Unordered customer records"},{type:"index",name:"idx_customer_id",storage:"B+ Tree on customers.id",description:"Primary key index for fast lookups"},{type:"index",name:"idx_order_date",storage:"B+ Tree on orders.order_date",description:"Range query optimization"},{type:"file",name:"products.dat",storage:"Clustered on category",description:"Products sorted by category"},{type:"cache",name:"Buffer Pool",storage:"128MB, LRU eviction",description:"In-memory page cache"}]},init(){console.log("[SchemaVisualizer] Initializing (Enhanced v2)..."),this.createTooltip(),this.bindEvents(),this.render(),console.log("[SchemaVisualizer] âœ… Initialized")},createTooltip(){this.tooltipEl||(this.tooltipEl=document.createElement("div"),this.tooltipEl.id="schemaTooltip",this.tooltipEl.className="schema-tooltip",this.tooltipEl.style.cssText=`
        position: fixed;
        display: none;
        background: rgba(15, 23, 42, 0.95);
        color: #f1f5f9;
        padding: 10px 14px;
        border-radius: 8px;
        font-size: 13px;
        max-width: 280px;
        z-index: 10000;
        pointer-events: none;
        box-shadow: 0 10px 25px rgba(0,0,0,0.3);
        border: 1px solid rgba(255,255,255,0.1);
        backdrop-filter: blur(8px);
        transition: opacity 0.15s ease;
      `,document.body.appendChild(this.tooltipEl))},showTooltip(t,e,i,s="#10B981"){this.tooltipEl&&(this.tooltipEl.innerHTML=`
      <div style="display: flex; align-items: center; gap: 8px; margin-bottom: 4px;">
        <span style="width: 8px; height: 8px; border-radius: 50%; background: ${s};"></span>
        <strong style="font-size: 14px;">${t.title||"Item"}</strong>
      </div>
      ${t.description?`<div style="color: #94a3b8; font-size: 12px;">${t.description}</div>`:""}
      ${t.details?`<div style="margin-top: 6px; padding-top: 6px; border-top: 1px solid rgba(255,255,255,0.1); font-family: 'JetBrains Mono', monospace; font-size: 11px; color: #cbd5e1;">${t.details}</div>`:""}
    `,this.tooltipEl.style.display="block",this.tooltipEl.style.left=`${e+15}px`,this.tooltipEl.style.top=`${i+15}px`,this.tooltipEl.style.opacity="1")},hideTooltip(){this.tooltipEl&&(this.tooltipEl.style.opacity="0",setTimeout(()=>{this.tooltipEl&&(this.tooltipEl.style.display="none")},150))},bindEvents(){var e,i,s,r,n,a,o,l,c;(e=Ke("btnSchemaAll"))==null||e.addEventListener("click",()=>this.setLevel("all")),(i=Ke("btnSchemaExternal"))==null||i.addEventListener("click",()=>this.setLevel("external")),(s=Ke("btnSchemaConceptual"))==null||s.addEventListener("click",()=>this.setLevel("conceptual")),(r=Ke("btnSchemaInternal"))==null||r.addEventListener("click",()=>this.setLevel("internal")),(n=Ke("btnSchemaGenDDL"))==null||n.addEventListener("click",()=>this.generateDDL());const t=Ke("schemaCanvas");t&&(t.addEventListener("click",h=>this.onCanvasClick(h)),t.addEventListener("mousemove",h=>this.onCanvasMouseMove(h)),t.addEventListener("mouseleave",()=>this.onCanvasMouseLeave())),(a=Ke("btnSchemaSaveTable"))==null||a.addEventListener("click",()=>this.saveTableEdit()),(o=Ke("btnSchemaDeleteTable"))==null||o.addEventListener("click",()=>this.deleteSelectedTable()),(l=Ke("btnSchemaAddColumn"))==null||l.addEventListener("click",()=>this.addColumn()),(c=Ke("btnSchemaAddTable"))==null||c.addEventListener("click",()=>this.addTable())},onCanvasMouseMove(t){var a,o,l;const e=Ke("schemaCanvas");if(!e)return;const i=e.getBoundingClientRect(),s=t.clientX-i.left,r=t.clientY-i.top;this.lastMousePos={x:t.clientX,y:t.clientY};let n=null;for(const c of this.tableRects)if(s>=c.x&&s<=c.x+c.w&&r>=c.y&&r<=c.y+c.h){n=c;break}if(n!==this.hoveredItem)if(this.hoveredItem=n,this.hoveredLevel=(n==null?void 0:n.level)||null,this.render(),n){const c=n.item,h=((a=this.colors[n.level])==null?void 0:a.border)||"#10B981",d={title:c.name,description:c.description||"",details:n.level==="conceptual"?(o=c.columns)==null?void 0:o.join(", "):n.level==="internal"?c.storage:n.level==="external"?`Tables: ${(l=c.tables)==null?void 0:l.join(", ")}`:""};this.showTooltip(d,t.clientX,t.clientY,h),e.style.cursor="pointer"}else this.hideTooltip(),e.style.cursor="default";else n&&(this.tooltipEl.style.left=`${t.clientX+15}px`,this.tooltipEl.style.top=`${t.clientY+15}px`)},onCanvasMouseLeave(){this.hoveredItem=null,this.hoveredLevel=null,this.hideTooltip(),this.render()},setLevel(t){var i;if(this.animating)return;this.currentLevel=t,this.render(),["All","External","Conceptual","Internal"].forEach(s=>{const r=Ke(`btnSchema${s}`);r&&r.classList.toggle("active",s.toLowerCase()===t)}),T(`ðŸ“Š Viewing: ${{all:"All Levels",external:"External Level (User Views)",conceptual:"Conceptual Level (Logical Schema)",internal:"Internal Level (Physical Storage)"}[t]}`),(i=O==null?void 0:O.play)==null||i.call(O,"click")},generateDDL(){var i,s;const t=this.schema.conceptual.map(r=>{const n=r.columns.map(a=>{const o=a.split(" "),l=o[0],c=o[1]||"";let h="TEXT";(l==="id"||l.endsWith("_id"))&&(h="INTEGER"),(l==="price"||l==="salary"||l==="total"||l==="budget")&&(h="DECIMAL(10,2)"),l.includes("date")&&(h="DATE");let d=`  ${l} ${h}`;return c==="PK"&&(d+=" PRIMARY KEY"),c==="FK"&&(d+=` REFERENCES ${l.replace("_id","s")}(id)`),d}).join(`,
`);return`CREATE TABLE ${r.name} (
${n}
);`}).join(`

`),e=Ke("schemaDDLOutput");e&&(e.textContent=t,e.style.display="block"),(i=navigator.clipboard)==null||i.writeText(t).then(()=>{T("ðŸ“‹ DDL copied to clipboard!")}).catch(()=>{T("ðŸ“ DDL generated below")}),(s=O==null?void 0:O.play)==null||s.call(O,"success")},onCanvasClick(t){const e=Ke("schemaCanvas");if(!e)return;const i=e.getBoundingClientRect(),s=t.clientX-i.left,r=t.clientY-i.top;for(const n of this.tableRects)if(s>=n.x&&s<=n.x+n.w&&r>=n.y&&r<=n.y+n.h){this.selectTable(n.item,n.level);return}this.selectedTable=null,this.selectedLevel=null,this.hideTableEditor(),this.render()},selectTable(t,e){var i;this.selectedTable=t,this.selectedLevel=e,this.showTableEditor(t,e),(i=O==null?void 0:O.play)==null||i.call(O,"click"),this.render()},showTableEditor(t,e){const i=Ke("schemaTableEditor");if(!i){T(`ðŸ“Š Selected: ${t.name} (${e})`);return}i.style.display="block",Ke("schemaTableName").value=t.name,Ke("schemaTableLevel").value=e;const s=Ke("schemaColumnsList");s&&e==="conceptual"&&t.columns&&(s.innerHTML=t.columns.map((r,n)=>`
        <div class="flex gap-2 align-center" data-index="${n}">
          <input type="text" value="${r}" class="input-field" style="flex:1" onchange="SchemaVisualizer.updateColumn(${n}, this.value)">
          <button class="btn btn-small" onclick="SchemaVisualizer.removeColumn(${n})">âœ•</button>
        </div>
      `).join(""))},hideTableEditor(){const t=Ke("schemaTableEditor");t&&(t.style.display="none")},saveTableEdit(){var t,e;!this.selectedTable||!this.selectedLevel||(this.selectedTable.name=((t=Ke("schemaTableName"))==null?void 0:t.value)||this.selectedTable.name,this.render(),T("âœ… Table updated"),(e=O==null?void 0:O.play)==null||e.call(O,"success"))},deleteSelectedTable(){var e;if(!this.selectedTable||!this.selectedLevel)return;const t=this.selectedLevel;this.schema[t]=this.schema[t].filter(i=>i!==this.selectedTable),this.selectedTable=null,this.selectedLevel=null,this.hideTableEditor(),this.render(),T("ðŸ—‘ï¸ Item deleted"),(e=O==null?void 0:O.play)==null||e.call(O,"ds_remove")},addTable(){var e;const t=this.currentLevel==="all"?"conceptual":this.currentLevel;t==="conceptual"?this.schema.conceptual.push({name:"new_table",columns:["id PK"],description:"New table"}):t==="external"?this.schema.external.push({name:"NewView",tables:[],description:"New view"}):t==="internal"&&this.schema.internal.push({type:"file",name:"new_table.dat",storage:"Heap file",description:"New storage file"}),this.render(),T("âž• Added to "+t),(e=O==null?void 0:O.play)==null||e.call(O,"ds_insert")},addColumn(){var t;!this.selectedTable||this.selectedLevel!=="conceptual"||(this.selectedTable.columns||(this.selectedTable.columns=[]),this.selectedTable.columns.push("new_column"),this.showTableEditor(this.selectedTable,this.selectedLevel),this.render(),(t=O==null?void 0:O.play)==null||t.call(O,"ds_insert"))},updateColumn(t,e){var i;(i=this.selectedTable)!=null&&i.columns&&(this.selectedTable.columns[t]=e,this.render())},removeColumn(t){var e,i;(e=this.selectedTable)!=null&&e.columns&&(this.selectedTable.columns.splice(t,1),this.showTableEditor(this.selectedTable,this.selectedLevel),this.render(),(i=O==null?void 0:O.play)==null||i.call(O,"ds_remove"))},render(){this.tableRects=[],be.renderCanvas("schemaCanvas",(t,e,i)=>{const s=document.body.classList.contains("dark");t.fillStyle=s?"#1a1a2e":"#f8fafc",t.fillRect(0,0,e,i);const r=20,n=this.currentLevel==="all",a=n||this.currentLevel==="external",o=n||this.currentLevel==="conceptual",l=n||this.currentLevel==="internal",c=[a,o,l].filter(Boolean).length;let h=i-r*2;n&&(h-=40);const d=n?30:0,u=(h-d*(c-1))/c;let p=r;const f={};a&&(f.external=p,p+=u+d),o&&(f.conceptual=p,p+=u+d),l&&(f.internal=p),a&&this.drawExternalLevel(t,r,f.external,e-r*2,u,s),o&&this.drawConceptualLevel(t,r,f.conceptual,e-r*2,u,s),l&&this.drawInternalLevel(t,r,f.internal,e-r*2,u,s),n&&c>1&&this.drawMappingArrows(t,e,f,u,d,s)})},drawExternalLevel(t,e,i,s,r,n){const a=this.colors.external,o=this.hoveredLevel==="external";t.save(),o&&(t.shadowColor=a.border,t.shadowBlur=15),t.fillStyle=n?"rgba(139, 92, 246, 0.1)":a.bg,t.strokeStyle=a.border,t.lineWidth=2,be.roundRect(t,e,i,s,r,16),t.fill(),t.stroke(),t.restore(),t.font="bold 14px Inter, sans-serif",t.fillStyle=n?"#A78BFA":a.text,t.textAlign="left",t.fillText("ðŸ‘¥ EXTERNAL LEVEL â€” User Views",e+12,i+22);const l=this.schema.external,c=8,h=8,d=36,u=s-c*2,p=Math.floor((u-h*(l.length-1))/l.length),f=r-d-c;l.forEach((g,m)=>{var L;const y=e+c+m*(p+h),b=i+d,w=p,k=f,x=((L=this.hoveredItem)==null?void 0:L.item)===g,E=this.selectedTable===g;t.save(),x&&(t.shadowColor=a.border,t.shadowBlur=12,t.shadowOffsetY=2),t.fillStyle=x?n?"rgba(139, 92, 246, 0.25)":"#EDE9FE":E?n?"rgba(139, 92, 246, 0.3)":"#DDD6FE":n?"rgba(139, 92, 246, 0.08)":"#F5F3FF",t.strokeStyle=x||E?a.border:n?"rgba(139, 92, 246, 0.3)":"#C4B5FD",t.lineWidth=x||E?2:1,be.roundRect(t,y,b,w,k,8),t.fill(),t.stroke(),t.restore();const _=28,R=Math.max(9,Math.min(12,w/10));t.font=`bold ${R}px Inter, sans-serif`,t.fillStyle=n?"#E9D5FF":a.header,t.textAlign="center";let C=g.name;for(;t.measureText(`ðŸ“‹ ${C}`).width>w-6&&C.length>2;)C=C.slice(0,-1);C!==g.name&&(C+="â€¦"),t.fillText(`ðŸ“‹ ${C}`,y+w/2,b+16),t.strokeStyle=n?"rgba(139, 92, 246, 0.2)":"#DDD6FE",t.lineWidth=1,t.beginPath(),t.moveTo(y+6,b+_),t.lineTo(y+w-6,b+_),t.stroke();const D=Math.max(8,Math.min(11,w/12));t.font=`${D}px "JetBrains Mono", monospace`,t.fillStyle=n?"#C4B5FD":"#7C3AED",t.textAlign="center";const q=D+5,A=b+_+12,F=Math.max(1,Math.floor((k-_-16)/q));g.tables.slice(0,F).forEach((W,M)=>{let G=W;for(;t.measureText(`â†’ ${G}`).width>w-10&&G.length>2;)G=G.slice(0,-1);t.fillText(`â†’ ${G}`,y+w/2,A+M*q)}),g.tables.length>F&&(t.fillStyle=n?"#A78BFA":"#8B5CF6",t.font=`${D}px Inter, sans-serif`,t.fillText(`+${g.tables.length-F}`,y+w/2,A+F*q)),this.tableRects.push({x:y,y:b,w,h:k,item:g,level:"external"})})},drawConceptualLevel(t,e,i,s,r,n){const a=this.colors.conceptual,o=this.hoveredLevel==="conceptual";t.save(),o&&(t.shadowColor=a.border,t.shadowBlur=12),t.fillStyle=n?"rgba(16, 185, 129, 0.08)":a.bg,t.strokeStyle=a.border,t.lineWidth=2,be.roundRect(t,e,i,s,r,14),t.fill(),t.stroke(),t.restore(),t.font="bold 14px Inter, sans-serif",t.fillStyle=n?"#6EE7B7":a.text,t.textAlign="left",t.fillText("ðŸ“ CONCEPTUAL LEVEL â€” Logical Schema",e+12,i+22);const l=this.schema.conceptual,c=8,h=6,d=36,u=s-c*2,p=Math.floor((u-h*(l.length-1))/l.length),f=r-d-c,g=24;l.forEach((m,y)=>{var W;const b=e+c+y*(p+h),w=i+d,k=p,x=f,E=((W=this.hoveredItem)==null?void 0:W.item)===m,_=this.selectedTable===m;t.save(),E&&(t.shadowColor=a.border,t.shadowBlur=12,t.shadowOffsetY=2),t.fillStyle=E?n?"rgba(16, 185, 129, 0.25)":"#D1FAE5":_?n?"rgba(16, 185, 129, 0.3)":"#A7F3D0":n?"rgba(16, 185, 129, 0.06)":"#ECFDF5",t.strokeStyle=E||_?a.border:n?"rgba(16, 185, 129, 0.3)":"#6EE7B7",t.lineWidth=E||_?2:1,be.roundRect(t,b,w,k,x,8),t.fill(),t.stroke(),t.restore(),t.fillStyle=n?"rgba(16, 185, 129, 0.5)":a.header,be.roundRect(t,b,w,k,g,[8,8,0,0]),t.fill();const R=Math.max(8,Math.min(11,k/10));t.font=`bold ${R}px Inter, sans-serif`,t.fillStyle=n?"#0f1f18":"white",t.textAlign="center";let C=m.name;for(;t.measureText(C).width>k-8&&C.length>2;)C=C.slice(0,-1);C!==m.name&&(C+="â€¦"),t.fillText(C,b+k/2,w+g/2+R/3);const D=w+g+8,q=Math.max(7,Math.min(10,k/12)),A=q+4,F=x-g-12,L=Math.max(1,Math.floor(F/A));t.font=`${q}px "JetBrains Mono", monospace`,t.textAlign="left",m.columns.slice(0,L).forEach((M,G)=>{const J=M.split(" "),ce=J[0],re=J[1]||"",le=D+G*A;re==="PK"?(t.fillStyle=n?"#FCD34D":"#B45309",t.fillText("ðŸ”‘",b+3,le)):re==="FK"?(t.fillStyle=n?"#93C5FD":"#1D4ED8",t.fillText("ðŸ”—",b+3,le)):(t.fillStyle=n?"#A7F3D0":"#374151",t.fillText("â€¢",b+6,le)),t.fillStyle=n?"#A7F3D0":"#374151";let oe=ce;const ke=b+16,Qe=k-20;for(;t.measureText(oe).width>Qe&&oe.length>1;)oe=oe.slice(0,-1);t.fillText(oe,ke,le)}),m.columns.length>L&&(t.fillStyle=n?"#6EE7B7":a.header,t.font=`${q}px Inter, sans-serif`,t.fillText(`+${m.columns.length-L}`,b+4,D+L*A)),this.tableRects.push({x:b,y:w,w:k,h:x,item:m,level:"conceptual"})})},drawInternalLevel(t,e,i,s,r,n){const a=this.colors.internal,o=this.hoveredLevel==="internal";t.save(),o&&(t.shadowColor=a.border,t.shadowBlur=10),t.fillStyle=n?"rgba(59, 130, 246, 0.08)":a.bg,t.strokeStyle=a.border,t.lineWidth=2,be.roundRect(t,e,i,s,r,14),t.fill(),t.stroke(),t.restore(),t.font="bold 14px Inter, sans-serif",t.fillStyle=n?"#93C5FD":a.text,t.textAlign="left",t.fillText("ðŸ’¾ INTERNAL LEVEL â€” Physical Storage",e+12,i+22);const l=this.schema.internal,c=8,h=6,d=36,u=s-c*2,p=Math.floor((u-h*(l.length-1))/l.length),f=r-d-c;l.forEach((g,m)=>{var J;const y=e+c+m*(p+h),b=i+d,w=p,k=f,x=((J=this.hoveredItem)==null?void 0:J.item)===g,E=this.selectedTable===g,_={file:{bg:n?"rgba(100, 116, 139, 0.2)":"#F1F5F9",accent:"#64748B"},index:{bg:n?"rgba(16, 185, 129, 0.15)":"#ECFDF5",accent:"#10B981"},cache:{bg:n?"rgba(245, 158, 11, 0.15)":"#FEF3C7",accent:"#F59E0B"}},R=_[g.type]||_.file;t.save(),x&&(t.shadowColor=a.border,t.shadowBlur=12,t.shadowOffsetY=2),t.fillStyle=x?n?"rgba(59, 130, 246, 0.25)":"#DBEAFE":E?n?"rgba(59, 130, 246, 0.3)":"#BFDBFE":R.bg,t.strokeStyle=x||E?a.border:n?"rgba(59, 130, 246, 0.3)":R.accent,t.lineWidth=x||E?2:1,be.roundRect(t,y,b,w,k,8),t.fill(),t.stroke(),t.restore();const C=Math.max(14,Math.min(20,w/5)),D=b+6,q=D+C+10,A=q+12,F=A+10,L={file:"ðŸ“„",index:"ðŸŒ³",cache:"âš¡"};t.font=`${C}px Inter`,t.textAlign="center",t.fillText(L[g.type]||"ðŸ“¦",y+w/2,D+C);const W=Math.max(7,Math.min(10,w/10));t.font=`bold ${W}px Inter, sans-serif`,t.fillStyle=n?"#93C5FD":a.header,t.textAlign="center";let M=g.name;for(;t.measureText(M).width>w-6&&M.length>2;)M=M.slice(0,-1);M!==g.name&&(M+="â€¦"),t.fillText(M,y+w/2,q);const G=Math.max(6,Math.min(9,w/12));if(t.fillStyle=R.accent,t.font=`bold ${G}px Inter, sans-serif`,t.fillText(g.type.toUpperCase(),y+w/2,A),k>80){const ce=Math.max(6,Math.min(9,w/12));t.font=`${ce}px "JetBrains Mono", monospace`,t.fillStyle=n?"#94A3B8":"#6B7280",t.textAlign="center";const re=g.storage.split(" ");let le=[],oe="";const ke=w-8;re.forEach(Ze=>{const Dt=oe+(oe?" ":"")+Ze;t.measureText(Dt).width>ke?(oe&&le.push(oe),oe=Ze):oe=Dt}),oe&&le.push(oe);const Qe=ce+3,qt=Math.max(1,Math.floor((k-F+b-4)/Qe));le.slice(0,qt).forEach((Ze,Dt)=>{t.fillText(Ze,y+w/2,F+Dt*Qe)})}this.tableRects.push({x:y,y:b,w,h:k,item:g,level:"internal"})})},drawMappingArrows(t,e,i,s,r,n){const a=e/2,o=n?"#475569":"#94A3B8",l=n?"#94A3B8":"#64748B";if(t.save(),t.strokeStyle=o,t.lineWidth=2,t.setLineDash([6,4]),i.external!==void 0&&i.conceptual!==void 0){const c=i.external+s-5,h=i.conceptual+5;t.beginPath(),t.moveTo(a,c),t.lineTo(a,h),t.stroke(),t.setLineDash([]),t.beginPath(),t.moveTo(a-6,h-8),t.lineTo(a,h),t.lineTo(a+6,h-8),t.stroke(),t.setLineDash([6,4]),t.font="bold 11px Inter, sans-serif",t.fillStyle=l,t.textAlign="left";const d="ðŸ”“ Logical Independence",u=t.measureText(d).width+16;t.fillStyle=n?"rgba(30, 41, 59, 0.9)":"rgba(255, 255, 255, 0.9)",t.fillRect(a+10,c+(h-c)/2-10,u,20),t.fillStyle=l,t.fillText(d,a+18,c+(h-c)/2+4)}if(i.conceptual!==void 0&&i.internal!==void 0){const c=i.conceptual+s-5,h=i.internal+5;t.beginPath(),t.moveTo(a,c),t.lineTo(a,h),t.stroke(),t.setLineDash([]),t.beginPath(),t.moveTo(a-6,h-8),t.lineTo(a,h),t.lineTo(a+6,h-8),t.stroke();const d="ðŸ’¾ Physical Independence",u=t.measureText(d).width+16;t.fillStyle=n?"rgba(30, 41, 59, 0.9)":"rgba(255, 255, 255, 0.9)",t.fillRect(a+10,c+(h-c)/2-10,u,20),t.fillStyle=l,t.fillText(d,a+18,c+(h-c)/2+4)}t.restore()}};typeof window<"u"&&(window.SchemaVisualizer=Qr);const jt=t=>document.getElementById(t),Ar={currentStep:0,animating:!1,sampleData:{original:{name:"Orders",columns:["OrderID","CustomerName","CustomerPhone","ProductName","Qty","Price","Category"],rows:[[1,"Alice","555-1234","Laptop, Mouse","1, 2","1000, 20","Electronics"],[2,"Bob","555-5678","Keyboard","1","50","Electronics"],[3,"Alice","555-1234","Headphones","1","80","Electronics"]],issues:["Multi-valued attributes (ProductName has multiple values)","Repeating groups in single cells"]},nf1:{tables:[{name:"Orders_1NF",columns:["OrderID","CustomerName","CustomerPhone","ProductName","Qty","Price","Category"],rows:[[1,"Alice","555-1234","Laptop",1,1e3,"Electronics"],[1,"Alice","555-1234","Mouse",2,20,"Electronics"],[2,"Bob","555-5678","Keyboard",1,50,"Electronics"],[3,"Alice","555-1234","Headphones",1,80,"Electronics"]],pk:["OrderID","ProductName"]}],changes:["Eliminated multi-valued attributes","Each cell now contains atomic values"],issues:["Partial dependency: CustomerName, CustomerPhone depend only on OrderID (not full PK)"]},nf2:{tables:[{name:"Orders",columns:["OrderID","CustomerName","CustomerPhone"],rows:[[1,"Alice","555-1234"],[2,"Bob","555-5678"],[3,"Alice","555-1234"]],pk:["OrderID"]},{name:"OrderItems",columns:["OrderID","ProductName","Qty","Price","Category"],rows:[[1,"Laptop",1,1e3,"Electronics"],[1,"Mouse",2,20,"Electronics"],[2,"Keyboard",1,50,"Electronics"],[3,"Headphones",1,80,"Electronics"]],pk:["OrderID","ProductName"],fk:["OrderID â†’ Orders"]}],changes:["Removed partial dependencies","Split into Orders and OrderItems"],issues:["Transitive dependency: Category depends on ProductName, not on PK"]},nf3:{tables:[{name:"Orders",columns:["OrderID","CustomerID"],rows:[[1,1],[2,2],[3,1]],pk:["OrderID"],fk:["CustomerID â†’ Customers"]},{name:"Customers",columns:["CustomerID","CustomerName","CustomerPhone"],rows:[[1,"Alice","555-1234"],[2,"Bob","555-5678"]],pk:["CustomerID"]},{name:"OrderItems",columns:["OrderID","ProductName","Qty"],rows:[[1,"Laptop",1],[1,"Mouse",2],[2,"Keyboard",1],[3,"Headphones",1]],pk:["OrderID","ProductName"],fk:["OrderID â†’ Orders","ProductName â†’ Products"]},{name:"Products",columns:["ProductName","Price","Category"],rows:[["Laptop",1e3,"Electronics"],["Mouse",20,"Electronics"],["Keyboard",50,"Electronics"],["Headphones",80,"Electronics"]],pk:["ProductName"]}],changes:["Removed transitive dependencies","Created Customers and Products tables"],issues:["Already in BCNF for this example!"]},bcnf:{tables:[{name:"Orders",columns:["OrderID","CustomerID"],rows:[[1,1],[2,2],[3,1]],pk:["OrderID"],fk:["CustomerID â†’ Customers"]},{name:"Customers",columns:["CustomerID","CustomerName","CustomerPhone"],rows:[[1,"Alice","555-1234"],[2,"Bob","555-5678"]],pk:["CustomerID"]},{name:"OrderItems",columns:["OrderID","ProductID","Qty"],rows:[[1,1,1],[1,2,2],[2,3,1],[3,4,1]],pk:["OrderID","ProductID"],fk:["OrderID â†’ Orders","ProductID â†’ Products"]},{name:"Products",columns:["ProductID","ProductName","Price","CategoryID"],rows:[[1,"Laptop",1e3,1],[2,"Mouse",20,1],[3,"Keyboard",50,1],[4,"Headphones",80,1]],pk:["ProductID"],fk:["CategoryID â†’ Categories"]},{name:"Categories",columns:["CategoryID","CategoryName"],rows:[[1,"Electronics"]],pk:["CategoryID"]}],changes:["Added surrogate keys (ProductID, CategoryID)","Every determinant is a candidate key"],issues:["âœ… Fully normalized!"]}},normalFormInfo:{0:{name:"Original (Unnormalized)",color:"#C44536",icon:"âš ï¸"},1:{name:"First Normal Form (1NF)",color:"#D4A853",icon:"1ï¸âƒ£"},2:{name:"Second Normal Form (2NF)",color:"#5B8BA0",icon:"2ï¸âƒ£"},3:{name:"Third Normal Form (3NF)",color:"#2F6A57",icon:"3ï¸âƒ£"},4:{name:"Boyce-Codd Normal Form (BCNF)",color:"#8B687F",icon:"âœ¨"}},normNarratives:{0:{intro:'This table is "messy on purpose" so you can see why normalization exists. Notice how some cells contain multiple values separated by commasâ€”this is the root of many anomalies.',issues:[{title:"Multi-valued Attributes",problem:'ProductName contains multiple values ("Laptop, Mouse") in a single cell.',why:"A single cell should contain only ONE atomic value. Multi-valued cells violate 1NF and make querying, updating, and deleting individual items unreliable.",example:"Example: If Alice returns only the Mouse, you cannot remove it cleanly without string-splitting and risking data corruption."},{title:"Repeating Groups",problem:'Qty and Price store comma-separated lists ("1, 2" and "1000, 20").',why:'Repeating groups prevent constraints and accurate calculations. The database sees "1000, 20" as text, not two numbersâ€”aggregates and validation become painful.',example:"Example: SUM(Price) won't work correctly because the field is not numeric per rowâ€”it's a string list."}]},1:{intro:'1NF fixes atomicity: every cell holds a single value. We "unroll" the repeating groups into multiple rows.',changes:[{title:"Atomic Values Enforced",body:'We split "Laptop, Mouse" into separate rows so each OrderIDâ€“ProductName pair is one fact.'}],remaining:[{title:"Partial Dependency Still Exists",body:"CustomerName and CustomerPhone depend only on OrderID, not on the full composite key (OrderID, ProductName). This violates 2NF."}]},2:{intro:"2NF removes partial dependencies by separating attributes that depend on only part of a composite key.",changes:[{title:"Orders vs OrderItems Split",body:"Customer details move to Orders (keyed by OrderID), while product-per-order details stay in OrderItems (keyed by OrderID + ProductName)."}],remaining:[{title:"Transitive Dependency Still Exists",body:"Category depends on ProductName (a non-key attribute) rather than on the primary key. This violates 3NF."}]},3:{intro:"3NF removes transitive dependencies by creating separate tables for attributes that depend on other non-key attributes.",changes:[{title:"Customers and Products Created",body:"We store customer info in Customers and product info (Price, Category) in Products, then reference them using foreign keys."}],success:"âœ… Now updates happen in one place (e.g., changing a phone number doesn't require editing many orders)."},4:{intro:"BCNF strengthens 3NF by ensuring every determinant is a candidate key.",changes:[{title:"Surrogate Keys Added",body:"We introduce ProductID and CategoryID so relationships are stable and efficient."}],success:"âœ… Fully normalized: fewer anomalies, cleaner constraints, and better scalability."}},init(){console.log("[NormalizationEngine] Initializing..."),this.bindEvents(),this.render(),console.log("[NormalizationEngine] âœ… Initialized")},bindEvents(){var t,e,i,s,r,n;(t=jt("btnNormPrev"))==null||t.addEventListener("click",()=>this.prevStep()),(e=jt("btnNormNext"))==null||e.addEventListener("click",()=>this.nextStep()),(i=jt("btnNormReset"))==null||i.addEventListener("click",()=>this.reset()),(s=jt("btnNormAnimate"))==null||s.addEventListener("click",()=>this.animateAll()),(r=jt("btnNormLoadCustom"))==null||r.addEventListener("click",()=>this.loadCustomData()),(n=jt("btnNormAddRow"))==null||n.addEventListener("click",()=>this.addRow())},prevStep(){var t;this.currentStep>0&&(this.currentStep--,this.render(),(t=O==null?void 0:O.play)==null||t.call(O,"click"))},nextStep(){var t;if(this.currentStep<4){this.currentStep++,this.render(),(t=O==null?void 0:O.play)==null||t.call(O,"success");const e=this.normalFormInfo[this.currentStep];T(`${e.icon} ${e.name}`)}},reset(){var t;this.currentStep=0,this.render(),T("ðŸ”„ Reset to original (unnormalized) data"),(t=O==null?void 0:O.play)==null||t.call(O,"reset")},async animateAll(){var t,e;if(!this.animating){this.animating=!0,this.currentStep=0,this.render();for(let i=1;i<=4;i++){await new Promise(r=>setTimeout(r,1500)),this.currentStep=i,this.render(),(t=O==null?void 0:O.play)==null||t.call(O,"ds_insert");const s=this.normalFormInfo[i];T(`${s.icon} ${s.name}`)}this.animating=!1,T("âœ… Normalization complete!"),(e=O==null?void 0:O.play)==null||e.call(O,"sort_complete")}},loadCustomData(){var s,r,n,a;const t=((s=jt("normTableName"))==null?void 0:s.value)||"CustomTable",e=((r=jt("normColumns"))==null?void 0:r.value)||"";if((n=jt("normPrimaryKey"))!=null&&n.value,!e){T("âŒ Please enter columns","error");return}const i=e.split(",").map(o=>o.trim()).filter(o=>o);this.sampleData.original={name:t,columns:i,rows:[],issues:["Custom data loaded - add rows to proceed"]},this.sampleData.nf1={...this.sampleData.original,name:t+"_1NF",issues:["1NF logic would apply here"]},this.sampleData.nf2={...this.sampleData.original,name:t+"_2NF",issues:["2NF logic would apply here"]},this.sampleData.nf3={...this.sampleData.original,name:t+"_3NF",issues:["3NF logic would apply here"]},this.sampleData.bcnf={...this.sampleData.original,name:t+"_BCNF",issues:["BCNF logic would apply here"]},this.currentStep=0,this.render(),T("âœ… Custom table created"),(a=O==null?void 0:O.play)==null||a.call(O,"success")},addRow(){var i;if(this.currentStep!==0){T("âš ï¸ Can only add rows to original table","warning");return}const t=this.sampleData.original.columns,e=new Array(t.length).fill("?");for(let s=0;s<t.length;s++){const r=prompt(`Enter value for ${t[s]}:`);r!==null&&(e[s]=r)}this.sampleData.original.rows.push(e),this.sampleData.nf1.rows.push([...e]),this.sampleData.nf2.rows.push([...e]),this.sampleData.nf3.rows.push([...e]),this.sampleData.bcnf.rows.push([...e]),this.render(),T("âž• Row added"),(i=O==null?void 0:O.play)==null||i.call(O,"ds_insert")},render(){this.renderCanvas(),this.renderInfo(),this.updateButtons()},renderCanvas(){be.renderCanvas("normCanvas",(t,e,i)=>{const s=this.getDataForStep(this.currentStep),r=this.normalFormInfo[this.currentStep];if(t.fillStyle=r.color,t.font="800 18px Inter",t.textAlign="center",t.fillText(`${r.icon} ${r.name}`,e/2,30),this.currentStep===0)this.drawTable(t,this.sampleData.original,30,45,e-60,i-60);else{const a=s.tables,o=Math.min(a.length,3),l=Math.ceil(a.length/o),c=(e-40)/o-10,h=(i-60)/l-10;a.forEach((d,u)=>{const p=u%o,f=Math.floor(u/o),g=20+p*(c+10),m=45+f*(h+10);this.drawNormalizedTable(t,d,g,m,c,h,r.color)})}})},drawTable(t,e,i,s,r,n){const h="#C44536",d=r/e.columns.length,u=8,p=(y,b)=>{const w=String(y??"");if(t.measureText(w).width<=b)return w;let k=w;for(;k.length>1&&t.measureText(k+"â€¦").width>b;)k=k.slice(0,-1);return k+"â€¦"},f=64+e.rows.length*28,g=s;t.save(),t.shadowColor="rgba(0,0,0,0.18)",t.shadowBlur=14,t.shadowOffsetY=6,t.fillStyle="#FFFFFF",be.roundRect(t,i,g,r,f,12),t.fill(),t.restore(),t.save(),t.strokeStyle=h,t.lineWidth=3,be.roundRect(t,i,g,r,f,12),t.stroke(),t.restore(),t.save(),t.fillStyle=h,be.roundRect(t,i,g,r,34,[12,12,0,0]),t.fill(),t.fillStyle="rgba(255,255,255,0.18)",be.roundRect(t,i+10,g+8,132,18,9),t.fill(),t.font="700 12px Inter",t.fillStyle="#FFFFFF",t.textAlign="left",t.textBaseline="middle",t.fillText("âš ï¸ UNNORMALIZED",i+18,g+17),t.font="800 16px Inter",t.textAlign="center",t.fillText(p(e.name,r-170),i+r/2,g+34/2+1),t.restore();let m=g+34;t.save(),t.fillStyle="#FFF0F0",t.fillRect(i,m,r,30),t.strokeStyle="rgba(196, 69, 54, 0.35)",t.lineWidth=1,t.beginPath(),t.moveTo(i,m+30+.5),t.lineTo(i+r,m+30+.5),t.stroke(),t.beginPath();for(let y=1;y<e.columns.length;y++){const b=i+d*y;t.moveTo(b,m),t.lineTo(b,m+30+e.rows.length*28)}t.stroke(),t.font="800 12px Inter",t.fillStyle=h,t.textAlign="center",t.textBaseline="middle",e.columns.forEach((y,b)=>{const w=Math.max(10,d-u*2);t.fillText(p(y,w),i+d*b+d/2,m+30/2+1)}),t.restore(),t.save(),t.font="11px JetBrains Mono",t.textAlign="left",t.textBaseline="middle",e.rows.forEach((y,b)=>{const w=m+30+b*28;t.fillStyle=b%2===0?"#FFFFFF":"#FFF7F7",t.fillRect(i,w,r,28),t.strokeStyle="rgba(0,0,0,0.06)",t.lineWidth=1,t.beginPath(),t.moveTo(i,w+28+.5),t.lineTo(i+r,w+28+.5),t.stroke(),t.fillStyle="#1F2A24",y.forEach((k,x)=>{const E=Math.max(10,d-u*2),_=p(k,E);t.fillText(_,i+d*x+u,w+28/2+1)})}),t.restore()},drawNormalizedTable(t,e,i,s,r,n,a){const d=Math.max(1,Math.floor((n-66)/28)),u=r/e.columns.length,p=(m,y)=>{const b=String(m??"");if(t.measureText(b).width<=y)return b;let w=b;for(;w.length>1&&t.measureText(w+"â€¦").width>y;)w=w.slice(0,-1);return w+"â€¦"};t.save(),t.shadowColor="rgba(0,0,0,0.14)",t.shadowBlur=12,t.shadowOffsetY=5,t.fillStyle="#FFFFFF",be.roundRect(t,i,s,r,n,8),t.fill(),t.restore(),t.strokeStyle=a,t.lineWidth=2.5,t.stroke(),t.fillStyle=a,be.roundRect(t,i,s,r,30,[8,8,0,0]),t.fill(),t.font="800 14px Inter",t.fillStyle="white",t.textAlign="center",t.textBaseline="middle",t.fillText(p(e.name,r-16),i+r/2,s+30/2);let f=s+30;t.fillStyle="rgba(0,0,0,0.04)",t.fillRect(i+2,f,r-4,26),t.font="800 12px Inter",t.fillStyle=a,t.textBaseline="middle",e.columns.forEach((m,y)=>{var x;const w=((x=e.pk)==null?void 0:x.includes(m))?"ðŸ”‘":"",k=Math.max(10,u-8*2);t.fillText(p(w+m,k),i+u*y+u/2,f+26/2)}),t.font="11px JetBrains Mono",t.fillStyle="#1F2A24",t.textAlign="left",t.textBaseline="middle";const g=e.rows.slice(0,d);g.forEach((m,y)=>{const b=f+26+y*28;t.fillStyle=y%2===0?"#FFFFFF":"rgba(0,0,0,0.03)",t.fillRect(i+2,b,r-4,28),t.fillStyle="#1F2A24",m.forEach((w,k)=>{const x=Math.max(10,u-16);t.fillText(p(w,x),i+u*k+8,b+28/2)})}),e.rows.length>g.length&&(t.fillStyle="#999",t.font="italic 12px Inter",t.textAlign="center",t.textBaseline="alphabetic",t.fillText(`+${e.rows.length-g.length} more...`,i+r/2,s+n-10))},renderInfo(){var l,c,h,d;const t=jt("normInfo");if(!t)return;const e=this.normalFormInfo[this.currentStep],i=this.getDataForStep(this.currentStep),s=((l=this.normNarratives)==null?void 0:l[this.currentStep])||{},r=(u,p)=>`
          <div class="norm-info-section">
            <div class="norm-info-label">${u}</div>
            <div class="norm-info-section-body">${p}</div>
          </div>
        `,n=u=>`
          <div class="norm-issue">
            <div class="norm-issue-title">âŒ ${u.title}</div>
            <div class="norm-issue-text norm-issue-problem">${u.problem}</div>
            <div class="norm-issue-text norm-issue-why"><strong>ðŸ’¡ Why it matters:</strong> ${u.why}</div>
            <div class="norm-issue-text norm-issue-example"><em>ðŸ“Œ ${u.example}</em></div>
          </div>
        `,a=u=>`
          <div class="norm-change">
            <div class="norm-change-title">âœ… ${u.title}</div>
            <div class="norm-change-text">${u.body}</div>
          </div>
        `;let o=`
          <div class="norm-info" style="--norm-accent:${e.color}">
            <div class="norm-info-header">
              <div class="norm-info-title">${e.icon} ${e.name}</div>
              <div class="norm-info-intro">${s.intro||""}</div>
            </div>
        `;this.currentStep===0?o+=r("Issues:",(s.issues||[]).map(n).join("")):(o+=r("Changes:",(s.changes||((c=i.changes)==null?void 0:c.map(u=>({title:u,body:""})))||[]).map(a).join("")),(h=s.remaining)!=null&&h.length&&(o+=r("Remaining Issues:",s.remaining.map(u=>`
                      <div class="norm-issue">
                        <div class="norm-issue-title">âš ï¸ ${u.title}</div>
                        <div class="norm-issue-text norm-issue-problem">${u.body}</div>
                      </div>
                    `).join(""))),s.success?o+=`<div class="norm-success">${s.success}</div>`:((d=i.issues)==null?void 0:d[0])==="âœ… Fully normalized!"&&(o+='<div class="norm-success">âœ… Fully normalized! No anomalies.</div>')),o+="</div>",t.innerHTML=o},updateButtons(){const t=jt("btnNormPrev"),e=jt("btnNormNext");t&&(t.disabled=this.currentStep===0),e&&(e.disabled=this.currentStep===4);const i=jt("normStepIndicator");i&&(i.textContent=`Step ${this.currentStep}/4`)},getDataForStep(t){switch(t){case 1:return this.sampleData.nf1;case 2:return this.sampleData.nf2;case 3:return this.sampleData.nf3;case 4:return this.sampleData.bcnf;default:return this.sampleData.original}}};typeof window<"u"&&(window.NormalizationEngine=Ar);const $n={init(){this.bindEvents(),console.log("[SQLElectures] âœ… Initialized")},bindEvents(){const t=document.getElementById("sqlLectureTabs");t&&t.addEventListener("click",e=>{e.target.classList.contains("tab-btn")&&this.switchTab(e.target)})},switchTab(t){document.querySelectorAll("#sqlLectureTabs .tab-btn").forEach(a=>a.classList.remove("active")),t.classList.add("active"),document.querySelectorAll(".lecture-panel").forEach(a=>a.style.display="none");let s="";const r=t.textContent.trim();r.includes("DQL")?s="lecture-dql":r.includes("Joins")?s="lecture-joins":r.includes("DML")?s="lecture-dml":r.includes("DDL")?s="lecture-ddl":r.includes("Aggregation")&&(s="lecture-agg");const n=document.getElementById(s);n&&(n.style.display="block")}},V2=[{id:"sql-dql-basics",title:"DQL: The Art of Asking",category:"SQL Patterns",hook:"Imagine a massive library. You don't walk shelf by shelf; you ask the librarian. 'Give me all sci-fi books from 1980.' That's exactly what DQL (Data Query Language) does.",steps:[{title:"SELECT: Choosing Your Columns",narration:"SELECT is your pointing finger. It tells the database exactly which columns you want to see. You can pick specific ones like 'name' and 'age', or use the wildcard '*' to grab everything.",code:`SELECT name, age FROM users;
SELECT * FROM products;`},{title:"FROM: Choosing Your Source",narration:"FROM tells the database where to look. It's the table name. You can't ask for data without saying where it lives.",visual:'<div class="sql-visual-table">Table: <strong>users</strong></div>'},{title:"WHERE: Filtering the Noise",narration:"WHERE is the filter. It sifts through millions of rows and keeps only the ones that match your condition. 'WHERE age > 18'. It's the gatekeeper.",code:`SELECT * FROM users
WHERE age >= 18 AND active = true;`}],keyTakeaway:"SELECT columns FROM table WHERE condition. This simple pattern is the foundation of 90% of data retrieval.",whenToUse:["Retrieving data","Filtering records","Reporting"],relatedProblems:[]},{id:"sql-joins-visual",title:"Visualizing SQL Joins",category:"SQL Patterns",hook:"Data is often split across many tables. Joins are the superglue that brings them back together. But there are different ways to glue things, and choosing the wrong one can lose data.",steps:[{title:"INNER JOIN: The Intersection",narration:"Inner Join is the strict parent. It only returns rows where there is a match in BOTH tables. If a user has no orders, they disappear. If an order has no user, it disappears.",visual:'<div class="venn-diagram inner-join">Intersection Only</div>'},{title:"LEFT JOIN: The Inclusive Host",narration:"Left Join is inclusive. It keeps EVERYTHING from the left table (the first one you mentioned). If there's a match on the right, great! If not, it just fills in NULLs. No left-side data is left behind.",visual:'<div class="venn-diagram left-join">Left Circle + Intersection</div>'},{title:"RIGHT & FULL JOIN",narration:"Right Join is just Left Join reversed. Full Join keeps everything from both sides, matching where possible and using NULLs where not.",visual:'<div class="venn-diagram full-join">Both Circles</div>'}],keyTakeaway:"Inner Join for matches only. Left Join to keep the main list. Joins connect tables via foreign keys.",whenToUse:["Combining data from multiple tables","Relational data retrieval"],relatedProblems:[]}];window.ConceptLibrary&&V2.forEach(t=>window.ConceptLibrary.register(t));const z2=[{id:"lecture-sql-dql",title:"Mastering SELECT",description:"Learn how to query data with precision using SELECT, FROM, and WHERE.",category:"sql",difficulty:"beginner",duration:"5 min",xpReward:100,steps:[{type:"concept",conceptId:"sql-dql-basics"},{type:"challenge",question:"Which keyword is used to filter rows?",options:["SELECT","FILTER","WHERE","LIMIT"],correctIndex:2}]},{id:"lecture-sql-joins",title:"The Power of Joins",description:"Visualize and understand Inner, Left, Right, and Full joins.",category:"sql",difficulty:"intermediate",duration:"8 min",xpReward:150,steps:[{type:"concept",conceptId:"sql-joins-visual"}]}];window.LectureLibrary&&z2.forEach(t=>window.LectureLibrary.register(t));const In={init(){console.log("[SQLElecturesContent] âœ… Registered SQL Content")}},us=t=>document.getElementById(t),X2={tables:{Students:{columns:["id","name","major","gpa"],rows:[[1,"Alice","CS",3.8],[2,"Bob","Math",3.5],[3,"Carol","CS",3.9],[4,"David","Physics",3.2]]},Enrollments:{columns:["student_id","course","grade"],rows:[[1,"DB101","A"],[1,"AI201","B+"],[2,"DB101","A-"],[3,"AI201","A"],[4,"PHY101","B"]]}},init(){console.log("[RelationalAlgebra] Initializing..."),console.log("[RelationalAlgebra] âœ… Ready")},runSelection(){var o,l,c,h;const t=((o=us("raSelectionColumn"))==null?void 0:o.value)||"major",e=((l=us("raSelectionOp"))==null?void 0:l.value)||"=",i=((c=us("raSelectionValue"))==null?void 0:c.value)||"CS",s=this.tables.Students,r=s.columns.indexOf(t);if(r===-1){T("Column not found","error");return}const n=s.rows.filter(d=>{const u=d[r];return this.compare(u,e,i)}),a={columns:s.columns,rows:n};this.renderResult("raSelectionResult",a,`Ïƒ<sub>${t}${e}'${i}'</sub>(Students) â†’ ${n.length} row(s)`),(h=O==null?void 0:O.play)==null||h.call(O,"success"),T(`âœ… Selection: ${n.length} rows match`)},compare(t,e,i){const s=parseFloat(t),r=parseFloat(i),n=!isNaN(s)&&!isNaN(r);switch(e){case"=":return n?s===r:String(t)===i;case">":return n?s>r:String(t)>i;case"<":return n?s<r:String(t)<i;case">=":return n?s>=r:String(t)>=i;case"<=":return n?s<=r:String(t)<=i;default:return!1}},runProjection(){var n,a,o,l,c;const t=this.tables.Students,e=[];if((n=us("raProjectId"))!=null&&n.checked&&e.push("id"),(a=us("raProjectName"))!=null&&a.checked&&e.push("name"),(o=us("raProjectMajor"))!=null&&o.checked&&e.push("major"),(l=us("raProjectGpa"))!=null&&l.checked&&e.push("gpa"),e.length===0){T("Select at least one column","error");return}const i=e.map(h=>t.columns.indexOf(h)),s=t.rows.map(h=>i.map(d=>h[d])),r={columns:e,rows:s};this.renderResult("raProjectionResult",r,`Ï€<sub>${e.join(", ")}</sub>(Students) â†’ ${e.length} column(s)`),(c=O==null?void 0:O.play)==null||c.call(O,"success"),T(`âœ… Projection: ${e.length} columns`)},runJoin(){var o;const t=this.tables.Students,e=this.tables.Enrollments,i=t.columns.indexOf("id"),s=e.columns.indexOf("student_id"),r=[];t.rows.forEach(l=>{e.rows.forEach(c=>{if(l[i]===c[s]){const h=[...l,...c.filter((d,u)=>u!==s)];r.push(h)}})});const a={columns:[...t.columns,...e.columns.filter(l=>l!=="student_id")],rows:r};this.renderResult("raJoinResult",a,`Students â¨ Enrollments â†’ ${r.length} row(s)`),(o=O==null?void 0:O.play)==null||o.call(O,"success"),T(`âœ… Join: ${r.length} rows`)},runCombined(){var u;const t=this.tables.Students,e=this.tables.Enrollments,i=t.columns.indexOf("major"),s={columns:t.columns,rows:t.rows.filter(p=>p[i]==="CS")},r=s.columns.indexOf("id"),n=e.columns.indexOf("student_id"),a=[];s.rows.forEach(p=>{e.rows.forEach(f=>{if(p[r]===f[n]){const g=[...p,...f.filter((m,y)=>y!==n)];a.push(g)}})});const o=[...s.columns,...e.columns.filter(p=>p!=="student_id")],l=["name","course","grade"],c=l.map(p=>o.indexOf(p)),h=a.map(p=>c.map(f=>p[f])),d={columns:l,rows:h};this.renderResult("raCombinedResult",d,`Ï€<sub>name,course,grade</sub>(Ïƒ<sub>major='CS'</sub>(Students) â¨ Enrollments) â†’ ${h.length} row(s)`),(u=O==null?void 0:O.play)==null||u.call(O,"sql_run_success"),T(`âœ… Combined: ${h.length} rows for CS students`)},renderResult(t,e,i){const s=us(t);if(!s)return;if(!e.rows.length){s.innerHTML=`
        <div class="notebook-card" style="text-align: center; color: var(--text-muted);">
          <p>${i}</p>
          <p>âš ï¸ Empty result set</p>
        </div>
      `;return}const r=`<thead><tr>${e.columns.map(a=>`<th>${a}</th>`).join("")}</tr></thead>`,n=`<tbody>${e.rows.map(a=>`<tr>${a.map(o=>`<td>${o}</td>`).join("")}</tr>`).join("")}</tbody>`;s.innerHTML=`
      <div class="notebook-card">
        <p style="margin-bottom: 0.5rem; font-family: monospace;">${i}</p>
        <table class="sql-table">${r}${n}</table>
      </div>
    `}};typeof window<"u"&&(window.RelationalAlgebra=X2);const Ht=t=>document.getElementById(t),G2={state:{scenario:"dirty-read",step:0,running:!1,data:{balance:1e3},uncommitted:null,txA:{status:"idle",log:[]},txB:{status:"idle",log:[]}},scenarios:{"dirty-read":{title:"Dirty Read",description:"Transaction B reads uncommitted data from Transaction A. If A rolls back, B has invalid data.",steps:[{tx:"A",action:"BEGIN",text:"BEGIN TRANSACTION"},{tx:"A",action:"WRITE",value:500,text:"UPDATE balance = 500"},{tx:"B",action:"BEGIN",text:"BEGIN TRANSACTION"},{tx:"B",action:"READ",text:"SELECT balance â†’ reads 500 (DIRTY!)"},{tx:"A",action:"ROLLBACK",text:"ROLLBACK (balance back to 1000)"},{tx:"B",action:"COMMIT",text:"COMMIT (but has wrong value!)"}],anomalyStep:3,anomalyText:"Transaction B read the value 500, but this was never committed! When A rolled back, B now has incorrect data."},"lost-update":{title:"Lost Update",description:"Both transactions read the same value, then overwrite each other's update.",steps:[{tx:"A",action:"BEGIN",text:"BEGIN TRANSACTION"},{tx:"A",action:"READ",text:"SELECT balance â†’ 1000"},{tx:"B",action:"BEGIN",text:"BEGIN TRANSACTION"},{tx:"B",action:"READ",text:"SELECT balance â†’ 1000"},{tx:"A",action:"WRITE",value:1100,text:"UPDATE balance = 1000 + 100 = 1100"},{tx:"A",action:"COMMIT",text:"COMMIT"},{tx:"B",action:"WRITE",value:1200,text:"UPDATE balance = 1000 + 200 = 1200"},{tx:"B",action:"COMMIT",text:"COMMIT (A's update is LOST!)"}],anomalyStep:7,anomalyText:"Transaction A added $100 (1000â†’1100), but B used the old value and set it to 1200. We lost A's $100 update! Balance should be $1300."},"non-repeatable":{title:"Non-Repeatable Read",description:"Transaction A reads a value twice, but gets different results because B modified it in between.",steps:[{tx:"A",action:"BEGIN",text:"BEGIN TRANSACTION"},{tx:"A",action:"READ",text:"SELECT balance â†’ 1000"},{tx:"B",action:"BEGIN",text:"BEGIN TRANSACTION"},{tx:"B",action:"WRITE",value:1500,text:"UPDATE balance = 1500"},{tx:"B",action:"COMMIT",text:"COMMIT"},{tx:"A",action:"READ",text:"SELECT balance â†’ 1500 (CHANGED!)"},{tx:"A",action:"COMMIT",text:"COMMIT (confused by inconsistent reads)"}],anomalyStep:5,anomalyText:"Transaction A read 1000 first, then 1500 later in the SAME transaction! This inconsistency can break application logic."},phantom:{title:"Phantom Read",description:"Transaction A runs a query twice, but gets different row counts because B added/removed rows.",steps:[{tx:"A",action:"BEGIN",text:"BEGIN TRANSACTION"},{tx:"A",action:"READ",text:"SELECT COUNT(*) â†’ 5 rows"},{tx:"B",action:"BEGIN",text:"BEGIN TRANSACTION"},{tx:"B",action:"INSERT",text:"INSERT INTO accounts VALUES (...)"},{tx:"B",action:"COMMIT",text:"COMMIT"},{tx:"A",action:"READ",text:"SELECT COUNT(*) â†’ 6 rows (PHANTOM!)"},{tx:"A",action:"COMMIT",text:"COMMIT (unexpected extra row)"}],anomalyStep:5,anomalyText:'Transaction A counted 5 rows, then 6 rows later! The new row is a "phantom" that appeared mid-transaction.'}},init(){console.log("[TransactionSimulator] Initializing..."),this.loadScenario("dirty-read"),console.log("[TransactionSimulator] âœ… Ready")},loadScenario(t){this.state.scenario=t,this.reset();const e=this.scenarios[t];e&&(Ht("txScenarioTitle").textContent=`ðŸ“– ${e.title} Explained`,Ht("txScenarioDesc").innerHTML=e.description,T(`ðŸ“š Loaded: ${e.title}`))},reset(){this.state.step=0,this.state.running=!1,this.state.data={balance:1e3},this.state.uncommitted=null,this.state.txA={status:"idle",log:[]},this.state.txB={status:"idle",log:[]},this.updateUI(),Ht("txAnomalyAlert").style.display="none"},start(){this.state.running||(this.reset(),this.state.running=!0,this.runAllSteps())},async runAllSteps(){const t=this.scenarios[this.state.scenario];if(t){for(let e=0;e<t.steps.length&&this.state.running;e++)await this.executeStep(e),await this.delay(1e3);this.state.running=!1}},step(){const t=this.scenarios[this.state.scenario];if(!t||this.state.step>=t.steps.length){T("Simulation complete");return}this.executeStep(this.state.step),this.state.step++},async executeStep(t){var r,n;const e=this.scenarios[this.state.scenario],i=e.steps[t];if(!i)return;const s=i.tx==="A"?this.state.txA:this.state.txB;i.action==="BEGIN"?s.status="active":i.action==="COMMIT"?(s.status="committed",this.state.uncommitted!==null&&(this.state.data.balance=this.state.uncommitted,this.state.uncommitted=null)):i.action==="ROLLBACK"?(s.status="rolled back",this.state.uncommitted=null):i.action==="WRITE"&&i.value!==void 0&&(this.state.uncommitted=i.value),s.log.push(i.text),t===e.anomalyStep&&(Ht("txAnomalyAlert").style.display="block",Ht("txAnomalyText").textContent=e.anomalyText,(r=O==null?void 0:O.play)==null||r.call(O,"error")),this.state.step=t+1,this.updateUI(),(n=O==null?void 0:O.play)==null||n.call(O,"click")},updateUI(){const t=this.state.uncommitted!==null?this.state.uncommitted:this.state.data.balance;Ht("txDataValue").textContent=`$${t}`,Ht("txCommitStatus").textContent=this.state.uncommitted!==null?"â³ Uncommitted":"âœ… Committed",Ht("txDataValue").style.color=this.state.uncommitted!==null?"var(--accent-coral)":"var(--accent-forest)",Ht("txALog").innerHTML=this.state.txA.log.length?this.state.txA.log.map((e,i)=>`<div>${i+1}. ${e}</div>`).join(""):'<div style="color: var(--text-muted);">Waiting to start...</div>',Ht("txAStatus").textContent=`Status: ${this.state.txA.status}`,Ht("txBLog").innerHTML=this.state.txB.log.length?this.state.txB.log.map((e,i)=>`<div>${i+1}. ${e}</div>`).join(""):'<div style="color: var(--text-muted);">Waiting to start...</div>',Ht("txBStatus").textContent=`Status: ${this.state.txB.status}`},delay(t){return new Promise(e=>setTimeout(e,t))}};typeof window<"u"&&(window.TransactionSimulator=G2);const ut=t=>document.getElementById(t);class mo{constructor(e=!0){this.keys=[],this.children=[],this.isLeaf=e,this.parent=null,this.x=0,this.y=0,this.highlighted=!1}}const Y2={root:null,order:4,log:[],highlightPath:[],init(){console.log("[BTreeVisualizer] Initializing..."),this.reset(),console.log("[BTreeVisualizer] âœ… Ready")},reset(){this.root=new mo(!0),this.log=[],this.highlightPath=[],this.addLog("ðŸŒ± Tree initialized (empty)"),this.render(),this.updateStats()},setOrder(t){this.order=parseInt(t),ut("btreeOrderDisplay").textContent=this.order,this.reset(),this.addLog(`ðŸ“ Order set to ${this.order}`)},insert(){var e,i;const t=parseInt((e=ut("btreeInsertValue"))==null?void 0:e.value);if(isNaN(t)){T("Please enter a valid number","error");return}this.insertValue(t),this.addLog(`âž• Inserted ${t}`),this.render(),this.updateStats(),(i=O==null?void 0:O.play)==null||i.call(O,"ds_insert"),T(`âœ… Inserted ${t}`)},insertRandom(){const t=Math.floor(Math.random()*100)+1;ut("btreeInsertValue").value=t,this.insert()},insertValue(t){if(this.searchValue(t).found){this.addLog(`âš ï¸ ${t} already exists`);return}const e=this.findLeaf(t);this.insertIntoLeaf(e,t),e.keys.length>=this.order&&this.splitNode(e)},findLeaf(t){let e=this.root;for(;!e.isLeaf;){let i=0;for(;i<e.keys.length&&t>=e.keys[i];)i++;e=e.children[i]}return e},insertIntoLeaf(t,e){let i=0;for(;i<t.keys.length&&t.keys[i]<e;)i++;t.keys.splice(i,0,e)},splitNode(t){const e=Math.floor(t.keys.length/2),i=new mo(t.isLeaf);if(t.isLeaf){i.keys=t.keys.splice(e);const s=i.keys[0];if(t.parent)this.insertIntoParent(t,s,i);else{const r=new mo(!1);r.keys=[s],r.children=[t,i],t.parent=r,i.parent=r,this.root=r,this.addLog(`ðŸ”€ Root split, promoted ${s}`)}}else{const s=t.keys[e];if(i.keys=t.keys.splice(e+1),t.keys.pop(),i.children=t.children.splice(e+1),i.children.forEach(r=>r.parent=i),t.parent)this.insertIntoParent(t,s,i);else{const r=new mo(!1);r.keys=[s],r.children=[t,i],t.parent=r,i.parent=r,this.root=r,this.addLog(`ðŸ”€ Internal split, promoted ${s}`)}}},insertIntoParent(t,e,i){const s=t.parent;let r=0;for(;r<s.keys.length&&s.keys[r]<e;)r++;s.keys.splice(r,0,e),s.children.splice(r+1,0,i),i.parent=s,s.keys.length>=this.order&&this.splitNode(s)},search(){var s,r,n;const t=parseInt((s=ut("btreeSearchValue"))==null?void 0:s.value);if(isNaN(t)){T("Please enter a valid number","error");return}const e=this.searchValue(t);this.highlightPath=e.path;const i=ut("btreeSearchResult");i.style.display="block",e.found?(ut("btreeSearchTitle").textContent="âœ… Found!",ut("btreeSearchText").textContent=`Key ${t} found in ${e.path.length} step(s).`,ut("btreeSearchPath").textContent=`Path: ${e.path.map(a=>`[${a.keys.join(",")}]`).join(" â†’ ")}`,(r=O==null?void 0:O.play)==null||r.call(O,"success")):(ut("btreeSearchTitle").textContent="âŒ Not Found",ut("btreeSearchText").textContent=`Key ${t} is not in the tree.`,ut("btreeSearchPath").textContent=`Searched: ${e.path.map(a=>`[${a.keys.join(",")}]`).join(" â†’ ")}`,(n=O==null?void 0:O.play)==null||n.call(O,"error")),this.addLog(`ðŸ” Searched ${t}: ${e.found?"Found":"Not found"}`),this.render(),setTimeout(()=>{this.highlightPath=[],this.render()},2e3)},searchValue(t){const e=[];let i=this.root;for(;i;){if(e.push(i),i.isLeaf)return{found:i.keys.includes(t),path:e};let s=0;for(;s<i.keys.length&&t>=i.keys[s];)t===i.keys[s]&&i.isLeaf,s++;i=i.children[s]}return{found:!1,path:e}},render(){const t=ut("btreeCanvas");if(!t)return;const e=t.getContext("2d"),i=window.devicePixelRatio||1,s=t.getBoundingClientRect();if(t.width=s.width*i,t.height=s.height*i,e.scale(i,i),e.fillStyle="#fafafa",e.fillRect(0,0,s.width,s.height),!this.root||this.root.keys.length===0){e.fillStyle="#999",e.font="16px Inter",e.textAlign="center",e.fillText("Empty tree - insert some values!",s.width/2,s.height/2);return}this.calculatePositions(this.root,0,s.width,0),this.drawEdges(e,this.root),this.drawNodes(e,this.root)},calculatePositions(t,e,i,s){if(!t)return;const r=40+s*80,n=(e+i)/2;if(t.x=n,t.y=r,!t.isLeaf&&t.children.length>0){const a=(i-e)/t.children.length;t.children.forEach((o,l)=>{this.calculatePositions(o,e+l*a,e+(l+1)*a,s+1)})}},drawEdges(t,e){!e||e.isLeaf||(t.strokeStyle="#999",t.lineWidth=2,e.children.forEach(i=>{t.beginPath(),t.moveTo(e.x,e.y+20),t.lineTo(i.x,i.y-20),t.stroke(),this.drawEdges(t,i)}))},drawNodes(t,e){if(!e)return;const i=this.highlightPath.includes(e),s=Math.max(60,e.keys.length*30+20),r=40;t.fillStyle=i?e.isLeaf?"#a8e6cf":"#ffd3b6":e.isLeaf?"#e8f5e9":"#fff3e0",t.strokeStyle=i?"#2f6a57":"#999",t.lineWidth=i?3:2,this.roundRect(t,e.x-s/2,e.y-r/2,s,r,8),t.fill(),t.stroke(),t.fillStyle="#333",t.font="bold 14px JetBrains Mono",t.textAlign="center",t.textBaseline="middle",t.fillText(e.keys.join(" | "),e.x,e.y),e===this.root&&(t.font="10px Inter",t.fillStyle="#666",t.fillText("root",e.x,e.y-r/2-8)),e.isLeaf||e.children.forEach(n=>this.drawNodes(t,n))},roundRect(t,e,i,s,r,n){t.beginPath(),t.moveTo(e+n,i),t.lineTo(e+s-n,i),t.quadraticCurveTo(e+s,i,e+s,i+n),t.lineTo(e+s,i+r-n),t.quadraticCurveTo(e+s,i+r,e+s-n,i+r),t.lineTo(e+n,i+r),t.quadraticCurveTo(e,i+r,e,i+r-n),t.lineTo(e,i+n),t.quadraticCurveTo(e,i,e+n,i),t.closePath()},updateStats(){const t=this.getStats(this.root);ut("btreeKeyCount").textContent=t.keys,ut("btreeHeight").textContent=t.height,ut("btreeNodeCount").textContent=t.nodes,ut("btreeOrderDisplay").textContent=this.order},getStats(t,e=1){if(!t)return{keys:0,height:0,nodes:0};let i={keys:t.keys.length,height:e,nodes:1};return t.isLeaf||t.children.forEach(s=>{const r=this.getStats(s,e+1);i.keys+=r.keys,i.height=Math.max(i.height,r.height),i.nodes+=r.nodes}),i},addLog(t){this.log.unshift(t),this.log.length>20&&this.log.pop();const e=ut("btreeLog");e&&(e.innerHTML=this.log.map(i=>`<div>${i}</div>`).join(""))}};typeof window<"u"&&(window.BTreeVisualizer=Y2);const Z2={init(){var t;console.log("[SQLLessons] Initialized"),(t=window.SQLModule)!=null&&t.ensureReady&&window.SQLModule.ensureReady()},async run(t){const e=`lesson${t}-input`,i=`lesson${t}-output`,s=v(e).value,r=v(i);if(s.trim()){r.style.display="block",r.innerHTML='<span style="color: #666">Running...</span>';try{const n=await Et.runQuery(s);this.renderTable(n,r)}catch(n){r.innerHTML=`<span style="color: var(--accent-coral)">âŒ ${n.message}</span>`}}},renderTable(t,e){if(!t||!t.values||t.values.length===0){e.innerHTML='<span style="color: #666">No results found.</span>';return}const i=t.columns,s=t.values;let r='<table class="sql-table" style="font-size: 0.8rem; width: 100%;">';r+="<thead><tr>",i.forEach(n=>r+=`<th>${n}</th>`),r+="</tr></thead>",r+="<tbody>",s.slice(0,5).forEach(n=>{r+="<tr>",n.forEach(a=>r+=`<td>${a}</td>`),r+="</tr>"}),r+="</tbody></table>",s.length>5&&(r+=`<div style="text-align: center; font-size: 0.75rem; color: #666; margin-top: 0.25rem;">...and ${s.length-5} more rows</div>`),e.innerHTML=r}};typeof window<"u"&&(window.SQLLessons=Z2);console.log("[SidebarConfig] Module loaded - v4 (SchemaLive Added)");const H2=[{title:"Today",items:[{id:"quiz-mode",icon:"ðŸ§ ",label:"Quiz Mode",style:"background: linear-gradient(135deg, #8B5CF6, #A78BFA); color: white;"}]},{title:"Sandbox",items:[{id:"algorithm-sandbox",icon:"ðŸ§ª",label:"Code Sandbox",badge:"Try",badgeStyle:"background: white; color: #059669",style:"background: linear-gradient(135deg, #10b981, #059669); color: white; box-shadow: 0 0 15px rgba(16, 185, 129, 0.4); animation: sandboxGlow 2s ease-in-out infinite;",className:"sandbox-nav-btn"}]},{title:"Visualizers",items:[{id:"algorithms",icon:"âš¡",label:"Sorting Algorithms",className:"active"},{id:"searching",icon:"ðŸ”",label:"Searching"},{id:"pathfinding",icon:"ðŸ—ºï¸",label:"Pathfinding"},{id:"algorithm-race",icon:"ðŸ",label:"Algorithm Race"},{id:"divide-conquer",icon:"âœ‚ï¸",label:"Divide & Conquer"},{id:"electure-algorithms",icon:"ðŸŽ“",label:"E-Lectures",badge:"Learn",badgeStyle:"background: white; color: #667eea",style:"background: linear-gradient(135deg, #667eea, #764ba2); color: white; margin-top: 0.5rem;",className:"electure-nav-btn"}],footerHtml:`
    <div style="margin-top: 0.75rem; padding-top: 0.5rem; border-top: 1px solid var(--border-subtle);">
      <div style="font-size: 0.7rem; text-transform: uppercase; color: var(--text-muted); padding: 0 0.75rem 0.25rem; letter-spacing: 0.05em;">
        Exam Solutions
      </div>
      <button class="nav-item" data-section="algo-midterm-solutions">
        <span class="nav-item-icon" aria-hidden="true">ðŸ“</span>
        Midterm Solutions
      </button>
      <button class="nav-item" data-section="algo-final-solutions">
        <span class="nav-item-icon" aria-hidden="true">ðŸŽ“</span>
        Final Solutions
      </button>
    </div>`},{title:"Data Structures",items:[{id:"ds-array",icon:"ðŸ“Š",label:"Arrays"},{id:"ds-stack",icon:"ðŸ“š",label:"Stacks"},{id:"ds-queue",icon:"ðŸŽ«",label:"Queues"},{id:"ds-linkedlist",icon:"ðŸ”—",label:"Linked Lists"},{id:"ds-tree",icon:"ðŸŒ³",label:"Binary Trees"},{id:"ds-hash",icon:"ðŸ—‚ï¸",label:"Hash Tables"},{id:"ds-heap",icon:"ðŸ”º",label:"Heaps",badge:"New",badgeStyle:"background: var(--accent-coral)",style:"background: linear-gradient(135deg, var(--bg-paper), var(--bg-elevated));"},{id:"ds-graph",icon:"ðŸ•¸ï¸",label:"Graphs"},{id:"ds-sandbox",icon:"ðŸ§ª",label:"DS Sandbox",badge:"Try",badgeStyle:"background: white; color: #0891b2",style:"background: linear-gradient(135deg, #06b6d4, #0891b2); color: white; box-shadow: 0 0 15px rgba(6, 182, 212, 0.4); animation: sandboxGlow 2s ease-in-out infinite;",className:"sandbox-nav-btn"},{id:"electure-datastructures",icon:"ðŸŽ“",label:"E-Lectures",badge:"Learn",badgeStyle:"background: white; color: #667eea",style:"background: linear-gradient(135deg, #667eea, #764ba2); color: white; margin-top: 0.5rem;",className:"electure-nav-btn"}],footerHtml:`
    <div style="margin-top: 0.75rem; padding-top: 0.5rem; border-top: 1px solid var(--border-subtle);">
      <div style="font-size: 0.7rem; text-transform: uppercase; color: var(--text-muted); padding: 0 0.75rem 0.25rem; letter-spacing: 0.05em;">
        Exam Solutions
      </div>
      <button class="nav-item" data-section="lab-solutions">
        <span class="nav-item-icon" aria-hidden="true">ðŸ§ª</span>
        Lab Solutions
      </button>
      <button class="nav-item" data-section="midterm-solutions">
        <span class="nav-item-icon" aria-hidden="true">ðŸ“</span>
        Midterm Solutions
      </button>
      <button class="nav-item" data-section="final-solutions">
        <span class="nav-item-icon" aria-hidden="true">ðŸŽ“</span>
        Final Solutions
      </button>
    </div>`},{title:"Database / SQL",items:[{id:"sql-lab",icon:"ðŸ§ª",label:"SQL Lab"},{id:"sql-practice",icon:"ðŸ",label:"SQL Practice"},{id:"sql-visualizer",icon:"ðŸ‘ï¸",label:"SQL Visualizer",badge:"New",badgeStyle:"background: var(--accent-coral)"},{id:"sql-lessons",icon:"ðŸ“˜",label:"SQL Lessons",badge:"New",badgeStyle:"background: var(--accent-coral)"},{id:"electure-sql",icon:"ðŸŽ“",label:"E-Lectures",badge:"Learn",badgeStyle:"background: white; color: #667eea",style:"background: linear-gradient(135deg, #667eea, #764ba2); color: white; margin-top: 0.5rem;",className:"electure-nav-btn"}]},{title:"Database Concepts (v3)",items:[{id:"relational-algebra",icon:"ðŸ”¢",label:"Relational Algebra",badge:"New",badgeStyle:"background: var(--accent-coral)"},{id:"db-erd",icon:"ðŸ“Š",label:"ER Diagrams"},{id:"db-schema",icon:"ðŸ—ï¸",label:"Schema Design"},{id:"db-normalization",icon:"ðŸ“",label:"Normalization"},{id:"transactions",icon:"ðŸ”",label:"Transactions & ACID",badge:"New",badgeStyle:"background: var(--accent-coral)"},{id:"btree",icon:"ðŸŒ³",label:"B-Tree Index",badge:"New",badgeStyle:"background: var(--accent-coral)"},{id:"schema-live",icon:"ðŸŽ¨",label:"Schema-Live",badge:"New",badgeStyle:"background: #10b981",className:"schema-live-nav-btn"},{id:"nosql",icon:"ðŸƒ",label:"NoSQL Intro",badge:"New",badgeStyle:"background: var(--accent-coral)"}]},{title:"Story Lessons",items:[{id:"story-recursion",icon:"ðŸ”„",label:"Recursion",badge:"Story"},{id:"story-bigo",icon:"ðŸŽï¸",label:"Big O Notation",badge:"Story"}]}],Qn={init(){try{const t=document.getElementById("sidebar");if(!t){console.error("Sidebar element not found");return}let e=`
      <!-- Back to Dashboard Button (compact) -->
      <div id="courseBackBtn" class="back-btn"
        style="margin: 0.75rem 1rem; padding: 0.5rem 0.85rem; font-size: 0.9rem; display: flex; align-items: center; gap: 0.5rem;">
        <span style="font-size: 1.1rem;">â†</span> Back to Dashboard
      </div>
    `;H2.forEach(i=>{e+='<div class="nav-section">',i.title&&(e+=`<div class="nav-section-title">${i.title}</div>`),i.items.forEach(s=>{const r=s.style?`style="${s.style}"`:"",n=`nav-item ${s.className||""}`,a=s.badgeStyle?`style="${s.badgeStyle}"`:"";e+=`
          <button class="${n}" data-section="${s.id}" ${r}>
            <span class="nav-item-icon" aria-hidden="true">${s.icon}</span>
            ${s.label}
            ${s.badge?`<span class="nav-item-badge" ${a}>${s.badge}</span>`:""}
          </button>
        `}),i.footerHtml&&(e+=i.footerHtml),e+="</div>"}),e+=`
      <div class="nav-section" aria-label="Progress">
        <div class="nav-section-title">Your Progress</div>
        <div id="progressBadge" class="progress-badge">
          <div class="progress-badge-icon">ðŸ†</div>
          <div class="progress-badge-info">
            <div id="progressLevel" class="progress-level">ðŸŒ± Beginner</div>
            <div class="progress-xp-row">
              <span id="progressXP" class="progress-xp">0 XP</span>
              <span id="progressStreak" class="progress-streak">ðŸ”¥ 1</span>
            </div>
            <div class="progress-bar-container">
              <div id="progressBar" class="progress-bar-fill" style="width: 0%"></div>
            </div>
          </div>
        </div>
      </div>
    `,t.innerHTML=e,t.classList.remove("sidebar-hidden"),t.style.display="block",console.log("[SidebarRenderer] Sidebar rendered dynamically (v3)")}catch(t){console.error("[SidebarRenderer] Error rendering sidebar:",t);const e=document.getElementById("sidebar-legacy");e&&(e.style.display="block",e.classList.remove("sidebar-hidden"));const i=document.createElement("div");i.style.cssText="position:fixed;top:10px;left:10px;background:red;color:white;padding:20px;z-index:99999;",i.innerText="Sidebar Error: "+t.message,document.body.appendChild(i)}}};function Ll(t=10){const e=document.getElementById("bigoCanvas");if(!e)return;const i=e.getContext("2d");if(!i)return;const s=window.devicePixelRatio||1,r=e.getBoundingClientRect();e.width=r.width*s,e.height=r.height*s,i.scale(s,s);const n=r.width,a=r.height;i.clearRect(0,0,n,a),i.fillStyle="#1a1a2e",i.fillRect(0,0,n,a);const o={top:30,right:120,bottom:40,left:60},l=n-o.left-o.right,c=a-o.top-o.bottom;i.strokeStyle="rgba(255, 255, 255, 0.1)",i.lineWidth=1;for(let f=0;f<=5;f++){const g=o.top+c/5*f;i.beginPath(),i.moveTo(o.left,g),i.lineTo(o.left+l,g),i.stroke()}i.strokeStyle="rgba(255, 255, 255, 0.5)",i.lineWidth=2,i.beginPath(),i.moveTo(o.left,o.top),i.lineTo(o.left,a-o.bottom),i.lineTo(n-o.right,a-o.bottom),i.stroke(),i.fillStyle="rgba(255, 255, 255, 0.7)",i.font="12px Inter, sans-serif",i.textAlign="center",i.fillText("Input Size (n)",o.left+l/2,a-8),i.save(),i.translate(15,o.top+c/2),i.rotate(-Math.PI/2),i.fillText("Time / Operations",0,0),i.restore();const h=[{fn:f=>1,color:"#2F6A57",label:"O(1)",emoji:"âš¡"},{fn:f=>Math.log2(Math.max(1,f)),color:"#5B8BA0",label:"O(log n)",emoji:"ðŸ”"},{fn:f=>f,color:"#D4A853",label:"O(n)",emoji:"ðŸƒ"},{fn:f=>f*Math.log2(Math.max(1,f)),color:"#E07A5F",label:"O(n log n)",emoji:"âš™ï¸"},{fn:f=>f*f,color:"#C44536",label:"O(nÂ²)",emoji:"ðŸ¢"}],d=100,u=Math.min(d*d,5e3);h.forEach((f,g)=>{i.strokeStyle=f.color,i.lineWidth=3,i.beginPath();for(let b=1;b<=d;b++){const w=o.left+b/d*l,k=Math.min(f.fn(b),u),x=a-o.bottom-k/u*c;b===1?i.moveTo(w,x):i.lineTo(w,Math.max(o.top,x))}i.stroke();const m=o.left+t/d*l,y=a-o.bottom-Math.min(f.fn(t),u)/u*c;i.beginPath(),i.arc(m,Math.max(o.top,y),8,0,Math.PI*2),i.fillStyle=f.color,i.fill(),i.strokeStyle="#fff",i.lineWidth=2,i.stroke()}),i.textAlign="left",h.forEach((f,g)=>{const m=o.top+20+g*28;i.strokeStyle=f.color,i.lineWidth=3,i.beginPath(),i.moveTo(n-o.right+10,m),i.lineTo(n-o.right+35,m),i.stroke(),i.fillStyle=f.color,i.font="bold 12px Inter, sans-serif",i.fillText(`${f.emoji} ${f.label}`,n-o.right+42,m+4)});const p=o.left+t/d*l;i.strokeStyle="rgba(255, 255, 255, 0.4)",i.lineWidth=2,i.setLineDash([5,5]),i.beginPath(),i.moveTo(p,o.top),i.lineTo(p,a-o.bottom),i.stroke(),i.setLineDash([]),i.fillStyle="#fff",i.font="bold 14px Inter, sans-serif",i.textAlign="center",i.fillText(`n = ${t}`,p,a-o.bottom+20)}function K2(){const t=v("mobileMenuBtn"),e=document.querySelector(".sidebar");!t||!e||(t.addEventListener("click",()=>{e.classList.toggle("open");const i=e.classList.contains("open");t.setAttribute("aria-expanded",i),i&&(e.classList.remove("sidebar-hidden"),e.classList.remove("sidebar-collapsed"));const s=t.querySelectorAll("span");i?(s[0].style.transform="rotate(45deg) translate(5px, 5px)",s[1].style.opacity="0",s[2].style.transform="rotate(-45deg) translate(5px, -5px)"):(s[0].style.transform="none",s[1].style.opacity="1",s[2].style.transform="none")}),document.addEventListener("click",i=>{if(window.innerWidth<=768&&!e.contains(i.target)&&!t.contains(i.target)&&e.classList.contains("open")){e.classList.remove("open"),t.setAttribute("aria-expanded","false");const s=t.querySelectorAll("span");s[0].style.transform="none",s[1].style.opacity="1",s[2].style.transform="none"}}))}function J2(){const t=v("sidebarToggle"),e=v("sidebar"),i=v("mainContent"),s=v("sidebarToggleIcon");!t||!e||t.addEventListener("click",()=>{if(document.body.classList.contains("dashboard-active"))return;const r=e.classList.toggle("sidebar-collapsed");i==null||i.classList.toggle("content-expanded",r),document.body.classList.toggle("sidebar-is-collapsed",r),t.setAttribute("aria-expanded",!r),s&&(s.textContent=r?"â–¶":"â—€"),localStorage.setItem("cse-sidebar-collapsed",r);const n=()=>window.dispatchEvent(new Event("resize"));n(),setTimeout(n,50),setTimeout(n,150),setTimeout(n,350)})}function e$(){let t;const e=()=>{clearTimeout(t),t=setTimeout(()=>{N!=null&&N.renderAll&&N.renderAll(),typeof Vt=="function"&&Vt(),Ll()},150)};if(window.addEventListener("resize",e),typeof ResizeObserver<"u"){const i=document.querySelectorAll(".viz-container"),s=new ResizeObserver(e);i.forEach(r=>{s.observe(r)})}}function t$(){var t,e,i,s,r,n,a,o,l,c,h;(t=v("btnPlay"))==null||t.addEventListener("click",()=>{cd()}),(e=v("btnPause"))==null||e.addEventListener("click",()=>{Js()}),(i=v("btnReset"))==null||i.addEventListener("click",()=>{Us()}),(s=v("btnStepFwd"))==null||s.addEventListener("click",()=>{var d,u;if(Js(),H.steps.length===0&&ll(),H.stepIndex<H.steps.length){const p=H.steps[H.stepIndex];H.data=p.arr.slice();const f=Math.max(...H.data);p.compareVals&&((d=O.playCompare)==null||d.call(O,p.compareVals[0],p.compareVals[1],f,p.pan||0)),p.swapVals&&((u=O.playSwap)==null||u.call(O,p.swapVals[0],p.swapVals[1],f,p.pan||0)),H.stepIndex++,ir(),Vt()}}),(r=v("btnStepBack"))==null||r.addEventListener("click",()=>{if(Js(),H.stepIndex>1){H.stepIndex--;const d=H.steps[H.stepIndex-1];d&&(H.data=d.arr.slice(),ir(),Vt())}}),(n=v("algoSelect"))==null||n.addEventListener("change",d=>{H.algo=d.target.value,Us()}),(a=v("speedSlider"))==null||a.addEventListener("input",d=>{H.speed=parseFloat(d.target.value);const u=v("speedLabel");u&&(u.textContent=`${H.speed.toFixed(1)}x`)}),(o=v("sizeSlider"))==null||o.addEventListener("input",d=>{H.size=parseInt(d.target.value);const u=v("sizeLabel");u&&(u.textContent=H.size),Us()}),(l=v("arrayTypeSelect"))==null||l.addEventListener("change",()=>{Us()}),(c=v("btnRandom"))==null||c.addEventListener("click",()=>{Us()}),(h=v("showValuesToggle"))==null||h.addEventListener("change",()=>{Vt()})}function i$(){document.querySelectorAll(".custom-array-preset").forEach(t=>{t.addEventListener("click",()=>{var r;const e=t.dataset.preset;if(!e)return;let i="";switch(e){case"random10":i="random(10)";break;case"random20":i="random(20)";break;case"reversed":i="reversed(15)";break;case"nearly":i="nearlysorted(15)";break;case"duplicates":const n=[5,10,15,20,25],a=[];for(let o=0;o<15;o++)a.push(n[Math.floor(Math.random()*n.length)]);i=a.join(", ");break;default:return}const s=v("customArrayInput");s&&(s.value=i),(r=window.InputParser)!=null&&r.applyToSort&&window.InputParser.applyToSort(i)})})}function s$(){var i,s,r,n,a,o,l,c,h,d;(i=v("btnPathPlay"))==null||i.addEventListener("click",()=>{hl()}),(s=v("btnPathPause"))==null||s.addEventListener("click",()=>{nn()}),(r=v("btnPathReset"))==null||r.addEventListener("click",()=>{Ft()}),(n=v("btnNewMaze"))==null||n.addEventListener("click",()=>{Ft(),al(),Le()}),(a=v("btnClearWalls"))==null||a.addEventListener("click",()=>{var u;(u=window.pathState)!=null&&u.grid&&(window.pathState.grid.walls.clear(),Ft(),Le())}),(o=v("pathAlgoSelect"))==null||o.addEventListener("change",u=>{window.pathState&&(window.pathState.algo=u.target.value);const p={bfs:{title:"ðŸŒŠ BFS Simulation (Breadth-First Search)",desc:"Explores all neighbors at current depth before going deeper. Uses Queue (FIFO). Guarantees shortest path in unweighted graphs.",icon:"ðŸŒŠ",name:"Breadth-First Search",complexity:"O(V + E)",dataStructure:"Queue (FIFO)",optimal:"Yes (unweighted)",optimalColor:"#48bb78",tip:"BFS explores level by level like ripples in water. Perfect for finding shortest paths in unweighted graphs!",color:"rgba(66,153,225",textColor:"#4299e1"},dfs:{title:"ðŸ” DFS Simulation (Depth-First Search)",desc:"Explores as deep as possible before backtracking. Uses Stack (LIFO). Good for exploring all paths but may not find shortest.",icon:"ðŸ”",name:"Depth-First Search",complexity:"O(V + E)",dataStructure:"Stack (LIFO)",optimal:"No (may not be shortest)",optimalColor:"#ed8936",tip:"DFS dives deep like an explorer in a cave. Great for finding ANY path or checking connectivity!",color:"rgba(159,122,234",textColor:"#9f7aea"},dijkstra:{title:"âš¡ Dijkstra's Algorithm",desc:"Finds shortest path in weighted graphs by always expanding the lowest-cost node. Uses Priority Queue.",icon:"âš¡",name:"Dijkstra's Algorithm",complexity:"O((V+E) log V)",dataStructure:"Priority Queue (Min-Heap)",optimal:"Yes (weighted)",optimalColor:"#48bb78",tip:"Dijkstra is like a strategic planner - always picks the cheapest next step. The gold standard for weighted graphs!",color:"rgba(237,137,54",textColor:"#ed8936"},greedy:{title:"ðŸŽ¯ Greedy Best-First Search",desc:"Always expands node closest to goal using heuristic h(n). Fast but may not find optimal path.",icon:"ðŸŽ¯",name:"Greedy Best-First",complexity:"O(b^m)",dataStructure:"Open/Closed Lists",optimal:"No (heuristic only)",optimalColor:"#ed8936",tip:"Greedy is fast but shortsighted - it always rushes toward the goal. Good when speed matters more than optimality!",color:"rgba(72,187,120",textColor:"#48bb78"},astar:{title:"â­ A* Search Algorithm",desc:"Combines actual cost g(n) + heuristic h(n) to find optimal path efficiently. f(n) = g(n) + h(n)",icon:"â­",name:"A* Search",complexity:"O(b^d)",dataStructure:"Open/Closed Lists",optimal:"Yes (with admissible h)",optimalColor:"#48bb78",tip:"A* is the best of both worlds - uses past cost AND future estimate. The smartest pathfinding algorithm!",color:"rgba(245,158,11",textColor:"#f59e0b"}},f=u.target.value,g=p[f]||p.bfs,m=document.querySelector("#section-pathfinding .page-header h1");m&&(m.textContent=g.title);const y=document.getElementById("pathAlgoDescription");y&&(y.textContent=g.desc);const b=document.getElementById("algorithmInfoCard");b&&(b.style.background=`linear-gradient(135deg, ${g.color},0.12), ${g.color},0.05))`,b.style.borderColor=`${g.color},0.25)`);const w=b==null?void 0:b.querySelector("div > span");w&&(w.textContent=g.icon);const k=document.getElementById("algoInfoTitle");k&&(k.textContent=g.name,k.style.color=g.textColor);const x=document.getElementById("algoInfoComplexity");x&&(x.textContent=g.complexity,x.style.background=`${g.color},0.2)`,x.style.color=g.textColor);const E=document.getElementById("algoInfoDS");E&&(E.textContent=g.dataStructure);const _=document.getElementById("algoInfoOptimal");_&&(_.textContent=g.optimal,_.style.color=g.optimalColor);const R=document.getElementById("algoInfoTip");R&&(R.textContent=g.tip),f==="bfs"||f==="dfs"?window.generateMaze&&window.generateMaze():f==="dijkstra"?window.generateDijkstraGraph&&window.generateDijkstraGraph():(f==="greedy"||f==="astar")&&(window.generateAStarGraph?window.generateAStarGraph():window.generateGreedyGraph&&window.generateGreedyGraph()),Ft(),Le(),window.startPhysicsAnimation&&window.startPhysicsAnimation()});const t=v("customEdgeList");t&&(t.addEventListener("input",u=>{var m;parseInt(((m=v("customNodeCount"))==null?void 0:m.value)||"6",10);const g=u.target.value.split(`
`).map(y=>{const b=y.trim();return/^\d\d$/.test(b)?b[0]+" "+b[1]:y}).join(`
`);if(g!==u.target.value){const y=u.target.selectionStart;u.target.value=g,u.target.selectionStart=y+1,u.target.selectionEnd=y+1}}),t.addEventListener("keypress",u=>{!/[\d\s\n]/.test(u.key)&&u.key!=="Enter"&&u.key!=="Backspace"&&(u.preventDefault(),T==null||T("âš ï¸ Only numbers allowed (0-indexed nodes)"))})),(l=v("btnParseCustomGraph"))==null||l.addEventListener("click",()=>{var A,F,L,W;const u=parseInt(((A=v("customNodeCount"))==null?void 0:A.value)||"6",10),p=((F=v("customEdgeList"))==null?void 0:F.value)||"",f=(L=v("btnDirected"))==null?void 0:L.classList.contains("active"),g=p.replace(/;/g,`
`).split(`
`).map(M=>M.trim()).filter(M=>M.length>0),m={};let y=0,b=0;for(let M=0;M<u;M++)m[M]=[];if(g.forEach(M=>{let G,J;const re=M.replace(/,/g," ").trim().split(/\s+/).filter(le=>le.length>0);if(re.length>=2)G=parseInt(re[0],10),J=parseInt(re[1],10);else if(re.length===1&&re[0].length>=2){const le=re[0];if(le.length===2)G=parseInt(le[0],10),J=parseInt(le[1],10);else if(le.length===3)G=parseInt(le[0],10),J=parseInt(le.slice(1),10);else return}else return;if(!(isNaN(G)||isNaN(J))){if(G<0||G>=u||J<0||J>=u){b++;return}m[G].includes(J)||(m[G].push(J),y++),!f&&!m[J].includes(G)&&m[J].push(G)}}),y===0){T==null||T('âš ï¸ No valid edges found. Use format: "0 1" (one edge per line)');return}b>0&&(T==null||T(`âš ï¸ Skipped ${b} edge(s) with invalid node numbers (max: ${u-1})`));const w=[],k=[],x=new Array(u).fill(-1),E=new Array(u).fill(0);x[0]=0;const _=[0],R={};for(;_.length>0;){const M=_.shift(),G=x[M];R[G]||(R[G]=[]),E[M]=R[G].length,R[G].push(M);const J=m[M]||[];for(const ce of J)x[ce]===-1&&(x[ce]=G+1,_.push(ce))}for(let M=0;M<u;M++)x[M]===-1&&(x[M]=3,R[3]||(R[3]=[]),E[M]=R[3].length,R[3].push(M));Math.max(...x);const C=100,D=700,q=60;for(let M=0;M<u;M++){w.push(String(M));const G=x[M],J=((W=R[G])==null?void 0:W.length)||1,ce=D/(J+1);k.push({x:ce*(E[M]+1)+50,y:q+G*C,label:String(M)})}window.pathState&&(window.pathState.grid={isGraph:!0,isRandomGraph:!0,isDirected:f,nodes:w,adjacency:m,adjacencyBFS:m,adjacencyDFS:m,positions:k,start:0,end:u-1,walls:new Set},window.pathState.steps=[],window.pathState.stepIndex=0),Ft(),Le(),window.startPhysicsAnimation&&window.startPhysicsAnimation(),T==null||T(`ðŸ“Š Custom graph created: ${u} nodes, ${y} edges`)}),(c=v("btnUndirected"))==null||c.addEventListener("click",()=>{var u;v("btnUndirected").style.border="2px solid #4299e1",v("btnUndirected").style.background="rgba(66,153,225,0.15)",v("btnUndirected").style.color="#4299e1",v("btnUndirected").classList.add("active"),v("btnDirected").style.border="2px solid var(--border-subtle)",v("btnDirected").style.background="transparent",v("btnDirected").style.color="var(--text-muted)",v("btnDirected").classList.remove("active"),(u=window.pathState)!=null&&u.grid&&(window.pathState.grid.isDirected=!1),Ft(),Le()}),(h=v("btnDirected"))==null||h.addEventListener("click",()=>{var u;v("btnDirected").style.border="2px solid #ed8936",v("btnDirected").style.background="rgba(237,137,54,0.15)",v("btnDirected").style.color="#ed8936",v("btnDirected").classList.add("active"),v("btnUndirected").style.border="2px solid var(--border-subtle)",v("btnUndirected").style.background="transparent",v("btnUndirected").style.color="var(--text-muted)",v("btnUndirected").classList.remove("active"),(u=window.pathState)!=null&&u.grid&&(window.pathState.grid.isDirected=!0),Ft(),Le()});const e=()=>{var g,m;const u=v("goalNodeSelect");if(!u||!((m=(g=window.pathState)==null?void 0:g.grid)!=null&&m.nodes))return;const p=window.pathState.grid.nodes,f=window.pathState.grid.end;u.innerHTML=p.map((y,b)=>`<option value="${b}" ${b===f?"selected":""}>${y}</option>`).join("")};window.updateGoalNodeDropdown=e,(d=v("goalNodeSelect"))==null||d.addEventListener("change",u=>{var f;const p=parseInt(u.target.value,10);(f=window.pathState)!=null&&f.grid&&!isNaN(p)&&(window.pathState.grid.end=p,Ft(),Le(),T==null||T(`ðŸŽ¯ Goal set to node ${window.pathState.grid.nodes[p]}`))})}function r$(){var t,e,i,s,r,n,a;(t=v("soundToggle"))==null||t.addEventListener("click",()=>{var o;(o=O==null?void 0:O.toggleEnabled)==null||o.call(O)}),(e=v("soundToggle"))==null||e.addEventListener("keydown",o=>{var l;(o.key==="Enter"||o.key===" ")&&(o.preventDefault(),(l=O==null?void 0:O.toggleEnabled)==null||l.call(O))}),(i=v("volumeSlider"))==null||i.addEventListener("input",o=>{var c,h;const l=parseInt(o.target.value,10)/100;(c=O==null?void 0:O.setVolume)==null||c.call(O,l),v("volumeLabel")&&(v("volumeLabel").textContent=`${Math.round(l*100)}%`),(h=O==null?void 0:O.play)==null||h.call(O,"slider_tick")}),document.querySelectorAll(".preset-btn").forEach(o=>{o.addEventListener("click",()=>{var c;const l=o.dataset.preset;l&&(O!=null&&O.setPreset)&&(O.setPreset(l),document.querySelectorAll(".preset-btn").forEach(h=>h.classList.remove("active")),o.classList.add("active"),(c=O==null?void 0:O.play)==null||c.call(O,"click"))})}),(s=v("btnShowHints"))==null||s.addEventListener("click",()=>{var h,d,u,p,f,g,m;let o=document.getElementById("hintsModal");o||(o=document.createElement("div"),o.id="hintsModal",o.className="learning-modal",document.body.appendChild(o));const l=(H==null?void 0:H.algo)||"sorting",c=l==="quick"?"quicksort":"sorting";(d=(h=window.SmartHintSystem)==null?void 0:h.reset)==null||d.call(h),o.innerHTML=`
      <div class="learning-modal-content">
        <div class="learning-modal-header">
          <h3>ðŸ’¡ Hints: ${((p=(u=window.ALGO_INFO)==null?void 0:u[l])==null?void 0:p.name)||"Sorting"}</h3>
          <button class="modal-close" onclick="document.getElementById('hintsModal').classList.remove('active')">âœ•</button>
        </div>
        <div id="hintsContainer"></div>
      </div>
    `,o.classList.add("active"),(g=(f=window.SmartHintSystem)==null?void 0:f.render)==null||g.call(f,"hintsContainer",c),(m=O==null?void 0:O.play)==null||m.call(O,"click")}),(r=v("btnShowComplexity"))==null||r.addEventListener("click",()=>{var l,c,h;let o=document.getElementById("complexityModal");o||(o=document.createElement("div"),o.id="complexityModal",o.className="learning-modal",document.body.appendChild(o)),o.innerHTML=`
      <div class="learning-modal-content">
        <div class="learning-modal-header">
          <h3>ðŸ“Š Complexity Comparison</h3>
          <button class="modal-close" onclick="document.getElementById('complexityModal').classList.remove('active')">âœ•</button>
        </div>
        <div id="complexityContainer"></div>
      </div>
    `,o.classList.add("active"),(c=(l=window.ComplexityAnalyzer)==null?void 0:l.render)==null||c.call(l,"complexityContainer",["bubble","quick","merge","heap"]),(h=O==null?void 0:O.play)==null||h.call(O,"click")}),(n=v("llTypeSelect"))==null||n.addEventListener("change",o=>{var l;N.linkedListType=o.target.value,N.renderLinkedList(),(l=O==null?void 0:O.play)==null||l.call(O,"pop"),T(`Switched to ${o.target.value} linked list`)}),(a=v("bigoSlider"))==null||a.addEventListener("input",o=>{const l=parseInt(o.target.value,10),c=v("bigoN");c&&(c.textContent=l),Ll(l)})}const X0={currentCourse:null,courseConfig:{cse220:{name:"CSE 220: Data Structures",sections:["ds-array","ds-stack","ds-queue","ds-linkedlist","ds-tree","ds-hash","ds-heap","ds-graph","lab-solutions","midterm-solutions","final-solutions","ds-sandbox","story-bigo","recursion-story","quiz-mode","electure-datastructures"],icon:"ðŸ“š",color:"#06b6d4"},cse221:{name:"CSE 221: Algorithms",sections:["algorithms","searching","pathfinding","algorithm-race","divide-conquer","dp","greedy","algorithm-sandbox","quiz-mode","electure-algorithms","algo-midterm-solutions","algo-final-solutions"],icon:"âš¡",color:"#f59e0b"},cse370:{name:"CSE 370: Database Systems",sections:["db-erd","db-eerd","db-schema","db-normalization","relational-algebra","transactions","btree","nosql","schema-live","sql-lab","sql-practice","sql-lessons","sql-visualizer","quiz-mode","electure-sql"],icon:"ðŸ—„ï¸",color:"#8b5cf6"}},init(){localStorage.removeItem("cse-helper-lastSection"),this.bindEvents(),this.showDashboard()},bindEvents(){var t,e;document.querySelectorAll(".course-card").forEach(i=>{i.addEventListener("click",()=>{const s=i.dataset.course;s&&this.enterCourse(s)})}),(t=v("sidebarLogo"))==null||t.addEventListener("click",()=>this.showDashboard()),(e=v("courseBackBtn"))==null||e.addEventListener("click",()=>this.showDashboard())},showDashboard(){var t,e;if(this.currentCourse=null,window.Router)window.Router.navigateTo("/dashboard");else{document.querySelectorAll("[id^='section-']").forEach(s=>{s.classList.add("section-hidden")});const i=v("section-dashboard");i&&(i.classList.remove("section-hidden"),i.classList.add("page-slide-in")),(t=v("sidebar"))==null||t.classList.add("sidebar-hidden"),(e=v("mainContent"))==null||e.classList.add("dashboard-fullwidth")}},enterCourse(t){const e=this.courseConfig[t];if(!e)return;this.currentCourse=t;const i=v("section-dashboard");i&&(i.style.opacity="1",i.style.transition="opacity 0.3s ease-out, transform 0.3s ease-out",i.style.opacity="0",i.style.transform="scale(0.98)"),setTimeout(()=>{var a;i&&(i.classList.add("section-hidden"),i.style.opacity="",i.style.transform="",i.style.transition="");const s=v("sidebar");s&&(s.style.transform="translateX(-100%)",s.classList.remove("sidebar-hidden"),s.classList.remove("sidebar-collapsed"),s.style.transition="transform 0.4s cubic-bezier(0.4, 0, 0.2, 1)",requestAnimationFrame(()=>{s.style.transform="translateX(0)"}),setTimeout(()=>{s.style.transform="",s.style.transition=""},400));const r=v("mainContent");r==null||r.classList.remove("dashboard-fullwidth"),r==null||r.classList.remove("content-expanded"),document.body.classList.remove("sidebar-is-collapsed"),document.body.classList.remove("dashboard-active"),window.dispatchEvent(new Event("resize")),this.filterNavbar(t);const n=e.sections[0];setTimeout(()=>{id.setSection(n);const o=v(`section-${n}`);o&&(o.style.opacity="0",o.style.transform="translateX(20px)",o.classList.remove("section-hidden"),o.style.transition="opacity 0.4s ease-out, transform 0.4s ease-out",requestAnimationFrame(()=>{o.style.opacity="1",o.style.transform="translateX(0)"}),setTimeout(()=>{o.style.opacity="",o.style.transform="",o.style.transition=""},400))},100),T(`ðŸ“– Entering ${e.name}`),(a=O==null?void 0:O.play)==null||a.call(O,"success")},300)},filterNavbar(t){const e=this.courseConfig[t];e&&(document.querySelectorAll(".nav-item[data-section]").forEach(i=>{const s=i.dataset.section;if(s==="quiz-mode"){i.classList.remove("sidebar-hidden");return}e.sections.includes(s)?i.classList.remove("sidebar-hidden"):i.classList.add("sidebar-hidden")}),document.querySelectorAll(".nav-section").forEach(i=>{i.querySelectorAll(".nav-item:not(.sidebar-hidden)").length===0?i.classList.add("sidebar-hidden"):i.classList.remove("sidebar-hidden")}))}};function mg(){var t,e,i,s,r,n,a,o,l,c,h,d,u,p,f,g,m,y;console.log("[CSE Helper] Initializing application via ES modules...");try{(t=Ei==null?void 0:Ei.init)==null||t.call(Ei),(e=N==null?void 0:N.initBST)==null||e.call(N),typeof aa=="function"&&aa(),t$(),z0.init(),i$(),s$(),typeof Xr=="function"&&Xr(),V0.init(),fS(),(i=Rr==null?void 0:Rr.init)==null||i.call(Rr),r$(),Ll(),(s=O==null?void 0:O.init)==null||s.call(O),(r=O==null?void 0:O.updateUI)==null||r.call(O);const b=v("volumeSlider");if(b&&(O==null?void 0:O.volume)!==void 0){b.value=Math.round(O.volume*100);const k=v("volumeLabel");k&&(k.textContent=`${Math.round(O.volume*100)}%`)}(n=Et==null?void 0:Et.bindUI)==null||n.call(Et),(a=be==null?void 0:be.init)==null||a.call(be),(o=$r==null?void 0:$r.init)==null||o.call($r),(l=Ir==null?void 0:Ir.init)==null||l.call(Ir),(c=Qr==null?void 0:Qr.init)==null||c.call(Qr),(h=Ar==null?void 0:Ar.init)==null||h.call(Ar),(d=$n==null?void 0:$n.init)==null||d.call($n),(u=In==null?void 0:In.init)==null||u.call(In),K2(),J2();try{(p=Qn==null?void 0:Qn.init)==null||p.call(Qn)}catch(k){console.error("[SidebarRenderer] Failed to init:",k)}js(()=>import("./index-Cyt6TAot.js"),[]).then(k=>{k.SchemaLive&&k.SchemaLive.init("section-schema-live")}).catch(k=>{console.error("[SchemaLive] Failed to load module:",k)}),e$(),typeof Ju=="function"&&Ju(),U0.init(),X0.init(),(f=Zi==null?void 0:Zi.init)==null||f.call(Zi),(g=Vs==null?void 0:Vs.init)==null||g.call(Vs),(m=zs==null?void 0:zs.renderQuiz)==null||m.call(zs,"sortingQuizContainer","algorithms"),(y=hi==null?void 0:hi.init)==null||y.call(hi),localStorage.getItem("cse-has-visited")&&T("ðŸ“š Welcome back to Study Sanctuary!"),console.log("[CSE Helper] âœ… Application initialized successfully")}catch(b){console.error("[CSE Helper] âŒ Initialization error:",b)}}window.renderBigO=Ll;window.CourseManager=X0;console.log("%c[CSE Helper] ES Modules loaded successfully - 51 modules","color: #2f6a57; font-weight: bold");console.log("Phases 1-6:",{core:4,ui:3,gamification:5,learning:4,visualizers:3,bootstrap:1});console.log("Phases A-D:",{learningExt:5,practice:2,eLecture:2,dataStructures:1});console.log("Phases E-I:",{vizRender:3,social:1,tools:3,accessibility:1,quiz:1,additionalViz:2});console.log("Phases J-K:",{majorSystems:5,sandbox:1});ad.setEncouragementEngine(od);ad.setAIAssistant(Vg);zs.setOnCorrectCallback(()=>Vs.onQuizCorrect());document.readyState==="loading"?document.addEventListener("DOMContentLoaded",mg):mg();uS();function Jh(){const t=document.querySelectorAll(".electure-hub-container");if(t.length===0){console.warn("Hub Interactions: No hub containers found. Retrying in 500ms..."),setTimeout(()=>{document.querySelectorAll(".electure-hub-container").length>0&&Jh()},500);return}t.forEach(e=>{if(e.dataset.interactionsInitialized==="true")return;e.dataset.interactionsInitialized="true";const i=e.querySelectorAll(".filter-btn"),s=e.querySelector(".search-input"),r=e.querySelectorAll(".course-card");if(!i.length||!r.length)return;function n(a,o){r.forEach(l=>{const c=l.getAttribute("data-category"),h=l.querySelector(".card-title").textContent.toLowerCase(),d=a==="all"||c===a,u=!o||h.includes(o.toLowerCase());d&&u?(l.style.display="flex",l.style.opacity="0",requestAnimationFrame(()=>{l.style.transition="opacity 0.3s ease",l.style.opacity="1"})):l.style.display="none"})}i.forEach(a=>{a.addEventListener("click",()=>{i.forEach(c=>c.classList.remove("active")),a.classList.add("active");const o=a.getAttribute("data-filter"),l=s?s.value:"";n(o,l)})}),s&&s.addEventListener("input",a=>{const o=a.target.value,l=e.querySelector(".filter-btn.active"),c=l?l.getAttribute("data-filter"):"all";n(c,o)})}),console.log(`Hub Interactions: Initialized ${t.length} hubs.`)}document.readyState==="loading"?document.addEventListener("DOMContentLoaded",Jh):Jh();export{O as A,wS as C,N as D,V as E,Ge as S,js as _,bs as a,n$ as b,c2 as c,Rv as d,a$ as p,T as s};
